[
  {
    "function_name": "virJSONValueObjectDeflatten",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "2198-2209",
    "snippet": "virJSONValuePtr\nvirJSONValueObjectDeflatten(virJSONValuePtr json)\n{\n    virJSONValuePtr deflattened;\n\n    if (!(deflattened = virJSONValueObjectDeflattenKeys(json)))\n        return NULL;\n\n    virJSONValueObjectDeflattenArrays(deflattened);\n\n    return deflattened;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectDeflattenArrays",
          "args": [
            "deflattened"
          ],
          "line": 2206
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectDeflattenArrays",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "2140-2183",
          "snippet": "static void\nvirJSONValueObjectDeflattenArrays(virJSONValuePtr json)\n{\n    g_autofree virJSONValuePtr *arraymembers = NULL;\n    virJSONObjectPtr obj;\n    size_t i;\n\n    if (!json ||\n        json->type != VIR_JSON_TYPE_OBJECT)\n        return;\n\n    obj = &json->data.object;\n\n    arraymembers = g_new0(virJSONValuePtr, obj->npairs);\n\n    for (i = 0; i < obj->npairs; i++)\n        virJSONValueObjectDeflattenArrays(obj->pairs[i].value);\n\n    for (i = 0; i < obj->npairs; i++) {\n        virJSONObjectPairPtr pair = obj->pairs + i;\n        unsigned int keynum;\n\n        if (virStrToLong_uip(pair->key, NULL, 10, &keynum) < 0)\n            return;\n\n        if (keynum >= obj->npairs)\n            return;\n\n        if (arraymembers[keynum])\n            return;\n\n        arraymembers[keynum] = pair->value;\n    }\n\n    for (i = 0; i < obj->npairs; i++)\n        g_free(obj->pairs[i].key);\n\n    g_free(json->data.object.pairs);\n\n    i = obj->npairs;\n    json->type = VIR_JSON_TYPE_ARRAY;\n    json->data.array.nvalues = i;\n    json->data.array.values = g_steal_pointer(&arraymembers);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json);\n\nstatic void\nvirJSONValueObjectDeflattenArrays(virJSONValuePtr json)\n{\n    g_autofree virJSONValuePtr *arraymembers = NULL;\n    virJSONObjectPtr obj;\n    size_t i;\n\n    if (!json ||\n        json->type != VIR_JSON_TYPE_OBJECT)\n        return;\n\n    obj = &json->data.object;\n\n    arraymembers = g_new0(virJSONValuePtr, obj->npairs);\n\n    for (i = 0; i < obj->npairs; i++)\n        virJSONValueObjectDeflattenArrays(obj->pairs[i].value);\n\n    for (i = 0; i < obj->npairs; i++) {\n        virJSONObjectPairPtr pair = obj->pairs + i;\n        unsigned int keynum;\n\n        if (virStrToLong_uip(pair->key, NULL, 10, &keynum) < 0)\n            return;\n\n        if (keynum >= obj->npairs)\n            return;\n\n        if (arraymembers[keynum])\n            return;\n\n        arraymembers[keynum] = pair->value;\n    }\n\n    for (i = 0; i < obj->npairs; i++)\n        g_free(obj->pairs[i].key);\n\n    g_free(json->data.object.pairs);\n\n    i = obj->npairs;\n    json->type = VIR_JSON_TYPE_ARRAY;\n    json->data.array.nvalues = i;\n    json->data.array.values = g_steal_pointer(&arraymembers);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectDeflattenKeys",
          "args": [
            "json"
          ],
          "line": 2203
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectDeflattenKeys",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "2120-2131",
          "snippet": "static virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json)\n{\n    g_autoptr(virJSONValue) deflattened = virJSONValueNewObject();\n\n    if (virJSONValueObjectForeachKeyValue(json,\n                                          virJSONValueObjectDeflattenWorker,\n                                          deflattened) < 0)\n        return NULL;\n\n    return g_steal_pointer(&deflattened);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json);\n\nstatic virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json)\n{\n    g_autoptr(virJSONValue) deflattened = virJSONValueNewObject();\n\n    if (virJSONValueObjectForeachKeyValue(json,\n                                          virJSONValueObjectDeflattenWorker,\n                                          deflattened) < 0)\n        return NULL;\n\n    return g_steal_pointer(&deflattened);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json);\n\nvirJSONValuePtr\nvirJSONValueObjectDeflatten(virJSONValuePtr json)\n{\n    virJSONValuePtr deflattened;\n\n    if (!(deflattened = virJSONValueObjectDeflattenKeys(json)))\n        return NULL;\n\n    virJSONValueObjectDeflattenArrays(deflattened);\n\n    return deflattened;\n}"
  },
  {
    "function_name": "virJSONValueObjectDeflattenArrays",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "2140-2183",
    "snippet": "static void\nvirJSONValueObjectDeflattenArrays(virJSONValuePtr json)\n{\n    g_autofree virJSONValuePtr *arraymembers = NULL;\n    virJSONObjectPtr obj;\n    size_t i;\n\n    if (!json ||\n        json->type != VIR_JSON_TYPE_OBJECT)\n        return;\n\n    obj = &json->data.object;\n\n    arraymembers = g_new0(virJSONValuePtr, obj->npairs);\n\n    for (i = 0; i < obj->npairs; i++)\n        virJSONValueObjectDeflattenArrays(obj->pairs[i].value);\n\n    for (i = 0; i < obj->npairs; i++) {\n        virJSONObjectPairPtr pair = obj->pairs + i;\n        unsigned int keynum;\n\n        if (virStrToLong_uip(pair->key, NULL, 10, &keynum) < 0)\n            return;\n\n        if (keynum >= obj->npairs)\n            return;\n\n        if (arraymembers[keynum])\n            return;\n\n        arraymembers[keynum] = pair->value;\n    }\n\n    for (i = 0; i < obj->npairs; i++)\n        g_free(obj->pairs[i].key);\n\n    g_free(json->data.object.pairs);\n\n    i = obj->npairs;\n    json->type = VIR_JSON_TYPE_ARRAY;\n    json->data.array.nvalues = i;\n    json->data.array.values = g_steal_pointer(&arraymembers);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&arraymembers"
          ],
          "line": 2182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "json->data.object.pairs"
          ],
          "line": 2177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "obj->pairs[i].key"
          ],
          "line": 2175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_uip",
          "args": [
            "pair->key",
            "NULL",
            "10",
            "&keynum"
          ],
          "line": 2162
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectDeflattenArrays",
          "args": [
            "obj->pairs[i].value"
          ],
          "line": 2156
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectDeflattenArrays",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "2140-2183",
          "snippet": "static void\nvirJSONValueObjectDeflattenArrays(virJSONValuePtr json)\n{\n    g_autofree virJSONValuePtr *arraymembers = NULL;\n    virJSONObjectPtr obj;\n    size_t i;\n\n    if (!json ||\n        json->type != VIR_JSON_TYPE_OBJECT)\n        return;\n\n    obj = &json->data.object;\n\n    arraymembers = g_new0(virJSONValuePtr, obj->npairs);\n\n    for (i = 0; i < obj->npairs; i++)\n        virJSONValueObjectDeflattenArrays(obj->pairs[i].value);\n\n    for (i = 0; i < obj->npairs; i++) {\n        virJSONObjectPairPtr pair = obj->pairs + i;\n        unsigned int keynum;\n\n        if (virStrToLong_uip(pair->key, NULL, 10, &keynum) < 0)\n            return;\n\n        if (keynum >= obj->npairs)\n            return;\n\n        if (arraymembers[keynum])\n            return;\n\n        arraymembers[keynum] = pair->value;\n    }\n\n    for (i = 0; i < obj->npairs; i++)\n        g_free(obj->pairs[i].key);\n\n    g_free(json->data.object.pairs);\n\n    i = obj->npairs;\n    json->type = VIR_JSON_TYPE_ARRAY;\n    json->data.array.nvalues = i;\n    json->data.array.values = g_steal_pointer(&arraymembers);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "virJSONValuePtr",
            "obj->npairs"
          ],
          "line": 2153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json);\n\nstatic void\nvirJSONValueObjectDeflattenArrays(virJSONValuePtr json)\n{\n    g_autofree virJSONValuePtr *arraymembers = NULL;\n    virJSONObjectPtr obj;\n    size_t i;\n\n    if (!json ||\n        json->type != VIR_JSON_TYPE_OBJECT)\n        return;\n\n    obj = &json->data.object;\n\n    arraymembers = g_new0(virJSONValuePtr, obj->npairs);\n\n    for (i = 0; i < obj->npairs; i++)\n        virJSONValueObjectDeflattenArrays(obj->pairs[i].value);\n\n    for (i = 0; i < obj->npairs; i++) {\n        virJSONObjectPairPtr pair = obj->pairs + i;\n        unsigned int keynum;\n\n        if (virStrToLong_uip(pair->key, NULL, 10, &keynum) < 0)\n            return;\n\n        if (keynum >= obj->npairs)\n            return;\n\n        if (arraymembers[keynum])\n            return;\n\n        arraymembers[keynum] = pair->value;\n    }\n\n    for (i = 0; i < obj->npairs; i++)\n        g_free(obj->pairs[i].key);\n\n    g_free(json->data.object.pairs);\n\n    i = obj->npairs;\n    json->type = VIR_JSON_TYPE_ARRAY;\n    json->data.array.nvalues = i;\n    json->data.array.values = g_steal_pointer(&arraymembers);\n}"
  },
  {
    "function_name": "virJSONValueObjectDeflattenKeys",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "2120-2131",
    "snippet": "static virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json)\n{\n    g_autoptr(virJSONValue) deflattened = virJSONValueNewObject();\n\n    if (virJSONValueObjectForeachKeyValue(json,\n                                          virJSONValueObjectDeflattenWorker,\n                                          deflattened) < 0)\n        return NULL;\n\n    return g_steal_pointer(&deflattened);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&deflattened"
          ],
          "line": 2130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectForeachKeyValue",
          "args": [
            "json",
            "virJSONValueObjectDeflattenWorker",
            "deflattened"
          ],
          "line": 2125
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectForeachKeyValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1469-1487",
          "snippet": "int\nvirJSONValueObjectForeachKeyValue(virJSONValuePtr object,\n                                  virJSONValueObjectIteratorFunc cb,\n                                  void *opaque)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        virJSONObjectPairPtr elem = object->data.object.pairs + i;\n\n        if (cb(elem->key, elem->value, opaque) < 0)\n            return -2;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectForeachKeyValue(virJSONValuePtr object,\n                                  virJSONValueObjectIteratorFunc cb,\n                                  void *opaque)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        virJSONObjectPairPtr elem = object->data.object.pairs + i;\n\n        if (cb(elem->key, elem->value, opaque) < 0)\n            return -2;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewObject",
          "args": [],
          "line": 2123
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "571-579",
          "snippet": "virJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json);\n\nstatic virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json)\n{\n    g_autoptr(virJSONValue) deflattened = virJSONValueNewObject();\n\n    if (virJSONValueObjectForeachKeyValue(json,\n                                          virJSONValueObjectDeflattenWorker,\n                                          deflattened) < 0)\n        return NULL;\n\n    return g_steal_pointer(&deflattened);\n}"
  },
  {
    "function_name": "virJSONValueObjectDeflattenWorker",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "2056-2117",
    "snippet": "static int\nvirJSONValueObjectDeflattenWorker(const char *key,\n                                  virJSONValuePtr value,\n                                  void *opaque)\n{\n    virJSONValuePtr retobj = opaque;\n    g_autoptr(virJSONValue) newval = NULL;\n    virJSONValuePtr existobj;\n    VIR_AUTOSTRINGLIST tokens = NULL;\n    size_t ntokens = 0;\n\n    /* non-nested keys only need to be copied */\n    if (!strchr(key, '.')) {\n\n        if (virJSONValueIsObject(value))\n            newval = virJSONValueObjectDeflattenKeys(value);\n        else\n            newval = virJSONValueCopy(value);\n\n        if (!newval)\n            return -1;\n\n        if (virJSONValueObjectHasKey(retobj, key)) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"can't deflatten colliding key '%s'\"), key);\n            return -1;\n        }\n\n        if (virJSONValueObjectAppend(retobj, key, newval) < 0)\n            return -1;\n\n        newval = NULL;\n\n        return 0;\n    }\n\n    if (!(tokens = virStringSplitCount(key, \".\", 2, &ntokens)))\n        return -1;\n\n    if (ntokens != 2) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"invalid nested value key '%s'\"), key);\n        return -1;\n    }\n\n    if (!(existobj = virJSONValueObjectGet(retobj, tokens[0]))) {\n        existobj = virJSONValueNewObject();\n\n        if (virJSONValueObjectAppend(retobj, tokens[0], existobj) < 0)\n            return -1;\n\n    } else {\n        if (!virJSONValueIsObject(existobj)) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"mixing nested objects and values is forbidden in \"\n                             \"JSON deflattening\"));\n            return -1;\n        }\n    }\n\n    return virJSONValueObjectDeflattenWorker(tokens[1], value, existobj);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectDeflattenWorker",
          "args": [
            "tokens[1]",
            "value",
            "existobj"
          ],
          "line": 2116
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectDeflattenWorker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "2056-2117",
          "snippet": "static int\nvirJSONValueObjectDeflattenWorker(const char *key,\n                                  virJSONValuePtr value,\n                                  void *opaque)\n{\n    virJSONValuePtr retobj = opaque;\n    g_autoptr(virJSONValue) newval = NULL;\n    virJSONValuePtr existobj;\n    VIR_AUTOSTRINGLIST tokens = NULL;\n    size_t ntokens = 0;\n\n    /* non-nested keys only need to be copied */\n    if (!strchr(key, '.')) {\n\n        if (virJSONValueIsObject(value))\n            newval = virJSONValueObjectDeflattenKeys(value);\n        else\n            newval = virJSONValueCopy(value);\n\n        if (!newval)\n            return -1;\n\n        if (virJSONValueObjectHasKey(retobj, key)) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"can't deflatten colliding key '%s'\"), key);\n            return -1;\n        }\n\n        if (virJSONValueObjectAppend(retobj, key, newval) < 0)\n            return -1;\n\n        newval = NULL;\n\n        return 0;\n    }\n\n    if (!(tokens = virStringSplitCount(key, \".\", 2, &ntokens)))\n        return -1;\n\n    if (ntokens != 2) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"invalid nested value key '%s'\"), key);\n        return -1;\n    }\n\n    if (!(existobj = virJSONValueObjectGet(retobj, tokens[0]))) {\n        existobj = virJSONValueNewObject();\n\n        if (virJSONValueObjectAppend(retobj, tokens[0], existobj) < 0)\n            return -1;\n\n    } else {\n        if (!virJSONValueIsObject(existobj)) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"mixing nested objects and values is forbidden in \"\n                             \"JSON deflattening\"));\n            return -1;\n        }\n    }\n\n    return virJSONValueObjectDeflattenWorker(tokens[1], value, existobj);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"mixing nested objects and values is forbidden in \"\n                             \"JSON deflattening\")"
          ],
          "line": 2109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"mixing nested objects and values is forbidden in \"\n                             \"JSON deflattening\""
          ],
          "line": 2110
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueIsObject",
          "args": [
            "existobj"
          ],
          "line": 2108
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueIsObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1000-1007",
          "snippet": "bool\nvirJSONValueIsObject(virJSONValuePtr object)\n{\n    if (object)\n        return object->type == VIR_JSON_TYPE_OBJECT;\n    else\n        return false;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nbool\nvirJSONValueIsObject(virJSONValuePtr object)\n{\n    if (object)\n        return object->type == VIR_JSON_TYPE_OBJECT;\n    else\n        return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppend",
          "args": [
            "retobj",
            "tokens[0]",
            "existobj"
          ],
          "line": 2104
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "741-754",
          "snippet": "int\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewObject",
          "args": [],
          "line": 2102
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "571-579",
          "snippet": "virJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGet",
          "args": [
            "retobj",
            "tokens[0]"
          ],
          "line": 2101
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"invalid nested value key '%s'\")",
            "key"
          ],
          "line": 2096
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringSplitCount",
          "args": [
            "key",
            "\".\"",
            "2",
            "&ntokens"
          ],
          "line": 2092
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplitCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "69-123",
          "snippet": "char **\nvirStringSplitCount(const char *string,\n                    const char *delim,\n                    size_t max_tokens,\n                    size_t *tokcount)\n{\n    char **tokens = NULL;\n    size_t ntokens = 0;\n    size_t maxtokens = 0;\n    const char *remainder = string;\n    char *tmp;\n    size_t i;\n\n    if (max_tokens == 0)\n        max_tokens = INT_MAX;\n\n    tmp = strstr(remainder, delim);\n    if (tmp) {\n        size_t delimlen = strlen(delim);\n\n        while (--max_tokens && tmp) {\n            size_t len = tmp - remainder;\n\n            if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n                goto error;\n\n            tokens[ntokens] = g_strndup(remainder, len);\n            ntokens++;\n            remainder = tmp + delimlen;\n            tmp = strstr(remainder, delim);\n        }\n    }\n    if (*string) {\n        if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n            goto error;\n\n        tokens[ntokens] = g_strdup(remainder);\n        ntokens++;\n    }\n\n    if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n        goto error;\n    tokens[ntokens++] = NULL;\n\n    if (tokcount)\n        *tokcount = ntokens - 1;\n\n    return tokens;\n\n error:\n    for (i = 0; i < ntokens; i++)\n        VIR_FREE(tokens[i]);\n    VIR_FREE(tokens);\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplitCount(const char *string,\n                    const char *delim,\n                    size_t max_tokens,\n                    size_t *tokcount)\n{\n    char **tokens = NULL;\n    size_t ntokens = 0;\n    size_t maxtokens = 0;\n    const char *remainder = string;\n    char *tmp;\n    size_t i;\n\n    if (max_tokens == 0)\n        max_tokens = INT_MAX;\n\n    tmp = strstr(remainder, delim);\n    if (tmp) {\n        size_t delimlen = strlen(delim);\n\n        while (--max_tokens && tmp) {\n            size_t len = tmp - remainder;\n\n            if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n                goto error;\n\n            tokens[ntokens] = g_strndup(remainder, len);\n            ntokens++;\n            remainder = tmp + delimlen;\n            tmp = strstr(remainder, delim);\n        }\n    }\n    if (*string) {\n        if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n            goto error;\n\n        tokens[ntokens] = g_strdup(remainder);\n        ntokens++;\n    }\n\n    if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n        goto error;\n    tokens[ntokens++] = NULL;\n\n    if (tokcount)\n        *tokcount = ntokens - 1;\n\n    return tokens;\n\n error:\n    for (i = 0; i < ntokens; i++)\n        VIR_FREE(tokens[i]);\n    VIR_FREE(tokens);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"can't deflatten colliding key '%s'\")",
            "key"
          ],
          "line": 2079
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectHasKey",
          "args": [
            "retobj",
            "key"
          ],
          "line": 2078
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectHasKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "838-853",
          "snippet": "int\nvirJSONValueObjectHasKey(virJSONValuePtr object,\n                         const char *key)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key))\n            return 1;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectHasKey(virJSONValuePtr object,\n                         const char *key)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key))\n            return 1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueCopy",
          "args": [
            "value"
          ],
          "line": 2073
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1490-1546",
          "snippet": "virJSONValuePtr\nvirJSONValueCopy(const virJSONValue *in)\n{\n    size_t i;\n    virJSONValuePtr out = NULL;\n\n    if (!in)\n        return NULL;\n\n    switch ((virJSONType) in->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        out = virJSONValueNewObject();\n        for (i = 0; i < in->data.object.npairs; i++) {\n            virJSONValuePtr val = NULL;\n            if (!(val = virJSONValueCopy(in->data.object.pairs[i].value)))\n                goto error;\n            if (virJSONValueObjectAppend(out, in->data.object.pairs[i].key,\n                                         val) < 0) {\n                virJSONValueFree(val);\n                goto error;\n            }\n        }\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        out = virJSONValueNewArray();\n        for (i = 0; i < in->data.array.nvalues; i++) {\n            virJSONValuePtr val = NULL;\n            if (!(val = virJSONValueCopy(in->data.array.values[i])))\n                goto error;\n            if (virJSONValueArrayAppend(out, val) < 0) {\n                virJSONValueFree(val);\n                goto error;\n            }\n        }\n        break;\n\n    /* No need to error out in the following cases */\n    case VIR_JSON_TYPE_STRING:\n        out = virJSONValueNewString(in->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        out = virJSONValueNewNumber(in->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n        out = virJSONValueNewBoolean(in->data.boolean);\n        break;\n    case VIR_JSON_TYPE_NULL:\n        out = virJSONValueNewNull();\n        break;\n    }\n\n    return out;\n\n error:\n    virJSONValueFree(out);\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueCopy(const virJSONValue *in)\n{\n    size_t i;\n    virJSONValuePtr out = NULL;\n\n    if (!in)\n        return NULL;\n\n    switch ((virJSONType) in->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        out = virJSONValueNewObject();\n        for (i = 0; i < in->data.object.npairs; i++) {\n            virJSONValuePtr val = NULL;\n            if (!(val = virJSONValueCopy(in->data.object.pairs[i].value)))\n                goto error;\n            if (virJSONValueObjectAppend(out, in->data.object.pairs[i].key,\n                                         val) < 0) {\n                virJSONValueFree(val);\n                goto error;\n            }\n        }\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        out = virJSONValueNewArray();\n        for (i = 0; i < in->data.array.nvalues; i++) {\n            virJSONValuePtr val = NULL;\n            if (!(val = virJSONValueCopy(in->data.array.values[i])))\n                goto error;\n            if (virJSONValueArrayAppend(out, val) < 0) {\n                virJSONValueFree(val);\n                goto error;\n            }\n        }\n        break;\n\n    /* No need to error out in the following cases */\n    case VIR_JSON_TYPE_STRING:\n        out = virJSONValueNewString(in->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        out = virJSONValueNewNumber(in->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n        out = virJSONValueNewBoolean(in->data.boolean);\n        break;\n    case VIR_JSON_TYPE_NULL:\n        out = virJSONValueNewNull();\n        break;\n    }\n\n    return out;\n\n error:\n    virJSONValueFree(out);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectDeflattenKeys",
          "args": [
            "value"
          ],
          "line": 2071
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectDeflattenKeys",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "2120-2131",
          "snippet": "static virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json)\n{\n    g_autoptr(virJSONValue) deflattened = virJSONValueNewObject();\n\n    if (virJSONValueObjectForeachKeyValue(json,\n                                          virJSONValueObjectDeflattenWorker,\n                                          deflattened) < 0)\n        return NULL;\n\n    return g_steal_pointer(&deflattened);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json);\n\nstatic virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json)\n{\n    g_autoptr(virJSONValue) deflattened = virJSONValueNewObject();\n\n    if (virJSONValueObjectForeachKeyValue(json,\n                                          virJSONValueObjectDeflattenWorker,\n                                          deflattened) < 0)\n        return NULL;\n\n    return g_steal_pointer(&deflattened);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "key",
            "'.'"
          ],
          "line": 2068
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONValueObjectDeflattenWorker(const char *key,\n                                  virJSONValuePtr value,\n                                  void *opaque)\n{\n    virJSONValuePtr retobj = opaque;\n    g_autoptr(virJSONValue) newval = NULL;\n    virJSONValuePtr existobj;\n    VIR_AUTOSTRINGLIST tokens = NULL;\n    size_t ntokens = 0;\n\n    /* non-nested keys only need to be copied */\n    if (!strchr(key, '.')) {\n\n        if (virJSONValueIsObject(value))\n            newval = virJSONValueObjectDeflattenKeys(value);\n        else\n            newval = virJSONValueCopy(value);\n\n        if (!newval)\n            return -1;\n\n        if (virJSONValueObjectHasKey(retobj, key)) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"can't deflatten colliding key '%s'\"), key);\n            return -1;\n        }\n\n        if (virJSONValueObjectAppend(retobj, key, newval) < 0)\n            return -1;\n\n        newval = NULL;\n\n        return 0;\n    }\n\n    if (!(tokens = virStringSplitCount(key, \".\", 2, &ntokens)))\n        return -1;\n\n    if (ntokens != 2) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"invalid nested value key '%s'\"), key);\n        return -1;\n    }\n\n    if (!(existobj = virJSONValueObjectGet(retobj, tokens[0]))) {\n        existobj = virJSONValueNewObject();\n\n        if (virJSONValueObjectAppend(retobj, tokens[0], existobj) < 0)\n            return -1;\n\n    } else {\n        if (!virJSONValueIsObject(existobj)) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"mixing nested objects and values is forbidden in \"\n                             \"JSON deflattening\"));\n            return -1;\n        }\n    }\n\n    return virJSONValueObjectDeflattenWorker(tokens[1], value, existobj);\n}"
  },
  {
    "function_name": "virJSONStringReformat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "2039-2049",
    "snippet": "char *\nvirJSONStringReformat(const char *jsonstr,\n                      bool pretty)\n{\n    g_autoptr(virJSONValue) json = NULL;\n\n    if (!(json = virJSONValueFromString(jsonstr)))\n        return NULL;\n\n    return virJSONValueToString(json, pretty);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueToString",
          "args": [
            "json",
            "pretty"
          ],
          "line": 2048
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "2014-2024",
          "snippet": "char *\nvirJSONValueToString(virJSONValuePtr object,\n                     bool pretty)\n{\n    g_auto(virBuffer) buf = VIR_BUFFER_INITIALIZER;\n\n    if (virJSONValueToBuffer(object, &buf, pretty) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nchar *\nvirJSONValueToString(virJSONValuePtr object,\n                     bool pretty)\n{\n    g_auto(virBuffer) buf = VIR_BUFFER_INITIALIZER;\n\n    if (virJSONValueToBuffer(object, &buf, pretty) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueFromString",
          "args": [
            "jsonstr"
          ],
          "line": 2045
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFromString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1993-1999",
          "snippet": "virJSONValuePtr\nvirJSONValueFromString(const char *jsonstring G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"No JSON parser implementation is available\"));\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueFromString(const char *jsonstring G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"No JSON parser implementation is available\"));\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json);\n\nchar *\nvirJSONStringReformat(const char *jsonstr,\n                      bool pretty)\n{\n    g_autoptr(virJSONValue) json = NULL;\n\n    if (!(json = virJSONValueFromString(jsonstr)))\n        return NULL;\n\n    return virJSONValueToString(json, pretty);\n}"
  },
  {
    "function_name": "virJSONValueToString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "2014-2024",
    "snippet": "char *\nvirJSONValueToString(virJSONValuePtr object,\n                     bool pretty)\n{\n    g_auto(virBuffer) buf = VIR_BUFFER_INITIALIZER;\n\n    if (virJSONValueToBuffer(object, &buf, pretty) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 2023
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueToBuffer",
          "args": [
            "object",
            "&buf",
            "pretty"
          ],
          "line": 2020
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueToBuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "2002-2010",
          "snippet": "int\nvirJSONValueToBuffer(virJSONValuePtr object G_GNUC_UNUSED,\n                     virBufferPtr buf G_GNUC_UNUSED,\n                     bool pretty G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"No JSON parser implementation is available\"));\n    return -1;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueToBuffer(virJSONValuePtr object G_GNUC_UNUSED,\n                     virBufferPtr buf G_GNUC_UNUSED,\n                     bool pretty G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"No JSON parser implementation is available\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nchar *\nvirJSONValueToString(virJSONValuePtr object,\n                     bool pretty)\n{\n    g_auto(virBuffer) buf = VIR_BUFFER_INITIALIZER;\n\n    if (virJSONValueToBuffer(object, &buf, pretty) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}"
  },
  {
    "function_name": "virJSONValueToBuffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "2002-2010",
    "snippet": "int\nvirJSONValueToBuffer(virJSONValuePtr object G_GNUC_UNUSED,\n                     virBufferPtr buf G_GNUC_UNUSED,\n                     bool pretty G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"No JSON parser implementation is available\"));\n    return -1;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"No JSON parser implementation is available\")"
          ],
          "line": 2007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"No JSON parser implementation is available\""
          ],
          "line": 2008
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueToBuffer(virJSONValuePtr object G_GNUC_UNUSED,\n                     virBufferPtr buf G_GNUC_UNUSED,\n                     bool pretty G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"No JSON parser implementation is available\"));\n    return -1;\n}"
  },
  {
    "function_name": "virJSONValueFromString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1993-1999",
    "snippet": "virJSONValuePtr\nvirJSONValueFromString(const char *jsonstring G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"No JSON parser implementation is available\"));\n    return NULL;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"No JSON parser implementation is available\")"
          ],
          "line": 1996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"No JSON parser implementation is available\""
          ],
          "line": 1997
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueFromString(const char *jsonstring G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"No JSON parser implementation is available\"));\n    return NULL;\n}"
  },
  {
    "function_name": "virJSONValueToBuffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1950-1989",
    "snippet": "int\nvirJSONValueToBuffer(virJSONValuePtr object,\n                     virBufferPtr buf,\n                     bool pretty)\n{\n    yajl_gen g;\n    const unsigned char *str;\n    size_t len;\n    int ret = -1;\n\n    VIR_DEBUG(\"object=%p\", object);\n\n    g = yajl_gen_alloc(NULL);\n    if (!g) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to create JSON formatter\"));\n        goto cleanup;\n    }\n    yajl_gen_config(g, yajl_gen_beautify, pretty ? 1 : 0);\n    yajl_gen_config(g, yajl_gen_indent_string, pretty ? \"  \" : \" \");\n    yajl_gen_config(g, yajl_gen_validate_utf8, 1);\n\n    if (virJSONValueToStringOne(object, g) < 0) {\n        virReportOOMError();\n        goto cleanup;\n    }\n\n    if (yajl_gen_get_buf(g, &str, &len) != yajl_gen_status_ok) {\n        virReportOOMError();\n        goto cleanup;\n    }\n\n    virBufferAdd(buf, (const char *) str, len);\n    ret = 0;\n\n cleanup:\n    yajl_gen_free(g);\n\n    return ret;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "yajl_gen_free",
          "args": [
            "g"
          ],
          "line": 1986
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdd",
          "args": [
            "buf",
            "(const char *) str",
            "len"
          ],
          "line": 1982
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "156-169",
          "snippet": "void\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportOOMError",
          "args": [],
          "line": 1978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "yajl_gen_get_buf",
          "args": [
            "g",
            "&str",
            "&len"
          ],
          "line": 1977
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportOOMError",
          "args": [],
          "line": 1973
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueToStringOne",
          "args": [
            "object",
            "g"
          ],
          "line": 1972
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueToStringOne",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1885-1947",
          "snippet": "static int\nvirJSONValueToStringOne(virJSONValuePtr object,\n                        yajl_gen g)\n{\n    size_t i;\n\n    VIR_DEBUG(\"object=%p type=%d gen=%p\", object, object->type, g);\n\n    switch (object->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        if (yajl_gen_map_open(g) != yajl_gen_status_ok)\n            return -1;\n        for (i = 0; i < object->data.object.npairs; i++) {\n            if (yajl_gen_string(g,\n                                (unsigned char *)object->data.object.pairs[i].key,\n                                strlen(object->data.object.pairs[i].key))\n                != yajl_gen_status_ok)\n                return -1;\n            if (virJSONValueToStringOne(object->data.object.pairs[i].value, g) < 0)\n                return -1;\n        }\n        if (yajl_gen_map_close(g) != yajl_gen_status_ok)\n            return -1;\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        if (yajl_gen_array_open(g) != yajl_gen_status_ok)\n            return -1;\n        for (i = 0; i < object->data.array.nvalues; i++) {\n            if (virJSONValueToStringOne(object->data.array.values[i], g) < 0)\n                return -1;\n        }\n        if (yajl_gen_array_close(g) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_STRING:\n        if (yajl_gen_string(g, (unsigned char *)object->data.string,\n                            strlen(object->data.string)) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_NUMBER:\n        if (yajl_gen_number(g, object->data.number,\n                            strlen(object->data.number)) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_BOOLEAN:\n        if (yajl_gen_bool(g, object->data.boolean) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_NULL:\n        if (yajl_gen_null(g) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    default:\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONValueToStringOne(virJSONValuePtr object,\n                        yajl_gen g)\n{\n    size_t i;\n\n    VIR_DEBUG(\"object=%p type=%d gen=%p\", object, object->type, g);\n\n    switch (object->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        if (yajl_gen_map_open(g) != yajl_gen_status_ok)\n            return -1;\n        for (i = 0; i < object->data.object.npairs; i++) {\n            if (yajl_gen_string(g,\n                                (unsigned char *)object->data.object.pairs[i].key,\n                                strlen(object->data.object.pairs[i].key))\n                != yajl_gen_status_ok)\n                return -1;\n            if (virJSONValueToStringOne(object->data.object.pairs[i].value, g) < 0)\n                return -1;\n        }\n        if (yajl_gen_map_close(g) != yajl_gen_status_ok)\n            return -1;\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        if (yajl_gen_array_open(g) != yajl_gen_status_ok)\n            return -1;\n        for (i = 0; i < object->data.array.nvalues; i++) {\n            if (virJSONValueToStringOne(object->data.array.values[i], g) < 0)\n                return -1;\n        }\n        if (yajl_gen_array_close(g) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_STRING:\n        if (yajl_gen_string(g, (unsigned char *)object->data.string,\n                            strlen(object->data.string)) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_NUMBER:\n        if (yajl_gen_number(g, object->data.number,\n                            strlen(object->data.number)) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_BOOLEAN:\n        if (yajl_gen_bool(g, object->data.boolean) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_NULL:\n        if (yajl_gen_null(g) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    default:\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "yajl_gen_config",
          "args": [
            "g",
            "yajl_gen_validate_utf8",
            "1"
          ],
          "line": 1970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "yajl_gen_config",
          "args": [
            "g",
            "yajl_gen_indent_string",
            "pretty ? \"  \" : \" \""
          ],
          "line": 1969
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "yajl_gen_config",
          "args": [
            "g",
            "yajl_gen_beautify",
            "pretty ? 1 : 0"
          ],
          "line": 1968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Unable to create JSON formatter\")"
          ],
          "line": 1964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to create JSON formatter\""
          ],
          "line": 1965
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "yajl_gen_alloc",
          "args": [
            "NULL"
          ],
          "line": 1962
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"object=%p\"",
            "object"
          ],
          "line": 1960
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueToBuffer(virJSONValuePtr object,\n                     virBufferPtr buf,\n                     bool pretty)\n{\n    yajl_gen g;\n    const unsigned char *str;\n    size_t len;\n    int ret = -1;\n\n    VIR_DEBUG(\"object=%p\", object);\n\n    g = yajl_gen_alloc(NULL);\n    if (!g) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to create JSON formatter\"));\n        goto cleanup;\n    }\n    yajl_gen_config(g, yajl_gen_beautify, pretty ? 1 : 0);\n    yajl_gen_config(g, yajl_gen_indent_string, pretty ? \"  \" : \" \");\n    yajl_gen_config(g, yajl_gen_validate_utf8, 1);\n\n    if (virJSONValueToStringOne(object, g) < 0) {\n        virReportOOMError();\n        goto cleanup;\n    }\n\n    if (yajl_gen_get_buf(g, &str, &len) != yajl_gen_status_ok) {\n        virReportOOMError();\n        goto cleanup;\n    }\n\n    virBufferAdd(buf, (const char *) str, len);\n    ret = 0;\n\n cleanup:\n    yajl_gen_free(g);\n\n    return ret;\n}"
  },
  {
    "function_name": "virJSONValueToStringOne",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1885-1947",
    "snippet": "static int\nvirJSONValueToStringOne(virJSONValuePtr object,\n                        yajl_gen g)\n{\n    size_t i;\n\n    VIR_DEBUG(\"object=%p type=%d gen=%p\", object, object->type, g);\n\n    switch (object->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        if (yajl_gen_map_open(g) != yajl_gen_status_ok)\n            return -1;\n        for (i = 0; i < object->data.object.npairs; i++) {\n            if (yajl_gen_string(g,\n                                (unsigned char *)object->data.object.pairs[i].key,\n                                strlen(object->data.object.pairs[i].key))\n                != yajl_gen_status_ok)\n                return -1;\n            if (virJSONValueToStringOne(object->data.object.pairs[i].value, g) < 0)\n                return -1;\n        }\n        if (yajl_gen_map_close(g) != yajl_gen_status_ok)\n            return -1;\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        if (yajl_gen_array_open(g) != yajl_gen_status_ok)\n            return -1;\n        for (i = 0; i < object->data.array.nvalues; i++) {\n            if (virJSONValueToStringOne(object->data.array.values[i], g) < 0)\n                return -1;\n        }\n        if (yajl_gen_array_close(g) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_STRING:\n        if (yajl_gen_string(g, (unsigned char *)object->data.string,\n                            strlen(object->data.string)) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_NUMBER:\n        if (yajl_gen_number(g, object->data.number,\n                            strlen(object->data.number)) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_BOOLEAN:\n        if (yajl_gen_bool(g, object->data.boolean) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_NULL:\n        if (yajl_gen_null(g) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    default:\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "yajl_gen_null",
          "args": [
            "g"
          ],
          "line": 1938
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "yajl_gen_bool",
          "args": [
            "g",
            "object->data.boolean"
          ],
          "line": 1933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "yajl_gen_number",
          "args": [
            "g",
            "object->data.number",
            "strlen(object->data.number)"
          ],
          "line": 1927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "object->data.number"
          ],
          "line": 1928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "yajl_gen_string",
          "args": [
            "g",
            "(unsigned char *)object->data.string",
            "strlen(object->data.string)"
          ],
          "line": 1921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "object->data.string"
          ],
          "line": 1922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "yajl_gen_array_close",
          "args": [
            "g"
          ],
          "line": 1916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueToStringOne",
          "args": [
            "object->data.array.values[i]",
            "g"
          ],
          "line": 1913
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueToStringOne",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1885-1947",
          "snippet": "static int\nvirJSONValueToStringOne(virJSONValuePtr object,\n                        yajl_gen g)\n{\n    size_t i;\n\n    VIR_DEBUG(\"object=%p type=%d gen=%p\", object, object->type, g);\n\n    switch (object->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        if (yajl_gen_map_open(g) != yajl_gen_status_ok)\n            return -1;\n        for (i = 0; i < object->data.object.npairs; i++) {\n            if (yajl_gen_string(g,\n                                (unsigned char *)object->data.object.pairs[i].key,\n                                strlen(object->data.object.pairs[i].key))\n                != yajl_gen_status_ok)\n                return -1;\n            if (virJSONValueToStringOne(object->data.object.pairs[i].value, g) < 0)\n                return -1;\n        }\n        if (yajl_gen_map_close(g) != yajl_gen_status_ok)\n            return -1;\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        if (yajl_gen_array_open(g) != yajl_gen_status_ok)\n            return -1;\n        for (i = 0; i < object->data.array.nvalues; i++) {\n            if (virJSONValueToStringOne(object->data.array.values[i], g) < 0)\n                return -1;\n        }\n        if (yajl_gen_array_close(g) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_STRING:\n        if (yajl_gen_string(g, (unsigned char *)object->data.string,\n                            strlen(object->data.string)) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_NUMBER:\n        if (yajl_gen_number(g, object->data.number,\n                            strlen(object->data.number)) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_BOOLEAN:\n        if (yajl_gen_bool(g, object->data.boolean) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_NULL:\n        if (yajl_gen_null(g) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    default:\n        return -1;\n    }\n\n    return 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "yajl_gen_array_open",
          "args": [
            "g"
          ],
          "line": 1910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "yajl_gen_map_close",
          "args": [
            "g"
          ],
          "line": 1906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "yajl_gen_string",
          "args": [
            "g",
            "(unsigned char *)object->data.object.pairs[i].key",
            "strlen(object->data.object.pairs[i].key)"
          ],
          "line": 1898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "object->data.object.pairs[i].key"
          ],
          "line": 1900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "yajl_gen_map_open",
          "args": [
            "g"
          ],
          "line": 1895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"object=%p type=%d gen=%p\"",
            "object",
            "object->type",
            "g"
          ],
          "line": 1891
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONValueToStringOne(virJSONValuePtr object,\n                        yajl_gen g)\n{\n    size_t i;\n\n    VIR_DEBUG(\"object=%p type=%d gen=%p\", object, object->type, g);\n\n    switch (object->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        if (yajl_gen_map_open(g) != yajl_gen_status_ok)\n            return -1;\n        for (i = 0; i < object->data.object.npairs; i++) {\n            if (yajl_gen_string(g,\n                                (unsigned char *)object->data.object.pairs[i].key,\n                                strlen(object->data.object.pairs[i].key))\n                != yajl_gen_status_ok)\n                return -1;\n            if (virJSONValueToStringOne(object->data.object.pairs[i].value, g) < 0)\n                return -1;\n        }\n        if (yajl_gen_map_close(g) != yajl_gen_status_ok)\n            return -1;\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        if (yajl_gen_array_open(g) != yajl_gen_status_ok)\n            return -1;\n        for (i = 0; i < object->data.array.nvalues; i++) {\n            if (virJSONValueToStringOne(object->data.array.values[i], g) < 0)\n                return -1;\n        }\n        if (yajl_gen_array_close(g) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_STRING:\n        if (yajl_gen_string(g, (unsigned char *)object->data.string,\n                            strlen(object->data.string)) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_NUMBER:\n        if (yajl_gen_number(g, object->data.number,\n                            strlen(object->data.number)) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_BOOLEAN:\n        if (yajl_gen_bool(g, object->data.boolean) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    case VIR_JSON_TYPE_NULL:\n        if (yajl_gen_null(g) != yajl_gen_status_ok)\n            return -1;\n        break;\n\n    default:\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueFromString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1826-1882",
    "snippet": "virJSONValuePtr\nvirJSONValueFromString(const char *jsonstring)\n{\n    yajl_handle hand;\n    virJSONParser parser = { NULL, NULL, 0, 0 };\n    virJSONValuePtr ret = NULL;\n    int rc;\n    size_t len = strlen(jsonstring);\n\n    VIR_DEBUG(\"string=%s\", jsonstring);\n\n    hand = yajl_alloc(&parserCallbacks, NULL, &parser);\n    if (!hand) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to create JSON parser\"));\n        goto cleanup;\n    }\n\n    /* Yajl 2 is nice enough to default to rejecting trailing garbage. */\n    rc = yajl_parse(hand, (const unsigned char *)jsonstring, len);\n    if (rc != yajl_status_ok ||\n        yajl_complete_parse(hand) != yajl_status_ok) {\n        unsigned char *errstr = yajl_get_error(hand, 1,\n                                               (const unsigned char*)jsonstring,\n                                               strlen(jsonstring));\n\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot parse json %s: %s\"),\n                       jsonstring, (const char*) errstr);\n        yajl_free_error(hand, errstr);\n        virJSONValueFree(parser.head);\n        goto cleanup;\n    }\n\n    if (parser.nstate != 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot parse json %s: unterminated string/map/array\"),\n                       jsonstring);\n        virJSONValueFree(parser.head);\n    } else {\n        ret = parser.head;\n    }\n\n cleanup:\n    yajl_free(hand);\n\n    if (parser.nstate) {\n        size_t i;\n        for (i = 0; i < parser.nstate; i++)\n            VIR_FREE(parser.state[i].key);\n        VIR_FREE(parser.state);\n    }\n\n    VIR_DEBUG(\"result=%p\", ret);\n\n    return ret;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"result=%p\"",
            "ret"
          ],
          "line": 1879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "parser.state"
          ],
          "line": 1876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "parser.state[i].key"
          ],
          "line": 1875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "yajl_free",
          "args": [
            "hand"
          ],
          "line": 1870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "parser.head"
          ],
          "line": 1864
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot parse json %s: unterminated string/map/array\")",
            "jsonstring"
          ],
          "line": 1861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot parse json %s: unterminated string/map/array\""
          ],
          "line": 1862
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "yajl_free_error",
          "args": [
            "hand",
            "errstr"
          ],
          "line": 1855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot parse json %s: %s\")",
            "jsonstring",
            "(const char*) errstr"
          ],
          "line": 1852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "yajl_get_error",
          "args": [
            "hand",
            "1",
            "(const unsigned char*)jsonstring",
            "strlen(jsonstring)"
          ],
          "line": 1848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "jsonstring"
          ],
          "line": 1850
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "yajl_complete_parse",
          "args": [
            "hand"
          ],
          "line": 1847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "yajl_parse",
          "args": [
            "hand",
            "(const unsigned char *)jsonstring",
            "len"
          ],
          "line": 1845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Unable to create JSON parser\")"
          ],
          "line": 1839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "yajl_alloc",
          "args": [
            "&parserCallbacks",
            "NULL",
            "&parser"
          ],
          "line": 1837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"string=%s\"",
            "jsonstring"
          ],
          "line": 1835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "jsonstring"
          ],
          "line": 1833
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nvirJSONValueObjectDeflattenKeys(virJSONValuePtr json);\n\nvirJSONValuePtr\nvirJSONValueFromString(const char *jsonstring)\n{\n    yajl_handle hand;\n    virJSONParser parser = { NULL, NULL, 0, 0 };\n    virJSONValuePtr ret = NULL;\n    int rc;\n    size_t len = strlen(jsonstring);\n\n    VIR_DEBUG(\"string=%s\", jsonstring);\n\n    hand = yajl_alloc(&parserCallbacks, NULL, &parser);\n    if (!hand) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to create JSON parser\"));\n        goto cleanup;\n    }\n\n    /* Yajl 2 is nice enough to default to rejecting trailing garbage. */\n    rc = yajl_parse(hand, (const unsigned char *)jsonstring, len);\n    if (rc != yajl_status_ok ||\n        yajl_complete_parse(hand) != yajl_status_ok) {\n        unsigned char *errstr = yajl_get_error(hand, 1,\n                                               (const unsigned char*)jsonstring,\n                                               strlen(jsonstring));\n\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot parse json %s: %s\"),\n                       jsonstring, (const char*) errstr);\n        yajl_free_error(hand, errstr);\n        virJSONValueFree(parser.head);\n        goto cleanup;\n    }\n\n    if (parser.nstate != 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot parse json %s: unterminated string/map/array\"),\n                       jsonstring);\n        virJSONValueFree(parser.head);\n    } else {\n        ret = parser.head;\n    }\n\n cleanup:\n    yajl_free(hand);\n\n    if (parser.nstate) {\n        size_t i;\n        for (i = 0; i < parser.nstate; i++)\n            VIR_FREE(parser.state[i].key);\n        VIR_FREE(parser.state);\n    }\n\n    VIR_DEBUG(\"result=%p\", ret);\n\n    return ret;\n}"
  },
  {
    "function_name": "virJSONParserHandleEndArray",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1787-1807",
    "snippet": "static int\nvirJSONParserHandleEndArray(void *ctx)\n{\n    virJSONParserPtr parser = ctx;\n    virJSONParserStatePtr state;\n\n    VIR_DEBUG(\"parser=%p\", parser);\n\n    if (!(parser->nstate - parser->wrap))\n        return 0;\n\n    state = &(parser->state[parser->nstate-1]);\n    if (state->key) {\n        VIR_FREE(state->key);\n        return 0;\n    }\n\n    VIR_DELETE_ELEMENT(parser->state, parser->nstate - 1, parser->nstate);\n\n    return 1;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DELETE_ELEMENT",
          "args": [
            "parser->state",
            "parser->nstate - 1",
            "parser->nstate"
          ],
          "line": 1804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "state->key"
          ],
          "line": 1800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"parser=%p\"",
            "parser"
          ],
          "line": 1793
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONParserHandleEndArray(void *ctx)\n{\n    virJSONParserPtr parser = ctx;\n    virJSONParserStatePtr state;\n\n    VIR_DEBUG(\"parser=%p\", parser);\n\n    if (!(parser->nstate - parser->wrap))\n        return 0;\n\n    state = &(parser->state[parser->nstate-1]);\n    if (state->key) {\n        VIR_FREE(state->key);\n        return 0;\n    }\n\n    VIR_DELETE_ELEMENT(parser->state, parser->nstate - 1, parser->nstate);\n\n    return 1;\n}"
  },
  {
    "function_name": "virJSONParserHandleStartArray",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1762-1784",
    "snippet": "static int\nvirJSONParserHandleStartArray(void *ctx)\n{\n    virJSONParserPtr parser = ctx;\n    virJSONValuePtr value = virJSONValueNewArray();\n\n    VIR_DEBUG(\"parser=%p\", parser);\n\n    if (virJSONParserInsertValue(parser, value) < 0) {\n        virJSONValueFree(value);\n        return 0;\n    }\n\n    if (VIR_REALLOC_N(parser->state,\n                      parser->nstate + 1) < 0)\n        return 0;\n\n    parser->state[parser->nstate].value = value;\n    parser->state[parser->nstate].key = NULL;\n    parser->nstate++;\n\n    return 1;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "parser->state",
            "parser->nstate + 1"
          ],
          "line": 1775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "value"
          ],
          "line": 1771
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONParserInsertValue",
          "args": [
            "parser",
            "value"
          ],
          "line": 1770
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONParserInsertValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1550-1598",
          "snippet": "static int\nvirJSONParserInsertValue(virJSONParserPtr parser,\n                         virJSONValuePtr value)\n{\n    if (!parser->head) {\n        parser->head = value;\n    } else {\n        virJSONParserStatePtr state;\n        if (!parser->nstate) {\n            VIR_DEBUG(\"got a value to insert without a container\");\n            return -1;\n        }\n\n        state = &parser->state[parser->nstate-1];\n\n        switch (state->value->type) {\n        case VIR_JSON_TYPE_OBJECT: {\n            if (!state->key) {\n                VIR_DEBUG(\"missing key when inserting object value\");\n                return -1;\n            }\n\n            if (virJSONValueObjectAppend(state->value,\n                                         state->key,\n                                         value) < 0)\n                return -1;\n\n            VIR_FREE(state->key);\n        }   break;\n\n        case VIR_JSON_TYPE_ARRAY: {\n            if (state->key) {\n                VIR_DEBUG(\"unexpected key when inserting array value\");\n                return -1;\n            }\n\n            if (virJSONValueArrayAppend(state->value,\n                                        value) < 0)\n                return -1;\n        }   break;\n\n        default:\n            VIR_DEBUG(\"unexpected value type, not a container\");\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONParserInsertValue(virJSONParserPtr parser,\n                         virJSONValuePtr value)\n{\n    if (!parser->head) {\n        parser->head = value;\n    } else {\n        virJSONParserStatePtr state;\n        if (!parser->nstate) {\n            VIR_DEBUG(\"got a value to insert without a container\");\n            return -1;\n        }\n\n        state = &parser->state[parser->nstate-1];\n\n        switch (state->value->type) {\n        case VIR_JSON_TYPE_OBJECT: {\n            if (!state->key) {\n                VIR_DEBUG(\"missing key when inserting object value\");\n                return -1;\n            }\n\n            if (virJSONValueObjectAppend(state->value,\n                                         state->key,\n                                         value) < 0)\n                return -1;\n\n            VIR_FREE(state->key);\n        }   break;\n\n        case VIR_JSON_TYPE_ARRAY: {\n            if (state->key) {\n                VIR_DEBUG(\"unexpected key when inserting array value\");\n                return -1;\n            }\n\n            if (virJSONValueArrayAppend(state->value,\n                                        value) < 0)\n                return -1;\n        }   break;\n\n        default:\n            VIR_DEBUG(\"unexpected value type, not a container\");\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"parser=%p\"",
            "parser"
          ],
          "line": 1768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueNewArray",
          "args": [],
          "line": 1766
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "560-568",
          "snippet": "virJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONParserHandleStartArray(void *ctx)\n{\n    virJSONParserPtr parser = ctx;\n    virJSONValuePtr value = virJSONValueNewArray();\n\n    VIR_DEBUG(\"parser=%p\", parser);\n\n    if (virJSONParserInsertValue(parser, value) < 0) {\n        virJSONValueFree(value);\n        return 0;\n    }\n\n    if (VIR_REALLOC_N(parser->state,\n                      parser->nstate + 1) < 0)\n        return 0;\n\n    parser->state[parser->nstate].value = value;\n    parser->state[parser->nstate].key = NULL;\n    parser->nstate++;\n\n    return 1;\n}"
  },
  {
    "function_name": "virJSONParserHandleEndMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1739-1759",
    "snippet": "static int\nvirJSONParserHandleEndMap(void *ctx)\n{\n    virJSONParserPtr parser = ctx;\n    virJSONParserStatePtr state;\n\n    VIR_DEBUG(\"parser=%p\", parser);\n\n    if (!parser->nstate)\n        return 0;\n\n    state = &(parser->state[parser->nstate-1]);\n    if (state->key) {\n        VIR_FREE(state->key);\n        return 0;\n    }\n\n    VIR_DELETE_ELEMENT(parser->state, parser->nstate - 1, parser->nstate);\n\n    return 1;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DELETE_ELEMENT",
          "args": [
            "parser->state",
            "parser->nstate - 1",
            "parser->nstate"
          ],
          "line": 1756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "state->key"
          ],
          "line": 1752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"parser=%p\"",
            "parser"
          ],
          "line": 1745
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONParserHandleEndMap(void *ctx)\n{\n    virJSONParserPtr parser = ctx;\n    virJSONParserStatePtr state;\n\n    VIR_DEBUG(\"parser=%p\", parser);\n\n    if (!parser->nstate)\n        return 0;\n\n    state = &(parser->state[parser->nstate-1]);\n    if (state->key) {\n        VIR_FREE(state->key);\n        return 0;\n    }\n\n    VIR_DELETE_ELEMENT(parser->state, parser->nstate - 1, parser->nstate);\n\n    return 1;\n}"
  },
  {
    "function_name": "virJSONParserHandleStartMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1713-1736",
    "snippet": "static int\nvirJSONParserHandleStartMap(void *ctx)\n{\n    virJSONParserPtr parser = ctx;\n    virJSONValuePtr value = virJSONValueNewObject();\n\n    VIR_DEBUG(\"parser=%p\", parser);\n\n    if (virJSONParserInsertValue(parser, value) < 0) {\n        virJSONValueFree(value);\n        return 0;\n    }\n\n    if (VIR_REALLOC_N(parser->state,\n                      parser->nstate + 1) < 0) {\n        return 0;\n    }\n\n    parser->state[parser->nstate].value = value;\n    parser->state[parser->nstate].key = NULL;\n    parser->nstate++;\n\n    return 1;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "parser->state",
            "parser->nstate + 1"
          ],
          "line": 1726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "value"
          ],
          "line": 1722
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONParserInsertValue",
          "args": [
            "parser",
            "value"
          ],
          "line": 1721
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONParserInsertValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1550-1598",
          "snippet": "static int\nvirJSONParserInsertValue(virJSONParserPtr parser,\n                         virJSONValuePtr value)\n{\n    if (!parser->head) {\n        parser->head = value;\n    } else {\n        virJSONParserStatePtr state;\n        if (!parser->nstate) {\n            VIR_DEBUG(\"got a value to insert without a container\");\n            return -1;\n        }\n\n        state = &parser->state[parser->nstate-1];\n\n        switch (state->value->type) {\n        case VIR_JSON_TYPE_OBJECT: {\n            if (!state->key) {\n                VIR_DEBUG(\"missing key when inserting object value\");\n                return -1;\n            }\n\n            if (virJSONValueObjectAppend(state->value,\n                                         state->key,\n                                         value) < 0)\n                return -1;\n\n            VIR_FREE(state->key);\n        }   break;\n\n        case VIR_JSON_TYPE_ARRAY: {\n            if (state->key) {\n                VIR_DEBUG(\"unexpected key when inserting array value\");\n                return -1;\n            }\n\n            if (virJSONValueArrayAppend(state->value,\n                                        value) < 0)\n                return -1;\n        }   break;\n\n        default:\n            VIR_DEBUG(\"unexpected value type, not a container\");\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONParserInsertValue(virJSONParserPtr parser,\n                         virJSONValuePtr value)\n{\n    if (!parser->head) {\n        parser->head = value;\n    } else {\n        virJSONParserStatePtr state;\n        if (!parser->nstate) {\n            VIR_DEBUG(\"got a value to insert without a container\");\n            return -1;\n        }\n\n        state = &parser->state[parser->nstate-1];\n\n        switch (state->value->type) {\n        case VIR_JSON_TYPE_OBJECT: {\n            if (!state->key) {\n                VIR_DEBUG(\"missing key when inserting object value\");\n                return -1;\n            }\n\n            if (virJSONValueObjectAppend(state->value,\n                                         state->key,\n                                         value) < 0)\n                return -1;\n\n            VIR_FREE(state->key);\n        }   break;\n\n        case VIR_JSON_TYPE_ARRAY: {\n            if (state->key) {\n                VIR_DEBUG(\"unexpected key when inserting array value\");\n                return -1;\n            }\n\n            if (virJSONValueArrayAppend(state->value,\n                                        value) < 0)\n                return -1;\n        }   break;\n\n        default:\n            VIR_DEBUG(\"unexpected value type, not a container\");\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"parser=%p\"",
            "parser"
          ],
          "line": 1719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueNewObject",
          "args": [],
          "line": 1717
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "571-579",
          "snippet": "virJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONParserHandleStartMap(void *ctx)\n{\n    virJSONParserPtr parser = ctx;\n    virJSONValuePtr value = virJSONValueNewObject();\n\n    VIR_DEBUG(\"parser=%p\", parser);\n\n    if (virJSONParserInsertValue(parser, value) < 0) {\n        virJSONValueFree(value);\n        return 0;\n    }\n\n    if (VIR_REALLOC_N(parser->state,\n                      parser->nstate + 1) < 0) {\n        return 0;\n    }\n\n    parser->state[parser->nstate].value = value;\n    parser->state[parser->nstate].key = NULL;\n    parser->nstate++;\n\n    return 1;\n}"
  },
  {
    "function_name": "virJSONParserHandleMapKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1692-1710",
    "snippet": "static int\nvirJSONParserHandleMapKey(void *ctx,\n                          const unsigned char *stringVal,\n                          size_t stringLen)\n{\n    virJSONParserPtr parser = ctx;\n    virJSONParserStatePtr state;\n\n    VIR_DEBUG(\"parser=%p key=%p\", parser, (const char *)stringVal);\n\n    if (!parser->nstate)\n        return 0;\n\n    state = &parser->state[parser->nstate-1];\n    if (state->key)\n        return 0;\n    state->key = g_strndup((const char *)stringVal, stringLen);\n    return 1;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "(const char *)stringVal",
            "stringLen"
          ],
          "line": 1708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"parser=%p key=%p\"",
            "parser",
            "(const char *)stringVal"
          ],
          "line": 1700
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONParserHandleMapKey(void *ctx,\n                          const unsigned char *stringVal,\n                          size_t stringLen)\n{\n    virJSONParserPtr parser = ctx;\n    virJSONParserStatePtr state;\n\n    VIR_DEBUG(\"parser=%p key=%p\", parser, (const char *)stringVal);\n\n    if (!parser->nstate)\n        return 0;\n\n    state = &parser->state[parser->nstate-1];\n    if (state->key)\n        return 0;\n    state->key = g_strndup((const char *)stringVal, stringLen);\n    return 1;\n}"
  },
  {
    "function_name": "virJSONParserHandleString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1669-1689",
    "snippet": "static int\nvirJSONParserHandleString(void *ctx,\n                          const unsigned char *stringVal,\n                          size_t stringLen)\n{\n    virJSONParserPtr parser = ctx;\n    virJSONValuePtr value = virJSONValueNewStringLen((const char *)stringVal,\n                                                     stringLen);\n\n    VIR_DEBUG(\"parser=%p str=%p\", parser, (const char *)stringVal);\n\n    if (!value)\n        return 0;\n\n    if (virJSONParserInsertValue(parser, value) < 0) {\n        virJSONValueFree(value);\n        return 0;\n    }\n\n    return 1;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "value"
          ],
          "line": 1684
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONParserInsertValue",
          "args": [
            "parser",
            "value"
          ],
          "line": 1683
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONParserInsertValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1550-1598",
          "snippet": "static int\nvirJSONParserInsertValue(virJSONParserPtr parser,\n                         virJSONValuePtr value)\n{\n    if (!parser->head) {\n        parser->head = value;\n    } else {\n        virJSONParserStatePtr state;\n        if (!parser->nstate) {\n            VIR_DEBUG(\"got a value to insert without a container\");\n            return -1;\n        }\n\n        state = &parser->state[parser->nstate-1];\n\n        switch (state->value->type) {\n        case VIR_JSON_TYPE_OBJECT: {\n            if (!state->key) {\n                VIR_DEBUG(\"missing key when inserting object value\");\n                return -1;\n            }\n\n            if (virJSONValueObjectAppend(state->value,\n                                         state->key,\n                                         value) < 0)\n                return -1;\n\n            VIR_FREE(state->key);\n        }   break;\n\n        case VIR_JSON_TYPE_ARRAY: {\n            if (state->key) {\n                VIR_DEBUG(\"unexpected key when inserting array value\");\n                return -1;\n            }\n\n            if (virJSONValueArrayAppend(state->value,\n                                        value) < 0)\n                return -1;\n        }   break;\n\n        default:\n            VIR_DEBUG(\"unexpected value type, not a container\");\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONParserInsertValue(virJSONParserPtr parser,\n                         virJSONValuePtr value)\n{\n    if (!parser->head) {\n        parser->head = value;\n    } else {\n        virJSONParserStatePtr state;\n        if (!parser->nstate) {\n            VIR_DEBUG(\"got a value to insert without a container\");\n            return -1;\n        }\n\n        state = &parser->state[parser->nstate-1];\n\n        switch (state->value->type) {\n        case VIR_JSON_TYPE_OBJECT: {\n            if (!state->key) {\n                VIR_DEBUG(\"missing key when inserting object value\");\n                return -1;\n            }\n\n            if (virJSONValueObjectAppend(state->value,\n                                         state->key,\n                                         value) < 0)\n                return -1;\n\n            VIR_FREE(state->key);\n        }   break;\n\n        case VIR_JSON_TYPE_ARRAY: {\n            if (state->key) {\n                VIR_DEBUG(\"unexpected key when inserting array value\");\n                return -1;\n            }\n\n            if (virJSONValueArrayAppend(state->value,\n                                        value) < 0)\n                return -1;\n        }   break;\n\n        default:\n            VIR_DEBUG(\"unexpected value type, not a container\");\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"parser=%p str=%p\"",
            "parser",
            "(const char *)stringVal"
          ],
          "line": 1678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueNewStringLen",
          "args": [
            "(const char *)stringVal",
            "stringLen"
          ],
          "line": 1675
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewStringLen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "451-467",
          "snippet": "virJSONValuePtr\nvirJSONValueNewStringLen(const char *data,\n                         size_t length)\n{\n    virJSONValuePtr val;\n\n    if (!data)\n        return virJSONValueNewNull();\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_STRING;\n    val->data.string = g_strndup(data, length);\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewStringLen(const char *data,\n                         size_t length)\n{\n    virJSONValuePtr val;\n\n    if (!data)\n        return virJSONValueNewNull();\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_STRING;\n    val->data.string = g_strndup(data, length);\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONParserHandleString(void *ctx,\n                          const unsigned char *stringVal,\n                          size_t stringLen)\n{\n    virJSONParserPtr parser = ctx;\n    virJSONValuePtr value = virJSONValueNewStringLen((const char *)stringVal,\n                                                     stringLen);\n\n    VIR_DEBUG(\"parser=%p str=%p\", parser, (const char *)stringVal);\n\n    if (!value)\n        return 0;\n\n    if (virJSONParserInsertValue(parser, value) < 0) {\n        virJSONValueFree(value);\n        return 0;\n    }\n\n    return 1;\n}"
  },
  {
    "function_name": "virJSONParserHandleNumber",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1642-1666",
    "snippet": "static int\nvirJSONParserHandleNumber(void *ctx,\n                          const char *s,\n                          size_t l)\n{\n    virJSONParserPtr parser = ctx;\n    char *str;\n    virJSONValuePtr value;\n\n    str = g_strndup(s, l);\n    value = virJSONValueNewNumber(str);\n    VIR_FREE(str);\n\n    VIR_DEBUG(\"parser=%p str=%s\", parser, str);\n\n    if (!value)\n        return 0;\n\n    if (virJSONParserInsertValue(parser, value) < 0) {\n        virJSONValueFree(value);\n        return 0;\n    }\n\n    return 1;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "value"
          ],
          "line": 1661
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONParserInsertValue",
          "args": [
            "parser",
            "value"
          ],
          "line": 1660
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONParserInsertValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1550-1598",
          "snippet": "static int\nvirJSONParserInsertValue(virJSONParserPtr parser,\n                         virJSONValuePtr value)\n{\n    if (!parser->head) {\n        parser->head = value;\n    } else {\n        virJSONParserStatePtr state;\n        if (!parser->nstate) {\n            VIR_DEBUG(\"got a value to insert without a container\");\n            return -1;\n        }\n\n        state = &parser->state[parser->nstate-1];\n\n        switch (state->value->type) {\n        case VIR_JSON_TYPE_OBJECT: {\n            if (!state->key) {\n                VIR_DEBUG(\"missing key when inserting object value\");\n                return -1;\n            }\n\n            if (virJSONValueObjectAppend(state->value,\n                                         state->key,\n                                         value) < 0)\n                return -1;\n\n            VIR_FREE(state->key);\n        }   break;\n\n        case VIR_JSON_TYPE_ARRAY: {\n            if (state->key) {\n                VIR_DEBUG(\"unexpected key when inserting array value\");\n                return -1;\n            }\n\n            if (virJSONValueArrayAppend(state->value,\n                                        value) < 0)\n                return -1;\n        }   break;\n\n        default:\n            VIR_DEBUG(\"unexpected value type, not a container\");\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONParserInsertValue(virJSONParserPtr parser,\n                         virJSONValuePtr value)\n{\n    if (!parser->head) {\n        parser->head = value;\n    } else {\n        virJSONParserStatePtr state;\n        if (!parser->nstate) {\n            VIR_DEBUG(\"got a value to insert without a container\");\n            return -1;\n        }\n\n        state = &parser->state[parser->nstate-1];\n\n        switch (state->value->type) {\n        case VIR_JSON_TYPE_OBJECT: {\n            if (!state->key) {\n                VIR_DEBUG(\"missing key when inserting object value\");\n                return -1;\n            }\n\n            if (virJSONValueObjectAppend(state->value,\n                                         state->key,\n                                         value) < 0)\n                return -1;\n\n            VIR_FREE(state->key);\n        }   break;\n\n        case VIR_JSON_TYPE_ARRAY: {\n            if (state->key) {\n                VIR_DEBUG(\"unexpected key when inserting array value\");\n                return -1;\n            }\n\n            if (virJSONValueArrayAppend(state->value,\n                                        value) < 0)\n                return -1;\n        }   break;\n\n        default:\n            VIR_DEBUG(\"unexpected value type, not a container\");\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"parser=%p str=%s\"",
            "parser",
            "str"
          ],
          "line": 1655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "str"
          ],
          "line": 1653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueNewNumber",
          "args": [
            "str"
          ],
          "line": 1652
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNumberDouble",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "521-528",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNumberDouble(double data)\n{\n    g_autofree char *str = NULL;\n    if (virDoubleToStr(&str, data) < 0)\n        return NULL;\n    return virJSONValueNewNumber(str);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNumberDouble(double data)\n{\n    g_autofree char *str = NULL;\n    if (virDoubleToStr(&str, data) < 0)\n        return NULL;\n    return virJSONValueNewNumber(str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "s",
            "l"
          ],
          "line": 1651
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONParserHandleNumber(void *ctx,\n                          const char *s,\n                          size_t l)\n{\n    virJSONParserPtr parser = ctx;\n    char *str;\n    virJSONValuePtr value;\n\n    str = g_strndup(s, l);\n    value = virJSONValueNewNumber(str);\n    VIR_FREE(str);\n\n    VIR_DEBUG(\"parser=%p str=%s\", parser, str);\n\n    if (!value)\n        return 0;\n\n    if (virJSONParserInsertValue(parser, value) < 0) {\n        virJSONValueFree(value);\n        return 0;\n    }\n\n    return 1;\n}"
  },
  {
    "function_name": "virJSONParserHandleBoolean",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1621-1639",
    "snippet": "static int\nvirJSONParserHandleBoolean(void *ctx,\n                           int boolean_)\n{\n    virJSONParserPtr parser = ctx;\n    virJSONValuePtr value = virJSONValueNewBoolean(boolean_);\n\n    VIR_DEBUG(\"parser=%p boolean=%d\", parser, boolean_);\n\n    if (!value)\n        return 0;\n\n    if (virJSONParserInsertValue(parser, value) < 0) {\n        virJSONValueFree(value);\n        return 0;\n    }\n\n    return 1;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "value"
          ],
          "line": 1634
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONParserInsertValue",
          "args": [
            "parser",
            "value"
          ],
          "line": 1633
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONParserInsertValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1550-1598",
          "snippet": "static int\nvirJSONParserInsertValue(virJSONParserPtr parser,\n                         virJSONValuePtr value)\n{\n    if (!parser->head) {\n        parser->head = value;\n    } else {\n        virJSONParserStatePtr state;\n        if (!parser->nstate) {\n            VIR_DEBUG(\"got a value to insert without a container\");\n            return -1;\n        }\n\n        state = &parser->state[parser->nstate-1];\n\n        switch (state->value->type) {\n        case VIR_JSON_TYPE_OBJECT: {\n            if (!state->key) {\n                VIR_DEBUG(\"missing key when inserting object value\");\n                return -1;\n            }\n\n            if (virJSONValueObjectAppend(state->value,\n                                         state->key,\n                                         value) < 0)\n                return -1;\n\n            VIR_FREE(state->key);\n        }   break;\n\n        case VIR_JSON_TYPE_ARRAY: {\n            if (state->key) {\n                VIR_DEBUG(\"unexpected key when inserting array value\");\n                return -1;\n            }\n\n            if (virJSONValueArrayAppend(state->value,\n                                        value) < 0)\n                return -1;\n        }   break;\n\n        default:\n            VIR_DEBUG(\"unexpected value type, not a container\");\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONParserInsertValue(virJSONParserPtr parser,\n                         virJSONValuePtr value)\n{\n    if (!parser->head) {\n        parser->head = value;\n    } else {\n        virJSONParserStatePtr state;\n        if (!parser->nstate) {\n            VIR_DEBUG(\"got a value to insert without a container\");\n            return -1;\n        }\n\n        state = &parser->state[parser->nstate-1];\n\n        switch (state->value->type) {\n        case VIR_JSON_TYPE_OBJECT: {\n            if (!state->key) {\n                VIR_DEBUG(\"missing key when inserting object value\");\n                return -1;\n            }\n\n            if (virJSONValueObjectAppend(state->value,\n                                         state->key,\n                                         value) < 0)\n                return -1;\n\n            VIR_FREE(state->key);\n        }   break;\n\n        case VIR_JSON_TYPE_ARRAY: {\n            if (state->key) {\n                VIR_DEBUG(\"unexpected key when inserting array value\");\n                return -1;\n            }\n\n            if (virJSONValueArrayAppend(state->value,\n                                        value) < 0)\n                return -1;\n        }   break;\n\n        default:\n            VIR_DEBUG(\"unexpected value type, not a container\");\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"parser=%p boolean=%d\"",
            "parser",
            "boolean_"
          ],
          "line": 1628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueNewBoolean",
          "args": [
            "boolean_"
          ],
          "line": 1626
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "531-543",
          "snippet": "virJSONValuePtr\nvirJSONValueNewBoolean(int boolean_)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_BOOLEAN;\n    val->data.boolean = boolean_;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewBoolean(int boolean_)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_BOOLEAN;\n    val->data.boolean = boolean_;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONParserHandleBoolean(void *ctx,\n                           int boolean_)\n{\n    virJSONParserPtr parser = ctx;\n    virJSONValuePtr value = virJSONValueNewBoolean(boolean_);\n\n    VIR_DEBUG(\"parser=%p boolean=%d\", parser, boolean_);\n\n    if (!value)\n        return 0;\n\n    if (virJSONParserInsertValue(parser, value) < 0) {\n        virJSONValueFree(value);\n        return 0;\n    }\n\n    return 1;\n}"
  },
  {
    "function_name": "virJSONParserHandleNull",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1601-1618",
    "snippet": "static int\nvirJSONParserHandleNull(void *ctx)\n{\n    virJSONParserPtr parser = ctx;\n    virJSONValuePtr value = virJSONValueNewNull();\n\n    VIR_DEBUG(\"parser=%p\", parser);\n\n    if (!value)\n        return 0;\n\n    if (virJSONParserInsertValue(parser, value) < 0) {\n        virJSONValueFree(value);\n        return 0;\n    }\n\n    return 1;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "value"
          ],
          "line": 1613
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONParserInsertValue",
          "args": [
            "parser",
            "value"
          ],
          "line": 1612
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONParserInsertValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1550-1598",
          "snippet": "static int\nvirJSONParserInsertValue(virJSONParserPtr parser,\n                         virJSONValuePtr value)\n{\n    if (!parser->head) {\n        parser->head = value;\n    } else {\n        virJSONParserStatePtr state;\n        if (!parser->nstate) {\n            VIR_DEBUG(\"got a value to insert without a container\");\n            return -1;\n        }\n\n        state = &parser->state[parser->nstate-1];\n\n        switch (state->value->type) {\n        case VIR_JSON_TYPE_OBJECT: {\n            if (!state->key) {\n                VIR_DEBUG(\"missing key when inserting object value\");\n                return -1;\n            }\n\n            if (virJSONValueObjectAppend(state->value,\n                                         state->key,\n                                         value) < 0)\n                return -1;\n\n            VIR_FREE(state->key);\n        }   break;\n\n        case VIR_JSON_TYPE_ARRAY: {\n            if (state->key) {\n                VIR_DEBUG(\"unexpected key when inserting array value\");\n                return -1;\n            }\n\n            if (virJSONValueArrayAppend(state->value,\n                                        value) < 0)\n                return -1;\n        }   break;\n\n        default:\n            VIR_DEBUG(\"unexpected value type, not a container\");\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONParserInsertValue(virJSONParserPtr parser,\n                         virJSONValuePtr value)\n{\n    if (!parser->head) {\n        parser->head = value;\n    } else {\n        virJSONParserStatePtr state;\n        if (!parser->nstate) {\n            VIR_DEBUG(\"got a value to insert without a container\");\n            return -1;\n        }\n\n        state = &parser->state[parser->nstate-1];\n\n        switch (state->value->type) {\n        case VIR_JSON_TYPE_OBJECT: {\n            if (!state->key) {\n                VIR_DEBUG(\"missing key when inserting object value\");\n                return -1;\n            }\n\n            if (virJSONValueObjectAppend(state->value,\n                                         state->key,\n                                         value) < 0)\n                return -1;\n\n            VIR_FREE(state->key);\n        }   break;\n\n        case VIR_JSON_TYPE_ARRAY: {\n            if (state->key) {\n                VIR_DEBUG(\"unexpected key when inserting array value\");\n                return -1;\n            }\n\n            if (virJSONValueArrayAppend(state->value,\n                                        value) < 0)\n                return -1;\n        }   break;\n\n        default:\n            VIR_DEBUG(\"unexpected value type, not a container\");\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"parser=%p\"",
            "parser"
          ],
          "line": 1607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueNewNull",
          "args": [],
          "line": 1605
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "546-557",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNull(void)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_NULL;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNull(void)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_NULL;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONParserHandleNull(void *ctx)\n{\n    virJSONParserPtr parser = ctx;\n    virJSONValuePtr value = virJSONValueNewNull();\n\n    VIR_DEBUG(\"parser=%p\", parser);\n\n    if (!value)\n        return 0;\n\n    if (virJSONParserInsertValue(parser, value) < 0) {\n        virJSONValueFree(value);\n        return 0;\n    }\n\n    return 1;\n}"
  },
  {
    "function_name": "virJSONParserInsertValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1550-1598",
    "snippet": "static int\nvirJSONParserInsertValue(virJSONParserPtr parser,\n                         virJSONValuePtr value)\n{\n    if (!parser->head) {\n        parser->head = value;\n    } else {\n        virJSONParserStatePtr state;\n        if (!parser->nstate) {\n            VIR_DEBUG(\"got a value to insert without a container\");\n            return -1;\n        }\n\n        state = &parser->state[parser->nstate-1];\n\n        switch (state->value->type) {\n        case VIR_JSON_TYPE_OBJECT: {\n            if (!state->key) {\n                VIR_DEBUG(\"missing key when inserting object value\");\n                return -1;\n            }\n\n            if (virJSONValueObjectAppend(state->value,\n                                         state->key,\n                                         value) < 0)\n                return -1;\n\n            VIR_FREE(state->key);\n        }   break;\n\n        case VIR_JSON_TYPE_ARRAY: {\n            if (state->key) {\n                VIR_DEBUG(\"unexpected key when inserting array value\");\n                return -1;\n            }\n\n            if (virJSONValueArrayAppend(state->value,\n                                        value) < 0)\n                return -1;\n        }   break;\n\n        default:\n            VIR_DEBUG(\"unexpected value type, not a container\");\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"unexpected value type, not a container\""
          ],
          "line": 1592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayAppend",
          "args": [
            "state->value",
            "value"
          ],
          "line": 1586
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayAppendString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "792-804",
          "snippet": "int\nvirJSONValueArrayAppendString(virJSONValuePtr object,\n                              const char *value)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueArrayAppend(object, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueArrayAppendString(virJSONValuePtr object,\n                              const char *value)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueArrayAppend(object, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"unexpected key when inserting array value\""
          ],
          "line": 1582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "state->key"
          ],
          "line": 1577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppend",
          "args": [
            "state->value",
            "state->key",
            "value"
          ],
          "line": 1572
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "741-754",
          "snippet": "int\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"missing key when inserting object value\""
          ],
          "line": 1568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"got a value to insert without a container\""
          ],
          "line": 1559
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONParserInsertValue(virJSONParserPtr parser,\n                         virJSONValuePtr value)\n{\n    if (!parser->head) {\n        parser->head = value;\n    } else {\n        virJSONParserStatePtr state;\n        if (!parser->nstate) {\n            VIR_DEBUG(\"got a value to insert without a container\");\n            return -1;\n        }\n\n        state = &parser->state[parser->nstate-1];\n\n        switch (state->value->type) {\n        case VIR_JSON_TYPE_OBJECT: {\n            if (!state->key) {\n                VIR_DEBUG(\"missing key when inserting object value\");\n                return -1;\n            }\n\n            if (virJSONValueObjectAppend(state->value,\n                                         state->key,\n                                         value) < 0)\n                return -1;\n\n            VIR_FREE(state->key);\n        }   break;\n\n        case VIR_JSON_TYPE_ARRAY: {\n            if (state->key) {\n                VIR_DEBUG(\"unexpected key when inserting array value\");\n                return -1;\n            }\n\n            if (virJSONValueArrayAppend(state->value,\n                                        value) < 0)\n                return -1;\n        }   break;\n\n        default:\n            VIR_DEBUG(\"unexpected value type, not a container\");\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1490-1546",
    "snippet": "virJSONValuePtr\nvirJSONValueCopy(const virJSONValue *in)\n{\n    size_t i;\n    virJSONValuePtr out = NULL;\n\n    if (!in)\n        return NULL;\n\n    switch ((virJSONType) in->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        out = virJSONValueNewObject();\n        for (i = 0; i < in->data.object.npairs; i++) {\n            virJSONValuePtr val = NULL;\n            if (!(val = virJSONValueCopy(in->data.object.pairs[i].value)))\n                goto error;\n            if (virJSONValueObjectAppend(out, in->data.object.pairs[i].key,\n                                         val) < 0) {\n                virJSONValueFree(val);\n                goto error;\n            }\n        }\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        out = virJSONValueNewArray();\n        for (i = 0; i < in->data.array.nvalues; i++) {\n            virJSONValuePtr val = NULL;\n            if (!(val = virJSONValueCopy(in->data.array.values[i])))\n                goto error;\n            if (virJSONValueArrayAppend(out, val) < 0) {\n                virJSONValueFree(val);\n                goto error;\n            }\n        }\n        break;\n\n    /* No need to error out in the following cases */\n    case VIR_JSON_TYPE_STRING:\n        out = virJSONValueNewString(in->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        out = virJSONValueNewNumber(in->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n        out = virJSONValueNewBoolean(in->data.boolean);\n        break;\n    case VIR_JSON_TYPE_NULL:\n        out = virJSONValueNewNull();\n        break;\n    }\n\n    return out;\n\n error:\n    virJSONValueFree(out);\n    return NULL;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "out"
          ],
          "line": 1544
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewNull",
          "args": [],
          "line": 1537
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "546-557",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNull(void)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_NULL;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNull(void)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_NULL;\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewBoolean",
          "args": [
            "in->data.boolean"
          ],
          "line": 1534
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "531-543",
          "snippet": "virJSONValuePtr\nvirJSONValueNewBoolean(int boolean_)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_BOOLEAN;\n    val->data.boolean = boolean_;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewBoolean(int boolean_)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_BOOLEAN;\n    val->data.boolean = boolean_;\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewNumber",
          "args": [
            "in->data.number"
          ],
          "line": 1531
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNumberDouble",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "521-528",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNumberDouble(double data)\n{\n    g_autofree char *str = NULL;\n    if (virDoubleToStr(&str, data) < 0)\n        return NULL;\n    return virJSONValueNewNumber(str);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNumberDouble(double data)\n{\n    g_autofree char *str = NULL;\n    if (virDoubleToStr(&str, data) < 0)\n        return NULL;\n    return virJSONValueNewNumber(str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewString",
          "args": [
            "in->data.string"
          ],
          "line": 1528
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "433-448",
          "snippet": "virJSONValuePtr\nvirJSONValueNewString(const char *data)\n{\n    virJSONValuePtr val;\n\n    if (!data)\n        return virJSONValueNewNull();\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_STRING;\n    val->data.string = g_strdup(data);\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewString(const char *data)\n{\n    virJSONValuePtr val;\n\n    if (!data)\n        return virJSONValueNewNull();\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_STRING;\n    val->data.string = g_strdup(data);\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayAppend",
          "args": [
            "out",
            "val"
          ],
          "line": 1519
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayAppendString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "792-804",
          "snippet": "int\nvirJSONValueArrayAppendString(virJSONValuePtr object,\n                              const char *value)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueArrayAppend(object, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueArrayAppendString(virJSONValuePtr object,\n                              const char *value)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueArrayAppend(object, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueCopy",
          "args": [
            "in->data.array.values[i]"
          ],
          "line": 1517
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1490-1546",
          "snippet": "virJSONValuePtr\nvirJSONValueCopy(const virJSONValue *in)\n{\n    size_t i;\n    virJSONValuePtr out = NULL;\n\n    if (!in)\n        return NULL;\n\n    switch ((virJSONType) in->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        out = virJSONValueNewObject();\n        for (i = 0; i < in->data.object.npairs; i++) {\n            virJSONValuePtr val = NULL;\n            if (!(val = virJSONValueCopy(in->data.object.pairs[i].value)))\n                goto error;\n            if (virJSONValueObjectAppend(out, in->data.object.pairs[i].key,\n                                         val) < 0) {\n                virJSONValueFree(val);\n                goto error;\n            }\n        }\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        out = virJSONValueNewArray();\n        for (i = 0; i < in->data.array.nvalues; i++) {\n            virJSONValuePtr val = NULL;\n            if (!(val = virJSONValueCopy(in->data.array.values[i])))\n                goto error;\n            if (virJSONValueArrayAppend(out, val) < 0) {\n                virJSONValueFree(val);\n                goto error;\n            }\n        }\n        break;\n\n    /* No need to error out in the following cases */\n    case VIR_JSON_TYPE_STRING:\n        out = virJSONValueNewString(in->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        out = virJSONValueNewNumber(in->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n        out = virJSONValueNewBoolean(in->data.boolean);\n        break;\n    case VIR_JSON_TYPE_NULL:\n        out = virJSONValueNewNull();\n        break;\n    }\n\n    return out;\n\n error:\n    virJSONValueFree(out);\n    return NULL;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewArray",
          "args": [],
          "line": 1514
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "560-568",
          "snippet": "virJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppend",
          "args": [
            "out",
            "in->data.object.pairs[i].key",
            "val"
          ],
          "line": 1506
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "741-754",
          "snippet": "int\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewObject",
          "args": [],
          "line": 1501
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "571-579",
          "snippet": "virJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueCopy(const virJSONValue *in)\n{\n    size_t i;\n    virJSONValuePtr out = NULL;\n\n    if (!in)\n        return NULL;\n\n    switch ((virJSONType) in->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        out = virJSONValueNewObject();\n        for (i = 0; i < in->data.object.npairs; i++) {\n            virJSONValuePtr val = NULL;\n            if (!(val = virJSONValueCopy(in->data.object.pairs[i].value)))\n                goto error;\n            if (virJSONValueObjectAppend(out, in->data.object.pairs[i].key,\n                                         val) < 0) {\n                virJSONValueFree(val);\n                goto error;\n            }\n        }\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        out = virJSONValueNewArray();\n        for (i = 0; i < in->data.array.nvalues; i++) {\n            virJSONValuePtr val = NULL;\n            if (!(val = virJSONValueCopy(in->data.array.values[i])))\n                goto error;\n            if (virJSONValueArrayAppend(out, val) < 0) {\n                virJSONValueFree(val);\n                goto error;\n            }\n        }\n        break;\n\n    /* No need to error out in the following cases */\n    case VIR_JSON_TYPE_STRING:\n        out = virJSONValueNewString(in->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        out = virJSONValueNewNumber(in->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n        out = virJSONValueNewBoolean(in->data.boolean);\n        break;\n    case VIR_JSON_TYPE_NULL:\n        out = virJSONValueNewNull();\n        break;\n    }\n\n    return out;\n\n error:\n    virJSONValueFree(out);\n    return NULL;\n}"
  },
  {
    "function_name": "virJSONValueObjectForeachKeyValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1469-1487",
    "snippet": "int\nvirJSONValueObjectForeachKeyValue(virJSONValuePtr object,\n                                  virJSONValueObjectIteratorFunc cb,\n                                  void *opaque)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        virJSONObjectPairPtr elem = object->data.object.pairs + i;\n\n        if (cb(elem->key, elem->value, opaque) < 0)\n            return -2;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cb",
          "args": [
            "elem->key",
            "elem->value",
            "opaque"
          ],
          "line": 1482
        },
        "resolved": true,
        "details": {
          "function_name": "file_iterate_pci_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/virt-aa-helper.c",
          "lines": "855-861",
          "snippet": "static int\nfile_iterate_pci_cb(virPCIDevicePtr dev G_GNUC_UNUSED,\n                    const char *file, void *opaque)\n{\n    virBufferPtr buf = opaque;\n    return vah_add_file(buf, file, \"rw\");\n}",
          "includes": [
            "#include \"virhostdev.h\"",
            "#include \"virgettext.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virpci.h\"",
            "#include \"virutil.h\"",
            "#include \"virusb.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"domain_conf.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"security_driver.h\"",
            "#include \"driver.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <sys/utsname.h>",
            "#include <getopt.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhostdev.h\"\n#include \"virgettext.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virpci.h\"\n#include \"virutil.h\"\n#include \"virusb.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"domain_conf.h\"\n#include \"security_apparmor.h\"\n#include \"security_driver.h\"\n#include \"driver.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <sys/utsname.h>\n#include <getopt.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nfile_iterate_pci_cb(virPCIDevicePtr dev G_GNUC_UNUSED,\n                    const char *file, void *opaque)\n{\n    virBufferPtr buf = opaque;\n    return vah_add_file(buf, file, \"rw\");\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectForeachKeyValue(virJSONValuePtr object,\n                                  virJSONValueObjectIteratorFunc cb,\n                                  void *opaque)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        virJSONObjectPairPtr elem = object->data.object.pairs + i;\n\n        if (cb(elem->key, elem->value, opaque) < 0)\n            return -2;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueObjectIsNull",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1444-1454",
    "snippet": "int\nvirJSONValueObjectIsNull(virJSONValuePtr object,\n                         const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueIsNull(val);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueIsNull",
          "args": [
            "val"
          ],
          "line": 1453
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueIsNull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1284-1288",
          "snippet": "bool\nvirJSONValueIsNull(virJSONValuePtr val)\n{\n    return val->type == VIR_JSON_TYPE_NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nbool\nvirJSONValueIsNull(virJSONValuePtr val)\n{\n    return val->type == VIR_JSON_TYPE_NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGet",
          "args": [
            "object",
            "key"
          ],
          "line": 1448
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectIsNull(virJSONValuePtr object,\n                         const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueIsNull(val);\n}"
  },
  {
    "function_name": "virJSONValueObjectStealObject",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1436-1441",
    "snippet": "virJSONValuePtr\nvirJSONValueObjectStealObject(virJSONValuePtr object,\n                              const char *key)\n{\n    return virJSONValueObjectStealByType(object, key, VIR_JSON_TYPE_OBJECT);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectStealByType",
          "args": [
            "object",
            "key",
            "VIR_JSON_TYPE_OBJECT"
          ],
          "line": 1440
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectStealByType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "915-925",
          "snippet": "static virJSONValuePtr\nvirJSONValueObjectStealByType(virJSONValuePtr object,\n                              const char *key,\n                              virJSONType type)\n{\n    virJSONValuePtr value = virJSONValueObjectSteal(object, key);\n\n    if (value && value->type == type)\n        return value;\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nvirJSONValueObjectStealByType(virJSONValuePtr object,\n                              const char *key,\n                              virJSONType type)\n{\n    virJSONValuePtr value = virJSONValueObjectSteal(object, key);\n\n    if (value && value->type == type)\n        return value;\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectStealObject(virJSONValuePtr object,\n                              const char *key)\n{\n    return virJSONValueObjectStealByType(object, key, VIR_JSON_TYPE_OBJECT);\n}"
  },
  {
    "function_name": "virJSONValueObjectStealArray",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1429-1433",
    "snippet": "virJSONValuePtr\nvirJSONValueObjectStealArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectStealByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectStealByType",
          "args": [
            "object",
            "key",
            "VIR_JSON_TYPE_ARRAY"
          ],
          "line": 1432
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectStealByType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "915-925",
          "snippet": "static virJSONValuePtr\nvirJSONValueObjectStealByType(virJSONValuePtr object,\n                              const char *key,\n                              virJSONType type)\n{\n    virJSONValuePtr value = virJSONValueObjectSteal(object, key);\n\n    if (value && value->type == type)\n        return value;\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nvirJSONValueObjectStealByType(virJSONValuePtr object,\n                              const char *key,\n                              virJSONType type)\n{\n    virJSONValuePtr value = virJSONValueObjectSteal(object, key);\n\n    if (value && value->type == type)\n        return value;\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectStealArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectStealByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
  },
  {
    "function_name": "virJSONValueObjectGetArray",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1422-1426",
    "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectGetByType",
          "args": [
            "object",
            "key",
            "VIR_JSON_TYPE_ARRAY"
          ],
          "line": 1425
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetByType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "900-910",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetByType(virJSONValuePtr object,\n                            const char *key,\n                            virJSONType type)\n{\n    virJSONValuePtr value = virJSONValueObjectGet(object, key);\n\n    if (value && value->type == type)\n        return value;\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetByType(virJSONValuePtr object,\n                            const char *key,\n                            virJSONType type)\n{\n    virJSONValuePtr value = virJSONValueObjectGet(object, key);\n\n    if (value && value->type == type)\n        return value;\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
  },
  {
    "function_name": "virJSONValueObjectGetObject",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1415-1419",
    "snippet": "virJSONValuePtr\nvirJSONValueObjectGetObject(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_OBJECT);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectGetByType",
          "args": [
            "object",
            "key",
            "VIR_JSON_TYPE_OBJECT"
          ],
          "line": 1418
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetByType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "900-910",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetByType(virJSONValuePtr object,\n                            const char *key,\n                            virJSONType type)\n{\n    virJSONValuePtr value = virJSONValueObjectGet(object, key);\n\n    if (value && value->type == type)\n        return value;\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetByType(virJSONValuePtr object,\n                            const char *key,\n                            virJSONType type)\n{\n    virJSONValuePtr value = virJSONValueObjectGet(object, key);\n\n    if (value && value->type == type)\n        return value;\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetObject(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_OBJECT);\n}"
  },
  {
    "function_name": "virJSONValueObjectGetBoolean",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1401-1412",
    "snippet": "int\nvirJSONValueObjectGetBoolean(virJSONValuePtr object,\n                             const char *key,\n                             bool *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetBoolean(val, value);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueGetBoolean",
          "args": [
            "val",
            "value"
          ],
          "line": 1411
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueGetBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1190-1199",
          "snippet": "int\nvirJSONValueGetBoolean(virJSONValuePtr val,\n                       bool *value)\n{\n    if (val->type != VIR_JSON_TYPE_BOOLEAN)\n        return -1;\n\n    *value = val->data.boolean;\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueGetBoolean(virJSONValuePtr val,\n                       bool *value)\n{\n    if (val->type != VIR_JSON_TYPE_BOOLEAN)\n        return -1;\n\n    *value = val->data.boolean;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGet",
          "args": [
            "object",
            "key"
          ],
          "line": 1406
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectGetBoolean(virJSONValuePtr object,\n                             const char *key,\n                             bool *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetBoolean(val, value);\n}"
  },
  {
    "function_name": "virJSONValueObjectGetNumberDouble",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1387-1398",
    "snippet": "int\nvirJSONValueObjectGetNumberDouble(virJSONValuePtr object,\n                                  const char *key,\n                                  double *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberDouble(val, value);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueGetNumberDouble",
          "args": [
            "val",
            "value"
          ],
          "line": 1397
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueGetNumberDouble",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1179-1187",
          "snippet": "int\nvirJSONValueGetNumberDouble(virJSONValuePtr number,\n                            double *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToDouble(number->data.number, NULL, value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueGetNumberDouble(virJSONValuePtr number,\n                            double *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToDouble(number->data.number, NULL, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGet",
          "args": [
            "object",
            "key"
          ],
          "line": 1392
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectGetNumberDouble(virJSONValuePtr object,\n                                  const char *key,\n                                  double *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberDouble(val, value);\n}"
  },
  {
    "function_name": "virJSONValueObjectGetNumberUlong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1373-1384",
    "snippet": "int\nvirJSONValueObjectGetNumberUlong(virJSONValuePtr object,\n                                 const char *key,\n                                 unsigned long long *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberUlong(val, value);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueGetNumberUlong",
          "args": [
            "val",
            "value"
          ],
          "line": 1383
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueGetNumberUlong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1168-1176",
          "snippet": "int\nvirJSONValueGetNumberUlong(virJSONValuePtr number,\n                           unsigned long long *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToLong_ull(number->data.number, NULL, 10, value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueGetNumberUlong(virJSONValuePtr number,\n                           unsigned long long *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToLong_ull(number->data.number, NULL, 10, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGet",
          "args": [
            "object",
            "key"
          ],
          "line": 1378
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectGetNumberUlong(virJSONValuePtr object,\n                                 const char *key,\n                                 unsigned long long *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberUlong(val, value);\n}"
  },
  {
    "function_name": "virJSONValueObjectGetNumberLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1359-1370",
    "snippet": "int\nvirJSONValueObjectGetNumberLong(virJSONValuePtr object,\n                                const char *key,\n                                long long *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberLong(val, value);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueGetNumberLong",
          "args": [
            "val",
            "value"
          ],
          "line": 1369
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueGetNumberLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1157-1165",
          "snippet": "int\nvirJSONValueGetNumberLong(virJSONValuePtr number,\n                          long long *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToLong_ll(number->data.number, NULL, 10, value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueGetNumberLong(virJSONValuePtr number,\n                          long long *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToLong_ll(number->data.number, NULL, 10, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGet",
          "args": [
            "object",
            "key"
          ],
          "line": 1364
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectGetNumberLong(virJSONValuePtr object,\n                                const char *key,\n                                long long *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberLong(val, value);\n}"
  },
  {
    "function_name": "virJSONValueObjectGetNumberUint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1345-1356",
    "snippet": "int\nvirJSONValueObjectGetNumberUint(virJSONValuePtr object,\n                                const char *key,\n                                unsigned int *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberUint(val, value);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueGetNumberUint",
          "args": [
            "val",
            "value"
          ],
          "line": 1355
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueGetNumberUint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1146-1154",
          "snippet": "int\nvirJSONValueGetNumberUint(virJSONValuePtr number,\n                          unsigned int *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToLong_ui(number->data.number, NULL, 10, value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueGetNumberUint(virJSONValuePtr number,\n                          unsigned int *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToLong_ui(number->data.number, NULL, 10, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGet",
          "args": [
            "object",
            "key"
          ],
          "line": 1350
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectGetNumberUint(virJSONValuePtr object,\n                                const char *key,\n                                unsigned int *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberUint(val, value);\n}"
  },
  {
    "function_name": "virJSONValueObjectGetNumberInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1331-1342",
    "snippet": "int\nvirJSONValueObjectGetNumberInt(virJSONValuePtr object,\n                               const char *key,\n                               int *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberInt(val, value);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueGetNumberInt",
          "args": [
            "val",
            "value"
          ],
          "line": 1341
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueGetNumberInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1135-1143",
          "snippet": "int\nvirJSONValueGetNumberInt(virJSONValuePtr number,\n                         int *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToLong_i(number->data.number, NULL, 10, value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueGetNumberInt(virJSONValuePtr number,\n                         int *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToLong_i(number->data.number, NULL, 10, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGet",
          "args": [
            "object",
            "key"
          ],
          "line": 1336
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectGetNumberInt(virJSONValuePtr object,\n                               const char *key,\n                               int *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberInt(val, value);\n}"
  },
  {
    "function_name": "virJSONValueObjectGetStringOrNumber",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1313-1328",
    "snippet": "const char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectGet",
          "args": [
            "object",
            "key"
          ],
          "line": 1317
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}"
  },
  {
    "function_name": "virJSONValueObjectGetString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1291-1301",
    "snippet": "const char *\nvirJSONValueObjectGetString(virJSONValuePtr object,\n                            const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    return virJSONValueGetString(val);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueGetString",
          "args": [
            "val"
          ],
          "line": 1300
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueGetString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1115-1122",
          "snippet": "const char *\nvirJSONValueGetString(virJSONValuePtr string)\n{\n    if (string->type != VIR_JSON_TYPE_STRING)\n        return NULL;\n\n    return string->data.string;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueGetString(virJSONValuePtr string)\n{\n    if (string->type != VIR_JSON_TYPE_STRING)\n        return NULL;\n\n    return string->data.string;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGet",
          "args": [
            "object",
            "key"
          ],
          "line": 1295
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetString(virJSONValuePtr object,\n                            const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    return virJSONValueGetString(val);\n}"
  },
  {
    "function_name": "virJSONValueIsNull",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1284-1288",
    "snippet": "bool\nvirJSONValueIsNull(virJSONValuePtr val)\n{\n    return val->type == VIR_JSON_TYPE_NULL;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nbool\nvirJSONValueIsNull(virJSONValuePtr val)\n{\n    return val->type == VIR_JSON_TYPE_NULL;\n}"
  },
  {
    "function_name": "virJSONValueNewArrayFromBitmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1255-1281",
    "snippet": "virJSONValuePtr\nvirJSONValueNewArrayFromBitmap(virBitmapPtr bitmap)\n{\n    virJSONValuePtr ret;\n    ssize_t pos = -1;\n\n    ret = virJSONValueNewArray();\n\n    if (!bitmap)\n        return ret;\n\n    while ((pos = virBitmapNextSetBit(bitmap, pos)) > -1) {\n        virJSONValuePtr newelem;\n\n        if (!(newelem = virJSONValueNewNumberLong(pos)) ||\n            virJSONValueArrayAppend(ret, newelem) < 0) {\n            virJSONValueFree(newelem);\n            goto error;\n        }\n    }\n\n    return ret;\n\n error:\n    virJSONValueFree(ret);\n    return NULL;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "ret"
          ],
          "line": 1279
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayAppend",
          "args": [
            "ret",
            "newelem"
          ],
          "line": 1270
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayAppendString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "792-804",
          "snippet": "int\nvirJSONValueArrayAppendString(virJSONValuePtr object,\n                              const char *value)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueArrayAppend(object, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueArrayAppendString(virJSONValuePtr object,\n                              const char *value)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueArrayAppend(object, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewNumberLong",
          "args": [
            "pos"
          ],
          "line": 1269
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNumberLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "503-509",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNumberLong(long long data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%lld\", data);\n    return virJSONValueNewNumber(str);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNumberLong(long long data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%lld\", data);\n    return virJSONValueNewNumber(str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapNextSetBit",
          "args": [
            "bitmap",
            "pos"
          ],
          "line": 1266
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNextSetBit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "986-1014",
          "snippet": "ssize_t\nvirBitmapNextSetBit(virBitmapPtr bitmap,\n                    ssize_t pos)\n{\n    size_t nl;\n    size_t nb;\n    unsigned long bits;\n\n    if (pos < 0)\n        pos = -1;\n\n    pos++;\n\n    if (pos >= bitmap->nbits)\n        return -1;\n\n    nl = pos / VIR_BITMAP_BITS_PER_UNIT;\n    nb = pos % VIR_BITMAP_BITS_PER_UNIT;\n\n    bits = bitmap->map[nl] & ~((1UL << nb) - 1);\n\n    while (bits == 0 && ++nl < bitmap->map_len)\n        bits = bitmap->map[nl];\n\n    if (bits == 0)\n        return -1;\n\n    return __builtin_ffsl(bits) - 1 + nl * VIR_BITMAP_BITS_PER_UNIT;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nssize_t\nvirBitmapNextSetBit(virBitmapPtr bitmap,\n                    ssize_t pos)\n{\n    size_t nl;\n    size_t nb;\n    unsigned long bits;\n\n    if (pos < 0)\n        pos = -1;\n\n    pos++;\n\n    if (pos >= bitmap->nbits)\n        return -1;\n\n    nl = pos / VIR_BITMAP_BITS_PER_UNIT;\n    nb = pos % VIR_BITMAP_BITS_PER_UNIT;\n\n    bits = bitmap->map[nl] & ~((1UL << nb) - 1);\n\n    while (bits == 0 && ++nl < bitmap->map_len)\n        bits = bitmap->map[nl];\n\n    if (bits == 0)\n        return -1;\n\n    return __builtin_ffsl(bits) - 1 + nl * VIR_BITMAP_BITS_PER_UNIT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewArray",
          "args": [],
          "line": 1261
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "560-568",
          "snippet": "virJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewArrayFromBitmap(virBitmapPtr bitmap)\n{\n    virJSONValuePtr ret;\n    ssize_t pos = -1;\n\n    ret = virJSONValueNewArray();\n\n    if (!bitmap)\n        return ret;\n\n    while ((pos = virBitmapNextSetBit(bitmap, pos)) > -1) {\n        virJSONValuePtr newelem;\n\n        if (!(newelem = virJSONValueNewNumberLong(pos)) ||\n            virJSONValueArrayAppend(ret, newelem) < 0) {\n            virJSONValueFree(newelem);\n            goto error;\n        }\n    }\n\n    return ret;\n\n error:\n    virJSONValueFree(ret);\n    return NULL;\n}"
  },
  {
    "function_name": "virJSONValueGetArrayAsBitmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1215-1252",
    "snippet": "int\nvirJSONValueGetArrayAsBitmap(const virJSONValue *val,\n                             virBitmapPtr *bitmap)\n{\n    virJSONValuePtr elem;\n    size_t i;\n    g_autofree unsigned long long *elems = NULL;\n    unsigned long long maxelem = 0;\n\n    *bitmap = NULL;\n\n    if (val->type != VIR_JSON_TYPE_ARRAY)\n        return -1;\n\n    if (VIR_ALLOC_N_QUIET(elems, val->data.array.nvalues) < 0)\n        return -1;\n\n    /* first pass converts array members to numbers and finds the maximum */\n    for (i = 0; i < val->data.array.nvalues; i++) {\n        elem = val->data.array.values[i];\n\n        if (elem->type != VIR_JSON_TYPE_NUMBER ||\n            virStrToLong_ullp(elem->data.number, NULL, 10, &elems[i]) < 0)\n            return -1;\n\n        if (elems[i] > maxelem)\n            maxelem = elems[i];\n    }\n\n    if (!(*bitmap = virBitmapNewQuiet(maxelem + 1)))\n        return -1;\n\n    /* second pass sets the correct bits in the map */\n    for (i = 0; i < val->data.array.nvalues; i++)\n        ignore_value(virBitmapSetBit(*bitmap, elems[i]));\n\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapSetBit(*bitmap, elems[i])"
          ],
          "line": 1249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "*bitmap",
            "elems[i]"
          ],
          "line": 1249
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapNewQuiet",
          "args": [
            "maxelem + 1"
          ],
          "line": 1244
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "61-84",
          "snippet": "virBitmapPtr\nvirBitmapNewQuiet(size_t size)\n{\n    virBitmapPtr bitmap;\n    size_t sz;\n\n    if (SIZE_MAX - VIR_BITMAP_BITS_PER_UNIT < size || size == 0)\n        return NULL;\n\n    sz = VIR_DIV_UP(size, VIR_BITMAP_BITS_PER_UNIT);\n\n    if (VIR_ALLOC_QUIET(bitmap) < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N_QUIET(bitmap->map, sz) < 0) {\n        VIR_FREE(bitmap);\n        return NULL;\n    }\n\n    bitmap->nbits = size;\n    bitmap->map_len = sz;\n    bitmap->map_alloc = sz;\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nvirBitmapPtr\nvirBitmapNewQuiet(size_t size)\n{\n    virBitmapPtr bitmap;\n    size_t sz;\n\n    if (SIZE_MAX - VIR_BITMAP_BITS_PER_UNIT < size || size == 0)\n        return NULL;\n\n    sz = VIR_DIV_UP(size, VIR_BITMAP_BITS_PER_UNIT);\n\n    if (VIR_ALLOC_QUIET(bitmap) < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N_QUIET(bitmap->map, sz) < 0) {\n        VIR_FREE(bitmap);\n        return NULL;\n    }\n\n    bitmap->nbits = size;\n    bitmap->map_len = sz;\n    bitmap->map_alloc = sz;\n    return bitmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ullp",
          "args": [
            "elem->data.number",
            "NULL",
            "10",
            "&elems[i]"
          ],
          "line": 1237
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N_QUIET",
          "args": [
            "elems",
            "val->data.array.nvalues"
          ],
          "line": 1229
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueGetArrayAsBitmap(const virJSONValue *val,\n                             virBitmapPtr *bitmap)\n{\n    virJSONValuePtr elem;\n    size_t i;\n    g_autofree unsigned long long *elems = NULL;\n    unsigned long long maxelem = 0;\n\n    *bitmap = NULL;\n\n    if (val->type != VIR_JSON_TYPE_ARRAY)\n        return -1;\n\n    if (VIR_ALLOC_N_QUIET(elems, val->data.array.nvalues) < 0)\n        return -1;\n\n    /* first pass converts array members to numbers and finds the maximum */\n    for (i = 0; i < val->data.array.nvalues; i++) {\n        elem = val->data.array.values[i];\n\n        if (elem->type != VIR_JSON_TYPE_NUMBER ||\n            virStrToLong_ullp(elem->data.number, NULL, 10, &elems[i]) < 0)\n            return -1;\n\n        if (elems[i] > maxelem)\n            maxelem = elems[i];\n    }\n\n    if (!(*bitmap = virBitmapNewQuiet(maxelem + 1)))\n        return -1;\n\n    /* second pass sets the correct bits in the map */\n    for (i = 0; i < val->data.array.nvalues; i++)\n        ignore_value(virBitmapSetBit(*bitmap, elems[i]));\n\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueGetBoolean",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1190-1199",
    "snippet": "int\nvirJSONValueGetBoolean(virJSONValuePtr val,\n                       bool *value)\n{\n    if (val->type != VIR_JSON_TYPE_BOOLEAN)\n        return -1;\n\n    *value = val->data.boolean;\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueGetBoolean(virJSONValuePtr val,\n                       bool *value)\n{\n    if (val->type != VIR_JSON_TYPE_BOOLEAN)\n        return -1;\n\n    *value = val->data.boolean;\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueGetNumberDouble",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1179-1187",
    "snippet": "int\nvirJSONValueGetNumberDouble(virJSONValuePtr number,\n                            double *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToDouble(number->data.number, NULL, value);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStrToDouble",
          "args": [
            "number->data.number",
            "NULL",
            "value"
          ],
          "line": 1186
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToDouble",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "674-697",
          "snippet": "int\nvirStrToDouble(char const *s,\n               char **end_ptr,\n               double *result)\n{\n    virLocale oldlocale;\n    double val;\n    char *p;\n    int err;\n\n    errno = 0;\n    if (virLocaleSetRaw(&oldlocale) < 0)\n        return -1;\n    val = strtod(s, &p); /* exempt from syntax-check */\n    virLocaleRevert(&oldlocale);\n\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToDouble(char const *s,\n               char **end_ptr,\n               double *result)\n{\n    virLocale oldlocale;\n    double val;\n    char *p;\n    int err;\n\n    errno = 0;\n    if (virLocaleSetRaw(&oldlocale) < 0)\n        return -1;\n    val = strtod(s, &p); /* exempt from syntax-check */\n    virLocaleRevert(&oldlocale);\n\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueGetNumberDouble(virJSONValuePtr number,\n                            double *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToDouble(number->data.number, NULL, value);\n}"
  },
  {
    "function_name": "virJSONValueGetNumberUlong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1168-1176",
    "snippet": "int\nvirJSONValueGetNumberUlong(virJSONValuePtr number,\n                           unsigned long long *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToLong_ull(number->data.number, NULL, 10, value);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "number->data.number",
            "NULL",
            "10",
            "value"
          ],
          "line": 1175
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueGetNumberUlong(virJSONValuePtr number,\n                           unsigned long long *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToLong_ull(number->data.number, NULL, 10, value);\n}"
  },
  {
    "function_name": "virJSONValueGetNumberLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1157-1165",
    "snippet": "int\nvirJSONValueGetNumberLong(virJSONValuePtr number,\n                          long long *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToLong_ll(number->data.number, NULL, 10, value);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStrToLong_ll",
          "args": [
            "number->data.number",
            "NULL",
            "10",
            "value"
          ],
          "line": 1164
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "526-542",
          "snippet": "int\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueGetNumberLong(virJSONValuePtr number,\n                          long long *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToLong_ll(number->data.number, NULL, 10, value);\n}"
  },
  {
    "function_name": "virJSONValueGetNumberUint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1146-1154",
    "snippet": "int\nvirJSONValueGetNumberUint(virJSONValuePtr number,\n                          unsigned int *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToLong_ui(number->data.number, NULL, 10, value);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "number->data.number",
            "NULL",
            "10",
            "value"
          ],
          "line": 1153
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueGetNumberUint(virJSONValuePtr number,\n                          unsigned int *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToLong_ui(number->data.number, NULL, 10, value);\n}"
  },
  {
    "function_name": "virJSONValueGetNumberInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1135-1143",
    "snippet": "int\nvirJSONValueGetNumberInt(virJSONValuePtr number,\n                         int *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToLong_i(number->data.number, NULL, 10, value);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "number->data.number",
            "NULL",
            "10",
            "value"
          ],
          "line": 1142
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueGetNumberInt(virJSONValuePtr number,\n                         int *value)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return -1;\n\n    return virStrToLong_i(number->data.number, NULL, 10, value);\n}"
  },
  {
    "function_name": "virJSONValueGetNumberString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1125-1132",
    "snippet": "const char *\nvirJSONValueGetNumberString(virJSONValuePtr number)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return NULL;\n\n    return number->data.number;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueGetNumberString(virJSONValuePtr number)\n{\n    if (number->type != VIR_JSON_TYPE_NUMBER)\n        return NULL;\n\n    return number->data.number;\n}"
  },
  {
    "function_name": "virJSONValueGetString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1115-1122",
    "snippet": "const char *\nvirJSONValueGetString(virJSONValuePtr string)\n{\n    if (string->type != VIR_JSON_TYPE_STRING)\n        return NULL;\n\n    return string->data.string;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueGetString(virJSONValuePtr string)\n{\n    if (string->type != VIR_JSON_TYPE_STRING)\n        return NULL;\n\n    return string->data.string;\n}"
  },
  {
    "function_name": "virJSONValueArrayForeachSteal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1078-1112",
    "snippet": "int\nvirJSONValueArrayForeachSteal(virJSONValuePtr array,\n                              virJSONArrayIteratorFunc cb,\n                              void *opaque)\n{\n    size_t i;\n    size_t j = 0;\n    int ret = 0;\n    int rc;\n\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return -1;\n\n    for (i = 0; i < array->data.array.nvalues; i++) {\n        if ((rc = cb(i, array->data.array.values[i], opaque)) < 0) {\n            ret = -1;\n            break;\n        }\n\n        if (rc == 0)\n            array->data.array.values[i] = NULL;\n    }\n\n    /* condense the remaining entries at the beginning */\n    for (i = 0; i < array->data.array.nvalues; i++) {\n        if (!array->data.array.values[i])\n            continue;\n\n        array->data.array.values[j++] = array->data.array.values[i];\n    }\n\n    array->data.array.nvalues = j;\n\n    return ret;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cb",
          "args": [
            "i",
            "array->data.array.values[i]",
            "opaque"
          ],
          "line": 1092
        },
        "resolved": true,
        "details": {
          "function_name": "file_iterate_pci_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/virt-aa-helper.c",
          "lines": "855-861",
          "snippet": "static int\nfile_iterate_pci_cb(virPCIDevicePtr dev G_GNUC_UNUSED,\n                    const char *file, void *opaque)\n{\n    virBufferPtr buf = opaque;\n    return vah_add_file(buf, file, \"rw\");\n}",
          "includes": [
            "#include \"virhostdev.h\"",
            "#include \"virgettext.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virpci.h\"",
            "#include \"virutil.h\"",
            "#include \"virusb.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"domain_conf.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"security_driver.h\"",
            "#include \"driver.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <sys/utsname.h>",
            "#include <getopt.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhostdev.h\"\n#include \"virgettext.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virpci.h\"\n#include \"virutil.h\"\n#include \"virusb.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"domain_conf.h\"\n#include \"security_apparmor.h\"\n#include \"security_driver.h\"\n#include \"driver.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <sys/utsname.h>\n#include <getopt.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nfile_iterate_pci_cb(virPCIDevicePtr dev G_GNUC_UNUSED,\n                    const char *file, void *opaque)\n{\n    virBufferPtr buf = opaque;\n    return vah_add_file(buf, file, \"rw\");\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueArrayForeachSteal(virJSONValuePtr array,\n                              virJSONArrayIteratorFunc cb,\n                              void *opaque)\n{\n    size_t i;\n    size_t j = 0;\n    int ret = 0;\n    int rc;\n\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return -1;\n\n    for (i = 0; i < array->data.array.nvalues; i++) {\n        if ((rc = cb(i, array->data.array.values[i], opaque)) < 0) {\n            ret = -1;\n            break;\n        }\n\n        if (rc == 0)\n            array->data.array.values[i] = NULL;\n    }\n\n    /* condense the remaining entries at the beginning */\n    for (i = 0; i < array->data.array.nvalues; i++) {\n        if (!array->data.array.values[i])\n            continue;\n\n        array->data.array.values[j++] = array->data.array.values[i];\n    }\n\n    array->data.array.nvalues = j;\n\n    return ret;\n}"
  },
  {
    "function_name": "virJSONValueArraySteal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1038-1057",
    "snippet": "virJSONValuePtr\nvirJSONValueArraySteal(virJSONValuePtr array,\n                       unsigned int element)\n{\n    virJSONValuePtr ret = NULL;\n\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return NULL;\n\n    if (element >= array->data.array.nvalues)\n        return NULL;\n\n    ret = array->data.array.values[element];\n\n    VIR_DELETE_ELEMENT(array->data.array.values,\n                       element,\n                       array->data.array.nvalues);\n\n    return ret;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DELETE_ELEMENT",
          "args": [
            "array->data.array.values",
            "element",
            "array->data.array.nvalues"
          ],
          "line": 1052
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueArraySteal(virJSONValuePtr array,\n                       unsigned int element)\n{\n    virJSONValuePtr ret = NULL;\n\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return NULL;\n\n    if (element >= array->data.array.nvalues)\n        return NULL;\n\n    ret = array->data.array.values[element];\n\n    VIR_DELETE_ELEMENT(array->data.array.values,\n                       element,\n                       array->data.array.nvalues);\n\n    return ret;\n}"
  },
  {
    "function_name": "virJSONValueArrayGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1024-1035",
    "snippet": "virJSONValuePtr\nvirJSONValueArrayGet(virJSONValuePtr array,\n                     unsigned int element)\n{\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return NULL;\n\n    if (element >= array->data.array.nvalues)\n        return NULL;\n\n    return array->data.array.values[element];\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueArrayGet(virJSONValuePtr array,\n                     unsigned int element)\n{\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return NULL;\n\n    if (element >= array->data.array.nvalues)\n        return NULL;\n\n    return array->data.array.values[element];\n}"
  },
  {
    "function_name": "virJSONValueArraySize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1017-1021",
    "snippet": "size_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nsize_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}"
  },
  {
    "function_name": "virJSONValueIsArray",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1010-1014",
    "snippet": "bool\nvirJSONValueIsArray(virJSONValuePtr array)\n{\n    return array->type == VIR_JSON_TYPE_ARRAY;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nbool\nvirJSONValueIsArray(virJSONValuePtr array)\n{\n    return array->type == VIR_JSON_TYPE_ARRAY;\n}"
  },
  {
    "function_name": "virJSONValueIsObject",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "1000-1007",
    "snippet": "bool\nvirJSONValueIsObject(virJSONValuePtr object)\n{\n    if (object)\n        return object->type == VIR_JSON_TYPE_OBJECT;\n    else\n        return false;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nbool\nvirJSONValueIsObject(virJSONValuePtr object)\n{\n    if (object)\n        return object->type == VIR_JSON_TYPE_OBJECT;\n    else\n        return false;\n}"
  },
  {
    "function_name": "virJSONValueObjectGetValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "986-997",
    "snippet": "virJSONValuePtr\nvirJSONValueObjectGetValue(virJSONValuePtr object,\n                           unsigned int n)\n{\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return NULL;\n\n    if (n >= object->data.object.npairs)\n        return NULL;\n\n    return object->data.object.pairs[n].value;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetValue(virJSONValuePtr object,\n                           unsigned int n)\n{\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return NULL;\n\n    if (n >= object->data.object.npairs)\n        return NULL;\n\n    return object->data.object.pairs[n].value;\n}"
  },
  {
    "function_name": "virJSONValueObjectRemoveKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "955-983",
    "snippet": "int\nvirJSONValueObjectRemoveKey(virJSONValuePtr object,\n                            const char *key,\n                            virJSONValuePtr *value)\n{\n    size_t i;\n\n    if (value)\n        *value = NULL;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key)) {\n            if (value) {\n                *value = object->data.object.pairs[i].value;\n                object->data.object.pairs[i].value = NULL;\n            }\n            VIR_FREE(object->data.object.pairs[i].key);\n            virJSONValueFree(object->data.object.pairs[i].value);\n            VIR_DELETE_ELEMENT(object->data.object.pairs, i,\n                               object->data.object.npairs);\n            return 1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DELETE_ELEMENT",
          "args": [
            "object->data.object.pairs",
            "i",
            "object->data.object.npairs"
          ],
          "line": 976
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "object->data.object.pairs[i].value"
          ],
          "line": 975
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "object->data.object.pairs[i].key"
          ],
          "line": 974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "object->data.object.pairs[i].key",
            "key"
          ],
          "line": 969
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectRemoveKey(virJSONValuePtr object,\n                            const char *key,\n                            virJSONValuePtr *value)\n{\n    size_t i;\n\n    if (value)\n        *value = NULL;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key)) {\n            if (value) {\n                *value = object->data.object.pairs[i].value;\n                object->data.object.pairs[i].value = NULL;\n            }\n            VIR_FREE(object->data.object.pairs[i].key);\n            virJSONValueFree(object->data.object.pairs[i].value);\n            VIR_DELETE_ELEMENT(object->data.object.pairs, i,\n                               object->data.object.npairs);\n            return 1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueObjectGetKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "938-949",
    "snippet": "const char *\nvirJSONValueObjectGetKey(virJSONValuePtr object,\n                         unsigned int n)\n{\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return NULL;\n\n    if (n >= object->data.object.npairs)\n        return NULL;\n\n    return object->data.object.pairs[n].key;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetKey(virJSONValuePtr object,\n                         unsigned int n)\n{\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return NULL;\n\n    if (n >= object->data.object.npairs)\n        return NULL;\n\n    return object->data.object.pairs[n].key;\n}"
  },
  {
    "function_name": "virJSONValueObjectKeysNumber",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "928-935",
    "snippet": "int\nvirJSONValueObjectKeysNumber(virJSONValuePtr object)\n{\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    return object->data.object.npairs;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectKeysNumber(virJSONValuePtr object)\n{\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    return object->data.object.npairs;\n}"
  },
  {
    "function_name": "virJSONValueObjectStealByType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "915-925",
    "snippet": "static virJSONValuePtr\nvirJSONValueObjectStealByType(virJSONValuePtr object,\n                              const char *key,\n                              virJSONType type)\n{\n    virJSONValuePtr value = virJSONValueObjectSteal(object, key);\n\n    if (value && value->type == type)\n        return value;\n    return NULL;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectSteal",
          "args": [
            "object",
            "key"
          ],
          "line": 920
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectStealObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1436-1441",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectStealObject(virJSONValuePtr object,\n                              const char *key)\n{\n    return virJSONValueObjectStealByType(object, key, VIR_JSON_TYPE_OBJECT);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectStealObject(virJSONValuePtr object,\n                              const char *key)\n{\n    return virJSONValueObjectStealByType(object, key, VIR_JSON_TYPE_OBJECT);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nvirJSONValueObjectStealByType(virJSONValuePtr object,\n                              const char *key,\n                              virJSONType type)\n{\n    virJSONValuePtr value = virJSONValueObjectSteal(object, key);\n\n    if (value && value->type == type)\n        return value;\n    return NULL;\n}"
  },
  {
    "function_name": "virJSONValueObjectGetByType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "900-910",
    "snippet": "virJSONValuePtr\nvirJSONValueObjectGetByType(virJSONValuePtr object,\n                            const char *key,\n                            virJSONType type)\n{\n    virJSONValuePtr value = virJSONValueObjectGet(object, key);\n\n    if (value && value->type == type)\n        return value;\n    return NULL;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectGet",
          "args": [
            "object",
            "key"
          ],
          "line": 905
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetByType(virJSONValuePtr object,\n                            const char *key,\n                            virJSONType type)\n{\n    virJSONValuePtr value = virJSONValueObjectGet(object, key);\n\n    if (value && value->type == type)\n        return value;\n    return NULL;\n}"
  },
  {
    "function_name": "virJSONValueObjectSteal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "874-895",
    "snippet": "static virJSONValuePtr\nvirJSONValueObjectSteal(virJSONValuePtr object,\n                        const char *key)\n{\n    size_t i;\n    virJSONValuePtr obj = NULL;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return NULL;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key)) {\n            obj = g_steal_pointer(&object->data.object.pairs[i].value);\n            VIR_FREE(object->data.object.pairs[i].key);\n            VIR_DELETE_ELEMENT(object->data.object.pairs, i,\n                               object->data.object.npairs);\n            break;\n        }\n    }\n\n    return obj;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DELETE_ELEMENT",
          "args": [
            "object->data.object.pairs",
            "i",
            "object->data.object.npairs"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "object->data.object.pairs[i].key"
          ],
          "line": 887
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&object->data.object.pairs[i].value"
          ],
          "line": 886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "object->data.object.pairs[i].key",
            "key"
          ],
          "line": 885
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nvirJSONValueObjectSteal(virJSONValuePtr object,\n                        const char *key)\n{\n    size_t i;\n    virJSONValuePtr obj = NULL;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return NULL;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key)) {\n            obj = g_steal_pointer(&object->data.object.pairs[i].value);\n            VIR_FREE(object->data.object.pairs[i].key);\n            VIR_DELETE_ELEMENT(object->data.object.pairs, i,\n                               object->data.object.npairs);\n            break;\n        }\n    }\n\n    return obj;\n}"
  },
  {
    "function_name": "virJSONValueObjectGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "856-871",
    "snippet": "virJSONValuePtr\nvirJSONValueObjectGet(virJSONValuePtr object,\n                      const char *key)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return NULL;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key))\n            return object->data.object.pairs[i].value;\n    }\n\n    return NULL;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "object->data.object.pairs[i].key",
            "key"
          ],
          "line": 866
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGet(virJSONValuePtr object,\n                      const char *key)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return NULL;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key))\n            return object->data.object.pairs[i].value;\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "virJSONValueObjectHasKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "838-853",
    "snippet": "int\nvirJSONValueObjectHasKey(virJSONValuePtr object,\n                         const char *key)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key))\n            return 1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "object->data.object.pairs[i].key",
            "key"
          ],
          "line": 848
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectHasKey(virJSONValuePtr object,\n                         const char *key)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key))\n            return 1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueArrayConcat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "814-835",
    "snippet": "int\nvirJSONValueArrayConcat(virJSONValuePtr a,\n                        virJSONValuePtr c)\n{\n    size_t i;\n\n    if (a->type != VIR_JSON_TYPE_ARRAY ||\n        c->type != VIR_JSON_TYPE_ARRAY) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"expecting JSON array\"));\n        return -1;\n    }\n\n    a->data.array.values = g_renew(virJSONValuePtr, a->data.array.values,\n                                   a->data.array.nvalues + c->data.array.nvalues);\n\n    for (i = 0; i < c->data.array.nvalues; i++)\n        a->data.array.values[a->data.array.nvalues++] = g_steal_pointer(&c->data.array.values[i]);\n\n    c->data.array.nvalues = 0;\n\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&c->data.array.values[i]"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_renew",
          "args": [
            "virJSONValuePtr",
            "a->data.array.values",
            "a->data.array.nvalues + c->data.array.nvalues"
          ],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"expecting JSON array\")"
          ],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"expecting JSON array\""
          ],
          "line": 822
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueArrayConcat(virJSONValuePtr a,\n                        virJSONValuePtr c)\n{\n    size_t i;\n\n    if (a->type != VIR_JSON_TYPE_ARRAY ||\n        c->type != VIR_JSON_TYPE_ARRAY) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"expecting JSON array\"));\n        return -1;\n    }\n\n    a->data.array.values = g_renew(virJSONValuePtr, a->data.array.values,\n                                   a->data.array.nvalues + c->data.array.nvalues);\n\n    for (i = 0; i < c->data.array.nvalues; i++)\n        a->data.array.values[a->data.array.nvalues++] = g_steal_pointer(&c->data.array.values[i]);\n\n    c->data.array.nvalues = 0;\n\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueArrayAppendString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "792-804",
    "snippet": "int\nvirJSONValueArrayAppendString(virJSONValuePtr object,\n                              const char *value)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueArrayAppend(object, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "jvalue"
          ],
          "line": 800
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayAppend",
          "args": [
            "object",
            "jvalue"
          ],
          "line": 799
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayAppendString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "792-804",
          "snippet": "int\nvirJSONValueArrayAppendString(virJSONValuePtr object,\n                              const char *value)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueArrayAppend(object, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewString",
          "args": [
            "value"
          ],
          "line": 796
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "433-448",
          "snippet": "virJSONValuePtr\nvirJSONValueNewString(const char *data)\n{\n    virJSONValuePtr val;\n\n    if (!data)\n        return virJSONValueNewNull();\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_STRING;\n    val->data.string = g_strdup(data);\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewString(const char *data)\n{\n    virJSONValuePtr val;\n\n    if (!data)\n        return virJSONValueNewNull();\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_STRING;\n    val->data.string = g_strdup(data);\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueArrayAppendString(virJSONValuePtr object,\n                              const char *value)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueArrayAppend(object, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueArrayAppend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "772-789",
    "snippet": "int\nvirJSONValueArrayAppend(virJSONValuePtr array,\n                        virJSONValuePtr value)\n{\n    if (array->type != VIR_JSON_TYPE_ARRAY) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"expecting JSON array\"));\n        return -1;\n    }\n\n    if (VIR_REALLOC_N(array->data.array.values,\n                      array->data.array.nvalues + 1) < 0)\n        return -1;\n\n    array->data.array.values[array->data.array.nvalues] = value;\n    array->data.array.nvalues++;\n\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "array->data.array.values",
            "array->data.array.nvalues + 1"
          ],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"expecting JSON array\")"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"expecting JSON array\""
          ],
          "line": 777
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueArrayAppend(virJSONValuePtr array,\n                        virJSONValuePtr value)\n{\n    if (array->type != VIR_JSON_TYPE_ARRAY) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"expecting JSON array\"));\n        return -1;\n    }\n\n    if (VIR_REALLOC_N(array->data.array.values,\n                      array->data.array.nvalues + 1) < 0)\n        return -1;\n\n    array->data.array.values[array->data.array.nvalues] = value;\n    array->data.array.nvalues++;\n\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueObjectAppendNull",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "757-769",
    "snippet": "int\nvirJSONValueObjectAppendNull(virJSONValuePtr object,\n                             const char *key)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNull();\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "jvalue"
          ],
          "line": 765
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppend",
          "args": [
            "object",
            "key",
            "jvalue"
          ],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "741-754",
          "snippet": "int\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewNull",
          "args": [],
          "line": 761
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "546-557",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNull(void)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_NULL;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNull(void)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_NULL;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNull(virJSONValuePtr object,\n                             const char *key)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNull();\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueObjectAppendBoolean",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "741-754",
    "snippet": "int\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "jvalue"
          ],
          "line": 750
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppend",
          "args": [
            "object",
            "key",
            "jvalue"
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "741-754",
          "snippet": "int\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewBoolean",
          "args": [
            "boolean_"
          ],
          "line": 746
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "531-543",
          "snippet": "virJSONValuePtr\nvirJSONValueNewBoolean(int boolean_)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_BOOLEAN;\n    val->data.boolean = boolean_;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewBoolean(int boolean_)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_BOOLEAN;\n    val->data.boolean = boolean_;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueObjectAppendNumberDouble",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "725-738",
    "snippet": "int\nvirJSONValueObjectAppendNumberDouble(virJSONValuePtr object,\n                                     const char *key,\n                                     double number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberDouble(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "jvalue"
          ],
          "line": 734
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppend",
          "args": [
            "object",
            "key",
            "jvalue"
          ],
          "line": 733
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "741-754",
          "snippet": "int\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewNumberDouble",
          "args": [
            "number"
          ],
          "line": 730
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNumberDouble",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "521-528",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNumberDouble(double data)\n{\n    g_autofree char *str = NULL;\n    if (virDoubleToStr(&str, data) < 0)\n        return NULL;\n    return virJSONValueNewNumber(str);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNumberDouble(double data)\n{\n    g_autofree char *str = NULL;\n    if (virDoubleToStr(&str, data) < 0)\n        return NULL;\n    return virJSONValueNewNumber(str);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNumberDouble(virJSONValuePtr object,\n                                     const char *key,\n                                     double number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberDouble(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueObjectAppendNumberUlong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "709-722",
    "snippet": "int\nvirJSONValueObjectAppendNumberUlong(virJSONValuePtr object,\n                                    const char *key,\n                                    unsigned long long number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberUlong(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "jvalue"
          ],
          "line": 718
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppend",
          "args": [
            "object",
            "key",
            "jvalue"
          ],
          "line": 717
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "741-754",
          "snippet": "int\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewNumberUlong",
          "args": [
            "number"
          ],
          "line": 714
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNumberUlong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "512-518",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNumberUlong(unsigned long long data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%llu\", data);\n    return virJSONValueNewNumber(str);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNumberUlong(unsigned long long data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%llu\", data);\n    return virJSONValueNewNumber(str);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNumberUlong(virJSONValuePtr object,\n                                    const char *key,\n                                    unsigned long long number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberUlong(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueObjectAppendNumberLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "693-706",
    "snippet": "int\nvirJSONValueObjectAppendNumberLong(virJSONValuePtr object,\n                                   const char *key,\n                                   long long number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberLong(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "jvalue"
          ],
          "line": 702
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppend",
          "args": [
            "object",
            "key",
            "jvalue"
          ],
          "line": 701
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "741-754",
          "snippet": "int\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewNumberLong",
          "args": [
            "number"
          ],
          "line": 698
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNumberLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "503-509",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNumberLong(long long data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%lld\", data);\n    return virJSONValueNewNumber(str);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNumberLong(long long data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%lld\", data);\n    return virJSONValueNewNumber(str);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNumberLong(virJSONValuePtr object,\n                                   const char *key,\n                                   long long number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberLong(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueObjectAppendNumberUint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "677-690",
    "snippet": "int\nvirJSONValueObjectAppendNumberUint(virJSONValuePtr object,\n                                   const char *key,\n                                   unsigned int number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberUint(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "jvalue"
          ],
          "line": 686
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppend",
          "args": [
            "object",
            "key",
            "jvalue"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "741-754",
          "snippet": "int\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewNumberUint",
          "args": [
            "number"
          ],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNumberUint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "494-500",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNumberUint(unsigned int data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%u\", data);\n    return virJSONValueNewNumber(str);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNumberUint(unsigned int data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%u\", data);\n    return virJSONValueNewNumber(str);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNumberUint(virJSONValuePtr object,\n                                   const char *key,\n                                   unsigned int number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberUint(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueObjectAppendNumberInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "661-674",
    "snippet": "int\nvirJSONValueObjectAppendNumberInt(virJSONValuePtr object,\n                                  const char *key,\n                                  int number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberInt(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "jvalue"
          ],
          "line": 670
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppend",
          "args": [
            "object",
            "key",
            "jvalue"
          ],
          "line": 669
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "741-754",
          "snippet": "int\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewNumberInt",
          "args": [
            "number"
          ],
          "line": 666
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNumberInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "485-491",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNumberInt(int data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%i\", data);\n    return virJSONValueNewNumber(str);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNumberInt(int data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%i\", data);\n    return virJSONValueNewNumber(str);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNumberInt(virJSONValuePtr object,\n                                  const char *key,\n                                  int number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberInt(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueObjectPrependString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "652-658",
    "snippet": "int\nvirJSONValueObjectPrependString(virJSONValuePtr object,\n                                const char *key,\n                                const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, true);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectInsertString",
          "args": [
            "object",
            "key",
            "value",
            "true"
          ],
          "line": 657
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectInsertString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "626-640",
          "snippet": "static int\nvirJSONValueObjectInsertString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value,\n                               bool prepend)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectInsert(object, key, jvalue, prepend) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONValueObjectInsertString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value,\n                               bool prepend)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectInsert(object, key, jvalue, prepend) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectPrependString(virJSONValuePtr object,\n                                const char *key,\n                                const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, true);\n}"
  },
  {
    "function_name": "virJSONValueObjectAppendString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "643-649",
    "snippet": "int\nvirJSONValueObjectAppendString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, false);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectInsertString",
          "args": [
            "object",
            "key",
            "value",
            "false"
          ],
          "line": 648
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectInsertString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "626-640",
          "snippet": "static int\nvirJSONValueObjectInsertString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value,\n                               bool prepend)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectInsert(object, key, jvalue, prepend) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONValueObjectInsertString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value,\n                               bool prepend)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectInsert(object, key, jvalue, prepend) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, false);\n}"
  },
  {
    "function_name": "virJSONValueObjectInsertString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "626-640",
    "snippet": "static int\nvirJSONValueObjectInsertString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value,\n                               bool prepend)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectInsert(object, key, jvalue, prepend) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "jvalue"
          ],
          "line": 636
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectInsert",
          "args": [
            "object",
            "key",
            "jvalue",
            "prepend"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectInsertString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "626-640",
          "snippet": "static int\nvirJSONValueObjectInsertString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value,\n                               bool prepend)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectInsert(object, key, jvalue, prepend) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewString",
          "args": [
            "value"
          ],
          "line": 632
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "433-448",
          "snippet": "virJSONValuePtr\nvirJSONValueNewString(const char *data)\n{\n    virJSONValuePtr val;\n\n    if (!data)\n        return virJSONValueNewNull();\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_STRING;\n    val->data.string = g_strdup(data);\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewString(const char *data)\n{\n    virJSONValuePtr val;\n\n    if (!data)\n        return virJSONValueNewNull();\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_STRING;\n    val->data.string = g_strdup(data);\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONValueObjectInsertString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value,\n                               bool prepend)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectInsert(object, key, jvalue, prepend) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virJSONValueObjectAppend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "617-623",
    "snippet": "int\nvirJSONValueObjectAppend(virJSONValuePtr object,\n                         const char *key,\n                         virJSONValuePtr value)\n{\n    return virJSONValueObjectInsert(object, key, value, false);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectInsert",
          "args": [
            "object",
            "key",
            "value",
            "false"
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectInsertString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "626-640",
          "snippet": "static int\nvirJSONValueObjectInsertString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value,\n                               bool prepend)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectInsert(object, key, jvalue, prepend) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONValueObjectInsertString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value,\n                               bool prepend)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectInsert(object, key, jvalue, prepend) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppend(virJSONValuePtr object,\n                         const char *key,\n                         virJSONValuePtr value)\n{\n    return virJSONValueObjectInsert(object, key, value, false);\n}"
  },
  {
    "function_name": "virJSONValueObjectInsert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "582-614",
    "snippet": "static int\nvirJSONValueObjectInsert(virJSONValuePtr object,\n                         const char *key,\n                         virJSONValuePtr value,\n                         bool prepend)\n{\n    virJSONObjectPair pair = { NULL, value };\n    int ret = -1;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"expecting JSON object\"));\n        return -1;\n    }\n\n    if (virJSONValueObjectHasKey(object, key)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"duplicate key '%s'\"), key);\n        return -1;\n    }\n\n    pair.key = g_strdup(key);\n\n    if (prepend) {\n        ret = VIR_INSERT_ELEMENT(object->data.object.pairs, 0,\n                                 object->data.object.npairs, pair);\n    } else {\n        ret = VIR_APPEND_ELEMENT(object->data.object.pairs,\n                                 object->data.object.npairs, pair);\n    }\n\n    VIR_FREE(pair.key);\n    return ret;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "pair.key"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "object->data.object.pairs",
            "object->data.object.npairs",
            "pair"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_INSERT_ELEMENT",
          "args": [
            "object->data.object.pairs",
            "0",
            "object->data.object.npairs",
            "pair"
          ],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "key"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"duplicate key '%s'\")",
            "key"
          ],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectHasKey",
          "args": [
            "object",
            "key"
          ],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectHasKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "838-853",
          "snippet": "int\nvirJSONValueObjectHasKey(virJSONValuePtr object,\n                         const char *key)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key))\n            return 1;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectHasKey(virJSONValuePtr object,\n                         const char *key)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key))\n            return 1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"expecting JSON object\")"
          ],
          "line": 592
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic int\nvirJSONValueObjectInsert(virJSONValuePtr object,\n                         const char *key,\n                         virJSONValuePtr value,\n                         bool prepend)\n{\n    virJSONObjectPair pair = { NULL, value };\n    int ret = -1;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"expecting JSON object\"));\n        return -1;\n    }\n\n    if (virJSONValueObjectHasKey(object, key)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"duplicate key '%s'\"), key);\n        return -1;\n    }\n\n    pair.key = g_strdup(key);\n\n    if (prepend) {\n        ret = VIR_INSERT_ELEMENT(object->data.object.pairs, 0,\n                                 object->data.object.npairs, pair);\n    } else {\n        ret = VIR_APPEND_ELEMENT(object->data.object.pairs,\n                                 object->data.object.npairs, pair);\n    }\n\n    VIR_FREE(pair.key);\n    return ret;\n}"
  },
  {
    "function_name": "virJSONValueNewObject",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "571-579",
    "snippet": "virJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "virJSONValue",
            "1"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}"
  },
  {
    "function_name": "virJSONValueNewArray",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "560-568",
    "snippet": "virJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "virJSONValue",
            "1"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}"
  },
  {
    "function_name": "virJSONValueNewNull",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "546-557",
    "snippet": "virJSONValuePtr\nvirJSONValueNewNull(void)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_NULL;\n\n    return val;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "val"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNull(void)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_NULL;\n\n    return val;\n}"
  },
  {
    "function_name": "virJSONValueNewBoolean",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "531-543",
    "snippet": "virJSONValuePtr\nvirJSONValueNewBoolean(int boolean_)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_BOOLEAN;\n    val->data.boolean = boolean_;\n\n    return val;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "val"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewBoolean(int boolean_)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_BOOLEAN;\n    val->data.boolean = boolean_;\n\n    return val;\n}"
  },
  {
    "function_name": "virJSONValueNewNumberDouble",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "521-528",
    "snippet": "virJSONValuePtr\nvirJSONValueNewNumberDouble(double data)\n{\n    g_autofree char *str = NULL;\n    if (virDoubleToStr(&str, data) < 0)\n        return NULL;\n    return virJSONValueNewNumber(str);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueNewNumber",
          "args": [
            "str"
          ],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNumberDouble",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "521-528",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNumberDouble(double data)\n{\n    g_autofree char *str = NULL;\n    if (virDoubleToStr(&str, data) < 0)\n        return NULL;\n    return virJSONValueNewNumber(str);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virDoubleToStr",
          "args": [
            "&str",
            "data"
          ],
          "line": 525
        },
        "resolved": true,
        "details": {
          "function_name": "virDoubleToStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "706-720",
          "snippet": "int\nvirDoubleToStr(char **strp, double number)\n{\n    virLocale oldlocale;\n\n    if (virLocaleSetRaw(&oldlocale) < 0)\n        return -1;\n\n    *strp = g_strdup_printf(\"%lf\", number);\n\n    virLocaleRevert(&oldlocale);\n    virLocaleFixupRadix(strp);\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirDoubleToStr(char **strp, double number)\n{\n    virLocale oldlocale;\n\n    if (virLocaleSetRaw(&oldlocale) < 0)\n        return -1;\n\n    *strp = g_strdup_printf(\"%lf\", number);\n\n    virLocaleRevert(&oldlocale);\n    virLocaleFixupRadix(strp);\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNumberDouble(double data)\n{\n    g_autofree char *str = NULL;\n    if (virDoubleToStr(&str, data) < 0)\n        return NULL;\n    return virJSONValueNewNumber(str);\n}"
  },
  {
    "function_name": "virJSONValueNewNumberUlong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "512-518",
    "snippet": "virJSONValuePtr\nvirJSONValueNewNumberUlong(unsigned long long data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%llu\", data);\n    return virJSONValueNewNumber(str);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueNewNumber",
          "args": [
            "str"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNumberDouble",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "521-528",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNumberDouble(double data)\n{\n    g_autofree char *str = NULL;\n    if (virDoubleToStr(&str, data) < 0)\n        return NULL;\n    return virJSONValueNewNumber(str);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNumberDouble(double data)\n{\n    g_autofree char *str = NULL;\n    if (virDoubleToStr(&str, data) < 0)\n        return NULL;\n    return virJSONValueNewNumber(str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%llu\"",
            "data"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNumberUlong(unsigned long long data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%llu\", data);\n    return virJSONValueNewNumber(str);\n}"
  },
  {
    "function_name": "virJSONValueNewNumberLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "503-509",
    "snippet": "virJSONValuePtr\nvirJSONValueNewNumberLong(long long data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%lld\", data);\n    return virJSONValueNewNumber(str);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueNewNumber",
          "args": [
            "str"
          ],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNumberDouble",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "521-528",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNumberDouble(double data)\n{\n    g_autofree char *str = NULL;\n    if (virDoubleToStr(&str, data) < 0)\n        return NULL;\n    return virJSONValueNewNumber(str);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNumberDouble(double data)\n{\n    g_autofree char *str = NULL;\n    if (virDoubleToStr(&str, data) < 0)\n        return NULL;\n    return virJSONValueNewNumber(str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%lld\"",
            "data"
          ],
          "line": 507
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNumberLong(long long data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%lld\", data);\n    return virJSONValueNewNumber(str);\n}"
  },
  {
    "function_name": "virJSONValueNewNumberUint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "494-500",
    "snippet": "virJSONValuePtr\nvirJSONValueNewNumberUint(unsigned int data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%u\", data);\n    return virJSONValueNewNumber(str);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueNewNumber",
          "args": [
            "str"
          ],
          "line": 499
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNumberDouble",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "521-528",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNumberDouble(double data)\n{\n    g_autofree char *str = NULL;\n    if (virDoubleToStr(&str, data) < 0)\n        return NULL;\n    return virJSONValueNewNumber(str);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNumberDouble(double data)\n{\n    g_autofree char *str = NULL;\n    if (virDoubleToStr(&str, data) < 0)\n        return NULL;\n    return virJSONValueNewNumber(str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%u\"",
            "data"
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNumberUint(unsigned int data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%u\", data);\n    return virJSONValueNewNumber(str);\n}"
  },
  {
    "function_name": "virJSONValueNewNumberInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "485-491",
    "snippet": "virJSONValuePtr\nvirJSONValueNewNumberInt(int data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%i\", data);\n    return virJSONValueNewNumber(str);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueNewNumber",
          "args": [
            "str"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNumberDouble",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "521-528",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNumberDouble(double data)\n{\n    g_autofree char *str = NULL;\n    if (virDoubleToStr(&str, data) < 0)\n        return NULL;\n    return virJSONValueNewNumber(str);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNumberDouble(double data)\n{\n    g_autofree char *str = NULL;\n    if (virDoubleToStr(&str, data) < 0)\n        return NULL;\n    return virJSONValueNewNumber(str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%i\"",
            "data"
          ],
          "line": 489
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNumberInt(int data)\n{\n    g_autofree char *str = NULL;\n    str = g_strdup_printf(\"%i\", data);\n    return virJSONValueNewNumber(str);\n}"
  },
  {
    "function_name": "virJSONValueNewNumber",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "470-482",
    "snippet": "static virJSONValuePtr\nvirJSONValueNewNumber(const char *data)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_NUMBER;\n    val->data.number = g_strdup(data);\n\n    return val;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "data"
          ],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "val"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nvirJSONValueNewNumber(const char *data)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_NUMBER;\n    val->data.number = g_strdup(data);\n\n    return val;\n}"
  },
  {
    "function_name": "virJSONValueNewStringLen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "451-467",
    "snippet": "virJSONValuePtr\nvirJSONValueNewStringLen(const char *data,\n                         size_t length)\n{\n    virJSONValuePtr val;\n\n    if (!data)\n        return virJSONValueNewNull();\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_STRING;\n    val->data.string = g_strndup(data, length);\n\n    return val;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "data",
            "length"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "val"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueNewNull",
          "args": [],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "546-557",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNull(void)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_NULL;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNull(void)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_NULL;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewStringLen(const char *data,\n                         size_t length)\n{\n    virJSONValuePtr val;\n\n    if (!data)\n        return virJSONValueNewNull();\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_STRING;\n    val->data.string = g_strndup(data, length);\n\n    return val;\n}"
  },
  {
    "function_name": "virJSONValueNewString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "433-448",
    "snippet": "virJSONValuePtr\nvirJSONValueNewString(const char *data)\n{\n    virJSONValuePtr val;\n\n    if (!data)\n        return virJSONValueNewNull();\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_STRING;\n    val->data.string = g_strdup(data);\n\n    return val;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "data"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "val"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueNewNull",
          "args": [],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewNull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "546-557",
          "snippet": "virJSONValuePtr\nvirJSONValueNewNull(void)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_NULL;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewNull(void)\n{\n    virJSONValuePtr val;\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_NULL;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewString(const char *data)\n{\n    virJSONValuePtr val;\n\n    if (!data)\n        return virJSONValueNewNull();\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->type = VIR_JSON_TYPE_STRING;\n    val->data.string = g_strdup(data);\n\n    return val;\n}"
  },
  {
    "function_name": "virJSONValueHashFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "426-430",
    "snippet": "void\nvirJSONValueHashFree(void *opaque)\n{\n    virJSONValueFree(opaque);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "opaque"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueHashFree(void *opaque)\n{\n    virJSONValueFree(opaque);\n}"
  },
  {
    "function_name": "virJSONValueFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "391-423",
    "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value->data.number"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value->data.string"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value->data.array.values"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "value->data.array.values[i]"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value->data.object.pairs"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value->data.object.pairs[i].key"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
  },
  {
    "function_name": "virJSONValueObjectCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "377-388",
    "snippet": "int\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectCreateVArgs",
          "args": [
            "obj",
            "args"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectCreateVArgs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "359-374",
          "snippet": "int\nvirJSONValueObjectCreateVArgs(virJSONValuePtr *obj,\n                              va_list args)\n{\n    int ret;\n\n    *obj = virJSONValueNewObject();\n\n    /* free the object on error, or if no value objects were added */\n    if ((ret = virJSONValueObjectAddVArgs(*obj, args)) <= 0) {\n        virJSONValueFree(*obj);\n        *obj = NULL;\n    }\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreateVArgs(virJSONValuePtr *obj,\n                              va_list args)\n{\n    int ret;\n\n    *obj = virJSONValueNewObject();\n\n    /* free the object on error, or if no value objects were added */\n    if ((ret = virJSONValueObjectAddVArgs(*obj, args)) <= 0) {\n        virJSONValueFree(*obj);\n        *obj = NULL;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "obj"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreate(virJSONValuePtr *obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectCreateVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
  },
  {
    "function_name": "virJSONValueObjectCreateVArgs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "359-374",
    "snippet": "int\nvirJSONValueObjectCreateVArgs(virJSONValuePtr *obj,\n                              va_list args)\n{\n    int ret;\n\n    *obj = virJSONValueNewObject();\n\n    /* free the object on error, or if no value objects were added */\n    if ((ret = virJSONValueObjectAddVArgs(*obj, args)) <= 0) {\n        virJSONValueFree(*obj);\n        *obj = NULL;\n    }\n\n    return ret;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "*obj"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAddVArgs",
          "args": [
            "*obj",
            "args"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAddVArgs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "157-342",
          "snippet": "int\nvirJSONValueObjectAddVArgs(virJSONValuePtr obj,\n                           va_list args)\n{\n    char type;\n    char *key;\n    int rc;\n\n    while ((key = va_arg(args, char *)) != NULL) {\n\n        if (strlen(key) < 3) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"argument key '%s' is too short, missing type prefix\"),\n                           key);\n            return -1;\n        }\n\n        type = key[0];\n        key += 2;\n\n        /* This doesn't support maps, but no command uses those.  */\n        switch (type) {\n        case 'S':\n        case 's': {\n            char *val = va_arg(args, char *);\n            if (!val) {\n                if (type == 'S')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n            rc = virJSONValueObjectAppendString(obj, key, val);\n        }   break;\n\n        case 'z':\n        case 'y':\n        case 'j':\n        case 'i': {\n            int val = va_arg(args, int);\n\n            if (val < 0 && (type == 'j' || type == 'y')) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not be negative\"),\n                               key);\n                return -1;\n            }\n\n            if (!val && (type == 'z' || type == 'y'))\n                continue;\n\n            rc = virJSONValueObjectAppendNumberInt(obj, key, val);\n        }   break;\n\n        case 'p':\n        case 'u': {\n            unsigned int val = va_arg(args, unsigned int);\n\n            if (!val && type == 'p')\n                continue;\n\n            rc = virJSONValueObjectAppendNumberUint(obj, key, val);\n        }   break;\n\n        case 'Z':\n        case 'Y':\n        case 'J':\n        case 'I': {\n            long long val = va_arg(args, long long);\n\n            if (val < 0 && (type == 'J' || type == 'Y')) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not be negative\"),\n                               key);\n                return -1;\n            }\n\n            if (!val && (type == 'Z' || type == 'Y'))\n                continue;\n\n            rc = virJSONValueObjectAppendNumberLong(obj, key, val);\n        }   break;\n\n        case 'P':\n        case 'U': {\n            /* qemu silently truncates numbers larger than LLONG_MAX,\n             * so passing the full range of unsigned 64 bit integers\n             * is not safe here.  Pass them as signed 64 bit integers\n             * instead.\n             */\n            long long val = va_arg(args, long long);\n\n            if (!val && type == 'P')\n                continue;\n\n            rc = virJSONValueObjectAppendNumberLong(obj, key, val);\n        }   break;\n\n        case 'd': {\n            double val = va_arg(args, double);\n            rc = virJSONValueObjectAppendNumberDouble(obj, key, val);\n        }   break;\n\n        case 'T':\n        case 'B':\n        case 'b': {\n            int val = va_arg(args, int);\n\n            if (!val && type == 'B')\n                continue;\n\n            if (type == 'T') {\n                if (val == VIR_TRISTATE_BOOL_ABSENT)\n                    continue;\n\n                if (val == VIR_TRISTATE_BOOL_NO)\n                    val = 0;\n                else\n                    val = 1;\n            }\n\n            rc = virJSONValueObjectAppendBoolean(obj, key, val);\n        }   break;\n\n        case 'n': {\n            rc = virJSONValueObjectAppendNull(obj, key);\n        }   break;\n\n        case 'A':\n        case 'a': {\n            virJSONValuePtr *val = va_arg(args, virJSONValuePtr *);\n\n            if (!(*val)) {\n                if (type == 'A')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n\n            if ((rc = virJSONValueObjectAppend(obj, key, *val)) == 0)\n                *val = NULL;\n        }   break;\n\n        case 'M':\n        case 'm': {\n            virBitmapPtr map = va_arg(args, virBitmapPtr);\n            virJSONValuePtr jsonMap;\n\n            if (!map) {\n                if (type == 'M')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n\n            if (!(jsonMap = virJSONValueNewArrayFromBitmap(map)))\n                return -1;\n\n            if ((rc = virJSONValueObjectAppend(obj, key, jsonMap)) < 0)\n                virJSONValueFree(jsonMap);\n        } break;\n\n        default:\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unsupported data type '%c' for arg '%s'\"), type, key - 2);\n            return -1;\n        }\n\n        if (rc < 0)\n            return -1;\n    }\n\n    /* verify that we added at least one key-value pair */\n    if (virJSONValueObjectKeysNumber(obj) == 0)\n        return 0;\n\n    return 1;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAddVArgs(virJSONValuePtr obj,\n                           va_list args)\n{\n    char type;\n    char *key;\n    int rc;\n\n    while ((key = va_arg(args, char *)) != NULL) {\n\n        if (strlen(key) < 3) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"argument key '%s' is too short, missing type prefix\"),\n                           key);\n            return -1;\n        }\n\n        type = key[0];\n        key += 2;\n\n        /* This doesn't support maps, but no command uses those.  */\n        switch (type) {\n        case 'S':\n        case 's': {\n            char *val = va_arg(args, char *);\n            if (!val) {\n                if (type == 'S')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n            rc = virJSONValueObjectAppendString(obj, key, val);\n        }   break;\n\n        case 'z':\n        case 'y':\n        case 'j':\n        case 'i': {\n            int val = va_arg(args, int);\n\n            if (val < 0 && (type == 'j' || type == 'y')) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not be negative\"),\n                               key);\n                return -1;\n            }\n\n            if (!val && (type == 'z' || type == 'y'))\n                continue;\n\n            rc = virJSONValueObjectAppendNumberInt(obj, key, val);\n        }   break;\n\n        case 'p':\n        case 'u': {\n            unsigned int val = va_arg(args, unsigned int);\n\n            if (!val && type == 'p')\n                continue;\n\n            rc = virJSONValueObjectAppendNumberUint(obj, key, val);\n        }   break;\n\n        case 'Z':\n        case 'Y':\n        case 'J':\n        case 'I': {\n            long long val = va_arg(args, long long);\n\n            if (val < 0 && (type == 'J' || type == 'Y')) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not be negative\"),\n                               key);\n                return -1;\n            }\n\n            if (!val && (type == 'Z' || type == 'Y'))\n                continue;\n\n            rc = virJSONValueObjectAppendNumberLong(obj, key, val);\n        }   break;\n\n        case 'P':\n        case 'U': {\n            /* qemu silently truncates numbers larger than LLONG_MAX,\n             * so passing the full range of unsigned 64 bit integers\n             * is not safe here.  Pass them as signed 64 bit integers\n             * instead.\n             */\n            long long val = va_arg(args, long long);\n\n            if (!val && type == 'P')\n                continue;\n\n            rc = virJSONValueObjectAppendNumberLong(obj, key, val);\n        }   break;\n\n        case 'd': {\n            double val = va_arg(args, double);\n            rc = virJSONValueObjectAppendNumberDouble(obj, key, val);\n        }   break;\n\n        case 'T':\n        case 'B':\n        case 'b': {\n            int val = va_arg(args, int);\n\n            if (!val && type == 'B')\n                continue;\n\n            if (type == 'T') {\n                if (val == VIR_TRISTATE_BOOL_ABSENT)\n                    continue;\n\n                if (val == VIR_TRISTATE_BOOL_NO)\n                    val = 0;\n                else\n                    val = 1;\n            }\n\n            rc = virJSONValueObjectAppendBoolean(obj, key, val);\n        }   break;\n\n        case 'n': {\n            rc = virJSONValueObjectAppendNull(obj, key);\n        }   break;\n\n        case 'A':\n        case 'a': {\n            virJSONValuePtr *val = va_arg(args, virJSONValuePtr *);\n\n            if (!(*val)) {\n                if (type == 'A')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n\n            if ((rc = virJSONValueObjectAppend(obj, key, *val)) == 0)\n                *val = NULL;\n        }   break;\n\n        case 'M':\n        case 'm': {\n            virBitmapPtr map = va_arg(args, virBitmapPtr);\n            virJSONValuePtr jsonMap;\n\n            if (!map) {\n                if (type == 'M')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n\n            if (!(jsonMap = virJSONValueNewArrayFromBitmap(map)))\n                return -1;\n\n            if ((rc = virJSONValueObjectAppend(obj, key, jsonMap)) < 0)\n                virJSONValueFree(jsonMap);\n        } break;\n\n        default:\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unsupported data type '%c' for arg '%s'\"), type, key - 2);\n            return -1;\n        }\n\n        if (rc < 0)\n            return -1;\n    }\n\n    /* verify that we added at least one key-value pair */\n    if (virJSONValueObjectKeysNumber(obj) == 0)\n        return 0;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewObject",
          "args": [],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "571-579",
          "snippet": "virJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectCreateVArgs(virJSONValuePtr *obj,\n                              va_list args)\n{\n    int ret;\n\n    *obj = virJSONValueNewObject();\n\n    /* free the object on error, or if no value objects were added */\n    if ((ret = virJSONValueObjectAddVArgs(*obj, args)) <= 0) {\n        virJSONValueFree(*obj);\n        *obj = NULL;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virJSONValueObjectAdd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "345-356",
    "snippet": "int\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAddVArgs",
          "args": [
            "obj",
            "args"
          ],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAddVArgs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "157-342",
          "snippet": "int\nvirJSONValueObjectAddVArgs(virJSONValuePtr obj,\n                           va_list args)\n{\n    char type;\n    char *key;\n    int rc;\n\n    while ((key = va_arg(args, char *)) != NULL) {\n\n        if (strlen(key) < 3) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"argument key '%s' is too short, missing type prefix\"),\n                           key);\n            return -1;\n        }\n\n        type = key[0];\n        key += 2;\n\n        /* This doesn't support maps, but no command uses those.  */\n        switch (type) {\n        case 'S':\n        case 's': {\n            char *val = va_arg(args, char *);\n            if (!val) {\n                if (type == 'S')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n            rc = virJSONValueObjectAppendString(obj, key, val);\n        }   break;\n\n        case 'z':\n        case 'y':\n        case 'j':\n        case 'i': {\n            int val = va_arg(args, int);\n\n            if (val < 0 && (type == 'j' || type == 'y')) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not be negative\"),\n                               key);\n                return -1;\n            }\n\n            if (!val && (type == 'z' || type == 'y'))\n                continue;\n\n            rc = virJSONValueObjectAppendNumberInt(obj, key, val);\n        }   break;\n\n        case 'p':\n        case 'u': {\n            unsigned int val = va_arg(args, unsigned int);\n\n            if (!val && type == 'p')\n                continue;\n\n            rc = virJSONValueObjectAppendNumberUint(obj, key, val);\n        }   break;\n\n        case 'Z':\n        case 'Y':\n        case 'J':\n        case 'I': {\n            long long val = va_arg(args, long long);\n\n            if (val < 0 && (type == 'J' || type == 'Y')) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not be negative\"),\n                               key);\n                return -1;\n            }\n\n            if (!val && (type == 'Z' || type == 'Y'))\n                continue;\n\n            rc = virJSONValueObjectAppendNumberLong(obj, key, val);\n        }   break;\n\n        case 'P':\n        case 'U': {\n            /* qemu silently truncates numbers larger than LLONG_MAX,\n             * so passing the full range of unsigned 64 bit integers\n             * is not safe here.  Pass them as signed 64 bit integers\n             * instead.\n             */\n            long long val = va_arg(args, long long);\n\n            if (!val && type == 'P')\n                continue;\n\n            rc = virJSONValueObjectAppendNumberLong(obj, key, val);\n        }   break;\n\n        case 'd': {\n            double val = va_arg(args, double);\n            rc = virJSONValueObjectAppendNumberDouble(obj, key, val);\n        }   break;\n\n        case 'T':\n        case 'B':\n        case 'b': {\n            int val = va_arg(args, int);\n\n            if (!val && type == 'B')\n                continue;\n\n            if (type == 'T') {\n                if (val == VIR_TRISTATE_BOOL_ABSENT)\n                    continue;\n\n                if (val == VIR_TRISTATE_BOOL_NO)\n                    val = 0;\n                else\n                    val = 1;\n            }\n\n            rc = virJSONValueObjectAppendBoolean(obj, key, val);\n        }   break;\n\n        case 'n': {\n            rc = virJSONValueObjectAppendNull(obj, key);\n        }   break;\n\n        case 'A':\n        case 'a': {\n            virJSONValuePtr *val = va_arg(args, virJSONValuePtr *);\n\n            if (!(*val)) {\n                if (type == 'A')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n\n            if ((rc = virJSONValueObjectAppend(obj, key, *val)) == 0)\n                *val = NULL;\n        }   break;\n\n        case 'M':\n        case 'm': {\n            virBitmapPtr map = va_arg(args, virBitmapPtr);\n            virJSONValuePtr jsonMap;\n\n            if (!map) {\n                if (type == 'M')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n\n            if (!(jsonMap = virJSONValueNewArrayFromBitmap(map)))\n                return -1;\n\n            if ((rc = virJSONValueObjectAppend(obj, key, jsonMap)) < 0)\n                virJSONValueFree(jsonMap);\n        } break;\n\n        default:\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unsupported data type '%c' for arg '%s'\"), type, key - 2);\n            return -1;\n        }\n\n        if (rc < 0)\n            return -1;\n    }\n\n    /* verify that we added at least one key-value pair */\n    if (virJSONValueObjectKeysNumber(obj) == 0)\n        return 0;\n\n    return 1;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAddVArgs(virJSONValuePtr obj,\n                           va_list args)\n{\n    char type;\n    char *key;\n    int rc;\n\n    while ((key = va_arg(args, char *)) != NULL) {\n\n        if (strlen(key) < 3) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"argument key '%s' is too short, missing type prefix\"),\n                           key);\n            return -1;\n        }\n\n        type = key[0];\n        key += 2;\n\n        /* This doesn't support maps, but no command uses those.  */\n        switch (type) {\n        case 'S':\n        case 's': {\n            char *val = va_arg(args, char *);\n            if (!val) {\n                if (type == 'S')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n            rc = virJSONValueObjectAppendString(obj, key, val);\n        }   break;\n\n        case 'z':\n        case 'y':\n        case 'j':\n        case 'i': {\n            int val = va_arg(args, int);\n\n            if (val < 0 && (type == 'j' || type == 'y')) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not be negative\"),\n                               key);\n                return -1;\n            }\n\n            if (!val && (type == 'z' || type == 'y'))\n                continue;\n\n            rc = virJSONValueObjectAppendNumberInt(obj, key, val);\n        }   break;\n\n        case 'p':\n        case 'u': {\n            unsigned int val = va_arg(args, unsigned int);\n\n            if (!val && type == 'p')\n                continue;\n\n            rc = virJSONValueObjectAppendNumberUint(obj, key, val);\n        }   break;\n\n        case 'Z':\n        case 'Y':\n        case 'J':\n        case 'I': {\n            long long val = va_arg(args, long long);\n\n            if (val < 0 && (type == 'J' || type == 'Y')) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not be negative\"),\n                               key);\n                return -1;\n            }\n\n            if (!val && (type == 'Z' || type == 'Y'))\n                continue;\n\n            rc = virJSONValueObjectAppendNumberLong(obj, key, val);\n        }   break;\n\n        case 'P':\n        case 'U': {\n            /* qemu silently truncates numbers larger than LLONG_MAX,\n             * so passing the full range of unsigned 64 bit integers\n             * is not safe here.  Pass them as signed 64 bit integers\n             * instead.\n             */\n            long long val = va_arg(args, long long);\n\n            if (!val && type == 'P')\n                continue;\n\n            rc = virJSONValueObjectAppendNumberLong(obj, key, val);\n        }   break;\n\n        case 'd': {\n            double val = va_arg(args, double);\n            rc = virJSONValueObjectAppendNumberDouble(obj, key, val);\n        }   break;\n\n        case 'T':\n        case 'B':\n        case 'b': {\n            int val = va_arg(args, int);\n\n            if (!val && type == 'B')\n                continue;\n\n            if (type == 'T') {\n                if (val == VIR_TRISTATE_BOOL_ABSENT)\n                    continue;\n\n                if (val == VIR_TRISTATE_BOOL_NO)\n                    val = 0;\n                else\n                    val = 1;\n            }\n\n            rc = virJSONValueObjectAppendBoolean(obj, key, val);\n        }   break;\n\n        case 'n': {\n            rc = virJSONValueObjectAppendNull(obj, key);\n        }   break;\n\n        case 'A':\n        case 'a': {\n            virJSONValuePtr *val = va_arg(args, virJSONValuePtr *);\n\n            if (!(*val)) {\n                if (type == 'A')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n\n            if ((rc = virJSONValueObjectAppend(obj, key, *val)) == 0)\n                *val = NULL;\n        }   break;\n\n        case 'M':\n        case 'm': {\n            virBitmapPtr map = va_arg(args, virBitmapPtr);\n            virJSONValuePtr jsonMap;\n\n            if (!map) {\n                if (type == 'M')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n\n            if (!(jsonMap = virJSONValueNewArrayFromBitmap(map)))\n                return -1;\n\n            if ((rc = virJSONValueObjectAppend(obj, key, jsonMap)) < 0)\n                virJSONValueFree(jsonMap);\n        } break;\n\n        default:\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unsupported data type '%c' for arg '%s'\"), type, key - 2);\n            return -1;\n        }\n\n        if (rc < 0)\n            return -1;\n    }\n\n    /* verify that we added at least one key-value pair */\n    if (virJSONValueObjectKeysNumber(obj) == 0)\n        return 0;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "obj"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAdd(virJSONValuePtr obj, ...)\n{\n    va_list args;\n    int ret;\n\n    va_start(args, obj);\n    ret = virJSONValueObjectAddVArgs(obj, args);\n    va_end(args);\n\n    return ret;\n}"
  },
  {
    "function_name": "virJSONValueObjectAddVArgs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "157-342",
    "snippet": "int\nvirJSONValueObjectAddVArgs(virJSONValuePtr obj,\n                           va_list args)\n{\n    char type;\n    char *key;\n    int rc;\n\n    while ((key = va_arg(args, char *)) != NULL) {\n\n        if (strlen(key) < 3) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"argument key '%s' is too short, missing type prefix\"),\n                           key);\n            return -1;\n        }\n\n        type = key[0];\n        key += 2;\n\n        /* This doesn't support maps, but no command uses those.  */\n        switch (type) {\n        case 'S':\n        case 's': {\n            char *val = va_arg(args, char *);\n            if (!val) {\n                if (type == 'S')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n            rc = virJSONValueObjectAppendString(obj, key, val);\n        }   break;\n\n        case 'z':\n        case 'y':\n        case 'j':\n        case 'i': {\n            int val = va_arg(args, int);\n\n            if (val < 0 && (type == 'j' || type == 'y')) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not be negative\"),\n                               key);\n                return -1;\n            }\n\n            if (!val && (type == 'z' || type == 'y'))\n                continue;\n\n            rc = virJSONValueObjectAppendNumberInt(obj, key, val);\n        }   break;\n\n        case 'p':\n        case 'u': {\n            unsigned int val = va_arg(args, unsigned int);\n\n            if (!val && type == 'p')\n                continue;\n\n            rc = virJSONValueObjectAppendNumberUint(obj, key, val);\n        }   break;\n\n        case 'Z':\n        case 'Y':\n        case 'J':\n        case 'I': {\n            long long val = va_arg(args, long long);\n\n            if (val < 0 && (type == 'J' || type == 'Y')) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not be negative\"),\n                               key);\n                return -1;\n            }\n\n            if (!val && (type == 'Z' || type == 'Y'))\n                continue;\n\n            rc = virJSONValueObjectAppendNumberLong(obj, key, val);\n        }   break;\n\n        case 'P':\n        case 'U': {\n            /* qemu silently truncates numbers larger than LLONG_MAX,\n             * so passing the full range of unsigned 64 bit integers\n             * is not safe here.  Pass them as signed 64 bit integers\n             * instead.\n             */\n            long long val = va_arg(args, long long);\n\n            if (!val && type == 'P')\n                continue;\n\n            rc = virJSONValueObjectAppendNumberLong(obj, key, val);\n        }   break;\n\n        case 'd': {\n            double val = va_arg(args, double);\n            rc = virJSONValueObjectAppendNumberDouble(obj, key, val);\n        }   break;\n\n        case 'T':\n        case 'B':\n        case 'b': {\n            int val = va_arg(args, int);\n\n            if (!val && type == 'B')\n                continue;\n\n            if (type == 'T') {\n                if (val == VIR_TRISTATE_BOOL_ABSENT)\n                    continue;\n\n                if (val == VIR_TRISTATE_BOOL_NO)\n                    val = 0;\n                else\n                    val = 1;\n            }\n\n            rc = virJSONValueObjectAppendBoolean(obj, key, val);\n        }   break;\n\n        case 'n': {\n            rc = virJSONValueObjectAppendNull(obj, key);\n        }   break;\n\n        case 'A':\n        case 'a': {\n            virJSONValuePtr *val = va_arg(args, virJSONValuePtr *);\n\n            if (!(*val)) {\n                if (type == 'A')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n\n            if ((rc = virJSONValueObjectAppend(obj, key, *val)) == 0)\n                *val = NULL;\n        }   break;\n\n        case 'M':\n        case 'm': {\n            virBitmapPtr map = va_arg(args, virBitmapPtr);\n            virJSONValuePtr jsonMap;\n\n            if (!map) {\n                if (type == 'M')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n\n            if (!(jsonMap = virJSONValueNewArrayFromBitmap(map)))\n                return -1;\n\n            if ((rc = virJSONValueObjectAppend(obj, key, jsonMap)) < 0)\n                virJSONValueFree(jsonMap);\n        } break;\n\n        default:\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unsupported data type '%c' for arg '%s'\"), type, key - 2);\n            return -1;\n        }\n\n        if (rc < 0)\n            return -1;\n    }\n\n    /* verify that we added at least one key-value pair */\n    if (virJSONValueObjectKeysNumber(obj) == 0)\n        return 0;\n\n    return 1;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueObjectKeysNumber",
          "args": [
            "obj"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectKeysNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "928-935",
          "snippet": "int\nvirJSONValueObjectKeysNumber(virJSONValuePtr object)\n{\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    return object->data.object.npairs;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectKeysNumber(virJSONValuePtr object)\n{\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    return object->data.object.npairs;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unsupported data type '%c' for arg '%s'\")",
            "type",
            "key - 2"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unsupported data type '%c' for arg '%s'\""
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "jsonMap"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppend",
          "args": [
            "obj",
            "key",
            "jsonMap"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "741-754",
          "snippet": "int\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewArrayFromBitmap",
          "args": [
            "map"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewArrayFromBitmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1255-1281",
          "snippet": "virJSONValuePtr\nvirJSONValueNewArrayFromBitmap(virBitmapPtr bitmap)\n{\n    virJSONValuePtr ret;\n    ssize_t pos = -1;\n\n    ret = virJSONValueNewArray();\n\n    if (!bitmap)\n        return ret;\n\n    while ((pos = virBitmapNextSetBit(bitmap, pos)) > -1) {\n        virJSONValuePtr newelem;\n\n        if (!(newelem = virJSONValueNewNumberLong(pos)) ||\n            virJSONValueArrayAppend(ret, newelem) < 0) {\n            virJSONValueFree(newelem);\n            goto error;\n        }\n    }\n\n    return ret;\n\n error:\n    virJSONValueFree(ret);\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewArrayFromBitmap(virBitmapPtr bitmap)\n{\n    virJSONValuePtr ret;\n    ssize_t pos = -1;\n\n    ret = virJSONValueNewArray();\n\n    if (!bitmap)\n        return ret;\n\n    while ((pos = virBitmapNextSetBit(bitmap, pos)) > -1) {\n        virJSONValuePtr newelem;\n\n        if (!(newelem = virJSONValueNewNumberLong(pos)) ||\n            virJSONValueArrayAppend(ret, newelem) < 0) {\n            virJSONValueFree(newelem);\n            goto error;\n        }\n    }\n\n    return ret;\n\n error:\n    virJSONValueFree(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"argument key '%s' must not have null value\")",
            "key"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "virBitmapPtr"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"argument key '%s' must not have null value\")",
            "key"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "virJSONValuePtr*"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendNull",
          "args": [
            "obj",
            "key"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendNull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "757-769",
          "snippet": "int\nvirJSONValueObjectAppendNull(virJSONValuePtr object,\n                             const char *key)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNull();\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNull(virJSONValuePtr object,\n                             const char *key)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNull();\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "int"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendNumberDouble",
          "args": [
            "obj",
            "key",
            "val"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendNumberDouble",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "725-738",
          "snippet": "int\nvirJSONValueObjectAppendNumberDouble(virJSONValuePtr object,\n                                     const char *key,\n                                     double number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberDouble(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNumberDouble(virJSONValuePtr object,\n                                     const char *key,\n                                     double number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberDouble(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "double"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendNumberLong",
          "args": [
            "obj",
            "key",
            "val"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendNumberLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "693-706",
          "snippet": "int\nvirJSONValueObjectAppendNumberLong(virJSONValuePtr object,\n                                   const char *key,\n                                   long long number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberLong(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNumberLong(virJSONValuePtr object,\n                                   const char *key,\n                                   long long number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberLong(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "longlong"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"argument key '%s' must not be negative\")",
            "key"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "longlong"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendNumberUint",
          "args": [
            "obj",
            "key",
            "val"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendNumberUint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "677-690",
          "snippet": "int\nvirJSONValueObjectAppendNumberUint(virJSONValuePtr object,\n                                   const char *key,\n                                   unsigned int number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberUint(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNumberUint(virJSONValuePtr object,\n                                   const char *key,\n                                   unsigned int number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberUint(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "unsignedint"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendNumberInt",
          "args": [
            "obj",
            "key",
            "val"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendNumberInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "661-674",
          "snippet": "int\nvirJSONValueObjectAppendNumberInt(virJSONValuePtr object,\n                                  const char *key,\n                                  int number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberInt(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNumberInt(virJSONValuePtr object,\n                                  const char *key,\n                                  int number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberInt(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"argument key '%s' must not be negative\")",
            "key"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "int"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendString",
          "args": [
            "obj",
            "key",
            "val"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "643-649",
          "snippet": "int\nvirJSONValueObjectAppendString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, false);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"argument key '%s' must not have null value\")",
            "key"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "char*"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"argument key '%s' is too short, missing type prefix\")",
            "key"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "key"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "char*"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAddVArgs(virJSONValuePtr obj,\n                           va_list args)\n{\n    char type;\n    char *key;\n    int rc;\n\n    while ((key = va_arg(args, char *)) != NULL) {\n\n        if (strlen(key) < 3) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"argument key '%s' is too short, missing type prefix\"),\n                           key);\n            return -1;\n        }\n\n        type = key[0];\n        key += 2;\n\n        /* This doesn't support maps, but no command uses those.  */\n        switch (type) {\n        case 'S':\n        case 's': {\n            char *val = va_arg(args, char *);\n            if (!val) {\n                if (type == 'S')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n            rc = virJSONValueObjectAppendString(obj, key, val);\n        }   break;\n\n        case 'z':\n        case 'y':\n        case 'j':\n        case 'i': {\n            int val = va_arg(args, int);\n\n            if (val < 0 && (type == 'j' || type == 'y')) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not be negative\"),\n                               key);\n                return -1;\n            }\n\n            if (!val && (type == 'z' || type == 'y'))\n                continue;\n\n            rc = virJSONValueObjectAppendNumberInt(obj, key, val);\n        }   break;\n\n        case 'p':\n        case 'u': {\n            unsigned int val = va_arg(args, unsigned int);\n\n            if (!val && type == 'p')\n                continue;\n\n            rc = virJSONValueObjectAppendNumberUint(obj, key, val);\n        }   break;\n\n        case 'Z':\n        case 'Y':\n        case 'J':\n        case 'I': {\n            long long val = va_arg(args, long long);\n\n            if (val < 0 && (type == 'J' || type == 'Y')) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not be negative\"),\n                               key);\n                return -1;\n            }\n\n            if (!val && (type == 'Z' || type == 'Y'))\n                continue;\n\n            rc = virJSONValueObjectAppendNumberLong(obj, key, val);\n        }   break;\n\n        case 'P':\n        case 'U': {\n            /* qemu silently truncates numbers larger than LLONG_MAX,\n             * so passing the full range of unsigned 64 bit integers\n             * is not safe here.  Pass them as signed 64 bit integers\n             * instead.\n             */\n            long long val = va_arg(args, long long);\n\n            if (!val && type == 'P')\n                continue;\n\n            rc = virJSONValueObjectAppendNumberLong(obj, key, val);\n        }   break;\n\n        case 'd': {\n            double val = va_arg(args, double);\n            rc = virJSONValueObjectAppendNumberDouble(obj, key, val);\n        }   break;\n\n        case 'T':\n        case 'B':\n        case 'b': {\n            int val = va_arg(args, int);\n\n            if (!val && type == 'B')\n                continue;\n\n            if (type == 'T') {\n                if (val == VIR_TRISTATE_BOOL_ABSENT)\n                    continue;\n\n                if (val == VIR_TRISTATE_BOOL_NO)\n                    val = 0;\n                else\n                    val = 1;\n            }\n\n            rc = virJSONValueObjectAppendBoolean(obj, key, val);\n        }   break;\n\n        case 'n': {\n            rc = virJSONValueObjectAppendNull(obj, key);\n        }   break;\n\n        case 'A':\n        case 'a': {\n            virJSONValuePtr *val = va_arg(args, virJSONValuePtr *);\n\n            if (!(*val)) {\n                if (type == 'A')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n\n            if ((rc = virJSONValueObjectAppend(obj, key, *val)) == 0)\n                *val = NULL;\n        }   break;\n\n        case 'M':\n        case 'm': {\n            virBitmapPtr map = va_arg(args, virBitmapPtr);\n            virJSONValuePtr jsonMap;\n\n            if (!map) {\n                if (type == 'M')\n                    continue;\n\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"argument key '%s' must not have null value\"),\n                               key);\n                return -1;\n            }\n\n            if (!(jsonMap = virJSONValueNewArrayFromBitmap(map)))\n                return -1;\n\n            if ((rc = virJSONValueObjectAppend(obj, key, jsonMap)) < 0)\n                virJSONValueFree(jsonMap);\n        } break;\n\n        default:\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unsupported data type '%c' for arg '%s'\"), type, key - 2);\n            return -1;\n        }\n\n        if (rc < 0)\n            return -1;\n    }\n\n    /* verify that we added at least one key-value pair */\n    if (virJSONValueObjectKeysNumber(obj) == 0)\n        return 0;\n\n    return 1;\n}"
  },
  {
    "function_name": "virJSONValueGetType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
    "lines": "101-105",
    "snippet": "virJSONType\nvirJSONValueGetType(const virJSONValue *value)\n{\n    return value->type;\n}",
    "includes": [
      "# include <yajl/yajl_parse.h>",
      "# include <yajl/yajl_gen.h>",
      "#include \"virenum.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virjson.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONType\nvirJSONValueGetType(const virJSONValue *value)\n{\n    return value->type;\n}"
  }
]