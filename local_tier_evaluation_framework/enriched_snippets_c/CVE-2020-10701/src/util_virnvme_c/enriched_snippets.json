[
  {
    "function_name": "virNVMeDeviceListCreateReAttachList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "389-447",
    "snippet": "virPCIDeviceListPtr\nvirNVMeDeviceListCreateReAttachList(virNVMeDeviceListPtr activeList,\n                                    virNVMeDeviceListPtr toReAttachList)\n{\n    g_autoptr(virPCIDeviceList) pciDevices = NULL;\n    size_t i;\n\n    if (!(pciDevices = virPCIDeviceListNew()))\n        return NULL;\n\n    for (i = 0; i < toReAttachList->count; i++) {\n        const virNVMeDevice *d = toReAttachList->devs[i];\n        g_autoptr(virPCIDevice) pci = NULL;\n        size_t nused = 0;\n\n        /* Check if there is any other NVMe device with the same PCI address as\n         * @d. To simplify this, let's just count how many NVMe devices with\n         * the same PCI address there are on the @activeList. */\n        for (i = 0; i < activeList->count; i++) {\n            virNVMeDevicePtr other = activeList->devs[i];\n\n            if (!virPCIDeviceAddressEqual(&d->address, &other->address))\n                continue;\n\n            nused++;\n        }\n\n        /* Now, the following cases can happen:\n         * nused > 1  -> there are other NVMe device active, do NOT detach it\n         * nused == 1 -> we've found only @d on the @activeList, detach it\n         * nused == 0 -> huh, wait, what? @d is NOT on the @active list, how can\n         *               we reattach it?\n         */\n\n        if (nused == 0) {\n            /* Shouldn't happen (TM) */\n            g_autofree char *addrStr = virPCIDeviceAddressAsString(&d->address);\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"NVMe device %s namespace %u not found\"),\n                           NULLSTR(addrStr), d->namespace);\n            return NULL;\n        } else if (nused > 1) {\n            /* NVMe device is still in use */\n            continue;\n        }\n\n        /* nused == 1 -> detach the device */\n        if (!(pci = virNVMeDeviceCreatePCIDevice(d)))\n            return NULL;\n\n        if (virPCIDeviceListAdd(pciDevices, pci) < 0)\n            return NULL;\n\n        /* avoid freeing the device */\n        pci = NULL;\n    }\n\n    return g_steal_pointer(&pciDevices);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&pciDevices"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virPCIDeviceListAdd",
          "args": [
            "pciDevices",
            "pci"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceListAddCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1609-1621",
          "snippet": "int\nvirPCIDeviceListAddCopy(virPCIDeviceListPtr list, virPCIDevicePtr dev)\n{\n    g_autoptr(virPCIDevice) copy = virPCIDeviceCopy(dev);\n\n    if (!copy)\n        return -1;\n    if (virPCIDeviceListAdd(list, copy) < 0)\n        return -1;\n\n    copy = NULL;\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nint\nvirPCIDeviceListAddCopy(virPCIDeviceListPtr list, virPCIDevicePtr dev)\n{\n    g_autoptr(virPCIDevice) copy = virPCIDeviceCopy(dev);\n\n    if (!copy)\n        return -1;\n    if (virPCIDeviceListAdd(list, copy) < 0)\n        return -1;\n\n    copy = NULL;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNVMeDeviceCreatePCIDevice",
          "args": [
            "d"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "virNVMeDeviceCreatePCIDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
          "lines": "288-304",
          "snippet": "static virPCIDevicePtr\nvirNVMeDeviceCreatePCIDevice(const virNVMeDevice *nvme)\n{\n    g_autoptr(virPCIDevice) pci = NULL;\n\n    if (!(pci = virPCIDeviceNew(nvme->address.domain,\n                                nvme->address.bus,\n                                nvme->address.slot,\n                                nvme->address.function)))\n        return NULL;\n\n    /* NVMe devices must be bound to vfio */\n    virPCIDeviceSetStubDriver(pci, VIR_PCI_STUB_DRIVER_VFIO);\n    virPCIDeviceSetManaged(pci, nvme->managed);\n\n    return g_steal_pointer(&pci);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virpci.h\"",
            "#include \"virobject.h\"",
            "#include \"virnvme.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nstatic virPCIDevicePtr\nvirNVMeDeviceCreatePCIDevice(const virNVMeDevice *nvme)\n{\n    g_autoptr(virPCIDevice) pci = NULL;\n\n    if (!(pci = virPCIDeviceNew(nvme->address.domain,\n                                nvme->address.bus,\n                                nvme->address.slot,\n                                nvme->address.function)))\n        return NULL;\n\n    /* NVMe devices must be bound to vfio */\n    virPCIDeviceSetStubDriver(pci, VIR_PCI_STUB_DRIVER_VFIO);\n    virPCIDeviceSetManaged(pci, nvme->managed);\n\n    return g_steal_pointer(&pci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"NVMe device %s namespace %u not found\")",
            "NULLSTR(addrStr)",
            "d->namespace"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "addrStr"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"NVMe device %s namespace %u not found\""
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceAddressAsString",
          "args": [
            "&d->address"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressAsString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1351-1362",
          "snippet": "char *\nvirPCIDeviceAddressAsString(const virPCIDeviceAddress *addr)\n{\n    char *str;\n\n    str = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                          addr->domain,\n                          addr->bus,\n                          addr->slot,\n                          addr->function);\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nchar *\nvirPCIDeviceAddressAsString(const virPCIDeviceAddress *addr)\n{\n    char *str;\n\n    str = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                          addr->domain,\n                          addr->bus,\n                          addr->slot,\n                          addr->function);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceAddressEqual",
          "args": [
            "&d->address",
            "&other->address"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1324-1335",
          "snippet": "bool\nvirPCIDeviceAddressEqual(const virPCIDeviceAddress *addr1,\n                         const virPCIDeviceAddress *addr2)\n{\n    if (addr1->domain == addr2->domain &&\n        addr1->bus == addr2->bus &&\n        addr1->slot == addr2->slot &&\n        addr1->function == addr2->function) {\n        return true;\n    }\n    return false;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nbool\nvirPCIDeviceAddressEqual(const virPCIDeviceAddress *addr1,\n                         const virPCIDeviceAddress *addr2)\n{\n    if (addr1->domain == addr2->domain &&\n        addr1->bus == addr2->bus &&\n        addr1->slot == addr2->slot &&\n        addr1->function == addr2->function) {\n        return true;\n    }\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceListNew",
          "args": [],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceListNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1566-1578",
          "snippet": "virPCIDeviceListPtr\nvirPCIDeviceListNew(void)\n{\n    virPCIDeviceListPtr list;\n\n    if (virPCIInitialize() < 0)\n        return NULL;\n\n    if (!(list = virObjectLockableNew(virPCIDeviceListClass)))\n        return NULL;\n\n    return list;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virPCIDeviceListClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nstatic virClassPtr virPCIDeviceListClass;\n\nvirPCIDeviceListPtr\nvirPCIDeviceListNew(void)\n{\n    virPCIDeviceListPtr list;\n\n    if (virPCIInitialize() < 0)\n        return NULL;\n\n    if (!(list = virObjectLockableNew(virPCIDeviceListClass)))\n        return NULL;\n\n    return list;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nvirPCIDeviceListPtr\nvirNVMeDeviceListCreateReAttachList(virNVMeDeviceListPtr activeList,\n                                    virNVMeDeviceListPtr toReAttachList)\n{\n    g_autoptr(virPCIDeviceList) pciDevices = NULL;\n    size_t i;\n\n    if (!(pciDevices = virPCIDeviceListNew()))\n        return NULL;\n\n    for (i = 0; i < toReAttachList->count; i++) {\n        const virNVMeDevice *d = toReAttachList->devs[i];\n        g_autoptr(virPCIDevice) pci = NULL;\n        size_t nused = 0;\n\n        /* Check if there is any other NVMe device with the same PCI address as\n         * @d. To simplify this, let's just count how many NVMe devices with\n         * the same PCI address there are on the @activeList. */\n        for (i = 0; i < activeList->count; i++) {\n            virNVMeDevicePtr other = activeList->devs[i];\n\n            if (!virPCIDeviceAddressEqual(&d->address, &other->address))\n                continue;\n\n            nused++;\n        }\n\n        /* Now, the following cases can happen:\n         * nused > 1  -> there are other NVMe device active, do NOT detach it\n         * nused == 1 -> we've found only @d on the @activeList, detach it\n         * nused == 0 -> huh, wait, what? @d is NOT on the @active list, how can\n         *               we reattach it?\n         */\n\n        if (nused == 0) {\n            /* Shouldn't happen (TM) */\n            g_autofree char *addrStr = virPCIDeviceAddressAsString(&d->address);\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"NVMe device %s namespace %u not found\"),\n                           NULLSTR(addrStr), d->namespace);\n            return NULL;\n        } else if (nused > 1) {\n            /* NVMe device is still in use */\n            continue;\n        }\n\n        /* nused == 1 -> detach the device */\n        if (!(pci = virNVMeDeviceCreatePCIDevice(d)))\n            return NULL;\n\n        if (virPCIDeviceListAdd(pciDevices, pci) < 0)\n            return NULL;\n\n        /* avoid freeing the device */\n        pci = NULL;\n    }\n\n    return g_steal_pointer(&pciDevices);\n}"
  },
  {
    "function_name": "virNVMeDeviceListCreateDetachList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "323-365",
    "snippet": "virPCIDeviceListPtr\nvirNVMeDeviceListCreateDetachList(virNVMeDeviceListPtr activeList,\n                                  virNVMeDeviceListPtr toDetachList)\n{\n    g_autoptr(virPCIDeviceList) pciDevices = NULL;\n    size_t i;\n\n    if (!(pciDevices = virPCIDeviceListNew()))\n        return NULL;\n\n    for (i = 0; i < toDetachList->count; i++) {\n        const virNVMeDevice *d = toDetachList->devs[i];\n        g_autoptr(virPCIDevice) pci = NULL;\n\n        /* If there is a NVMe device with the same PCI address on\n         * the activeList, the device is already detached. */\n        if (virNVMeDeviceListLookupByPCIAddress(activeList, &d->address))\n            continue;\n\n        /* It may happen that we want to detach two namespaces\n         * from the same NVMe device. This will be represented as\n         * two different instances of virNVMeDevice, but\n         * obviously we want to put the PCI device on the detach\n         * list only once. */\n        if (virPCIDeviceListFindByIDs(pciDevices,\n                                      d->address.domain,\n                                      d->address.bus,\n                                      d->address.slot,\n                                      d->address.function))\n            continue;\n\n        if (!(pci = virNVMeDeviceCreatePCIDevice(d)))\n            return NULL;\n\n        if (virPCIDeviceListAdd(pciDevices, pci) < 0)\n            return NULL;\n\n        /* avoid freeing the device */\n        pci = NULL;\n    }\n\n    return g_steal_pointer(&pciDevices);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&pciDevices"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virPCIDeviceListAdd",
          "args": [
            "pciDevices",
            "pci"
          ],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceListAddCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1609-1621",
          "snippet": "int\nvirPCIDeviceListAddCopy(virPCIDeviceListPtr list, virPCIDevicePtr dev)\n{\n    g_autoptr(virPCIDevice) copy = virPCIDeviceCopy(dev);\n\n    if (!copy)\n        return -1;\n    if (virPCIDeviceListAdd(list, copy) < 0)\n        return -1;\n\n    copy = NULL;\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nint\nvirPCIDeviceListAddCopy(virPCIDeviceListPtr list, virPCIDevicePtr dev)\n{\n    g_autoptr(virPCIDevice) copy = virPCIDeviceCopy(dev);\n\n    if (!copy)\n        return -1;\n    if (virPCIDeviceListAdd(list, copy) < 0)\n        return -1;\n\n    copy = NULL;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNVMeDeviceCreatePCIDevice",
          "args": [
            "d"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "virNVMeDeviceCreatePCIDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
          "lines": "288-304",
          "snippet": "static virPCIDevicePtr\nvirNVMeDeviceCreatePCIDevice(const virNVMeDevice *nvme)\n{\n    g_autoptr(virPCIDevice) pci = NULL;\n\n    if (!(pci = virPCIDeviceNew(nvme->address.domain,\n                                nvme->address.bus,\n                                nvme->address.slot,\n                                nvme->address.function)))\n        return NULL;\n\n    /* NVMe devices must be bound to vfio */\n    virPCIDeviceSetStubDriver(pci, VIR_PCI_STUB_DRIVER_VFIO);\n    virPCIDeviceSetManaged(pci, nvme->managed);\n\n    return g_steal_pointer(&pci);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virpci.h\"",
            "#include \"virobject.h\"",
            "#include \"virnvme.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nstatic virPCIDevicePtr\nvirNVMeDeviceCreatePCIDevice(const virNVMeDevice *nvme)\n{\n    g_autoptr(virPCIDevice) pci = NULL;\n\n    if (!(pci = virPCIDeviceNew(nvme->address.domain,\n                                nvme->address.bus,\n                                nvme->address.slot,\n                                nvme->address.function)))\n        return NULL;\n\n    /* NVMe devices must be bound to vfio */\n    virPCIDeviceSetStubDriver(pci, VIR_PCI_STUB_DRIVER_VFIO);\n    virPCIDeviceSetManaged(pci, nvme->managed);\n\n    return g_steal_pointer(&pci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceListFindByIDs",
          "args": [
            "pciDevices",
            "d->address.domain",
            "d->address.bus",
            "d->address.slot",
            "d->address.function"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceListFindByIDs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1687-1705",
          "snippet": "virPCIDevicePtr\nvirPCIDeviceListFindByIDs(virPCIDeviceListPtr list,\n                          unsigned int domain,\n                          unsigned int bus,\n                          unsigned int slot,\n                          unsigned int function)\n{\n    size_t i;\n\n    for (i = 0; i < list->count; i++) {\n        virPCIDevicePtr other = list->devs[i];\n        if (other->address.domain   == domain &&\n            other->address.bus      == bus    &&\n            other->address.slot     == slot   &&\n            other->address.function == function)\n            return list->devs[i];\n    }\n    return NULL;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nvirPCIDevicePtr\nvirPCIDeviceListFindByIDs(virPCIDeviceListPtr list,\n                          unsigned int domain,\n                          unsigned int bus,\n                          unsigned int slot,\n                          unsigned int function)\n{\n    size_t i;\n\n    for (i = 0; i < list->count; i++) {\n        virPCIDevicePtr other = list->devs[i];\n        if (other->address.domain   == domain &&\n            other->address.bus      == bus    &&\n            other->address.slot     == slot   &&\n            other->address.function == function)\n            return list->devs[i];\n    }\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNVMeDeviceListLookupByPCIAddress",
          "args": [
            "activeList",
            "&d->address"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "virNVMeDeviceListLookupByPCIAddress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
          "lines": "268-285",
          "snippet": "static virNVMeDevicePtr\nvirNVMeDeviceListLookupByPCIAddress(virNVMeDeviceListPtr list,\n                                    const virPCIDeviceAddress *address)\n{\n    size_t i;\n\n    if (!list)\n        return NULL;\n\n    for (i = 0; i < list->count; i++) {\n        virNVMeDevicePtr other = list->devs[i];\n\n        if (virPCIDeviceAddressEqual(address, &other->address))\n            return other;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virpci.h\"",
            "#include \"virobject.h\"",
            "#include \"virnvme.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nstatic virNVMeDevicePtr\nvirNVMeDeviceListLookupByPCIAddress(virNVMeDeviceListPtr list,\n                                    const virPCIDeviceAddress *address)\n{\n    size_t i;\n\n    if (!list)\n        return NULL;\n\n    for (i = 0; i < list->count; i++) {\n        virNVMeDevicePtr other = list->devs[i];\n\n        if (virPCIDeviceAddressEqual(address, &other->address))\n            return other;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceListNew",
          "args": [],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceListNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1566-1578",
          "snippet": "virPCIDeviceListPtr\nvirPCIDeviceListNew(void)\n{\n    virPCIDeviceListPtr list;\n\n    if (virPCIInitialize() < 0)\n        return NULL;\n\n    if (!(list = virObjectLockableNew(virPCIDeviceListClass)))\n        return NULL;\n\n    return list;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virPCIDeviceListClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nstatic virClassPtr virPCIDeviceListClass;\n\nvirPCIDeviceListPtr\nvirPCIDeviceListNew(void)\n{\n    virPCIDeviceListPtr list;\n\n    if (virPCIInitialize() < 0)\n        return NULL;\n\n    if (!(list = virObjectLockableNew(virPCIDeviceListClass)))\n        return NULL;\n\n    return list;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nvirPCIDeviceListPtr\nvirNVMeDeviceListCreateDetachList(virNVMeDeviceListPtr activeList,\n                                  virNVMeDeviceListPtr toDetachList)\n{\n    g_autoptr(virPCIDeviceList) pciDevices = NULL;\n    size_t i;\n\n    if (!(pciDevices = virPCIDeviceListNew()))\n        return NULL;\n\n    for (i = 0; i < toDetachList->count; i++) {\n        const virNVMeDevice *d = toDetachList->devs[i];\n        g_autoptr(virPCIDevice) pci = NULL;\n\n        /* If there is a NVMe device with the same PCI address on\n         * the activeList, the device is already detached. */\n        if (virNVMeDeviceListLookupByPCIAddress(activeList, &d->address))\n            continue;\n\n        /* It may happen that we want to detach two namespaces\n         * from the same NVMe device. This will be represented as\n         * two different instances of virNVMeDevice, but\n         * obviously we want to put the PCI device on the detach\n         * list only once. */\n        if (virPCIDeviceListFindByIDs(pciDevices,\n                                      d->address.domain,\n                                      d->address.bus,\n                                      d->address.slot,\n                                      d->address.function))\n            continue;\n\n        if (!(pci = virNVMeDeviceCreatePCIDevice(d)))\n            return NULL;\n\n        if (virPCIDeviceListAdd(pciDevices, pci) < 0)\n            return NULL;\n\n        /* avoid freeing the device */\n        pci = NULL;\n    }\n\n    return g_steal_pointer(&pciDevices);\n}"
  },
  {
    "function_name": "virNVMeDeviceCreatePCIDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "288-304",
    "snippet": "static virPCIDevicePtr\nvirNVMeDeviceCreatePCIDevice(const virNVMeDevice *nvme)\n{\n    g_autoptr(virPCIDevice) pci = NULL;\n\n    if (!(pci = virPCIDeviceNew(nvme->address.domain,\n                                nvme->address.bus,\n                                nvme->address.slot,\n                                nvme->address.function)))\n        return NULL;\n\n    /* NVMe devices must be bound to vfio */\n    virPCIDeviceSetStubDriver(pci, VIR_PCI_STUB_DRIVER_VFIO);\n    virPCIDeviceSetManaged(pci, nvme->managed);\n\n    return g_steal_pointer(&pci);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&pci"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virPCIDeviceSetManaged",
          "args": [
            "pci",
            "nvme->managed"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceSetManaged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1485-1488",
          "snippet": "void virPCIDeviceSetManaged(virPCIDevicePtr dev, bool managed)\n{\n    dev->managed = managed;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nvoid virPCIDeviceSetManaged(virPCIDevicePtr dev, bool managed)\n{\n    dev->managed = managed;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceSetStubDriver",
          "args": [
            "pci",
            "VIR_PCI_STUB_DRIVER_VFIO"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceSetStubDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1496-1500",
          "snippet": "void\nvirPCIDeviceSetStubDriver(virPCIDevicePtr dev, virPCIStubDriver driver)\n{\n    dev->stubDriver = driver;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nvoid\nvirPCIDeviceSetStubDriver(virPCIDevicePtr dev, virPCIStubDriver driver)\n{\n    dev->stubDriver = driver;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceNew",
          "args": [
            "nvme->address.domain",
            "nvme->address.bus",
            "nvme->address.slot",
            "nvme->address.function"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1364-1416",
          "snippet": "virPCIDevicePtr\nvirPCIDeviceNew(unsigned int domain,\n                unsigned int bus,\n                unsigned int slot,\n                unsigned int function)\n{\n    g_autoptr(virPCIDevice) dev = NULL;\n    g_autofree char *vendor = NULL;\n    g_autofree char *product = NULL;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    dev->address.domain = domain;\n    dev->address.bus = bus;\n    dev->address.slot = slot;\n    dev->address.function = function;\n\n    dev->name = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT, domain, bus, slot,\n                                function);\n\n    dev->path = g_strdup_printf(PCI_SYSFS \"devices/%s/config\", dev->name);\n\n    if (!virFileExists(dev->path)) {\n        virReportSystemError(errno,\n                             _(\"Device %s not found: could not access %s\"),\n                             dev->name, dev->path);\n        return NULL;\n    }\n\n    vendor  = virPCIDeviceReadID(dev, \"vendor\");\n    product = virPCIDeviceReadID(dev, \"device\");\n\n    if (!vendor || !product) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to read product/vendor ID for %s\"),\n                       dev->name);\n        return NULL;\n    }\n\n    /* strings contain '0x' prefix */\n    if (g_snprintf(dev->id, sizeof(dev->id), \"%s %s\", &vendor[2],\n                   &product[2]) >= sizeof(dev->id)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"dev->id buffer overflow: %s %s\"),\n                       &vendor[2], &product[2]);\n        return NULL;\n    }\n\n    VIR_DEBUG(\"%s %s: initialized\", dev->id, dev->name);\n\n    return g_steal_pointer(&dev);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PCI_SYSFS \"/sys/bus/pci/\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\n#define PCI_SYSFS \"/sys/bus/pci/\"\n\nvirPCIDevicePtr\nvirPCIDeviceNew(unsigned int domain,\n                unsigned int bus,\n                unsigned int slot,\n                unsigned int function)\n{\n    g_autoptr(virPCIDevice) dev = NULL;\n    g_autofree char *vendor = NULL;\n    g_autofree char *product = NULL;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    dev->address.domain = domain;\n    dev->address.bus = bus;\n    dev->address.slot = slot;\n    dev->address.function = function;\n\n    dev->name = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT, domain, bus, slot,\n                                function);\n\n    dev->path = g_strdup_printf(PCI_SYSFS \"devices/%s/config\", dev->name);\n\n    if (!virFileExists(dev->path)) {\n        virReportSystemError(errno,\n                             _(\"Device %s not found: could not access %s\"),\n                             dev->name, dev->path);\n        return NULL;\n    }\n\n    vendor  = virPCIDeviceReadID(dev, \"vendor\");\n    product = virPCIDeviceReadID(dev, \"device\");\n\n    if (!vendor || !product) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to read product/vendor ID for %s\"),\n                       dev->name);\n        return NULL;\n    }\n\n    /* strings contain '0x' prefix */\n    if (g_snprintf(dev->id, sizeof(dev->id), \"%s %s\", &vendor[2],\n                   &product[2]) >= sizeof(dev->id)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"dev->id buffer overflow: %s %s\"),\n                       &vendor[2], &product[2]);\n        return NULL;\n    }\n\n    VIR_DEBUG(\"%s %s: initialized\", dev->id, dev->name);\n\n    return g_steal_pointer(&dev);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nstatic virPCIDevicePtr\nvirNVMeDeviceCreatePCIDevice(const virNVMeDevice *nvme)\n{\n    g_autoptr(virPCIDevice) pci = NULL;\n\n    if (!(pci = virPCIDeviceNew(nvme->address.domain,\n                                nvme->address.bus,\n                                nvme->address.slot,\n                                nvme->address.function)))\n        return NULL;\n\n    /* NVMe devices must be bound to vfio */\n    virPCIDeviceSetStubDriver(pci, VIR_PCI_STUB_DRIVER_VFIO);\n    virPCIDeviceSetManaged(pci, nvme->managed);\n\n    return g_steal_pointer(&pci);\n}"
  },
  {
    "function_name": "virNVMeDeviceListLookupByPCIAddress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "268-285",
    "snippet": "static virNVMeDevicePtr\nvirNVMeDeviceListLookupByPCIAddress(virNVMeDeviceListPtr list,\n                                    const virPCIDeviceAddress *address)\n{\n    size_t i;\n\n    if (!list)\n        return NULL;\n\n    for (i = 0; i < list->count; i++) {\n        virNVMeDevicePtr other = list->devs[i];\n\n        if (virPCIDeviceAddressEqual(address, &other->address))\n            return other;\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virPCIDeviceAddressEqual",
          "args": [
            "address",
            "&other->address"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1324-1335",
          "snippet": "bool\nvirPCIDeviceAddressEqual(const virPCIDeviceAddress *addr1,\n                         const virPCIDeviceAddress *addr2)\n{\n    if (addr1->domain == addr2->domain &&\n        addr1->bus == addr2->bus &&\n        addr1->slot == addr2->slot &&\n        addr1->function == addr2->function) {\n        return true;\n    }\n    return false;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nbool\nvirPCIDeviceAddressEqual(const virPCIDeviceAddress *addr1,\n                         const virPCIDeviceAddress *addr2)\n{\n    if (addr1->domain == addr2->domain &&\n        addr1->bus == addr2->bus &&\n        addr1->slot == addr2->slot &&\n        addr1->function == addr2->function) {\n        return true;\n    }\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nstatic virNVMeDevicePtr\nvirNVMeDeviceListLookupByPCIAddress(virNVMeDeviceListPtr list,\n                                    const virPCIDeviceAddress *address)\n{\n    size_t i;\n\n    if (!list)\n        return NULL;\n\n    for (i = 0; i < list->count; i++) {\n        virNVMeDevicePtr other = list->devs[i];\n\n        if (virPCIDeviceAddressEqual(address, &other->address))\n            return other;\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "virNVMeDeviceListLookupIndex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "247-265",
    "snippet": "ssize_t\nvirNVMeDeviceListLookupIndex(virNVMeDeviceListPtr list,\n                             const virNVMeDevice *dev)\n{\n    size_t i;\n\n    if (!list)\n        return -1;\n\n    for (i = 0; i < list->count; i++) {\n        virNVMeDevicePtr other = list->devs[i];\n\n        if (virPCIDeviceAddressEqual(&dev->address, &other->address) &&\n            dev->namespace == other->namespace)\n            return i;\n    }\n\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virPCIDeviceAddressEqual",
          "args": [
            "&dev->address",
            "&other->address"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1324-1335",
          "snippet": "bool\nvirPCIDeviceAddressEqual(const virPCIDeviceAddress *addr1,\n                         const virPCIDeviceAddress *addr2)\n{\n    if (addr1->domain == addr2->domain &&\n        addr1->bus == addr2->bus &&\n        addr1->slot == addr2->slot &&\n        addr1->function == addr2->function) {\n        return true;\n    }\n    return false;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nbool\nvirPCIDeviceAddressEqual(const virPCIDeviceAddress *addr1,\n                         const virPCIDeviceAddress *addr2)\n{\n    if (addr1->domain == addr2->domain &&\n        addr1->bus == addr2->bus &&\n        addr1->slot == addr2->slot &&\n        addr1->function == addr2->function) {\n        return true;\n    }\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nssize_t\nvirNVMeDeviceListLookupIndex(virNVMeDeviceListPtr list,\n                             const virNVMeDevice *dev)\n{\n    size_t i;\n\n    if (!list)\n        return -1;\n\n    for (i = 0; i < list->count; i++) {\n        virNVMeDevicePtr other = list->devs[i];\n\n        if (virPCIDeviceAddressEqual(&dev->address, &other->address) &&\n            dev->namespace == other->namespace)\n            return i;\n    }\n\n    return -1;\n}"
  },
  {
    "function_name": "virNVMeDeviceListLookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "234-244",
    "snippet": "virNVMeDevicePtr\nvirNVMeDeviceListLookup(virNVMeDeviceListPtr list,\n                        const virNVMeDevice *dev)\n{\n    ssize_t idx;\n\n    if ((idx = virNVMeDeviceListLookupIndex(list, dev)) < 0)\n        return NULL;\n\n    return list->devs[idx];\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNVMeDeviceListLookupIndex",
          "args": [
            "list",
            "dev"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "virNVMeDeviceListLookupIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
          "lines": "247-265",
          "snippet": "ssize_t\nvirNVMeDeviceListLookupIndex(virNVMeDeviceListPtr list,\n                             const virNVMeDevice *dev)\n{\n    size_t i;\n\n    if (!list)\n        return -1;\n\n    for (i = 0; i < list->count; i++) {\n        virNVMeDevicePtr other = list->devs[i];\n\n        if (virPCIDeviceAddressEqual(&dev->address, &other->address) &&\n            dev->namespace == other->namespace)\n            return i;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virpci.h\"",
            "#include \"virobject.h\"",
            "#include \"virnvme.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nssize_t\nvirNVMeDeviceListLookupIndex(virNVMeDeviceListPtr list,\n                             const virNVMeDevice *dev)\n{\n    size_t i;\n\n    if (!list)\n        return -1;\n\n    for (i = 0; i < list->count; i++) {\n        virNVMeDevicePtr other = list->devs[i];\n\n        if (virPCIDeviceAddressEqual(&dev->address, &other->address) &&\n            dev->namespace == other->namespace)\n            return i;\n    }\n\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nvirNVMeDevicePtr\nvirNVMeDeviceListLookup(virNVMeDeviceListPtr list,\n                        const virNVMeDevice *dev)\n{\n    ssize_t idx;\n\n    if ((idx = virNVMeDeviceListLookupIndex(list, dev)) < 0)\n        return NULL;\n\n    return list->devs[idx];\n}"
  },
  {
    "function_name": "virNVMeDeviceListGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "226-231",
    "snippet": "virNVMeDevicePtr\nvirNVMeDeviceListGet(virNVMeDeviceListPtr list,\n                     size_t i)\n{\n    return i < list->count ? list->devs[i] : NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nvirNVMeDevicePtr\nvirNVMeDeviceListGet(virNVMeDeviceListPtr list,\n                     size_t i)\n{\n    return i < list->count ? list->devs[i] : NULL;\n}"
  },
  {
    "function_name": "virNVMeDeviceListDel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "204-223",
    "snippet": "int\nvirNVMeDeviceListDel(virNVMeDeviceListPtr list,\n                     const virNVMeDevice *dev)\n{\n    ssize_t idx;\n    virNVMeDevicePtr tmp = NULL;\n\n    if ((idx = virNVMeDeviceListLookupIndex(list, dev)) < 0) {\n        g_autofree char *addrStr = virPCIDeviceAddressAsString(&dev->address);\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"NVMe device %s namespace %u not found\"),\n                       NULLSTR(addrStr), dev->namespace);\n        return -1;\n    }\n\n    tmp = list->devs[idx];\n    VIR_DELETE_ELEMENT(list->devs, idx, list->count);\n    virNVMeDeviceFree(tmp);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNVMeDeviceFree",
          "args": [
            "tmp"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "virNVMeDeviceFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
          "lines": "82-90",
          "snippet": "void\nvirNVMeDeviceFree(virNVMeDevicePtr dev)\n{\n    if (!dev)\n        return;\n\n    virNVMeDeviceUsedByClear(dev);\n    VIR_FREE(dev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virpci.h\"",
            "#include \"virobject.h\"",
            "#include \"virnvme.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nvoid\nvirNVMeDeviceFree(virNVMeDevicePtr dev)\n{\n    if (!dev)\n        return;\n\n    virNVMeDeviceUsedByClear(dev);\n    VIR_FREE(dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DELETE_ELEMENT",
          "args": [
            "list->devs",
            "idx",
            "list->count"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"NVMe device %s namespace %u not found\")",
            "NULLSTR(addrStr)",
            "dev->namespace"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "addrStr"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"NVMe device %s namespace %u not found\""
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceAddressAsString",
          "args": [
            "&dev->address"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressAsString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1351-1362",
          "snippet": "char *\nvirPCIDeviceAddressAsString(const virPCIDeviceAddress *addr)\n{\n    char *str;\n\n    str = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                          addr->domain,\n                          addr->bus,\n                          addr->slot,\n                          addr->function);\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nchar *\nvirPCIDeviceAddressAsString(const virPCIDeviceAddress *addr)\n{\n    char *str;\n\n    str = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                          addr->domain,\n                          addr->bus,\n                          addr->slot,\n                          addr->function);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNVMeDeviceListLookupIndex",
          "args": [
            "list",
            "dev"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "virNVMeDeviceListLookupIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
          "lines": "247-265",
          "snippet": "ssize_t\nvirNVMeDeviceListLookupIndex(virNVMeDeviceListPtr list,\n                             const virNVMeDevice *dev)\n{\n    size_t i;\n\n    if (!list)\n        return -1;\n\n    for (i = 0; i < list->count; i++) {\n        virNVMeDevicePtr other = list->devs[i];\n\n        if (virPCIDeviceAddressEqual(&dev->address, &other->address) &&\n            dev->namespace == other->namespace)\n            return i;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virpci.h\"",
            "#include \"virobject.h\"",
            "#include \"virnvme.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nssize_t\nvirNVMeDeviceListLookupIndex(virNVMeDeviceListPtr list,\n                             const virNVMeDevice *dev)\n{\n    size_t i;\n\n    if (!list)\n        return -1;\n\n    for (i = 0; i < list->count; i++) {\n        virNVMeDevicePtr other = list->devs[i];\n\n        if (virPCIDeviceAddressEqual(&dev->address, &other->address) &&\n            dev->namespace == other->namespace)\n            return i;\n    }\n\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nint\nvirNVMeDeviceListDel(virNVMeDeviceListPtr list,\n                     const virNVMeDevice *dev)\n{\n    ssize_t idx;\n    virNVMeDevicePtr tmp = NULL;\n\n    if ((idx = virNVMeDeviceListLookupIndex(list, dev)) < 0) {\n        g_autofree char *addrStr = virPCIDeviceAddressAsString(&dev->address);\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"NVMe device %s namespace %u not found\"),\n                       NULLSTR(addrStr), dev->namespace);\n        return -1;\n    }\n\n    tmp = list->devs[idx];\n    VIR_DELETE_ELEMENT(list->devs, idx, list->count);\n    virNVMeDeviceFree(tmp);\n    return 0;\n}"
  },
  {
    "function_name": "virNVMeDeviceListAdd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "180-201",
    "snippet": "int\nvirNVMeDeviceListAdd(virNVMeDeviceListPtr list,\n                     const virNVMeDevice *dev)\n{\n    virNVMeDevicePtr tmp;\n\n    if ((tmp = virNVMeDeviceListLookup(list, dev))) {\n        g_autofree char *addrStr = virPCIDeviceAddressAsString(&tmp->address);\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"NVMe device %s namespace %u is already on the list\"),\n                       NULLSTR(addrStr), tmp->namespace);\n        return -1;\n    }\n\n    if (!(tmp = virNVMeDeviceCopy(dev)) ||\n        VIR_APPEND_ELEMENT(list->devs, list->count, tmp) < 0) {\n        virNVMeDeviceFree(tmp);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNVMeDeviceFree",
          "args": [
            "tmp"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "virNVMeDeviceFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
          "lines": "82-90",
          "snippet": "void\nvirNVMeDeviceFree(virNVMeDevicePtr dev)\n{\n    if (!dev)\n        return;\n\n    virNVMeDeviceUsedByClear(dev);\n    VIR_FREE(dev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virpci.h\"",
            "#include \"virobject.h\"",
            "#include \"virnvme.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nvoid\nvirNVMeDeviceFree(virNVMeDevicePtr dev)\n{\n    if (!dev)\n        return;\n\n    virNVMeDeviceUsedByClear(dev);\n    VIR_FREE(dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "list->devs",
            "list->count",
            "tmp"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNVMeDeviceCopy",
          "args": [
            "dev"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "virNVMeDeviceCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
          "lines": "93-107",
          "snippet": "virNVMeDevicePtr\nvirNVMeDeviceCopy(const virNVMeDevice *dev)\n{\n    virNVMeDevicePtr copy = NULL;\n\n    copy = g_new0(virNVMeDevice, 1);\n    copy->drvname = g_strdup(dev->drvname);\n    copy->domname = g_strdup(dev->domname);\n\n    virPCIDeviceAddressCopy(&copy->address, &dev->address);\n    copy->namespace = dev->namespace;\n    copy->managed = dev->managed;\n\n    return copy;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virpci.h\"",
            "#include \"virobject.h\"",
            "#include \"virnvme.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nvirNVMeDevicePtr\nvirNVMeDeviceCopy(const virNVMeDevice *dev)\n{\n    virNVMeDevicePtr copy = NULL;\n\n    copy = g_new0(virNVMeDevice, 1);\n    copy->drvname = g_strdup(dev->drvname);\n    copy->domname = g_strdup(dev->domname);\n\n    virPCIDeviceAddressCopy(&copy->address, &dev->address);\n    copy->namespace = dev->namespace;\n    copy->managed = dev->managed;\n\n    return copy;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"NVMe device %s namespace %u is already on the list\")",
            "NULLSTR(addrStr)",
            "tmp->namespace"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "addrStr"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"NVMe device %s namespace %u is already on the list\""
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceAddressAsString",
          "args": [
            "&tmp->address"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressAsString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1351-1362",
          "snippet": "char *\nvirPCIDeviceAddressAsString(const virPCIDeviceAddress *addr)\n{\n    char *str;\n\n    str = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                          addr->domain,\n                          addr->bus,\n                          addr->slot,\n                          addr->function);\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nchar *\nvirPCIDeviceAddressAsString(const virPCIDeviceAddress *addr)\n{\n    char *str;\n\n    str = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                          addr->domain,\n                          addr->bus,\n                          addr->slot,\n                          addr->function);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNVMeDeviceListLookup",
          "args": [
            "list",
            "dev"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "virNVMeDeviceListLookupByPCIAddress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
          "lines": "268-285",
          "snippet": "static virNVMeDevicePtr\nvirNVMeDeviceListLookupByPCIAddress(virNVMeDeviceListPtr list,\n                                    const virPCIDeviceAddress *address)\n{\n    size_t i;\n\n    if (!list)\n        return NULL;\n\n    for (i = 0; i < list->count; i++) {\n        virNVMeDevicePtr other = list->devs[i];\n\n        if (virPCIDeviceAddressEqual(address, &other->address))\n            return other;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virpci.h\"",
            "#include \"virobject.h\"",
            "#include \"virnvme.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nstatic virNVMeDevicePtr\nvirNVMeDeviceListLookupByPCIAddress(virNVMeDeviceListPtr list,\n                                    const virPCIDeviceAddress *address)\n{\n    size_t i;\n\n    if (!list)\n        return NULL;\n\n    for (i = 0; i < list->count; i++) {\n        virNVMeDevicePtr other = list->devs[i];\n\n        if (virPCIDeviceAddressEqual(address, &other->address))\n            return other;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nint\nvirNVMeDeviceListAdd(virNVMeDeviceListPtr list,\n                     const virNVMeDevice *dev)\n{\n    virNVMeDevicePtr tmp;\n\n    if ((tmp = virNVMeDeviceListLookup(list, dev))) {\n        g_autofree char *addrStr = virPCIDeviceAddressAsString(&tmp->address);\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"NVMe device %s namespace %u is already on the list\"),\n                       NULLSTR(addrStr), tmp->namespace);\n        return -1;\n    }\n\n    if (!(tmp = virNVMeDeviceCopy(dev)) ||\n        VIR_APPEND_ELEMENT(list->devs, list->count, tmp) < 0) {\n        virNVMeDeviceFree(tmp);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNVMeDeviceListCount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "173-177",
    "snippet": "size_t\nvirNVMeDeviceListCount(const virNVMeDeviceList *list)\n{\n    return list->count;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nsize_t\nvirNVMeDeviceListCount(const virNVMeDeviceList *list)\n{\n    return list->count;\n}"
  },
  {
    "function_name": "virNVMeDeviceListDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "160-170",
    "snippet": "static void\nvirNVMeDeviceListDispose(void *obj)\n{\n    virNVMeDeviceListPtr list = obj;\n    size_t i;\n\n    for (i = 0; i < list->count; i++)\n        virNVMeDeviceFree(list->devs[i]);\n\n    VIR_FREE(list->devs);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNVMeDeviceListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "list->devs"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNVMeDeviceFree",
          "args": [
            "list->devs[i]"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "virNVMeDeviceFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
          "lines": "82-90",
          "snippet": "void\nvirNVMeDeviceFree(virNVMeDevicePtr dev)\n{\n    if (!dev)\n        return;\n\n    virNVMeDeviceUsedByClear(dev);\n    VIR_FREE(dev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virpci.h\"",
            "#include \"virobject.h\"",
            "#include \"virnvme.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nvoid\nvirNVMeDeviceFree(virNVMeDevicePtr dev)\n{\n    if (!dev)\n        return;\n\n    virNVMeDeviceUsedByClear(dev);\n    VIR_FREE(dev);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nstatic void virNVMeDeviceListDispose(void *obj);\n\nstatic void\nvirNVMeDeviceListDispose(void *obj)\n{\n    virNVMeDeviceListPtr list = obj;\n    size_t i;\n\n    for (i = 0; i < list->count; i++)\n        virNVMeDeviceFree(list->devs[i]);\n\n    VIR_FREE(list->devs);\n}"
  },
  {
    "function_name": "virNVMeDeviceListNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "145-157",
    "snippet": "virNVMeDeviceListPtr\nvirNVMeDeviceListNew(void)\n{\n    virNVMeDeviceListPtr list;\n\n    if (virNVMeInitialize() < 0)\n        return NULL;\n\n    if (!(list = virObjectLockableNew(virNVMeDeviceListClass)))\n        return NULL;\n\n    return list;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virNVMeDeviceListClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virNVMeDeviceListClass"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNVMeInitialize",
          "args": [],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nstatic virClassPtr virNVMeDeviceListClass;\n\nvirNVMeDeviceListPtr\nvirNVMeDeviceListNew(void)\n{\n    virNVMeDeviceListPtr list;\n\n    if (virNVMeInitialize() < 0)\n        return NULL;\n\n    if (!(list = virObjectLockableNew(virNVMeDeviceListClass)))\n        return NULL;\n\n    return list;\n}"
  },
  {
    "function_name": "virNVMeDeviceUsedBySet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "135-142",
    "snippet": "void\nvirNVMeDeviceUsedBySet(virNVMeDevicePtr dev,\n                       const char *drv,\n                       const char *dom)\n{\n    dev->drvname = g_strdup(drv);\n    dev->domname = g_strdup(dom);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "dom"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nvoid\nvirNVMeDeviceUsedBySet(virNVMeDevicePtr dev,\n                       const char *drv,\n                       const char *dom)\n{\n    dev->drvname = g_strdup(drv);\n    dev->domname = g_strdup(dom);\n}"
  },
  {
    "function_name": "virNVMeDeviceUsedByGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "125-132",
    "snippet": "void\nvirNVMeDeviceUsedByGet(const virNVMeDevice *dev,\n                       const char **drv,\n                       const char **dom)\n{\n    *drv = dev->drvname;\n    *dom = dev->domname;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nvoid\nvirNVMeDeviceUsedByGet(const virNVMeDevice *dev,\n                       const char **drv,\n                       const char **dom)\n{\n    *drv = dev->drvname;\n    *dom = dev->domname;\n}"
  },
  {
    "function_name": "virNVMeDeviceUsedByClear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "117-122",
    "snippet": "void\nvirNVMeDeviceUsedByClear(virNVMeDevicePtr dev)\n{\n    VIR_FREE(dev->drvname);\n    VIR_FREE(dev->domname);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dev->domname"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dev->drvname"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nvoid\nvirNVMeDeviceUsedByClear(virNVMeDevicePtr dev)\n{\n    VIR_FREE(dev->drvname);\n    VIR_FREE(dev->domname);\n}"
  },
  {
    "function_name": "virNVMeDeviceAddressGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "110-114",
    "snippet": "const virPCIDeviceAddress *\nvirNVMeDeviceAddressGet(const virNVMeDevice *dev)\n{\n    return &dev->address;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nconst virPCIDeviceAddress *\nvirNVMeDeviceAddressGet(const virNVMeDevice *dev)\n{\n    return &dev->address;\n}"
  },
  {
    "function_name": "virNVMeDeviceCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "93-107",
    "snippet": "virNVMeDevicePtr\nvirNVMeDeviceCopy(const virNVMeDevice *dev)\n{\n    virNVMeDevicePtr copy = NULL;\n\n    copy = g_new0(virNVMeDevice, 1);\n    copy->drvname = g_strdup(dev->drvname);\n    copy->domname = g_strdup(dev->domname);\n\n    virPCIDeviceAddressCopy(&copy->address, &dev->address);\n    copy->namespace = dev->namespace;\n    copy->managed = dev->managed;\n\n    return copy;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virPCIDeviceAddressCopy",
          "args": [
            "&copy->address",
            "&dev->address"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1345-1349",
          "snippet": "void virPCIDeviceAddressCopy(virPCIDeviceAddressPtr dst,\n                             const virPCIDeviceAddress *src)\n{\n    memcpy(dst, src, sizeof(*src));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nvoid virPCIDeviceAddressCopy(virPCIDeviceAddressPtr dst,\n                             const virPCIDeviceAddress *src)\n{\n    memcpy(dst, src, sizeof(*src));\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "dev->domname"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "virNVMeDevice",
            "1"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nvirNVMeDevicePtr\nvirNVMeDeviceCopy(const virNVMeDevice *dev)\n{\n    virNVMeDevicePtr copy = NULL;\n\n    copy = g_new0(virNVMeDevice, 1);\n    copy->drvname = g_strdup(dev->drvname);\n    copy->domname = g_strdup(dev->domname);\n\n    virPCIDeviceAddressCopy(&copy->address, &dev->address);\n    copy->namespace = dev->namespace;\n    copy->managed = dev->managed;\n\n    return copy;\n}"
  },
  {
    "function_name": "virNVMeDeviceFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "82-90",
    "snippet": "void\nvirNVMeDeviceFree(virNVMeDevicePtr dev)\n{\n    if (!dev)\n        return;\n\n    virNVMeDeviceUsedByClear(dev);\n    VIR_FREE(dev);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dev"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNVMeDeviceUsedByClear",
          "args": [
            "dev"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "virNVMeDeviceUsedByClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
          "lines": "117-122",
          "snippet": "void\nvirNVMeDeviceUsedByClear(virNVMeDevicePtr dev)\n{\n    VIR_FREE(dev->drvname);\n    VIR_FREE(dev->domname);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virpci.h\"",
            "#include \"virobject.h\"",
            "#include \"virnvme.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nvoid\nvirNVMeDeviceUsedByClear(virNVMeDevicePtr dev)\n{\n    VIR_FREE(dev->drvname);\n    VIR_FREE(dev->domname);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nvoid\nvirNVMeDeviceFree(virNVMeDevicePtr dev)\n{\n    if (!dev)\n        return;\n\n    virNVMeDeviceUsedByClear(dev);\n    VIR_FREE(dev);\n}"
  },
  {
    "function_name": "virNVMeDeviceNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "65-79",
    "snippet": "virNVMeDevicePtr\nvirNVMeDeviceNew(const virPCIDeviceAddress *address,\n                 unsigned long namespace,\n                 bool managed)\n{\n    virNVMeDevicePtr dev = NULL;\n\n    dev = g_new0(virNVMeDevice, 1);\n\n    virPCIDeviceAddressCopy(&dev->address, address);\n    dev->namespace = namespace;\n    dev->managed = managed;\n\n    return dev;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virPCIDeviceAddressCopy",
          "args": [
            "&dev->address",
            "address"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1345-1349",
          "snippet": "void virPCIDeviceAddressCopy(virPCIDeviceAddressPtr dst,\n                             const virPCIDeviceAddress *src)\n{\n    memcpy(dst, src, sizeof(*src));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nvoid virPCIDeviceAddressCopy(virPCIDeviceAddressPtr dst,\n                             const virPCIDeviceAddress *src)\n{\n    memcpy(dst, src, sizeof(*src));\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "virNVMeDevice",
            "1"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nvirNVMeDevicePtr\nvirNVMeDeviceNew(const virPCIDeviceAddress *address,\n                 unsigned long namespace,\n                 bool managed)\n{\n    virNVMeDevicePtr dev = NULL;\n\n    dev = g_new0(virNVMeDevice, 1);\n\n    virPCIDeviceAddressCopy(&dev->address, address);\n    dev->namespace = namespace;\n    dev->managed = managed;\n\n    return dev;\n}"
  },
  {
    "function_name": "virNVMeOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnvme.c",
    "lines": "53-60",
    "snippet": "static int\nvirNVMeOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNVMeDeviceList, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virpci.h\"",
      "#include \"virobject.h\"",
      "#include \"virnvme.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virNVMeDeviceList",
            "virClassForObjectLockable()"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virpci.h\"\n#include \"virobject.h\"\n#include \"virnvme.h\"\n#include <config.h>\n\nstatic int\nvirNVMeOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNVMeDeviceList, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}"
  }
]