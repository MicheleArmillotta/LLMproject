[
  {
    "function_name": "virKeycodeValueTranslate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeycode.c",
    "lines": "105-121",
    "snippet": "int virKeycodeValueTranslate(virKeycodeSet from_codeset,\n                             virKeycodeSet to_codeset,\n                             int key_value)\n{\n    size_t i;\n\n    if (key_value < 0)\n        return -1;\n\n\n    for (i = 0; i < VIR_KEYMAP_ENTRY_MAX; i++) {\n        if (virKeymapValues[from_codeset][i] == key_value)\n            return virKeymapValues[to_codeset][i];\n    }\n\n    return -1;\n}",
    "includes": [
      "#include \"virkeynametable_win32.h\"",
      "#include \"virkeynametable_osx.h\"",
      "#include \"virkeynametable_linux.h\"",
      "#include \"virkeycodetable_xtkbd.h\"",
      "#include \"virkeycodetable_win32.h\"",
      "#include \"virkeycodetable_usb.h\"",
      "#include \"virkeycodetable_qnum.h\"",
      "#include \"virkeycodetable_osx.h\"",
      "#include \"virkeycodetable_linux.h\"",
      "#include \"virkeycodetable_atset3.h\"",
      "#include \"virkeycodetable_atset2.h\"",
      "#include \"virkeycodetable_atset1.h\"",
      "#include <stddef.h>",
      "#include \"virkeycode.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_KEYMAP_ENTRY_MAX G_N_ELEMENTS(virKeyCodeTable_linux)"
    ],
    "globals_used": [
      "static const unsigned short *virKeymapValues[VIR_KEYCODE_SET_LAST] = {\n    [VIR_KEYCODE_SET_LINUX] = virKeyCodeTable_linux,\n    /* XT is same as AT Set1 - it was included by mistake */\n    [VIR_KEYCODE_SET_XT] = virKeyCodeTable_atset1,\n    [VIR_KEYCODE_SET_ATSET1] = virKeyCodeTable_atset1,\n    [VIR_KEYCODE_SET_ATSET2] = virKeyCodeTable_atset2,\n    [VIR_KEYCODE_SET_ATSET3] = virKeyCodeTable_atset3,\n    [VIR_KEYCODE_SET_OSX] = virKeyCodeTable_osx,\n    [VIR_KEYCODE_SET_XT_KBD] = virKeyCodeTable_xtkbd,\n    [VIR_KEYCODE_SET_USB] = virKeyCodeTable_usb,\n    [VIR_KEYCODE_SET_WIN32] = virKeyCodeTable_win32,\n    [VIR_KEYCODE_SET_QNUM] = virKeyCodeTable_qnum,\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virkeynametable_win32.h\"\n#include \"virkeynametable_osx.h\"\n#include \"virkeynametable_linux.h\"\n#include \"virkeycodetable_xtkbd.h\"\n#include \"virkeycodetable_win32.h\"\n#include \"virkeycodetable_usb.h\"\n#include \"virkeycodetable_qnum.h\"\n#include \"virkeycodetable_osx.h\"\n#include \"virkeycodetable_linux.h\"\n#include \"virkeycodetable_atset3.h\"\n#include \"virkeycodetable_atset2.h\"\n#include \"virkeycodetable_atset1.h\"\n#include <stddef.h>\n#include \"virkeycode.h\"\n#include <config.h>\n\n#define VIR_KEYMAP_ENTRY_MAX G_N_ELEMENTS(virKeyCodeTable_linux)\n\nstatic const unsigned short *virKeymapValues[VIR_KEYCODE_SET_LAST] = {\n    [VIR_KEYCODE_SET_LINUX] = virKeyCodeTable_linux,\n    /* XT is same as AT Set1 - it was included by mistake */\n    [VIR_KEYCODE_SET_XT] = virKeyCodeTable_atset1,\n    [VIR_KEYCODE_SET_ATSET1] = virKeyCodeTable_atset1,\n    [VIR_KEYCODE_SET_ATSET2] = virKeyCodeTable_atset2,\n    [VIR_KEYCODE_SET_ATSET3] = virKeyCodeTable_atset3,\n    [VIR_KEYCODE_SET_OSX] = virKeyCodeTable_osx,\n    [VIR_KEYCODE_SET_XT_KBD] = virKeyCodeTable_xtkbd,\n    [VIR_KEYCODE_SET_USB] = virKeyCodeTable_usb,\n    [VIR_KEYCODE_SET_WIN32] = virKeyCodeTable_win32,\n    [VIR_KEYCODE_SET_QNUM] = virKeyCodeTable_qnum,\n};\n\nint virKeycodeValueTranslate(virKeycodeSet from_codeset,\n                             virKeycodeSet to_codeset,\n                             int key_value)\n{\n    size_t i;\n\n    if (key_value < 0)\n        return -1;\n\n\n    for (i = 0; i < VIR_KEYMAP_ENTRY_MAX; i++) {\n        if (virKeymapValues[from_codeset][i] == key_value)\n            return virKeymapValues[to_codeset][i];\n    }\n\n    return -1;\n}"
  },
  {
    "function_name": "virKeycodeValueFromString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeycode.c",
    "lines": "85-102",
    "snippet": "int virKeycodeValueFromString(virKeycodeSet codeset,\n                              const char *keyname)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_KEYMAP_ENTRY_MAX; i++) {\n        if (!virKeymapNames[codeset] ||\n            !virKeymapValues[codeset])\n            continue;\n\n        const char *name = virKeymapNames[codeset][i];\n\n        if (name && STREQ_NULLABLE(name, keyname))\n            return virKeymapValues[codeset][i];\n    }\n\n    return -1;\n}",
    "includes": [
      "#include \"virkeynametable_win32.h\"",
      "#include \"virkeynametable_osx.h\"",
      "#include \"virkeynametable_linux.h\"",
      "#include \"virkeycodetable_xtkbd.h\"",
      "#include \"virkeycodetable_win32.h\"",
      "#include \"virkeycodetable_usb.h\"",
      "#include \"virkeycodetable_qnum.h\"",
      "#include \"virkeycodetable_osx.h\"",
      "#include \"virkeycodetable_linux.h\"",
      "#include \"virkeycodetable_atset3.h\"",
      "#include \"virkeycodetable_atset2.h\"",
      "#include \"virkeycodetable_atset1.h\"",
      "#include <stddef.h>",
      "#include \"virkeycode.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_KEYMAP_ENTRY_MAX G_N_ELEMENTS(virKeyCodeTable_linux)"
    ],
    "globals_used": [
      "static const char **virKeymapNames[VIR_KEYCODE_SET_LAST] = {\n    [VIR_KEYCODE_SET_LINUX] = virKeyNameTable_linux,\n    [VIR_KEYCODE_SET_OSX] = virKeyNameTable_osx,\n    [VIR_KEYCODE_SET_WIN32] = virKeyNameTable_win32,\n};",
      "static const unsigned short *virKeymapValues[VIR_KEYCODE_SET_LAST] = {\n    [VIR_KEYCODE_SET_LINUX] = virKeyCodeTable_linux,\n    /* XT is same as AT Set1 - it was included by mistake */\n    [VIR_KEYCODE_SET_XT] = virKeyCodeTable_atset1,\n    [VIR_KEYCODE_SET_ATSET1] = virKeyCodeTable_atset1,\n    [VIR_KEYCODE_SET_ATSET2] = virKeyCodeTable_atset2,\n    [VIR_KEYCODE_SET_ATSET3] = virKeyCodeTable_atset3,\n    [VIR_KEYCODE_SET_OSX] = virKeyCodeTable_osx,\n    [VIR_KEYCODE_SET_XT_KBD] = virKeyCodeTable_xtkbd,\n    [VIR_KEYCODE_SET_USB] = virKeyCodeTable_usb,\n    [VIR_KEYCODE_SET_WIN32] = virKeyCodeTable_win32,\n    [VIR_KEYCODE_SET_QNUM] = virKeyCodeTable_qnum,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "name",
            "keyname"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virkeynametable_win32.h\"\n#include \"virkeynametable_osx.h\"\n#include \"virkeynametable_linux.h\"\n#include \"virkeycodetable_xtkbd.h\"\n#include \"virkeycodetable_win32.h\"\n#include \"virkeycodetable_usb.h\"\n#include \"virkeycodetable_qnum.h\"\n#include \"virkeycodetable_osx.h\"\n#include \"virkeycodetable_linux.h\"\n#include \"virkeycodetable_atset3.h\"\n#include \"virkeycodetable_atset2.h\"\n#include \"virkeycodetable_atset1.h\"\n#include <stddef.h>\n#include \"virkeycode.h\"\n#include <config.h>\n\n#define VIR_KEYMAP_ENTRY_MAX G_N_ELEMENTS(virKeyCodeTable_linux)\n\nstatic const char **virKeymapNames[VIR_KEYCODE_SET_LAST] = {\n    [VIR_KEYCODE_SET_LINUX] = virKeyNameTable_linux,\n    [VIR_KEYCODE_SET_OSX] = virKeyNameTable_osx,\n    [VIR_KEYCODE_SET_WIN32] = virKeyNameTable_win32,\n};\nstatic const unsigned short *virKeymapValues[VIR_KEYCODE_SET_LAST] = {\n    [VIR_KEYCODE_SET_LINUX] = virKeyCodeTable_linux,\n    /* XT is same as AT Set1 - it was included by mistake */\n    [VIR_KEYCODE_SET_XT] = virKeyCodeTable_atset1,\n    [VIR_KEYCODE_SET_ATSET1] = virKeyCodeTable_atset1,\n    [VIR_KEYCODE_SET_ATSET2] = virKeyCodeTable_atset2,\n    [VIR_KEYCODE_SET_ATSET3] = virKeyCodeTable_atset3,\n    [VIR_KEYCODE_SET_OSX] = virKeyCodeTable_osx,\n    [VIR_KEYCODE_SET_XT_KBD] = virKeyCodeTable_xtkbd,\n    [VIR_KEYCODE_SET_USB] = virKeyCodeTable_usb,\n    [VIR_KEYCODE_SET_WIN32] = virKeyCodeTable_win32,\n    [VIR_KEYCODE_SET_QNUM] = virKeyCodeTable_qnum,\n};\n\nint virKeycodeValueFromString(virKeycodeSet codeset,\n                              const char *keyname)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_KEYMAP_ENTRY_MAX; i++) {\n        if (!virKeymapNames[codeset] ||\n            !virKeymapValues[codeset])\n            continue;\n\n        const char *name = virKeymapNames[codeset][i];\n\n        if (name && STREQ_NULLABLE(name, keyname))\n            return virKeymapValues[codeset][i];\n    }\n\n    return -1;\n}"
  }
]