[
  {
    "function_name": "virNetDaemonHasClients",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "916-924",
    "snippet": "bool\nvirNetDaemonHasClients(virNetDaemonPtr dmn)\n{\n    bool ret = false;\n\n    virHashForEach(dmn->servers, daemonServerHasClients, &ret);\n\n    return ret;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "dmn->servers",
            "daemonServerHasClients",
            "&ret"
          ],
          "line": 921
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirNetDaemonHasClients(virNetDaemonPtr dmn)\n{\n    bool ret = false;\n\n    virHashForEach(dmn->servers, daemonServerHasClients, &ret);\n\n    return ret;\n}"
  },
  {
    "function_name": "daemonServerHasClients",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "902-914",
    "snippet": "static int\ndaemonServerHasClients(void *payload,\n                       const void *key G_GNUC_UNUSED,\n                       void *opaque)\n{\n    bool *clients = opaque;\n    virNetServerPtr srv = payload;\n\n    if (virNetServerHasClients(srv))\n        *clients = true;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetServerHasClients",
          "args": [
            "srv"
          ],
          "line": 910
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerHasClients",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserver.c",
          "lines": "960-970",
          "snippet": "bool\nvirNetServerHasClients(virNetServerPtr srv)\n{\n    bool ret;\n\n    virObjectLock(srv);\n    ret = !!srv->nclients;\n    virObjectUnlock(srv);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);",
            "static inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetserver.h\"\n#include <config.h>\n\nstatic inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);\nstatic inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);\n\nbool\nvirNetServerHasClients(virNetServerPtr srv)\n{\n    bool ret;\n\n    virObjectLock(srv);\n    ret = !!srv->nclients;\n    virObjectUnlock(srv);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\ndaemonServerHasClients(void *payload,\n                       const void *key G_GNUC_UNUSED,\n                       void *opaque)\n{\n    bool *clients = opaque;\n    virNetServerPtr srv = payload;\n\n    if (virNetServerHasClients(srv))\n        *clients = true;\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDaemonClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "889-900",
    "snippet": "void\nvirNetDaemonClose(virNetDaemonPtr dmn)\n{\n    if (!dmn)\n        return;\n\n    virObjectLock(dmn);\n\n    virHashForEach(dmn->servers, daemonServerClose, NULL);\n\n    virObjectUnlock(dmn);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dmn"
          ],
          "line": 899
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "dmn->servers",
            "daemonServerClose",
            "NULL"
          ],
          "line": 897
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dmn"
          ],
          "line": 895
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNetDaemonClose(virNetDaemonPtr dmn)\n{\n    if (!dmn)\n        return;\n\n    virObjectLock(dmn);\n\n    virHashForEach(dmn->servers, daemonServerClose, NULL);\n\n    virObjectUnlock(dmn);\n}"
  },
  {
    "function_name": "daemonServerClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "878-887",
    "snippet": "static int\ndaemonServerClose(void *payload,\n                  const void *key G_GNUC_UNUSED,\n                  void *opaque G_GNUC_UNUSED)\n{\n    virNetServerPtr srv = payload;\n\n    virNetServerClose(srv);\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetServerClose",
          "args": [
            "srv"
          ],
          "line": 885
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClose",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserver.c",
          "lines": "929-945",
          "snippet": "void virNetServerClose(virNetServerPtr srv)\n{\n    size_t i;\n\n    if (!srv)\n        return;\n\n    virObjectLock(srv);\n\n    for (i = 0; i < srv->nservices; i++)\n        virNetServerServiceClose(srv->services[i]);\n\n    for (i = 0; i < srv->nclients; i++)\n        virNetServerClientClose(srv->clients[i]);\n\n    virObjectUnlock(srv);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);",
            "static inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetserver.h\"\n#include <config.h>\n\nstatic inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);\nstatic inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);\n\nvoid virNetServerClose(virNetServerPtr srv)\n{\n    size_t i;\n\n    if (!srv)\n        return;\n\n    virObjectLock(srv);\n\n    for (i = 0; i < srv->nservices; i++)\n        virNetServerServiceClose(srv->services[i]);\n\n    for (i = 0; i < srv->nclients; i++)\n        virNetServerClientClose(srv->clients[i]);\n\n    virObjectUnlock(srv);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\ndaemonServerClose(void *payload,\n                  const void *key G_GNUC_UNUSED,\n                  void *opaque G_GNUC_UNUSED)\n{\n    virNetServerPtr srv = payload;\n\n    virNetServerClose(srv);\n    return 0;\n}"
  },
  {
    "function_name": "virNetDaemonQuit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "867-876",
    "snippet": "void\nvirNetDaemonQuit(virNetDaemonPtr dmn)\n{\n    virObjectLock(dmn);\n\n    VIR_DEBUG(\"Quit requested %p\", dmn);\n    dmn->quit = true;\n\n    virObjectUnlock(dmn);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dmn"
          ],
          "line": 875
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Quit requested %p\"",
            "dmn"
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dmn"
          ],
          "line": 870
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNetDaemonQuit(virNetDaemonPtr dmn)\n{\n    virObjectLock(dmn);\n\n    VIR_DEBUG(\"Quit requested %p\", dmn);\n    dmn->quit = true;\n\n    virObjectUnlock(dmn);\n}"
  },
  {
    "function_name": "virNetDaemonRun",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "799-864",
    "snippet": "void\nvirNetDaemonRun(virNetDaemonPtr dmn)\n{\n    int timerid = -1;\n    bool timerActive = false;\n\n    virObjectLock(dmn);\n\n    if (dmn->srvObject) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Not all servers restored, cannot run server\"));\n        goto cleanup;\n    }\n\n    dmn->quit = false;\n\n    if (dmn->autoShutdownTimeout &&\n        (timerid = virEventAddTimeout(-1,\n                                      virNetDaemonAutoShutdownTimer,\n                                      dmn, NULL)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to register shutdown timeout\"));\n        goto cleanup;\n    }\n\n    /* We are accepting connections now. Notify systemd\n     * so it can start dependent services. */\n    virSystemdNotifyStartup();\n\n    VIR_DEBUG(\"dmn=%p quit=%d\", dmn, dmn->quit);\n    while (!dmn->quit) {\n        /* A shutdown timeout is specified, so check\n         * if any drivers have active state, if not\n         * shutdown after timeout seconds\n         */\n        if (dmn->autoShutdownTimeout) {\n            if (timerActive) {\n                if (virNetDaemonHasClients(dmn)) {\n                    VIR_DEBUG(\"Deactivating shutdown timer %d\", timerid);\n                    virEventUpdateTimeout(timerid, -1);\n                    timerActive = false;\n                }\n            } else {\n                if (!virNetDaemonHasClients(dmn)) {\n                    VIR_DEBUG(\"Activating shutdown timer %d\", timerid);\n                    virEventUpdateTimeout(timerid,\n                                          dmn->autoShutdownTimeout * 1000);\n                    timerActive = true;\n                }\n            }\n        }\n\n        virObjectUnlock(dmn);\n        if (virEventRunDefaultImpl() < 0) {\n            virObjectLock(dmn);\n            VIR_DEBUG(\"Loop iteration error, exiting\");\n            break;\n        }\n        virObjectLock(dmn);\n\n        virHashForEach(dmn->servers, daemonServerProcessClients, NULL);\n    }\n\n cleanup:\n    virObjectUnlock(dmn);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dmn"
          ],
          "line": 863
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "dmn->servers",
            "daemonServerProcessClients",
            "NULL"
          ],
          "line": 859
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dmn"
          ],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Loop iteration error, exiting\""
          ],
          "line": 854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virEventRunDefaultImpl",
          "args": [],
          "line": 852
        },
        "resolved": true,
        "details": {
          "function_name": "virEventRunDefaultImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virevent.c",
          "lines": "338-344",
          "snippet": "int virEventRunDefaultImpl(void)\n{\n    VIR_DEBUG(\"running default event implementation\");\n    virResetLastError();\n\n    return virEventGLibRunOnce();\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vireventglib.h\"",
            "#include \"virevent.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vireventglib.h\"\n#include \"virevent.h\"\n#include <config.h>\n\nint virEventRunDefaultImpl(void)\n{\n    VIR_DEBUG(\"running default event implementation\");\n    virResetLastError();\n\n    return virEventGLibRunOnce();\n}"
        }
      },
      {
        "call_info": {
          "callee": "virEventUpdateTimeout",
          "args": [
            "timerid",
            "dmn->autoShutdownTimeout * 1000"
          ],
          "line": 844
        },
        "resolved": true,
        "details": {
          "function_name": "virEventUpdateTimeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virevent.c",
          "lines": "170-175",
          "snippet": "void\nvirEventUpdateTimeout(int timer, int timeout)\n{\n    if (updateTimeoutImpl)\n        updateTimeoutImpl(timer, timeout);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vireventglib.h\"",
            "#include \"virevent.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virEventUpdateTimeoutFunc updateTimeoutImpl;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vireventglib.h\"\n#include \"virevent.h\"\n#include <config.h>\n\nstatic virEventUpdateTimeoutFunc updateTimeoutImpl;\n\nvoid\nvirEventUpdateTimeout(int timer, int timeout)\n{\n    if (updateTimeoutImpl)\n        updateTimeoutImpl(timer, timeout);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Activating shutdown timer %d\"",
            "timerid"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDaemonHasClients",
          "args": [
            "dmn"
          ],
          "line": 842
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDaemonHasClients",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
          "lines": "916-924",
          "snippet": "bool\nvirNetDaemonHasClients(virNetDaemonPtr dmn)\n{\n    bool ret = false;\n\n    virHashForEach(dmn->servers, daemonServerHasClients, &ret);\n\n    return ret;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhash.h\"",
            "#include \"virdbus.h\"",
            "#include \"virnetserver.h\"",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdaemon.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirNetDaemonHasClients(virNetDaemonPtr dmn)\n{\n    bool ret = false;\n\n    virHashForEach(dmn->servers, daemonServerHasClients, &ret);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Deactivating shutdown timer %d\"",
            "timerid"
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dmn=%p quit=%d\"",
            "dmn",
            "dmn->quit"
          ],
          "line": 828
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSystemdNotifyStartup",
          "args": [],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "virSystemdNotifyStartup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsystemd.c",
          "lines": "509-557",
          "snippet": "void\nvirSystemdNotifyStartup(void)\n{\n#ifndef WIN32\n    const char *path;\n    const char *msg = \"READY=1\";\n    int fd;\n    struct sockaddr_un un = {\n        .sun_family = AF_UNIX,\n    };\n    struct iovec iov = {\n        .iov_base = (char *)msg,\n        .iov_len = strlen(msg),\n    };\n    struct msghdr mh = {\n        .msg_name = &un,\n        .msg_iov = &iov,\n        .msg_iovlen = 1,\n    };\n\n    if (!(path = getenv(\"NOTIFY_SOCKET\"))) {\n        VIR_DEBUG(\"Skipping systemd notify, not requested\");\n        return;\n    }\n\n    /* NB sun_path field is *not* NUL-terminated, hence >, not >= */\n    if (strlen(path) > sizeof(un.sun_path)) {\n        VIR_WARN(\"Systemd notify socket path '%s' too long\", path);\n        return;\n    }\n\n    memcpy(un.sun_path, path, strlen(path));\n    if (un.sun_path[0] == '@')\n        un.sun_path[0] = '\\0';\n\n    mh.msg_namelen = offsetof(struct sockaddr_un, sun_path) + strlen(path);\n\n    fd = socket(AF_UNIX, SOCK_DGRAM, 0);\n    if (fd < 0) {\n        VIR_WARN(\"Unable to create socket FD\");\n        return;\n    }\n\n    if (sendmsg(fd, &mh, MSG_NOSIGNAL) < 0)\n        VIR_WARN(\"Failed to notify systemd\");\n\n    VIR_FORCE_CLOSE(fd);\n#endif /* !WIN32 */\n}",
          "includes": [
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virdbus.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virsystemdpriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virdbus.h\"\n#include \"virbuffer.h\"\n#include \"virsystemd.h\"\n#include \"virsystemdpriv.h\"\n#include <config.h>\n\nvoid\nvirSystemdNotifyStartup(void)\n{\n#ifndef WIN32\n    const char *path;\n    const char *msg = \"READY=1\";\n    int fd;\n    struct sockaddr_un un = {\n        .sun_family = AF_UNIX,\n    };\n    struct iovec iov = {\n        .iov_base = (char *)msg,\n        .iov_len = strlen(msg),\n    };\n    struct msghdr mh = {\n        .msg_name = &un,\n        .msg_iov = &iov,\n        .msg_iovlen = 1,\n    };\n\n    if (!(path = getenv(\"NOTIFY_SOCKET\"))) {\n        VIR_DEBUG(\"Skipping systemd notify, not requested\");\n        return;\n    }\n\n    /* NB sun_path field is *not* NUL-terminated, hence >, not >= */\n    if (strlen(path) > sizeof(un.sun_path)) {\n        VIR_WARN(\"Systemd notify socket path '%s' too long\", path);\n        return;\n    }\n\n    memcpy(un.sun_path, path, strlen(path));\n    if (un.sun_path[0] == '@')\n        un.sun_path[0] = '\\0';\n\n    mh.msg_namelen = offsetof(struct sockaddr_un, sun_path) + strlen(path);\n\n    fd = socket(AF_UNIX, SOCK_DGRAM, 0);\n    if (fd < 0) {\n        VIR_WARN(\"Unable to create socket FD\");\n        return;\n    }\n\n    if (sendmsg(fd, &mh, MSG_NOSIGNAL) < 0)\n        VIR_WARN(\"Failed to notify systemd\");\n\n    VIR_FORCE_CLOSE(fd);\n#endif /* !WIN32 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Failed to register shutdown timeout\")"
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to register shutdown timeout\""
          ],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virEventAddTimeout",
          "args": [
            "-1",
            "virNetDaemonAutoShutdownTimer",
            "dmn",
            "NULL"
          ],
          "line": 816
        },
        "resolved": true,
        "details": {
          "function_name": "virEventAddTimeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virevent.c",
          "lines": "143-153",
          "snippet": "int\nvirEventAddTimeout(int timeout,\n                   virEventTimeoutCallback cb,\n                   void *opaque,\n                   virFreeCallback ff)\n{\n    if (!addTimeoutImpl)\n        return -1;\n\n    return addTimeoutImpl(timeout, cb, opaque, ff);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vireventglib.h\"",
            "#include \"virevent.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virEventAddTimeoutFunc addTimeoutImpl;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vireventglib.h\"\n#include \"virevent.h\"\n#include <config.h>\n\nstatic virEventAddTimeoutFunc addTimeoutImpl;\n\nint\nvirEventAddTimeout(int timeout,\n                   virEventTimeoutCallback cb,\n                   void *opaque,\n                   virFreeCallback ff)\n{\n    if (!addTimeoutImpl)\n        return -1;\n\n    return addTimeoutImpl(timeout, cb, opaque, ff);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Not all servers restored, cannot run server\")"
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNetDaemonRun(virNetDaemonPtr dmn)\n{\n    int timerid = -1;\n    bool timerActive = false;\n\n    virObjectLock(dmn);\n\n    if (dmn->srvObject) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Not all servers restored, cannot run server\"));\n        goto cleanup;\n    }\n\n    dmn->quit = false;\n\n    if (dmn->autoShutdownTimeout &&\n        (timerid = virEventAddTimeout(-1,\n                                      virNetDaemonAutoShutdownTimer,\n                                      dmn, NULL)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to register shutdown timeout\"));\n        goto cleanup;\n    }\n\n    /* We are accepting connections now. Notify systemd\n     * so it can start dependent services. */\n    virSystemdNotifyStartup();\n\n    VIR_DEBUG(\"dmn=%p quit=%d\", dmn, dmn->quit);\n    while (!dmn->quit) {\n        /* A shutdown timeout is specified, so check\n         * if any drivers have active state, if not\n         * shutdown after timeout seconds\n         */\n        if (dmn->autoShutdownTimeout) {\n            if (timerActive) {\n                if (virNetDaemonHasClients(dmn)) {\n                    VIR_DEBUG(\"Deactivating shutdown timer %d\", timerid);\n                    virEventUpdateTimeout(timerid, -1);\n                    timerActive = false;\n                }\n            } else {\n                if (!virNetDaemonHasClients(dmn)) {\n                    VIR_DEBUG(\"Activating shutdown timer %d\", timerid);\n                    virEventUpdateTimeout(timerid,\n                                          dmn->autoShutdownTimeout * 1000);\n                    timerActive = true;\n                }\n            }\n        }\n\n        virObjectUnlock(dmn);\n        if (virEventRunDefaultImpl() < 0) {\n            virObjectLock(dmn);\n            VIR_DEBUG(\"Loop iteration error, exiting\");\n            break;\n        }\n        virObjectLock(dmn);\n\n        virHashForEach(dmn->servers, daemonServerProcessClients, NULL);\n    }\n\n cleanup:\n    virObjectUnlock(dmn);\n}"
  },
  {
    "function_name": "daemonServerProcessClients",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "788-797",
    "snippet": "static int\ndaemonServerProcessClients(void *payload,\n                           const void *key G_GNUC_UNUSED,\n                           void *opaque G_GNUC_UNUSED)\n{\n    virNetServerPtr srv = payload;\n\n    virNetServerProcessClients(srv);\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetServerProcessClients",
          "args": [
            "srv"
          ],
          "line": 795
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerProcessClients",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserver.c",
          "lines": "972-1011",
          "snippet": "void\nvirNetServerProcessClients(virNetServerPtr srv)\n{\n    size_t i;\n    virNetServerClientPtr client;\n\n    virObjectLock(srv);\n\n reprocess:\n    for (i = 0; i < srv->nclients; i++) {\n        /* Coverity 5.3.0 couldn't see that srv->clients is non-NULL\n         * if srv->nclients is non-zero.  */\n        sa_assert(srv->clients);\n\n        client = srv->clients[i];\n        virObjectLock(client);\n        if (virNetServerClientWantCloseLocked(client))\n            virNetServerClientCloseLocked(client);\n\n        if (virNetServerClientIsClosedLocked(client)) {\n            VIR_DELETE_ELEMENT(srv->clients, i, srv->nclients);\n\n            /* Update server authentication tracking */\n            virNetServerSetClientAuthCompletedLocked(srv, client);\n            virObjectUnlock(client);\n\n            virNetServerCheckLimits(srv);\n\n            virObjectUnlock(srv);\n            virObjectUnref(client);\n            virObjectLock(srv);\n\n            goto reprocess;\n        } else {\n            virObjectUnlock(client);\n        }\n    }\n\n    virObjectUnlock(srv);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);",
            "static inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetserver.h\"\n#include <config.h>\n\nstatic inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);\nstatic inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);\n\nvoid\nvirNetServerProcessClients(virNetServerPtr srv)\n{\n    size_t i;\n    virNetServerClientPtr client;\n\n    virObjectLock(srv);\n\n reprocess:\n    for (i = 0; i < srv->nclients; i++) {\n        /* Coverity 5.3.0 couldn't see that srv->clients is non-NULL\n         * if srv->nclients is non-zero.  */\n        sa_assert(srv->clients);\n\n        client = srv->clients[i];\n        virObjectLock(client);\n        if (virNetServerClientWantCloseLocked(client))\n            virNetServerClientCloseLocked(client);\n\n        if (virNetServerClientIsClosedLocked(client)) {\n            VIR_DELETE_ELEMENT(srv->clients, i, srv->nclients);\n\n            /* Update server authentication tracking */\n            virNetServerSetClientAuthCompletedLocked(srv, client);\n            virObjectUnlock(client);\n\n            virNetServerCheckLimits(srv);\n\n            virObjectUnlock(srv);\n            virObjectUnref(client);\n            virObjectLock(srv);\n\n            goto reprocess;\n        } else {\n            virObjectUnlock(client);\n        }\n    }\n\n    virObjectUnlock(srv);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\ndaemonServerProcessClients(void *payload,\n                           const void *key G_GNUC_UNUSED,\n                           void *opaque G_GNUC_UNUSED)\n{\n    virNetServerPtr srv = payload;\n\n    virNetServerProcessClients(srv);\n    return 0;\n}"
  },
  {
    "function_name": "virNetDaemonUpdateServices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "779-786",
    "snippet": "void\nvirNetDaemonUpdateServices(virNetDaemonPtr dmn,\n                           bool enabled)\n{\n    virObjectLock(dmn);\n    virHashForEach(dmn->servers, daemonServerUpdateServices, &enabled);\n    virObjectUnlock(dmn);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dmn"
          ],
          "line": 785
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "dmn->servers",
            "daemonServerUpdateServices",
            "&enabled"
          ],
          "line": 784
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dmn"
          ],
          "line": 783
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNetDaemonUpdateServices(virNetDaemonPtr dmn,\n                           bool enabled)\n{\n    virObjectLock(dmn);\n    virHashForEach(dmn->servers, daemonServerUpdateServices, &enabled);\n    virObjectUnlock(dmn);\n}"
  },
  {
    "function_name": "daemonServerUpdateServices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "767-777",
    "snippet": "static int\ndaemonServerUpdateServices(void *payload,\n                           const void *key G_GNUC_UNUSED,\n                           void *opaque)\n{\n    bool *enable = opaque;\n    virNetServerPtr srv = payload;\n\n    virNetServerUpdateServices(srv, *enable);\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetServerUpdateServices",
          "args": [
            "srv",
            "*enable"
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerUpdateServices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserver.c",
          "lines": "899-905",
          "snippet": "void virNetServerUpdateServices(virNetServerPtr srv,\n                                bool enabled)\n{\n    virObjectLock(srv);\n    virNetServerUpdateServicesLocked(srv, enabled);\n    virObjectUnlock(srv);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerUpdateServicesLocked(virNetServerPtr srv,\n                                             bool enabled);",
            "static inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);",
            "static inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetserver.h\"\n#include <config.h>\n\nstatic void virNetServerUpdateServicesLocked(virNetServerPtr srv,\n                                             bool enabled);\nstatic inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);\nstatic inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);\n\nvoid virNetServerUpdateServices(virNetServerPtr srv,\n                                bool enabled)\n{\n    virObjectLock(srv);\n    virNetServerUpdateServicesLocked(srv, enabled);\n    virObjectUnlock(srv);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\ndaemonServerUpdateServices(void *payload,\n                           const void *key G_GNUC_UNUSED,\n                           void *opaque)\n{\n    bool *enable = opaque;\n    virNetServerPtr srv = payload;\n\n    virNetServerUpdateServices(srv, *enable);\n    return 0;\n}"
  },
  {
    "function_name": "virNetDaemonAutoShutdownTimer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "751-765",
    "snippet": "static void\nvirNetDaemonAutoShutdownTimer(int timerid G_GNUC_UNUSED,\n                              void *opaque)\n{\n    virNetDaemonPtr dmn = opaque;\n\n    virObjectLock(dmn);\n\n    if (!dmn->autoShutdownInhibitions) {\n        VIR_DEBUG(\"Automatic shutdown triggered\");\n        dmn->quit = true;\n    }\n\n    virObjectUnlock(dmn);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dmn"
          ],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Automatic shutdown triggered\""
          ],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dmn"
          ],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirNetDaemonAutoShutdownTimer(int timerid G_GNUC_UNUSED,\n                              void *opaque)\n{\n    virNetDaemonPtr dmn = opaque;\n\n    virObjectLock(dmn);\n\n    if (!dmn->autoShutdownInhibitions) {\n        VIR_DEBUG(\"Automatic shutdown triggered\");\n        dmn->quit = true;\n    }\n\n    virObjectUnlock(dmn);\n}"
  },
  {
    "function_name": "virNetDaemonAddSignalHandler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "737-746",
    "snippet": "int\nvirNetDaemonAddSignalHandler(virNetDaemonPtr dmn G_GNUC_UNUSED,\n                             int signum G_GNUC_UNUSED,\n                             virNetDaemonSignalFunc func G_GNUC_UNUSED,\n                             void *opaque G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Signal handling not available on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Signal handling not available on this platform\")"
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Signal handling not available on this platform\""
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetDaemonAddSignalHandler(virNetDaemonPtr dmn G_GNUC_UNUSED,\n                             int signum G_GNUC_UNUSED,\n                             virNetDaemonSignalFunc func G_GNUC_UNUSED,\n                             void *opaque G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Signal handling not available on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDaemonAddSignalHandler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "693-733",
    "snippet": "int\nvirNetDaemonAddSignalHandler(virNetDaemonPtr dmn,\n                             int signum,\n                             virNetDaemonSignalFunc func,\n                             void *opaque)\n{\n    virNetDaemonSignalPtr sigdata = NULL;\n    struct sigaction sig_action;\n\n    virObjectLock(dmn);\n\n    if (virNetDaemonSignalSetup(dmn) < 0)\n        goto error;\n\n    if (VIR_EXPAND_N(dmn->signals, dmn->nsignals, 1) < 0)\n        goto error;\n\n    if (VIR_ALLOC(sigdata) < 0)\n        goto error;\n\n    sigdata->signum = signum;\n    sigdata->func = func;\n    sigdata->opaque = opaque;\n\n    memset(&sig_action, 0, sizeof(sig_action));\n    sig_action.sa_sigaction = virNetDaemonSignalHandler;\n    sig_action.sa_flags = SA_SIGINFO;\n    sigemptyset(&sig_action.sa_mask);\n\n    sigaction(signum, &sig_action, &sigdata->oldaction);\n\n    dmn->signals[dmn->nsignals-1] = sigdata;\n\n    virObjectUnlock(dmn);\n    return 0;\n\n error:\n    VIR_FREE(sigdata);\n    virObjectUnlock(dmn);\n    return -1;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dmn"
          ],
          "line": 731
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "sigdata"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigaction",
          "args": [
            "signum",
            "&sig_action",
            "&sigdata->oldaction"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigemptyset",
          "args": [
            "&sig_action.sa_mask"
          ],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&sig_action",
            "0",
            "sizeof(sig_action)"
          ],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "sigdata"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "dmn->signals",
            "dmn->nsignals",
            "1"
          ],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDaemonSignalSetup",
          "args": [
            "dmn"
          ],
          "line": 704
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDaemonSignalSetup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
          "lines": "660-690",
          "snippet": "static int\nvirNetDaemonSignalSetup(virNetDaemonPtr dmn)\n{\n    int fds[2] = { -1, -1 };\n\n    if (dmn->sigwrite != -1)\n        return 0;\n\n    if (virPipeNonBlock(fds) < 0)\n        return -1;\n\n    if ((dmn->sigwatch = virEventAddHandle(fds[0],\n                                           VIR_EVENT_HANDLE_READABLE,\n                                           virNetDaemonSignalEvent,\n                                           dmn, NULL)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to add signal handle watch\"));\n        goto error;\n    }\n\n    dmn->sigread = fds[0];\n    dmn->sigwrite = fds[1];\n    sigWrite = fds[1];\n\n    return 0;\n\n error:\n    VIR_FORCE_CLOSE(fds[0]);\n    VIR_FORCE_CLOSE(fds[1]);\n    return -1;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhash.h\"",
            "#include \"virdbus.h\"",
            "#include \"virnetserver.h\"",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdaemon.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirNetDaemonSignalSetup(virNetDaemonPtr dmn)\n{\n    int fds[2] = { -1, -1 };\n\n    if (dmn->sigwrite != -1)\n        return 0;\n\n    if (virPipeNonBlock(fds) < 0)\n        return -1;\n\n    if ((dmn->sigwatch = virEventAddHandle(fds[0],\n                                           VIR_EVENT_HANDLE_READABLE,\n                                           virNetDaemonSignalEvent,\n                                           dmn, NULL)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to add signal handle watch\"));\n        goto error;\n    }\n\n    dmn->sigread = fds[0];\n    dmn->sigwrite = fds[1];\n    sigWrite = fds[1];\n\n    return 0;\n\n error:\n    VIR_FORCE_CLOSE(fds[0]);\n    VIR_FORCE_CLOSE(fds[1]);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dmn"
          ],
          "line": 702
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetDaemonAddSignalHandler(virNetDaemonPtr dmn,\n                             int signum,\n                             virNetDaemonSignalFunc func,\n                             void *opaque)\n{\n    virNetDaemonSignalPtr sigdata = NULL;\n    struct sigaction sig_action;\n\n    virObjectLock(dmn);\n\n    if (virNetDaemonSignalSetup(dmn) < 0)\n        goto error;\n\n    if (VIR_EXPAND_N(dmn->signals, dmn->nsignals, 1) < 0)\n        goto error;\n\n    if (VIR_ALLOC(sigdata) < 0)\n        goto error;\n\n    sigdata->signum = signum;\n    sigdata->func = func;\n    sigdata->opaque = opaque;\n\n    memset(&sig_action, 0, sizeof(sig_action));\n    sig_action.sa_sigaction = virNetDaemonSignalHandler;\n    sig_action.sa_flags = SA_SIGINFO;\n    sigemptyset(&sig_action.sa_mask);\n\n    sigaction(signum, &sig_action, &sigdata->oldaction);\n\n    dmn->signals[dmn->nsignals-1] = sigdata;\n\n    virObjectUnlock(dmn);\n    return 0;\n\n error:\n    VIR_FREE(sigdata);\n    virObjectUnlock(dmn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDaemonSignalSetup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "660-690",
    "snippet": "static int\nvirNetDaemonSignalSetup(virNetDaemonPtr dmn)\n{\n    int fds[2] = { -1, -1 };\n\n    if (dmn->sigwrite != -1)\n        return 0;\n\n    if (virPipeNonBlock(fds) < 0)\n        return -1;\n\n    if ((dmn->sigwatch = virEventAddHandle(fds[0],\n                                           VIR_EVENT_HANDLE_READABLE,\n                                           virNetDaemonSignalEvent,\n                                           dmn, NULL)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to add signal handle watch\"));\n        goto error;\n    }\n\n    dmn->sigread = fds[0];\n    dmn->sigwrite = fds[1];\n    sigWrite = fds[1];\n\n    return 0;\n\n error:\n    VIR_FORCE_CLOSE(fds[0]);\n    VIR_FORCE_CLOSE(fds[1]);\n    return -1;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fds[1]"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fds[0]"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Failed to add signal handle watch\")"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to add signal handle watch\""
          ],
          "line": 676
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virEventAddHandle",
          "args": [
            "fds[0]",
            "VIR_EVENT_HANDLE_READABLE",
            "virNetDaemonSignalEvent",
            "dmn",
            "NULL"
          ],
          "line": 671
        },
        "resolved": true,
        "details": {
          "function_name": "virEventAddHandle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virevent.c",
          "lines": "73-84",
          "snippet": "int\nvirEventAddHandle(int fd,\n                  int events,\n                  virEventHandleCallback cb,\n                  void *opaque,\n                  virFreeCallback ff)\n{\n    if (!addHandleImpl)\n        return -1;\n\n    return addHandleImpl(fd, events, cb, opaque, ff);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vireventglib.h\"",
            "#include \"virevent.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virEventAddHandleFunc addHandleImpl;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vireventglib.h\"\n#include \"virevent.h\"\n#include <config.h>\n\nstatic virEventAddHandleFunc addHandleImpl;\n\nint\nvirEventAddHandle(int fd,\n                  int events,\n                  virEventHandleCallback cb,\n                  void *opaque,\n                  virFreeCallback ff)\n{\n    if (!addHandleImpl)\n        return -1;\n\n    return addHandleImpl(fd, events, cb, opaque, ff);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPipeNonBlock",
          "args": [
            "fds"
          ],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "virPipeNonBlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1813-1817",
          "snippet": "int\nvirPipeNonBlock(int fds[2])\n{\n    return virPipeImpl(fds, true, true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirPipeNonBlock(int fds[2])\n{\n    return virPipeImpl(fds, true, true);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirNetDaemonSignalSetup(virNetDaemonPtr dmn)\n{\n    int fds[2] = { -1, -1 };\n\n    if (dmn->sigwrite != -1)\n        return 0;\n\n    if (virPipeNonBlock(fds) < 0)\n        return -1;\n\n    if ((dmn->sigwatch = virEventAddHandle(fds[0],\n                                           VIR_EVENT_HANDLE_READABLE,\n                                           virNetDaemonSignalEvent,\n                                           dmn, NULL)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to add signal handle watch\"));\n        goto error;\n    }\n\n    dmn->sigread = fds[0];\n    dmn->sigwrite = fds[1];\n    sigWrite = fds[1];\n\n    return 0;\n\n error:\n    VIR_FORCE_CLOSE(fds[0]);\n    VIR_FORCE_CLOSE(fds[1]);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDaemonSignalEvent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "623-658",
    "snippet": "static void\nvirNetDaemonSignalEvent(int watch,\n                        int fd G_GNUC_UNUSED,\n                        int events G_GNUC_UNUSED,\n                        void *opaque)\n{\n    virNetDaemonPtr dmn = opaque;\n    siginfo_t siginfo;\n    size_t i;\n\n    virObjectLock(dmn);\n\n    if (saferead(dmn->sigread, &siginfo, sizeof(siginfo)) != sizeof(siginfo)) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Failed to read from signal pipe\"));\n        virEventRemoveHandle(watch);\n        dmn->sigwatch = -1;\n        goto cleanup;\n    }\n\n    for (i = 0; i < dmn->nsignals; i++) {\n        if (siginfo.si_signo == dmn->signals[i]->signum) {\n            virNetDaemonSignalFunc func = dmn->signals[i]->func;\n            void *funcopaque = dmn->signals[i]->opaque;\n            virObjectUnlock(dmn);\n            func(dmn, &siginfo, funcopaque);\n            return;\n        }\n    }\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"Unexpected signal received: %d\"), siginfo.si_signo);\n\n cleanup:\n    virObjectUnlock(dmn);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dmn"
          ],
          "line": 657
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unexpected signal received: %d\")",
            "siginfo.si_signo"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unexpected signal received: %d\""
          ],
          "line": 654
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "func",
          "args": [
            "dmn",
            "&siginfo",
            "funcopaque"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virEventRemoveHandle",
          "args": [
            "watch"
          ],
          "line": 638
        },
        "resolved": true,
        "details": {
          "function_name": "virEventRemoveHandle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virevent.c",
          "lines": "116-123",
          "snippet": "int\nvirEventRemoveHandle(int watch)\n{\n    if (!removeHandleImpl)\n        return -1;\n\n    return removeHandleImpl(watch);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vireventglib.h\"",
            "#include \"virevent.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virEventRemoveHandleFunc removeHandleImpl;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vireventglib.h\"\n#include \"virevent.h\"\n#include <config.h>\n\nstatic virEventRemoveHandleFunc removeHandleImpl;\n\nint\nvirEventRemoveHandle(int watch)\n{\n    if (!removeHandleImpl)\n        return -1;\n\n    return removeHandleImpl(watch);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Failed to read from signal pipe\")"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "saferead",
          "args": [
            "dmn->sigread",
            "&siginfo",
            "sizeof(siginfo)"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "saferead_lim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1330-1372",
          "snippet": "static char *\nsaferead_lim(int fd, size_t max_len, size_t *length)\n{\n    char *buf = NULL;\n    size_t alloc = 0;\n    size_t size = 0;\n    int save_errno;\n\n    for (;;) {\n        int count;\n        int requested;\n\n        if (size + BUFSIZ + 1 > alloc) {\n            alloc += alloc / 2;\n            if (alloc < size + BUFSIZ + 1)\n                alloc = size + BUFSIZ + 1;\n\n            if (VIR_REALLOC_N(buf, alloc) < 0) {\n                save_errno = errno;\n                break;\n            }\n        }\n\n        /* Ensure that (size + requested <= max_len); */\n        requested = MIN(size < max_len ? max_len - size : 0,\n                        alloc - size - 1);\n        count = saferead(fd, buf + size, requested);\n        size += count;\n\n        if (count != requested || requested == 0) {\n            save_errno = errno;\n            if (count < 0)\n                break;\n            buf[size] = '\\0';\n            *length = size;\n            return buf;\n        }\n    }\n\n    VIR_FREE(buf);\n    errno = save_errno;\n    return NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\nsaferead_lim(int fd, size_t max_len, size_t *length)\n{\n    char *buf = NULL;\n    size_t alloc = 0;\n    size_t size = 0;\n    int save_errno;\n\n    for (;;) {\n        int count;\n        int requested;\n\n        if (size + BUFSIZ + 1 > alloc) {\n            alloc += alloc / 2;\n            if (alloc < size + BUFSIZ + 1)\n                alloc = size + BUFSIZ + 1;\n\n            if (VIR_REALLOC_N(buf, alloc) < 0) {\n                save_errno = errno;\n                break;\n            }\n        }\n\n        /* Ensure that (size + requested <= max_len); */\n        requested = MIN(size < max_len ? max_len - size : 0,\n                        alloc - size - 1);\n        count = saferead(fd, buf + size, requested);\n        size += count;\n\n        if (count != requested || requested == 0) {\n            save_errno = errno;\n            if (count < 0)\n                break;\n            buf[size] = '\\0';\n            *length = size;\n            return buf;\n        }\n    }\n\n    VIR_FREE(buf);\n    errno = save_errno;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dmn"
          ],
          "line": 633
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirNetDaemonSignalEvent(int watch,\n                        int fd G_GNUC_UNUSED,\n                        int events G_GNUC_UNUSED,\n                        void *opaque)\n{\n    virNetDaemonPtr dmn = opaque;\n    siginfo_t siginfo;\n    size_t i;\n\n    virObjectLock(dmn);\n\n    if (saferead(dmn->sigread, &siginfo, sizeof(siginfo)) != sizeof(siginfo)) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Failed to read from signal pipe\"));\n        virEventRemoveHandle(watch);\n        dmn->sigwatch = -1;\n        goto cleanup;\n    }\n\n    for (i = 0; i < dmn->nsignals; i++) {\n        if (siginfo.si_signo == dmn->signals[i]->signum) {\n            virNetDaemonSignalFunc func = dmn->signals[i]->func;\n            void *funcopaque = dmn->signals[i]->opaque;\n            virObjectUnlock(dmn);\n            func(dmn, &siginfo, funcopaque);\n            return;\n        }\n    }\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"Unexpected signal received: %d\"), siginfo.si_signo);\n\n cleanup:\n    virObjectUnlock(dmn);\n}"
  },
  {
    "function_name": "virNetDaemonSignalHandler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "598-621",
    "snippet": "static void\nvirNetDaemonSignalHandler(int sig, siginfo_t * siginfo,\n                          void* context G_GNUC_UNUSED)\n{\n    int origerrno;\n    int r;\n    siginfo_t tmp;\n\n    if (SA_SIGINFO)\n        tmp = *siginfo;\n    else\n        memset(&tmp, 0, sizeof(tmp));\n\n    /* set the sig num in the struct */\n    tmp.si_signo = sig;\n\n    origerrno = errno;\n    r = safewrite(sigWrite, &tmp, sizeof(tmp));\n    if (r == -1) {\n        sigErrors++;\n        sigLastErrno = errno;\n    }\n    errno = origerrno;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "safewrite",
          "args": [
            "sigWrite",
            "&tmp",
            "sizeof(tmp)"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "safewrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1093-1111",
          "snippet": "ssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&tmp",
            "0",
            "sizeof(tmp)"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirNetDaemonSignalHandler(int sig, siginfo_t * siginfo,\n                          void* context G_GNUC_UNUSED)\n{\n    int origerrno;\n    int r;\n    siginfo_t tmp;\n\n    if (SA_SIGINFO)\n        tmp = *siginfo;\n    else\n        memset(&tmp, 0, sizeof(tmp));\n\n    /* set the sig num in the struct */\n    tmp.si_signo = sig;\n\n    origerrno = errno;\n    r = safewrite(sigWrite, &tmp, sizeof(tmp));\n    if (r == -1) {\n        sigErrors++;\n        sigLastErrno = errno;\n    }\n    errno = origerrno;\n}"
  },
  {
    "function_name": "virNetDaemonRemoveShutdownInhibition",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "576-590",
    "snippet": "void\nvirNetDaemonRemoveShutdownInhibition(virNetDaemonPtr dmn)\n{\n    virObjectLock(dmn);\n    dmn->autoShutdownInhibitions--;\n\n    VIR_DEBUG(\"dmn=%p inhibitions=%zu\", dmn, dmn->autoShutdownInhibitions);\n\n    if (dmn->autoShutdownInhibitions == 0) {\n        VIR_DEBUG(\"Closing inhibit FD %d\", dmn->autoShutdownInhibitFd);\n        VIR_FORCE_CLOSE(dmn->autoShutdownInhibitFd);\n    }\n\n    virObjectUnlock(dmn);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dmn"
          ],
          "line": 589
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "dmn->autoShutdownInhibitFd"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Closing inhibit FD %d\"",
            "dmn->autoShutdownInhibitFd"
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dmn=%p inhibitions=%zu\"",
            "dmn",
            "dmn->autoShutdownInhibitions"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dmn"
          ],
          "line": 579
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNetDaemonRemoveShutdownInhibition(virNetDaemonPtr dmn)\n{\n    virObjectLock(dmn);\n    dmn->autoShutdownInhibitions--;\n\n    VIR_DEBUG(\"dmn=%p inhibitions=%zu\", dmn, dmn->autoShutdownInhibitions);\n\n    if (dmn->autoShutdownInhibitions == 0) {\n        VIR_DEBUG(\"Closing inhibit FD %d\", dmn->autoShutdownInhibitFd);\n        VIR_FORCE_CLOSE(dmn->autoShutdownInhibitFd);\n    }\n\n    virObjectUnlock(dmn);\n}"
  },
  {
    "function_name": "virNetDaemonAddShutdownInhibition",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "555-573",
    "snippet": "void\nvirNetDaemonAddShutdownInhibition(virNetDaemonPtr dmn)\n{\n    virObjectLock(dmn);\n    dmn->autoShutdownInhibitions++;\n\n    VIR_DEBUG(\"dmn=%p inhibitions=%zu\", dmn, dmn->autoShutdownInhibitions);\n\n#if defined(WITH_DBUS) && defined(DBUS_TYPE_UNIX_FD)\n    if (dmn->autoShutdownInhibitions == 1)\n        virNetDaemonCallInhibit(dmn,\n                                \"shutdown\",\n                                _(\"Libvirt\"),\n                                _(\"Virtual machines need to be saved\"),\n                                \"delay\");\n#endif\n\n    virObjectUnlock(dmn);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dmn"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDaemonCallInhibit",
          "args": [
            "dmn",
            "\"shutdown\"",
            "_(\"Libvirt\")",
            "_(\"Virtual machines need to be saved\")",
            "\"delay\""
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDaemonCallInhibit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
          "lines": "500-552",
          "snippet": "static void\nvirNetDaemonCallInhibit(virNetDaemonPtr dmn,\n                        const char *what,\n                        const char *who,\n                        const char *why,\n                        const char *mode)\n{\n    DBusMessage *message;\n    DBusPendingCall *pendingReply = NULL;\n    DBusConnection *systemBus;\n\n    VIR_DEBUG(\"dmn=%p what=%s who=%s why=%s mode=%s\",\n              dmn, NULLSTR(what), NULLSTR(who), NULLSTR(why), NULLSTR(mode));\n\n    if (virSystemdHasLogind() < 0)\n        return;\n\n    if (!(systemBus = virDBusGetSystemBus()))\n        return;\n\n    /* Only one outstanding call at a time */\n    if (dmn->autoShutdownCallingInhibit)\n        return;\n\n    message = dbus_message_new_method_call(\"org.freedesktop.login1\",\n                                           \"/org/freedesktop/login1\",\n                                           \"org.freedesktop.login1.Manager\",\n                                           \"Inhibit\");\n    if (message == NULL)\n        return;\n\n    dbus_message_append_args(message,\n                             DBUS_TYPE_STRING, &what,\n                             DBUS_TYPE_STRING, &who,\n                             DBUS_TYPE_STRING, &why,\n                             DBUS_TYPE_STRING, &mode,\n                             DBUS_TYPE_INVALID);\n\n    if (dbus_connection_send_with_reply(systemBus, message,\n                                        &pendingReply,\n                                        25 * 1000) &&\n        pendingReply) {\n        if (dbus_pending_call_get_completed(pendingReply)) {\n            virNetDaemonGotInhibitReplyLocked(pendingReply, dmn);\n        } else {\n            dbus_pending_call_set_notify(pendingReply,\n                                         virNetDaemonGotInhibitReply,\n                                         dmn, NULL);\n        }\n        dmn->autoShutdownCallingInhibit = true;\n    }\n    virDBusMessageUnref(message);\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhash.h\"",
            "#include \"virdbus.h\"",
            "#include \"virnetserver.h\"",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdaemon.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirNetDaemonCallInhibit(virNetDaemonPtr dmn,\n                        const char *what,\n                        const char *who,\n                        const char *why,\n                        const char *mode)\n{\n    DBusMessage *message;\n    DBusPendingCall *pendingReply = NULL;\n    DBusConnection *systemBus;\n\n    VIR_DEBUG(\"dmn=%p what=%s who=%s why=%s mode=%s\",\n              dmn, NULLSTR(what), NULLSTR(who), NULLSTR(why), NULLSTR(mode));\n\n    if (virSystemdHasLogind() < 0)\n        return;\n\n    if (!(systemBus = virDBusGetSystemBus()))\n        return;\n\n    /* Only one outstanding call at a time */\n    if (dmn->autoShutdownCallingInhibit)\n        return;\n\n    message = dbus_message_new_method_call(\"org.freedesktop.login1\",\n                                           \"/org/freedesktop/login1\",\n                                           \"org.freedesktop.login1.Manager\",\n                                           \"Inhibit\");\n    if (message == NULL)\n        return;\n\n    dbus_message_append_args(message,\n                             DBUS_TYPE_STRING, &what,\n                             DBUS_TYPE_STRING, &who,\n                             DBUS_TYPE_STRING, &why,\n                             DBUS_TYPE_STRING, &mode,\n                             DBUS_TYPE_INVALID);\n\n    if (dbus_connection_send_with_reply(systemBus, message,\n                                        &pendingReply,\n                                        25 * 1000) &&\n        pendingReply) {\n        if (dbus_pending_call_get_completed(pendingReply)) {\n            virNetDaemonGotInhibitReplyLocked(pendingReply, dmn);\n        } else {\n            dbus_pending_call_set_notify(pendingReply,\n                                         virNetDaemonGotInhibitReply,\n                                         dmn, NULL);\n        }\n        dmn->autoShutdownCallingInhibit = true;\n    }\n    virDBusMessageUnref(message);\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Virtual machines need to be saved\""
          ],
          "line": 568
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dmn=%p inhibitions=%zu\"",
            "dmn",
            "dmn->autoShutdownInhibitions"
          ],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dmn"
          ],
          "line": 558
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNetDaemonAddShutdownInhibition(virNetDaemonPtr dmn)\n{\n    virObjectLock(dmn);\n    dmn->autoShutdownInhibitions++;\n\n    VIR_DEBUG(\"dmn=%p inhibitions=%zu\", dmn, dmn->autoShutdownInhibitions);\n\n#if defined(WITH_DBUS) && defined(DBUS_TYPE_UNIX_FD)\n    if (dmn->autoShutdownInhibitions == 1)\n        virNetDaemonCallInhibit(dmn,\n                                \"shutdown\",\n                                _(\"Libvirt\"),\n                                _(\"Virtual machines need to be saved\"),\n                                \"delay\");\n#endif\n\n    virObjectUnlock(dmn);\n}"
  },
  {
    "function_name": "virNetDaemonCallInhibit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "500-552",
    "snippet": "static void\nvirNetDaemonCallInhibit(virNetDaemonPtr dmn,\n                        const char *what,\n                        const char *who,\n                        const char *why,\n                        const char *mode)\n{\n    DBusMessage *message;\n    DBusPendingCall *pendingReply = NULL;\n    DBusConnection *systemBus;\n\n    VIR_DEBUG(\"dmn=%p what=%s who=%s why=%s mode=%s\",\n              dmn, NULLSTR(what), NULLSTR(who), NULLSTR(why), NULLSTR(mode));\n\n    if (virSystemdHasLogind() < 0)\n        return;\n\n    if (!(systemBus = virDBusGetSystemBus()))\n        return;\n\n    /* Only one outstanding call at a time */\n    if (dmn->autoShutdownCallingInhibit)\n        return;\n\n    message = dbus_message_new_method_call(\"org.freedesktop.login1\",\n                                           \"/org/freedesktop/login1\",\n                                           \"org.freedesktop.login1.Manager\",\n                                           \"Inhibit\");\n    if (message == NULL)\n        return;\n\n    dbus_message_append_args(message,\n                             DBUS_TYPE_STRING, &what,\n                             DBUS_TYPE_STRING, &who,\n                             DBUS_TYPE_STRING, &why,\n                             DBUS_TYPE_STRING, &mode,\n                             DBUS_TYPE_INVALID);\n\n    if (dbus_connection_send_with_reply(systemBus, message,\n                                        &pendingReply,\n                                        25 * 1000) &&\n        pendingReply) {\n        if (dbus_pending_call_get_completed(pendingReply)) {\n            virNetDaemonGotInhibitReplyLocked(pendingReply, dmn);\n        } else {\n            dbus_pending_call_set_notify(pendingReply,\n                                         virNetDaemonGotInhibitReply,\n                                         dmn, NULL);\n        }\n        dmn->autoShutdownCallingInhibit = true;\n    }\n    virDBusMessageUnref(message);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDBusMessageUnref",
          "args": [
            "message"
          ],
          "line": 551
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusMessageUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1858-1861",
          "snippet": "void virDBusMessageUnref(DBusMessage *msg G_GNUC_UNUSED)\n{\n    /* nothing */\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nvoid virDBusMessageUnref(DBusMessage *msg G_GNUC_UNUSED)\n{\n    /* nothing */\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbus_pending_call_set_notify",
          "args": [
            "pendingReply",
            "virNetDaemonGotInhibitReply",
            "dmn",
            "NULL"
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDaemonGotInhibitReplyLocked",
          "args": [
            "pendingReply",
            "dmn"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDaemonGotInhibitReplyLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
          "lines": "453-484",
          "snippet": "static void\nvirNetDaemonGotInhibitReplyLocked(DBusPendingCall *pending,\n                                  virNetDaemonPtr dmn)\n{\n    DBusMessage *reply;\n    int fd;\n\n    dmn->autoShutdownCallingInhibit = false;\n\n    VIR_DEBUG(\"dmn=%p\", dmn);\n\n    reply = dbus_pending_call_steal_reply(pending);\n    if (reply == NULL)\n        goto cleanup;\n\n    if (dbus_message_get_args(reply, NULL,\n                              DBUS_TYPE_UNIX_FD, &fd,\n                              DBUS_TYPE_INVALID)) {\n        if (dmn->autoShutdownInhibitions) {\n            dmn->autoShutdownInhibitFd = fd;\n            VIR_DEBUG(\"Got inhibit FD %d\", fd);\n        } else {\n            /* We stopped the last VM since we made the inhibit call */\n            VIR_DEBUG(\"Closing inhibit FD %d\", fd);\n            VIR_FORCE_CLOSE(fd);\n        }\n    }\n    virDBusMessageUnref(reply);\n\n cleanup:\n    dbus_pending_call_unref(pending);\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhash.h\"",
            "#include \"virdbus.h\"",
            "#include \"virnetserver.h\"",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdaemon.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirNetDaemonGotInhibitReplyLocked(DBusPendingCall *pending,\n                                  virNetDaemonPtr dmn)\n{\n    DBusMessage *reply;\n    int fd;\n\n    dmn->autoShutdownCallingInhibit = false;\n\n    VIR_DEBUG(\"dmn=%p\", dmn);\n\n    reply = dbus_pending_call_steal_reply(pending);\n    if (reply == NULL)\n        goto cleanup;\n\n    if (dbus_message_get_args(reply, NULL,\n                              DBUS_TYPE_UNIX_FD, &fd,\n                              DBUS_TYPE_INVALID)) {\n        if (dmn->autoShutdownInhibitions) {\n            dmn->autoShutdownInhibitFd = fd;\n            VIR_DEBUG(\"Got inhibit FD %d\", fd);\n        } else {\n            /* We stopped the last VM since we made the inhibit call */\n            VIR_DEBUG(\"Closing inhibit FD %d\", fd);\n            VIR_FORCE_CLOSE(fd);\n        }\n    }\n    virDBusMessageUnref(reply);\n\n cleanup:\n    dbus_pending_call_unref(pending);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbus_pending_call_get_completed",
          "args": [
            "pendingReply"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbus_connection_send_with_reply",
          "args": [
            "systemBus",
            "message",
            "&pendingReply",
            "25 * 1000"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbus_message_append_args",
          "args": [
            "message",
            "DBUS_TYPE_STRING",
            "&what",
            "DBUS_TYPE_STRING",
            "&who",
            "DBUS_TYPE_STRING",
            "&why",
            "DBUS_TYPE_STRING",
            "&mode",
            "DBUS_TYPE_INVALID"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbus_message_new_method_call",
          "args": [
            "\"org.freedesktop.login1\"",
            "\"/org/freedesktop/login1\"",
            "\"org.freedesktop.login1.Manager\"",
            "\"Inhibit\""
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDBusGetSystemBus",
          "args": [],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusGetSystemBus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1744-1749",
          "snippet": "DBusConnection *virDBusGetSystemBus(void)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return NULL;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nDBusConnection *virDBusGetSystemBus(void)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSystemdHasLogind",
          "args": [],
          "line": 514
        },
        "resolved": true,
        "details": {
          "function_name": "virSystemdHasLogind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsystemd.c",
          "lines": "172-194",
          "snippet": "int\nvirSystemdHasLogind(void)\n{\n    int ret;\n    int val;\n\n    val = g_atomic_int_get(&virSystemdHasLogindCachedValue);\n    if (val != -1)\n        return val;\n\n    ret = virDBusIsServiceEnabled(\"org.freedesktop.login1\");\n    if (ret < 0) {\n        if (ret == -2)\n            g_atomic_int_set(&virSystemdHasLogindCachedValue, -2);\n        return ret;\n    }\n\n    if ((ret = virDBusIsServiceRegistered(\"org.freedesktop.login1\")) == -1)\n        return ret;\n\n    g_atomic_int_set(&virSystemdHasLogindCachedValue, ret);\n    return ret;\n}",
          "includes": [
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virdbus.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virsystemdpriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int virSystemdHasLogindCachedValue = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virdbus.h\"\n#include \"virbuffer.h\"\n#include \"virsystemd.h\"\n#include \"virsystemdpriv.h\"\n#include <config.h>\n\nstatic int virSystemdHasLogindCachedValue = -1;\n\nint\nvirSystemdHasLogind(void)\n{\n    int ret;\n    int val;\n\n    val = g_atomic_int_get(&virSystemdHasLogindCachedValue);\n    if (val != -1)\n        return val;\n\n    ret = virDBusIsServiceEnabled(\"org.freedesktop.login1\");\n    if (ret < 0) {\n        if (ret == -2)\n            g_atomic_int_set(&virSystemdHasLogindCachedValue, -2);\n        return ret;\n    }\n\n    if ((ret = virDBusIsServiceRegistered(\"org.freedesktop.login1\")) == -1)\n        return ret;\n\n    g_atomic_int_set(&virSystemdHasLogindCachedValue, ret);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dmn=%p what=%s who=%s why=%s mode=%s\"",
            "dmn",
            "NULLSTR(what)",
            "NULLSTR(who)",
            "NULLSTR(why)",
            "NULLSTR(mode)"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "mode"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "why"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "who"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "what"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirNetDaemonCallInhibit(virNetDaemonPtr dmn,\n                        const char *what,\n                        const char *who,\n                        const char *why,\n                        const char *mode)\n{\n    DBusMessage *message;\n    DBusPendingCall *pendingReply = NULL;\n    DBusConnection *systemBus;\n\n    VIR_DEBUG(\"dmn=%p what=%s who=%s why=%s mode=%s\",\n              dmn, NULLSTR(what), NULLSTR(who), NULLSTR(why), NULLSTR(mode));\n\n    if (virSystemdHasLogind() < 0)\n        return;\n\n    if (!(systemBus = virDBusGetSystemBus()))\n        return;\n\n    /* Only one outstanding call at a time */\n    if (dmn->autoShutdownCallingInhibit)\n        return;\n\n    message = dbus_message_new_method_call(\"org.freedesktop.login1\",\n                                           \"/org/freedesktop/login1\",\n                                           \"org.freedesktop.login1.Manager\",\n                                           \"Inhibit\");\n    if (message == NULL)\n        return;\n\n    dbus_message_append_args(message,\n                             DBUS_TYPE_STRING, &what,\n                             DBUS_TYPE_STRING, &who,\n                             DBUS_TYPE_STRING, &why,\n                             DBUS_TYPE_STRING, &mode,\n                             DBUS_TYPE_INVALID);\n\n    if (dbus_connection_send_with_reply(systemBus, message,\n                                        &pendingReply,\n                                        25 * 1000) &&\n        pendingReply) {\n        if (dbus_pending_call_get_completed(pendingReply)) {\n            virNetDaemonGotInhibitReplyLocked(pendingReply, dmn);\n        } else {\n            dbus_pending_call_set_notify(pendingReply,\n                                         virNetDaemonGotInhibitReply,\n                                         dmn, NULL);\n        }\n        dmn->autoShutdownCallingInhibit = true;\n    }\n    virDBusMessageUnref(message);\n}"
  },
  {
    "function_name": "virNetDaemonGotInhibitReply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "487-496",
    "snippet": "static void\nvirNetDaemonGotInhibitReply(DBusPendingCall *pending,\n                            void *opaque)\n{\n    virNetDaemonPtr dmn = opaque;\n\n    virObjectLock(dmn);\n    virNetDaemonGotInhibitReplyLocked(pending, dmn);\n    virObjectUnlock(dmn);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dmn"
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDaemonGotInhibitReplyLocked",
          "args": [
            "pending",
            "dmn"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDaemonGotInhibitReplyLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
          "lines": "453-484",
          "snippet": "static void\nvirNetDaemonGotInhibitReplyLocked(DBusPendingCall *pending,\n                                  virNetDaemonPtr dmn)\n{\n    DBusMessage *reply;\n    int fd;\n\n    dmn->autoShutdownCallingInhibit = false;\n\n    VIR_DEBUG(\"dmn=%p\", dmn);\n\n    reply = dbus_pending_call_steal_reply(pending);\n    if (reply == NULL)\n        goto cleanup;\n\n    if (dbus_message_get_args(reply, NULL,\n                              DBUS_TYPE_UNIX_FD, &fd,\n                              DBUS_TYPE_INVALID)) {\n        if (dmn->autoShutdownInhibitions) {\n            dmn->autoShutdownInhibitFd = fd;\n            VIR_DEBUG(\"Got inhibit FD %d\", fd);\n        } else {\n            /* We stopped the last VM since we made the inhibit call */\n            VIR_DEBUG(\"Closing inhibit FD %d\", fd);\n            VIR_FORCE_CLOSE(fd);\n        }\n    }\n    virDBusMessageUnref(reply);\n\n cleanup:\n    dbus_pending_call_unref(pending);\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhash.h\"",
            "#include \"virdbus.h\"",
            "#include \"virnetserver.h\"",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdaemon.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirNetDaemonGotInhibitReplyLocked(DBusPendingCall *pending,\n                                  virNetDaemonPtr dmn)\n{\n    DBusMessage *reply;\n    int fd;\n\n    dmn->autoShutdownCallingInhibit = false;\n\n    VIR_DEBUG(\"dmn=%p\", dmn);\n\n    reply = dbus_pending_call_steal_reply(pending);\n    if (reply == NULL)\n        goto cleanup;\n\n    if (dbus_message_get_args(reply, NULL,\n                              DBUS_TYPE_UNIX_FD, &fd,\n                              DBUS_TYPE_INVALID)) {\n        if (dmn->autoShutdownInhibitions) {\n            dmn->autoShutdownInhibitFd = fd;\n            VIR_DEBUG(\"Got inhibit FD %d\", fd);\n        } else {\n            /* We stopped the last VM since we made the inhibit call */\n            VIR_DEBUG(\"Closing inhibit FD %d\", fd);\n            VIR_FORCE_CLOSE(fd);\n        }\n    }\n    virDBusMessageUnref(reply);\n\n cleanup:\n    dbus_pending_call_unref(pending);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dmn"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirNetDaemonGotInhibitReply(DBusPendingCall *pending,\n                            void *opaque)\n{\n    virNetDaemonPtr dmn = opaque;\n\n    virObjectLock(dmn);\n    virNetDaemonGotInhibitReplyLocked(pending, dmn);\n    virObjectUnlock(dmn);\n}"
  },
  {
    "function_name": "virNetDaemonGotInhibitReplyLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "453-484",
    "snippet": "static void\nvirNetDaemonGotInhibitReplyLocked(DBusPendingCall *pending,\n                                  virNetDaemonPtr dmn)\n{\n    DBusMessage *reply;\n    int fd;\n\n    dmn->autoShutdownCallingInhibit = false;\n\n    VIR_DEBUG(\"dmn=%p\", dmn);\n\n    reply = dbus_pending_call_steal_reply(pending);\n    if (reply == NULL)\n        goto cleanup;\n\n    if (dbus_message_get_args(reply, NULL,\n                              DBUS_TYPE_UNIX_FD, &fd,\n                              DBUS_TYPE_INVALID)) {\n        if (dmn->autoShutdownInhibitions) {\n            dmn->autoShutdownInhibitFd = fd;\n            VIR_DEBUG(\"Got inhibit FD %d\", fd);\n        } else {\n            /* We stopped the last VM since we made the inhibit call */\n            VIR_DEBUG(\"Closing inhibit FD %d\", fd);\n            VIR_FORCE_CLOSE(fd);\n        }\n    }\n    virDBusMessageUnref(reply);\n\n cleanup:\n    dbus_pending_call_unref(pending);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dbus_pending_call_unref",
          "args": [
            "pending"
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDBusMessageUnref",
          "args": [
            "reply"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusMessageUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1858-1861",
          "snippet": "void virDBusMessageUnref(DBusMessage *msg G_GNUC_UNUSED)\n{\n    /* nothing */\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nvoid virDBusMessageUnref(DBusMessage *msg G_GNUC_UNUSED)\n{\n    /* nothing */\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Closing inhibit FD %d\"",
            "fd"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Got inhibit FD %d\"",
            "fd"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbus_message_get_args",
          "args": [
            "reply",
            "NULL",
            "DBUS_TYPE_UNIX_FD",
            "&fd",
            "DBUS_TYPE_INVALID"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbus_pending_call_steal_reply",
          "args": [
            "pending"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dmn=%p\"",
            "dmn"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirNetDaemonGotInhibitReplyLocked(DBusPendingCall *pending,\n                                  virNetDaemonPtr dmn)\n{\n    DBusMessage *reply;\n    int fd;\n\n    dmn->autoShutdownCallingInhibit = false;\n\n    VIR_DEBUG(\"dmn=%p\", dmn);\n\n    reply = dbus_pending_call_steal_reply(pending);\n    if (reply == NULL)\n        goto cleanup;\n\n    if (dbus_message_get_args(reply, NULL,\n                              DBUS_TYPE_UNIX_FD, &fd,\n                              DBUS_TYPE_INVALID)) {\n        if (dmn->autoShutdownInhibitions) {\n            dmn->autoShutdownInhibitFd = fd;\n            VIR_DEBUG(\"Got inhibit FD %d\", fd);\n        } else {\n            /* We stopped the last VM since we made the inhibit call */\n            VIR_DEBUG(\"Closing inhibit FD %d\", fd);\n            VIR_FORCE_CLOSE(fd);\n        }\n    }\n    virDBusMessageUnref(reply);\n\n cleanup:\n    dbus_pending_call_unref(pending);\n}"
  },
  {
    "function_name": "virNetDaemonAutoShutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "440-449",
    "snippet": "void\nvirNetDaemonAutoShutdown(virNetDaemonPtr dmn,\n                         unsigned int timeout)\n{\n    virObjectLock(dmn);\n\n    dmn->autoShutdownTimeout = timeout;\n\n    virObjectUnlock(dmn);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dmn"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dmn"
          ],
          "line": 444
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNetDaemonAutoShutdown(virNetDaemonPtr dmn,\n                         unsigned int timeout)\n{\n    virObjectLock(dmn);\n\n    dmn->autoShutdownTimeout = timeout;\n\n    virObjectUnlock(dmn);\n}"
  },
  {
    "function_name": "virNetDaemonIsPrivileged",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "429-437",
    "snippet": "bool\nvirNetDaemonIsPrivileged(virNetDaemonPtr dmn)\n{\n    bool priv;\n    virObjectLock(dmn);\n    priv = dmn->privileged;\n    virObjectUnlock(dmn);\n    return priv;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dmn"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dmn"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirNetDaemonIsPrivileged(virNetDaemonPtr dmn)\n{\n    bool priv;\n    virObjectLock(dmn);\n    priv = dmn->privileged;\n    virObjectUnlock(dmn);\n    return priv;\n}"
  },
  {
    "function_name": "virNetDaemonPreExecRestart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "381-426",
    "snippet": "virJSONValuePtr\nvirNetDaemonPreExecRestart(virNetDaemonPtr dmn)\n{\n    size_t i = 0;\n    virJSONValuePtr object = virJSONValueNewObject();\n    virJSONValuePtr srvObj = virJSONValueNewObject();\n    virHashKeyValuePairPtr srvArray = NULL;\n\n    virObjectLock(dmn);\n\n    if (virJSONValueObjectAppend(object, \"servers\", srvObj) < 0) {\n        virJSONValueFree(srvObj);\n        goto error;\n    }\n\n    if (!(srvArray = virHashGetItems(dmn->servers, daemonServerCompare)))\n        goto error;\n\n    for (i = 0; srvArray[i].key; i++) {\n        virNetServerPtr server = virHashLookup(dmn->servers, srvArray[i].key);\n        virJSONValuePtr srvJSON;\n\n        if (!server)\n            goto error;\n\n        srvJSON = virNetServerPreExecRestart(server);\n        if (!srvJSON)\n            goto error;\n\n        if (virJSONValueObjectAppend(srvObj, srvArray[i].key, srvJSON) < 0) {\n            virJSONValueFree(srvJSON);\n            goto error;\n        }\n    }\n\n    VIR_FREE(srvArray);\n    virObjectUnlock(dmn);\n\n    return object;\n\n error:\n    VIR_FREE(srvArray);\n    virJSONValueFree(object);\n    virObjectUnlock(dmn);\n    return NULL;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dmn"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "object"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "srvArray"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "srvArray"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppend",
          "args": [
            "srvObj",
            "srvArray[i].key",
            "srvJSON"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "741-754",
          "snippet": "int\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerPreExecRestart",
          "args": [
            "server"
          ],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerPreExecRestart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserver.c",
          "lines": "549-649",
          "snippet": "virJSONValuePtr virNetServerPreExecRestart(virNetServerPtr srv)\n{\n    virJSONValuePtr object = virJSONValueNewObject();\n    virJSONValuePtr clients;\n    virJSONValuePtr services;\n    size_t i;\n\n    virObjectLock(srv);\n\n    if (virJSONValueObjectAppendNumberUint(object, \"min_workers\",\n                                           virThreadPoolGetMinWorkers(srv->workers)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot set min_workers data in JSON document\"));\n        goto error;\n    }\n    if (virJSONValueObjectAppendNumberUint(object, \"max_workers\",\n                                           virThreadPoolGetMaxWorkers(srv->workers)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot set max_workers data in JSON document\"));\n        goto error;\n    }\n    if (virJSONValueObjectAppendNumberUint(object, \"priority_workers\",\n                                           virThreadPoolGetPriorityWorkers(srv->workers)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot set priority_workers data in JSON document\"));\n        goto error;\n    }\n    if (virJSONValueObjectAppendNumberUint(object, \"max_clients\", srv->nclients_max) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot set max_clients data in JSON document\"));\n        goto error;\n    }\n    if (virJSONValueObjectAppendNumberUint(object, \"max_anonymous_clients\",\n                                           srv->nclients_unauth_max) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot set max_anonymous_clients data in JSON document\"));\n        goto error;\n    }\n    if (virJSONValueObjectAppendNumberUint(object, \"keepaliveInterval\", srv->keepaliveInterval) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot set keepaliveInterval data in JSON document\"));\n        goto error;\n    }\n    if (virJSONValueObjectAppendNumberUint(object, \"keepaliveCount\", srv->keepaliveCount) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot set keepaliveCount data in JSON document\"));\n        goto error;\n    }\n\n    if (virJSONValueObjectAppendNumberUlong(object, \"next_client_id\",\n                                            srv->next_client_id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot set next_client_id data in JSON document\"));\n        goto error;\n    }\n\n    services = virJSONValueNewArray();\n\n    if (virJSONValueObjectAppend(object, \"services\", services) < 0) {\n        virJSONValueFree(services);\n        goto error;\n    }\n\n    for (i = 0; i < srv->nservices; i++) {\n        virJSONValuePtr child;\n        if (!(child = virNetServerServicePreExecRestart(srv->services[i])))\n            goto error;\n\n        if (virJSONValueArrayAppend(services, child) < 0) {\n            virJSONValueFree(child);\n            goto error;\n        }\n    }\n\n    clients = virJSONValueNewArray();\n\n    if (virJSONValueObjectAppend(object, \"clients\", clients) < 0) {\n        virJSONValueFree(clients);\n        goto error;\n    }\n\n    for (i = 0; i < srv->nclients; i++) {\n        virJSONValuePtr child;\n        if (!(child = virNetServerClientPreExecRestart(srv->clients[i])))\n            goto error;\n\n        if (virJSONValueArrayAppend(clients, child) < 0) {\n            virJSONValueFree(child);\n            goto error;\n        }\n    }\n\n    virObjectUnlock(srv);\n\n    return object;\n\n error:\n    virJSONValueFree(object);\n    virObjectUnlock(srv);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);",
            "static inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetserver.h\"\n#include <config.h>\n\nstatic inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);\nstatic inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);\n\nvirJSONValuePtr virNetServerPreExecRestart(virNetServerPtr srv)\n{\n    virJSONValuePtr object = virJSONValueNewObject();\n    virJSONValuePtr clients;\n    virJSONValuePtr services;\n    size_t i;\n\n    virObjectLock(srv);\n\n    if (virJSONValueObjectAppendNumberUint(object, \"min_workers\",\n                                           virThreadPoolGetMinWorkers(srv->workers)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot set min_workers data in JSON document\"));\n        goto error;\n    }\n    if (virJSONValueObjectAppendNumberUint(object, \"max_workers\",\n                                           virThreadPoolGetMaxWorkers(srv->workers)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot set max_workers data in JSON document\"));\n        goto error;\n    }\n    if (virJSONValueObjectAppendNumberUint(object, \"priority_workers\",\n                                           virThreadPoolGetPriorityWorkers(srv->workers)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot set priority_workers data in JSON document\"));\n        goto error;\n    }\n    if (virJSONValueObjectAppendNumberUint(object, \"max_clients\", srv->nclients_max) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot set max_clients data in JSON document\"));\n        goto error;\n    }\n    if (virJSONValueObjectAppendNumberUint(object, \"max_anonymous_clients\",\n                                           srv->nclients_unauth_max) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot set max_anonymous_clients data in JSON document\"));\n        goto error;\n    }\n    if (virJSONValueObjectAppendNumberUint(object, \"keepaliveInterval\", srv->keepaliveInterval) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot set keepaliveInterval data in JSON document\"));\n        goto error;\n    }\n    if (virJSONValueObjectAppendNumberUint(object, \"keepaliveCount\", srv->keepaliveCount) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot set keepaliveCount data in JSON document\"));\n        goto error;\n    }\n\n    if (virJSONValueObjectAppendNumberUlong(object, \"next_client_id\",\n                                            srv->next_client_id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot set next_client_id data in JSON document\"));\n        goto error;\n    }\n\n    services = virJSONValueNewArray();\n\n    if (virJSONValueObjectAppend(object, \"services\", services) < 0) {\n        virJSONValueFree(services);\n        goto error;\n    }\n\n    for (i = 0; i < srv->nservices; i++) {\n        virJSONValuePtr child;\n        if (!(child = virNetServerServicePreExecRestart(srv->services[i])))\n            goto error;\n\n        if (virJSONValueArrayAppend(services, child) < 0) {\n            virJSONValueFree(child);\n            goto error;\n        }\n    }\n\n    clients = virJSONValueNewArray();\n\n    if (virJSONValueObjectAppend(object, \"clients\", clients) < 0) {\n        virJSONValueFree(clients);\n        goto error;\n    }\n\n    for (i = 0; i < srv->nclients; i++) {\n        virJSONValuePtr child;\n        if (!(child = virNetServerClientPreExecRestart(srv->clients[i])))\n            goto error;\n\n        if (virJSONValueArrayAppend(clients, child) < 0) {\n            virJSONValueFree(child);\n            goto error;\n        }\n    }\n\n    virObjectUnlock(srv);\n\n    return object;\n\n error:\n    virJSONValueFree(object);\n    virObjectUnlock(srv);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "dmn->servers",
            "srvArray[i].key"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashGetItems",
          "args": [
            "dmn->servers",
            "daemonServerCompare"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "virHashGetItems",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "783-805",
          "snippet": "virHashKeyValuePairPtr virHashGetItems(virHashTablePtr table,\n                                       virHashKeyComparator compar)\n{\n    ssize_t numElems = virHashSize(table);\n    struct getKeysIter iter = {\n        .arrayIdx = 0,\n        .sortArray = NULL,\n    };\n\n    if (numElems < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N(iter.sortArray, numElems + 1))\n        return NULL;\n\n    virHashForEach(table, virHashGetKeysIterator, &iter);\n\n    if (compar)\n        qsort(&iter.sortArray[0], numElems, sizeof(iter.sortArray[0]),\n              (qsort_comp)compar);\n\n    return iter.sortArray;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashKeyValuePairPtr virHashGetItems(virHashTablePtr table,\n                                       virHashKeyComparator compar)\n{\n    ssize_t numElems = virHashSize(table);\n    struct getKeysIter iter = {\n        .arrayIdx = 0,\n        .sortArray = NULL,\n    };\n\n    if (numElems < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N(iter.sortArray, numElems + 1))\n        return NULL;\n\n    virHashForEach(table, virHashGetKeysIterator, &iter);\n\n    if (compar)\n        qsort(&iter.sortArray[0], numElems, sizeof(iter.sortArray[0]),\n              (qsort_comp)compar);\n\n    return iter.sortArray;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dmn"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewObject",
          "args": [],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "571-579",
          "snippet": "virJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvirJSONValuePtr\nvirNetDaemonPreExecRestart(virNetDaemonPtr dmn)\n{\n    size_t i = 0;\n    virJSONValuePtr object = virJSONValueNewObject();\n    virJSONValuePtr srvObj = virJSONValueNewObject();\n    virHashKeyValuePairPtr srvArray = NULL;\n\n    virObjectLock(dmn);\n\n    if (virJSONValueObjectAppend(object, \"servers\", srvObj) < 0) {\n        virJSONValueFree(srvObj);\n        goto error;\n    }\n\n    if (!(srvArray = virHashGetItems(dmn->servers, daemonServerCompare)))\n        goto error;\n\n    for (i = 0; srvArray[i].key; i++) {\n        virNetServerPtr server = virHashLookup(dmn->servers, srvArray[i].key);\n        virJSONValuePtr srvJSON;\n\n        if (!server)\n            goto error;\n\n        srvJSON = virNetServerPreExecRestart(server);\n        if (!srvJSON)\n            goto error;\n\n        if (virJSONValueObjectAppend(srvObj, srvArray[i].key, srvJSON) < 0) {\n            virJSONValueFree(srvJSON);\n            goto error;\n        }\n    }\n\n    VIR_FREE(srvArray);\n    virObjectUnlock(dmn);\n\n    return object;\n\n error:\n    VIR_FREE(srvArray);\n    virJSONValueFree(object);\n    virObjectUnlock(dmn);\n    return NULL;\n}"
  },
  {
    "function_name": "daemonServerCompare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "372-379",
    "snippet": "static int\ndaemonServerCompare(const virHashKeyValuePair *a, const virHashKeyValuePair *b)\n{\n    const char *as = a->key;\n    const char *bs = b->key;\n\n    return strcmp(as, bs);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "as",
            "bs"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\ndaemonServerCompare(const virHashKeyValuePair *a, const virHashKeyValuePair *b)\n{\n    const char *as = a->key;\n    const char *bs = b->key;\n\n    return strcmp(as, bs);\n}"
  },
  {
    "function_name": "virNetDaemonNewPostExecRestart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "293-369",
    "snippet": "virNetDaemonPtr\nvirNetDaemonNewPostExecRestart(virJSONValuePtr object,\n                               size_t nDefServerNames,\n                               const char **defServerNames,\n                               virNetDaemonNewServerPostExecRestart cb,\n                               void *opaque)\n{\n    virNetDaemonPtr dmn = NULL;\n    virJSONValuePtr servers = virJSONValueObjectGet(object, \"servers\");\n    bool new_version = virJSONValueObjectHasKey(object, \"servers\");\n\n    if (!(dmn = virNetDaemonNew()))\n        goto error;\n\n    if (new_version && !servers) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Malformed servers data in JSON document\"));\n        goto error;\n    }\n\n    if (!new_version) {\n        virNetServerPtr srv;\n\n        if (nDefServerNames < 1) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"No default server names provided\"));\n            goto error;\n        }\n\n        VIR_DEBUG(\"No 'servers' data, creating default '%s' name\", defServerNames[0]);\n\n        srv = cb(dmn, defServerNames[0], object, opaque);\n\n        if (virHashAddEntry(dmn->servers, defServerNames[0], srv) < 0)\n            goto error;\n    } else if (virJSONValueIsArray(servers)) {\n        size_t i;\n        size_t n = virJSONValueArraySize(servers);\n        if (n > nDefServerNames) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Server count %zd greater than default name count %zu\"),\n                           n, nDefServerNames);\n            goto error;\n        }\n\n        for (i = 0; i < n; i++) {\n            virNetServerPtr srv;\n            virJSONValuePtr value = virJSONValueArrayGet(servers, i);\n\n            VIR_DEBUG(\"Creating server '%s'\", defServerNames[i]);\n            srv = cb(dmn, defServerNames[i], value, opaque);\n            if (!srv)\n                goto error;\n\n            if (virHashAddEntry(dmn->servers, defServerNames[i], srv) < 0) {\n                virObjectUnref(srv);\n                goto error;\n            }\n        }\n    } else {\n        struct virNetDaemonServerData data = {\n            dmn,\n            cb,\n            opaque,\n        };\n        if (virJSONValueObjectForeachKeyValue(servers,\n                                              virNetDaemonServerIterator,\n                                              &data) < 0)\n            goto error;\n    }\n\n    return dmn;\n\n error:\n    virObjectUnref(dmn);\n    return NULL;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "dmn"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectForeachKeyValue",
          "args": [
            "servers",
            "virNetDaemonServerIterator",
            "&data"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectForeachKeyValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1469-1487",
          "snippet": "int\nvirJSONValueObjectForeachKeyValue(virJSONValuePtr object,\n                                  virJSONValueObjectIteratorFunc cb,\n                                  void *opaque)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        virJSONObjectPairPtr elem = object->data.object.pairs + i;\n\n        if (cb(elem->key, elem->value, opaque) < 0)\n            return -2;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectForeachKeyValue(virJSONValuePtr object,\n                                  virJSONValueObjectIteratorFunc cb,\n                                  void *opaque)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        virJSONObjectPairPtr elem = object->data.object.pairs + i;\n\n        if (cb(elem->key, elem->value, opaque) < 0)\n            return -2;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "dmn->servers",
            "defServerNames[i]",
            "srv"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cb",
          "args": [
            "dmn",
            "defServerNames[i]",
            "value",
            "opaque"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Creating server '%s'\"",
            "defServerNames[i]"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayGet",
          "args": [
            "servers",
            "i"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1024-1035",
          "snippet": "virJSONValuePtr\nvirJSONValueArrayGet(virJSONValuePtr array,\n                     unsigned int element)\n{\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return NULL;\n\n    if (element >= array->data.array.nvalues)\n        return NULL;\n\n    return array->data.array.values[element];\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueArrayGet(virJSONValuePtr array,\n                     unsigned int element)\n{\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return NULL;\n\n    if (element >= array->data.array.nvalues)\n        return NULL;\n\n    return array->data.array.values[element];\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Server count %zd greater than default name count %zu\")",
            "n",
            "nDefServerNames"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Server count %zd greater than default name count %zu\""
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueArraySize",
          "args": [
            "servers"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArraySize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1017-1021",
          "snippet": "size_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nsize_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueIsArray",
          "args": [
            "servers"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueIsArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1010-1014",
          "snippet": "bool\nvirJSONValueIsArray(virJSONValuePtr array)\n{\n    return array->type == VIR_JSON_TYPE_ARRAY;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nbool\nvirJSONValueIsArray(virJSONValuePtr array)\n{\n    return array->type == VIR_JSON_TYPE_ARRAY;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cb",
          "args": [
            "dmn",
            "defServerNames[0]",
            "object",
            "opaque"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"No 'servers' data, creating default '%s' name\"",
            "defServerNames[0]"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"No default server names provided\")"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Malformed servers data in JSON document\")"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDaemonNew",
          "args": [],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDaemonNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
          "lines": "120-158",
          "snippet": "virNetDaemonPtr\nvirNetDaemonNew(void)\n{\n    virNetDaemonPtr dmn;\n#ifndef WIN32\n    struct sigaction sig_action;\n#endif /* !WIN32 */\n\n    if (virNetDaemonInitialize() < 0)\n        return NULL;\n\n    if (!(dmn = virObjectLockableNew(virNetDaemonClass)))\n        return NULL;\n\n    if (!(dmn->servers = virHashCreate(5, virObjectFreeHashData)))\n        goto error;\n\n#ifndef WIN32\n    dmn->sigwrite = dmn->sigread = -1;\n#endif /* !WIN32 */\n\n    dmn->privileged = geteuid() == 0;\n    dmn->autoShutdownInhibitFd = -1;\n\n    if (virEventRegisterDefaultImpl() < 0)\n        goto error;\n\n#ifndef WIN32\n    memset(&sig_action, 0, sizeof(sig_action));\n    sig_action.sa_handler = SIG_IGN;\n    sigaction(SIGPIPE, &sig_action, NULL);\n#endif /* !WIN32 */\n\n    return dmn;\n\n error:\n    virObjectUnref(dmn);\n    return NULL;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhash.h\"",
            "#include \"virdbus.h\"",
            "#include \"virnetserver.h\"",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdaemon.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virNetDaemonClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virClassPtr virNetDaemonClass;\n\nvirNetDaemonPtr\nvirNetDaemonNew(void)\n{\n    virNetDaemonPtr dmn;\n#ifndef WIN32\n    struct sigaction sig_action;\n#endif /* !WIN32 */\n\n    if (virNetDaemonInitialize() < 0)\n        return NULL;\n\n    if (!(dmn = virObjectLockableNew(virNetDaemonClass)))\n        return NULL;\n\n    if (!(dmn->servers = virHashCreate(5, virObjectFreeHashData)))\n        goto error;\n\n#ifndef WIN32\n    dmn->sigwrite = dmn->sigread = -1;\n#endif /* !WIN32 */\n\n    dmn->privileged = geteuid() == 0;\n    dmn->autoShutdownInhibitFd = -1;\n\n    if (virEventRegisterDefaultImpl() < 0)\n        goto error;\n\n#ifndef WIN32\n    memset(&sig_action, 0, sizeof(sig_action));\n    sig_action.sa_handler = SIG_IGN;\n    sigaction(SIGPIPE, &sig_action, NULL);\n#endif /* !WIN32 */\n\n    return dmn;\n\n error:\n    virObjectUnref(dmn);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectHasKey",
          "args": [
            "object",
            "\"servers\""
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectHasKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "838-853",
          "snippet": "int\nvirJSONValueObjectHasKey(virJSONValuePtr object,\n                         const char *key)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key))\n            return 1;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectHasKey(virJSONValuePtr object,\n                         const char *key)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key))\n            return 1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGet",
          "args": [
            "object",
            "\"servers\""
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvirNetDaemonPtr\nvirNetDaemonNewPostExecRestart(virJSONValuePtr object,\n                               size_t nDefServerNames,\n                               const char **defServerNames,\n                               virNetDaemonNewServerPostExecRestart cb,\n                               void *opaque)\n{\n    virNetDaemonPtr dmn = NULL;\n    virJSONValuePtr servers = virJSONValueObjectGet(object, \"servers\");\n    bool new_version = virJSONValueObjectHasKey(object, \"servers\");\n\n    if (!(dmn = virNetDaemonNew()))\n        goto error;\n\n    if (new_version && !servers) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Malformed servers data in JSON document\"));\n        goto error;\n    }\n\n    if (!new_version) {\n        virNetServerPtr srv;\n\n        if (nDefServerNames < 1) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"No default server names provided\"));\n            goto error;\n        }\n\n        VIR_DEBUG(\"No 'servers' data, creating default '%s' name\", defServerNames[0]);\n\n        srv = cb(dmn, defServerNames[0], object, opaque);\n\n        if (virHashAddEntry(dmn->servers, defServerNames[0], srv) < 0)\n            goto error;\n    } else if (virJSONValueIsArray(servers)) {\n        size_t i;\n        size_t n = virJSONValueArraySize(servers);\n        if (n > nDefServerNames) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Server count %zd greater than default name count %zu\"),\n                           n, nDefServerNames);\n            goto error;\n        }\n\n        for (i = 0; i < n; i++) {\n            virNetServerPtr srv;\n            virJSONValuePtr value = virJSONValueArrayGet(servers, i);\n\n            VIR_DEBUG(\"Creating server '%s'\", defServerNames[i]);\n            srv = cb(dmn, defServerNames[i], value, opaque);\n            if (!srv)\n                goto error;\n\n            if (virHashAddEntry(dmn->servers, defServerNames[i], srv) < 0) {\n                virObjectUnref(srv);\n                goto error;\n            }\n        }\n    } else {\n        struct virNetDaemonServerData data = {\n            dmn,\n            cb,\n            opaque,\n        };\n        if (virJSONValueObjectForeachKeyValue(servers,\n                                              virNetDaemonServerIterator,\n                                              &data) < 0)\n            goto error;\n    }\n\n    return dmn;\n\n error:\n    virObjectUnref(dmn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetDaemonServerIterator",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "273-290",
    "snippet": "static int\nvirNetDaemonServerIterator(const char *key,\n                           virJSONValuePtr value,\n                           void *opaque)\n{\n    struct virNetDaemonServerData *data = opaque;\n    virNetServerPtr srv;\n\n    VIR_DEBUG(\"Creating server '%s'\", key);\n    srv = data->cb(data->dmn, key, value, data->opaque);\n    if (!srv)\n        return -1;\n\n    if (virHashAddEntry(data->dmn->servers, key, srv) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "data->dmn->servers",
            "key",
            "srv"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->cb",
          "args": [
            "data->dmn",
            "key",
            "value",
            "data->opaque"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Creating server '%s'\"",
            "key"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirNetDaemonServerIterator(const char *key,\n                           virJSONValuePtr value,\n                           void *opaque)\n{\n    struct virNetDaemonServerData *data = opaque;\n    virNetServerPtr srv;\n\n    VIR_DEBUG(\"Creating server '%s'\", key);\n    srv = data->cb(data->dmn, key, value, data->opaque);\n    if (!srv)\n        return -1;\n\n    if (virHashAddEntry(data->dmn->servers, key, srv) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDaemonGetServers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "240-264",
    "snippet": "ssize_t\nvirNetDaemonGetServers(virNetDaemonPtr dmn,\n                       virNetServerPtr **servers)\n{\n    struct collectData data = { servers, 0 };\n    ssize_t ret = -1;\n\n    *servers = NULL;\n\n    virObjectLock(dmn);\n\n    if (virHashForEach(dmn->servers, collectServers, &data) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot get all servers from daemon\"));\n        goto cleanup;\n    }\n\n    ret = data.nservers;\n\n cleanup:\n    if (ret < 0)\n        virObjectListFreeCount(*servers, data.nservers);\n    virObjectUnlock(dmn);\n    return ret;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dmn"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectListFreeCount",
          "args": [
            "*servers",
            "data.nservers"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectListFreeCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "625-638",
          "snippet": "void\nvirObjectListFreeCount(void *list,\n                       size_t count)\n{\n    size_t i;\n\n    if (!list)\n        return;\n\n    for (i = 0; i < count; i++)\n        virObjectUnref(((void **)list)[i]);\n\n    VIR_FREE(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid\nvirObjectListFreeCount(void *list,\n                       size_t count)\n{\n    size_t i;\n\n    if (!list)\n        return;\n\n    for (i = 0; i < count; i++)\n        virObjectUnref(((void **)list)[i]);\n\n    VIR_FREE(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot get all servers from daemon\")"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot get all servers from daemon\""
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "dmn->servers",
            "collectServers",
            "&data"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dmn"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nssize_t\nvirNetDaemonGetServers(virNetDaemonPtr dmn,\n                       virNetServerPtr **servers)\n{\n    struct collectData data = { servers, 0 };\n    ssize_t ret = -1;\n\n    *servers = NULL;\n\n    virObjectLock(dmn);\n\n    if (virHashForEach(dmn->servers, collectServers, &data) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot get all servers from daemon\"));\n        goto cleanup;\n    }\n\n    ret = data.nservers;\n\n cleanup:\n    if (ret < 0)\n        virObjectListFreeCount(*servers, data.nservers);\n    virObjectUnlock(dmn);\n    return ret;\n}"
  },
  {
    "function_name": "collectServers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "220-232",
    "snippet": "static int\ncollectServers(void *payload,\n               const void *name G_GNUC_UNUSED,\n               void *opaque)\n{\n    virNetServerPtr srv = virObjectRef(payload);\n    struct collectData *data = opaque;\n\n    if (!srv)\n        return -1;\n\n    return VIR_APPEND_ELEMENT(*data->servers, data->nservers, srv);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "*data->servers",
            "data->nservers",
            "srv"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "payload"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\ncollectServers(void *payload,\n               const void *name G_GNUC_UNUSED,\n               void *opaque)\n{\n    virNetServerPtr srv = virObjectRef(payload);\n    struct collectData *data = opaque;\n\n    if (!srv)\n        return -1;\n\n    return VIR_APPEND_ELEMENT(*data->servers, data->nservers, srv);\n}"
  },
  {
    "function_name": "virNetDaemonHasServer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "200-211",
    "snippet": "bool\nvirNetDaemonHasServer(virNetDaemonPtr dmn,\n                      const char *serverName)\n{\n    void *ent;\n\n    virObjectLock(dmn);\n    ent = virHashLookup(dmn->servers, serverName);\n    virObjectUnlock(dmn);\n\n    return ent != NULL;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dmn"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "dmn->servers",
            "serverName"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dmn"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirNetDaemonHasServer(virNetDaemonPtr dmn,\n                      const char *serverName)\n{\n    void *ent;\n\n    virObjectLock(dmn);\n    ent = virHashLookup(dmn->servers, serverName);\n    virObjectUnlock(dmn);\n\n    return ent != NULL;\n}"
  },
  {
    "function_name": "virNetDaemonGetServer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "182-198",
    "snippet": "virNetServerPtr\nvirNetDaemonGetServer(virNetDaemonPtr dmn,\n                      const char *serverName)\n{\n    virNetServerPtr srv = NULL;\n\n    virObjectLock(dmn);\n    srv = virObjectRef(virHashLookup(dmn->servers, serverName));\n    virObjectUnlock(dmn);\n\n    if (!srv) {\n        virReportError(VIR_ERR_NO_SERVER,\n                       _(\"No server named '%s'\"), serverName);\n    }\n\n    return srv;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_SERVER",
            "_(\"No server named '%s'\")",
            "serverName"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"No server named '%s'\""
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dmn"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "virHashLookup(dmn->servers, serverName)"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "dmn->servers",
            "serverName"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dmn"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvirNetServerPtr\nvirNetDaemonGetServer(virNetDaemonPtr dmn,\n                      const char *serverName)\n{\n    virNetServerPtr srv = NULL;\n\n    virObjectLock(dmn);\n    srv = virObjectRef(virHashLookup(dmn->servers, serverName));\n    virObjectUnlock(dmn);\n\n    if (!srv) {\n        virReportError(VIR_ERR_NO_SERVER,\n                       _(\"No server named '%s'\"), serverName);\n    }\n\n    return srv;\n}"
  },
  {
    "function_name": "virNetDaemonAddServer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "161-179",
    "snippet": "int\nvirNetDaemonAddServer(virNetDaemonPtr dmn,\n                      virNetServerPtr srv)\n{\n    int ret = -1;\n    const char *serverName = virNetServerGetName(srv);\n\n    virObjectLock(dmn);\n\n    if (virHashAddEntry(dmn->servers, serverName, srv) < 0)\n        goto cleanup;\n\n    virObjectRef(srv);\n\n    ret = 0;\n cleanup:\n    virObjectUnlock(dmn);\n    return ret;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dmn"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "srv"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "dmn->servers",
            "serverName",
            "srv"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dmn"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerGetName",
          "args": [
            "srv"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerGetName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserver.c",
          "lines": "1013-1017",
          "snippet": "const char *\nvirNetServerGetName(virNetServerPtr srv)\n{\n    return srv->name;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);",
            "static inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetserver.h\"\n#include <config.h>\n\nstatic inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);\nstatic inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);\n\nconst char *\nvirNetServerGetName(virNetServerPtr srv)\n{\n    return srv->name;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetDaemonAddServer(virNetDaemonPtr dmn,\n                      virNetServerPtr srv)\n{\n    int ret = -1;\n    const char *serverName = virNetServerGetName(srv);\n\n    virObjectLock(dmn);\n\n    if (virHashAddEntry(dmn->servers, serverName, srv) < 0)\n        goto cleanup;\n\n    virObjectRef(srv);\n\n    ret = 0;\n cleanup:\n    virObjectUnlock(dmn);\n    return ret;\n}"
  },
  {
    "function_name": "virNetDaemonNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "120-158",
    "snippet": "virNetDaemonPtr\nvirNetDaemonNew(void)\n{\n    virNetDaemonPtr dmn;\n#ifndef WIN32\n    struct sigaction sig_action;\n#endif /* !WIN32 */\n\n    if (virNetDaemonInitialize() < 0)\n        return NULL;\n\n    if (!(dmn = virObjectLockableNew(virNetDaemonClass)))\n        return NULL;\n\n    if (!(dmn->servers = virHashCreate(5, virObjectFreeHashData)))\n        goto error;\n\n#ifndef WIN32\n    dmn->sigwrite = dmn->sigread = -1;\n#endif /* !WIN32 */\n\n    dmn->privileged = geteuid() == 0;\n    dmn->autoShutdownInhibitFd = -1;\n\n    if (virEventRegisterDefaultImpl() < 0)\n        goto error;\n\n#ifndef WIN32\n    memset(&sig_action, 0, sizeof(sig_action));\n    sig_action.sa_handler = SIG_IGN;\n    sigaction(SIGPIPE, &sig_action, NULL);\n#endif /* !WIN32 */\n\n    return dmn;\n\n error:\n    virObjectUnref(dmn);\n    return NULL;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virNetDaemonClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "dmn"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sigaction",
          "args": [
            "SIGPIPE",
            "&sig_action",
            "NULL"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&sig_action",
            "0",
            "sizeof(sig_action)"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virEventRegisterDefaultImpl",
          "args": [],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "virEventRegisterDefaultImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virevent.c",
          "lines": "304-315",
          "snippet": "int virEventRegisterDefaultImpl(void)\n{\n    VIR_DEBUG(\"registering default event implementation\");\n\n    virInitialize();\n\n    virResetLastError();\n\n    virEventGLibRegister();\n\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vireventglib.h\"",
            "#include \"virevent.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vireventglib.h\"\n#include \"virevent.h\"\n#include <config.h>\n\nint virEventRegisterDefaultImpl(void)\n{\n    VIR_DEBUG(\"registering default event implementation\");\n\n    virInitialize();\n\n    virResetLastError();\n\n    virEventGLibRegister();\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "geteuid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "68-69",
          "snippet": "static inline int geteuid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int geteuid(void)\n{ return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "5",
            "virObjectFreeHashData"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virNetDaemonClass"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDaemonInitialize",
          "args": [],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virClassPtr virNetDaemonClass;\n\nvirNetDaemonPtr\nvirNetDaemonNew(void)\n{\n    virNetDaemonPtr dmn;\n#ifndef WIN32\n    struct sigaction sig_action;\n#endif /* !WIN32 */\n\n    if (virNetDaemonInitialize() < 0)\n        return NULL;\n\n    if (!(dmn = virObjectLockableNew(virNetDaemonClass)))\n        return NULL;\n\n    if (!(dmn->servers = virHashCreate(5, virObjectFreeHashData)))\n        goto error;\n\n#ifndef WIN32\n    dmn->sigwrite = dmn->sigread = -1;\n#endif /* !WIN32 */\n\n    dmn->privileged = geteuid() == 0;\n    dmn->autoShutdownInhibitFd = -1;\n\n    if (virEventRegisterDefaultImpl() < 0)\n        goto error;\n\n#ifndef WIN32\n    memset(&sig_action, 0, sizeof(sig_action));\n    sig_action.sa_handler = SIG_IGN;\n    sigaction(SIGPIPE, &sig_action, NULL);\n#endif /* !WIN32 */\n\n    return dmn;\n\n error:\n    virObjectUnref(dmn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetDaemonOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "108-115",
    "snippet": "static int\nvirNetDaemonOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNetDaemon, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virNetDaemon",
            "virClassForObjectLockable()"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirNetDaemonOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNetDaemon, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDaemonDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
    "lines": "83-106",
    "snippet": "static void\nvirNetDaemonDispose(void *obj)\n{\n    virNetDaemonPtr dmn = obj;\n#ifndef WIN32\n    size_t i;\n\n    for (i = 0; i < dmn->nsignals; i++) {\n        sigaction(dmn->signals[i]->signum, &dmn->signals[i]->oldaction, NULL);\n        VIR_FREE(dmn->signals[i]);\n    }\n    VIR_FREE(dmn->signals);\n    VIR_FORCE_CLOSE(dmn->sigread);\n    VIR_FORCE_CLOSE(dmn->sigwrite);\n    if (dmn->sigwatch > 0)\n        virEventRemoveHandle(dmn->sigwatch);\n#endif /* !WIN32 */\n\n    VIR_FORCE_CLOSE(dmn->autoShutdownInhibitFd);\n\n    virHashFree(dmn->servers);\n\n    virJSONValueFree(dmn->srvObject);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhash.h\"",
      "#include \"virdbus.h\"",
      "#include \"virnetserver.h\"",
      "#include \"virfile.h\"",
      "#include \"virutil.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetdaemon.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "dmn->srvObject"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "dmn->servers"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "dmn->autoShutdownInhibitFd"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virEventRemoveHandle",
          "args": [
            "dmn->sigwatch"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "virEventRemoveHandle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virevent.c",
          "lines": "116-123",
          "snippet": "int\nvirEventRemoveHandle(int watch)\n{\n    if (!removeHandleImpl)\n        return -1;\n\n    return removeHandleImpl(watch);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vireventglib.h\"",
            "#include \"virevent.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virEventRemoveHandleFunc removeHandleImpl;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vireventglib.h\"\n#include \"virevent.h\"\n#include <config.h>\n\nstatic virEventRemoveHandleFunc removeHandleImpl;\n\nint\nvirEventRemoveHandle(int watch)\n{\n    if (!removeHandleImpl)\n        return -1;\n\n    return removeHandleImpl(watch);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "dmn->sigwrite"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "dmn->sigread"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dmn->signals"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dmn->signals[i]"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigaction",
          "args": [
            "dmn->signals[i]->signum",
            "&dmn->signals[i]->oldaction",
            "NULL"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirNetDaemonDispose(void *obj)\n{\n    virNetDaemonPtr dmn = obj;\n#ifndef WIN32\n    size_t i;\n\n    for (i = 0; i < dmn->nsignals; i++) {\n        sigaction(dmn->signals[i]->signum, &dmn->signals[i]->oldaction, NULL);\n        VIR_FREE(dmn->signals[i]);\n    }\n    VIR_FREE(dmn->signals);\n    VIR_FORCE_CLOSE(dmn->sigread);\n    VIR_FORCE_CLOSE(dmn->sigwrite);\n    if (dmn->sigwatch > 0)\n        virEventRemoveHandle(dmn->sigwatch);\n#endif /* !WIN32 */\n\n    VIR_FORCE_CLOSE(dmn->autoShutdownInhibitFd);\n\n    virHashFree(dmn->servers);\n\n    virJSONValueFree(dmn->srvObject);\n}"
  }
]