[
  {
    "function_name": "virConfLoadConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "1517-1542",
    "snippet": "int\nvirConfLoadConfig(virConfPtr *conf, const char *name)\n{\n    char *path = NULL;\n    int ret = -1;\n\n    *conf = NULL;\n\n    if (!(path = virConfLoadConfigPath(name)))\n        goto cleanup;\n\n    if (!virFileExists(path)) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"Loading config file '%s'\", path);\n    if (!(*conf = virConfReadFile(path, 0)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(path);\n    return ret;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "path"
          ],
          "line": 1540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfReadFile",
          "args": [
            "path",
            "0"
          ],
          "line": 1534
        },
        "resolved": true,
        "details": {
          "function_name": "virConfReadFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "730-752",
          "snippet": "virConfPtr\nvirConfReadFile(const char *filename, unsigned int flags)\n{\n    char *content;\n    int len;\n    virConfPtr conf;\n\n    VIR_DEBUG(\"filename=%s\", NULLSTR(filename));\n\n    if (filename == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    if ((len = virFileReadAll(filename, MAX_CONFIG_FILE_SIZE, &content)) < 0)\n        return NULL;\n\n    conf = virConfParse(filename, content, len, flags);\n\n    VIR_FREE(content);\n\n    return conf;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_CONFIG_FILE_SIZE (1024*1024*10)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define MAX_CONFIG_FILE_SIZE (1024*1024*10)\n\nvirConfPtr\nvirConfReadFile(const char *filename, unsigned int flags)\n{\n    char *content;\n    int len;\n    virConfPtr conf;\n\n    VIR_DEBUG(\"filename=%s\", NULLSTR(filename));\n\n    if (filename == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    if ((len = virFileReadAll(filename, MAX_CONFIG_FILE_SIZE, &content)) < 0)\n        return NULL;\n\n    conf = virConfParse(filename, content, len, flags);\n\n    VIR_FREE(content);\n\n    return conf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Loading config file '%s'\"",
            "path"
          ],
          "line": 1533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 1528
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfLoadConfigPath",
          "args": [
            "name"
          ],
          "line": 1525
        },
        "resolved": true,
        "details": {
          "function_name": "virConfLoadConfigPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1502-1515",
          "snippet": "static char *\nvirConfLoadConfigPath(const char *name)\n{\n    char *path;\n    if (geteuid() == 0) {\n        path = g_strdup_printf(\"%s/libvirt/%s\", SYSCONFDIR, name);\n    } else {\n        g_autofree char *userdir = virGetUserConfigDirectory();\n\n        path = g_strdup_printf(\"%s/%s\", userdir, name);\n    }\n\n    return path;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *\nvirConfLoadConfigPath(const char *name)\n{\n    char *path;\n    if (geteuid() == 0) {\n        path = g_strdup_printf(\"%s/libvirt/%s\", SYSCONFDIR, name);\n    } else {\n        g_autofree char *userdir = virGetUserConfigDirectory();\n\n        path = g_strdup_printf(\"%s/%s\", userdir, name);\n    }\n\n    return path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirConfLoadConfig(virConfPtr *conf, const char *name)\n{\n    char *path = NULL;\n    int ret = -1;\n\n    *conf = NULL;\n\n    if (!(path = virConfLoadConfigPath(name)))\n        goto cleanup;\n\n    if (!virFileExists(path)) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"Loading config file '%s'\", path);\n    if (!(*conf = virConfReadFile(path, 0)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(path);\n    return ret;\n}"
  },
  {
    "function_name": "virConfLoadConfigPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "1502-1515",
    "snippet": "static char *\nvirConfLoadConfigPath(const char *name)\n{\n    char *path;\n    if (geteuid() == 0) {\n        path = g_strdup_printf(\"%s/libvirt/%s\", SYSCONFDIR, name);\n    } else {\n        g_autofree char *userdir = virGetUserConfigDirectory();\n\n        path = g_strdup_printf(\"%s/%s\", userdir, name);\n    }\n\n    return path;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s\"",
            "userdir",
            "name"
          ],
          "line": 1511
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUserConfigDirectory",
          "args": [],
          "line": 1509
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserConfigDirectory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "574-581",
          "snippet": "char *virGetUserConfigDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_config_dir());\n#else\n    return g_build_filename(g_get_user_config_dir(), \"libvirt\", NULL);\n#endif\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virGetUserConfigDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_config_dir());\n#else\n    return g_build_filename(g_get_user_config_dir(), \"libvirt\", NULL);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 1506
        },
        "resolved": true,
        "details": {
          "function_name": "geteuid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "68-69",
          "snippet": "static inline int geteuid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int geteuid(void)\n{ return 0; }"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *\nvirConfLoadConfigPath(const char *name)\n{\n    char *path;\n    if (geteuid() == 0) {\n        path = g_strdup_printf(\"%s/libvirt/%s\", SYSCONFDIR, name);\n    } else {\n        g_autofree char *userdir = virGetUserConfigDirectory();\n\n        path = g_strdup_printf(\"%s/%s\", userdir, name);\n    }\n\n    return path;\n}"
  },
  {
    "function_name": "virConfWriteMem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "1471-1500",
    "snippet": "int\nvirConfWriteMem(char *memory, int *len, virConfPtr conf)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    virConfEntryPtr cur;\n    char *content;\n    unsigned int use;\n\n    if ((memory == NULL) || (len == NULL) || (*len <= 0) || (conf == NULL))\n        return -1;\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        virConfSaveEntry(&buf, cur);\n        cur = cur->next;\n    }\n\n    use = virBufferUse(&buf);\n    content = virBufferContentAndReset(&buf);\n\n    if ((int)use >= *len) {\n        *len = (int)use;\n        VIR_FREE(content);\n        return -1;\n    }\n    memcpy(memory, content, use);\n    VIR_FREE(content);\n    *len = use;\n    return use;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "content"
          ],
          "line": 1497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "memory",
            "content",
            "use"
          ],
          "line": 1496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "content"
          ],
          "line": 1493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 1489
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferUse",
          "args": [
            "&buf"
          ],
          "line": 1488
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferUse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "285-292",
          "snippet": "size_t\nvirBufferUse(const virBuffer *buf)\n{\n    if (!buf || !buf->str)\n        return 0;\n\n    return buf->str->len;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nsize_t\nvirBufferUse(const virBuffer *buf)\n{\n    if (!buf || !buf->str)\n        return 0;\n\n    return buf->str->len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfSaveEntry",
          "args": [
            "&buf",
            "cur"
          ],
          "line": 1484
        },
        "resolved": true,
        "details": {
          "function_name": "virConfSaveEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "311-328",
          "snippet": "static int\nvirConfSaveEntry(virBufferPtr buf, virConfEntryPtr cur)\n{\n    if (cur->name != NULL) {\n        virBufferAdd(buf, cur->name, -1);\n        virBufferAddLit(buf, \" = \");\n        virConfSaveValue(buf, cur->value);\n        if (cur->comment != NULL) {\n            virBufferAddLit(buf, \" #\");\n            virBufferAdd(buf, cur->comment, -1);\n        }\n    } else if (cur->comment != NULL) {\n        virBufferAddLit(buf, \"#\");\n        virBufferAdd(buf, cur->comment, -1);\n    }\n    virBufferAddLit(buf, \"\\n\");\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirConfSaveEntry(virBufferPtr buf, virConfEntryPtr cur)\n{\n    if (cur->name != NULL) {\n        virBufferAdd(buf, cur->name, -1);\n        virBufferAddLit(buf, \" = \");\n        virConfSaveValue(buf, cur->value);\n        if (cur->comment != NULL) {\n            virBufferAddLit(buf, \" #\");\n            virBufferAdd(buf, cur->comment, -1);\n        }\n    } else if (cur->comment != NULL) {\n        virBufferAddLit(buf, \"#\");\n        virBufferAdd(buf, cur->comment, -1);\n    }\n    virBufferAddLit(buf, \"\\n\");\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirConfWriteMem(char *memory, int *len, virConfPtr conf)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    virConfEntryPtr cur;\n    char *content;\n    unsigned int use;\n\n    if ((memory == NULL) || (len == NULL) || (*len <= 0) || (conf == NULL))\n        return -1;\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        virConfSaveEntry(&buf, cur);\n        cur = cur->next;\n    }\n\n    use = virBufferUse(&buf);\n    content = virBufferContentAndReset(&buf);\n\n    if ((int)use >= *len) {\n        *len = (int)use;\n        VIR_FREE(content);\n        return -1;\n    }\n    memcpy(memory, content, use);\n    VIR_FREE(content);\n    *len = use;\n    return use;\n}"
  },
  {
    "function_name": "virConfWriteFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "1419-1456",
    "snippet": "int\nvirConfWriteFile(const char *filename, virConfPtr conf)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    virConfEntryPtr cur;\n    int ret;\n    int fd;\n    char *content;\n    unsigned int use;\n\n    if (conf == NULL)\n        return -1;\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        virConfSaveEntry(&buf, cur);\n        cur = cur->next;\n    }\n\n    fd = open(filename, O_WRONLY | O_CREAT | O_TRUNC, S_IRUSR | S_IWUSR);\n    if (fd < 0) {\n        virBufferFreeAndReset(&buf);\n        virConfError(NULL, VIR_ERR_WRITE_FAILED, _(\"failed to open file\"));\n        return -1;\n    }\n\n    use = virBufferUse(&buf);\n    content = virBufferContentAndReset(&buf);\n    ret = safewrite(fd, content, use);\n    VIR_FREE(content);\n    VIR_FORCE_CLOSE(fd);\n    if (ret != (int)use) {\n        virConfError(NULL, VIR_ERR_WRITE_FAILED, _(\"failed to save content\"));\n        return -1;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfError",
          "args": [
            "NULL",
            "VIR_ERR_WRITE_FAILED",
            "_(\"failed to save content\")"
          ],
          "line": 1451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to save content\""
          ],
          "line": 1451
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 1449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "content"
          ],
          "line": 1448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "safewrite",
          "args": [
            "fd",
            "content",
            "use"
          ],
          "line": 1447
        },
        "resolved": true,
        "details": {
          "function_name": "safewrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1093-1111",
          "snippet": "ssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 1446
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferUse",
          "args": [
            "&buf"
          ],
          "line": 1445
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferUse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "285-292",
          "snippet": "size_t\nvirBufferUse(const virBuffer *buf)\n{\n    if (!buf || !buf->str)\n        return 0;\n\n    return buf->str->len;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nsize_t\nvirBufferUse(const virBuffer *buf)\n{\n    if (!buf || !buf->str)\n        return 0;\n\n    return buf->str->len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfError",
          "args": [
            "NULL",
            "VIR_ERR_WRITE_FAILED",
            "_(\"failed to open file\")"
          ],
          "line": 1441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "&buf"
          ],
          "line": 1440
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "filename",
            "O_WRONLY | O_CREAT | O_TRUNC",
            "S_IRUSR | S_IWUSR"
          ],
          "line": 1438
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockReopenReadOnly",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "3308-3323",
          "snippet": "int\nqemuBlockReopenReadOnly(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (src->readonly)\n        return 0;\n\n    src->readonly = true;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = false;\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockReopenReadOnly(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (src->readonly)\n        return 0;\n\n    src->readonly = true;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = false;\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfSaveEntry",
          "args": [
            "&buf",
            "cur"
          ],
          "line": 1434
        },
        "resolved": true,
        "details": {
          "function_name": "virConfSaveEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "311-328",
          "snippet": "static int\nvirConfSaveEntry(virBufferPtr buf, virConfEntryPtr cur)\n{\n    if (cur->name != NULL) {\n        virBufferAdd(buf, cur->name, -1);\n        virBufferAddLit(buf, \" = \");\n        virConfSaveValue(buf, cur->value);\n        if (cur->comment != NULL) {\n            virBufferAddLit(buf, \" #\");\n            virBufferAdd(buf, cur->comment, -1);\n        }\n    } else if (cur->comment != NULL) {\n        virBufferAddLit(buf, \"#\");\n        virBufferAdd(buf, cur->comment, -1);\n    }\n    virBufferAddLit(buf, \"\\n\");\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirConfSaveEntry(virBufferPtr buf, virConfEntryPtr cur)\n{\n    if (cur->name != NULL) {\n        virBufferAdd(buf, cur->name, -1);\n        virBufferAddLit(buf, \" = \");\n        virConfSaveValue(buf, cur->value);\n        if (cur->comment != NULL) {\n            virBufferAddLit(buf, \" #\");\n            virBufferAdd(buf, cur->comment, -1);\n        }\n    } else if (cur->comment != NULL) {\n        virBufferAddLit(buf, \"#\");\n        virBufferAdd(buf, cur->comment, -1);\n    }\n    virBufferAddLit(buf, \"\\n\");\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirConfWriteFile(const char *filename, virConfPtr conf)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    virConfEntryPtr cur;\n    int ret;\n    int fd;\n    char *content;\n    unsigned int use;\n\n    if (conf == NULL)\n        return -1;\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        virConfSaveEntry(&buf, cur);\n        cur = cur->next;\n    }\n\n    fd = open(filename, O_WRONLY | O_CREAT | O_TRUNC, S_IRUSR | S_IWUSR);\n    if (fd < 0) {\n        virBufferFreeAndReset(&buf);\n        virConfError(NULL, VIR_ERR_WRITE_FAILED, _(\"failed to open file\"));\n        return -1;\n    }\n\n    use = virBufferUse(&buf);\n    content = virBufferContentAndReset(&buf);\n    ret = safewrite(fd, content, use);\n    VIR_FREE(content);\n    VIR_FORCE_CLOSE(fd);\n    if (ret != (int)use) {\n        virConfError(NULL, VIR_ERR_WRITE_FAILED, _(\"failed to save content\"));\n        return -1;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virConfWalk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "1391-1408",
    "snippet": "int virConfWalk(virConfPtr conf,\n                virConfWalkCallback callback,\n                void *opaque)\n{\n    virConfEntryPtr cur;\n\n    if (!conf)\n        return 0;\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        if (cur->name && cur->value &&\n            callback(cur->name, cur->value, opaque) < 0)\n            return -1;\n        cur = cur->next;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "callback",
          "args": [
            "cur->name",
            "cur->value",
            "opaque"
          ],
          "line": 1403
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfWalk(virConfPtr conf,\n                virConfWalkCallback callback,\n                void *opaque)\n{\n    virConfEntryPtr cur;\n\n    if (!conf)\n        return 0;\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        if (cur->name && cur->value &&\n            callback(cur->name, cur->value, opaque) < 0)\n            return -1;\n        cur = cur->next;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virConfSetValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "1338-1378",
    "snippet": "int\nvirConfSetValue(virConfPtr conf,\n                const char *setting,\n                virConfValuePtr value)\n{\n    virConfEntryPtr cur, prev = NULL;\n\n    if (value && value->type == VIR_CONF_STRING && value->str == NULL) {\n        virConfFreeValue(value);\n        return -1;\n    }\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        if (STREQ_NULLABLE(cur->name, setting))\n            break;\n        prev = cur;\n        cur = cur->next;\n    }\n\n    if (!cur) {\n        if (VIR_ALLOC(cur) < 0) {\n            virConfFreeValue(value);\n            return -1;\n        }\n        cur->comment = NULL;\n        cur->name = g_strdup(setting);\n        cur->value = value;\n        if (prev) {\n            cur->next = prev->next;\n            prev->next = cur;\n        } else {\n            cur->next = conf->entries;\n            conf->entries = cur;\n        }\n    } else {\n        virConfFreeValue(cur->value);\n        cur->value = value;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfFreeValue",
          "args": [
            "cur->value"
          ],
          "line": 1374
        },
        "resolved": true,
        "details": {
          "function_name": "virConfFreeValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "147-159",
          "snippet": "void\nvirConfFreeValue(virConfValuePtr val)\n{\n    if (val == NULL)\n        return;\n    if (val->type == VIR_CONF_STRING &&\n        val->str != NULL)\n        VIR_FREE(val->str);\n    if (val->type == VIR_CONF_LIST &&\n        val->list != NULL)\n        virConfFreeList(val->list);\n    VIR_FREE(val);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirConfFreeValue(virConfValuePtr val)\n{\n    if (val == NULL)\n        return;\n    if (val->type == VIR_CONF_STRING &&\n        val->str != NULL)\n        VIR_FREE(val->str);\n    if (val->type == VIR_CONF_LIST &&\n        val->list != NULL)\n        virConfFreeList(val->list);\n    VIR_FREE(val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "setting"
          ],
          "line": 1364
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "cur"
          ],
          "line": 1359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "cur->name",
            "setting"
          ],
          "line": 1352
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirConfSetValue(virConfPtr conf,\n                const char *setting,\n                virConfValuePtr value)\n{\n    virConfEntryPtr cur, prev = NULL;\n\n    if (value && value->type == VIR_CONF_STRING && value->str == NULL) {\n        virConfFreeValue(value);\n        return -1;\n    }\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        if (STREQ_NULLABLE(cur->name, setting))\n            break;\n        prev = cur;\n        cur = cur->next;\n    }\n\n    if (!cur) {\n        if (VIR_ALLOC(cur) < 0) {\n            virConfFreeValue(value);\n            return -1;\n        }\n        cur->comment = NULL;\n        cur->name = g_strdup(setting);\n        cur->value = value;\n        if (prev) {\n            cur->next = prev->next;\n            prev->next = cur;\n        } else {\n            cur->next = conf->entries;\n            conf->entries = cur;\n        }\n    } else {\n        virConfFreeValue(cur->value);\n        cur->value = value;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virConfGetValueULLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "1301-1323",
    "snippet": "int virConfGetValueULLong(virConfPtr conf,\n                          const char *setting,\n                          unsigned long long *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value unsigned long long %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = (unsigned long long)cval->l;\n\n    return 1;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: expected an unsigned integer for '%s' parameter\")",
            "conf->filename",
            "setting"
          ],
          "line": 1314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"%s: expected an unsigned integer for '%s' parameter\""
          ],
          "line": 1315
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Get value unsigned long long %p %d\"",
            "cval",
            "cval ? cval->type : VIR_CONF_NONE"
          ],
          "line": 1307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValue",
          "args": [
            "conf",
            "setting"
          ],
          "line": 1305
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "849-857",
          "snippet": "virConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueULLong(virConfPtr conf,\n                          const char *setting,\n                          unsigned long long *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value unsigned long long %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = (unsigned long long)cval->l;\n\n    return 1;\n}"
  },
  {
    "function_name": "virConfGetValueLLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "1254-1283",
    "snippet": "int virConfGetValueLLong(virConfPtr conf,\n                         const char *setting,\n                         long long *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value long long %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type == VIR_CONF_ULLONG) {\n        if (((unsigned long long)cval->l) > LLONG_MAX) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: value for '%s' parameter must be in range %lld:%lld\"),\n                           conf->filename, setting, LLONG_MIN, LLONG_MAX);\n            return -1;\n        }\n    } else if (cval->type != VIR_CONF_LLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a signed integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l;\n\n    return 1;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: expected a signed integer for '%s' parameter\")",
            "conf->filename",
            "setting"
          ],
          "line": 1274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"%s: expected a signed integer for '%s' parameter\""
          ],
          "line": 1275
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: value for '%s' parameter must be in range %lld:%lld\")",
            "conf->filename",
            "setting",
            "LLONG_MIN",
            "LLONG_MAX"
          ],
          "line": 1268
        },
        "resolved": true,
        "details": {
          "function_name": "virReportErrorHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1282-1308",
          "snippet": "void virReportErrorHelper(int domcode,\n                          int errorcode,\n                          const char *filename,\n                          const char *funcname,\n                          size_t linenr,\n                          const char *fmt, ...)\n{\n    int save_errno = errno;\n    va_list args;\n    char errorMessage[VIR_ERROR_MAX_LENGTH];\n    const char *virerr;\n\n    if (fmt) {\n        va_start(args, fmt);\n        g_vsnprintf(errorMessage, sizeof(errorMessage)-1, fmt, args);\n        va_end(args);\n    } else {\n        errorMessage[0] = '\\0';\n    }\n\n    virerr = virErrorMsg(errorcode, (errorMessage[0] ? errorMessage : NULL));\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, errorcode, VIR_ERR_ERROR,\n                      virerr, errorMessage, NULL,\n                      -1, -1, virerr, errorMessage);\n    errno = save_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virReportErrorHelper(int domcode,\n                          int errorcode,\n                          const char *filename,\n                          const char *funcname,\n                          size_t linenr,\n                          const char *fmt, ...)\n{\n    int save_errno = errno;\n    va_list args;\n    char errorMessage[VIR_ERROR_MAX_LENGTH];\n    const char *virerr;\n\n    if (fmt) {\n        va_start(args, fmt);\n        g_vsnprintf(errorMessage, sizeof(errorMessage)-1, fmt, args);\n        va_end(args);\n    } else {\n        errorMessage[0] = '\\0';\n    }\n\n    virerr = virErrorMsg(errorcode, (errorMessage[0] ? errorMessage : NULL));\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, errorcode, VIR_ERR_ERROR,\n                      virerr, errorMessage, NULL,\n                      -1, -1, virerr, errorMessage);\n    errno = save_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Get value long long %p %d\"",
            "cval",
            "cval ? cval->type : VIR_CONF_NONE"
          ],
          "line": 1260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValue",
          "args": [
            "conf",
            "setting"
          ],
          "line": 1258
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "849-857",
          "snippet": "virConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueLLong(virConfPtr conf,\n                         const char *setting,\n                         long long *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value long long %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type == VIR_CONF_ULLONG) {\n        if (((unsigned long long)cval->l) > LLONG_MAX) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: value for '%s' parameter must be in range %lld:%lld\"),\n                           conf->filename, setting, LLONG_MIN, LLONG_MAX);\n            return -1;\n        }\n    } else if (cval->type != VIR_CONF_LLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a signed integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l;\n\n    return 1;\n}"
  },
  {
    "function_name": "virConfGetValueSSizeT",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "1197-1235",
    "snippet": "int virConfGetValueSSizeT(virConfPtr conf,\n                          const char *setting,\n                          ssize_t *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value ssize_t %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type == VIR_CONF_ULLONG) {\n        if (((unsigned long long)cval->l) > SSIZE_MAX) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: value for '%s' parameter must be in range %zd:%zd\"),\n                           conf->filename, setting, (ssize_t)-SSIZE_MAX - 1, (ssize_t)SSIZE_MAX);\n            return -1;\n        }\n    } else if (cval->type == VIR_CONF_LLONG) {\n#if SSIZE_MAX < LLONG_MAX\n        if (cval->l < (-SSIZE_MAX - 1) || cval->l > SSIZE_MAX) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: value for '%s' parameter must be in range %zd:%zd\"),\n                           conf->filename, setting, (ssize_t)-SSIZE_MAX - 1, (ssize_t)SSIZE_MAX);\n            return -1;\n        }\n#endif\n    } else {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a signed integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = (ssize_t)cval->l;\n\n    return 1;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: expected a signed integer for '%s' parameter\")",
            "conf->filename",
            "setting"
          ],
          "line": 1226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"%s: expected a signed integer for '%s' parameter\""
          ],
          "line": 1227
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: value for '%s' parameter must be in range %zd:%zd\")",
            "conf->filename",
            "setting",
            "(ssize_t)-SSIZE_MAX - 1",
            "(ssize_t)SSIZE_MAX"
          ],
          "line": 1219
        },
        "resolved": true,
        "details": {
          "function_name": "virReportErrorHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1282-1308",
          "snippet": "void virReportErrorHelper(int domcode,\n                          int errorcode,\n                          const char *filename,\n                          const char *funcname,\n                          size_t linenr,\n                          const char *fmt, ...)\n{\n    int save_errno = errno;\n    va_list args;\n    char errorMessage[VIR_ERROR_MAX_LENGTH];\n    const char *virerr;\n\n    if (fmt) {\n        va_start(args, fmt);\n        g_vsnprintf(errorMessage, sizeof(errorMessage)-1, fmt, args);\n        va_end(args);\n    } else {\n        errorMessage[0] = '\\0';\n    }\n\n    virerr = virErrorMsg(errorcode, (errorMessage[0] ? errorMessage : NULL));\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, errorcode, VIR_ERR_ERROR,\n                      virerr, errorMessage, NULL,\n                      -1, -1, virerr, errorMessage);\n    errno = save_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virReportErrorHelper(int domcode,\n                          int errorcode,\n                          const char *filename,\n                          const char *funcname,\n                          size_t linenr,\n                          const char *fmt, ...)\n{\n    int save_errno = errno;\n    va_list args;\n    char errorMessage[VIR_ERROR_MAX_LENGTH];\n    const char *virerr;\n\n    if (fmt) {\n        va_start(args, fmt);\n        g_vsnprintf(errorMessage, sizeof(errorMessage)-1, fmt, args);\n        va_end(args);\n    } else {\n        errorMessage[0] = '\\0';\n    }\n\n    virerr = virErrorMsg(errorcode, (errorMessage[0] ? errorMessage : NULL));\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, errorcode, VIR_ERR_ERROR,\n                      virerr, errorMessage, NULL,\n                      -1, -1, virerr, errorMessage);\n    errno = save_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Get value ssize_t %p %d\"",
            "cval",
            "cval ? cval->type : VIR_CONF_NONE"
          ],
          "line": 1203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValue",
          "args": [
            "conf",
            "setting"
          ],
          "line": 1201
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "849-857",
          "snippet": "virConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueSSizeT(virConfPtr conf,\n                          const char *setting,\n                          ssize_t *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value ssize_t %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type == VIR_CONF_ULLONG) {\n        if (((unsigned long long)cval->l) > SSIZE_MAX) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: value for '%s' parameter must be in range %zd:%zd\"),\n                           conf->filename, setting, (ssize_t)-SSIZE_MAX - 1, (ssize_t)SSIZE_MAX);\n            return -1;\n        }\n    } else if (cval->type == VIR_CONF_LLONG) {\n#if SSIZE_MAX < LLONG_MAX\n        if (cval->l < (-SSIZE_MAX - 1) || cval->l > SSIZE_MAX) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: value for '%s' parameter must be in range %zd:%zd\"),\n                           conf->filename, setting, (ssize_t)-SSIZE_MAX - 1, (ssize_t)SSIZE_MAX);\n            return -1;\n        }\n#endif\n    } else {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a signed integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = (ssize_t)cval->l;\n\n    return 1;\n}"
  },
  {
    "function_name": "virConfGetValueSizeT",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "1147-1178",
    "snippet": "int virConfGetValueSizeT(virConfPtr conf,\n                         const char *setting,\n                         size_t *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value size_t %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n#if ULLONG_MAX > SIZE_MAX\n    if (((unsigned long long)cval->l) > SIZE_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%zu\"),\n                       conf->filename, setting, SIZE_MAX);\n        return -1;\n    }\n#endif\n\n    *value = (size_t)cval->l;\n\n    return 1;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: value for '%s' parameter must be in range 0:%zu\")",
            "conf->filename",
            "setting",
            "SIZE_MAX"
          ],
          "line": 1168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"%s: value for '%s' parameter must be in range 0:%zu\""
          ],
          "line": 1169
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: expected an unsigned integer for '%s' parameter\")",
            "conf->filename",
            "setting"
          ],
          "line": 1160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Get value size_t %p %d\"",
            "cval",
            "cval ? cval->type : VIR_CONF_NONE"
          ],
          "line": 1153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValue",
          "args": [
            "conf",
            "setting"
          ],
          "line": 1151
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "849-857",
          "snippet": "virConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueSizeT(virConfPtr conf,\n                         const char *setting,\n                         size_t *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value size_t %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n#if ULLONG_MAX > SIZE_MAX\n    if (((unsigned long long)cval->l) > SIZE_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%zu\"),\n                       conf->filename, setting, SIZE_MAX);\n        return -1;\n    }\n#endif\n\n    *value = (size_t)cval->l;\n\n    return 1;\n}"
  },
  {
    "function_name": "virConfGetValueUInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "1099-1128",
    "snippet": "int virConfGetValueUInt(virConfPtr conf,\n                        const char *setting,\n                        unsigned int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value uint %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > UINT_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%u\"),\n                       conf->filename, setting, UINT_MAX);\n        return -1;\n    }\n\n    *value = (unsigned int)cval->l;\n\n    return 1;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: value for '%s' parameter must be in range 0:%u\")",
            "conf->filename",
            "setting",
            "UINT_MAX"
          ],
          "line": 1119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"%s: value for '%s' parameter must be in range 0:%u\""
          ],
          "line": 1120
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: expected an unsigned integer for '%s' parameter\")",
            "conf->filename",
            "setting"
          ],
          "line": 1112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Get value uint %p %d\"",
            "cval",
            "cval ? cval->type : VIR_CONF_NONE"
          ],
          "line": 1105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValue",
          "args": [
            "conf",
            "setting"
          ],
          "line": 1103
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "849-857",
          "snippet": "virConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueUInt(virConfPtr conf,\n                        const char *setting,\n                        unsigned int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value uint %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > UINT_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%u\"),\n                       conf->filename, setting, UINT_MAX);\n        return -1;\n    }\n\n    *value = (unsigned int)cval->l;\n\n    return 1;\n}"
  },
  {
    "function_name": "virConfGetValueInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "1050-1080",
    "snippet": "int virConfGetValueInt(virConfPtr conf,\n                       const char *setting,\n                       int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value int %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_LLONG &&\n        cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a signed integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (cval->l > INT_MAX || cval->l < INT_MIN) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range %d:%d\"),\n                       conf->filename, setting, INT_MIN, INT_MAX);\n        return -1;\n    }\n\n    *value = (int)cval->l;\n\n    return 1;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: value for '%s' parameter must be in range %d:%d\")",
            "conf->filename",
            "setting",
            "INT_MIN",
            "INT_MAX"
          ],
          "line": 1071
        },
        "resolved": true,
        "details": {
          "function_name": "virReportErrorHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1282-1308",
          "snippet": "void virReportErrorHelper(int domcode,\n                          int errorcode,\n                          const char *filename,\n                          const char *funcname,\n                          size_t linenr,\n                          const char *fmt, ...)\n{\n    int save_errno = errno;\n    va_list args;\n    char errorMessage[VIR_ERROR_MAX_LENGTH];\n    const char *virerr;\n\n    if (fmt) {\n        va_start(args, fmt);\n        g_vsnprintf(errorMessage, sizeof(errorMessage)-1, fmt, args);\n        va_end(args);\n    } else {\n        errorMessage[0] = '\\0';\n    }\n\n    virerr = virErrorMsg(errorcode, (errorMessage[0] ? errorMessage : NULL));\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, errorcode, VIR_ERR_ERROR,\n                      virerr, errorMessage, NULL,\n                      -1, -1, virerr, errorMessage);\n    errno = save_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virReportErrorHelper(int domcode,\n                          int errorcode,\n                          const char *filename,\n                          const char *funcname,\n                          size_t linenr,\n                          const char *fmt, ...)\n{\n    int save_errno = errno;\n    va_list args;\n    char errorMessage[VIR_ERROR_MAX_LENGTH];\n    const char *virerr;\n\n    if (fmt) {\n        va_start(args, fmt);\n        g_vsnprintf(errorMessage, sizeof(errorMessage)-1, fmt, args);\n        va_end(args);\n    } else {\n        errorMessage[0] = '\\0';\n    }\n\n    virerr = virErrorMsg(errorcode, (errorMessage[0] ? errorMessage : NULL));\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, errorcode, VIR_ERR_ERROR,\n                      virerr, errorMessage, NULL,\n                      -1, -1, virerr, errorMessage);\n    errno = save_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"%s: value for '%s' parameter must be in range %d:%d\""
          ],
          "line": 1072
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: expected a signed integer for '%s' parameter\")",
            "conf->filename",
            "setting"
          ],
          "line": 1064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Get value int %p %d\"",
            "cval",
            "cval ? cval->type : VIR_CONF_NONE"
          ],
          "line": 1056
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValue",
          "args": [
            "conf",
            "setting"
          ],
          "line": 1054
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "849-857",
          "snippet": "virConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueInt(virConfPtr conf,\n                       const char *setting,\n                       int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value int %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_LLONG &&\n        cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a signed integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (cval->l > INT_MAX || cval->l < INT_MIN) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range %d:%d\"),\n                       conf->filename, setting, INT_MIN, INT_MAX);\n        return -1;\n    }\n\n    *value = (int)cval->l;\n\n    return 1;\n}"
  },
  {
    "function_name": "virConfGetValueBool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "1002-1031",
    "snippet": "int virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: value for '%s' parameter must be 0 or 1\")",
            "conf->filename",
            "setting"
          ],
          "line": 1022
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"%s: value for '%s' parameter must be 0 or 1\""
          ],
          "line": 1023
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: expected a bool for '%s' parameter\")",
            "conf->filename",
            "setting"
          ],
          "line": 1015
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Get value bool %p %d\"",
            "cval",
            "cval ? cval->type : VIR_CONF_NONE"
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValue",
          "args": [
            "conf",
            "setting"
          ],
          "line": 1006
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "849-857",
          "snippet": "virConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}"
  },
  {
    "function_name": "virConfGetValueStringList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "920-984",
    "snippet": "int virConfGetValueStringList(virConfPtr conf,\n                              const char *setting,\n                              bool compatString,\n                              char ***values)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    size_t len;\n    virConfValuePtr eval;\n\n    VIR_DEBUG(\"Get value string list %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    virStringListFree(*values);\n    *values = NULL;\n\n    switch (cval->type) {\n    case VIR_CONF_LIST:\n        /* Calc length and check items */\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next) {\n            if (eval->type != VIR_CONF_STRING) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"%s: expected a string list for '%s' parameter\"),\n                               conf->filename, setting);\n                return -1;\n            }\n        }\n\n        if (VIR_ALLOC_N(*values, len + 1) < 0)\n            return -1;\n\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next)\n            (*values)[len] = g_strdup(eval->str);\n        break;\n\n    case VIR_CONF_STRING:\n        if (compatString) {\n            if (VIR_ALLOC_N(*values, cval->str ? 2 : 1) < 0)\n                return -1;\n            if (cval->str)\n                (*values)[0] = g_strdup(cval->str);\n            break;\n        }\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_CONF_LLONG:\n    case VIR_CONF_ULLONG:\n    case VIR_CONF_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       compatString ?\n                       _(\"%s: expected a string or string list for '%s' parameter\") :\n                       _(\"%s: expected a string list for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n\n    case VIR_CONF_LAST:\n    default:\n        virReportEnumRangeError(virConfType, cval->type);\n        return -1;\n    }\n\n    return 1;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportEnumRangeError",
          "args": [
            "virConfType",
            "cval->type"
          ],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "compatString ?\n                       _(\"%s: expected a string or string list for '%s' parameter\") :\n                       _(\"%s: expected a string list for '%s' parameter\")",
            "conf->filename",
            "setting"
          ],
          "line": 970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"%s: expected a string list for '%s' parameter\""
          ],
          "line": 973
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "*values",
            "cval->str ? 2 : 1"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "*values",
            "len + 1"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONF_SYNTAX",
            "_(\"%s: expected a string list for '%s' parameter\")",
            "conf->filename",
            "setting"
          ],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "*values"
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Get value string list %p %d\"",
            "cval",
            "cval ? cval->type : VIR_CONF_NONE"
          ],
          "line": 929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValue",
          "args": [
            "conf",
            "setting"
          ],
          "line": 925
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "849-857",
          "snippet": "virConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueStringList(virConfPtr conf,\n                              const char *setting,\n                              bool compatString,\n                              char ***values)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    size_t len;\n    virConfValuePtr eval;\n\n    VIR_DEBUG(\"Get value string list %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    virStringListFree(*values);\n    *values = NULL;\n\n    switch (cval->type) {\n    case VIR_CONF_LIST:\n        /* Calc length and check items */\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next) {\n            if (eval->type != VIR_CONF_STRING) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"%s: expected a string list for '%s' parameter\"),\n                               conf->filename, setting);\n                return -1;\n            }\n        }\n\n        if (VIR_ALLOC_N(*values, len + 1) < 0)\n            return -1;\n\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next)\n            (*values)[len] = g_strdup(eval->str);\n        break;\n\n    case VIR_CONF_STRING:\n        if (compatString) {\n            if (VIR_ALLOC_N(*values, cval->str ? 2 : 1) < 0)\n                return -1;\n            if (cval->str)\n                (*values)[0] = g_strdup(cval->str);\n            break;\n        }\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_CONF_LLONG:\n    case VIR_CONF_ULLONG:\n    case VIR_CONF_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       compatString ?\n                       _(\"%s: expected a string or string list for '%s' parameter\") :\n                       _(\"%s: expected a string list for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n\n    case VIR_CONF_LAST:\n    default:\n        virReportEnumRangeError(virConfType, cval->type);\n        return -1;\n    }\n\n    return 1;\n}"
  },
  {
    "function_name": "virConfGetValueString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "875-898",
    "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "cval->str"
          ],
          "line": 895
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*value"
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: expected a string for '%s' parameter\")",
            "conf->filename",
            "setting"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Get value string %p %d\"",
            "cval",
            "cval ? cval->type : VIR_CONF_NONE"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValue",
          "args": [
            "conf",
            "setting"
          ],
          "line": 879
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "849-857",
          "snippet": "virConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
  },
  {
    "function_name": "virConfGetValueType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "849-857",
    "snippet": "virConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfGetValue",
          "args": [
            "conf",
            "setting"
          ],
          "line": 852
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "849-857",
          "snippet": "virConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}"
  },
  {
    "function_name": "virConfGetValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "819-837",
    "snippet": "virConfValuePtr\nvirConfGetValue(virConfPtr conf, const char *setting)\n{\n    virConfEntryPtr cur;\n\n    if (conf == NULL)\n        return NULL;\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        if ((cur->name != NULL) &&\n            ((conf->flags & VIR_CONF_FLAG_VMX_FORMAT &&\n              STRCASEEQ(cur->name, setting)) ||\n             STREQ(cur->name, setting)))\n            return cur->value;\n        cur = cur->next;\n    }\n    return NULL;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "cur->name",
            "setting"
          ],
          "line": 832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRCASEEQ",
          "args": [
            "cur->name",
            "setting"
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfValuePtr\nvirConfGetValue(virConfPtr conf, const char *setting)\n{\n    virConfEntryPtr cur;\n\n    if (conf == NULL)\n        return NULL;\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        if ((cur->name != NULL) &&\n            ((conf->flags & VIR_CONF_FLAG_VMX_FORMAT &&\n              STRCASEEQ(cur->name, setting)) ||\n             STREQ(cur->name, setting)))\n            return cur->value;\n        cur = cur->next;\n    }\n    return NULL;\n}"
  },
  {
    "function_name": "virConfFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "787-807",
    "snippet": "int\nvirConfFree(virConfPtr conf)\n{\n    virConfEntryPtr tmp;\n    if (conf == NULL)\n        return 0;\n\n    tmp = conf->entries;\n    while (tmp) {\n        virConfEntryPtr next;\n        VIR_FREE(tmp->name);\n        virConfFreeValue(tmp->value);\n        VIR_FREE(tmp->comment);\n        next = tmp->next;\n        VIR_FREE(tmp);\n        tmp = next;\n    }\n    VIR_FREE(conf->filename);\n    VIR_FREE(conf);\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "conf"
          ],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "conf->filename"
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp->comment"
          ],
          "line": 799
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfFreeValue",
          "args": [
            "tmp->value"
          ],
          "line": 798
        },
        "resolved": true,
        "details": {
          "function_name": "virConfFreeValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "147-159",
          "snippet": "void\nvirConfFreeValue(virConfValuePtr val)\n{\n    if (val == NULL)\n        return;\n    if (val->type == VIR_CONF_STRING &&\n        val->str != NULL)\n        VIR_FREE(val->str);\n    if (val->type == VIR_CONF_LIST &&\n        val->list != NULL)\n        virConfFreeList(val->list);\n    VIR_FREE(val);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirConfFreeValue(virConfValuePtr val)\n{\n    if (val == NULL)\n        return;\n    if (val->type == VIR_CONF_STRING &&\n        val->str != NULL)\n        VIR_FREE(val->str);\n    if (val->type == VIR_CONF_LIST &&\n        val->list != NULL)\n        virConfFreeList(val->list);\n    VIR_FREE(val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp->name"
          ],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirConfFree(virConfPtr conf)\n{\n    virConfEntryPtr tmp;\n    if (conf == NULL)\n        return 0;\n\n    tmp = conf->entries;\n    while (tmp) {\n        virConfEntryPtr next;\n        VIR_FREE(tmp->name);\n        virConfFreeValue(tmp->value);\n        VIR_FREE(tmp->comment);\n        next = tmp->next;\n        VIR_FREE(tmp);\n        tmp = next;\n    }\n    VIR_FREE(conf->filename);\n    VIR_FREE(conf);\n    return 0;\n}"
  },
  {
    "function_name": "virConfReadString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "765-777",
    "snippet": "virConfPtr\nvirConfReadString(const char *memory, unsigned int flags)\n{\n    size_t len;\n\n    if (memory == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    len = strlen(memory);\n    return virConfParse(\"memory conf\", memory, len, flags);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfParse",
          "args": [
            "\"memory conf\"",
            "memory",
            "len",
            "flags"
          ],
          "line": 776
        },
        "resolved": true,
        "details": {
          "function_name": "virConfParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "687-714",
          "snippet": "static virConfPtr\nvirConfParse(const char *filename, const char *content, int len,\n             unsigned int flags)\n{\n    virConfParserCtxt ctxt;\n\n    ctxt.filename = filename;\n    ctxt.base = ctxt.cur = content;\n    ctxt.end = content + len;\n    ctxt.line = 1;\n\n    ctxt.conf = virConfCreate(filename, flags);\n    if (ctxt.conf == NULL)\n        return NULL;\n\n    while (ctxt.cur < ctxt.end) {\n        if (virConfParseStatement(&ctxt) < 0)\n            goto error;\n        if (virConfParseSeparator(&ctxt) < 0)\n            goto error;\n    }\n\n    return ctxt.conf;\n\n error:\n    virConfFree(ctxt.conf);\n    return NULL;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virConfPtr\nvirConfParse(const char *filename, const char *content, int len,\n             unsigned int flags)\n{\n    virConfParserCtxt ctxt;\n\n    ctxt.filename = filename;\n    ctxt.base = ctxt.cur = content;\n    ctxt.end = content + len;\n    ctxt.line = 1;\n\n    ctxt.conf = virConfCreate(filename, flags);\n    if (ctxt.conf == NULL)\n        return NULL;\n\n    while (ctxt.cur < ctxt.end) {\n        if (virConfParseStatement(&ctxt) < 0)\n            goto error;\n        if (virConfParseSeparator(&ctxt) < 0)\n            goto error;\n    }\n\n    return ctxt.conf;\n\n error:\n    virConfFree(ctxt.conf);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "memory"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfError",
          "args": [
            "NULL",
            "VIR_ERR_INVALID_ARG",
            "__FUNCTION__"
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfPtr\nvirConfReadString(const char *memory, unsigned int flags)\n{\n    size_t len;\n\n    if (memory == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    len = strlen(memory);\n    return virConfParse(\"memory conf\", memory, len, flags);\n}"
  },
  {
    "function_name": "virConfReadFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "730-752",
    "snippet": "virConfPtr\nvirConfReadFile(const char *filename, unsigned int flags)\n{\n    char *content;\n    int len;\n    virConfPtr conf;\n\n    VIR_DEBUG(\"filename=%s\", NULLSTR(filename));\n\n    if (filename == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    if ((len = virFileReadAll(filename, MAX_CONFIG_FILE_SIZE, &content)) < 0)\n        return NULL;\n\n    conf = virConfParse(filename, content, len, flags);\n\n    VIR_FREE(content);\n\n    return conf;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define MAX_CONFIG_FILE_SIZE (1024*1024*10)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "content"
          ],
          "line": 749
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfParse",
          "args": [
            "filename",
            "content",
            "len",
            "flags"
          ],
          "line": 747
        },
        "resolved": true,
        "details": {
          "function_name": "virConfParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "687-714",
          "snippet": "static virConfPtr\nvirConfParse(const char *filename, const char *content, int len,\n             unsigned int flags)\n{\n    virConfParserCtxt ctxt;\n\n    ctxt.filename = filename;\n    ctxt.base = ctxt.cur = content;\n    ctxt.end = content + len;\n    ctxt.line = 1;\n\n    ctxt.conf = virConfCreate(filename, flags);\n    if (ctxt.conf == NULL)\n        return NULL;\n\n    while (ctxt.cur < ctxt.end) {\n        if (virConfParseStatement(&ctxt) < 0)\n            goto error;\n        if (virConfParseSeparator(&ctxt) < 0)\n            goto error;\n    }\n\n    return ctxt.conf;\n\n error:\n    virConfFree(ctxt.conf);\n    return NULL;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virConfPtr\nvirConfParse(const char *filename, const char *content, int len,\n             unsigned int flags)\n{\n    virConfParserCtxt ctxt;\n\n    ctxt.filename = filename;\n    ctxt.base = ctxt.cur = content;\n    ctxt.end = content + len;\n    ctxt.line = 1;\n\n    ctxt.conf = virConfCreate(filename, flags);\n    if (ctxt.conf == NULL)\n        return NULL;\n\n    while (ctxt.cur < ctxt.end) {\n        if (virConfParseStatement(&ctxt) < 0)\n            goto error;\n        if (virConfParseSeparator(&ctxt) < 0)\n            goto error;\n    }\n\n    return ctxt.conf;\n\n error:\n    virConfFree(ctxt.conf);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "filename",
            "MAX_CONFIG_FILE_SIZE",
            "&content"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfError",
          "args": [
            "NULL",
            "VIR_ERR_INVALID_ARG",
            "__FUNCTION__"
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"filename=%s\"",
            "NULLSTR(filename)"
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "filename"
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define MAX_CONFIG_FILE_SIZE (1024*1024*10)\n\nvirConfPtr\nvirConfReadFile(const char *filename, unsigned int flags)\n{\n    char *content;\n    int len;\n    virConfPtr conf;\n\n    VIR_DEBUG(\"filename=%s\", NULLSTR(filename));\n\n    if (filename == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    if ((len = virFileReadAll(filename, MAX_CONFIG_FILE_SIZE, &content)) < 0)\n        return NULL;\n\n    conf = virConfParse(filename, content, len, flags);\n\n    VIR_FREE(content);\n\n    return conf;\n}"
  },
  {
    "function_name": "virConfParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "687-714",
    "snippet": "static virConfPtr\nvirConfParse(const char *filename, const char *content, int len,\n             unsigned int flags)\n{\n    virConfParserCtxt ctxt;\n\n    ctxt.filename = filename;\n    ctxt.base = ctxt.cur = content;\n    ctxt.end = content + len;\n    ctxt.line = 1;\n\n    ctxt.conf = virConfCreate(filename, flags);\n    if (ctxt.conf == NULL)\n        return NULL;\n\n    while (ctxt.cur < ctxt.end) {\n        if (virConfParseStatement(&ctxt) < 0)\n            goto error;\n        if (virConfParseSeparator(&ctxt) < 0)\n            goto error;\n    }\n\n    return ctxt.conf;\n\n error:\n    virConfFree(ctxt.conf);\n    return NULL;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfFree",
          "args": [
            "ctxt.conf"
          ],
          "line": 712
        },
        "resolved": true,
        "details": {
          "function_name": "virConfFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "787-807",
          "snippet": "int\nvirConfFree(virConfPtr conf)\n{\n    virConfEntryPtr tmp;\n    if (conf == NULL)\n        return 0;\n\n    tmp = conf->entries;\n    while (tmp) {\n        virConfEntryPtr next;\n        VIR_FREE(tmp->name);\n        virConfFreeValue(tmp->value);\n        VIR_FREE(tmp->comment);\n        next = tmp->next;\n        VIR_FREE(tmp);\n        tmp = next;\n    }\n    VIR_FREE(conf->filename);\n    VIR_FREE(conf);\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirConfFree(virConfPtr conf)\n{\n    virConfEntryPtr tmp;\n    if (conf == NULL)\n        return 0;\n\n    tmp = conf->entries;\n    while (tmp) {\n        virConfEntryPtr next;\n        VIR_FREE(tmp->name);\n        virConfFreeValue(tmp->value);\n        VIR_FREE(tmp->comment);\n        next = tmp->next;\n        VIR_FREE(tmp);\n        tmp = next;\n    }\n    VIR_FREE(conf->filename);\n    VIR_FREE(conf);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfParseSeparator",
          "args": [
            "&ctxt"
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "virConfParseSeparator",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "605-621",
          "snippet": "static int\nvirConfParseSeparator(virConfParserCtxtPtr ctxt)\n{\n    SKIP_BLANKS;\n    if (ctxt->cur >= ctxt->end)\n        return 0;\n    if (IS_EOL(CUR)) {\n        SKIP_BLANKS_AND_EOL;\n    } else if (CUR == ';') {\n        NEXT;\n        SKIP_BLANKS_AND_EOL;\n    } else {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a separator\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SKIP_BLANKS \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR))) \\\n          ctxt->cur++; } while (0)",
            "#define SKIP_BLANKS_AND_EOL \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR) || IS_EOL(CUR))) { \\\n         if (CUR == '\\n') ctxt->line++; \\\n         ctxt->cur++; } } while (0)",
            "#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;",
            "#define CUR (*ctxt->cur)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define SKIP_BLANKS \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR))) \\\n          ctxt->cur++; } while (0)\n#define SKIP_BLANKS_AND_EOL \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR) || IS_EOL(CUR))) { \\\n         if (CUR == '\\n') ctxt->line++; \\\n         ctxt->cur++; } } while (0)\n#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;\n#define CUR (*ctxt->cur)\n\nstatic int\nvirConfParseSeparator(virConfParserCtxtPtr ctxt)\n{\n    SKIP_BLANKS;\n    if (ctxt->cur >= ctxt->end)\n        return 0;\n    if (IS_EOL(CUR)) {\n        SKIP_BLANKS_AND_EOL;\n    } else if (CUR == ';') {\n        NEXT;\n        SKIP_BLANKS_AND_EOL;\n    } else {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a separator\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfParseStatement",
          "args": [
            "&ctxt"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "virConfParseStatement",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "631-672",
          "snippet": "static int\nvirConfParseStatement(virConfParserCtxtPtr ctxt)\n{\n    const char *base;\n    char *name;\n    virConfValuePtr value;\n    char *comm = NULL;\n\n    SKIP_BLANKS_AND_EOL;\n    if (CUR == '#')\n        return virConfParseComment(ctxt);\n    name = virConfParseName(ctxt);\n    if (name == NULL)\n        return -1;\n    SKIP_BLANKS;\n    if (CUR != '=') {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting an assignment\"));\n        VIR_FREE(name);\n        return -1;\n    }\n    NEXT;\n    SKIP_BLANKS;\n    value = virConfParseValue(ctxt);\n    if (value == NULL) {\n        VIR_FREE(name);\n        return -1;\n    }\n    SKIP_BLANKS;\n    if (CUR == '#') {\n        NEXT;\n        base = ctxt->cur;\n        while ((ctxt->cur < ctxt->end) && (!IS_EOL(CUR))) NEXT;\n        comm = g_strndup(base, ctxt->cur - base);\n    }\n    if (virConfAddEntry(ctxt->conf, name, value, comm) == NULL) {\n        VIR_FREE(name);\n        virConfFreeValue(value);\n        VIR_FREE(comm);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SKIP_BLANKS \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR))) \\\n          ctxt->cur++; } while (0)",
            "#define SKIP_BLANKS_AND_EOL \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR) || IS_EOL(CUR))) { \\\n         if (CUR == '\\n') ctxt->line++; \\\n         ctxt->cur++; } } while (0)",
            "#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;",
            "#define CUR (*ctxt->cur)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define SKIP_BLANKS \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR))) \\\n          ctxt->cur++; } while (0)\n#define SKIP_BLANKS_AND_EOL \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR) || IS_EOL(CUR))) { \\\n         if (CUR == '\\n') ctxt->line++; \\\n         ctxt->cur++; } } while (0)\n#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;\n#define CUR (*ctxt->cur)\n\nstatic int\nvirConfParseStatement(virConfParserCtxtPtr ctxt)\n{\n    const char *base;\n    char *name;\n    virConfValuePtr value;\n    char *comm = NULL;\n\n    SKIP_BLANKS_AND_EOL;\n    if (CUR == '#')\n        return virConfParseComment(ctxt);\n    name = virConfParseName(ctxt);\n    if (name == NULL)\n        return -1;\n    SKIP_BLANKS;\n    if (CUR != '=') {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting an assignment\"));\n        VIR_FREE(name);\n        return -1;\n    }\n    NEXT;\n    SKIP_BLANKS;\n    value = virConfParseValue(ctxt);\n    if (value == NULL) {\n        VIR_FREE(name);\n        return -1;\n    }\n    SKIP_BLANKS;\n    if (CUR == '#') {\n        NEXT;\n        base = ctxt->cur;\n        while ((ctxt->cur < ctxt->end) && (!IS_EOL(CUR))) NEXT;\n        comm = g_strndup(base, ctxt->cur - base);\n    }\n    if (virConfAddEntry(ctxt->conf, name, value, comm) == NULL) {\n        VIR_FREE(name);\n        virConfFreeValue(value);\n        VIR_FREE(comm);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfCreate",
          "args": [
            "filename",
            "flags"
          ],
          "line": 698
        },
        "resolved": true,
        "details": {
          "function_name": "virConfCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "183-194",
          "snippet": "static virConfPtr\nvirConfCreate(const char *filename, unsigned int flags)\n{\n    virConfPtr ret = virConfNew();\n    if (!ret)\n        return NULL;\n\n    ret->filename = g_strdup(filename);\n\n    ret->flags = flags;\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virConfPtr\nvirConfCreate(const char *filename, unsigned int flags)\n{\n    virConfPtr ret = virConfNew();\n    if (!ret)\n        return NULL;\n\n    ret->filename = g_strdup(filename);\n\n    ret->flags = flags;\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virConfPtr\nvirConfParse(const char *filename, const char *content, int len,\n             unsigned int flags)\n{\n    virConfParserCtxt ctxt;\n\n    ctxt.filename = filename;\n    ctxt.base = ctxt.cur = content;\n    ctxt.end = content + len;\n    ctxt.line = 1;\n\n    ctxt.conf = virConfCreate(filename, flags);\n    if (ctxt.conf == NULL)\n        return NULL;\n\n    while (ctxt.cur < ctxt.end) {\n        if (virConfParseStatement(&ctxt) < 0)\n            goto error;\n        if (virConfParseSeparator(&ctxt) < 0)\n            goto error;\n    }\n\n    return ctxt.conf;\n\n error:\n    virConfFree(ctxt.conf);\n    return NULL;\n}"
  },
  {
    "function_name": "virConfParseStatement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "631-672",
    "snippet": "static int\nvirConfParseStatement(virConfParserCtxtPtr ctxt)\n{\n    const char *base;\n    char *name;\n    virConfValuePtr value;\n    char *comm = NULL;\n\n    SKIP_BLANKS_AND_EOL;\n    if (CUR == '#')\n        return virConfParseComment(ctxt);\n    name = virConfParseName(ctxt);\n    if (name == NULL)\n        return -1;\n    SKIP_BLANKS;\n    if (CUR != '=') {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting an assignment\"));\n        VIR_FREE(name);\n        return -1;\n    }\n    NEXT;\n    SKIP_BLANKS;\n    value = virConfParseValue(ctxt);\n    if (value == NULL) {\n        VIR_FREE(name);\n        return -1;\n    }\n    SKIP_BLANKS;\n    if (CUR == '#') {\n        NEXT;\n        base = ctxt->cur;\n        while ((ctxt->cur < ctxt->end) && (!IS_EOL(CUR))) NEXT;\n        comm = g_strndup(base, ctxt->cur - base);\n    }\n    if (virConfAddEntry(ctxt->conf, name, value, comm) == NULL) {\n        VIR_FREE(name);\n        virConfFreeValue(value);\n        VIR_FREE(comm);\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define SKIP_BLANKS \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR))) \\\n          ctxt->cur++; } while (0)",
      "#define SKIP_BLANKS_AND_EOL \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR) || IS_EOL(CUR))) { \\\n         if (CUR == '\\n') ctxt->line++; \\\n         ctxt->cur++; } } while (0)",
      "#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;",
      "#define CUR (*ctxt->cur)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "comm"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfFreeValue",
          "args": [
            "value"
          ],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "virConfFreeValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "147-159",
          "snippet": "void\nvirConfFreeValue(virConfValuePtr val)\n{\n    if (val == NULL)\n        return;\n    if (val->type == VIR_CONF_STRING &&\n        val->str != NULL)\n        VIR_FREE(val->str);\n    if (val->type == VIR_CONF_LIST &&\n        val->list != NULL)\n        virConfFreeList(val->list);\n    VIR_FREE(val);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirConfFreeValue(virConfValuePtr val)\n{\n    if (val == NULL)\n        return;\n    if (val->type == VIR_CONF_STRING &&\n        val->str != NULL)\n        VIR_FREE(val->str);\n    if (val->type == VIR_CONF_LIST &&\n        val->list != NULL)\n        virConfFreeList(val->list);\n    VIR_FREE(val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "name"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfAddEntry",
          "args": [
            "ctxt->conf",
            "name",
            "value",
            "comm"
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "virConfAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "208-238",
          "snippet": "static virConfEntryPtr\nvirConfAddEntry(virConfPtr conf, char *name, virConfValuePtr value, char *comm)\n{\n    virConfEntryPtr ret, prev;\n\n    if (conf == NULL)\n        return NULL;\n    if ((comm == NULL) && (name == NULL))\n        return NULL;\n\n    /* don't log fully commented out lines */\n    if (name)\n        VIR_DEBUG(\"Add entry %s %p\", name, value);\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->name = name;\n    ret->value = value;\n    ret->comment = comm;\n\n    if (conf->entries == NULL) {\n        conf->entries = ret;\n    } else {\n        prev = conf->entries;\n        while (prev->next != NULL)\n            prev = prev->next;\n        prev->next = ret;\n    }\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virConfEntryPtr\nvirConfAddEntry(virConfPtr conf, char *name, virConfValuePtr value, char *comm)\n{\n    virConfEntryPtr ret, prev;\n\n    if (conf == NULL)\n        return NULL;\n    if ((comm == NULL) && (name == NULL))\n        return NULL;\n\n    /* don't log fully commented out lines */\n    if (name)\n        VIR_DEBUG(\"Add entry %s %p\", name, value);\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->name = name;\n    ret->value = value;\n    ret->comment = comm;\n\n    if (conf->entries == NULL) {\n        conf->entries = ret;\n    } else {\n        prev = conf->entries;\n        while (prev->next != NULL)\n            prev = prev->next;\n        prev->next = ret;\n    }\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "base",
            "ctxt->cur - base"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_EOL",
          "args": [
            "CUR"
          ],
          "line": 662
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "name"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfParseValue",
          "args": [
            "ctxt"
          ],
          "line": 653
        },
        "resolved": true,
        "details": {
          "function_name": "virConfParseValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "443-535",
          "snippet": "static virConfValuePtr\nvirConfParseValue(virConfParserCtxtPtr ctxt)\n{\n    virConfValuePtr ret, lst = NULL, tmp, prev;\n    virConfType type = VIR_CONF_NONE;\n    char *str = NULL;\n    long long l = 0;\n\n    SKIP_BLANKS;\n    if (ctxt->cur >= ctxt->end) {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a value\"));\n        return NULL;\n    }\n    if ((CUR == '\"') || (CUR == '\\'') ||\n        (ctxt->conf->flags & VIR_CONF_FLAG_LXC_FORMAT)) {\n        type = VIR_CONF_STRING;\n        str = virConfParseString(ctxt);\n        if (str == NULL)\n            return NULL;\n    } else if (CUR == '[') {\n        if (ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                         _(\"lists not allowed in VMX format\"));\n            return NULL;\n        }\n        type = VIR_CONF_LIST;\n        NEXT;\n        SKIP_BLANKS_AND_EOL;\n        if ((ctxt->cur < ctxt->end) && (CUR != ']')) {\n            if ((lst = virConfParseValue(ctxt)) == NULL)\n                return NULL;\n            SKIP_BLANKS_AND_EOL;\n        }\n        while ((ctxt->cur < ctxt->end) && (CUR != ']')) {\n\n            /* Tell Clang that when execution reaches this point\n               \"lst\" is guaranteed to be non-NULL.  This stops it\n               from issuing an invalid NULL-dereference warning about\n               \"prev = lst; while (prev->next...\" below.  */\n            sa_assert(lst);\n\n            if (CUR != ',') {\n                virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                             _(\"expecting a separator in list\"));\n                virConfFreeList(lst);\n                return NULL;\n            }\n            NEXT;\n            SKIP_BLANKS_AND_EOL;\n            if (CUR == ']')\n                break;\n            tmp = virConfParseValue(ctxt);\n            if (tmp == NULL) {\n                virConfFreeList(lst);\n                return NULL;\n            }\n            prev = lst;\n            while (prev->next != NULL) prev = prev->next;\n            prev->next = tmp;\n            SKIP_BLANKS_AND_EOL;\n        }\n        if (CUR == ']') {\n            NEXT;\n        } else {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                         _(\"list is not closed with ]\"));\n            virConfFreeList(lst);\n            return NULL;\n        }\n    } else if (g_ascii_isdigit(CUR) || (CUR == '-') || (CUR == '+')) {\n        if (ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                         _(\"numbers not allowed in VMX format\"));\n            return NULL;\n        }\n        type = (CUR == '-') ? VIR_CONF_LLONG : VIR_CONF_ULLONG;\n        if (virConfParseLong(ctxt, &l) < 0)\n            return NULL;\n    } else {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a value\"));\n        return NULL;\n    }\n    if (VIR_ALLOC(ret) < 0) {\n        virConfFreeList(lst);\n        VIR_FREE(str);\n        return NULL;\n    }\n    ret->type = type;\n    ret->l = l;\n    ret->str = str;\n    ret->list = lst;\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SKIP_BLANKS \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR))) \\\n          ctxt->cur++; } while (0)",
            "#define SKIP_BLANKS_AND_EOL \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR) || IS_EOL(CUR))) { \\\n         if (CUR == '\\n') ctxt->line++; \\\n         ctxt->cur++; } } while (0)",
            "#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;",
            "#define CUR (*ctxt->cur)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define SKIP_BLANKS \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR))) \\\n          ctxt->cur++; } while (0)\n#define SKIP_BLANKS_AND_EOL \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR) || IS_EOL(CUR))) { \\\n         if (CUR == '\\n') ctxt->line++; \\\n         ctxt->cur++; } } while (0)\n#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;\n#define CUR (*ctxt->cur)\n\nstatic virConfValuePtr\nvirConfParseValue(virConfParserCtxtPtr ctxt)\n{\n    virConfValuePtr ret, lst = NULL, tmp, prev;\n    virConfType type = VIR_CONF_NONE;\n    char *str = NULL;\n    long long l = 0;\n\n    SKIP_BLANKS;\n    if (ctxt->cur >= ctxt->end) {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a value\"));\n        return NULL;\n    }\n    if ((CUR == '\"') || (CUR == '\\'') ||\n        (ctxt->conf->flags & VIR_CONF_FLAG_LXC_FORMAT)) {\n        type = VIR_CONF_STRING;\n        str = virConfParseString(ctxt);\n        if (str == NULL)\n            return NULL;\n    } else if (CUR == '[') {\n        if (ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                         _(\"lists not allowed in VMX format\"));\n            return NULL;\n        }\n        type = VIR_CONF_LIST;\n        NEXT;\n        SKIP_BLANKS_AND_EOL;\n        if ((ctxt->cur < ctxt->end) && (CUR != ']')) {\n            if ((lst = virConfParseValue(ctxt)) == NULL)\n                return NULL;\n            SKIP_BLANKS_AND_EOL;\n        }\n        while ((ctxt->cur < ctxt->end) && (CUR != ']')) {\n\n            /* Tell Clang that when execution reaches this point\n               \"lst\" is guaranteed to be non-NULL.  This stops it\n               from issuing an invalid NULL-dereference warning about\n               \"prev = lst; while (prev->next...\" below.  */\n            sa_assert(lst);\n\n            if (CUR != ',') {\n                virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                             _(\"expecting a separator in list\"));\n                virConfFreeList(lst);\n                return NULL;\n            }\n            NEXT;\n            SKIP_BLANKS_AND_EOL;\n            if (CUR == ']')\n                break;\n            tmp = virConfParseValue(ctxt);\n            if (tmp == NULL) {\n                virConfFreeList(lst);\n                return NULL;\n            }\n            prev = lst;\n            while (prev->next != NULL) prev = prev->next;\n            prev->next = tmp;\n            SKIP_BLANKS_AND_EOL;\n        }\n        if (CUR == ']') {\n            NEXT;\n        } else {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                         _(\"list is not closed with ]\"));\n            virConfFreeList(lst);\n            return NULL;\n        }\n    } else if (g_ascii_isdigit(CUR) || (CUR == '-') || (CUR == '+')) {\n        if (ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                         _(\"numbers not allowed in VMX format\"));\n            return NULL;\n        }\n        type = (CUR == '-') ? VIR_CONF_LLONG : VIR_CONF_ULLONG;\n        if (virConfParseLong(ctxt, &l) < 0)\n            return NULL;\n    } else {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a value\"));\n        return NULL;\n    }\n    if (VIR_ALLOC(ret) < 0) {\n        virConfFreeList(lst);\n        VIR_FREE(str);\n        return NULL;\n    }\n    ret->type = type;\n    ret->l = l;\n    ret->str = str;\n    ret->list = lst;\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "name"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "_(\"expecting an assignment\")"
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"expecting an assignment\""
          ],
          "line": 647
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfParseName",
          "args": [
            "ctxt"
          ],
          "line": 642
        },
        "resolved": true,
        "details": {
          "function_name": "virConfParseName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "545-568",
          "snippet": "static char *\nvirConfParseName(virConfParserCtxtPtr ctxt)\n{\n    const char *base;\n    char *ret;\n\n    SKIP_BLANKS;\n    base = ctxt->cur;\n    /* TODO: probably need encoding support and UTF-8 parsing ! */\n    if (!g_ascii_isalpha(CUR) &&\n        !((ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) && (CUR == '.'))) {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a name\"));\n        return NULL;\n    }\n    while ((ctxt->cur < ctxt->end) &&\n           (g_ascii_isalnum(CUR) || (CUR == '_') ||\n            ((ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) &&\n             ((CUR == ':') || (CUR == '.') || (CUR == '-'))) ||\n            ((ctxt->conf->flags & VIR_CONF_FLAG_LXC_FORMAT) &&\n             (CUR == '.'))))\n        NEXT;\n    ret = g_strndup(base, ctxt->cur - base);\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SKIP_BLANKS \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR))) \\\n          ctxt->cur++; } while (0)",
            "#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;",
            "#define CUR (*ctxt->cur)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define SKIP_BLANKS \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR))) \\\n          ctxt->cur++; } while (0)\n#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;\n#define CUR (*ctxt->cur)\n\nstatic char *\nvirConfParseName(virConfParserCtxtPtr ctxt)\n{\n    const char *base;\n    char *ret;\n\n    SKIP_BLANKS;\n    base = ctxt->cur;\n    /* TODO: probably need encoding support and UTF-8 parsing ! */\n    if (!g_ascii_isalpha(CUR) &&\n        !((ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) && (CUR == '.'))) {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a name\"));\n        return NULL;\n    }\n    while ((ctxt->cur < ctxt->end) &&\n           (g_ascii_isalnum(CUR) || (CUR == '_') ||\n            ((ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) &&\n             ((CUR == ':') || (CUR == '.') || (CUR == '-'))) ||\n            ((ctxt->conf->flags & VIR_CONF_FLAG_LXC_FORMAT) &&\n             (CUR == '.'))))\n        NEXT;\n    ret = g_strndup(base, ctxt->cur - base);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfParseComment",
          "args": [
            "ctxt"
          ],
          "line": 641
        },
        "resolved": true,
        "details": {
          "function_name": "virConfParseComment",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "578-595",
          "snippet": "static int\nvirConfParseComment(virConfParserCtxtPtr ctxt)\n{\n    const char *base;\n    char *comm;\n\n    if (CUR != '#')\n        return -1;\n    NEXT;\n    base = ctxt->cur;\n    while ((ctxt->cur < ctxt->end) && (!IS_EOL(CUR))) NEXT;\n    comm = g_strndup(base, ctxt->cur - base);\n    if (virConfAddEntry(ctxt->conf, NULL, NULL, comm) == NULL) {\n        VIR_FREE(comm);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;",
            "#define CUR (*ctxt->cur)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;\n#define CUR (*ctxt->cur)\n\nstatic int\nvirConfParseComment(virConfParserCtxtPtr ctxt)\n{\n    const char *base;\n    char *comm;\n\n    if (CUR != '#')\n        return -1;\n    NEXT;\n    base = ctxt->cur;\n    while ((ctxt->cur < ctxt->end) && (!IS_EOL(CUR))) NEXT;\n    comm = g_strndup(base, ctxt->cur - base);\n    if (virConfAddEntry(ctxt->conf, NULL, NULL, comm) == NULL) {\n        VIR_FREE(comm);\n        return -1;\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define SKIP_BLANKS \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR))) \\\n          ctxt->cur++; } while (0)\n#define SKIP_BLANKS_AND_EOL \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR) || IS_EOL(CUR))) { \\\n         if (CUR == '\\n') ctxt->line++; \\\n         ctxt->cur++; } } while (0)\n#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;\n#define CUR (*ctxt->cur)\n\nstatic int\nvirConfParseStatement(virConfParserCtxtPtr ctxt)\n{\n    const char *base;\n    char *name;\n    virConfValuePtr value;\n    char *comm = NULL;\n\n    SKIP_BLANKS_AND_EOL;\n    if (CUR == '#')\n        return virConfParseComment(ctxt);\n    name = virConfParseName(ctxt);\n    if (name == NULL)\n        return -1;\n    SKIP_BLANKS;\n    if (CUR != '=') {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting an assignment\"));\n        VIR_FREE(name);\n        return -1;\n    }\n    NEXT;\n    SKIP_BLANKS;\n    value = virConfParseValue(ctxt);\n    if (value == NULL) {\n        VIR_FREE(name);\n        return -1;\n    }\n    SKIP_BLANKS;\n    if (CUR == '#') {\n        NEXT;\n        base = ctxt->cur;\n        while ((ctxt->cur < ctxt->end) && (!IS_EOL(CUR))) NEXT;\n        comm = g_strndup(base, ctxt->cur - base);\n    }\n    if (virConfAddEntry(ctxt->conf, name, value, comm) == NULL) {\n        VIR_FREE(name);\n        virConfFreeValue(value);\n        VIR_FREE(comm);\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virConfParseSeparator",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "605-621",
    "snippet": "static int\nvirConfParseSeparator(virConfParserCtxtPtr ctxt)\n{\n    SKIP_BLANKS;\n    if (ctxt->cur >= ctxt->end)\n        return 0;\n    if (IS_EOL(CUR)) {\n        SKIP_BLANKS_AND_EOL;\n    } else if (CUR == ';') {\n        NEXT;\n        SKIP_BLANKS_AND_EOL;\n    } else {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a separator\"));\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define SKIP_BLANKS \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR))) \\\n          ctxt->cur++; } while (0)",
      "#define SKIP_BLANKS_AND_EOL \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR) || IS_EOL(CUR))) { \\\n         if (CUR == '\\n') ctxt->line++; \\\n         ctxt->cur++; } } while (0)",
      "#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;",
      "#define CUR (*ctxt->cur)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "_(\"expecting a separator\")"
          ],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"expecting a separator\""
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_EOL",
          "args": [
            "CUR"
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define SKIP_BLANKS \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR))) \\\n          ctxt->cur++; } while (0)\n#define SKIP_BLANKS_AND_EOL \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR) || IS_EOL(CUR))) { \\\n         if (CUR == '\\n') ctxt->line++; \\\n         ctxt->cur++; } } while (0)\n#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;\n#define CUR (*ctxt->cur)\n\nstatic int\nvirConfParseSeparator(virConfParserCtxtPtr ctxt)\n{\n    SKIP_BLANKS;\n    if (ctxt->cur >= ctxt->end)\n        return 0;\n    if (IS_EOL(CUR)) {\n        SKIP_BLANKS_AND_EOL;\n    } else if (CUR == ';') {\n        NEXT;\n        SKIP_BLANKS_AND_EOL;\n    } else {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a separator\"));\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virConfParseComment",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "578-595",
    "snippet": "static int\nvirConfParseComment(virConfParserCtxtPtr ctxt)\n{\n    const char *base;\n    char *comm;\n\n    if (CUR != '#')\n        return -1;\n    NEXT;\n    base = ctxt->cur;\n    while ((ctxt->cur < ctxt->end) && (!IS_EOL(CUR))) NEXT;\n    comm = g_strndup(base, ctxt->cur - base);\n    if (virConfAddEntry(ctxt->conf, NULL, NULL, comm) == NULL) {\n        VIR_FREE(comm);\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;",
      "#define CUR (*ctxt->cur)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "comm"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfAddEntry",
          "args": [
            "ctxt->conf",
            "NULL",
            "NULL",
            "comm"
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "virConfAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "208-238",
          "snippet": "static virConfEntryPtr\nvirConfAddEntry(virConfPtr conf, char *name, virConfValuePtr value, char *comm)\n{\n    virConfEntryPtr ret, prev;\n\n    if (conf == NULL)\n        return NULL;\n    if ((comm == NULL) && (name == NULL))\n        return NULL;\n\n    /* don't log fully commented out lines */\n    if (name)\n        VIR_DEBUG(\"Add entry %s %p\", name, value);\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->name = name;\n    ret->value = value;\n    ret->comment = comm;\n\n    if (conf->entries == NULL) {\n        conf->entries = ret;\n    } else {\n        prev = conf->entries;\n        while (prev->next != NULL)\n            prev = prev->next;\n        prev->next = ret;\n    }\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virConfEntryPtr\nvirConfAddEntry(virConfPtr conf, char *name, virConfValuePtr value, char *comm)\n{\n    virConfEntryPtr ret, prev;\n\n    if (conf == NULL)\n        return NULL;\n    if ((comm == NULL) && (name == NULL))\n        return NULL;\n\n    /* don't log fully commented out lines */\n    if (name)\n        VIR_DEBUG(\"Add entry %s %p\", name, value);\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->name = name;\n    ret->value = value;\n    ret->comment = comm;\n\n    if (conf->entries == NULL) {\n        conf->entries = ret;\n    } else {\n        prev = conf->entries;\n        while (prev->next != NULL)\n            prev = prev->next;\n        prev->next = ret;\n    }\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "base",
            "ctxt->cur - base"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_EOL",
          "args": [
            "CUR"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;\n#define CUR (*ctxt->cur)\n\nstatic int\nvirConfParseComment(virConfParserCtxtPtr ctxt)\n{\n    const char *base;\n    char *comm;\n\n    if (CUR != '#')\n        return -1;\n    NEXT;\n    base = ctxt->cur;\n    while ((ctxt->cur < ctxt->end) && (!IS_EOL(CUR))) NEXT;\n    comm = g_strndup(base, ctxt->cur - base);\n    if (virConfAddEntry(ctxt->conf, NULL, NULL, comm) == NULL) {\n        VIR_FREE(comm);\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virConfParseName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "545-568",
    "snippet": "static char *\nvirConfParseName(virConfParserCtxtPtr ctxt)\n{\n    const char *base;\n    char *ret;\n\n    SKIP_BLANKS;\n    base = ctxt->cur;\n    /* TODO: probably need encoding support and UTF-8 parsing ! */\n    if (!g_ascii_isalpha(CUR) &&\n        !((ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) && (CUR == '.'))) {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a name\"));\n        return NULL;\n    }\n    while ((ctxt->cur < ctxt->end) &&\n           (g_ascii_isalnum(CUR) || (CUR == '_') ||\n            ((ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) &&\n             ((CUR == ':') || (CUR == '.') || (CUR == '-'))) ||\n            ((ctxt->conf->flags & VIR_CONF_FLAG_LXC_FORMAT) &&\n             (CUR == '.'))))\n        NEXT;\n    ret = g_strndup(base, ctxt->cur - base);\n    return ret;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define SKIP_BLANKS \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR))) \\\n          ctxt->cur++; } while (0)",
      "#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;",
      "#define CUR (*ctxt->cur)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "base",
            "ctxt->cur - base"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ascii_isalnum",
          "args": [
            "CUR"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "_(\"expecting a name\")"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"expecting a name\""
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_ascii_isalpha",
          "args": [
            "CUR"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define SKIP_BLANKS \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR))) \\\n          ctxt->cur++; } while (0)\n#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;\n#define CUR (*ctxt->cur)\n\nstatic char *\nvirConfParseName(virConfParserCtxtPtr ctxt)\n{\n    const char *base;\n    char *ret;\n\n    SKIP_BLANKS;\n    base = ctxt->cur;\n    /* TODO: probably need encoding support and UTF-8 parsing ! */\n    if (!g_ascii_isalpha(CUR) &&\n        !((ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) && (CUR == '.'))) {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a name\"));\n        return NULL;\n    }\n    while ((ctxt->cur < ctxt->end) &&\n           (g_ascii_isalnum(CUR) || (CUR == '_') ||\n            ((ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) &&\n             ((CUR == ':') || (CUR == '.') || (CUR == '-'))) ||\n            ((ctxt->conf->flags & VIR_CONF_FLAG_LXC_FORMAT) &&\n             (CUR == '.'))))\n        NEXT;\n    ret = g_strndup(base, ctxt->cur - base);\n    return ret;\n}"
  },
  {
    "function_name": "virConfParseValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "443-535",
    "snippet": "static virConfValuePtr\nvirConfParseValue(virConfParserCtxtPtr ctxt)\n{\n    virConfValuePtr ret, lst = NULL, tmp, prev;\n    virConfType type = VIR_CONF_NONE;\n    char *str = NULL;\n    long long l = 0;\n\n    SKIP_BLANKS;\n    if (ctxt->cur >= ctxt->end) {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a value\"));\n        return NULL;\n    }\n    if ((CUR == '\"') || (CUR == '\\'') ||\n        (ctxt->conf->flags & VIR_CONF_FLAG_LXC_FORMAT)) {\n        type = VIR_CONF_STRING;\n        str = virConfParseString(ctxt);\n        if (str == NULL)\n            return NULL;\n    } else if (CUR == '[') {\n        if (ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                         _(\"lists not allowed in VMX format\"));\n            return NULL;\n        }\n        type = VIR_CONF_LIST;\n        NEXT;\n        SKIP_BLANKS_AND_EOL;\n        if ((ctxt->cur < ctxt->end) && (CUR != ']')) {\n            if ((lst = virConfParseValue(ctxt)) == NULL)\n                return NULL;\n            SKIP_BLANKS_AND_EOL;\n        }\n        while ((ctxt->cur < ctxt->end) && (CUR != ']')) {\n\n            /* Tell Clang that when execution reaches this point\n               \"lst\" is guaranteed to be non-NULL.  This stops it\n               from issuing an invalid NULL-dereference warning about\n               \"prev = lst; while (prev->next...\" below.  */\n            sa_assert(lst);\n\n            if (CUR != ',') {\n                virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                             _(\"expecting a separator in list\"));\n                virConfFreeList(lst);\n                return NULL;\n            }\n            NEXT;\n            SKIP_BLANKS_AND_EOL;\n            if (CUR == ']')\n                break;\n            tmp = virConfParseValue(ctxt);\n            if (tmp == NULL) {\n                virConfFreeList(lst);\n                return NULL;\n            }\n            prev = lst;\n            while (prev->next != NULL) prev = prev->next;\n            prev->next = tmp;\n            SKIP_BLANKS_AND_EOL;\n        }\n        if (CUR == ']') {\n            NEXT;\n        } else {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                         _(\"list is not closed with ]\"));\n            virConfFreeList(lst);\n            return NULL;\n        }\n    } else if (g_ascii_isdigit(CUR) || (CUR == '-') || (CUR == '+')) {\n        if (ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                         _(\"numbers not allowed in VMX format\"));\n            return NULL;\n        }\n        type = (CUR == '-') ? VIR_CONF_LLONG : VIR_CONF_ULLONG;\n        if (virConfParseLong(ctxt, &l) < 0)\n            return NULL;\n    } else {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a value\"));\n        return NULL;\n    }\n    if (VIR_ALLOC(ret) < 0) {\n        virConfFreeList(lst);\n        VIR_FREE(str);\n        return NULL;\n    }\n    ret->type = type;\n    ret->l = l;\n    ret->str = str;\n    ret->list = lst;\n    return ret;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define SKIP_BLANKS \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR))) \\\n          ctxt->cur++; } while (0)",
      "#define SKIP_BLANKS_AND_EOL \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR) || IS_EOL(CUR))) { \\\n         if (CUR == '\\n') ctxt->line++; \\\n         ctxt->cur++; } } while (0)",
      "#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;",
      "#define CUR (*ctxt->cur)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "str"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfFreeList",
          "args": [
            "lst"
          ],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "virConfFreeList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "128-139",
          "snippet": "static void\nvirConfFreeList(virConfValuePtr list)\n{\n    virConfValuePtr next;\n\n    while (list != NULL) {\n        next = list->next;\n        list->next = NULL;\n        virConfFreeValue(list);\n        list = next;\n    }\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirConfFreeList(virConfValuePtr list)\n{\n    virConfValuePtr next;\n\n    while (list != NULL) {\n        next = list->next;\n        list->next = NULL;\n        virConfFreeValue(list);\n        list = next;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ret"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "_(\"expecting a value\")"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"expecting a value\""
          ],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfParseLong",
          "args": [
            "ctxt",
            "&l"
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "virConfParseLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "340-364",
          "snippet": "static int\nvirConfParseLong(virConfParserCtxtPtr ctxt, long long *val)\n{\n    long long l = 0;\n    int neg = 0;\n\n    if (CUR == '-') {\n        neg = 1;\n        NEXT;\n    } else if (CUR == '+') {\n        NEXT;\n    }\n    if ((ctxt->cur >= ctxt->end) || (!g_ascii_isdigit(CUR))) {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"unterminated number\"));\n        return -1;\n    }\n    while ((ctxt->cur < ctxt->end) && (g_ascii_isdigit(CUR))) {\n        l = l * 10 + (CUR - '0');\n        NEXT;\n    }\n    if (neg)\n        l = -l;\n    *val = l;\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;",
            "#define CUR (*ctxt->cur)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;\n#define CUR (*ctxt->cur)\n\nstatic int\nvirConfParseLong(virConfParserCtxtPtr ctxt, long long *val)\n{\n    long long l = 0;\n    int neg = 0;\n\n    if (CUR == '-') {\n        neg = 1;\n        NEXT;\n    } else if (CUR == '+') {\n        NEXT;\n    }\n    if ((ctxt->cur >= ctxt->end) || (!g_ascii_isdigit(CUR))) {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"unterminated number\"));\n        return -1;\n    }\n    while ((ctxt->cur < ctxt->end) && (g_ascii_isdigit(CUR))) {\n        l = l * 10 + (CUR - '0');\n        NEXT;\n    }\n    if (neg)\n        l = -l;\n    *val = l;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "_(\"numbers not allowed in VMX format\")"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ascii_isdigit",
          "args": [
            "CUR"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "_(\"list is not closed with ]\")"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfParseValue",
          "args": [
            "ctxt"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "virConfParseValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "443-535",
          "snippet": "static virConfValuePtr\nvirConfParseValue(virConfParserCtxtPtr ctxt)\n{\n    virConfValuePtr ret, lst = NULL, tmp, prev;\n    virConfType type = VIR_CONF_NONE;\n    char *str = NULL;\n    long long l = 0;\n\n    SKIP_BLANKS;\n    if (ctxt->cur >= ctxt->end) {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a value\"));\n        return NULL;\n    }\n    if ((CUR == '\"') || (CUR == '\\'') ||\n        (ctxt->conf->flags & VIR_CONF_FLAG_LXC_FORMAT)) {\n        type = VIR_CONF_STRING;\n        str = virConfParseString(ctxt);\n        if (str == NULL)\n            return NULL;\n    } else if (CUR == '[') {\n        if (ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                         _(\"lists not allowed in VMX format\"));\n            return NULL;\n        }\n        type = VIR_CONF_LIST;\n        NEXT;\n        SKIP_BLANKS_AND_EOL;\n        if ((ctxt->cur < ctxt->end) && (CUR != ']')) {\n            if ((lst = virConfParseValue(ctxt)) == NULL)\n                return NULL;\n            SKIP_BLANKS_AND_EOL;\n        }\n        while ((ctxt->cur < ctxt->end) && (CUR != ']')) {\n\n            /* Tell Clang that when execution reaches this point\n               \"lst\" is guaranteed to be non-NULL.  This stops it\n               from issuing an invalid NULL-dereference warning about\n               \"prev = lst; while (prev->next...\" below.  */\n            sa_assert(lst);\n\n            if (CUR != ',') {\n                virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                             _(\"expecting a separator in list\"));\n                virConfFreeList(lst);\n                return NULL;\n            }\n            NEXT;\n            SKIP_BLANKS_AND_EOL;\n            if (CUR == ']')\n                break;\n            tmp = virConfParseValue(ctxt);\n            if (tmp == NULL) {\n                virConfFreeList(lst);\n                return NULL;\n            }\n            prev = lst;\n            while (prev->next != NULL) prev = prev->next;\n            prev->next = tmp;\n            SKIP_BLANKS_AND_EOL;\n        }\n        if (CUR == ']') {\n            NEXT;\n        } else {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                         _(\"list is not closed with ]\"));\n            virConfFreeList(lst);\n            return NULL;\n        }\n    } else if (g_ascii_isdigit(CUR) || (CUR == '-') || (CUR == '+')) {\n        if (ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                         _(\"numbers not allowed in VMX format\"));\n            return NULL;\n        }\n        type = (CUR == '-') ? VIR_CONF_LLONG : VIR_CONF_ULLONG;\n        if (virConfParseLong(ctxt, &l) < 0)\n            return NULL;\n    } else {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a value\"));\n        return NULL;\n    }\n    if (VIR_ALLOC(ret) < 0) {\n        virConfFreeList(lst);\n        VIR_FREE(str);\n        return NULL;\n    }\n    ret->type = type;\n    ret->l = l;\n    ret->str = str;\n    ret->list = lst;\n    return ret;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virConfError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "_(\"expecting a separator in list\")"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sa_assert",
          "args": [
            "lst"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "_(\"lists not allowed in VMX format\")"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfParseString",
          "args": [
            "ctxt"
          ],
          "line": 459
        },
        "resolved": true,
        "details": {
          "function_name": "virConfParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "374-433",
          "snippet": "static char *\nvirConfParseString(virConfParserCtxtPtr ctxt)\n{\n    const char *base;\n    char *ret = NULL;\n\n    if (CUR == '\\'') {\n        NEXT;\n        base = ctxt->cur;\n        while ((ctxt->cur < ctxt->end) && (CUR != '\\'') && (!IS_EOL(CUR)))\n            NEXT;\n        if (CUR != '\\'') {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"unterminated string\"));\n            return NULL;\n        }\n        ret = g_strndup(base, ctxt->cur - base);\n        NEXT;\n    } else if ((ctxt->cur + 6 < ctxt->end) &&\n               (STRPREFIX(ctxt->cur, \"\\\"\\\"\\\"\"))) {\n        /* String starts with python-style triple quotes \"\"\" */\n        ctxt->cur += 3;\n        base = ctxt->cur;\n\n        /* Find the ending triple quotes */\n        while ((ctxt->cur + 2 < ctxt->end) &&\n               !(STRPREFIX(ctxt->cur, \"\\\"\\\"\\\"\"))) {\n            if (CUR == '\\n')\n                ctxt->line++;\n            NEXT;\n        }\n\n        if (!STRPREFIX(ctxt->cur, \"\\\"\\\"\\\"\")) {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"unterminated string\"));\n            return NULL;\n        }\n        ret = g_strndup(base, ctxt->cur - base);\n        ctxt->cur += 3;\n    } else if (CUR == '\"') {\n        NEXT;\n        base = ctxt->cur;\n        while ((ctxt->cur < ctxt->end) && (CUR != '\"') && (!IS_EOL(CUR)))\n            NEXT;\n        if (CUR != '\"') {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"unterminated string\"));\n            return NULL;\n        }\n        ret = g_strndup(base, ctxt->cur - base);\n        NEXT;\n    } else if (ctxt->conf->flags & VIR_CONF_FLAG_LXC_FORMAT) {\n        base = ctxt->cur;\n        /* LXC config format doesn't support comments after the value */\n        while ((ctxt->cur < ctxt->end) && (!IS_EOL(CUR)))\n            NEXT;\n        /* Reverse to exclude the trailing blanks from the value */\n        while ((ctxt->cur > base) && (IS_BLANK(CUR)))\n            ctxt->cur--;\n        ret = g_strndup(base, ctxt->cur - base);\n    }\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;",
            "#define CUR (*ctxt->cur)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;\n#define CUR (*ctxt->cur)\n\nstatic char *\nvirConfParseString(virConfParserCtxtPtr ctxt)\n{\n    const char *base;\n    char *ret = NULL;\n\n    if (CUR == '\\'') {\n        NEXT;\n        base = ctxt->cur;\n        while ((ctxt->cur < ctxt->end) && (CUR != '\\'') && (!IS_EOL(CUR)))\n            NEXT;\n        if (CUR != '\\'') {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"unterminated string\"));\n            return NULL;\n        }\n        ret = g_strndup(base, ctxt->cur - base);\n        NEXT;\n    } else if ((ctxt->cur + 6 < ctxt->end) &&\n               (STRPREFIX(ctxt->cur, \"\\\"\\\"\\\"\"))) {\n        /* String starts with python-style triple quotes \"\"\" */\n        ctxt->cur += 3;\n        base = ctxt->cur;\n\n        /* Find the ending triple quotes */\n        while ((ctxt->cur + 2 < ctxt->end) &&\n               !(STRPREFIX(ctxt->cur, \"\\\"\\\"\\\"\"))) {\n            if (CUR == '\\n')\n                ctxt->line++;\n            NEXT;\n        }\n\n        if (!STRPREFIX(ctxt->cur, \"\\\"\\\"\\\"\")) {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"unterminated string\"));\n            return NULL;\n        }\n        ret = g_strndup(base, ctxt->cur - base);\n        ctxt->cur += 3;\n    } else if (CUR == '\"') {\n        NEXT;\n        base = ctxt->cur;\n        while ((ctxt->cur < ctxt->end) && (CUR != '\"') && (!IS_EOL(CUR)))\n            NEXT;\n        if (CUR != '\"') {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"unterminated string\"));\n            return NULL;\n        }\n        ret = g_strndup(base, ctxt->cur - base);\n        NEXT;\n    } else if (ctxt->conf->flags & VIR_CONF_FLAG_LXC_FORMAT) {\n        base = ctxt->cur;\n        /* LXC config format doesn't support comments after the value */\n        while ((ctxt->cur < ctxt->end) && (!IS_EOL(CUR)))\n            NEXT;\n        /* Reverse to exclude the trailing blanks from the value */\n        while ((ctxt->cur > base) && (IS_BLANK(CUR)))\n            ctxt->cur--;\n        ret = g_strndup(base, ctxt->cur - base);\n    }\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "_(\"expecting a value\")"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define SKIP_BLANKS \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR))) \\\n          ctxt->cur++; } while (0)\n#define SKIP_BLANKS_AND_EOL \\\n  do { while ((ctxt->cur < ctxt->end) && (IS_BLANK(CUR) || IS_EOL(CUR))) { \\\n         if (CUR == '\\n') ctxt->line++; \\\n         ctxt->cur++; } } while (0)\n#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;\n#define CUR (*ctxt->cur)\n\nstatic virConfValuePtr\nvirConfParseValue(virConfParserCtxtPtr ctxt)\n{\n    virConfValuePtr ret, lst = NULL, tmp, prev;\n    virConfType type = VIR_CONF_NONE;\n    char *str = NULL;\n    long long l = 0;\n\n    SKIP_BLANKS;\n    if (ctxt->cur >= ctxt->end) {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a value\"));\n        return NULL;\n    }\n    if ((CUR == '\"') || (CUR == '\\'') ||\n        (ctxt->conf->flags & VIR_CONF_FLAG_LXC_FORMAT)) {\n        type = VIR_CONF_STRING;\n        str = virConfParseString(ctxt);\n        if (str == NULL)\n            return NULL;\n    } else if (CUR == '[') {\n        if (ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                         _(\"lists not allowed in VMX format\"));\n            return NULL;\n        }\n        type = VIR_CONF_LIST;\n        NEXT;\n        SKIP_BLANKS_AND_EOL;\n        if ((ctxt->cur < ctxt->end) && (CUR != ']')) {\n            if ((lst = virConfParseValue(ctxt)) == NULL)\n                return NULL;\n            SKIP_BLANKS_AND_EOL;\n        }\n        while ((ctxt->cur < ctxt->end) && (CUR != ']')) {\n\n            /* Tell Clang that when execution reaches this point\n               \"lst\" is guaranteed to be non-NULL.  This stops it\n               from issuing an invalid NULL-dereference warning about\n               \"prev = lst; while (prev->next...\" below.  */\n            sa_assert(lst);\n\n            if (CUR != ',') {\n                virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                             _(\"expecting a separator in list\"));\n                virConfFreeList(lst);\n                return NULL;\n            }\n            NEXT;\n            SKIP_BLANKS_AND_EOL;\n            if (CUR == ']')\n                break;\n            tmp = virConfParseValue(ctxt);\n            if (tmp == NULL) {\n                virConfFreeList(lst);\n                return NULL;\n            }\n            prev = lst;\n            while (prev->next != NULL) prev = prev->next;\n            prev->next = tmp;\n            SKIP_BLANKS_AND_EOL;\n        }\n        if (CUR == ']') {\n            NEXT;\n        } else {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                         _(\"list is not closed with ]\"));\n            virConfFreeList(lst);\n            return NULL;\n        }\n    } else if (g_ascii_isdigit(CUR) || (CUR == '-') || (CUR == '+')) {\n        if (ctxt->conf->flags & VIR_CONF_FLAG_VMX_FORMAT) {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX,\n                         _(\"numbers not allowed in VMX format\"));\n            return NULL;\n        }\n        type = (CUR == '-') ? VIR_CONF_LLONG : VIR_CONF_ULLONG;\n        if (virConfParseLong(ctxt, &l) < 0)\n            return NULL;\n    } else {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"expecting a value\"));\n        return NULL;\n    }\n    if (VIR_ALLOC(ret) < 0) {\n        virConfFreeList(lst);\n        VIR_FREE(str);\n        return NULL;\n    }\n    ret->type = type;\n    ret->l = l;\n    ret->str = str;\n    ret->list = lst;\n    return ret;\n}"
  },
  {
    "function_name": "virConfParseString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "374-433",
    "snippet": "static char *\nvirConfParseString(virConfParserCtxtPtr ctxt)\n{\n    const char *base;\n    char *ret = NULL;\n\n    if (CUR == '\\'') {\n        NEXT;\n        base = ctxt->cur;\n        while ((ctxt->cur < ctxt->end) && (CUR != '\\'') && (!IS_EOL(CUR)))\n            NEXT;\n        if (CUR != '\\'') {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"unterminated string\"));\n            return NULL;\n        }\n        ret = g_strndup(base, ctxt->cur - base);\n        NEXT;\n    } else if ((ctxt->cur + 6 < ctxt->end) &&\n               (STRPREFIX(ctxt->cur, \"\\\"\\\"\\\"\"))) {\n        /* String starts with python-style triple quotes \"\"\" */\n        ctxt->cur += 3;\n        base = ctxt->cur;\n\n        /* Find the ending triple quotes */\n        while ((ctxt->cur + 2 < ctxt->end) &&\n               !(STRPREFIX(ctxt->cur, \"\\\"\\\"\\\"\"))) {\n            if (CUR == '\\n')\n                ctxt->line++;\n            NEXT;\n        }\n\n        if (!STRPREFIX(ctxt->cur, \"\\\"\\\"\\\"\")) {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"unterminated string\"));\n            return NULL;\n        }\n        ret = g_strndup(base, ctxt->cur - base);\n        ctxt->cur += 3;\n    } else if (CUR == '\"') {\n        NEXT;\n        base = ctxt->cur;\n        while ((ctxt->cur < ctxt->end) && (CUR != '\"') && (!IS_EOL(CUR)))\n            NEXT;\n        if (CUR != '\"') {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"unterminated string\"));\n            return NULL;\n        }\n        ret = g_strndup(base, ctxt->cur - base);\n        NEXT;\n    } else if (ctxt->conf->flags & VIR_CONF_FLAG_LXC_FORMAT) {\n        base = ctxt->cur;\n        /* LXC config format doesn't support comments after the value */\n        while ((ctxt->cur < ctxt->end) && (!IS_EOL(CUR)))\n            NEXT;\n        /* Reverse to exclude the trailing blanks from the value */\n        while ((ctxt->cur > base) && (IS_BLANK(CUR)))\n            ctxt->cur--;\n        ret = g_strndup(base, ctxt->cur - base);\n    }\n    return ret;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;",
      "#define CUR (*ctxt->cur)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "base",
            "ctxt->cur - base"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_BLANK",
          "args": [
            "CUR"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_EOL",
          "args": [
            "CUR"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "base",
            "ctxt->cur - base"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "_(\"unterminated string\")"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unterminated string\""
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_EOL",
          "args": [
            "CUR"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "base",
            "ctxt->cur - base"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "_(\"unterminated string\")"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "ctxt->cur",
            "\"\\\"\\\"\\\"\""
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "ctxt->cur",
            "\"\\\"\\\"\\\"\""
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "ctxt->cur",
            "\"\\\"\\\"\\\"\""
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "base",
            "ctxt->cur - base"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "_(\"unterminated string\")"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_EOL",
          "args": [
            "CUR"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;\n#define CUR (*ctxt->cur)\n\nstatic char *\nvirConfParseString(virConfParserCtxtPtr ctxt)\n{\n    const char *base;\n    char *ret = NULL;\n\n    if (CUR == '\\'') {\n        NEXT;\n        base = ctxt->cur;\n        while ((ctxt->cur < ctxt->end) && (CUR != '\\'') && (!IS_EOL(CUR)))\n            NEXT;\n        if (CUR != '\\'') {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"unterminated string\"));\n            return NULL;\n        }\n        ret = g_strndup(base, ctxt->cur - base);\n        NEXT;\n    } else if ((ctxt->cur + 6 < ctxt->end) &&\n               (STRPREFIX(ctxt->cur, \"\\\"\\\"\\\"\"))) {\n        /* String starts with python-style triple quotes \"\"\" */\n        ctxt->cur += 3;\n        base = ctxt->cur;\n\n        /* Find the ending triple quotes */\n        while ((ctxt->cur + 2 < ctxt->end) &&\n               !(STRPREFIX(ctxt->cur, \"\\\"\\\"\\\"\"))) {\n            if (CUR == '\\n')\n                ctxt->line++;\n            NEXT;\n        }\n\n        if (!STRPREFIX(ctxt->cur, \"\\\"\\\"\\\"\")) {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"unterminated string\"));\n            return NULL;\n        }\n        ret = g_strndup(base, ctxt->cur - base);\n        ctxt->cur += 3;\n    } else if (CUR == '\"') {\n        NEXT;\n        base = ctxt->cur;\n        while ((ctxt->cur < ctxt->end) && (CUR != '\"') && (!IS_EOL(CUR)))\n            NEXT;\n        if (CUR != '\"') {\n            virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"unterminated string\"));\n            return NULL;\n        }\n        ret = g_strndup(base, ctxt->cur - base);\n        NEXT;\n    } else if (ctxt->conf->flags & VIR_CONF_FLAG_LXC_FORMAT) {\n        base = ctxt->cur;\n        /* LXC config format doesn't support comments after the value */\n        while ((ctxt->cur < ctxt->end) && (!IS_EOL(CUR)))\n            NEXT;\n        /* Reverse to exclude the trailing blanks from the value */\n        while ((ctxt->cur > base) && (IS_BLANK(CUR)))\n            ctxt->cur--;\n        ret = g_strndup(base, ctxt->cur - base);\n    }\n    return ret;\n}"
  },
  {
    "function_name": "virConfParseLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "340-364",
    "snippet": "static int\nvirConfParseLong(virConfParserCtxtPtr ctxt, long long *val)\n{\n    long long l = 0;\n    int neg = 0;\n\n    if (CUR == '-') {\n        neg = 1;\n        NEXT;\n    } else if (CUR == '+') {\n        NEXT;\n    }\n    if ((ctxt->cur >= ctxt->end) || (!g_ascii_isdigit(CUR))) {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"unterminated number\"));\n        return -1;\n    }\n    while ((ctxt->cur < ctxt->end) && (g_ascii_isdigit(CUR))) {\n        l = l * 10 + (CUR - '0');\n        NEXT;\n    }\n    if (neg)\n        l = -l;\n    *val = l;\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;",
      "#define CUR (*ctxt->cur)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_ascii_isdigit",
          "args": [
            "CUR"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "_(\"unterminated number\")"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unterminated number\""
          ],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_ascii_isdigit",
          "args": [
            "CUR"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define NEXT if (ctxt->cur < ctxt->end) ctxt->cur++;\n#define CUR (*ctxt->cur)\n\nstatic int\nvirConfParseLong(virConfParserCtxtPtr ctxt, long long *val)\n{\n    long long l = 0;\n    int neg = 0;\n\n    if (CUR == '-') {\n        neg = 1;\n        NEXT;\n    } else if (CUR == '+') {\n        NEXT;\n    }\n    if ((ctxt->cur >= ctxt->end) || (!g_ascii_isdigit(CUR))) {\n        virConfError(ctxt, VIR_ERR_CONF_SYNTAX, _(\"unterminated number\"));\n        return -1;\n    }\n    while ((ctxt->cur < ctxt->end) && (g_ascii_isdigit(CUR))) {\n        l = l * 10 + (CUR - '0');\n        NEXT;\n    }\n    if (neg)\n        l = -l;\n    *val = l;\n    return 0;\n}"
  },
  {
    "function_name": "virConfSaveEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "311-328",
    "snippet": "static int\nvirConfSaveEntry(virBufferPtr buf, virConfEntryPtr cur)\n{\n    if (cur->name != NULL) {\n        virBufferAdd(buf, cur->name, -1);\n        virBufferAddLit(buf, \" = \");\n        virConfSaveValue(buf, cur->value);\n        if (cur->comment != NULL) {\n            virBufferAddLit(buf, \" #\");\n            virBufferAdd(buf, cur->comment, -1);\n        }\n    } else if (cur->comment != NULL) {\n        virBufferAddLit(buf, \"#\");\n        virBufferAdd(buf, cur->comment, -1);\n    }\n    virBufferAddLit(buf, \"\\n\");\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"\\n\""
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdd",
          "args": [
            "buf",
            "cur->comment",
            "-1"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "156-169",
          "snippet": "void\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"#\""
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\" #\""
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfSaveValue",
          "args": [
            "buf",
            "cur->value"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "virConfSaveValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "250-300",
          "snippet": "static int\nvirConfSaveValue(virBufferPtr buf, virConfValuePtr val)\n{\n    if (val == NULL)\n        return -1;\n    switch (val->type) {\n        case VIR_CONF_NONE:\n            return -1;\n        case VIR_CONF_LLONG:\n            virBufferAsprintf(buf, \"%lld\", val->l);\n            break;\n        case VIR_CONF_ULLONG:\n            virBufferAsprintf(buf, \"%llu\", val->l);\n            break;\n        case VIR_CONF_STRING:\n            if (val->str) {\n                if (strchr(val->str, '\\n') != NULL) {\n                    virBufferAsprintf(buf, \"\\\"\\\"\\\"%s\\\"\\\"\\\"\", val->str);\n                } else if (strchr(val->str, '\"') == NULL) {\n                    virBufferAsprintf(buf, \"\\\"%s\\\"\", val->str);\n                } else if (strchr(val->str, '\\'') == NULL) {\n                    virBufferAsprintf(buf, \"'%s'\", val->str);\n                } else {\n                    virBufferAsprintf(buf, \"\\\"\\\"\\\"%s\\\"\\\"\\\"\", val->str);\n                }\n            }\n            break;\n        case VIR_CONF_LIST: {\n            virConfValuePtr cur;\n\n            cur = val->list;\n            virBufferAddLit(buf, \"[ \");\n            if (cur != NULL) {\n                virConfSaveValue(buf, cur);\n                cur = cur->next;\n                while (cur != NULL) {\n                    virBufferAddLit(buf, \", \");\n                    virConfSaveValue(buf, cur);\n                    cur = cur->next;\n                }\n            }\n            virBufferAddLit(buf, \" ]\");\n            break;\n        }\n        case VIR_CONF_LAST:\n        default:\n            virReportEnumRangeError(virConfType, val->type);\n            return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirConfSaveValue(virBufferPtr buf, virConfValuePtr val)\n{\n    if (val == NULL)\n        return -1;\n    switch (val->type) {\n        case VIR_CONF_NONE:\n            return -1;\n        case VIR_CONF_LLONG:\n            virBufferAsprintf(buf, \"%lld\", val->l);\n            break;\n        case VIR_CONF_ULLONG:\n            virBufferAsprintf(buf, \"%llu\", val->l);\n            break;\n        case VIR_CONF_STRING:\n            if (val->str) {\n                if (strchr(val->str, '\\n') != NULL) {\n                    virBufferAsprintf(buf, \"\\\"\\\"\\\"%s\\\"\\\"\\\"\", val->str);\n                } else if (strchr(val->str, '\"') == NULL) {\n                    virBufferAsprintf(buf, \"\\\"%s\\\"\", val->str);\n                } else if (strchr(val->str, '\\'') == NULL) {\n                    virBufferAsprintf(buf, \"'%s'\", val->str);\n                } else {\n                    virBufferAsprintf(buf, \"\\\"\\\"\\\"%s\\\"\\\"\\\"\", val->str);\n                }\n            }\n            break;\n        case VIR_CONF_LIST: {\n            virConfValuePtr cur;\n\n            cur = val->list;\n            virBufferAddLit(buf, \"[ \");\n            if (cur != NULL) {\n                virConfSaveValue(buf, cur);\n                cur = cur->next;\n                while (cur != NULL) {\n                    virBufferAddLit(buf, \", \");\n                    virConfSaveValue(buf, cur);\n                    cur = cur->next;\n                }\n            }\n            virBufferAddLit(buf, \" ]\");\n            break;\n        }\n        case VIR_CONF_LAST:\n        default:\n            virReportEnumRangeError(virConfType, val->type);\n            return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\" = \""
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirConfSaveEntry(virBufferPtr buf, virConfEntryPtr cur)\n{\n    if (cur->name != NULL) {\n        virBufferAdd(buf, cur->name, -1);\n        virBufferAddLit(buf, \" = \");\n        virConfSaveValue(buf, cur->value);\n        if (cur->comment != NULL) {\n            virBufferAddLit(buf, \" #\");\n            virBufferAdd(buf, cur->comment, -1);\n        }\n    } else if (cur->comment != NULL) {\n        virBufferAddLit(buf, \"#\");\n        virBufferAdd(buf, cur->comment, -1);\n    }\n    virBufferAddLit(buf, \"\\n\");\n    return 0;\n}"
  },
  {
    "function_name": "virConfSaveValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "250-300",
    "snippet": "static int\nvirConfSaveValue(virBufferPtr buf, virConfValuePtr val)\n{\n    if (val == NULL)\n        return -1;\n    switch (val->type) {\n        case VIR_CONF_NONE:\n            return -1;\n        case VIR_CONF_LLONG:\n            virBufferAsprintf(buf, \"%lld\", val->l);\n            break;\n        case VIR_CONF_ULLONG:\n            virBufferAsprintf(buf, \"%llu\", val->l);\n            break;\n        case VIR_CONF_STRING:\n            if (val->str) {\n                if (strchr(val->str, '\\n') != NULL) {\n                    virBufferAsprintf(buf, \"\\\"\\\"\\\"%s\\\"\\\"\\\"\", val->str);\n                } else if (strchr(val->str, '\"') == NULL) {\n                    virBufferAsprintf(buf, \"\\\"%s\\\"\", val->str);\n                } else if (strchr(val->str, '\\'') == NULL) {\n                    virBufferAsprintf(buf, \"'%s'\", val->str);\n                } else {\n                    virBufferAsprintf(buf, \"\\\"\\\"\\\"%s\\\"\\\"\\\"\", val->str);\n                }\n            }\n            break;\n        case VIR_CONF_LIST: {\n            virConfValuePtr cur;\n\n            cur = val->list;\n            virBufferAddLit(buf, \"[ \");\n            if (cur != NULL) {\n                virConfSaveValue(buf, cur);\n                cur = cur->next;\n                while (cur != NULL) {\n                    virBufferAddLit(buf, \", \");\n                    virConfSaveValue(buf, cur);\n                    cur = cur->next;\n                }\n            }\n            virBufferAddLit(buf, \" ]\");\n            break;\n        }\n        case VIR_CONF_LAST:\n        default:\n            virReportEnumRangeError(virConfType, val->type);\n            return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportEnumRangeError",
          "args": [
            "virConfType",
            "val->type"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\" ]\""
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfSaveValue",
          "args": [
            "buf",
            "cur"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "virConfSaveValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "250-300",
          "snippet": "static int\nvirConfSaveValue(virBufferPtr buf, virConfValuePtr val)\n{\n    if (val == NULL)\n        return -1;\n    switch (val->type) {\n        case VIR_CONF_NONE:\n            return -1;\n        case VIR_CONF_LLONG:\n            virBufferAsprintf(buf, \"%lld\", val->l);\n            break;\n        case VIR_CONF_ULLONG:\n            virBufferAsprintf(buf, \"%llu\", val->l);\n            break;\n        case VIR_CONF_STRING:\n            if (val->str) {\n                if (strchr(val->str, '\\n') != NULL) {\n                    virBufferAsprintf(buf, \"\\\"\\\"\\\"%s\\\"\\\"\\\"\", val->str);\n                } else if (strchr(val->str, '\"') == NULL) {\n                    virBufferAsprintf(buf, \"\\\"%s\\\"\", val->str);\n                } else if (strchr(val->str, '\\'') == NULL) {\n                    virBufferAsprintf(buf, \"'%s'\", val->str);\n                } else {\n                    virBufferAsprintf(buf, \"\\\"\\\"\\\"%s\\\"\\\"\\\"\", val->str);\n                }\n            }\n            break;\n        case VIR_CONF_LIST: {\n            virConfValuePtr cur;\n\n            cur = val->list;\n            virBufferAddLit(buf, \"[ \");\n            if (cur != NULL) {\n                virConfSaveValue(buf, cur);\n                cur = cur->next;\n                while (cur != NULL) {\n                    virBufferAddLit(buf, \", \");\n                    virConfSaveValue(buf, cur);\n                    cur = cur->next;\n                }\n            }\n            virBufferAddLit(buf, \" ]\");\n            break;\n        }\n        case VIR_CONF_LAST:\n        default:\n            virReportEnumRangeError(virConfType, val->type);\n            return -1;\n    }\n    return 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\", \""
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"[ \""
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"\\\"\\\"\\\"%s\\\"\\\"\\\"\"",
            "val->str"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "val->str",
            "'\\''"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "val->str",
            "'\"'"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "val->str",
            "'\\n'"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirConfSaveValue(virBufferPtr buf, virConfValuePtr val)\n{\n    if (val == NULL)\n        return -1;\n    switch (val->type) {\n        case VIR_CONF_NONE:\n            return -1;\n        case VIR_CONF_LLONG:\n            virBufferAsprintf(buf, \"%lld\", val->l);\n            break;\n        case VIR_CONF_ULLONG:\n            virBufferAsprintf(buf, \"%llu\", val->l);\n            break;\n        case VIR_CONF_STRING:\n            if (val->str) {\n                if (strchr(val->str, '\\n') != NULL) {\n                    virBufferAsprintf(buf, \"\\\"\\\"\\\"%s\\\"\\\"\\\"\", val->str);\n                } else if (strchr(val->str, '\"') == NULL) {\n                    virBufferAsprintf(buf, \"\\\"%s\\\"\", val->str);\n                } else if (strchr(val->str, '\\'') == NULL) {\n                    virBufferAsprintf(buf, \"'%s'\", val->str);\n                } else {\n                    virBufferAsprintf(buf, \"\\\"\\\"\\\"%s\\\"\\\"\\\"\", val->str);\n                }\n            }\n            break;\n        case VIR_CONF_LIST: {\n            virConfValuePtr cur;\n\n            cur = val->list;\n            virBufferAddLit(buf, \"[ \");\n            if (cur != NULL) {\n                virConfSaveValue(buf, cur);\n                cur = cur->next;\n                while (cur != NULL) {\n                    virBufferAddLit(buf, \", \");\n                    virConfSaveValue(buf, cur);\n                    cur = cur->next;\n                }\n            }\n            virBufferAddLit(buf, \" ]\");\n            break;\n        }\n        case VIR_CONF_LAST:\n        default:\n            virReportEnumRangeError(virConfType, val->type);\n            return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virConfAddEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "208-238",
    "snippet": "static virConfEntryPtr\nvirConfAddEntry(virConfPtr conf, char *name, virConfValuePtr value, char *comm)\n{\n    virConfEntryPtr ret, prev;\n\n    if (conf == NULL)\n        return NULL;\n    if ((comm == NULL) && (name == NULL))\n        return NULL;\n\n    /* don't log fully commented out lines */\n    if (name)\n        VIR_DEBUG(\"Add entry %s %p\", name, value);\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->name = name;\n    ret->value = value;\n    ret->comment = comm;\n\n    if (conf->entries == NULL) {\n        conf->entries = ret;\n    } else {\n        prev = conf->entries;\n        while (prev->next != NULL)\n            prev = prev->next;\n        prev->next = ret;\n    }\n    return ret;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ret"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Add entry %s %p\"",
            "name",
            "value"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virConfEntryPtr\nvirConfAddEntry(virConfPtr conf, char *name, virConfValuePtr value, char *comm)\n{\n    virConfEntryPtr ret, prev;\n\n    if (conf == NULL)\n        return NULL;\n    if ((comm == NULL) && (name == NULL))\n        return NULL;\n\n    /* don't log fully commented out lines */\n    if (name)\n        VIR_DEBUG(\"Add entry %s %p\", name, value);\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->name = name;\n    ret->value = value;\n    ret->comment = comm;\n\n    if (conf->entries == NULL) {\n        conf->entries = ret;\n    } else {\n        prev = conf->entries;\n        while (prev->next != NULL)\n            prev = prev->next;\n        prev->next = ret;\n    }\n    return ret;\n}"
  },
  {
    "function_name": "virConfCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "183-194",
    "snippet": "static virConfPtr\nvirConfCreate(const char *filename, unsigned int flags)\n{\n    virConfPtr ret = virConfNew();\n    if (!ret)\n        return NULL;\n\n    ret->filename = g_strdup(filename);\n\n    ret->flags = flags;\n    return ret;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "filename"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfNew",
          "args": [],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "virConfNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "161-172",
          "snippet": "virConfPtr\nvirConfNew(void)\n{\n    virConfPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n    ret->filename = NULL;\n    ret->flags = 0;\n\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfPtr\nvirConfNew(void)\n{\n    virConfPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n    ret->filename = NULL;\n    ret->flags = 0;\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virConfPtr\nvirConfCreate(const char *filename, unsigned int flags)\n{\n    virConfPtr ret = virConfNew();\n    if (!ret)\n        return NULL;\n\n    ret->filename = g_strdup(filename);\n\n    ret->flags = flags;\n    return ret;\n}"
  },
  {
    "function_name": "virConfNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "161-172",
    "snippet": "virConfPtr\nvirConfNew(void)\n{\n    virConfPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n    ret->filename = NULL;\n    ret->flags = 0;\n\n    return ret;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ret"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfPtr\nvirConfNew(void)\n{\n    virConfPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n    ret->filename = NULL;\n    ret->flags = 0;\n\n    return ret;\n}"
  },
  {
    "function_name": "virConfFreeValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "147-159",
    "snippet": "void\nvirConfFreeValue(virConfValuePtr val)\n{\n    if (val == NULL)\n        return;\n    if (val->type == VIR_CONF_STRING &&\n        val->str != NULL)\n        VIR_FREE(val->str);\n    if (val->type == VIR_CONF_LIST &&\n        val->list != NULL)\n        virConfFreeList(val->list);\n    VIR_FREE(val);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "val"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfFreeList",
          "args": [
            "val->list"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "virConfFreeList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "128-139",
          "snippet": "static void\nvirConfFreeList(virConfValuePtr list)\n{\n    virConfValuePtr next;\n\n    while (list != NULL) {\n        next = list->next;\n        list->next = NULL;\n        virConfFreeValue(list);\n        list = next;\n    }\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirConfFreeList(virConfValuePtr list)\n{\n    virConfValuePtr next;\n\n    while (list != NULL) {\n        next = list->next;\n        list->next = NULL;\n        virConfFreeValue(list);\n        list = next;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "val->str"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirConfFreeValue(virConfValuePtr val)\n{\n    if (val == NULL)\n        return;\n    if (val->type == VIR_CONF_STRING &&\n        val->str != NULL)\n        VIR_FREE(val->str);\n    if (val->type == VIR_CONF_LIST &&\n        val->list != NULL)\n        virConfFreeList(val->list);\n    VIR_FREE(val);\n}"
  },
  {
    "function_name": "virConfFreeList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "128-139",
    "snippet": "static void\nvirConfFreeList(virConfValuePtr list)\n{\n    virConfValuePtr next;\n\n    while (list != NULL) {\n        next = list->next;\n        list->next = NULL;\n        virConfFreeValue(list);\n        list = next;\n    }\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfFreeValue",
          "args": [
            "list"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "virConfFreeValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "147-159",
          "snippet": "void\nvirConfFreeValue(virConfValuePtr val)\n{\n    if (val == NULL)\n        return;\n    if (val->type == VIR_CONF_STRING &&\n        val->str != NULL)\n        VIR_FREE(val->str);\n    if (val->type == VIR_CONF_LIST &&\n        val->list != NULL)\n        virConfFreeList(val->list);\n    VIR_FREE(val);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirConfFreeValue(virConfValuePtr val)\n{\n    if (val == NULL)\n        return;\n    if (val->type == VIR_CONF_STRING &&\n        val->str != NULL)\n        VIR_FREE(val->str);\n    if (val->type == VIR_CONF_LIST &&\n        val->list != NULL)\n        virConfFreeList(val->list);\n    VIR_FREE(val);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirConfFreeList(virConfValuePtr list)\n{\n    virConfValuePtr next;\n\n    while (list != NULL) {\n        next = list->next;\n        list->next = NULL;\n        virConfFreeValue(list);\n        list = next;\n    }\n}"
  },
  {
    "function_name": "virConfErrorHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
    "lines": "103-119",
    "snippet": "static void\nvirConfErrorHelper(const char *file, const char *func, size_t line,\n                   virConfParserCtxtPtr ctxt,\n                   virErrorNumber error, const char *info)\n{\n    if (error == VIR_ERR_OK)\n        return;\n\n    /* Construct the string 'filename:line: info' if we have that. */\n    if (ctxt && ctxt->filename) {\n        virReportErrorHelper(VIR_FROM_CONF, error, file, func, line,\n                             _(\"%s:%d: %s\"), ctxt->filename, ctxt->line, info);\n    } else {\n        virReportErrorHelper(VIR_FROM_CONF, error, file, func, line,\n                             \"%s\", info);\n    }\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportErrorHelper",
          "args": [
            "VIR_FROM_CONF",
            "error",
            "file",
            "func",
            "line",
            "\"%s\"",
            "info"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "virReportErrorHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1282-1308",
          "snippet": "void virReportErrorHelper(int domcode,\n                          int errorcode,\n                          const char *filename,\n                          const char *funcname,\n                          size_t linenr,\n                          const char *fmt, ...)\n{\n    int save_errno = errno;\n    va_list args;\n    char errorMessage[VIR_ERROR_MAX_LENGTH];\n    const char *virerr;\n\n    if (fmt) {\n        va_start(args, fmt);\n        g_vsnprintf(errorMessage, sizeof(errorMessage)-1, fmt, args);\n        va_end(args);\n    } else {\n        errorMessage[0] = '\\0';\n    }\n\n    virerr = virErrorMsg(errorcode, (errorMessage[0] ? errorMessage : NULL));\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, errorcode, VIR_ERR_ERROR,\n                      virerr, errorMessage, NULL,\n                      -1, -1, virerr, errorMessage);\n    errno = save_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virReportErrorHelper(int domcode,\n                          int errorcode,\n                          const char *filename,\n                          const char *funcname,\n                          size_t linenr,\n                          const char *fmt, ...)\n{\n    int save_errno = errno;\n    va_list args;\n    char errorMessage[VIR_ERROR_MAX_LENGTH];\n    const char *virerr;\n\n    if (fmt) {\n        va_start(args, fmt);\n        g_vsnprintf(errorMessage, sizeof(errorMessage)-1, fmt, args);\n        va_end(args);\n    } else {\n        errorMessage[0] = '\\0';\n    }\n\n    virerr = virErrorMsg(errorcode, (errorMessage[0] ? errorMessage : NULL));\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, errorcode, VIR_ERR_ERROR,\n                      virerr, errorMessage, NULL,\n                      -1, -1, virerr, errorMessage);\n    errno = save_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"%s:%d: %s\""
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirConfErrorHelper(const char *file, const char *func, size_t line,\n                   virConfParserCtxtPtr ctxt,\n                   virErrorNumber error, const char *info)\n{\n    if (error == VIR_ERR_OK)\n        return;\n\n    /* Construct the string 'filename:line: info' if we have that. */\n    if (ctxt && ctxt->filename) {\n        virReportErrorHelper(VIR_FROM_CONF, error, file, func, line,\n                             _(\"%s:%d: %s\"), ctxt->filename, ctxt->line, info);\n    } else {\n        virReportErrorHelper(VIR_FROM_CONF, error, file, func, line,\n                             \"%s\", info);\n    }\n}"
  }
]