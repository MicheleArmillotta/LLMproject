[
  {
    "function_name": "virLockDaemonConfigLoadFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_daemon_config.c",
    "lines": "103-120",
    "snippet": "int\nvirLockDaemonConfigLoadFile(virLockDaemonConfigPtr data,\n                            const char *filename,\n                            bool allow_missing)\n{\n    g_autoptr(virConf) conf = NULL;\n\n    if (allow_missing &&\n        access(filename, R_OK) == -1 &&\n        errno == ENOENT)\n        return 0;\n\n    conf = virConfReadFile(filename, 0);\n    if (!conf)\n        return -1;\n\n    return virLockDaemonConfigLoadOptions(data, conf);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"configmake.h\"",
      "#include \"rpc/virnetdaemon.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"lock_daemon_config.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLockDaemonConfigLoadOptions",
          "args": [
            "data",
            "conf"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "virLockDaemonConfigLoadOptions",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_daemon_config.c",
          "lines": "81-97",
          "snippet": "static int\nvirLockDaemonConfigLoadOptions(virLockDaemonConfigPtr data,\n                               virConfPtr conf)\n{\n    if (virConfGetValueUInt(conf, \"log_level\", &data->log_level) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_filters\", &data->log_filters) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_outputs\", &data->log_outputs) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_clients\", &data->max_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_clients\", &data->admin_max_clients) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"configmake.h\"",
            "#include \"rpc/virnetdaemon.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"lock_daemon_config.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"configmake.h\"\n#include \"rpc/virnetdaemon.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"lock_daemon_config.h\"\n#include <config.h>\n\nstatic int\nvirLockDaemonConfigLoadOptions(virLockDaemonConfigPtr data,\n                               virConfPtr conf)\n{\n    if (virConfGetValueUInt(conf, \"log_level\", &data->log_level) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_filters\", &data->log_filters) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_outputs\", &data->log_outputs) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_clients\", &data->max_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_clients\", &data->admin_max_clients) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfReadFile",
          "args": [
            "filename",
            "0"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "virConfReadFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "730-752",
          "snippet": "virConfPtr\nvirConfReadFile(const char *filename, unsigned int flags)\n{\n    char *content;\n    int len;\n    virConfPtr conf;\n\n    VIR_DEBUG(\"filename=%s\", NULLSTR(filename));\n\n    if (filename == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    if ((len = virFileReadAll(filename, MAX_CONFIG_FILE_SIZE, &content)) < 0)\n        return NULL;\n\n    conf = virConfParse(filename, content, len, flags);\n\n    VIR_FREE(content);\n\n    return conf;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_CONFIG_FILE_SIZE (1024*1024*10)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define MAX_CONFIG_FILE_SIZE (1024*1024*10)\n\nvirConfPtr\nvirConfReadFile(const char *filename, unsigned int flags)\n{\n    char *content;\n    int len;\n    virConfPtr conf;\n\n    VIR_DEBUG(\"filename=%s\", NULLSTR(filename));\n\n    if (filename == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    if ((len = virFileReadAll(filename, MAX_CONFIG_FILE_SIZE, &content)) < 0)\n        return NULL;\n\n    conf = virConfParse(filename, content, len, flags);\n\n    VIR_FREE(content);\n\n    return conf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "filename",
            "R_OK"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"configmake.h\"\n#include \"rpc/virnetdaemon.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"lock_daemon_config.h\"\n#include <config.h>\n\nint\nvirLockDaemonConfigLoadFile(virLockDaemonConfigPtr data,\n                            const char *filename,\n                            bool allow_missing)\n{\n    g_autoptr(virConf) conf = NULL;\n\n    if (allow_missing &&\n        access(filename, R_OK) == -1 &&\n        errno == ENOENT)\n        return 0;\n\n    conf = virConfReadFile(filename, 0);\n    if (!conf)\n        return -1;\n\n    return virLockDaemonConfigLoadOptions(data, conf);\n}"
  },
  {
    "function_name": "virLockDaemonConfigLoadOptions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_daemon_config.c",
    "lines": "81-97",
    "snippet": "static int\nvirLockDaemonConfigLoadOptions(virLockDaemonConfigPtr data,\n                               virConfPtr conf)\n{\n    if (virConfGetValueUInt(conf, \"log_level\", &data->log_level) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_filters\", &data->log_filters) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_outputs\", &data->log_outputs) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_clients\", &data->max_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_clients\", &data->admin_max_clients) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"configmake.h\"",
      "#include \"rpc/virnetdaemon.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"lock_daemon_config.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfGetValueUInt",
          "args": [
            "conf",
            "\"admin_max_clients\"",
            "&data->admin_max_clients"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueUInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1099-1128",
          "snippet": "int virConfGetValueUInt(virConfPtr conf,\n                        const char *setting,\n                        unsigned int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value uint %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > UINT_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%u\"),\n                       conf->filename, setting, UINT_MAX);\n        return -1;\n    }\n\n    *value = (unsigned int)cval->l;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueUInt(virConfPtr conf,\n                        const char *setting,\n                        unsigned int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value uint %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > UINT_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%u\"),\n                       conf->filename, setting, UINT_MAX);\n        return -1;\n    }\n\n    *value = (unsigned int)cval->l;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "conf",
            "\"log_outputs\"",
            "&data->log_outputs"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"configmake.h\"\n#include \"rpc/virnetdaemon.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"lock_daemon_config.h\"\n#include <config.h>\n\nstatic int\nvirLockDaemonConfigLoadOptions(virLockDaemonConfigPtr data,\n                               virConfPtr conf)\n{\n    if (virConfGetValueUInt(conf, \"log_level\", &data->log_level) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_filters\", &data->log_filters) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_outputs\", &data->log_outputs) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_clients\", &data->max_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_clients\", &data->admin_max_clients) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virLockDaemonConfigFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_daemon_config.c",
    "lines": "69-79",
    "snippet": "void\nvirLockDaemonConfigFree(virLockDaemonConfigPtr data)\n{\n    if (!data)\n        return;\n\n    VIR_FREE(data->log_filters);\n    VIR_FREE(data->log_outputs);\n\n    VIR_FREE(data);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"configmake.h\"",
      "#include \"rpc/virnetdaemon.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"lock_daemon_config.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->log_outputs"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->log_filters"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"configmake.h\"\n#include \"rpc/virnetdaemon.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"lock_daemon_config.h\"\n#include <config.h>\n\nvoid\nvirLockDaemonConfigFree(virLockDaemonConfigPtr data)\n{\n    if (!data)\n        return;\n\n    VIR_FREE(data->log_filters);\n    VIR_FREE(data->log_outputs);\n\n    VIR_FREE(data);\n}"
  },
  {
    "function_name": "virLockDaemonConfigNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_daemon_config.c",
    "lines": "55-67",
    "snippet": "virLockDaemonConfigPtr\nvirLockDaemonConfigNew(bool privileged G_GNUC_UNUSED)\n{\n    virLockDaemonConfigPtr data;\n\n    if (VIR_ALLOC(data) < 0)\n        return NULL;\n\n    data->max_clients = 1024;\n    data->admin_max_clients = 5000;\n\n    return data;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"configmake.h\"",
      "#include \"rpc/virnetdaemon.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"lock_daemon_config.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "data"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"configmake.h\"\n#include \"rpc/virnetdaemon.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"lock_daemon_config.h\"\n#include <config.h>\n\nvirLockDaemonConfigPtr\nvirLockDaemonConfigNew(bool privileged G_GNUC_UNUSED)\n{\n    virLockDaemonConfigPtr data;\n\n    if (VIR_ALLOC(data) < 0)\n        return NULL;\n\n    data->max_clients = 1024;\n    data->admin_max_clients = 5000;\n\n    return data;\n}"
  },
  {
    "function_name": "virLockDaemonConfigFilePath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_daemon_config.c",
    "lines": "38-52",
    "snippet": "int\nvirLockDaemonConfigFilePath(bool privileged, char **configfile)\n{\n    if (privileged) {\n        *configfile = g_strdup(SYSCONFDIR \"/libvirt/virtlockd.conf\");\n    } else {\n        g_autofree char *configdir = NULL;\n\n        configdir = virGetUserConfigDirectory();\n\n        *configfile = g_strdup_printf(\"%s/virtlockd.conf\", configdir);\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"configmake.h\"",
      "#include \"rpc/virnetdaemon.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"lock_daemon_config.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/virtlockd.conf\"",
            "configdir"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUserConfigDirectory",
          "args": [],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserConfigDirectory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "574-581",
          "snippet": "char *virGetUserConfigDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_config_dir());\n#else\n    return g_build_filename(g_get_user_config_dir(), \"libvirt\", NULL);\n#endif\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virGetUserConfigDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_config_dir());\n#else\n    return g_build_filename(g_get_user_config_dir(), \"libvirt\", NULL);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"configmake.h\"\n#include \"rpc/virnetdaemon.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"lock_daemon_config.h\"\n#include <config.h>\n\nint\nvirLockDaemonConfigFilePath(bool privileged, char **configfile)\n{\n    if (privileged) {\n        *configfile = g_strdup(SYSCONFDIR \"/libvirt/virtlockd.conf\");\n    } else {\n        g_autofree char *configdir = NULL;\n\n        configdir = virGetUserConfigDirectory();\n\n        *configfile = g_strdup_printf(\"%s/virtlockd.conf\", configdir);\n    }\n\n    return 0;\n}"
  }
]