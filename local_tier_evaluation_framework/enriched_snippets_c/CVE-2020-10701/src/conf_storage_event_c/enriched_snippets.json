[
  {
    "function_name": "virStoragePoolEventRefreshNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
    "lines": "279-297",
    "snippet": "virObjectEventPtr\nvirStoragePoolEventRefreshNew(const char *name,\n                              const unsigned char *uuid)\n{\n    virStoragePoolEventRefreshPtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventRefreshClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_REFRESH,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    return (virObjectEventPtr)event;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"storage_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virStoragePoolEventRefreshClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventNew",
          "args": [
            "virStoragePoolEventRefreshClass",
            "virStoragePoolEventDispatchDefaultFunc",
            "VIR_STORAGE_POOL_EVENT_ID_REFRESH",
            "0",
            "name",
            "uuid",
            "uuidstr"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "597-633",
          "snippet": "void *\nvirObjectEventNew(virClassPtr klass,\n                  virObjectEventDispatchFunc dispatcher,\n                  int eventID,\n                  int id,\n                  const char *name,\n                  const unsigned char *uuid,\n                  const char *key)\n{\n    virObjectEventPtr event;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!virClassIsDerivedFrom(klass, virObjectEventClass)) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectEvent\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(event = virObjectNew(klass)))\n        return NULL;\n\n    event->dispatch = dispatcher;\n    event->eventID = eventID;\n    event->remoteID = -1;\n\n    event->meta.name = g_strdup(name);\n    event->meta.key = g_strdup(key);\n    event->meta.id = id;\n    if (uuid)\n        memcpy(event->meta.uuid, uuid, VIR_UUID_BUFLEN);\n\n    VIR_DEBUG(\"obj=%p\", event);\n    return event;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectEventClass;",
            "static void virObjectEventDispose(void *obj);",
            "static void virObjectEventStateDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectEventClass;\nstatic void virObjectEventDispose(void *obj);\nstatic void virObjectEventStateDispose(void *obj);\n\nvoid *\nvirObjectEventNew(virClassPtr klass,\n                  virObjectEventDispatchFunc dispatcher,\n                  int eventID,\n                  int id,\n                  const char *name,\n                  const unsigned char *uuid,\n                  const char *key)\n{\n    virObjectEventPtr event;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!virClassIsDerivedFrom(klass, virObjectEventClass)) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectEvent\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(event = virObjectNew(klass)))\n        return NULL;\n\n    event->dispatch = dispatcher;\n    event->eventID = eventID;\n    event->remoteID = -1;\n\n    event->meta.name = g_strdup(name);\n    event->meta.key = g_strdup(key);\n    event->meta.id = id;\n    if (uuid)\n        memcpy(event->meta.uuid, uuid, VIR_UUID_BUFLEN);\n\n    VIR_DEBUG(\"obj=%p\", event);\n    return event;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "uuid",
            "uuidstr"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolEventsInitialize",
          "args": [],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolEventRefreshClass;\n\nvirObjectEventPtr\nvirStoragePoolEventRefreshNew(const char *name,\n                              const unsigned char *uuid)\n{\n    virStoragePoolEventRefreshPtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventRefreshClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_REFRESH,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    return (virObjectEventPtr)event;\n}"
  },
  {
    "function_name": "virStoragePoolEventLifecycleNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
    "lines": "246-269",
    "snippet": "virObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"storage_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virStoragePoolEventLifecycleClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventNew",
          "args": [
            "virStoragePoolEventLifecycleClass",
            "virStoragePoolEventDispatchDefaultFunc",
            "VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE",
            "0",
            "name",
            "uuid",
            "uuidstr"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "597-633",
          "snippet": "void *\nvirObjectEventNew(virClassPtr klass,\n                  virObjectEventDispatchFunc dispatcher,\n                  int eventID,\n                  int id,\n                  const char *name,\n                  const unsigned char *uuid,\n                  const char *key)\n{\n    virObjectEventPtr event;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!virClassIsDerivedFrom(klass, virObjectEventClass)) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectEvent\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(event = virObjectNew(klass)))\n        return NULL;\n\n    event->dispatch = dispatcher;\n    event->eventID = eventID;\n    event->remoteID = -1;\n\n    event->meta.name = g_strdup(name);\n    event->meta.key = g_strdup(key);\n    event->meta.id = id;\n    if (uuid)\n        memcpy(event->meta.uuid, uuid, VIR_UUID_BUFLEN);\n\n    VIR_DEBUG(\"obj=%p\", event);\n    return event;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectEventClass;",
            "static void virObjectEventDispose(void *obj);",
            "static void virObjectEventStateDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectEventClass;\nstatic void virObjectEventDispose(void *obj);\nstatic void virObjectEventStateDispose(void *obj);\n\nvoid *\nvirObjectEventNew(virClassPtr klass,\n                  virObjectEventDispatchFunc dispatcher,\n                  int eventID,\n                  int id,\n                  const char *name,\n                  const unsigned char *uuid,\n                  const char *key)\n{\n    virObjectEventPtr event;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!virClassIsDerivedFrom(klass, virObjectEventClass)) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectEvent\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(event = virObjectNew(klass)))\n        return NULL;\n\n    event->dispatch = dispatcher;\n    event->eventID = eventID;\n    event->remoteID = -1;\n\n    event->meta.name = g_strdup(name);\n    event->meta.key = g_strdup(key);\n    event->meta.id = id;\n    if (uuid)\n        memcpy(event->meta.uuid, uuid, VIR_UUID_BUFLEN);\n\n    VIR_DEBUG(\"obj=%p\", event);\n    return event;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "uuid",
            "uuidstr"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolEventsInitialize",
          "args": [],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolEventLifecycleClass;\n\nvirObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}"
  },
  {
    "function_name": "virStoragePoolEventStateRegisterClient",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
    "lines": "211-234",
    "snippet": "int\nvirStoragePoolEventStateRegisterClient(virConnectPtr conn,\n                                       virObjectEventStatePtr state,\n                                       virStoragePoolPtr pool,\n                                       int eventID,\n                                       virConnectStoragePoolEventGenericCallback cb,\n                                       void *opaque,\n                                       virFreeCallback freecb,\n                                       int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return -1;\n\n    if (pool)\n        virUUIDFormat(pool->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, pool ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virStoragePoolEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, true);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"storage_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virStoragePoolEventClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateRegisterID",
          "args": [
            "conn",
            "state",
            "pool ? uuidstr : NULL",
            "NULL",
            "NULL",
            "virStoragePoolEventClass",
            "eventID",
            "VIR_OBJECT_EVENT_CALLBACK(cb)",
            "opaque",
            "freecb",
            "false",
            "callbackID",
            "true"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateRegisterID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "870-917",
          "snippet": "int\nvirObjectEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              const char *key,\n                              virObjectEventCallbackFilter filter,\n                              void *filter_opaque,\n                              virClassPtr klass,\n                              int eventID,\n                              virConnectObjectEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              bool legacy,\n                              int *callbackID,\n                              bool serverFilter)\n{\n    int ret = -1;\n\n    virObjectLock(state);\n\n    if ((state->callbacks->count == 0) &&\n        (state->timer == -1)) {\n        if ((state->timer = virEventAddTimeout(-1,\n                                               virObjectEventTimer,\n                                               state,\n                                               virObjectFreeCallback)) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not initialize domain event timer\"));\n            goto cleanup;\n        }\n\n        /* event loop has one reference, but we need one more for the\n         * timer's opaque argument */\n        virObjectRef(state);\n    }\n\n    ret = virObjectEventCallbackListAddID(conn, state->callbacks,\n                                          key, filter, filter_opaque,\n                                          klass, eventID,\n                                          cb, opaque, freecb,\n                                          legacy, callbackID, serverFilter);\n\n    if (ret < 0)\n        virObjectEventStateCleanupTimer(state, false);\n\n cleanup:\n    virObjectUnlock(state);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nint\nvirObjectEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              const char *key,\n                              virObjectEventCallbackFilter filter,\n                              void *filter_opaque,\n                              virClassPtr klass,\n                              int eventID,\n                              virConnectObjectEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              bool legacy,\n                              int *callbackID,\n                              bool serverFilter)\n{\n    int ret = -1;\n\n    virObjectLock(state);\n\n    if ((state->callbacks->count == 0) &&\n        (state->timer == -1)) {\n        if ((state->timer = virEventAddTimeout(-1,\n                                               virObjectEventTimer,\n                                               state,\n                                               virObjectFreeCallback)) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not initialize domain event timer\"));\n            goto cleanup;\n        }\n\n        /* event loop has one reference, but we need one more for the\n         * timer's opaque argument */\n        virObjectRef(state);\n    }\n\n    ret = virObjectEventCallbackListAddID(conn, state->callbacks,\n                                          key, filter, filter_opaque,\n                                          klass, eventID,\n                                          cb, opaque, freecb,\n                                          legacy, callbackID, serverFilter);\n\n    if (ret < 0)\n        virObjectEventStateCleanupTimer(state, false);\n\n cleanup:\n    virObjectUnlock(state);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_OBJECT_EVENT_CALLBACK",
          "args": [
            "cb"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "pool->uuid",
            "uuidstr"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolEventsInitialize",
          "args": [],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolEventClass;\n\nint\nvirStoragePoolEventStateRegisterClient(virConnectPtr conn,\n                                       virObjectEventStatePtr state,\n                                       virStoragePoolPtr pool,\n                                       int eventID,\n                                       virConnectStoragePoolEventGenericCallback cb,\n                                       void *opaque,\n                                       virFreeCallback freecb,\n                                       int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return -1;\n\n    if (pool)\n        virUUIDFormat(pool->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, pool ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virStoragePoolEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, true);\n}"
  },
  {
    "function_name": "virStoragePoolEventStateRegisterID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
    "lines": "167-190",
    "snippet": "int\nvirStoragePoolEventStateRegisterID(virConnectPtr conn,\n                                   virObjectEventStatePtr state,\n                                   virStoragePoolPtr pool,\n                                   int eventID,\n                                   virConnectStoragePoolEventGenericCallback cb,\n                                   void *opaque,\n                                   virFreeCallback freecb,\n                                   int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return -1;\n\n    if (pool)\n        virUUIDFormat(pool->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, pool ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virStoragePoolEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, false);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"storage_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virStoragePoolEventClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateRegisterID",
          "args": [
            "conn",
            "state",
            "pool ? uuidstr : NULL",
            "NULL",
            "NULL",
            "virStoragePoolEventClass",
            "eventID",
            "VIR_OBJECT_EVENT_CALLBACK(cb)",
            "opaque",
            "freecb",
            "false",
            "callbackID",
            "false"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateRegisterID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "870-917",
          "snippet": "int\nvirObjectEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              const char *key,\n                              virObjectEventCallbackFilter filter,\n                              void *filter_opaque,\n                              virClassPtr klass,\n                              int eventID,\n                              virConnectObjectEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              bool legacy,\n                              int *callbackID,\n                              bool serverFilter)\n{\n    int ret = -1;\n\n    virObjectLock(state);\n\n    if ((state->callbacks->count == 0) &&\n        (state->timer == -1)) {\n        if ((state->timer = virEventAddTimeout(-1,\n                                               virObjectEventTimer,\n                                               state,\n                                               virObjectFreeCallback)) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not initialize domain event timer\"));\n            goto cleanup;\n        }\n\n        /* event loop has one reference, but we need one more for the\n         * timer's opaque argument */\n        virObjectRef(state);\n    }\n\n    ret = virObjectEventCallbackListAddID(conn, state->callbacks,\n                                          key, filter, filter_opaque,\n                                          klass, eventID,\n                                          cb, opaque, freecb,\n                                          legacy, callbackID, serverFilter);\n\n    if (ret < 0)\n        virObjectEventStateCleanupTimer(state, false);\n\n cleanup:\n    virObjectUnlock(state);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nint\nvirObjectEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              const char *key,\n                              virObjectEventCallbackFilter filter,\n                              void *filter_opaque,\n                              virClassPtr klass,\n                              int eventID,\n                              virConnectObjectEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              bool legacy,\n                              int *callbackID,\n                              bool serverFilter)\n{\n    int ret = -1;\n\n    virObjectLock(state);\n\n    if ((state->callbacks->count == 0) &&\n        (state->timer == -1)) {\n        if ((state->timer = virEventAddTimeout(-1,\n                                               virObjectEventTimer,\n                                               state,\n                                               virObjectFreeCallback)) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not initialize domain event timer\"));\n            goto cleanup;\n        }\n\n        /* event loop has one reference, but we need one more for the\n         * timer's opaque argument */\n        virObjectRef(state);\n    }\n\n    ret = virObjectEventCallbackListAddID(conn, state->callbacks,\n                                          key, filter, filter_opaque,\n                                          klass, eventID,\n                                          cb, opaque, freecb,\n                                          legacy, callbackID, serverFilter);\n\n    if (ret < 0)\n        virObjectEventStateCleanupTimer(state, false);\n\n cleanup:\n    virObjectUnlock(state);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_OBJECT_EVENT_CALLBACK",
          "args": [
            "cb"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "pool->uuid",
            "uuidstr"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolEventsInitialize",
          "args": [],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolEventClass;\n\nint\nvirStoragePoolEventStateRegisterID(virConnectPtr conn,\n                                   virObjectEventStatePtr state,\n                                   virStoragePoolPtr pool,\n                                   int eventID,\n                                   virConnectStoragePoolEventGenericCallback cb,\n                                   void *opaque,\n                                   virFreeCallback freecb,\n                                   int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return -1;\n\n    if (pool)\n        virUUIDFormat(pool->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, pool ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virStoragePoolEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, false);\n}"
  },
  {
    "function_name": "virStoragePoolEventDispatchDefaultFunc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
    "lines": "107-147",
    "snippet": "static void\nvirStoragePoolEventDispatchDefaultFunc(virConnectPtr conn,\n                                       virObjectEventPtr event,\n                                       virConnectObjectEventGenericCallback cb,\n                                       void *cbopaque)\n{\n    virStoragePoolPtr pool = virGetStoragePool(conn,\n                                               event->meta.name,\n                                               event->meta.uuid,\n                                               NULL, NULL);\n    if (!pool)\n        return;\n\n    switch ((virStoragePoolEventID)event->eventID) {\n    case VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE:\n        {\n            virStoragePoolEventLifecyclePtr storagePoolLifecycleEvent;\n\n            storagePoolLifecycleEvent = (virStoragePoolEventLifecyclePtr)event;\n            ((virConnectStoragePoolEventLifecycleCallback)cb)(conn, pool,\n                                                              storagePoolLifecycleEvent->type,\n                                                              storagePoolLifecycleEvent->detail,\n                                                              cbopaque);\n            goto cleanup;\n        }\n\n    case VIR_STORAGE_POOL_EVENT_ID_REFRESH:\n        {\n            ((virConnectStoragePoolEventGenericCallback)cb)(conn, pool,\n                                                            cbopaque);\n            goto cleanup;\n        }\n\n    case VIR_STORAGE_POOL_EVENT_ID_LAST:\n        break;\n    }\n    VIR_WARN(\"Unexpected event ID %d\", event->eventID);\n\n cleanup:\n    virObjectUnref(pool);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"storage_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "pool"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unexpected event ID %d\"",
            "event->eventID"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "conn",
            "pool",
            "cbopaque"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "conn",
            "pool",
            "storagePoolLifecycleEvent->type",
            "storagePoolLifecycleEvent->detail",
            "cbopaque"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetStoragePool",
          "args": [
            "conn",
            "event->meta.name",
            "event->meta.uuid",
            "NULL",
            "NULL"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "virGetStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "525-556",
          "snippet": "virStoragePoolPtr\nvirGetStoragePool(virConnectPtr conn, const char *name,\n                  const unsigned char *uuid,\n                  void *privateData, virFreeCallback freeFunc)\n{\n    virStoragePoolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virStoragePoolClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    /* set the driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virStoragePoolClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virStoragePoolClass;\n\nvirStoragePoolPtr\nvirGetStoragePool(virConnectPtr conn, const char *name,\n                  const unsigned char *uuid,\n                  void *privateData, virFreeCallback freeFunc)\n{\n    virStoragePoolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virStoragePoolClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    /* set the driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic void\nvirStoragePoolEventDispatchDefaultFunc(virConnectPtr conn,\n                                       virObjectEventPtr event,\n                                       virConnectObjectEventGenericCallback cb,\n                                       void *cbopaque)\n{\n    virStoragePoolPtr pool = virGetStoragePool(conn,\n                                               event->meta.name,\n                                               event->meta.uuid,\n                                               NULL, NULL);\n    if (!pool)\n        return;\n\n    switch ((virStoragePoolEventID)event->eventID) {\n    case VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE:\n        {\n            virStoragePoolEventLifecyclePtr storagePoolLifecycleEvent;\n\n            storagePoolLifecycleEvent = (virStoragePoolEventLifecyclePtr)event;\n            ((virConnectStoragePoolEventLifecycleCallback)cb)(conn, pool,\n                                                              storagePoolLifecycleEvent->type,\n                                                              storagePoolLifecycleEvent->detail,\n                                                              cbopaque);\n            goto cleanup;\n        }\n\n    case VIR_STORAGE_POOL_EVENT_ID_REFRESH:\n        {\n            ((virConnectStoragePoolEventGenericCallback)cb)(conn, pool,\n                                                            cbopaque);\n            goto cleanup;\n        }\n\n    case VIR_STORAGE_POOL_EVENT_ID_LAST:\n        break;\n    }\n    VIR_WARN(\"Unexpected event ID %d\", event->eventID);\n\n cleanup:\n    virObjectUnref(pool);\n}"
  },
  {
    "function_name": "virStoragePoolEventRefreshDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
    "lines": "99-104",
    "snippet": "static void\nvirStoragePoolEventRefreshDispose(void *obj)\n{\n    virStoragePoolEventRefreshPtr event = obj;\n    VIR_DEBUG(\"obj=%p\", event);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"storage_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virStoragePoolEventDispose(void *obj);",
      "static void virStoragePoolEventLifecycleDispose(void *obj);",
      "static void virStoragePoolEventRefreshDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"obj=%p\"",
            "event"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic void virStoragePoolEventDispose(void *obj);\nstatic void virStoragePoolEventLifecycleDispose(void *obj);\nstatic void virStoragePoolEventRefreshDispose(void *obj);\n\nstatic void\nvirStoragePoolEventRefreshDispose(void *obj)\n{\n    virStoragePoolEventRefreshPtr event = obj;\n    VIR_DEBUG(\"obj=%p\", event);\n}"
  },
  {
    "function_name": "virStoragePoolEventLifecycleDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
    "lines": "91-96",
    "snippet": "static void\nvirStoragePoolEventLifecycleDispose(void *obj)\n{\n    virStoragePoolEventLifecyclePtr event = obj;\n    VIR_DEBUG(\"obj=%p\", event);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"storage_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virStoragePoolEventDispose(void *obj);",
      "static void virStoragePoolEventLifecycleDispose(void *obj);",
      "static void virStoragePoolEventRefreshDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"obj=%p\"",
            "event"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic void virStoragePoolEventDispose(void *obj);\nstatic void virStoragePoolEventLifecycleDispose(void *obj);\nstatic void virStoragePoolEventRefreshDispose(void *obj);\n\nstatic void\nvirStoragePoolEventLifecycleDispose(void *obj)\n{\n    virStoragePoolEventLifecyclePtr event = obj;\n    VIR_DEBUG(\"obj=%p\", event);\n}"
  },
  {
    "function_name": "virStoragePoolEventDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
    "lines": "83-88",
    "snippet": "static void\nvirStoragePoolEventDispose(void *obj)\n{\n    virStoragePoolEventPtr event = obj;\n    VIR_DEBUG(\"obj=%p\", event);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"storage_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virStoragePoolEventDispose(void *obj);",
      "static void virStoragePoolEventLifecycleDispose(void *obj);",
      "static void virStoragePoolEventRefreshDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"obj=%p\"",
            "event"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic void virStoragePoolEventDispose(void *obj);\nstatic void virStoragePoolEventLifecycleDispose(void *obj);\nstatic void virStoragePoolEventRefreshDispose(void *obj);\n\nstatic void\nvirStoragePoolEventDispose(void *obj)\n{\n    virStoragePoolEventPtr event = obj;\n    VIR_DEBUG(\"obj=%p\", event);\n}"
  },
  {
    "function_name": "virStoragePoolEventsOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
    "lines": "66-79",
    "snippet": "static int\nvirStoragePoolEventsOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virStoragePoolEvent, virClassForObjectEvent()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virStoragePoolEventLifecycle, virStoragePoolEventClass))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virStoragePoolEventRefresh, virStoragePoolEventClass))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"storage_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virStoragePoolEventClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virStoragePoolEventRefresh",
            "virStoragePoolEventClass"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virStoragePoolEventLifecycle",
            "virStoragePoolEventClass"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virStoragePoolEvent",
            "virClassForObjectEvent()"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectEvent",
          "args": [],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectEvent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "110-116",
          "snippet": "virClassPtr\nvirClassForObjectEvent(void)\n{\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n    return virObjectEventClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectEventClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectEventClass;\n\nvirClassPtr\nvirClassForObjectEvent(void)\n{\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n    return virObjectEventClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolEventClass;\n\nstatic int\nvirStoragePoolEventsOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virStoragePoolEvent, virClassForObjectEvent()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virStoragePoolEventLifecycle, virStoragePoolEventClass))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virStoragePoolEventRefresh, virStoragePoolEventClass))\n        return -1;\n\n    return 0;\n}"
  }
]