[
  {
    "function_name": "virTypedParamsFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "878-884",
    "snippet": "void\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "params"
          ],
          "line": 883
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsClear",
          "args": [
            "params",
            "nparams"
          ],
          "line": 882
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "852-865",
          "snippet": "void\nvirTypedParamsClear(virTypedParameterPtr params,\n                    int nparams)\n{\n    size_t i;\n\n    if (!params)\n        return;\n\n    for (i = 0; i < nparams; i++) {\n        if (params[i].type == VIR_TYPED_PARAM_STRING)\n            VIR_FREE(params[i].value.s);\n    }\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvoid\nvirTypedParamsClear(virTypedParameterPtr params,\n                    int nparams)\n{\n    size_t i;\n\n    if (!params)\n        return;\n\n    for (i = 0; i < nparams; i++) {\n        if (params[i].type == VIR_TYPED_PARAM_STRING)\n            VIR_FREE(params[i].value.s);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvoid\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}"
  },
  {
    "function_name": "virTypedParamsClear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "852-865",
    "snippet": "void\nvirTypedParamsClear(virTypedParameterPtr params,\n                    int nparams)\n{\n    size_t i;\n\n    if (!params)\n        return;\n\n    for (i = 0; i < nparams; i++) {\n        if (params[i].type == VIR_TYPED_PARAM_STRING)\n            VIR_FREE(params[i].value.s);\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "params[i].value.s"
          ],
          "line": 863
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvoid\nvirTypedParamsClear(virTypedParameterPtr params,\n                    int nparams)\n{\n    size_t i;\n\n    if (!params)\n        return;\n\n    for (i = 0; i < nparams; i++) {\n        if (params[i].type == VIR_TYPED_PARAM_STRING)\n            VIR_FREE(params[i].value.s);\n    }\n}"
  },
  {
    "function_name": "virTypedParamsAddFromString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "813-839",
    "snippet": "int\nvirTypedParamsAddFromString(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            int type,\n                            const char *value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssignFromStr(*params + n, name, type, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 837
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssignFromStr",
          "args": [
            "*params + n",
            "name",
            "type",
            "value"
          ],
          "line": 830
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssignFromStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "31-116",
          "snippet": "static int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "*params",
            "max",
            "n",
            "1"
          ],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 824
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddFromString(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            int type,\n                            const char *value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssignFromStr(*params + n, name, type, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virTypedParamsAddStringList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "768-788",
    "snippet": "int\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsAddString",
          "args": [
            "params",
            "nparams",
            "maxparams",
            "name",
            "values[i]"
          ],
          "line": 782
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "768-788",
          "snippet": "int\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}"
  },
  {
    "function_name": "virTypedParamsAddString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "721-752",
    "snippet": "int\nvirTypedParamsAddString(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        const char *value)\n{\n    char *str = NULL;\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    str = g_strdup(value);\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_STRING, str) < 0) {\n        VIR_FREE(str);\n        goto error;\n    }\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 750
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "str"
          ],
          "line": 742
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssign",
          "args": [
            "*params + n",
            "name",
            "VIR_TYPED_PARAM_STRING",
            "str"
          ],
          "line": 740
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssignFromStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "31-116",
          "snippet": "static int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "value"
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "*params",
            "max",
            "n",
            "1"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddString(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        const char *value)\n{\n    char *str = NULL;\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    str = g_strdup(value);\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_STRING, str) < 0) {\n        VIR_FREE(str);\n        goto error;\n    }\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virTypedParamsAddBoolean",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "672-698",
    "snippet": "int\nvirTypedParamsAddBoolean(virTypedParameterPtr *params,\n                         int *nparams,\n                         int *maxparams,\n                         const char *name,\n                         int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_BOOLEAN, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 696
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssign",
          "args": [
            "*params + n",
            "name",
            "VIR_TYPED_PARAM_BOOLEAN",
            "value"
          ],
          "line": 688
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssignFromStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "31-116",
          "snippet": "static int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "*params",
            "max",
            "n",
            "1"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddBoolean(virTypedParameterPtr *params,\n                         int *nparams,\n                         int *maxparams,\n                         const char *name,\n                         int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_BOOLEAN, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virTypedParamsAddDouble",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "625-651",
    "snippet": "int\nvirTypedParamsAddDouble(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        double value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_DOUBLE, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 649
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssign",
          "args": [
            "*params + n",
            "name",
            "VIR_TYPED_PARAM_DOUBLE",
            "value"
          ],
          "line": 641
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssignFromStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "31-116",
          "snippet": "static int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "*params",
            "max",
            "n",
            "1"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddDouble(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        double value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_DOUBLE, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virTypedParamsAddULLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "578-604",
    "snippet": "int\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssign",
          "args": [
            "*params + n",
            "name",
            "VIR_TYPED_PARAM_ULLONG",
            "value"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssignFromStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "31-116",
          "snippet": "static int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "*params",
            "max",
            "n",
            "1"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virTypedParamsAddLLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "531-557",
    "snippet": "int\nvirTypedParamsAddLLong(virTypedParameterPtr *params,\n                       int *nparams,\n                       int *maxparams,\n                       const char *name,\n                       long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_LLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssign",
          "args": [
            "*params + n",
            "name",
            "VIR_TYPED_PARAM_LLONG",
            "value"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssignFromStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "31-116",
          "snippet": "static int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "*params",
            "max",
            "n",
            "1"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddLLong(virTypedParameterPtr *params,\n                       int *nparams,\n                       int *maxparams,\n                       const char *name,\n                       long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_LLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virTypedParamsAddUInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "484-510",
    "snippet": "int\nvirTypedParamsAddUInt(virTypedParameterPtr *params,\n                      int *nparams,\n                      int *maxparams,\n                      const char *name,\n                      unsigned int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_UINT, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssign",
          "args": [
            "*params + n",
            "name",
            "VIR_TYPED_PARAM_UINT",
            "value"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssignFromStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "31-116",
          "snippet": "static int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "*params",
            "max",
            "n",
            "1"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddUInt(virTypedParameterPtr *params,\n                      int *nparams,\n                      int *maxparams,\n                      const char *name,\n                      unsigned int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_UINT, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virTypedParamsAddInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "437-463",
    "snippet": "int\nvirTypedParamsAddInt(virTypedParameterPtr *params,\n                     int *nparams,\n                     int *maxparams,\n                     const char *name,\n                     int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_INT, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssign",
          "args": [
            "*params + n",
            "name",
            "VIR_TYPED_PARAM_INT",
            "value"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssignFromStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "31-116",
          "snippet": "static int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "*params",
            "max",
            "n",
            "1"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddInt(virTypedParameterPtr *params,\n                     int *nparams,\n                     int *maxparams,\n                     const char *name,\n                     int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_INT, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virTypedParamsGetString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "398-416",
    "snippet": "int\nvirTypedParamsGetString(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        const char **value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_STRING);\n    if (value)\n        *value = param->value.s;\n\n    return 1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAM_CHECK_TYPE",
          "args": [
            "VIR_TYPED_PARAM_STRING"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "params",
            "nparams",
            "name"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetString(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        const char **value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_STRING);\n    if (value)\n        *value = param->value.s;\n\n    return 1;\n}"
  },
  {
    "function_name": "virTypedParamsGetBoolean",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "360-378",
    "snippet": "int\nvirTypedParamsGetBoolean(virTypedParameterPtr params,\n                         int nparams,\n                         const char *name,\n                         int *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_BOOLEAN);\n    if (value)\n        *value = !!param->value.b;\n\n    return 1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAM_CHECK_TYPE",
          "args": [
            "VIR_TYPED_PARAM_BOOLEAN"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "params",
            "nparams",
            "name"
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetBoolean(virTypedParameterPtr params,\n                         int nparams,\n                         const char *name,\n                         int *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_BOOLEAN);\n    if (value)\n        *value = !!param->value.b;\n\n    return 1;\n}"
  },
  {
    "function_name": "virTypedParamsGetDouble",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "324-342",
    "snippet": "int\nvirTypedParamsGetDouble(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        double *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_DOUBLE);\n    if (value)\n        *value = param->value.d;\n\n    return 1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAM_CHECK_TYPE",
          "args": [
            "VIR_TYPED_PARAM_DOUBLE"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "params",
            "nparams",
            "name"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetDouble(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        double *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_DOUBLE);\n    if (value)\n        *value = param->value.d;\n\n    return 1;\n}"
  },
  {
    "function_name": "virTypedParamsGetULLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "288-306",
    "snippet": "int\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAM_CHECK_TYPE",
          "args": [
            "VIR_TYPED_PARAM_ULLONG"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "params",
            "nparams",
            "name"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}"
  },
  {
    "function_name": "virTypedParamsGetLLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "252-270",
    "snippet": "int\nvirTypedParamsGetLLong(virTypedParameterPtr params,\n                       int nparams,\n                       const char *name,\n                       long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_LLONG);\n    if (value)\n        *value = param->value.l;\n\n    return 1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAM_CHECK_TYPE",
          "args": [
            "VIR_TYPED_PARAM_LLONG"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "params",
            "nparams",
            "name"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetLLong(virTypedParameterPtr params,\n                       int nparams,\n                       const char *name,\n                       long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_LLONG);\n    if (value)\n        *value = param->value.l;\n\n    return 1;\n}"
  },
  {
    "function_name": "virTypedParamsGetUInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "216-234",
    "snippet": "int\nvirTypedParamsGetUInt(virTypedParameterPtr params,\n                      int nparams,\n                      const char *name,\n                      unsigned int *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_UINT);\n    if (value)\n        *value = param->value.ui;\n\n    return 1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAM_CHECK_TYPE",
          "args": [
            "VIR_TYPED_PARAM_UINT"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "params",
            "nparams",
            "name"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetUInt(virTypedParameterPtr params,\n                      int nparams,\n                      const char *name,\n                      unsigned int *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_UINT);\n    if (value)\n        *value = param->value.ui;\n\n    return 1;\n}"
  },
  {
    "function_name": "virTypedParamsGetInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "180-198",
    "snippet": "int\nvirTypedParamsGetInt(virTypedParameterPtr params,\n                     int nparams,\n                     const char *name,\n                     int *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_INT);\n    if (value)\n        *value = param->value.i;\n\n    return 1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAM_CHECK_TYPE",
          "args": [
            "VIR_TYPED_PARAM_INT"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "params",
            "nparams",
            "name"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetInt(virTypedParameterPtr params,\n                     int nparams,\n                     const char *name,\n                     int *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_INT);\n    if (value)\n        *value = param->value.i;\n\n    return 1;\n}"
  },
  {
    "function_name": "virTypedParamsGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "131-149",
    "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "params[i].field",
            "name"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "virTypedParameterAssignFromStr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
    "lines": "31-116",
    "snippet": "static int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unexpected type %d for field %s\")",
            "type",
            "name"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unexpected type %d for field %s\""
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Invalid boolean value for field '%s'\")",
            "name"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "val",
            "\"0\""
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRCASEEQ",
          "args": [
            "val",
            "\"false\""
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "val",
            "\"1\""
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRCASEEQ",
          "args": [
            "val",
            "\"true\""
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Invalid value for field '%s': \"\n                             \"expected double\")",
            "name"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToDouble",
          "args": [
            "val",
            "NULL",
            "&param->value.d"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToDouble",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "674-697",
          "snippet": "int\nvirStrToDouble(char const *s,\n               char **end_ptr,\n               double *result)\n{\n    virLocale oldlocale;\n    double val;\n    char *p;\n    int err;\n\n    errno = 0;\n    if (virLocaleSetRaw(&oldlocale) < 0)\n        return -1;\n    val = strtod(s, &p); /* exempt from syntax-check */\n    virLocaleRevert(&oldlocale);\n\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToDouble(char const *s,\n               char **end_ptr,\n               double *result)\n{\n    virLocale oldlocale;\n    double val;\n    char *p;\n    int err;\n\n    errno = 0;\n    if (virLocaleSetRaw(&oldlocale) < 0)\n        return -1;\n    val = strtod(s, &p); /* exempt from syntax-check */\n    virLocaleRevert(&oldlocale);\n\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\")",
            "name"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "val",
            "NULL",
            "10",
            "&param->value.ul"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Invalid value for field '%s': \"\n                             \"expected long long\")",
            "name"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ll",
          "args": [
            "val",
            "NULL",
            "10",
            "&param->value.l"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "526-542",
          "snippet": "int\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\")",
            "name"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "val",
            "NULL",
            "10",
            "&param->value.ui"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Invalid value for field '%s': expected int\")",
            "name"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "val",
            "NULL",
            "10",
            "&param->value.i"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Field name '%s' too long\")",
            "name"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrcpyStatic",
          "args": [
            "param->field",
            "name"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"NULL value for field '%s'\")",
            "name"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignFromStr(virTypedParameterPtr param,\n                               const char *name,\n                               int type,\n                               const char *val)\n{\n    if (!val) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"NULL value for field '%s'\"),\n                       name);\n        return -1;\n    }\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        if (virStrToLong_i(val, NULL, 10, &param->value.i) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': expected int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        if (virStrToLong_ui(val, NULL, 10, &param->value.ui) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned int\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        if (virStrToLong_ll(val, NULL, 10, &param->value.l) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        if (virStrToLong_ull(val, NULL, 10, &param->value.ul) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected unsigned long long\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        if (virStrToDouble(val, NULL, &param->value.d) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid value for field '%s': \"\n                             \"expected double\"),\n                           name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        if (STRCASEEQ(val, \"true\") || STREQ(val, \"1\")) {\n            param->value.b = true;\n        } else if (STRCASEEQ(val, \"false\") || STREQ(val, \"0\")) {\n            param->value.b = false;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Invalid boolean value for field '%s'\"), name);\n            return -1;\n        }\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        param->value.s = g_strdup(val);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type, name);\n        return -1;\n    }\n\n    return 0;\n}"
  }
]