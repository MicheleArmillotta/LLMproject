[
  {
    "function_name": "virSCSIVHostDeviceFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "266-277",
    "snippet": "void\nvirSCSIVHostDeviceFree(virSCSIVHostDevicePtr dev)\n{\n    if (!dev)\n        return;\n    VIR_DEBUG(\"%s: freeing\", dev->name);\n    VIR_FREE(dev->name);\n    VIR_FREE(dev->path);\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    VIR_FREE(dev);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dev"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dev->used_by_domname"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dev->used_by_drvname"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dev->path"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dev->name"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"%s: freeing\"",
            "dev->name"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirSCSIVHostDeviceFree(virSCSIVHostDevicePtr dev)\n{\n    if (!dev)\n        return;\n    VIR_DEBUG(\"%s: freeing\", dev->name);\n    VIR_FREE(dev->name);\n    VIR_FREE(dev->path);\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    VIR_FREE(dev);\n}"
  },
  {
    "function_name": "virSCSIVHostDeviceNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "248-263",
    "snippet": "virSCSIVHostDevicePtr\nvirSCSIVHostDeviceNew(const char *name)\n{\n    g_autoptr(virSCSIVHostDevice) dev = NULL;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    dev->name = g_strdup(name);\n\n    dev->path = g_strdup_printf(\"%s/%s\", SYSFS_VHOST_SCSI_DEVICES, name);\n\n    VIR_DEBUG(\"%s: initialized\", dev->name);\n\n    return g_steal_pointer(&dev);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define SYSFS_VHOST_SCSI_DEVICES \"/sys/kernel/config/target/vhost/\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&dev"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"%s: initialized\"",
            "dev->name"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s\"",
            "SYSFS_VHOST_SCSI_DEVICES",
            "name"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "dev"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\n#define SYSFS_VHOST_SCSI_DEVICES \"/sys/kernel/config/target/vhost/\"\n\nvirSCSIVHostDevicePtr\nvirSCSIVHostDeviceNew(const char *name)\n{\n    g_autoptr(virSCSIVHostDevice) dev = NULL;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    dev->name = g_strdup(name);\n\n    dev->path = g_strdup_printf(\"%s/%s\", SYSFS_VHOST_SCSI_DEVICES, name);\n\n    VIR_DEBUG(\"%s: initialized\", dev->name);\n\n    return g_steal_pointer(&dev);\n}"
  },
  {
    "function_name": "virSCSIVHostDeviceGetPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "241-245",
    "snippet": "const char *\nvirSCSIVHostDeviceGetPath(virSCSIVHostDevicePtr dev)\n{\n    return dev->path;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirSCSIVHostDeviceGetPath(virSCSIVHostDevicePtr dev)\n{\n    return dev->path;\n}"
  },
  {
    "function_name": "virSCSIVHostDeviceGetName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "234-238",
    "snippet": "const char *\nvirSCSIVHostDeviceGetName(virSCSIVHostDevicePtr dev)\n{\n    return dev->name;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirSCSIVHostDeviceGetName(virSCSIVHostDevicePtr dev)\n{\n    return dev->name;\n}"
  },
  {
    "function_name": "virSCSIVHostDeviceFileIterate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "225-231",
    "snippet": "int\nvirSCSIVHostDeviceFileIterate(virSCSIVHostDevicePtr dev,\n                              virSCSIVHostDeviceFileActor actor,\n                              void *opaque)\n{\n    return (actor)(dev, dev->path, opaque);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "dev",
            "dev->path",
            "opaque"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirSCSIVHostDeviceFileIterate(virSCSIVHostDevicePtr dev,\n                              virSCSIVHostDeviceFileActor actor,\n                              void *opaque)\n{\n    return (actor)(dev, dev->path, opaque);\n}"
  },
  {
    "function_name": "virSCSIVHostDeviceGetUsedBy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "215-222",
    "snippet": "void\nvirSCSIVHostDeviceGetUsedBy(virSCSIVHostDevicePtr dev,\n                            const char **drv_name,\n                            const char **dom_name)\n{\n    *drv_name = dev->used_by_drvname;\n    *dom_name = dev->used_by_domname;\n }",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirSCSIVHostDeviceGetUsedBy(virSCSIVHostDevicePtr dev,\n                            const char **drv_name,\n                            const char **dom_name)\n{\n    *drv_name = dev->used_by_drvname;\n    *dom_name = dev->used_by_domname;\n }"
  },
  {
    "function_name": "virSCSIVHostDeviceSetUsedBy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "201-212",
    "snippet": "int\nvirSCSIVHostDeviceSetUsedBy(virSCSIVHostDevicePtr dev,\n                            const char *drvname,\n                            const char *domname)\n{\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    dev->used_by_drvname = g_strdup(drvname);\n    dev->used_by_domname = g_strdup(domname);\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "domname"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dev->used_by_domname"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dev->used_by_drvname"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirSCSIVHostDeviceSetUsedBy(virSCSIVHostDevicePtr dev,\n                            const char *drvname,\n                            const char *domname)\n{\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    dev->used_by_drvname = g_strdup(drvname);\n    dev->used_by_domname = g_strdup(domname);\n\n    return 0;\n}"
  },
  {
    "function_name": "virSCSIVHostDeviceListNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "191-198",
    "snippet": "virSCSIVHostDeviceListPtr\nvirSCSIVHostDeviceListNew(void)\n{\n    if (virSCSIVHostInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableNew(virSCSIVHostDeviceListClass);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virSCSIVHostDeviceListClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virSCSIVHostDeviceListClass"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSCSIVHostInitialize",
          "args": [],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nstatic virClassPtr virSCSIVHostDeviceListClass;\n\nvirSCSIVHostDeviceListPtr\nvirSCSIVHostDeviceListNew(void)\n{\n    if (virSCSIVHostInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableNew(virSCSIVHostDeviceListClass);\n}"
  },
  {
    "function_name": "virSCSIVHostDeviceListAdd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "178-188",
    "snippet": "int\nvirSCSIVHostDeviceListAdd(virSCSIVHostDeviceListPtr list,\n                          virSCSIVHostDevicePtr dev)\n{\n    if (virSCSIVHostDeviceListFind(list, dev)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Device %s is already in use\"), dev->name);\n        return -1;\n    }\n    return VIR_APPEND_ELEMENT(list->devs, list->count, dev);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "list->devs",
            "list->count",
            "dev"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Device %s is already in use\")",
            "dev->name"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Device %s is already in use\""
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSCSIVHostDeviceListFind",
          "args": [
            "list",
            "dev"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "virSCSIVHostDeviceListFind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
          "lines": "165-175",
          "snippet": "virSCSIVHostDevicePtr\nvirSCSIVHostDeviceListFind(virSCSIVHostDeviceListPtr list,\n                           virSCSIVHostDevicePtr dev)\n{\n    int idx;\n\n    if ((idx = virSCSIVHostDeviceListFindIndex(list, dev)) >= 0)\n        return list->devs[idx];\n    else\n        return NULL;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virscsivhost.h\"",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nvirSCSIVHostDevicePtr\nvirSCSIVHostDeviceListFind(virSCSIVHostDeviceListPtr list,\n                           virSCSIVHostDevicePtr dev)\n{\n    int idx;\n\n    if ((idx = virSCSIVHostDeviceListFindIndex(list, dev)) >= 0)\n        return list->devs[idx];\n    else\n        return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirSCSIVHostDeviceListAdd(virSCSIVHostDeviceListPtr list,\n                          virSCSIVHostDevicePtr dev)\n{\n    if (virSCSIVHostDeviceListFind(list, dev)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Device %s is already in use\"), dev->name);\n        return -1;\n    }\n    return VIR_APPEND_ELEMENT(list->devs, list->count, dev);\n}"
  },
  {
    "function_name": "virSCSIVHostDeviceListFind",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "165-175",
    "snippet": "virSCSIVHostDevicePtr\nvirSCSIVHostDeviceListFind(virSCSIVHostDeviceListPtr list,\n                           virSCSIVHostDevicePtr dev)\n{\n    int idx;\n\n    if ((idx = virSCSIVHostDeviceListFindIndex(list, dev)) >= 0)\n        return list->devs[idx];\n    else\n        return NULL;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSCSIVHostDeviceListFindIndex",
          "args": [
            "list",
            "dev"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "virSCSIVHostDeviceListFindIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
          "lines": "114-126",
          "snippet": "static int\nvirSCSIVHostDeviceListFindIndex(virSCSIVHostDeviceListPtr list,\n                                virSCSIVHostDevicePtr dev)\n{\n    size_t i;\n\n    for (i = 0; i < list->count; i++) {\n        virSCSIVHostDevicePtr other = list->devs[i];\n        if (STREQ_NULLABLE(other->name, dev->name))\n            return i;\n    }\n    return -1;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virscsivhost.h\"",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirSCSIVHostDeviceListFindIndex(virSCSIVHostDeviceListPtr list,\n                                virSCSIVHostDevicePtr dev)\n{\n    size_t i;\n\n    for (i = 0; i < list->count; i++) {\n        virSCSIVHostDevicePtr other = list->devs[i];\n        if (STREQ_NULLABLE(other->name, dev->name))\n            return i;\n    }\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nvirSCSIVHostDevicePtr\nvirSCSIVHostDeviceListFind(virSCSIVHostDeviceListPtr list,\n                           virSCSIVHostDevicePtr dev)\n{\n    int idx;\n\n    if ((idx = virSCSIVHostDeviceListFindIndex(list, dev)) >= 0)\n        return list->devs[idx];\n    else\n        return NULL;\n}"
  },
  {
    "function_name": "virSCSIVHostDeviceListSteal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "146-162",
    "snippet": "virSCSIVHostDevicePtr\nvirSCSIVHostDeviceListSteal(virSCSIVHostDeviceListPtr list,\n                            virSCSIVHostDevicePtr dev)\n{\n    virSCSIVHostDevicePtr ret = NULL;\n    size_t i;\n\n    for (i = 0; i < list->count; i++) {\n        if (STREQ_NULLABLE(list->devs[i]->name, dev->name)) {\n            ret = list->devs[i];\n            VIR_DELETE_ELEMENT(list->devs, i, list->count);\n            break;\n        }\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DELETE_ELEMENT",
          "args": [
            "list->devs",
            "i",
            "list->count"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "list->devs[i]->name",
            "dev->name"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nvirSCSIVHostDevicePtr\nvirSCSIVHostDeviceListSteal(virSCSIVHostDeviceListPtr list,\n                            virSCSIVHostDevicePtr dev)\n{\n    virSCSIVHostDevicePtr ret = NULL;\n    size_t i;\n\n    for (i = 0; i < list->count; i++) {\n        if (STREQ_NULLABLE(list->devs[i]->name, dev->name)) {\n            ret = list->devs[i];\n            VIR_DELETE_ELEMENT(list->devs, i, list->count);\n            break;\n        }\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virSCSIVHostDeviceListCount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "139-143",
    "snippet": "size_t\nvirSCSIVHostDeviceListCount(virSCSIVHostDeviceListPtr list)\n{\n    return list->count;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nsize_t\nvirSCSIVHostDeviceListCount(virSCSIVHostDeviceListPtr list)\n{\n    return list->count;\n}"
  },
  {
    "function_name": "virSCSIVHostDeviceListGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "129-136",
    "snippet": "virSCSIVHostDevicePtr\nvirSCSIVHostDeviceListGet(virSCSIVHostDeviceListPtr list, int idx)\n{\n    if (idx >= list->count || idx < 0)\n        return NULL;\n\n    return list->devs[idx];\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nvirSCSIVHostDevicePtr\nvirSCSIVHostDeviceListGet(virSCSIVHostDeviceListPtr list, int idx)\n{\n    if (idx >= list->count || idx < 0)\n        return NULL;\n\n    return list->devs[idx];\n}"
  },
  {
    "function_name": "virSCSIVHostDeviceListFindIndex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "114-126",
    "snippet": "static int\nvirSCSIVHostDeviceListFindIndex(virSCSIVHostDeviceListPtr list,\n                                virSCSIVHostDevicePtr dev)\n{\n    size_t i;\n\n    for (i = 0; i < list->count; i++) {\n        virSCSIVHostDevicePtr other = list->devs[i];\n        if (STREQ_NULLABLE(other->name, dev->name))\n            return i;\n    }\n    return -1;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "other->name",
            "dev->name"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirSCSIVHostDeviceListFindIndex(virSCSIVHostDeviceListPtr list,\n                                virSCSIVHostDevicePtr dev)\n{\n    size_t i;\n\n    for (i = 0; i < list->count; i++) {\n        virSCSIVHostDevicePtr other = list->devs[i];\n        if (STREQ_NULLABLE(other->name, dev->name))\n            return i;\n    }\n    return -1;\n}"
  },
  {
    "function_name": "virSCSIVHostDeviceListDel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "106-111",
    "snippet": "void\nvirSCSIVHostDeviceListDel(virSCSIVHostDeviceListPtr list,\n                          virSCSIVHostDevicePtr dev)\n{\n    virSCSIVHostDeviceFree(virSCSIVHostDeviceListSteal(list, dev));\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSCSIVHostDeviceFree",
          "args": [
            "virSCSIVHostDeviceListSteal(list, dev)"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "virSCSIVHostDeviceFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
          "lines": "266-277",
          "snippet": "void\nvirSCSIVHostDeviceFree(virSCSIVHostDevicePtr dev)\n{\n    if (!dev)\n        return;\n    VIR_DEBUG(\"%s: freeing\", dev->name);\n    VIR_FREE(dev->name);\n    VIR_FREE(dev->path);\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    VIR_FREE(dev);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virscsivhost.h\"",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirSCSIVHostDeviceFree(virSCSIVHostDevicePtr dev)\n{\n    if (!dev)\n        return;\n    VIR_DEBUG(\"%s: freeing\", dev->name);\n    VIR_FREE(dev->name);\n    VIR_FREE(dev->path);\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    VIR_FREE(dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSCSIVHostDeviceListSteal",
          "args": [
            "list",
            "dev"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "virSCSIVHostDeviceListSteal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
          "lines": "146-162",
          "snippet": "virSCSIVHostDevicePtr\nvirSCSIVHostDeviceListSteal(virSCSIVHostDeviceListPtr list,\n                            virSCSIVHostDevicePtr dev)\n{\n    virSCSIVHostDevicePtr ret = NULL;\n    size_t i;\n\n    for (i = 0; i < list->count; i++) {\n        if (STREQ_NULLABLE(list->devs[i]->name, dev->name)) {\n            ret = list->devs[i];\n            VIR_DELETE_ELEMENT(list->devs, i, list->count);\n            break;\n        }\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virscsivhost.h\"",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nvirSCSIVHostDevicePtr\nvirSCSIVHostDeviceListSteal(virSCSIVHostDeviceListPtr list,\n                            virSCSIVHostDevicePtr dev)\n{\n    virSCSIVHostDevicePtr ret = NULL;\n    size_t i;\n\n    for (i = 0; i < list->count; i++) {\n        if (STREQ_NULLABLE(list->devs[i]->name, dev->name)) {\n            ret = list->devs[i];\n            VIR_DELETE_ELEMENT(list->devs, i, list->count);\n            break;\n        }\n    }\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirSCSIVHostDeviceListDel(virSCSIVHostDeviceListPtr list,\n                          virSCSIVHostDevicePtr dev)\n{\n    virSCSIVHostDeviceFree(virSCSIVHostDeviceListSteal(list, dev));\n}"
  },
  {
    "function_name": "virSCSIVHostOpenVhostSCSI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "80-103",
    "snippet": "int\nvirSCSIVHostOpenVhostSCSI(int *vhostfd)\n{\n    if (!virFileExists(VHOST_SCSI_DEVICE)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"vhost-scsi device file '%s' cannot be found\"),\n                       VHOST_SCSI_DEVICE);\n        return -1;\n    }\n\n    *vhostfd = open(VHOST_SCSI_DEVICE, O_RDWR);\n\n    if (*vhostfd < 0) {\n        virReportSystemError(errno, _(\"Failed to open %s\"), VHOST_SCSI_DEVICE);\n        goto error;\n    }\n\n    return 0;\n\n error:\n    VIR_FORCE_CLOSE(*vhostfd);\n\n    return -1;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VHOST_SCSI_DEVICE \"/dev/vhost-scsi\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "*vhostfd"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to open %s\")",
            "VHOST_SCSI_DEVICE"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to open %s\""
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "VHOST_SCSI_DEVICE",
            "O_RDWR"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFdopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "164-177",
          "snippet": "FILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nFILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"vhost-scsi device file '%s' cannot be found\")",
            "VHOST_SCSI_DEVICE"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "VHOST_SCSI_DEVICE"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\n#define VHOST_SCSI_DEVICE \"/dev/vhost-scsi\"\n\nint\nvirSCSIVHostOpenVhostSCSI(int *vhostfd)\n{\n    if (!virFileExists(VHOST_SCSI_DEVICE)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"vhost-scsi device file '%s' cannot be found\"),\n                       VHOST_SCSI_DEVICE);\n        return -1;\n    }\n\n    *vhostfd = open(VHOST_SCSI_DEVICE, O_RDWR);\n\n    if (*vhostfd < 0) {\n        virReportSystemError(errno, _(\"Failed to open %s\"), VHOST_SCSI_DEVICE);\n        goto error;\n    }\n\n    return 0;\n\n error:\n    VIR_FORCE_CLOSE(*vhostfd);\n\n    return -1;\n}"
  },
  {
    "function_name": "virSCSIVHostOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "67-74",
    "snippet": "static int\nvirSCSIVHostOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virSCSIVHostDeviceList, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virSCSIVHostDeviceList",
            "virClassForObjectLockable()"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirSCSIVHostOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virSCSIVHostDeviceList, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virSCSIVHostDeviceListDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
    "lines": "54-64",
    "snippet": "static void\nvirSCSIVHostDeviceListDispose(void *obj)\n{\n    virSCSIVHostDeviceListPtr list = obj;\n    size_t i;\n\n    for (i = 0; i < list->count; i++)\n        virSCSIVHostDeviceFree(list->devs[i]);\n\n    VIR_FREE(list->devs);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virscsivhost.h\"",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "list->devs"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSCSIVHostDeviceFree",
          "args": [
            "list->devs[i]"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "virSCSIVHostDeviceFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsivhost.c",
          "lines": "266-277",
          "snippet": "void\nvirSCSIVHostDeviceFree(virSCSIVHostDevicePtr dev)\n{\n    if (!dev)\n        return;\n    VIR_DEBUG(\"%s: freeing\", dev->name);\n    VIR_FREE(dev->name);\n    VIR_FREE(dev->path);\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    VIR_FREE(dev);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virscsivhost.h\"",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirSCSIVHostDeviceFree(virSCSIVHostDevicePtr dev)\n{\n    if (!dev)\n        return;\n    VIR_DEBUG(\"%s: freeing\", dev->name);\n    VIR_FREE(dev->name);\n    VIR_FREE(dev->path);\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    VIR_FREE(dev);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virscsivhost.h\"\n#include <fcntl.h>\n#include <config.h>\n\nstatic void\nvirSCSIVHostDeviceListDispose(void *obj)\n{\n    virSCSIVHostDeviceListPtr list = obj;\n    size_t i;\n\n    for (i = 0; i < list->count; i++)\n        virSCSIVHostDeviceFree(list->devs[i]);\n\n    VIR_FREE(list->devs);\n}"
  }
]