[
  {
    "function_name": "virIdentityGetParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "596-609",
    "snippet": "int virIdentityGetParameters(virIdentityPtr ident,\n                             virTypedParameterPtr *params,\n                             int *nparams)\n{\n    *params = NULL;\n    *nparams = 0;\n\n    if (virTypedParamsCopy(params, ident->params, ident->nparams) < 0)\n        return -1;\n\n    *nparams = ident->nparams;\n\n    return 0;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsCopy",
          "args": [
            "params",
            "ident->params",
            "ident->nparams"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "353-378",
          "snippet": "int\nvirTypedParamsCopy(virTypedParameterPtr *dst,\n                   virTypedParameterPtr src,\n                   int nparams)\n{\n    size_t i;\n\n    *dst = NULL;\n    if (!src || nparams <= 0)\n        return 0;\n\n    if (VIR_ALLOC_N(*dst, nparams) < 0)\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        ignore_value(virStrcpyStatic((*dst)[i].field, src[i].field));\n        (*dst)[i].type = src[i].type;\n        if (src[i].type == VIR_TYPED_PARAM_STRING) {\n            (*dst)[i].value.s = g_strdup(src[i].value.s);\n        } else {\n            (*dst)[i].value = src[i].value;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsCopy(virTypedParameterPtr *dst,\n                   virTypedParameterPtr src,\n                   int nparams)\n{\n    size_t i;\n\n    *dst = NULL;\n    if (!src || nparams <= 0)\n        return 0;\n\n    if (VIR_ALLOC_N(*dst, nparams) < 0)\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        ignore_value(virStrcpyStatic((*dst)[i].field, src[i].field));\n        (*dst)[i].type = src[i].type;\n        if (src[i].type == VIR_TYPED_PARAM_STRING) {\n            (*dst)[i].value.s = g_strdup(src[i].value.s);\n        } else {\n            (*dst)[i].value = src[i].value;\n        }\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetParameters(virIdentityPtr ident,\n                             virTypedParameterPtr *params,\n                             int *nparams)\n{\n    *params = NULL;\n    *nparams = 0;\n\n    if (virTypedParamsCopy(params, ident->params, ident->nparams) < 0)\n        return -1;\n\n    *nparams = ident->nparams;\n\n    return 0;\n}"
  },
  {
    "function_name": "virIdentitySetParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "557-593",
    "snippet": "int virIdentitySetParameters(virIdentityPtr ident,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_CONNECT_IDENTITY_USER_NAME,\n                               VIR_TYPED_PARAM_STRING,\n                               VIR_CONNECT_IDENTITY_UNIX_USER_ID,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_CONNECT_IDENTITY_GROUP_NAME,\n                               VIR_TYPED_PARAM_STRING,\n                               VIR_CONNECT_IDENTITY_UNIX_GROUP_ID,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_CONNECT_IDENTITY_PROCESS_ID,\n                               VIR_TYPED_PARAM_LLONG,\n                               VIR_CONNECT_IDENTITY_PROCESS_TIME,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_CONNECT_IDENTITY_SASL_USER_NAME,\n                               VIR_TYPED_PARAM_STRING,\n                               VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME,\n                               VIR_TYPED_PARAM_STRING,\n                               VIR_CONNECT_IDENTITY_SELINUX_CONTEXT,\n                               VIR_TYPED_PARAM_STRING,\n                               NULL) < 0)\n        return -1;\n\n    virTypedParamsFree(ident->params, ident->nparams);\n    ident->params = NULL;\n    ident->nparams = 0;\n    ident->maxparams = 0;\n    if (virTypedParamsCopy(&ident->params, params, nparams) < 0)\n        return -1;\n    ident->nparams = nparams;\n    ident->maxparams = nparams;\n\n    return 0;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsCopy",
          "args": [
            "&ident->params",
            "params",
            "nparams"
          ],
          "line": 587
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "353-378",
          "snippet": "int\nvirTypedParamsCopy(virTypedParameterPtr *dst,\n                   virTypedParameterPtr src,\n                   int nparams)\n{\n    size_t i;\n\n    *dst = NULL;\n    if (!src || nparams <= 0)\n        return 0;\n\n    if (VIR_ALLOC_N(*dst, nparams) < 0)\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        ignore_value(virStrcpyStatic((*dst)[i].field, src[i].field));\n        (*dst)[i].type = src[i].type;\n        if (src[i].type == VIR_TYPED_PARAM_STRING) {\n            (*dst)[i].value.s = g_strdup(src[i].value.s);\n        } else {\n            (*dst)[i].value = src[i].value;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsCopy(virTypedParameterPtr *dst,\n                   virTypedParameterPtr src,\n                   int nparams)\n{\n    size_t i;\n\n    *dst = NULL;\n    if (!src || nparams <= 0)\n        return 0;\n\n    if (VIR_ALLOC_N(*dst, nparams) < 0)\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        ignore_value(virStrcpyStatic((*dst)[i].field, src[i].field));\n        (*dst)[i].type = src[i].type;\n        if (src[i].type == VIR_TYPED_PARAM_STRING) {\n            (*dst)[i].value.s = g_strdup(src[i].value.s);\n        } else {\n            (*dst)[i].value = src[i].value;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsFree",
          "args": [
            "ident->params",
            "ident->nparams"
          ],
          "line": 583
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "878-884",
          "snippet": "void\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvoid\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsValidate",
          "args": [
            "params",
            "nparams",
            "VIR_CONNECT_IDENTITY_USER_NAME",
            "VIR_TYPED_PARAM_STRING",
            "VIR_CONNECT_IDENTITY_UNIX_USER_ID",
            "VIR_TYPED_PARAM_ULLONG",
            "VIR_CONNECT_IDENTITY_GROUP_NAME",
            "VIR_TYPED_PARAM_STRING",
            "VIR_CONNECT_IDENTITY_UNIX_GROUP_ID",
            "VIR_TYPED_PARAM_ULLONG",
            "VIR_CONNECT_IDENTITY_PROCESS_ID",
            "VIR_TYPED_PARAM_LLONG",
            "VIR_CONNECT_IDENTITY_PROCESS_TIME",
            "VIR_TYPED_PARAM_ULLONG",
            "VIR_CONNECT_IDENTITY_SASL_USER_NAME",
            "VIR_TYPED_PARAM_STRING",
            "VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME",
            "VIR_TYPED_PARAM_STRING",
            "VIR_CONNECT_IDENTITY_SELINUX_CONTEXT",
            "VIR_TYPED_PARAM_STRING",
            "NULL"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "58-142",
          "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetParameters(virIdentityPtr ident,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_CONNECT_IDENTITY_USER_NAME,\n                               VIR_TYPED_PARAM_STRING,\n                               VIR_CONNECT_IDENTITY_UNIX_USER_ID,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_CONNECT_IDENTITY_GROUP_NAME,\n                               VIR_TYPED_PARAM_STRING,\n                               VIR_CONNECT_IDENTITY_UNIX_GROUP_ID,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_CONNECT_IDENTITY_PROCESS_ID,\n                               VIR_TYPED_PARAM_LLONG,\n                               VIR_CONNECT_IDENTITY_PROCESS_TIME,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_CONNECT_IDENTITY_SASL_USER_NAME,\n                               VIR_TYPED_PARAM_STRING,\n                               VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME,\n                               VIR_TYPED_PARAM_STRING,\n                               VIR_CONNECT_IDENTITY_SELINUX_CONTEXT,\n                               VIR_TYPED_PARAM_STRING,\n                               NULL) < 0)\n        return -1;\n\n    virTypedParamsFree(ident->params, ident->nparams);\n    ident->params = NULL;\n    ident->nparams = 0;\n    ident->maxparams = 0;\n    if (virTypedParamsCopy(&ident->params, params, nparams) < 0)\n        return -1;\n    ident->nparams = nparams;\n    ident->maxparams = nparams;\n\n    return 0;\n}"
  },
  {
    "function_name": "virIdentitySetSELinuxContext",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "538-554",
    "snippet": "int virIdentitySetSELinuxContext(virIdentityPtr ident,\n                                 const char *context)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_SELINUX_CONTEXT)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_SELINUX_CONTEXT,\n                                   context);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsAddString",
          "args": [
            "&ident->params",
            "&ident->nparams",
            "&ident->maxparams",
            "VIR_CONNECT_IDENTITY_SELINUX_CONTEXT",
            "context"
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "768-788",
          "snippet": "int\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_DENIED",
            "\"%s\"",
            "_(\"Identity attribute is already set\")"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Identity attribute is already set\""
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "vir_identity_class_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "83-88",
          "snippet": "static void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virIdentityFinalize(GObject *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void virIdentityFinalize(GObject *obj);\n\nstatic void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_SELINUX_CONTEXT"
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetSELinuxContext(virIdentityPtr ident,\n                                 const char *context)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_SELINUX_CONTEXT)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_SELINUX_CONTEXT,\n                                   context);\n}"
  },
  {
    "function_name": "virIdentitySetX509DName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "519-535",
    "snippet": "int virIdentitySetX509DName(virIdentityPtr ident,\n                            const char *dname)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME,\n                                   dname);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsAddString",
          "args": [
            "&ident->params",
            "&ident->nparams",
            "&ident->maxparams",
            "VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME",
            "dname"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "768-788",
          "snippet": "int\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_DENIED",
            "\"%s\"",
            "_(\"Identity attribute is already set\")"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Identity attribute is already set\""
          ],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "vir_identity_class_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "83-88",
          "snippet": "static void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virIdentityFinalize(GObject *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void virIdentityFinalize(GObject *obj);\n\nstatic void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME"
          ],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetX509DName(virIdentityPtr ident,\n                            const char *dname)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME,\n                                   dname);\n}"
  },
  {
    "function_name": "virIdentitySetSASLUserName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "500-516",
    "snippet": "int virIdentitySetSASLUserName(virIdentityPtr ident,\n                               const char *username)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_SASL_USER_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_SASL_USER_NAME,\n                                   username);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsAddString",
          "args": [
            "&ident->params",
            "&ident->nparams",
            "&ident->maxparams",
            "VIR_CONNECT_IDENTITY_SASL_USER_NAME",
            "username"
          ],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "768-788",
          "snippet": "int\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_DENIED",
            "\"%s\"",
            "_(\"Identity attribute is already set\")"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Identity attribute is already set\""
          ],
          "line": 507
        },
        "resolved": true,
        "details": {
          "function_name": "vir_identity_class_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "83-88",
          "snippet": "static void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virIdentityFinalize(GObject *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void virIdentityFinalize(GObject *obj);\n\nstatic void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_SASL_USER_NAME"
          ],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetSASLUserName(virIdentityPtr ident,\n                               const char *username)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_SASL_USER_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_SASL_USER_NAME,\n                                   username);\n}"
  },
  {
    "function_name": "virIdentitySetProcessTime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "480-496",
    "snippet": "int virIdentitySetProcessTime(virIdentityPtr ident,\n                              unsigned long long timestamp)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_PROCESS_TIME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_PROCESS_TIME,\n                                   timestamp);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsAddULLong",
          "args": [
            "&ident->params",
            "&ident->nparams",
            "&ident->maxparams",
            "VIR_CONNECT_IDENTITY_PROCESS_TIME",
            "timestamp"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "578-604",
          "snippet": "int\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_DENIED",
            "\"%s\"",
            "_(\"Identity attribute is already set\")"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Identity attribute is already set\""
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "vir_identity_class_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "83-88",
          "snippet": "static void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virIdentityFinalize(GObject *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void virIdentityFinalize(GObject *obj);\n\nstatic void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_PROCESS_TIME"
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetProcessTime(virIdentityPtr ident,\n                              unsigned long long timestamp)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_PROCESS_TIME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_PROCESS_TIME,\n                                   timestamp);\n}"
  },
  {
    "function_name": "virIdentitySetProcessID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "461-477",
    "snippet": "int virIdentitySetProcessID(virIdentityPtr ident,\n                            pid_t pid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_PROCESS_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddLLong(&ident->params,\n                                  &ident->nparams,\n                                  &ident->maxparams,\n                                  VIR_CONNECT_IDENTITY_PROCESS_ID,\n                                  pid);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsAddLLong",
          "args": [
            "&ident->params",
            "&ident->nparams",
            "&ident->maxparams",
            "VIR_CONNECT_IDENTITY_PROCESS_ID",
            "pid"
          ],
          "line": 472
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddLLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "531-557",
          "snippet": "int\nvirTypedParamsAddLLong(virTypedParameterPtr *params,\n                       int *nparams,\n                       int *maxparams,\n                       const char *name,\n                       long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_LLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddLLong(virTypedParameterPtr *params,\n                       int *nparams,\n                       int *maxparams,\n                       const char *name,\n                       long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_LLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_DENIED",
            "\"%s\"",
            "_(\"Identity attribute is already set\")"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Identity attribute is already set\""
          ],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "vir_identity_class_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "83-88",
          "snippet": "static void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virIdentityFinalize(GObject *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void virIdentityFinalize(GObject *obj);\n\nstatic void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_PROCESS_ID"
          ],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetProcessID(virIdentityPtr ident,\n                            pid_t pid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_PROCESS_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddLLong(&ident->params,\n                                  &ident->nparams,\n                                  &ident->maxparams,\n                                  VIR_CONNECT_IDENTITY_PROCESS_ID,\n                                  pid);\n}"
  },
  {
    "function_name": "virIdentitySetUNIXGroupID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "442-458",
    "snippet": "int virIdentitySetUNIXGroupID(virIdentityPtr ident,\n                              gid_t gid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_UNIX_GROUP_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_UNIX_GROUP_ID,\n                                   gid);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsAddULLong",
          "args": [
            "&ident->params",
            "&ident->nparams",
            "&ident->maxparams",
            "VIR_CONNECT_IDENTITY_UNIX_GROUP_ID",
            "gid"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "578-604",
          "snippet": "int\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_DENIED",
            "\"%s\"",
            "_(\"Identity attribute is already set\")"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Identity attribute is already set\""
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "vir_identity_class_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "83-88",
          "snippet": "static void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virIdentityFinalize(GObject *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void virIdentityFinalize(GObject *obj);\n\nstatic void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_UNIX_GROUP_ID"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetUNIXGroupID(virIdentityPtr ident,\n                              gid_t gid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_UNIX_GROUP_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_UNIX_GROUP_ID,\n                                   gid);\n}"
  },
  {
    "function_name": "virIdentitySetGroupName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "423-439",
    "snippet": "int virIdentitySetGroupName(virIdentityPtr ident,\n                            const char *groupname)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_GROUP_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_GROUP_NAME,\n                                   groupname);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsAddString",
          "args": [
            "&ident->params",
            "&ident->nparams",
            "&ident->maxparams",
            "VIR_CONNECT_IDENTITY_GROUP_NAME",
            "groupname"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "768-788",
          "snippet": "int\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_DENIED",
            "\"%s\"",
            "_(\"Identity attribute is already set\")"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Identity attribute is already set\""
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "vir_identity_class_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "83-88",
          "snippet": "static void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virIdentityFinalize(GObject *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void virIdentityFinalize(GObject *obj);\n\nstatic void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_GROUP_NAME"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetGroupName(virIdentityPtr ident,\n                            const char *groupname)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_GROUP_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_GROUP_NAME,\n                                   groupname);\n}"
  },
  {
    "function_name": "virIdentitySetUNIXUserID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "404-420",
    "snippet": "int virIdentitySetUNIXUserID(virIdentityPtr ident,\n                             uid_t uid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_UNIX_USER_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_UNIX_USER_ID,\n                                   uid);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsAddULLong",
          "args": [
            "&ident->params",
            "&ident->nparams",
            "&ident->maxparams",
            "VIR_CONNECT_IDENTITY_UNIX_USER_ID",
            "uid"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "578-604",
          "snippet": "int\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_DENIED",
            "\"%s\"",
            "_(\"Identity attribute is already set\")"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Identity attribute is already set\""
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "vir_identity_class_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "83-88",
          "snippet": "static void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virIdentityFinalize(GObject *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void virIdentityFinalize(GObject *obj);\n\nstatic void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_UNIX_USER_ID"
          ],
          "line": 407
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetUNIXUserID(virIdentityPtr ident,\n                             uid_t uid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_UNIX_USER_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_UNIX_USER_ID,\n                                   uid);\n}"
  },
  {
    "function_name": "virIdentitySetUserName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "385-401",
    "snippet": "int virIdentitySetUserName(virIdentityPtr ident,\n                           const char *username)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_USER_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_USER_NAME,\n                                   username);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsAddString",
          "args": [
            "&ident->params",
            "&ident->nparams",
            "&ident->maxparams",
            "VIR_CONNECT_IDENTITY_USER_NAME",
            "username"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "768-788",
          "snippet": "int\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_DENIED",
            "\"%s\"",
            "_(\"Identity attribute is already set\")"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Identity attribute is already set\""
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "vir_identity_class_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "83-88",
          "snippet": "static void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virIdentityFinalize(GObject *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void virIdentityFinalize(GObject *obj);\n\nstatic void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_USER_NAME"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetUserName(virIdentityPtr ident,\n                           const char *username)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_USER_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_USER_NAME,\n                                   username);\n}"
  },
  {
    "function_name": "virIdentityGetSELinuxContext",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "374-382",
    "snippet": "int virIdentityGetSELinuxContext(virIdentityPtr ident,\n                                 const char **context)\n{\n    *context = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_SELINUX_CONTEXT,\n                                   context);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsGetString",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_SELINUX_CONTEXT",
            "context"
          ],
          "line": 378
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "432-467",
          "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetSELinuxContext(virIdentityPtr ident,\n                                 const char **context)\n{\n    *context = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_SELINUX_CONTEXT,\n                                   context);\n}"
  },
  {
    "function_name": "virIdentityGetX509DName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "360-368",
    "snippet": "int virIdentityGetX509DName(virIdentityPtr ident,\n                            const char **dname)\n{\n    *dname = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME,\n                                   dname);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsGetString",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME",
            "dname"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "432-467",
          "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetX509DName(virIdentityPtr ident,\n                            const char **dname)\n{\n    *dname = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME,\n                                   dname);\n}"
  },
  {
    "function_name": "virIdentityGetSASLUserName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "346-354",
    "snippet": "int virIdentityGetSASLUserName(virIdentityPtr ident,\n                               const char **username)\n{\n    *username = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_SASL_USER_NAME,\n                                   username);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsGetString",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_SASL_USER_NAME",
            "username"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "432-467",
          "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetSASLUserName(virIdentityPtr ident,\n                               const char **username)\n{\n    *username = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_SASL_USER_NAME,\n                                   username);\n}"
  },
  {
    "function_name": "virIdentityGetProcessTime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "332-340",
    "snippet": "int virIdentityGetProcessTime(virIdentityPtr ident,\n                              unsigned long long *timestamp)\n{\n    *timestamp = 0;\n    return virTypedParamsGetULLong(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_PROCESS_TIME,\n                                   timestamp);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsGetULLong",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_PROCESS_TIME",
            "timestamp"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "288-306",
          "snippet": "int\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetProcessTime(virIdentityPtr ident,\n                              unsigned long long *timestamp)\n{\n    *timestamp = 0;\n    return virTypedParamsGetULLong(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_PROCESS_TIME,\n                                   timestamp);\n}"
  },
  {
    "function_name": "virIdentityGetProcessID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "309-326",
    "snippet": "int virIdentityGetProcessID(virIdentityPtr ident,\n                            pid_t *pid)\n{\n    long long val;\n    int rc;\n\n    *pid = 0;\n    rc = virTypedParamsGetLLong(ident->params,\n                                ident->nparams,\n                                VIR_CONNECT_IDENTITY_PROCESS_ID,\n                                &val);\n    if (rc <= 0)\n        return rc;\n\n    *pid = (pid_t)val;\n\n    return 1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsGetLLong",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_PROCESS_ID",
            "&val"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetLLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "252-270",
          "snippet": "int\nvirTypedParamsGetLLong(virTypedParameterPtr params,\n                       int nparams,\n                       const char *name,\n                       long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_LLONG);\n    if (value)\n        *value = param->value.l;\n\n    return 1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetLLong(virTypedParameterPtr params,\n                       int nparams,\n                       const char *name,\n                       long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_LLONG);\n    if (value)\n        *value = param->value.l;\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetProcessID(virIdentityPtr ident,\n                            pid_t *pid)\n{\n    long long val;\n    int rc;\n\n    *pid = 0;\n    rc = virTypedParamsGetLLong(ident->params,\n                                ident->nparams,\n                                VIR_CONNECT_IDENTITY_PROCESS_ID,\n                                &val);\n    if (rc <= 0)\n        return rc;\n\n    *pid = (pid_t)val;\n\n    return 1;\n}"
  },
  {
    "function_name": "virIdentityGetUNIXGroupID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "286-303",
    "snippet": "int virIdentityGetUNIXGroupID(virIdentityPtr ident,\n                              gid_t *gid)\n{\n    unsigned long long val;\n    int rc;\n\n    *gid = -1;\n    rc = virTypedParamsGetULLong(ident->params,\n                                 ident->nparams,\n                                 VIR_CONNECT_IDENTITY_UNIX_GROUP_ID,\n                                 &val);\n    if (rc <= 0)\n        return rc;\n\n    *gid = (gid_t)val;\n\n    return 1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsGetULLong",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_UNIX_GROUP_ID",
            "&val"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "288-306",
          "snippet": "int\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetUNIXGroupID(virIdentityPtr ident,\n                              gid_t *gid)\n{\n    unsigned long long val;\n    int rc;\n\n    *gid = -1;\n    rc = virTypedParamsGetULLong(ident->params,\n                                 ident->nparams,\n                                 VIR_CONNECT_IDENTITY_UNIX_GROUP_ID,\n                                 &val);\n    if (rc <= 0)\n        return rc;\n\n    *gid = (gid_t)val;\n\n    return 1;\n}"
  },
  {
    "function_name": "virIdentityGetGroupName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "272-280",
    "snippet": "int virIdentityGetGroupName(virIdentityPtr ident,\n                            const char **groupname)\n{\n    *groupname = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_GROUP_NAME,\n                                   groupname);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsGetString",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_GROUP_NAME",
            "groupname"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "432-467",
          "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetGroupName(virIdentityPtr ident,\n                            const char **groupname)\n{\n    *groupname = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_GROUP_NAME,\n                                   groupname);\n}"
  },
  {
    "function_name": "virIdentityGetUNIXUserID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "249-266",
    "snippet": "int virIdentityGetUNIXUserID(virIdentityPtr ident,\n                             uid_t *uid)\n{\n    unsigned long long val;\n    int rc;\n\n    *uid = -1;\n    rc = virTypedParamsGetULLong(ident->params,\n                                 ident->nparams,\n                                 VIR_CONNECT_IDENTITY_UNIX_USER_ID,\n                                 &val);\n    if (rc <= 0)\n        return rc;\n\n    *uid = (uid_t)val;\n\n    return 1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsGetULLong",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_UNIX_USER_ID",
            "&val"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "288-306",
          "snippet": "int\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetUNIXUserID(virIdentityPtr ident,\n                             uid_t *uid)\n{\n    unsigned long long val;\n    int rc;\n\n    *uid = -1;\n    rc = virTypedParamsGetULLong(ident->params,\n                                 ident->nparams,\n                                 VIR_CONNECT_IDENTITY_UNIX_USER_ID,\n                                 &val);\n    if (rc <= 0)\n        return rc;\n\n    *uid = (uid_t)val;\n\n    return 1;\n}"
  },
  {
    "function_name": "virIdentityGetUserName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "235-243",
    "snippet": "int virIdentityGetUserName(virIdentityPtr ident,\n                           const char **username)\n{\n    *username = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_USER_NAME,\n                                   username);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsGetString",
          "args": [
            "ident->params",
            "ident->nparams",
            "VIR_CONNECT_IDENTITY_USER_NAME",
            "username"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "432-467",
          "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetUserName(virIdentityPtr ident,\n                           const char **username)\n{\n    *username = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_USER_NAME,\n                                   username);\n}"
  },
  {
    "function_name": "virIdentityFinalize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "222-229",
    "snippet": "static void virIdentityFinalize(GObject *object)\n{\n    virIdentityPtr ident = VIR_IDENTITY(object);\n\n    virTypedParamsFree(ident->params, ident->nparams);\n\n    G_OBJECT_CLASS(vir_identity_parent_class)->finalize(object);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "G_OBJECT_CLASS",
          "args": [
            "object"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_OBJECT_CLASS",
          "args": [
            "vir_identity_parent_class"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsFree",
          "args": [
            "ident->params",
            "ident->nparams"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "878-884",
          "snippet": "void\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvoid\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_IDENTITY",
          "args": [
            "object"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void virIdentityFinalize(GObject *object)\n{\n    virIdentityPtr ident = VIR_IDENTITY(object);\n\n    virTypedParamsFree(ident->params, ident->nparams);\n\n    G_OBJECT_CLASS(vir_identity_parent_class)->finalize(object);\n}"
  },
  {
    "function_name": "virIdentityNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "216-219",
    "snippet": "virIdentityPtr virIdentityNew(void)\n{\n    return VIR_IDENTITY(g_object_new(VIR_TYPE_IDENTITY, NULL));\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_IDENTITY",
          "args": [
            "g_object_new(VIR_TYPE_IDENTITY, NULL)"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_object_new",
          "args": [
            "VIR_TYPE_IDENTITY",
            "NULL"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nvirIdentityPtr virIdentityNew(void)\n{\n    return VIR_IDENTITY(g_object_new(VIR_TYPE_IDENTITY, NULL));\n}"
  },
  {
    "function_name": "virIdentityGetSystem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "153-205",
    "snippet": "virIdentityPtr virIdentityGetSystem(void)\n{\n    g_autofree char *username = NULL;\n    g_autofree char *groupname = NULL;\n    unsigned long long startTime;\n    g_autoptr(virIdentity) ret = NULL;\n#if WITH_SELINUX\n    security_context_t con;\n#endif\n\n    if (!(ret = virIdentityNew()))\n        return NULL;\n\n    if (virIdentitySetProcessID(ret, getpid()) < 0)\n        return NULL;\n\n    if (virProcessGetStartTime(getpid(), &startTime) < 0)\n        return NULL;\n    if (startTime != 0 &&\n        virIdentitySetProcessTime(ret, startTime) < 0)\n        return NULL;\n\n    if (!(username = virGetUserName(geteuid())))\n        return ret;\n    if (virIdentitySetUserName(ret, username) < 0)\n        return NULL;\n    if (virIdentitySetUNIXUserID(ret, getuid()) < 0)\n        return NULL;\n\n    if (!(groupname = virGetGroupName(getegid())))\n        return ret;\n    if (virIdentitySetGroupName(ret, groupname) < 0)\n        return NULL;\n    if (virIdentitySetUNIXGroupID(ret, getgid()) < 0)\n        return NULL;\n\n#if WITH_SELINUX\n    if (is_selinux_enabled() > 0) {\n        if (getcon(&con) < 0) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to lookup SELinux process context\"));\n            return NULL;\n        }\n        if (virIdentitySetSELinuxContext(ret, con) < 0) {\n            freecon(con);\n            return NULL;\n        }\n        freecon(con);\n    }\n#endif\n\n    return g_steal_pointer(&ret);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&ret"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "freecon",
          "args": [
            "con"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "freecon",
          "args": [
            "con"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virIdentitySetSELinuxContext",
          "args": [
            "ret",
            "con"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentitySetSELinuxContext",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "538-554",
          "snippet": "int virIdentitySetSELinuxContext(virIdentityPtr ident,\n                                 const char *context)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_SELINUX_CONTEXT)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_SELINUX_CONTEXT,\n                                   context);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetSELinuxContext(virIdentityPtr ident,\n                                 const char *context)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_SELINUX_CONTEXT)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_SELINUX_CONTEXT,\n                                   context);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to lookup SELinux process context\")"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to lookup SELinux process context\""
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "vir_identity_class_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "83-88",
          "snippet": "static void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virIdentityFinalize(GObject *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void virIdentityFinalize(GObject *obj);\n\nstatic void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getcon",
          "args": [
            "&con"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_selinux_enabled",
          "args": [],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virIdentitySetUNIXGroupID",
          "args": [
            "ret",
            "getgid()"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentitySetUNIXGroupID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "442-458",
          "snippet": "int virIdentitySetUNIXGroupID(virIdentityPtr ident,\n                              gid_t gid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_UNIX_GROUP_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_UNIX_GROUP_ID,\n                                   gid);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetUNIXGroupID(virIdentityPtr ident,\n                              gid_t gid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_UNIX_GROUP_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_UNIX_GROUP_ID,\n                                   gid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "getgid",
          "args": [],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "getgid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "73-74",
          "snippet": "static inline int getgid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int getgid(void)\n{ return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "virIdentitySetGroupName",
          "args": [
            "ret",
            "groupname"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentitySetGroupName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "423-439",
          "snippet": "int virIdentitySetGroupName(virIdentityPtr ident,\n                            const char *groupname)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_GROUP_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_GROUP_NAME,\n                                   groupname);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetGroupName(virIdentityPtr ident,\n                            const char *groupname)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_GROUP_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_GROUP_NAME,\n                                   groupname);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetGroupName",
          "args": [
            "getegid()"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "virGetGroupName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1158-1165",
          "snippet": "char *\nvirGetGroupName(gid_t gid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetGroupName is not available\"));\n\n    return NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetGroupName(gid_t gid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetGroupName is not available\"));\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getegid",
          "args": [],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "getegid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "78-79",
          "snippet": "static inline int getegid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int getegid(void)\n{ return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "virIdentitySetUNIXUserID",
          "args": [
            "ret",
            "getuid()"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentitySetUNIXUserID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "404-420",
          "snippet": "int virIdentitySetUNIXUserID(virIdentityPtr ident,\n                             uid_t uid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_UNIX_USER_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_UNIX_USER_ID,\n                                   uid);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetUNIXUserID(virIdentityPtr ident,\n                             uid_t uid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_UNIX_USER_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_UNIX_USER_ID,\n                                   uid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "getuid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "63-64",
          "snippet": "static inline int getuid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int getuid(void)\n{ return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "virIdentitySetUserName",
          "args": [
            "ret",
            "username"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentitySetUserName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "385-401",
          "snippet": "int virIdentitySetUserName(virIdentityPtr ident,\n                           const char *username)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_USER_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_USER_NAME,\n                                   username);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetUserName(virIdentityPtr ident,\n                           const char *username)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_USER_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_USER_NAME,\n                                   username);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUserName",
          "args": [
            "geteuid()"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1119-1126",
          "snippet": "char *\nvirGetUserName(uid_t uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserName is not available\"));\n\n    return NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetUserName(uid_t uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserName is not available\"));\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "geteuid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "68-69",
          "snippet": "static inline int geteuid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int geteuid(void)\n{ return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "virIdentitySetProcessTime",
          "args": [
            "ret",
            "startTime"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentitySetProcessTime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "480-496",
          "snippet": "int virIdentitySetProcessTime(virIdentityPtr ident,\n                              unsigned long long timestamp)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_PROCESS_TIME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_PROCESS_TIME,\n                                   timestamp);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetProcessTime(virIdentityPtr ident,\n                              unsigned long long timestamp)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_PROCESS_TIME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_PROCESS_TIME,\n                                   timestamp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virProcessGetStartTime",
          "args": [
            "getpid()",
            "&startTime"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessGetStartTime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "1046-1056",
          "snippet": "int virProcessGetStartTime(pid_t pid,\n                           unsigned long long *timestamp)\n{\n    static int warned;\n    if (g_atomic_int_add(&warned, 1) == 0) {\n        VIR_WARN(\"Process start time of pid %lld not available on this platform\",\n                 (long long) pid);\n    }\n    *timestamp = 0;\n    return 0;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virProcessGetStartTime(pid_t pid,\n                           unsigned long long *timestamp)\n{\n    static int warned;\n    if (g_atomic_int_add(&warned, 1) == 0) {\n        VIR_WARN(\"Process start time of pid %lld not available on this platform\",\n                 (long long) pid);\n    }\n    *timestamp = 0;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getpid",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virIdentitySetProcessID",
          "args": [
            "ret",
            "getpid()"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentitySetProcessID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "461-477",
          "snippet": "int virIdentitySetProcessID(virIdentityPtr ident,\n                            pid_t pid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_PROCESS_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddLLong(&ident->params,\n                                  &ident->nparams,\n                                  &ident->maxparams,\n                                  VIR_CONNECT_IDENTITY_PROCESS_ID,\n                                  pid);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetProcessID(virIdentityPtr ident,\n                            pid_t pid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_PROCESS_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddLLong(&ident->params,\n                                  &ident->nparams,\n                                  &ident->maxparams,\n                                  VIR_CONNECT_IDENTITY_PROCESS_ID,\n                                  pid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "getpid",
          "args": [],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virIdentityNew",
          "args": [],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentityNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "216-219",
          "snippet": "virIdentityPtr virIdentityNew(void)\n{\n    return VIR_IDENTITY(g_object_new(VIR_TYPE_IDENTITY, NULL));\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nvirIdentityPtr virIdentityNew(void)\n{\n    return VIR_IDENTITY(g_object_new(VIR_TYPE_IDENTITY, NULL));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nvirIdentityPtr virIdentityGetSystem(void)\n{\n    g_autofree char *username = NULL;\n    g_autofree char *groupname = NULL;\n    unsigned long long startTime;\n    g_autoptr(virIdentity) ret = NULL;\n#if WITH_SELINUX\n    security_context_t con;\n#endif\n\n    if (!(ret = virIdentityNew()))\n        return NULL;\n\n    if (virIdentitySetProcessID(ret, getpid()) < 0)\n        return NULL;\n\n    if (virProcessGetStartTime(getpid(), &startTime) < 0)\n        return NULL;\n    if (startTime != 0 &&\n        virIdentitySetProcessTime(ret, startTime) < 0)\n        return NULL;\n\n    if (!(username = virGetUserName(geteuid())))\n        return ret;\n    if (virIdentitySetUserName(ret, username) < 0)\n        return NULL;\n    if (virIdentitySetUNIXUserID(ret, getuid()) < 0)\n        return NULL;\n\n    if (!(groupname = virGetGroupName(getegid())))\n        return ret;\n    if (virIdentitySetGroupName(ret, groupname) < 0)\n        return NULL;\n    if (virIdentitySetUNIXGroupID(ret, getgid()) < 0)\n        return NULL;\n\n#if WITH_SELINUX\n    if (is_selinux_enabled() > 0) {\n        if (getcon(&con) < 0) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to lookup SELinux process context\"));\n            return NULL;\n        }\n        if (virIdentitySetSELinuxContext(ret, con) < 0) {\n            freecon(con);\n            return NULL;\n        }\n        freecon(con);\n    }\n#endif\n\n    return g_steal_pointer(&ret);\n}"
  },
  {
    "function_name": "virIdentitySetCurrent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "123-142",
    "snippet": "int virIdentitySetCurrent(virIdentityPtr ident)\n{\n    g_autoptr(virIdentity) old = NULL;\n\n    if (virIdentityInitialize() < 0)\n        return -1;\n\n    old = virThreadLocalGet(&virIdentityCurrent);\n\n    if (virThreadLocalSet(&virIdentityCurrent,\n                          ident ? g_object_ref(ident) : NULL) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to set thread local identity\"));\n        if (ident)\n            g_object_unref(ident);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virThreadLocal virIdentityCurrent;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_object_unref",
          "args": [
            "ident"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Unable to set thread local identity\")"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to set thread local identity\""
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "vir_identity_class_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "83-88",
          "snippet": "static void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virIdentityFinalize(GObject *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void virIdentityFinalize(GObject *obj);\n\nstatic void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virThreadLocalSet",
          "args": [
            "&virIdentityCurrent",
            "ident ? g_object_ref(ident) : NULL"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadLocalSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "352-360",
          "snippet": "int virThreadLocalSet(virThreadLocalPtr l, void *val)\n{\n    int err = pthread_setspecific(l->key, val);\n    if (err) {\n        errno = err;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virThreadLocalSet(virThreadLocalPtr l, void *val)\n{\n    int err = pthread_setspecific(l->key, val);\n    if (err) {\n        errno = err;\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_object_ref",
          "args": [
            "ident"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virThreadLocalGet",
          "args": [
            "&virIdentityCurrent"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadLocalGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "347-350",
          "snippet": "void *virThreadLocalGet(virThreadLocalPtr l)\n{\n    return pthread_getspecific(l->key);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid *virThreadLocalGet(virThreadLocalPtr l)\n{\n    return pthread_getspecific(l->key);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virIdentityInitialize",
          "args": [],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virThreadLocal virIdentityCurrent;\n\nint virIdentitySetCurrent(virIdentityPtr ident)\n{\n    g_autoptr(virIdentity) old = NULL;\n\n    if (virIdentityInitialize() < 0)\n        return -1;\n\n    old = virThreadLocalGet(&virIdentityCurrent);\n\n    if (virThreadLocalSet(&virIdentityCurrent,\n                          ident ? g_object_ref(ident) : NULL) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to set thread local identity\"));\n        if (ident)\n            g_object_unref(ident);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virIdentityGetCurrent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "100-111",
    "snippet": "virIdentityPtr virIdentityGetCurrent(void)\n{\n    virIdentityPtr ident;\n\n    if (virIdentityInitialize() < 0)\n        return NULL;\n\n    ident = virThreadLocalGet(&virIdentityCurrent);\n    if (ident)\n        g_object_ref(ident);\n    return ident;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virThreadLocal virIdentityCurrent;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_object_ref",
          "args": [
            "ident"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virThreadLocalGet",
          "args": [
            "&virIdentityCurrent"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadLocalGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "347-350",
          "snippet": "void *virThreadLocalGet(virThreadLocalPtr l)\n{\n    return pthread_getspecific(l->key);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid *virThreadLocalGet(virThreadLocalPtr l)\n{\n    return pthread_getspecific(l->key);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virIdentityInitialize",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virThreadLocal virIdentityCurrent;\n\nvirIdentityPtr virIdentityGetCurrent(void)\n{\n    virIdentityPtr ident;\n\n    if (virIdentityInitialize() < 0)\n        return NULL;\n\n    ident = virThreadLocalGet(&virIdentityCurrent);\n    if (ident)\n        g_object_ref(ident);\n    return ident;\n}"
  },
  {
    "function_name": "vir_identity_class_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "83-88",
    "snippet": "static void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virIdentityFinalize(GObject *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "G_OBJECT_CLASS",
          "args": [
            "klass"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void virIdentityFinalize(GObject *obj);\n\nstatic void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}"
  },
  {
    "function_name": "vir_identity_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "79-81",
    "snippet": "static void vir_identity_init(virIdentity *ident G_GNUC_UNUSED)\n{\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void vir_identity_init(virIdentity *ident G_GNUC_UNUSED)\n{\n}"
  },
  {
    "function_name": "virIdentityOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "65-75",
    "snippet": "static int virIdentityOnceInit(void)\n{\n    if (virThreadLocalInit(&virIdentityCurrent,\n                           virIdentityCurrentCleanup) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot initialize thread local for current identity\"));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virThreadLocal virIdentityCurrent;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot initialize thread local for current identity\")"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot initialize thread local for current identity\""
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "vir_identity_class_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "83-88",
          "snippet": "static void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virIdentityFinalize(GObject *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void virIdentityFinalize(GObject *obj);\n\nstatic void vir_identity_class_init(virIdentityClass *klass)\n{\n    GObjectClass *obj = G_OBJECT_CLASS(klass);\n\n    obj->finalize = virIdentityFinalize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virThreadLocalInit",
          "args": [
            "&virIdentityCurrent",
            "virIdentityCurrentCleanup"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadLocalInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "336-345",
          "snippet": "int virThreadLocalInit(virThreadLocalPtr l,\n                       virThreadLocalCleanup c)\n{\n    int ret;\n    if ((ret = pthread_key_create(&l->key, c)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virThreadLocalInit(virThreadLocalPtr l,\n                       virThreadLocalCleanup c)\n{\n    int ret;\n    if ((ret = pthread_key_create(&l->key, c)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virThreadLocal virIdentityCurrent;\n\nstatic int virIdentityOnceInit(void)\n{\n    if (virThreadLocalInit(&virIdentityCurrent,\n                           virIdentityCurrentCleanup) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot initialize thread local for current identity\"));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virIdentityCurrentCleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
    "lines": "59-63",
    "snippet": "static void virIdentityCurrentCleanup(void *ident)\n{\n    if (ident)\n        g_object_unref(ident);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virprocess.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "# include <selinux/selinux.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_object_unref",
          "args": [
            "ident"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void virIdentityCurrentCleanup(void *ident)\n{\n    if (ident)\n        g_object_unref(ident);\n}"
  }
]