[
  {
    "function_name": "daemonConfigLoadData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/remote/remote_daemon_config.c",
    "lines": "397-408",
    "snippet": "int daemonConfigLoadData(struct daemonConfig *data,\n                         const char *filename,\n                         const char *filedata)\n{\n    g_autoptr(virConf) conf = NULL;\n\n    conf = virConfReadString(filedata, 0);\n    if (!conf)\n        return -1;\n\n    return daemonConfigLoadOptions(data, filename, conf);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"util/virnetdevopenvswitch.h\"",
      "#include \"remote_driver.h\"",
      "#include \"remote_protocol.h\"",
      "#include \"configmake.h\"",
      "#include \"rpc/virnetserver.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"remote_daemon_config.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "daemonConfigLoadOptions",
          "args": [
            "data",
            "filename",
            "conf"
          ],
          "line": 407
        },
        "resolved": true,
        "details": {
          "function_name": "daemonConfigLoadOptions",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/remote/remote_daemon_config.c",
          "lines": "226-372",
          "snippet": "static int\ndaemonConfigLoadOptions(struct daemonConfig *data,\n                        const char *filename,\n                        virConfPtr conf)\n{\n#ifdef WITH_IP\n    if (virConfGetValueBool(conf, \"listen_tcp\", &data->listen_tcp) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"listen_tls\", &data->listen_tls) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"tls_port\", &data->tls_port) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"tcp_port\", &data->tcp_port) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"listen_addr\", &data->listen_addr) < 0)\n        return -1;\n#endif /* !WITH_IP */\n\n    if (remoteConfigGetAuth(conf, filename, \"auth_unix_rw\", &data->auth_unix_rw) < 0)\n        return -1;\n#if WITH_POLKIT\n    /* Change default perms to be wide-open if PolicyKit is enabled.\n     * Admin can always override in config file\n     */\n    if (data->auth_unix_rw == REMOTE_AUTH_POLKIT) {\n        VIR_FREE(data->unix_sock_rw_perms);\n        data->unix_sock_rw_perms = g_strdup(\"0777\");\n    }\n#endif\n    if (remoteConfigGetAuth(conf, filename, \"auth_unix_ro\", &data->auth_unix_ro) < 0)\n        return -1;\n\n#ifdef WITH_IP\n    if (remoteConfigGetAuth(conf, filename, \"auth_tcp\", &data->auth_tcp) < 0)\n        return -1;\n    if (remoteConfigGetAuth(conf, filename, \"auth_tls\", &data->auth_tls) < 0)\n        return -1;\n#endif /* ! WITH_IP */\n\n    if (virConfGetValueStringList(conf, \"access_drivers\", false,\n                                  &data->access_drivers) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"unix_sock_group\", &data->unix_sock_group) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_admin_perms\", &data->unix_sock_admin_perms) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_ro_perms\", &data->unix_sock_ro_perms) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_rw_perms\", &data->unix_sock_rw_perms) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"unix_sock_dir\", &data->unix_sock_dir) < 0)\n        return -1;\n\n#ifdef WITH_IP\n    if (virConfGetValueBool(conf, \"tls_no_sanity_certificate\", &data->tls_no_sanity_certificate) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"tls_no_verify_certificate\", &data->tls_no_verify_certificate) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"key_file\", &data->key_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"cert_file\", &data->cert_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"ca_file\", &data->ca_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"crl_file\", &data->crl_file) < 0)\n        return -1;\n\n    if (virConfGetValueStringList(conf, \"tls_allowed_dn_list\", false,\n                                  &data->tls_allowed_dn_list) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"tls_priority\", &data->tls_priority) < 0)\n        return -1;\n#endif /* ! WITH_IP */\n\n    if (virConfGetValueStringList(conf, \"sasl_allowed_username_list\", false,\n                                  &data->sasl_allowed_username_list) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"min_workers\", &data->min_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_workers\", &data->max_workers) < 0)\n        return -1;\n    if (data->max_workers < 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"'max_workers' must be greater than 0\"));\n        return -1;\n    }\n    if (virConfGetValueUInt(conf, \"max_clients\", &data->max_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_queued_clients\", &data->max_queued_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_anonymous_clients\", &data->max_anonymous_clients) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"prio_workers\", &data->prio_workers) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"max_client_requests\", &data->max_client_requests) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"admin_min_workers\", &data->admin_min_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_workers\", &data->admin_max_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_clients\", &data->admin_max_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_queued_clients\", &data->admin_max_queued_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_client_requests\", &data->admin_max_client_requests) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"audit_level\", &data->audit_level) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"audit_logging\", &data->audit_logging) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"host_uuid\", &data->host_uuid) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"host_uuid_source\", &data->host_uuid_source) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"log_level\", &data->log_level) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_filters\", &data->log_filters) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_outputs\", &data->log_outputs) < 0)\n        return -1;\n\n    if (virConfGetValueInt(conf, \"keepalive_interval\", &data->keepalive_interval) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"keepalive_count\", &data->keepalive_count) < 0)\n        return -1;\n\n    if (virConfGetValueInt(conf, \"admin_keepalive_interval\", &data->admin_keepalive_interval) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_keepalive_count\", &data->admin_keepalive_count) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"ovs_timeout\", &data->ovs_timeout) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"util/virnetdevopenvswitch.h\"",
            "#include \"remote_driver.h\"",
            "#include \"remote_protocol.h\"",
            "#include \"configmake.h\"",
            "#include \"rpc/virnetserver.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"remote_daemon_config.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"util/virnetdevopenvswitch.h\"\n#include \"remote_driver.h\"\n#include \"remote_protocol.h\"\n#include \"configmake.h\"\n#include \"rpc/virnetserver.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"remote_daemon_config.h\"\n#include <config.h>\n\nstatic int\ndaemonConfigLoadOptions(struct daemonConfig *data,\n                        const char *filename,\n                        virConfPtr conf)\n{\n#ifdef WITH_IP\n    if (virConfGetValueBool(conf, \"listen_tcp\", &data->listen_tcp) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"listen_tls\", &data->listen_tls) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"tls_port\", &data->tls_port) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"tcp_port\", &data->tcp_port) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"listen_addr\", &data->listen_addr) < 0)\n        return -1;\n#endif /* !WITH_IP */\n\n    if (remoteConfigGetAuth(conf, filename, \"auth_unix_rw\", &data->auth_unix_rw) < 0)\n        return -1;\n#if WITH_POLKIT\n    /* Change default perms to be wide-open if PolicyKit is enabled.\n     * Admin can always override in config file\n     */\n    if (data->auth_unix_rw == REMOTE_AUTH_POLKIT) {\n        VIR_FREE(data->unix_sock_rw_perms);\n        data->unix_sock_rw_perms = g_strdup(\"0777\");\n    }\n#endif\n    if (remoteConfigGetAuth(conf, filename, \"auth_unix_ro\", &data->auth_unix_ro) < 0)\n        return -1;\n\n#ifdef WITH_IP\n    if (remoteConfigGetAuth(conf, filename, \"auth_tcp\", &data->auth_tcp) < 0)\n        return -1;\n    if (remoteConfigGetAuth(conf, filename, \"auth_tls\", &data->auth_tls) < 0)\n        return -1;\n#endif /* ! WITH_IP */\n\n    if (virConfGetValueStringList(conf, \"access_drivers\", false,\n                                  &data->access_drivers) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"unix_sock_group\", &data->unix_sock_group) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_admin_perms\", &data->unix_sock_admin_perms) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_ro_perms\", &data->unix_sock_ro_perms) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_rw_perms\", &data->unix_sock_rw_perms) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"unix_sock_dir\", &data->unix_sock_dir) < 0)\n        return -1;\n\n#ifdef WITH_IP\n    if (virConfGetValueBool(conf, \"tls_no_sanity_certificate\", &data->tls_no_sanity_certificate) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"tls_no_verify_certificate\", &data->tls_no_verify_certificate) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"key_file\", &data->key_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"cert_file\", &data->cert_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"ca_file\", &data->ca_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"crl_file\", &data->crl_file) < 0)\n        return -1;\n\n    if (virConfGetValueStringList(conf, \"tls_allowed_dn_list\", false,\n                                  &data->tls_allowed_dn_list) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"tls_priority\", &data->tls_priority) < 0)\n        return -1;\n#endif /* ! WITH_IP */\n\n    if (virConfGetValueStringList(conf, \"sasl_allowed_username_list\", false,\n                                  &data->sasl_allowed_username_list) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"min_workers\", &data->min_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_workers\", &data->max_workers) < 0)\n        return -1;\n    if (data->max_workers < 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"'max_workers' must be greater than 0\"));\n        return -1;\n    }\n    if (virConfGetValueUInt(conf, \"max_clients\", &data->max_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_queued_clients\", &data->max_queued_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_anonymous_clients\", &data->max_anonymous_clients) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"prio_workers\", &data->prio_workers) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"max_client_requests\", &data->max_client_requests) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"admin_min_workers\", &data->admin_min_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_workers\", &data->admin_max_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_clients\", &data->admin_max_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_queued_clients\", &data->admin_max_queued_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_client_requests\", &data->admin_max_client_requests) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"audit_level\", &data->audit_level) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"audit_logging\", &data->audit_logging) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"host_uuid\", &data->host_uuid) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"host_uuid_source\", &data->host_uuid_source) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"log_level\", &data->log_level) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_filters\", &data->log_filters) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_outputs\", &data->log_outputs) < 0)\n        return -1;\n\n    if (virConfGetValueInt(conf, \"keepalive_interval\", &data->keepalive_interval) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"keepalive_count\", &data->keepalive_count) < 0)\n        return -1;\n\n    if (virConfGetValueInt(conf, \"admin_keepalive_interval\", &data->admin_keepalive_interval) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_keepalive_count\", &data->admin_keepalive_count) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"ovs_timeout\", &data->ovs_timeout) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfReadString",
          "args": [
            "filedata",
            "0"
          ],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "virConfReadString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "765-777",
          "snippet": "virConfPtr\nvirConfReadString(const char *memory, unsigned int flags)\n{\n    size_t len;\n\n    if (memory == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    len = strlen(memory);\n    return virConfParse(\"memory conf\", memory, len, flags);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfPtr\nvirConfReadString(const char *memory, unsigned int flags)\n{\n    size_t len;\n\n    if (memory == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    len = strlen(memory);\n    return virConfParse(\"memory conf\", memory, len, flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"util/virnetdevopenvswitch.h\"\n#include \"remote_driver.h\"\n#include \"remote_protocol.h\"\n#include \"configmake.h\"\n#include \"rpc/virnetserver.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"remote_daemon_config.h\"\n#include <config.h>\n\nint daemonConfigLoadData(struct daemonConfig *data,\n                         const char *filename,\n                         const char *filedata)\n{\n    g_autoptr(virConf) conf = NULL;\n\n    conf = virConfReadString(filedata, 0);\n    if (!conf)\n        return -1;\n\n    return daemonConfigLoadOptions(data, filename, conf);\n}"
  },
  {
    "function_name": "daemonConfigLoadFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/remote/remote_daemon_config.c",
    "lines": "378-395",
    "snippet": "int\ndaemonConfigLoadFile(struct daemonConfig *data,\n                     const char *filename,\n                     bool allow_missing)\n{\n    g_autoptr(virConf) conf = NULL;\n\n    if (allow_missing &&\n        access(filename, R_OK) == -1 &&\n        errno == ENOENT)\n        return 0;\n\n    conf = virConfReadFile(filename, 0);\n    if (!conf)\n        return -1;\n\n    return daemonConfigLoadOptions(data, filename, conf);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"util/virnetdevopenvswitch.h\"",
      "#include \"remote_driver.h\"",
      "#include \"remote_protocol.h\"",
      "#include \"configmake.h\"",
      "#include \"rpc/virnetserver.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"remote_daemon_config.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "daemonConfigLoadOptions",
          "args": [
            "data",
            "filename",
            "conf"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "daemonConfigLoadOptions",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/remote/remote_daemon_config.c",
          "lines": "226-372",
          "snippet": "static int\ndaemonConfigLoadOptions(struct daemonConfig *data,\n                        const char *filename,\n                        virConfPtr conf)\n{\n#ifdef WITH_IP\n    if (virConfGetValueBool(conf, \"listen_tcp\", &data->listen_tcp) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"listen_tls\", &data->listen_tls) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"tls_port\", &data->tls_port) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"tcp_port\", &data->tcp_port) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"listen_addr\", &data->listen_addr) < 0)\n        return -1;\n#endif /* !WITH_IP */\n\n    if (remoteConfigGetAuth(conf, filename, \"auth_unix_rw\", &data->auth_unix_rw) < 0)\n        return -1;\n#if WITH_POLKIT\n    /* Change default perms to be wide-open if PolicyKit is enabled.\n     * Admin can always override in config file\n     */\n    if (data->auth_unix_rw == REMOTE_AUTH_POLKIT) {\n        VIR_FREE(data->unix_sock_rw_perms);\n        data->unix_sock_rw_perms = g_strdup(\"0777\");\n    }\n#endif\n    if (remoteConfigGetAuth(conf, filename, \"auth_unix_ro\", &data->auth_unix_ro) < 0)\n        return -1;\n\n#ifdef WITH_IP\n    if (remoteConfigGetAuth(conf, filename, \"auth_tcp\", &data->auth_tcp) < 0)\n        return -1;\n    if (remoteConfigGetAuth(conf, filename, \"auth_tls\", &data->auth_tls) < 0)\n        return -1;\n#endif /* ! WITH_IP */\n\n    if (virConfGetValueStringList(conf, \"access_drivers\", false,\n                                  &data->access_drivers) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"unix_sock_group\", &data->unix_sock_group) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_admin_perms\", &data->unix_sock_admin_perms) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_ro_perms\", &data->unix_sock_ro_perms) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_rw_perms\", &data->unix_sock_rw_perms) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"unix_sock_dir\", &data->unix_sock_dir) < 0)\n        return -1;\n\n#ifdef WITH_IP\n    if (virConfGetValueBool(conf, \"tls_no_sanity_certificate\", &data->tls_no_sanity_certificate) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"tls_no_verify_certificate\", &data->tls_no_verify_certificate) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"key_file\", &data->key_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"cert_file\", &data->cert_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"ca_file\", &data->ca_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"crl_file\", &data->crl_file) < 0)\n        return -1;\n\n    if (virConfGetValueStringList(conf, \"tls_allowed_dn_list\", false,\n                                  &data->tls_allowed_dn_list) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"tls_priority\", &data->tls_priority) < 0)\n        return -1;\n#endif /* ! WITH_IP */\n\n    if (virConfGetValueStringList(conf, \"sasl_allowed_username_list\", false,\n                                  &data->sasl_allowed_username_list) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"min_workers\", &data->min_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_workers\", &data->max_workers) < 0)\n        return -1;\n    if (data->max_workers < 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"'max_workers' must be greater than 0\"));\n        return -1;\n    }\n    if (virConfGetValueUInt(conf, \"max_clients\", &data->max_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_queued_clients\", &data->max_queued_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_anonymous_clients\", &data->max_anonymous_clients) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"prio_workers\", &data->prio_workers) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"max_client_requests\", &data->max_client_requests) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"admin_min_workers\", &data->admin_min_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_workers\", &data->admin_max_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_clients\", &data->admin_max_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_queued_clients\", &data->admin_max_queued_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_client_requests\", &data->admin_max_client_requests) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"audit_level\", &data->audit_level) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"audit_logging\", &data->audit_logging) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"host_uuid\", &data->host_uuid) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"host_uuid_source\", &data->host_uuid_source) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"log_level\", &data->log_level) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_filters\", &data->log_filters) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_outputs\", &data->log_outputs) < 0)\n        return -1;\n\n    if (virConfGetValueInt(conf, \"keepalive_interval\", &data->keepalive_interval) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"keepalive_count\", &data->keepalive_count) < 0)\n        return -1;\n\n    if (virConfGetValueInt(conf, \"admin_keepalive_interval\", &data->admin_keepalive_interval) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_keepalive_count\", &data->admin_keepalive_count) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"ovs_timeout\", &data->ovs_timeout) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"util/virnetdevopenvswitch.h\"",
            "#include \"remote_driver.h\"",
            "#include \"remote_protocol.h\"",
            "#include \"configmake.h\"",
            "#include \"rpc/virnetserver.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"remote_daemon_config.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"util/virnetdevopenvswitch.h\"\n#include \"remote_driver.h\"\n#include \"remote_protocol.h\"\n#include \"configmake.h\"\n#include \"rpc/virnetserver.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"remote_daemon_config.h\"\n#include <config.h>\n\nstatic int\ndaemonConfigLoadOptions(struct daemonConfig *data,\n                        const char *filename,\n                        virConfPtr conf)\n{\n#ifdef WITH_IP\n    if (virConfGetValueBool(conf, \"listen_tcp\", &data->listen_tcp) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"listen_tls\", &data->listen_tls) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"tls_port\", &data->tls_port) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"tcp_port\", &data->tcp_port) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"listen_addr\", &data->listen_addr) < 0)\n        return -1;\n#endif /* !WITH_IP */\n\n    if (remoteConfigGetAuth(conf, filename, \"auth_unix_rw\", &data->auth_unix_rw) < 0)\n        return -1;\n#if WITH_POLKIT\n    /* Change default perms to be wide-open if PolicyKit is enabled.\n     * Admin can always override in config file\n     */\n    if (data->auth_unix_rw == REMOTE_AUTH_POLKIT) {\n        VIR_FREE(data->unix_sock_rw_perms);\n        data->unix_sock_rw_perms = g_strdup(\"0777\");\n    }\n#endif\n    if (remoteConfigGetAuth(conf, filename, \"auth_unix_ro\", &data->auth_unix_ro) < 0)\n        return -1;\n\n#ifdef WITH_IP\n    if (remoteConfigGetAuth(conf, filename, \"auth_tcp\", &data->auth_tcp) < 0)\n        return -1;\n    if (remoteConfigGetAuth(conf, filename, \"auth_tls\", &data->auth_tls) < 0)\n        return -1;\n#endif /* ! WITH_IP */\n\n    if (virConfGetValueStringList(conf, \"access_drivers\", false,\n                                  &data->access_drivers) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"unix_sock_group\", &data->unix_sock_group) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_admin_perms\", &data->unix_sock_admin_perms) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_ro_perms\", &data->unix_sock_ro_perms) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_rw_perms\", &data->unix_sock_rw_perms) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"unix_sock_dir\", &data->unix_sock_dir) < 0)\n        return -1;\n\n#ifdef WITH_IP\n    if (virConfGetValueBool(conf, \"tls_no_sanity_certificate\", &data->tls_no_sanity_certificate) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"tls_no_verify_certificate\", &data->tls_no_verify_certificate) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"key_file\", &data->key_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"cert_file\", &data->cert_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"ca_file\", &data->ca_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"crl_file\", &data->crl_file) < 0)\n        return -1;\n\n    if (virConfGetValueStringList(conf, \"tls_allowed_dn_list\", false,\n                                  &data->tls_allowed_dn_list) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"tls_priority\", &data->tls_priority) < 0)\n        return -1;\n#endif /* ! WITH_IP */\n\n    if (virConfGetValueStringList(conf, \"sasl_allowed_username_list\", false,\n                                  &data->sasl_allowed_username_list) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"min_workers\", &data->min_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_workers\", &data->max_workers) < 0)\n        return -1;\n    if (data->max_workers < 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"'max_workers' must be greater than 0\"));\n        return -1;\n    }\n    if (virConfGetValueUInt(conf, \"max_clients\", &data->max_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_queued_clients\", &data->max_queued_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_anonymous_clients\", &data->max_anonymous_clients) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"prio_workers\", &data->prio_workers) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"max_client_requests\", &data->max_client_requests) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"admin_min_workers\", &data->admin_min_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_workers\", &data->admin_max_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_clients\", &data->admin_max_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_queued_clients\", &data->admin_max_queued_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_client_requests\", &data->admin_max_client_requests) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"audit_level\", &data->audit_level) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"audit_logging\", &data->audit_logging) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"host_uuid\", &data->host_uuid) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"host_uuid_source\", &data->host_uuid_source) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"log_level\", &data->log_level) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_filters\", &data->log_filters) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_outputs\", &data->log_outputs) < 0)\n        return -1;\n\n    if (virConfGetValueInt(conf, \"keepalive_interval\", &data->keepalive_interval) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"keepalive_count\", &data->keepalive_count) < 0)\n        return -1;\n\n    if (virConfGetValueInt(conf, \"admin_keepalive_interval\", &data->admin_keepalive_interval) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_keepalive_count\", &data->admin_keepalive_count) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"ovs_timeout\", &data->ovs_timeout) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfReadFile",
          "args": [
            "filename",
            "0"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "virConfReadFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "730-752",
          "snippet": "virConfPtr\nvirConfReadFile(const char *filename, unsigned int flags)\n{\n    char *content;\n    int len;\n    virConfPtr conf;\n\n    VIR_DEBUG(\"filename=%s\", NULLSTR(filename));\n\n    if (filename == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    if ((len = virFileReadAll(filename, MAX_CONFIG_FILE_SIZE, &content)) < 0)\n        return NULL;\n\n    conf = virConfParse(filename, content, len, flags);\n\n    VIR_FREE(content);\n\n    return conf;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_CONFIG_FILE_SIZE (1024*1024*10)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define MAX_CONFIG_FILE_SIZE (1024*1024*10)\n\nvirConfPtr\nvirConfReadFile(const char *filename, unsigned int flags)\n{\n    char *content;\n    int len;\n    virConfPtr conf;\n\n    VIR_DEBUG(\"filename=%s\", NULLSTR(filename));\n\n    if (filename == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    if ((len = virFileReadAll(filename, MAX_CONFIG_FILE_SIZE, &content)) < 0)\n        return NULL;\n\n    conf = virConfParse(filename, content, len, flags);\n\n    VIR_FREE(content);\n\n    return conf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "filename",
            "R_OK"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"util/virnetdevopenvswitch.h\"\n#include \"remote_driver.h\"\n#include \"remote_protocol.h\"\n#include \"configmake.h\"\n#include \"rpc/virnetserver.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"remote_daemon_config.h\"\n#include <config.h>\n\nint\ndaemonConfigLoadFile(struct daemonConfig *data,\n                     const char *filename,\n                     bool allow_missing)\n{\n    g_autoptr(virConf) conf = NULL;\n\n    if (allow_missing &&\n        access(filename, R_OK) == -1 &&\n        errno == ENOENT)\n        return 0;\n\n    conf = virConfReadFile(filename, 0);\n    if (!conf)\n        return -1;\n\n    return daemonConfigLoadOptions(data, filename, conf);\n}"
  },
  {
    "function_name": "daemonConfigLoadOptions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/remote/remote_daemon_config.c",
    "lines": "226-372",
    "snippet": "static int\ndaemonConfigLoadOptions(struct daemonConfig *data,\n                        const char *filename,\n                        virConfPtr conf)\n{\n#ifdef WITH_IP\n    if (virConfGetValueBool(conf, \"listen_tcp\", &data->listen_tcp) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"listen_tls\", &data->listen_tls) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"tls_port\", &data->tls_port) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"tcp_port\", &data->tcp_port) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"listen_addr\", &data->listen_addr) < 0)\n        return -1;\n#endif /* !WITH_IP */\n\n    if (remoteConfigGetAuth(conf, filename, \"auth_unix_rw\", &data->auth_unix_rw) < 0)\n        return -1;\n#if WITH_POLKIT\n    /* Change default perms to be wide-open if PolicyKit is enabled.\n     * Admin can always override in config file\n     */\n    if (data->auth_unix_rw == REMOTE_AUTH_POLKIT) {\n        VIR_FREE(data->unix_sock_rw_perms);\n        data->unix_sock_rw_perms = g_strdup(\"0777\");\n    }\n#endif\n    if (remoteConfigGetAuth(conf, filename, \"auth_unix_ro\", &data->auth_unix_ro) < 0)\n        return -1;\n\n#ifdef WITH_IP\n    if (remoteConfigGetAuth(conf, filename, \"auth_tcp\", &data->auth_tcp) < 0)\n        return -1;\n    if (remoteConfigGetAuth(conf, filename, \"auth_tls\", &data->auth_tls) < 0)\n        return -1;\n#endif /* ! WITH_IP */\n\n    if (virConfGetValueStringList(conf, \"access_drivers\", false,\n                                  &data->access_drivers) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"unix_sock_group\", &data->unix_sock_group) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_admin_perms\", &data->unix_sock_admin_perms) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_ro_perms\", &data->unix_sock_ro_perms) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_rw_perms\", &data->unix_sock_rw_perms) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"unix_sock_dir\", &data->unix_sock_dir) < 0)\n        return -1;\n\n#ifdef WITH_IP\n    if (virConfGetValueBool(conf, \"tls_no_sanity_certificate\", &data->tls_no_sanity_certificate) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"tls_no_verify_certificate\", &data->tls_no_verify_certificate) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"key_file\", &data->key_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"cert_file\", &data->cert_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"ca_file\", &data->ca_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"crl_file\", &data->crl_file) < 0)\n        return -1;\n\n    if (virConfGetValueStringList(conf, \"tls_allowed_dn_list\", false,\n                                  &data->tls_allowed_dn_list) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"tls_priority\", &data->tls_priority) < 0)\n        return -1;\n#endif /* ! WITH_IP */\n\n    if (virConfGetValueStringList(conf, \"sasl_allowed_username_list\", false,\n                                  &data->sasl_allowed_username_list) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"min_workers\", &data->min_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_workers\", &data->max_workers) < 0)\n        return -1;\n    if (data->max_workers < 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"'max_workers' must be greater than 0\"));\n        return -1;\n    }\n    if (virConfGetValueUInt(conf, \"max_clients\", &data->max_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_queued_clients\", &data->max_queued_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_anonymous_clients\", &data->max_anonymous_clients) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"prio_workers\", &data->prio_workers) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"max_client_requests\", &data->max_client_requests) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"admin_min_workers\", &data->admin_min_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_workers\", &data->admin_max_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_clients\", &data->admin_max_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_queued_clients\", &data->admin_max_queued_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_client_requests\", &data->admin_max_client_requests) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"audit_level\", &data->audit_level) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"audit_logging\", &data->audit_logging) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"host_uuid\", &data->host_uuid) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"host_uuid_source\", &data->host_uuid_source) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"log_level\", &data->log_level) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_filters\", &data->log_filters) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_outputs\", &data->log_outputs) < 0)\n        return -1;\n\n    if (virConfGetValueInt(conf, \"keepalive_interval\", &data->keepalive_interval) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"keepalive_count\", &data->keepalive_count) < 0)\n        return -1;\n\n    if (virConfGetValueInt(conf, \"admin_keepalive_interval\", &data->admin_keepalive_interval) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_keepalive_count\", &data->admin_keepalive_count) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"ovs_timeout\", &data->ovs_timeout) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"util/virnetdevopenvswitch.h\"",
      "#include \"remote_driver.h\"",
      "#include \"remote_protocol.h\"",
      "#include \"configmake.h\"",
      "#include \"rpc/virnetserver.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"remote_daemon_config.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfGetValueUInt",
          "args": [
            "conf",
            "\"ovs_timeout\"",
            "&data->ovs_timeout"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueUInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1099-1128",
          "snippet": "int virConfGetValueUInt(virConfPtr conf,\n                        const char *setting,\n                        unsigned int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value uint %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > UINT_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%u\"),\n                       conf->filename, setting, UINT_MAX);\n        return -1;\n    }\n\n    *value = (unsigned int)cval->l;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueUInt(virConfPtr conf,\n                        const char *setting,\n                        unsigned int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value uint %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > UINT_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%u\"),\n                       conf->filename, setting, UINT_MAX);\n        return -1;\n    }\n\n    *value = (unsigned int)cval->l;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueInt",
          "args": [
            "conf",
            "\"admin_keepalive_interval\"",
            "&data->admin_keepalive_interval"
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1050-1080",
          "snippet": "int virConfGetValueInt(virConfPtr conf,\n                       const char *setting,\n                       int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value int %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_LLONG &&\n        cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a signed integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (cval->l > INT_MAX || cval->l < INT_MIN) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range %d:%d\"),\n                       conf->filename, setting, INT_MIN, INT_MAX);\n        return -1;\n    }\n\n    *value = (int)cval->l;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueInt(virConfPtr conf,\n                       const char *setting,\n                       int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value int %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_LLONG &&\n        cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a signed integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (cval->l > INT_MAX || cval->l < INT_MIN) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range %d:%d\"),\n                       conf->filename, setting, INT_MIN, INT_MAX);\n        return -1;\n    }\n\n    *value = (int)cval->l;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "conf",
            "\"log_outputs\"",
            "&data->log_outputs"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueBool",
          "args": [
            "conf",
            "\"audit_logging\"",
            "&data->audit_logging"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueBool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1002-1031",
          "snippet": "int virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"'max_workers' must be greater than 0\")"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"'max_workers' must be greater than 0\""
          ],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/remote/remote_daemon.c",
          "lines": "378-422",
          "snippet": "static int ATTRIBUTE_NONNULL(3)\ndaemonSetupNetworking(virNetServerPtr srv,\n                      virNetServerPtr srvAdm,\n                      struct daemonConfig *config,\n#ifdef WITH_IP\n                      bool ipsock,\n                      bool privileged,\n#endif /* ! WITH_IP */\n                      const char *sock_path,\n                      const char *sock_path_ro,\n                      const char *sock_path_adm)\n{\n    gid_t unix_sock_gid = 0;\n    int unix_sock_ro_mask = 0;\n    int unix_sock_rw_mask = 0;\n    int unix_sock_adm_mask = 0;\n    g_autoptr(virSystemdActivation) act = NULL;\n    virSystemdActivationMap actmap[] = {\n        { .name = DAEMON_NAME \".socket\", .family = AF_UNIX, .path = sock_path },\n        { .name = DAEMON_NAME \"-ro.socket\", .family = AF_UNIX, .path = sock_path_ro },\n        { .name = DAEMON_NAME \"-admin.socket\", .family = AF_UNIX, .path = sock_path_adm },\n#ifdef WITH_IP\n        { .name = DAEMON_NAME \"-tcp.socket\", .family = AF_INET },\n        { .name = DAEMON_NAME \"-tls.socket\", .family = AF_INET },\n#endif /* ! WITH_IP */\n    };\n\n#ifdef WITH_IP\n    if ((actmap[3].port = virSocketAddrResolveService(config->tcp_port)) < 0)\n        return -1;\n\n    if ((actmap[4].port = virSocketAddrResolveService(config->tls_port)) < 0)\n        return -1;\n#endif /* ! WITH_IP */\n\n    if (virSystemdGetActivation(actmap, G_N_ELEMENTS(actmap), &act) < 0)\n        return -1;\n\n#ifdef WITH_IP\n# ifdef LIBVIRTD\n    if (act && ipsock) {\n        VIR_ERROR(_(\"--listen parameter not permitted with systemd activation \"\n                    \"sockets, see 'man libvirtd' for further guidance\"));\n        return -1;\n    }",
          "includes": [
            "#include \"virdbus.h\"",
            "#include \"configmake.h\"",
            "#include \"driver.h\"",
            "#include \"virhostuptime.h\"",
            "#include \"virsystemd.h\"",
            "#include \"util/virnetdevopenvswitch.h\"",
            "#include \"virgettext.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessmanager.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virstring.h\"",
            "#include \"viraudit.h\"",
            "#include \"virhook.h\"",
            "#include \"remote_daemon_dispatch.h\"",
            "#include \"virnetdaemon.h\"",
            "#include \"virnetlink.h\"",
            "#include \"virconf.h\"",
            "#include \"viralloc.h\"",
            "#include \"remote_driver.h\"",
            "#include \"viruuid.h\"",
            "#include \"admin/admin_server_dispatch.h\"",
            "#include \"remote_daemon_config.h\"",
            "#include \"remote_daemon.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"libvirt_internal.h\"",
            "#include <grp.h>",
            "#include <getopt.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdbus.h\"\n#include \"configmake.h\"\n#include \"driver.h\"\n#include \"virhostuptime.h\"\n#include \"virsystemd.h\"\n#include \"util/virnetdevopenvswitch.h\"\n#include \"virgettext.h\"\n#include \"virutil.h\"\n#include \"viraccessmanager.h\"\n#include \"locking/lock_manager.h\"\n#include \"virstring.h\"\n#include \"viraudit.h\"\n#include \"virhook.h\"\n#include \"remote_daemon_dispatch.h\"\n#include \"virnetdaemon.h\"\n#include \"virnetlink.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"remote_driver.h\"\n#include \"viruuid.h\"\n#include \"admin/admin_server_dispatch.h\"\n#include \"remote_daemon_config.h\"\n#include \"remote_daemon.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"libvirt_internal.h\"\n#include <grp.h>\n#include <getopt.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int ATTRIBUTE_NONNULL(3)\ndaemonSetupNetworking(virNetServerPtr srv,\n                      virNetServerPtr srvAdm,\n                      struct daemonConfig *config,\n#ifdef WITH_IP\n                      bool ipsock,\n                      bool privileged,\n#endif /* ! WITH_IP */\n                      const char *sock_path,\n                      const char *sock_path_ro,\n                      const char *sock_path_adm)\n{\n    gid_t unix_sock_gid = 0;\n    int unix_sock_ro_mask = 0;\n    int unix_sock_rw_mask = 0;\n    int unix_sock_adm_mask = 0;\n    g_autoptr(virSystemdActivation) act = NULL;\n    virSystemdActivationMap actmap[] = {\n        { .name = DAEMON_NAME \".socket\", .family = AF_UNIX, .path = sock_path },\n        { .name = DAEMON_NAME \"-ro.socket\", .family = AF_UNIX, .path = sock_path_ro },\n        { .name = DAEMON_NAME \"-admin.socket\", .family = AF_UNIX, .path = sock_path_adm },\n#ifdef WITH_IP\n        { .name = DAEMON_NAME \"-tcp.socket\", .family = AF_INET },\n        { .name = DAEMON_NAME \"-tls.socket\", .family = AF_INET },\n#endif /* ! WITH_IP */\n    };\n\n#ifdef WITH_IP\n    if ((actmap[3].port = virSocketAddrResolveService(config->tcp_port)) < 0)\n        return -1;\n\n    if ((actmap[4].port = virSocketAddrResolveService(config->tls_port)) < 0)\n        return -1;\n#endif /* ! WITH_IP */\n\n    if (virSystemdGetActivation(actmap, G_N_ELEMENTS(actmap), &act) < 0)\n        return -1;\n\n#ifdef WITH_IP\n# ifdef LIBVIRTD\n    if (act && ipsock) {\n        VIR_ERROR(_(\"--listen parameter not permitted with systemd activation \"\n                    \"sockets, see 'man libvirtd' for further guidance\"));\n        return -1;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueStringList",
          "args": [
            "conf",
            "\"sasl_allowed_username_list\"",
            "false",
            "&data->sasl_allowed_username_list"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "920-984",
          "snippet": "int virConfGetValueStringList(virConfPtr conf,\n                              const char *setting,\n                              bool compatString,\n                              char ***values)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    size_t len;\n    virConfValuePtr eval;\n\n    VIR_DEBUG(\"Get value string list %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    virStringListFree(*values);\n    *values = NULL;\n\n    switch (cval->type) {\n    case VIR_CONF_LIST:\n        /* Calc length and check items */\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next) {\n            if (eval->type != VIR_CONF_STRING) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"%s: expected a string list for '%s' parameter\"),\n                               conf->filename, setting);\n                return -1;\n            }\n        }\n\n        if (VIR_ALLOC_N(*values, len + 1) < 0)\n            return -1;\n\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next)\n            (*values)[len] = g_strdup(eval->str);\n        break;\n\n    case VIR_CONF_STRING:\n        if (compatString) {\n            if (VIR_ALLOC_N(*values, cval->str ? 2 : 1) < 0)\n                return -1;\n            if (cval->str)\n                (*values)[0] = g_strdup(cval->str);\n            break;\n        }\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_CONF_LLONG:\n    case VIR_CONF_ULLONG:\n    case VIR_CONF_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       compatString ?\n                       _(\"%s: expected a string or string list for '%s' parameter\") :\n                       _(\"%s: expected a string list for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n\n    case VIR_CONF_LAST:\n    default:\n        virReportEnumRangeError(virConfType, cval->type);\n        return -1;\n    }\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueStringList(virConfPtr conf,\n                              const char *setting,\n                              bool compatString,\n                              char ***values)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    size_t len;\n    virConfValuePtr eval;\n\n    VIR_DEBUG(\"Get value string list %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    virStringListFree(*values);\n    *values = NULL;\n\n    switch (cval->type) {\n    case VIR_CONF_LIST:\n        /* Calc length and check items */\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next) {\n            if (eval->type != VIR_CONF_STRING) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"%s: expected a string list for '%s' parameter\"),\n                               conf->filename, setting);\n                return -1;\n            }\n        }\n\n        if (VIR_ALLOC_N(*values, len + 1) < 0)\n            return -1;\n\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next)\n            (*values)[len] = g_strdup(eval->str);\n        break;\n\n    case VIR_CONF_STRING:\n        if (compatString) {\n            if (VIR_ALLOC_N(*values, cval->str ? 2 : 1) < 0)\n                return -1;\n            if (cval->str)\n                (*values)[0] = g_strdup(cval->str);\n            break;\n        }\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_CONF_LLONG:\n    case VIR_CONF_ULLONG:\n    case VIR_CONF_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       compatString ?\n                       _(\"%s: expected a string or string list for '%s' parameter\") :\n                       _(\"%s: expected a string list for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n\n    case VIR_CONF_LAST:\n    default:\n        virReportEnumRangeError(virConfType, cval->type);\n        return -1;\n    }\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteConfigGetAuth",
          "args": [
            "conf",
            "filename",
            "\"auth_tls\"",
            "&data->auth_tls"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "remoteConfigGetAuth",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/remote/remote_daemon_config.c",
          "lines": "42-74",
          "snippet": "static int\nremoteConfigGetAuth(virConfPtr conf,\n                    const char *filename,\n                    const char *key,\n                    int *auth)\n{\n    char *authstr = NULL;\n\n    if (virConfGetValueString(conf, key, &authstr) < 0)\n        return -1;\n\n    if (!authstr)\n        return 0;\n\n    if (STREQ(authstr, \"none\")) {\n        *auth = VIR_NET_SERVER_SERVICE_AUTH_NONE;\n#if WITH_SASL\n    } else if (STREQ(authstr, \"sasl\")) {\n        *auth = VIR_NET_SERVER_SERVICE_AUTH_SASL;\n#endif\n    } else if (STREQ(authstr, \"polkit\")) {\n        *auth = VIR_NET_SERVER_SERVICE_AUTH_POLKIT;\n    } else {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"%s: %s: unsupported auth %s\"),\n                       filename, key, authstr);\n        VIR_FREE(authstr);\n        return -1;\n    }\n\n    VIR_FREE(authstr);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"util/virnetdevopenvswitch.h\"",
            "#include \"remote_driver.h\"",
            "#include \"remote_protocol.h\"",
            "#include \"configmake.h\"",
            "#include \"rpc/virnetserver.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"remote_daemon_config.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"util/virnetdevopenvswitch.h\"\n#include \"remote_driver.h\"\n#include \"remote_protocol.h\"\n#include \"configmake.h\"\n#include \"rpc/virnetserver.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"remote_daemon_config.h\"\n#include <config.h>\n\nstatic int\nremoteConfigGetAuth(virConfPtr conf,\n                    const char *filename,\n                    const char *key,\n                    int *auth)\n{\n    char *authstr = NULL;\n\n    if (virConfGetValueString(conf, key, &authstr) < 0)\n        return -1;\n\n    if (!authstr)\n        return 0;\n\n    if (STREQ(authstr, \"none\")) {\n        *auth = VIR_NET_SERVER_SERVICE_AUTH_NONE;\n#if WITH_SASL\n    } else if (STREQ(authstr, \"sasl\")) {\n        *auth = VIR_NET_SERVER_SERVICE_AUTH_SASL;\n#endif\n    } else if (STREQ(authstr, \"polkit\")) {\n        *auth = VIR_NET_SERVER_SERVICE_AUTH_POLKIT;\n    } else {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"%s: %s: unsupported auth %s\"),\n                       filename, key, authstr);\n        VIR_FREE(authstr);\n        return -1;\n    }\n\n    VIR_FREE(authstr);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"0777\""
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->unix_sock_rw_perms"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"util/virnetdevopenvswitch.h\"\n#include \"remote_driver.h\"\n#include \"remote_protocol.h\"\n#include \"configmake.h\"\n#include \"rpc/virnetserver.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"remote_daemon_config.h\"\n#include <config.h>\n\nstatic int\ndaemonConfigLoadOptions(struct daemonConfig *data,\n                        const char *filename,\n                        virConfPtr conf)\n{\n#ifdef WITH_IP\n    if (virConfGetValueBool(conf, \"listen_tcp\", &data->listen_tcp) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"listen_tls\", &data->listen_tls) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"tls_port\", &data->tls_port) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"tcp_port\", &data->tcp_port) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"listen_addr\", &data->listen_addr) < 0)\n        return -1;\n#endif /* !WITH_IP */\n\n    if (remoteConfigGetAuth(conf, filename, \"auth_unix_rw\", &data->auth_unix_rw) < 0)\n        return -1;\n#if WITH_POLKIT\n    /* Change default perms to be wide-open if PolicyKit is enabled.\n     * Admin can always override in config file\n     */\n    if (data->auth_unix_rw == REMOTE_AUTH_POLKIT) {\n        VIR_FREE(data->unix_sock_rw_perms);\n        data->unix_sock_rw_perms = g_strdup(\"0777\");\n    }\n#endif\n    if (remoteConfigGetAuth(conf, filename, \"auth_unix_ro\", &data->auth_unix_ro) < 0)\n        return -1;\n\n#ifdef WITH_IP\n    if (remoteConfigGetAuth(conf, filename, \"auth_tcp\", &data->auth_tcp) < 0)\n        return -1;\n    if (remoteConfigGetAuth(conf, filename, \"auth_tls\", &data->auth_tls) < 0)\n        return -1;\n#endif /* ! WITH_IP */\n\n    if (virConfGetValueStringList(conf, \"access_drivers\", false,\n                                  &data->access_drivers) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"unix_sock_group\", &data->unix_sock_group) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_admin_perms\", &data->unix_sock_admin_perms) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_ro_perms\", &data->unix_sock_ro_perms) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"unix_sock_rw_perms\", &data->unix_sock_rw_perms) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"unix_sock_dir\", &data->unix_sock_dir) < 0)\n        return -1;\n\n#ifdef WITH_IP\n    if (virConfGetValueBool(conf, \"tls_no_sanity_certificate\", &data->tls_no_sanity_certificate) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"tls_no_verify_certificate\", &data->tls_no_verify_certificate) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"key_file\", &data->key_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"cert_file\", &data->cert_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"ca_file\", &data->ca_file) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"crl_file\", &data->crl_file) < 0)\n        return -1;\n\n    if (virConfGetValueStringList(conf, \"tls_allowed_dn_list\", false,\n                                  &data->tls_allowed_dn_list) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"tls_priority\", &data->tls_priority) < 0)\n        return -1;\n#endif /* ! WITH_IP */\n\n    if (virConfGetValueStringList(conf, \"sasl_allowed_username_list\", false,\n                                  &data->sasl_allowed_username_list) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"min_workers\", &data->min_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_workers\", &data->max_workers) < 0)\n        return -1;\n    if (data->max_workers < 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"'max_workers' must be greater than 0\"));\n        return -1;\n    }\n    if (virConfGetValueUInt(conf, \"max_clients\", &data->max_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_queued_clients\", &data->max_queued_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_anonymous_clients\", &data->max_anonymous_clients) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"prio_workers\", &data->prio_workers) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"max_client_requests\", &data->max_client_requests) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"admin_min_workers\", &data->admin_min_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_workers\", &data->admin_max_workers) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_clients\", &data->admin_max_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_queued_clients\", &data->admin_max_queued_clients) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_max_client_requests\", &data->admin_max_client_requests) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"audit_level\", &data->audit_level) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"audit_logging\", &data->audit_logging) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"host_uuid\", &data->host_uuid) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"host_uuid_source\", &data->host_uuid_source) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"log_level\", &data->log_level) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_filters\", &data->log_filters) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"log_outputs\", &data->log_outputs) < 0)\n        return -1;\n\n    if (virConfGetValueInt(conf, \"keepalive_interval\", &data->keepalive_interval) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"keepalive_count\", &data->keepalive_count) < 0)\n        return -1;\n\n    if (virConfGetValueInt(conf, \"admin_keepalive_interval\", &data->admin_keepalive_interval) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"admin_keepalive_count\", &data->admin_keepalive_count) < 0)\n        return -1;\n\n    if (virConfGetValueUInt(conf, \"ovs_timeout\", &data->ovs_timeout) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "daemonConfigFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/remote/remote_daemon_config.c",
    "lines": "168-224",
    "snippet": "void\ndaemonConfigFree(struct daemonConfig *data)\n{\n    char **tmp;\n\n    if (!data)\n        return;\n\n#ifdef WITH_IP\n    VIR_FREE(data->listen_addr);\n    VIR_FREE(data->tls_port);\n    VIR_FREE(data->tcp_port);\n#endif /* ! WITH_IP */\n\n    tmp = data->access_drivers;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(data->access_drivers);\n\n    VIR_FREE(data->unix_sock_admin_perms);\n    VIR_FREE(data->unix_sock_ro_perms);\n    VIR_FREE(data->unix_sock_rw_perms);\n    VIR_FREE(data->unix_sock_group);\n    VIR_FREE(data->unix_sock_dir);\n\n    tmp = data->sasl_allowed_username_list;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(data->sasl_allowed_username_list);\n\n#ifdef WITH_IP\n    tmp = data->tls_allowed_dn_list;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(data->tls_allowed_dn_list);\n\n    VIR_FREE(data->tls_priority);\n\n    VIR_FREE(data->key_file);\n    VIR_FREE(data->ca_file);\n    VIR_FREE(data->cert_file);\n    VIR_FREE(data->crl_file);\n#endif /* ! WITH_IP */\n\n    VIR_FREE(data->host_uuid);\n    VIR_FREE(data->host_uuid_source);\n    VIR_FREE(data->log_filters);\n    VIR_FREE(data->log_outputs);\n\n    VIR_FREE(data);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"util/virnetdevopenvswitch.h\"",
      "#include \"remote_driver.h\"",
      "#include \"remote_protocol.h\"",
      "#include \"configmake.h\"",
      "#include \"rpc/virnetserver.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"remote_daemon_config.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->log_outputs"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->log_filters"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->host_uuid_source"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->host_uuid"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->crl_file"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->cert_file"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->ca_file"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->key_file"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->tls_priority"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->tls_allowed_dn_list"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*tmp"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->sasl_allowed_username_list"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*tmp"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->unix_sock_dir"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->unix_sock_group"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->unix_sock_rw_perms"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->unix_sock_ro_perms"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->unix_sock_admin_perms"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->access_drivers"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*tmp"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->tcp_port"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->tls_port"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->listen_addr"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"util/virnetdevopenvswitch.h\"\n#include \"remote_driver.h\"\n#include \"remote_protocol.h\"\n#include \"configmake.h\"\n#include \"rpc/virnetserver.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"remote_daemon_config.h\"\n#include <config.h>\n\nvoid\ndaemonConfigFree(struct daemonConfig *data)\n{\n    char **tmp;\n\n    if (!data)\n        return;\n\n#ifdef WITH_IP\n    VIR_FREE(data->listen_addr);\n    VIR_FREE(data->tls_port);\n    VIR_FREE(data->tcp_port);\n#endif /* ! WITH_IP */\n\n    tmp = data->access_drivers;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(data->access_drivers);\n\n    VIR_FREE(data->unix_sock_admin_perms);\n    VIR_FREE(data->unix_sock_ro_perms);\n    VIR_FREE(data->unix_sock_rw_perms);\n    VIR_FREE(data->unix_sock_group);\n    VIR_FREE(data->unix_sock_dir);\n\n    tmp = data->sasl_allowed_username_list;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(data->sasl_allowed_username_list);\n\n#ifdef WITH_IP\n    tmp = data->tls_allowed_dn_list;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(data->tls_allowed_dn_list);\n\n    VIR_FREE(data->tls_priority);\n\n    VIR_FREE(data->key_file);\n    VIR_FREE(data->ca_file);\n    VIR_FREE(data->cert_file);\n    VIR_FREE(data->crl_file);\n#endif /* ! WITH_IP */\n\n    VIR_FREE(data->host_uuid);\n    VIR_FREE(data->host_uuid_source);\n    VIR_FREE(data->log_filters);\n    VIR_FREE(data->log_outputs);\n\n    VIR_FREE(data);\n}"
  },
  {
    "function_name": "daemonConfigFilePath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/remote/remote_daemon_config.c",
    "lines": "76-90",
    "snippet": "int\ndaemonConfigFilePath(bool privileged, char **configfile)\n{\n    if (privileged) {\n        *configfile = g_strdup(SYSCONFDIR \"/libvirt/\" DAEMON_NAME \".conf\");\n    } else {\n        g_autofree char *configdir = NULL;\n\n        configdir = virGetUserConfigDirectory();\n\n        *configfile = g_strdup_printf(\"%s/%s.conf\", configdir, DAEMON_NAME);\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"util/virnetdevopenvswitch.h\"",
      "#include \"remote_driver.h\"",
      "#include \"remote_protocol.h\"",
      "#include \"configmake.h\"",
      "#include \"rpc/virnetserver.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"remote_daemon_config.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s.conf\"",
            "configdir",
            "DAEMON_NAME"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUserConfigDirectory",
          "args": [],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserConfigDirectory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "574-581",
          "snippet": "char *virGetUserConfigDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_config_dir());\n#else\n    return g_build_filename(g_get_user_config_dir(), \"libvirt\", NULL);\n#endif\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virGetUserConfigDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_config_dir());\n#else\n    return g_build_filename(g_get_user_config_dir(), \"libvirt\", NULL);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"util/virnetdevopenvswitch.h\"\n#include \"remote_driver.h\"\n#include \"remote_protocol.h\"\n#include \"configmake.h\"\n#include \"rpc/virnetserver.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"remote_daemon_config.h\"\n#include <config.h>\n\nint\ndaemonConfigFilePath(bool privileged, char **configfile)\n{\n    if (privileged) {\n        *configfile = g_strdup(SYSCONFDIR \"/libvirt/\" DAEMON_NAME \".conf\");\n    } else {\n        g_autofree char *configdir = NULL;\n\n        configdir = virGetUserConfigDirectory();\n\n        *configfile = g_strdup_printf(\"%s/%s.conf\", configdir, DAEMON_NAME);\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "remoteConfigGetAuth",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/remote/remote_daemon_config.c",
    "lines": "42-74",
    "snippet": "static int\nremoteConfigGetAuth(virConfPtr conf,\n                    const char *filename,\n                    const char *key,\n                    int *auth)\n{\n    char *authstr = NULL;\n\n    if (virConfGetValueString(conf, key, &authstr) < 0)\n        return -1;\n\n    if (!authstr)\n        return 0;\n\n    if (STREQ(authstr, \"none\")) {\n        *auth = VIR_NET_SERVER_SERVICE_AUTH_NONE;\n#if WITH_SASL\n    } else if (STREQ(authstr, \"sasl\")) {\n        *auth = VIR_NET_SERVER_SERVICE_AUTH_SASL;\n#endif\n    } else if (STREQ(authstr, \"polkit\")) {\n        *auth = VIR_NET_SERVER_SERVICE_AUTH_POLKIT;\n    } else {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"%s: %s: unsupported auth %s\"),\n                       filename, key, authstr);\n        VIR_FREE(authstr);\n        return -1;\n    }\n\n    VIR_FREE(authstr);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"util/virnetdevopenvswitch.h\"",
      "#include \"remote_driver.h\"",
      "#include \"remote_protocol.h\"",
      "#include \"configmake.h\"",
      "#include \"rpc/virnetserver.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"remote_daemon_config.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "authstr"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "authstr"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"%s: %s: unsupported auth %s\")",
            "filename",
            "key",
            "authstr"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"%s: %s: unsupported auth %s\""
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/remote/remote_daemon.c",
          "lines": "378-422",
          "snippet": "static int ATTRIBUTE_NONNULL(3)\ndaemonSetupNetworking(virNetServerPtr srv,\n                      virNetServerPtr srvAdm,\n                      struct daemonConfig *config,\n#ifdef WITH_IP\n                      bool ipsock,\n                      bool privileged,\n#endif /* ! WITH_IP */\n                      const char *sock_path,\n                      const char *sock_path_ro,\n                      const char *sock_path_adm)\n{\n    gid_t unix_sock_gid = 0;\n    int unix_sock_ro_mask = 0;\n    int unix_sock_rw_mask = 0;\n    int unix_sock_adm_mask = 0;\n    g_autoptr(virSystemdActivation) act = NULL;\n    virSystemdActivationMap actmap[] = {\n        { .name = DAEMON_NAME \".socket\", .family = AF_UNIX, .path = sock_path },\n        { .name = DAEMON_NAME \"-ro.socket\", .family = AF_UNIX, .path = sock_path_ro },\n        { .name = DAEMON_NAME \"-admin.socket\", .family = AF_UNIX, .path = sock_path_adm },\n#ifdef WITH_IP\n        { .name = DAEMON_NAME \"-tcp.socket\", .family = AF_INET },\n        { .name = DAEMON_NAME \"-tls.socket\", .family = AF_INET },\n#endif /* ! WITH_IP */\n    };\n\n#ifdef WITH_IP\n    if ((actmap[3].port = virSocketAddrResolveService(config->tcp_port)) < 0)\n        return -1;\n\n    if ((actmap[4].port = virSocketAddrResolveService(config->tls_port)) < 0)\n        return -1;\n#endif /* ! WITH_IP */\n\n    if (virSystemdGetActivation(actmap, G_N_ELEMENTS(actmap), &act) < 0)\n        return -1;\n\n#ifdef WITH_IP\n# ifdef LIBVIRTD\n    if (act && ipsock) {\n        VIR_ERROR(_(\"--listen parameter not permitted with systemd activation \"\n                    \"sockets, see 'man libvirtd' for further guidance\"));\n        return -1;\n    }",
          "includes": [
            "#include \"virdbus.h\"",
            "#include \"configmake.h\"",
            "#include \"driver.h\"",
            "#include \"virhostuptime.h\"",
            "#include \"virsystemd.h\"",
            "#include \"util/virnetdevopenvswitch.h\"",
            "#include \"virgettext.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessmanager.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virstring.h\"",
            "#include \"viraudit.h\"",
            "#include \"virhook.h\"",
            "#include \"remote_daemon_dispatch.h\"",
            "#include \"virnetdaemon.h\"",
            "#include \"virnetlink.h\"",
            "#include \"virconf.h\"",
            "#include \"viralloc.h\"",
            "#include \"remote_driver.h\"",
            "#include \"viruuid.h\"",
            "#include \"admin/admin_server_dispatch.h\"",
            "#include \"remote_daemon_config.h\"",
            "#include \"remote_daemon.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"libvirt_internal.h\"",
            "#include <grp.h>",
            "#include <getopt.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdbus.h\"\n#include \"configmake.h\"\n#include \"driver.h\"\n#include \"virhostuptime.h\"\n#include \"virsystemd.h\"\n#include \"util/virnetdevopenvswitch.h\"\n#include \"virgettext.h\"\n#include \"virutil.h\"\n#include \"viraccessmanager.h\"\n#include \"locking/lock_manager.h\"\n#include \"virstring.h\"\n#include \"viraudit.h\"\n#include \"virhook.h\"\n#include \"remote_daemon_dispatch.h\"\n#include \"virnetdaemon.h\"\n#include \"virnetlink.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"remote_driver.h\"\n#include \"viruuid.h\"\n#include \"admin/admin_server_dispatch.h\"\n#include \"remote_daemon_config.h\"\n#include \"remote_daemon.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"libvirt_internal.h\"\n#include <grp.h>\n#include <getopt.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int ATTRIBUTE_NONNULL(3)\ndaemonSetupNetworking(virNetServerPtr srv,\n                      virNetServerPtr srvAdm,\n                      struct daemonConfig *config,\n#ifdef WITH_IP\n                      bool ipsock,\n                      bool privileged,\n#endif /* ! WITH_IP */\n                      const char *sock_path,\n                      const char *sock_path_ro,\n                      const char *sock_path_adm)\n{\n    gid_t unix_sock_gid = 0;\n    int unix_sock_ro_mask = 0;\n    int unix_sock_rw_mask = 0;\n    int unix_sock_adm_mask = 0;\n    g_autoptr(virSystemdActivation) act = NULL;\n    virSystemdActivationMap actmap[] = {\n        { .name = DAEMON_NAME \".socket\", .family = AF_UNIX, .path = sock_path },\n        { .name = DAEMON_NAME \"-ro.socket\", .family = AF_UNIX, .path = sock_path_ro },\n        { .name = DAEMON_NAME \"-admin.socket\", .family = AF_UNIX, .path = sock_path_adm },\n#ifdef WITH_IP\n        { .name = DAEMON_NAME \"-tcp.socket\", .family = AF_INET },\n        { .name = DAEMON_NAME \"-tls.socket\", .family = AF_INET },\n#endif /* ! WITH_IP */\n    };\n\n#ifdef WITH_IP\n    if ((actmap[3].port = virSocketAddrResolveService(config->tcp_port)) < 0)\n        return -1;\n\n    if ((actmap[4].port = virSocketAddrResolveService(config->tls_port)) < 0)\n        return -1;\n#endif /* ! WITH_IP */\n\n    if (virSystemdGetActivation(actmap, G_N_ELEMENTS(actmap), &act) < 0)\n        return -1;\n\n#ifdef WITH_IP\n# ifdef LIBVIRTD\n    if (act && ipsock) {\n        VIR_ERROR(_(\"--listen parameter not permitted with systemd activation \"\n                    \"sockets, see 'man libvirtd' for further guidance\"));\n        return -1;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "authstr",
            "\"polkit\""
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "authstr",
            "\"sasl\""
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "authstr",
            "\"none\""
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "conf",
            "key",
            "&authstr"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"util/virnetdevopenvswitch.h\"\n#include \"remote_driver.h\"\n#include \"remote_protocol.h\"\n#include \"configmake.h\"\n#include \"rpc/virnetserver.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"remote_daemon_config.h\"\n#include <config.h>\n\nstatic int\nremoteConfigGetAuth(virConfPtr conf,\n                    const char *filename,\n                    const char *key,\n                    int *auth)\n{\n    char *authstr = NULL;\n\n    if (virConfGetValueString(conf, key, &authstr) < 0)\n        return -1;\n\n    if (!authstr)\n        return 0;\n\n    if (STREQ(authstr, \"none\")) {\n        *auth = VIR_NET_SERVER_SERVICE_AUTH_NONE;\n#if WITH_SASL\n    } else if (STREQ(authstr, \"sasl\")) {\n        *auth = VIR_NET_SERVER_SERVICE_AUTH_SASL;\n#endif\n    } else if (STREQ(authstr, \"polkit\")) {\n        *auth = VIR_NET_SERVER_SERVICE_AUTH_POLKIT;\n    } else {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"%s: %s: unsupported auth %s\"),\n                       filename, key, authstr);\n        VIR_FREE(authstr);\n        return -1;\n    }\n\n    VIR_FREE(authstr);\n    return 0;\n}"
  }
]