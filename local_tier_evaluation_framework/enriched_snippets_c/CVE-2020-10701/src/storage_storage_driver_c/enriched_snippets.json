[
  {
    "function_name": "storageRegisterAll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2950-2954",
    "snippet": "int\nstorageRegisterAll(void)\n{\n    return storageRegisterFull(true);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "storageRegisterFull",
          "args": [
            "true"
          ],
          "line": 2953
        },
        "resolved": true,
        "details": {
          "function_name": "storageRegisterFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2928-2940",
          "snippet": "static int\nstorageRegisterFull(bool allbackends)\n{\n    if (virRegisterConnectDriver(&storageConnectDriver, false) < 0)\n        return -1;\n    if (virStorageBackendDriversRegister(allbackends) < 0)\n        return -1;\n    if (virSetSharedStorageDriver(&storageDriver) < 0)\n        return -1;\n    if (virRegisterStateDriver(&stateDriver) < 0)\n        return -1;\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriver storageDriver = {\n    .name = \"storage\",\n    .connectNumOfStoragePools = storageConnectNumOfStoragePools, /* 0.4.0 */\n    .connectListStoragePools = storageConnectListStoragePools, /* 0.4.0 */\n    .connectNumOfDefinedStoragePools = storageConnectNumOfDefinedStoragePools, /* 0.4.0 */\n    .connectListDefinedStoragePools = storageConnectListDefinedStoragePools, /* 0.4.0 */\n    .connectListAllStoragePools = storageConnectListAllStoragePools, /* 0.10.2 */\n    .connectStoragePoolEventRegisterAny = storageConnectStoragePoolEventRegisterAny, /* 2.0.0 */\n    .connectStoragePoolEventDeregisterAny = storageConnectStoragePoolEventDeregisterAny, /* 2.0.0 */\n    .connectFindStoragePoolSources = storageConnectFindStoragePoolSources, /* 0.4.0 */\n    .connectGetStoragePoolCapabilities = storageConnectGetStoragePoolCapabilities, /* 5.2.0 */\n    .storagePoolLookupByName = storagePoolLookupByName, /* 0.4.0 */\n    .storagePoolLookupByUUID = storagePoolLookupByUUID, /* 0.4.0 */\n    .storagePoolLookupByVolume = storagePoolLookupByVolume, /* 0.4.0 */\n    .storagePoolLookupByTargetPath = storagePoolLookupByTargetPath, /* 4.1.0 */\n    .storagePoolCreateXML = storagePoolCreateXML, /* 0.4.0 */\n    .storagePoolDefineXML = storagePoolDefineXML, /* 0.4.0 */\n    .storagePoolBuild = storagePoolBuild, /* 0.4.0 */\n    .storagePoolUndefine = storagePoolUndefine, /* 0.4.0 */\n    .storagePoolCreate = storagePoolCreate, /* 0.4.0 */\n    .storagePoolDestroy = storagePoolDestroy, /* 0.4.0 */\n    .storagePoolDelete = storagePoolDelete, /* 0.4.0 */\n    .storagePoolRefresh = storagePoolRefresh, /* 0.4.0 */\n    .storagePoolGetInfo = storagePoolGetInfo, /* 0.4.0 */\n    .storagePoolGetXMLDesc = storagePoolGetXMLDesc, /* 0.4.0 */\n    .storagePoolGetAutostart = storagePoolGetAutostart, /* 0.4.0 */\n    .storagePoolSetAutostart = storagePoolSetAutostart, /* 0.4.0 */\n    .storagePoolNumOfVolumes = storagePoolNumOfVolumes, /* 0.4.0 */\n    .storagePoolListVolumes = storagePoolListVolumes, /* 0.4.0 */\n    .storagePoolListAllVolumes = storagePoolListAllVolumes, /* 0.10.2 */\n\n    .storageVolLookupByName = storageVolLookupByName, /* 0.4.0 */\n    .storageVolLookupByKey = storageVolLookupByKey, /* 0.4.0 */\n    .storageVolLookupByPath = storageVolLookupByPath, /* 0.4.0 */\n    .storageVolCreateXML = storageVolCreateXML, /* 0.4.0 */\n    .storageVolCreateXMLFrom = storageVolCreateXMLFrom, /* 0.6.4 */\n    .storageVolDownload = storageVolDownload, /* 0.9.0 */\n    .storageVolUpload = storageVolUpload, /* 0.9.0 */\n    .storageVolDelete = storageVolDelete, /* 0.4.0 */\n    .storageVolWipe = storageVolWipe, /* 0.8.0 */\n    .storageVolWipePattern = storageVolWipePattern, /* 0.9.10 */\n    .storageVolGetInfo = storageVolGetInfo, /* 0.4.0 */\n    .storageVolGetInfoFlags = storageVolGetInfoFlags, /* 3.0.0 */\n    .storageVolGetXMLDesc = storageVolGetXMLDesc, /* 0.4.0 */\n    .storageVolGetPath = storageVolGetPath, /* 0.4.0 */\n    .storageVolResize = storageVolResize, /* 0.9.10 */\n\n    .storagePoolIsActive = storagePoolIsActive, /* 0.7.3 */\n    .storagePoolIsPersistent = storagePoolIsPersistent, /* 0.7.3 */\n};",
            "static virConnectDriver storageConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"storage\", NULL },\n    .hypervisorDriver = &storageHypervisorDriver,\n    .storageDriver = &storageDriver,\n};",
            "static virStateDriver stateDriver = {\n    .name = \"storage\",\n    .stateInitialize = storageStateInitialize,\n    .stateCleanup = storageStateCleanup,\n    .stateReload = storageStateReload,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriver storageDriver = {\n    .name = \"storage\",\n    .connectNumOfStoragePools = storageConnectNumOfStoragePools, /* 0.4.0 */\n    .connectListStoragePools = storageConnectListStoragePools, /* 0.4.0 */\n    .connectNumOfDefinedStoragePools = storageConnectNumOfDefinedStoragePools, /* 0.4.0 */\n    .connectListDefinedStoragePools = storageConnectListDefinedStoragePools, /* 0.4.0 */\n    .connectListAllStoragePools = storageConnectListAllStoragePools, /* 0.10.2 */\n    .connectStoragePoolEventRegisterAny = storageConnectStoragePoolEventRegisterAny, /* 2.0.0 */\n    .connectStoragePoolEventDeregisterAny = storageConnectStoragePoolEventDeregisterAny, /* 2.0.0 */\n    .connectFindStoragePoolSources = storageConnectFindStoragePoolSources, /* 0.4.0 */\n    .connectGetStoragePoolCapabilities = storageConnectGetStoragePoolCapabilities, /* 5.2.0 */\n    .storagePoolLookupByName = storagePoolLookupByName, /* 0.4.0 */\n    .storagePoolLookupByUUID = storagePoolLookupByUUID, /* 0.4.0 */\n    .storagePoolLookupByVolume = storagePoolLookupByVolume, /* 0.4.0 */\n    .storagePoolLookupByTargetPath = storagePoolLookupByTargetPath, /* 4.1.0 */\n    .storagePoolCreateXML = storagePoolCreateXML, /* 0.4.0 */\n    .storagePoolDefineXML = storagePoolDefineXML, /* 0.4.0 */\n    .storagePoolBuild = storagePoolBuild, /* 0.4.0 */\n    .storagePoolUndefine = storagePoolUndefine, /* 0.4.0 */\n    .storagePoolCreate = storagePoolCreate, /* 0.4.0 */\n    .storagePoolDestroy = storagePoolDestroy, /* 0.4.0 */\n    .storagePoolDelete = storagePoolDelete, /* 0.4.0 */\n    .storagePoolRefresh = storagePoolRefresh, /* 0.4.0 */\n    .storagePoolGetInfo = storagePoolGetInfo, /* 0.4.0 */\n    .storagePoolGetXMLDesc = storagePoolGetXMLDesc, /* 0.4.0 */\n    .storagePoolGetAutostart = storagePoolGetAutostart, /* 0.4.0 */\n    .storagePoolSetAutostart = storagePoolSetAutostart, /* 0.4.0 */\n    .storagePoolNumOfVolumes = storagePoolNumOfVolumes, /* 0.4.0 */\n    .storagePoolListVolumes = storagePoolListVolumes, /* 0.4.0 */\n    .storagePoolListAllVolumes = storagePoolListAllVolumes, /* 0.10.2 */\n\n    .storageVolLookupByName = storageVolLookupByName, /* 0.4.0 */\n    .storageVolLookupByKey = storageVolLookupByKey, /* 0.4.0 */\n    .storageVolLookupByPath = storageVolLookupByPath, /* 0.4.0 */\n    .storageVolCreateXML = storageVolCreateXML, /* 0.4.0 */\n    .storageVolCreateXMLFrom = storageVolCreateXMLFrom, /* 0.6.4 */\n    .storageVolDownload = storageVolDownload, /* 0.9.0 */\n    .storageVolUpload = storageVolUpload, /* 0.9.0 */\n    .storageVolDelete = storageVolDelete, /* 0.4.0 */\n    .storageVolWipe = storageVolWipe, /* 0.8.0 */\n    .storageVolWipePattern = storageVolWipePattern, /* 0.9.10 */\n    .storageVolGetInfo = storageVolGetInfo, /* 0.4.0 */\n    .storageVolGetInfoFlags = storageVolGetInfoFlags, /* 3.0.0 */\n    .storageVolGetXMLDesc = storageVolGetXMLDesc, /* 0.4.0 */\n    .storageVolGetPath = storageVolGetPath, /* 0.4.0 */\n    .storageVolResize = storageVolResize, /* 0.9.10 */\n\n    .storagePoolIsActive = storagePoolIsActive, /* 0.7.3 */\n    .storagePoolIsPersistent = storagePoolIsPersistent, /* 0.7.3 */\n};\nstatic virConnectDriver storageConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"storage\", NULL },\n    .hypervisorDriver = &storageHypervisorDriver,\n    .storageDriver = &storageDriver,\n};\nstatic virStateDriver stateDriver = {\n    .name = \"storage\",\n    .stateInitialize = storageStateInitialize,\n    .stateCleanup = storageStateCleanup,\n    .stateReload = storageStateReload,\n};\n\nstatic int\nstorageRegisterFull(bool allbackends)\n{\n    if (virRegisterConnectDriver(&storageConnectDriver, false) < 0)\n        return -1;\n    if (virStorageBackendDriversRegister(allbackends) < 0)\n        return -1;\n    if (virSetSharedStorageDriver(&storageDriver) < 0)\n        return -1;\n    if (virRegisterStateDriver(&stateDriver) < 0)\n        return -1;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nstorageRegisterAll(void)\n{\n    return storageRegisterFull(true);\n}"
  },
  {
    "function_name": "storageRegister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2943-2947",
    "snippet": "int\nstorageRegister(void)\n{\n    return storageRegisterFull(false);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "storageRegisterFull",
          "args": [
            "false"
          ],
          "line": 2946
        },
        "resolved": true,
        "details": {
          "function_name": "storageRegisterFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2928-2940",
          "snippet": "static int\nstorageRegisterFull(bool allbackends)\n{\n    if (virRegisterConnectDriver(&storageConnectDriver, false) < 0)\n        return -1;\n    if (virStorageBackendDriversRegister(allbackends) < 0)\n        return -1;\n    if (virSetSharedStorageDriver(&storageDriver) < 0)\n        return -1;\n    if (virRegisterStateDriver(&stateDriver) < 0)\n        return -1;\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriver storageDriver = {\n    .name = \"storage\",\n    .connectNumOfStoragePools = storageConnectNumOfStoragePools, /* 0.4.0 */\n    .connectListStoragePools = storageConnectListStoragePools, /* 0.4.0 */\n    .connectNumOfDefinedStoragePools = storageConnectNumOfDefinedStoragePools, /* 0.4.0 */\n    .connectListDefinedStoragePools = storageConnectListDefinedStoragePools, /* 0.4.0 */\n    .connectListAllStoragePools = storageConnectListAllStoragePools, /* 0.10.2 */\n    .connectStoragePoolEventRegisterAny = storageConnectStoragePoolEventRegisterAny, /* 2.0.0 */\n    .connectStoragePoolEventDeregisterAny = storageConnectStoragePoolEventDeregisterAny, /* 2.0.0 */\n    .connectFindStoragePoolSources = storageConnectFindStoragePoolSources, /* 0.4.0 */\n    .connectGetStoragePoolCapabilities = storageConnectGetStoragePoolCapabilities, /* 5.2.0 */\n    .storagePoolLookupByName = storagePoolLookupByName, /* 0.4.0 */\n    .storagePoolLookupByUUID = storagePoolLookupByUUID, /* 0.4.0 */\n    .storagePoolLookupByVolume = storagePoolLookupByVolume, /* 0.4.0 */\n    .storagePoolLookupByTargetPath = storagePoolLookupByTargetPath, /* 4.1.0 */\n    .storagePoolCreateXML = storagePoolCreateXML, /* 0.4.0 */\n    .storagePoolDefineXML = storagePoolDefineXML, /* 0.4.0 */\n    .storagePoolBuild = storagePoolBuild, /* 0.4.0 */\n    .storagePoolUndefine = storagePoolUndefine, /* 0.4.0 */\n    .storagePoolCreate = storagePoolCreate, /* 0.4.0 */\n    .storagePoolDestroy = storagePoolDestroy, /* 0.4.0 */\n    .storagePoolDelete = storagePoolDelete, /* 0.4.0 */\n    .storagePoolRefresh = storagePoolRefresh, /* 0.4.0 */\n    .storagePoolGetInfo = storagePoolGetInfo, /* 0.4.0 */\n    .storagePoolGetXMLDesc = storagePoolGetXMLDesc, /* 0.4.0 */\n    .storagePoolGetAutostart = storagePoolGetAutostart, /* 0.4.0 */\n    .storagePoolSetAutostart = storagePoolSetAutostart, /* 0.4.0 */\n    .storagePoolNumOfVolumes = storagePoolNumOfVolumes, /* 0.4.0 */\n    .storagePoolListVolumes = storagePoolListVolumes, /* 0.4.0 */\n    .storagePoolListAllVolumes = storagePoolListAllVolumes, /* 0.10.2 */\n\n    .storageVolLookupByName = storageVolLookupByName, /* 0.4.0 */\n    .storageVolLookupByKey = storageVolLookupByKey, /* 0.4.0 */\n    .storageVolLookupByPath = storageVolLookupByPath, /* 0.4.0 */\n    .storageVolCreateXML = storageVolCreateXML, /* 0.4.0 */\n    .storageVolCreateXMLFrom = storageVolCreateXMLFrom, /* 0.6.4 */\n    .storageVolDownload = storageVolDownload, /* 0.9.0 */\n    .storageVolUpload = storageVolUpload, /* 0.9.0 */\n    .storageVolDelete = storageVolDelete, /* 0.4.0 */\n    .storageVolWipe = storageVolWipe, /* 0.8.0 */\n    .storageVolWipePattern = storageVolWipePattern, /* 0.9.10 */\n    .storageVolGetInfo = storageVolGetInfo, /* 0.4.0 */\n    .storageVolGetInfoFlags = storageVolGetInfoFlags, /* 3.0.0 */\n    .storageVolGetXMLDesc = storageVolGetXMLDesc, /* 0.4.0 */\n    .storageVolGetPath = storageVolGetPath, /* 0.4.0 */\n    .storageVolResize = storageVolResize, /* 0.9.10 */\n\n    .storagePoolIsActive = storagePoolIsActive, /* 0.7.3 */\n    .storagePoolIsPersistent = storagePoolIsPersistent, /* 0.7.3 */\n};",
            "static virConnectDriver storageConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"storage\", NULL },\n    .hypervisorDriver = &storageHypervisorDriver,\n    .storageDriver = &storageDriver,\n};",
            "static virStateDriver stateDriver = {\n    .name = \"storage\",\n    .stateInitialize = storageStateInitialize,\n    .stateCleanup = storageStateCleanup,\n    .stateReload = storageStateReload,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriver storageDriver = {\n    .name = \"storage\",\n    .connectNumOfStoragePools = storageConnectNumOfStoragePools, /* 0.4.0 */\n    .connectListStoragePools = storageConnectListStoragePools, /* 0.4.0 */\n    .connectNumOfDefinedStoragePools = storageConnectNumOfDefinedStoragePools, /* 0.4.0 */\n    .connectListDefinedStoragePools = storageConnectListDefinedStoragePools, /* 0.4.0 */\n    .connectListAllStoragePools = storageConnectListAllStoragePools, /* 0.10.2 */\n    .connectStoragePoolEventRegisterAny = storageConnectStoragePoolEventRegisterAny, /* 2.0.0 */\n    .connectStoragePoolEventDeregisterAny = storageConnectStoragePoolEventDeregisterAny, /* 2.0.0 */\n    .connectFindStoragePoolSources = storageConnectFindStoragePoolSources, /* 0.4.0 */\n    .connectGetStoragePoolCapabilities = storageConnectGetStoragePoolCapabilities, /* 5.2.0 */\n    .storagePoolLookupByName = storagePoolLookupByName, /* 0.4.0 */\n    .storagePoolLookupByUUID = storagePoolLookupByUUID, /* 0.4.0 */\n    .storagePoolLookupByVolume = storagePoolLookupByVolume, /* 0.4.0 */\n    .storagePoolLookupByTargetPath = storagePoolLookupByTargetPath, /* 4.1.0 */\n    .storagePoolCreateXML = storagePoolCreateXML, /* 0.4.0 */\n    .storagePoolDefineXML = storagePoolDefineXML, /* 0.4.0 */\n    .storagePoolBuild = storagePoolBuild, /* 0.4.0 */\n    .storagePoolUndefine = storagePoolUndefine, /* 0.4.0 */\n    .storagePoolCreate = storagePoolCreate, /* 0.4.0 */\n    .storagePoolDestroy = storagePoolDestroy, /* 0.4.0 */\n    .storagePoolDelete = storagePoolDelete, /* 0.4.0 */\n    .storagePoolRefresh = storagePoolRefresh, /* 0.4.0 */\n    .storagePoolGetInfo = storagePoolGetInfo, /* 0.4.0 */\n    .storagePoolGetXMLDesc = storagePoolGetXMLDesc, /* 0.4.0 */\n    .storagePoolGetAutostart = storagePoolGetAutostart, /* 0.4.0 */\n    .storagePoolSetAutostart = storagePoolSetAutostart, /* 0.4.0 */\n    .storagePoolNumOfVolumes = storagePoolNumOfVolumes, /* 0.4.0 */\n    .storagePoolListVolumes = storagePoolListVolumes, /* 0.4.0 */\n    .storagePoolListAllVolumes = storagePoolListAllVolumes, /* 0.10.2 */\n\n    .storageVolLookupByName = storageVolLookupByName, /* 0.4.0 */\n    .storageVolLookupByKey = storageVolLookupByKey, /* 0.4.0 */\n    .storageVolLookupByPath = storageVolLookupByPath, /* 0.4.0 */\n    .storageVolCreateXML = storageVolCreateXML, /* 0.4.0 */\n    .storageVolCreateXMLFrom = storageVolCreateXMLFrom, /* 0.6.4 */\n    .storageVolDownload = storageVolDownload, /* 0.9.0 */\n    .storageVolUpload = storageVolUpload, /* 0.9.0 */\n    .storageVolDelete = storageVolDelete, /* 0.4.0 */\n    .storageVolWipe = storageVolWipe, /* 0.8.0 */\n    .storageVolWipePattern = storageVolWipePattern, /* 0.9.10 */\n    .storageVolGetInfo = storageVolGetInfo, /* 0.4.0 */\n    .storageVolGetInfoFlags = storageVolGetInfoFlags, /* 3.0.0 */\n    .storageVolGetXMLDesc = storageVolGetXMLDesc, /* 0.4.0 */\n    .storageVolGetPath = storageVolGetPath, /* 0.4.0 */\n    .storageVolResize = storageVolResize, /* 0.9.10 */\n\n    .storagePoolIsActive = storagePoolIsActive, /* 0.7.3 */\n    .storagePoolIsPersistent = storagePoolIsPersistent, /* 0.7.3 */\n};\nstatic virConnectDriver storageConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"storage\", NULL },\n    .hypervisorDriver = &storageHypervisorDriver,\n    .storageDriver = &storageDriver,\n};\nstatic virStateDriver stateDriver = {\n    .name = \"storage\",\n    .stateInitialize = storageStateInitialize,\n    .stateCleanup = storageStateCleanup,\n    .stateReload = storageStateReload,\n};\n\nstatic int\nstorageRegisterFull(bool allbackends)\n{\n    if (virRegisterConnectDriver(&storageConnectDriver, false) < 0)\n        return -1;\n    if (virStorageBackendDriversRegister(allbackends) < 0)\n        return -1;\n    if (virSetSharedStorageDriver(&storageDriver) < 0)\n        return -1;\n    if (virRegisterStateDriver(&stateDriver) < 0)\n        return -1;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nstorageRegister(void)\n{\n    return storageRegisterFull(false);\n}"
  },
  {
    "function_name": "storageRegisterFull",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2928-2940",
    "snippet": "static int\nstorageRegisterFull(bool allbackends)\n{\n    if (virRegisterConnectDriver(&storageConnectDriver, false) < 0)\n        return -1;\n    if (virStorageBackendDriversRegister(allbackends) < 0)\n        return -1;\n    if (virSetSharedStorageDriver(&storageDriver) < 0)\n        return -1;\n    if (virRegisterStateDriver(&stateDriver) < 0)\n        return -1;\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriver storageDriver = {\n    .name = \"storage\",\n    .connectNumOfStoragePools = storageConnectNumOfStoragePools, /* 0.4.0 */\n    .connectListStoragePools = storageConnectListStoragePools, /* 0.4.0 */\n    .connectNumOfDefinedStoragePools = storageConnectNumOfDefinedStoragePools, /* 0.4.0 */\n    .connectListDefinedStoragePools = storageConnectListDefinedStoragePools, /* 0.4.0 */\n    .connectListAllStoragePools = storageConnectListAllStoragePools, /* 0.10.2 */\n    .connectStoragePoolEventRegisterAny = storageConnectStoragePoolEventRegisterAny, /* 2.0.0 */\n    .connectStoragePoolEventDeregisterAny = storageConnectStoragePoolEventDeregisterAny, /* 2.0.0 */\n    .connectFindStoragePoolSources = storageConnectFindStoragePoolSources, /* 0.4.0 */\n    .connectGetStoragePoolCapabilities = storageConnectGetStoragePoolCapabilities, /* 5.2.0 */\n    .storagePoolLookupByName = storagePoolLookupByName, /* 0.4.0 */\n    .storagePoolLookupByUUID = storagePoolLookupByUUID, /* 0.4.0 */\n    .storagePoolLookupByVolume = storagePoolLookupByVolume, /* 0.4.0 */\n    .storagePoolLookupByTargetPath = storagePoolLookupByTargetPath, /* 4.1.0 */\n    .storagePoolCreateXML = storagePoolCreateXML, /* 0.4.0 */\n    .storagePoolDefineXML = storagePoolDefineXML, /* 0.4.0 */\n    .storagePoolBuild = storagePoolBuild, /* 0.4.0 */\n    .storagePoolUndefine = storagePoolUndefine, /* 0.4.0 */\n    .storagePoolCreate = storagePoolCreate, /* 0.4.0 */\n    .storagePoolDestroy = storagePoolDestroy, /* 0.4.0 */\n    .storagePoolDelete = storagePoolDelete, /* 0.4.0 */\n    .storagePoolRefresh = storagePoolRefresh, /* 0.4.0 */\n    .storagePoolGetInfo = storagePoolGetInfo, /* 0.4.0 */\n    .storagePoolGetXMLDesc = storagePoolGetXMLDesc, /* 0.4.0 */\n    .storagePoolGetAutostart = storagePoolGetAutostart, /* 0.4.0 */\n    .storagePoolSetAutostart = storagePoolSetAutostart, /* 0.4.0 */\n    .storagePoolNumOfVolumes = storagePoolNumOfVolumes, /* 0.4.0 */\n    .storagePoolListVolumes = storagePoolListVolumes, /* 0.4.0 */\n    .storagePoolListAllVolumes = storagePoolListAllVolumes, /* 0.10.2 */\n\n    .storageVolLookupByName = storageVolLookupByName, /* 0.4.0 */\n    .storageVolLookupByKey = storageVolLookupByKey, /* 0.4.0 */\n    .storageVolLookupByPath = storageVolLookupByPath, /* 0.4.0 */\n    .storageVolCreateXML = storageVolCreateXML, /* 0.4.0 */\n    .storageVolCreateXMLFrom = storageVolCreateXMLFrom, /* 0.6.4 */\n    .storageVolDownload = storageVolDownload, /* 0.9.0 */\n    .storageVolUpload = storageVolUpload, /* 0.9.0 */\n    .storageVolDelete = storageVolDelete, /* 0.4.0 */\n    .storageVolWipe = storageVolWipe, /* 0.8.0 */\n    .storageVolWipePattern = storageVolWipePattern, /* 0.9.10 */\n    .storageVolGetInfo = storageVolGetInfo, /* 0.4.0 */\n    .storageVolGetInfoFlags = storageVolGetInfoFlags, /* 3.0.0 */\n    .storageVolGetXMLDesc = storageVolGetXMLDesc, /* 0.4.0 */\n    .storageVolGetPath = storageVolGetPath, /* 0.4.0 */\n    .storageVolResize = storageVolResize, /* 0.9.10 */\n\n    .storagePoolIsActive = storagePoolIsActive, /* 0.7.3 */\n    .storagePoolIsPersistent = storagePoolIsPersistent, /* 0.7.3 */\n};",
      "static virConnectDriver storageConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"storage\", NULL },\n    .hypervisorDriver = &storageHypervisorDriver,\n    .storageDriver = &storageDriver,\n};",
      "static virStateDriver stateDriver = {\n    .name = \"storage\",\n    .stateInitialize = storageStateInitialize,\n    .stateCleanup = storageStateCleanup,\n    .stateReload = storageStateReload,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virRegisterStateDriver",
          "args": [
            "&stateDriver"
          ],
          "line": 2937
        },
        "resolved": true,
        "details": {
          "function_name": "virRegisterStateDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "588-602",
          "snippet": "int\nvirRegisterStateDriver(virStateDriverPtr driver)\n{\n    virCheckNonNullArgReturn(driver, -1);\n\n    if (virStateDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->name);\n        return -1;\n    }\n\n    virStateDriverTab[virStateDriverTabCount] = driver;\n    return virStateDriverTabCount++;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_DRIVERS 21"
          ],
          "globals_used": [
            "static virStateDriverPtr virStateDriverTab[MAX_DRIVERS];",
            "static int virStateDriverTabCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define MAX_DRIVERS 21\n\nstatic virStateDriverPtr virStateDriverTab[MAX_DRIVERS];\nstatic int virStateDriverTabCount;\n\nint\nvirRegisterStateDriver(virStateDriverPtr driver)\n{\n    virCheckNonNullArgReturn(driver, -1);\n\n    if (virStateDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->name);\n        return -1;\n    }\n\n    virStateDriverTab[virStateDriverTabCount] = driver;\n    return virStateDriverTabCount++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSetSharedStorageDriver",
          "args": [
            "&storageDriver"
          ],
          "line": 2935
        },
        "resolved": true,
        "details": {
          "function_name": "virSetSharedStorageDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "409-424",
          "snippet": "int\nvirSetSharedStorageDriver(virStorageDriverPtr driver)\n{\n    virCheckNonNullArgReturn(driver, -1);\n\n    if (virSharedStorageDriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"A storage driver is already registered\"));\n        return -1;\n    }\n\n    VIR_DEBUG(\"registering %s as storage driver\", driver->name);\n\n    virSharedStorageDriver = driver;\n    return 0;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverPtr virSharedStorageDriver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStorageDriverPtr virSharedStorageDriver;\n\nint\nvirSetSharedStorageDriver(virStorageDriverPtr driver)\n{\n    virCheckNonNullArgReturn(driver, -1);\n\n    if (virSharedStorageDriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"A storage driver is already registered\"));\n        return -1;\n    }\n\n    VIR_DEBUG(\"registering %s as storage driver\", driver->name);\n\n    virSharedStorageDriver = driver;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageBackendDriversRegister",
          "args": [
            "allbackends"
          ],
          "line": 2933
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendDriversRegister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
          "lines": "108-149",
          "snippet": "int\nvirStorageBackendDriversRegister(bool allbackends G_GNUC_UNUSED)\n{\n#if WITH_STORAGE_DIR || WITH_STORAGE_FS\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendFsRegister, \"fs\");\n#endif\n#if WITH_STORAGE_LVM\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendLogicalRegister, \"logical\");\n#endif\n#if WITH_STORAGE_ISCSI\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendISCSIRegister, \"iscsi\");\n#endif\n#if WITH_STORAGE_ISCSI_DIRECT\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendISCSIDirectRegister, \"iscsi-direct\");\n#endif\n#if WITH_STORAGE_SCSI\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendSCSIRegister, \"scsi\");\n#endif\n#if WITH_STORAGE_MPATH\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendMpathRegister, \"mpath\");\n#endif\n#if WITH_STORAGE_DISK\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendDiskRegister, \"disk\");\n#endif\n#if WITH_STORAGE_RBD\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendRBDRegister, \"rbd\");\n#endif\n#if WITH_STORAGE_SHEEPDOG\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendSheepdogRegister, \"sheepdog\");\n#endif\n#if WITH_STORAGE_GLUSTER\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendGlusterRegister, \"gluster\");\n#endif\n#if WITH_STORAGE_ZFS\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendZFSRegister, \"zfs\");\n#endif\n#if WITH_STORAGE_VSTORAGE\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendVstorageRegister, \"vstorage\");\n#endif\n\n    return 0;\n}",
          "includes": [
            "# include \"storage_backend_vstorage.h\"",
            "# include \"storage_backend_zfs.h\"",
            "# include \"storage_backend_gluster.h\"",
            "# include \"storage_backend_sheepdog.h\"",
            "# include \"storage_backend_rbd.h\"",
            "# include \"storage_backend_fs.h\"",
            "# include \"storage_backend_disk.h\"",
            "# include \"storage_backend_mpath.h\"",
            "# include \"storage_backend_scsi.h\"",
            "# include \"storage_backend_iscsi_direct.h\"",
            "# include \"storage_backend_iscsi.h\"",
            "# include \"storage_backend_logical.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirStorageBackendDriversRegister(bool allbackends G_GNUC_UNUSED)\n{\n#if WITH_STORAGE_DIR || WITH_STORAGE_FS\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendFsRegister, \"fs\");\n#endif\n#if WITH_STORAGE_LVM\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendLogicalRegister, \"logical\");\n#endif\n#if WITH_STORAGE_ISCSI\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendISCSIRegister, \"iscsi\");\n#endif\n#if WITH_STORAGE_ISCSI_DIRECT\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendISCSIDirectRegister, \"iscsi-direct\");\n#endif\n#if WITH_STORAGE_SCSI\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendSCSIRegister, \"scsi\");\n#endif\n#if WITH_STORAGE_MPATH\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendMpathRegister, \"mpath\");\n#endif\n#if WITH_STORAGE_DISK\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendDiskRegister, \"disk\");\n#endif\n#if WITH_STORAGE_RBD\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendRBDRegister, \"rbd\");\n#endif\n#if WITH_STORAGE_SHEEPDOG\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendSheepdogRegister, \"sheepdog\");\n#endif\n#if WITH_STORAGE_GLUSTER\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendGlusterRegister, \"gluster\");\n#endif\n#if WITH_STORAGE_ZFS\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendZFSRegister, \"zfs\");\n#endif\n#if WITH_STORAGE_VSTORAGE\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendVstorageRegister, \"vstorage\");\n#endif\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRegisterConnectDriver",
          "args": [
            "&storageConnectDriver",
            "false"
          ],
          "line": 2931
        },
        "resolved": true,
        "details": {
          "function_name": "virRegisterConnectDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "515-550",
          "snippet": "int\nvirRegisterConnectDriver(virConnectDriverPtr driver,\n                         bool setSharedDrivers)\n{\n    VIR_DEBUG(\"driver=%p name=%s\", driver,\n              driver ? NULLSTR(driver->hypervisorDriver->name) : \"(null)\");\n\n    virCheckNonNullArgReturn(driver, -1);\n    if (virConnectDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->hypervisorDriver->name);\n        return -1;\n    }\n\n    VIR_DEBUG(\"registering %s as driver %d\",\n           driver->hypervisorDriver->name, virConnectDriverTabCount);\n\n    if (setSharedDrivers) {\n        if (driver->interfaceDriver == NULL)\n            driver->interfaceDriver = virSharedInterfaceDriver;\n        if (driver->networkDriver == NULL)\n            driver->networkDriver = virSharedNetworkDriver;\n        if (driver->nodeDeviceDriver == NULL)\n            driver->nodeDeviceDriver = virSharedNodeDeviceDriver;\n        if (driver->nwfilterDriver == NULL)\n            driver->nwfilterDriver = virSharedNWFilterDriver;\n        if (driver->secretDriver == NULL)\n            driver->secretDriver = virSharedSecretDriver;\n        if (driver->storageDriver == NULL)\n            driver->storageDriver = virSharedStorageDriver;\n    }\n\n    virConnectDriverTab[virConnectDriverTabCount] = driver;\n    return virConnectDriverTabCount++;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_DRIVERS 21"
          ],
          "globals_used": [
            "static virConnectDriverPtr virConnectDriverTab[MAX_DRIVERS];",
            "static int virConnectDriverTabCount;",
            "static virNetworkDriverPtr virSharedNetworkDriver;",
            "static virInterfaceDriverPtr virSharedInterfaceDriver;",
            "static virStorageDriverPtr virSharedStorageDriver;",
            "static virNodeDeviceDriverPtr virSharedNodeDeviceDriver;",
            "static virSecretDriverPtr virSharedSecretDriver;",
            "static virNWFilterDriverPtr virSharedNWFilterDriver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define MAX_DRIVERS 21\n\nstatic virConnectDriverPtr virConnectDriverTab[MAX_DRIVERS];\nstatic int virConnectDriverTabCount;\nstatic virNetworkDriverPtr virSharedNetworkDriver;\nstatic virInterfaceDriverPtr virSharedInterfaceDriver;\nstatic virStorageDriverPtr virSharedStorageDriver;\nstatic virNodeDeviceDriverPtr virSharedNodeDeviceDriver;\nstatic virSecretDriverPtr virSharedSecretDriver;\nstatic virNWFilterDriverPtr virSharedNWFilterDriver;\n\nint\nvirRegisterConnectDriver(virConnectDriverPtr driver,\n                         bool setSharedDrivers)\n{\n    VIR_DEBUG(\"driver=%p name=%s\", driver,\n              driver ? NULLSTR(driver->hypervisorDriver->name) : \"(null)\");\n\n    virCheckNonNullArgReturn(driver, -1);\n    if (virConnectDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->hypervisorDriver->name);\n        return -1;\n    }\n\n    VIR_DEBUG(\"registering %s as driver %d\",\n           driver->hypervisorDriver->name, virConnectDriverTabCount);\n\n    if (setSharedDrivers) {\n        if (driver->interfaceDriver == NULL)\n            driver->interfaceDriver = virSharedInterfaceDriver;\n        if (driver->networkDriver == NULL)\n            driver->networkDriver = virSharedNetworkDriver;\n        if (driver->nodeDeviceDriver == NULL)\n            driver->nodeDeviceDriver = virSharedNodeDeviceDriver;\n        if (driver->nwfilterDriver == NULL)\n            driver->nwfilterDriver = virSharedNWFilterDriver;\n        if (driver->secretDriver == NULL)\n            driver->secretDriver = virSharedSecretDriver;\n        if (driver->storageDriver == NULL)\n            driver->storageDriver = virSharedStorageDriver;\n    }\n\n    virConnectDriverTab[virConnectDriverTabCount] = driver;\n    return virConnectDriverTabCount++;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriver storageDriver = {\n    .name = \"storage\",\n    .connectNumOfStoragePools = storageConnectNumOfStoragePools, /* 0.4.0 */\n    .connectListStoragePools = storageConnectListStoragePools, /* 0.4.0 */\n    .connectNumOfDefinedStoragePools = storageConnectNumOfDefinedStoragePools, /* 0.4.0 */\n    .connectListDefinedStoragePools = storageConnectListDefinedStoragePools, /* 0.4.0 */\n    .connectListAllStoragePools = storageConnectListAllStoragePools, /* 0.10.2 */\n    .connectStoragePoolEventRegisterAny = storageConnectStoragePoolEventRegisterAny, /* 2.0.0 */\n    .connectStoragePoolEventDeregisterAny = storageConnectStoragePoolEventDeregisterAny, /* 2.0.0 */\n    .connectFindStoragePoolSources = storageConnectFindStoragePoolSources, /* 0.4.0 */\n    .connectGetStoragePoolCapabilities = storageConnectGetStoragePoolCapabilities, /* 5.2.0 */\n    .storagePoolLookupByName = storagePoolLookupByName, /* 0.4.0 */\n    .storagePoolLookupByUUID = storagePoolLookupByUUID, /* 0.4.0 */\n    .storagePoolLookupByVolume = storagePoolLookupByVolume, /* 0.4.0 */\n    .storagePoolLookupByTargetPath = storagePoolLookupByTargetPath, /* 4.1.0 */\n    .storagePoolCreateXML = storagePoolCreateXML, /* 0.4.0 */\n    .storagePoolDefineXML = storagePoolDefineXML, /* 0.4.0 */\n    .storagePoolBuild = storagePoolBuild, /* 0.4.0 */\n    .storagePoolUndefine = storagePoolUndefine, /* 0.4.0 */\n    .storagePoolCreate = storagePoolCreate, /* 0.4.0 */\n    .storagePoolDestroy = storagePoolDestroy, /* 0.4.0 */\n    .storagePoolDelete = storagePoolDelete, /* 0.4.0 */\n    .storagePoolRefresh = storagePoolRefresh, /* 0.4.0 */\n    .storagePoolGetInfo = storagePoolGetInfo, /* 0.4.0 */\n    .storagePoolGetXMLDesc = storagePoolGetXMLDesc, /* 0.4.0 */\n    .storagePoolGetAutostart = storagePoolGetAutostart, /* 0.4.0 */\n    .storagePoolSetAutostart = storagePoolSetAutostart, /* 0.4.0 */\n    .storagePoolNumOfVolumes = storagePoolNumOfVolumes, /* 0.4.0 */\n    .storagePoolListVolumes = storagePoolListVolumes, /* 0.4.0 */\n    .storagePoolListAllVolumes = storagePoolListAllVolumes, /* 0.10.2 */\n\n    .storageVolLookupByName = storageVolLookupByName, /* 0.4.0 */\n    .storageVolLookupByKey = storageVolLookupByKey, /* 0.4.0 */\n    .storageVolLookupByPath = storageVolLookupByPath, /* 0.4.0 */\n    .storageVolCreateXML = storageVolCreateXML, /* 0.4.0 */\n    .storageVolCreateXMLFrom = storageVolCreateXMLFrom, /* 0.6.4 */\n    .storageVolDownload = storageVolDownload, /* 0.9.0 */\n    .storageVolUpload = storageVolUpload, /* 0.9.0 */\n    .storageVolDelete = storageVolDelete, /* 0.4.0 */\n    .storageVolWipe = storageVolWipe, /* 0.8.0 */\n    .storageVolWipePattern = storageVolWipePattern, /* 0.9.10 */\n    .storageVolGetInfo = storageVolGetInfo, /* 0.4.0 */\n    .storageVolGetInfoFlags = storageVolGetInfoFlags, /* 3.0.0 */\n    .storageVolGetXMLDesc = storageVolGetXMLDesc, /* 0.4.0 */\n    .storageVolGetPath = storageVolGetPath, /* 0.4.0 */\n    .storageVolResize = storageVolResize, /* 0.9.10 */\n\n    .storagePoolIsActive = storagePoolIsActive, /* 0.7.3 */\n    .storagePoolIsPersistent = storagePoolIsPersistent, /* 0.7.3 */\n};\nstatic virConnectDriver storageConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"storage\", NULL },\n    .hypervisorDriver = &storageHypervisorDriver,\n    .storageDriver = &storageDriver,\n};\nstatic virStateDriver stateDriver = {\n    .name = \"storage\",\n    .stateInitialize = storageStateInitialize,\n    .stateCleanup = storageStateCleanup,\n    .stateReload = storageStateReload,\n};\n\nstatic int\nstorageRegisterFull(bool allbackends)\n{\n    if (virRegisterConnectDriver(&storageConnectDriver, false) < 0)\n        return -1;\n    if (virStorageBackendDriversRegister(allbackends) < 0)\n        return -1;\n    if (virSetSharedStorageDriver(&storageDriver) < 0)\n        return -1;\n    if (virRegisterStateDriver(&stateDriver) < 0)\n        return -1;\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolObjBuildTempFilePath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2836-2847",
    "snippet": "char *\nvirStoragePoolObjBuildTempFilePath(virStoragePoolObjPtr obj,\n                                   virStorageVolDefPtr voldef)\n\n{\n    virStoragePoolDefPtr def = virStoragePoolObjGetDef(obj);\n    char *tmp = NULL;\n\n    tmp = g_strdup_printf(\"%s/%s.%s.secret.XXXXXX\",\n                          driver->stateDir, def->name, voldef->name);\n    return tmp;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s.%s.secret.XXXXXX\"",
            "driver->stateDir",
            "def->name",
            "voldef->name"
          ],
          "line": 2844
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 2841
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nchar *\nvirStoragePoolObjBuildTempFilePath(virStoragePoolObjPtr obj,\n                                   virStorageVolDefPtr voldef)\n\n{\n    virStoragePoolDefPtr def = virStoragePoolObjGetDef(obj);\n    char *tmp = NULL;\n\n    tmp = g_strdup_printf(\"%s/%s.%s.secret.XXXXXX\",\n                          driver->stateDir, def->name, voldef->name);\n    return tmp;\n}"
  },
  {
    "function_name": "virStoragePoolObjFindPoolByUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2818-2822",
    "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjFindPoolByUUID(const unsigned char *uuid)\n{\n    return virStoragePoolObjFindByUUID(driver->pools, uuid);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjFindByUUID",
          "args": [
            "driver->pools",
            "uuid"
          ],
          "line": 2821
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "563-576",
          "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjFindByUUID(virStoragePoolObjListPtr pools,\n                            const unsigned char *uuid)\n{\n    virStoragePoolObjPtr obj;\n\n    virObjectRWLockRead(pools);\n    obj = virStoragePoolObjFindByUUIDLocked(pools, uuid);\n    virObjectRWUnlock(pools);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolObjPtr\nvirStoragePoolObjFindByUUID(virStoragePoolObjListPtr pools,\n                            const unsigned char *uuid)\n{\n    virStoragePoolObjPtr obj;\n\n    virObjectRWLockRead(pools);\n    obj = virStoragePoolObjFindByUUIDLocked(pools, uuid);\n    virObjectRWUnlock(pools);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nvirStoragePoolObjPtr\nvirStoragePoolObjFindPoolByUUID(const unsigned char *uuid)\n{\n    return virStoragePoolObjFindByUUID(driver->pools, uuid);\n}"
  },
  {
    "function_name": "storageConnectStoragePoolEventDeregisterAny",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2791-2804",
    "snippet": "static int\nstorageConnectStoragePoolEventDeregisterAny(virConnectPtr conn,\n                                            int callbackID)\n{\n    if (virConnectStoragePoolEventDeregisterAnyEnsureACL(conn) < 0)\n        return -1;\n\n    if (virObjectEventStateDeregisterID(conn,\n                                        driver->storageEventState,\n                                        callbackID, true) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateDeregisterID",
          "args": [
            "conn",
            "driver->storageEventState",
            "callbackID",
            "true"
          ],
          "line": 2798
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateDeregisterID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "936-957",
          "snippet": "int\nvirObjectEventStateDeregisterID(virConnectPtr conn,\n                                virObjectEventStatePtr state,\n                                int callbackID,\n                                bool doFreeCb)\n{\n    int ret;\n\n    virObjectLock(state);\n    if (state->isDispatching)\n        ret = virObjectEventCallbackListMarkDeleteID(conn,\n                                                     state->callbacks,\n                                                     callbackID);\n    else\n        ret = virObjectEventCallbackListRemoveID(conn, state->callbacks,\n                                                 callbackID, doFreeCb);\n\n    virObjectEventStateCleanupTimer(state, true);\n\n    virObjectUnlock(state);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nint\nvirObjectEventStateDeregisterID(virConnectPtr conn,\n                                virObjectEventStatePtr state,\n                                int callbackID,\n                                bool doFreeCb)\n{\n    int ret;\n\n    virObjectLock(state);\n    if (state->isDispatching)\n        ret = virObjectEventCallbackListMarkDeleteID(conn,\n                                                     state->callbacks,\n                                                     callbackID);\n    else\n        ret = virObjectEventCallbackListRemoveID(conn, state->callbacks,\n                                                 callbackID, doFreeCb);\n\n    virObjectEventStateCleanupTimer(state, true);\n\n    virObjectUnlock(state);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectStoragePoolEventDeregisterAnyEnsureACL",
          "args": [
            "conn"
          ],
          "line": 2795
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstorageConnectStoragePoolEventDeregisterAny(virConnectPtr conn,\n                                            int callbackID)\n{\n    if (virConnectStoragePoolEventDeregisterAnyEnsureACL(conn) < 0)\n        return -1;\n\n    if (virObjectEventStateDeregisterID(conn,\n                                        driver->storageEventState,\n                                        callbackID, true) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "storageConnectStoragePoolEventRegisterAny",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2770-2789",
    "snippet": "static int\nstorageConnectStoragePoolEventRegisterAny(virConnectPtr conn,\n                                          virStoragePoolPtr pool,\n                                          int eventID,\n                                          virConnectStoragePoolEventGenericCallback callback,\n                                          void *opaque,\n                                          virFreeCallback freecb)\n{\n    int callbackID = -1;\n\n    if (virConnectStoragePoolEventRegisterAnyEnsureACL(conn) < 0)\n        return -1;\n\n    if (virStoragePoolEventStateRegisterID(conn, driver->storageEventState,\n                                           pool, eventID, callback,\n                                           opaque, freecb, &callbackID) < 0)\n        callbackID = -1;\n\n    return callbackID;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolEventStateRegisterID",
          "args": [
            "conn",
            "driver->storageEventState",
            "pool",
            "eventID",
            "callback",
            "opaque",
            "freecb",
            "&callbackID"
          ],
          "line": 2783
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolEventStateRegisterID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
          "lines": "167-190",
          "snippet": "int\nvirStoragePoolEventStateRegisterID(virConnectPtr conn,\n                                   virObjectEventStatePtr state,\n                                   virStoragePoolPtr pool,\n                                   int eventID,\n                                   virConnectStoragePoolEventGenericCallback cb,\n                                   void *opaque,\n                                   virFreeCallback freecb,\n                                   int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return -1;\n\n    if (pool)\n        virUUIDFormat(pool->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, pool ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virStoragePoolEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, false);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"storage_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virStoragePoolEventClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolEventClass;\n\nint\nvirStoragePoolEventStateRegisterID(virConnectPtr conn,\n                                   virObjectEventStatePtr state,\n                                   virStoragePoolPtr pool,\n                                   int eventID,\n                                   virConnectStoragePoolEventGenericCallback cb,\n                                   void *opaque,\n                                   virFreeCallback freecb,\n                                   int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return -1;\n\n    if (pool)\n        virUUIDFormat(pool->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, pool ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virStoragePoolEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectStoragePoolEventRegisterAnyEnsureACL",
          "args": [
            "conn"
          ],
          "line": 2780
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstorageConnectStoragePoolEventRegisterAny(virConnectPtr conn,\n                                          virStoragePoolPtr pool,\n                                          int eventID,\n                                          virConnectStoragePoolEventGenericCallback callback,\n                                          void *opaque,\n                                          virFreeCallback freecb)\n{\n    int callbackID = -1;\n\n    if (virConnectStoragePoolEventRegisterAnyEnsureACL(conn) < 0)\n        return -1;\n\n    if (virStoragePoolEventStateRegisterID(conn, driver->storageEventState,\n                                           pool, eventID, callback,\n                                           opaque, freecb, &callbackID) < 0)\n        callbackID = -1;\n\n    return callbackID;\n}"
  },
  {
    "function_name": "storageConnectListAllStoragePools",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2755-2768",
    "snippet": "static int\nstorageConnectListAllStoragePools(virConnectPtr conn,\n                                  virStoragePoolPtr **pools,\n                                  unsigned int flags)\n{\n    virCheckFlags(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_ALL, -1);\n\n    if (virConnectListAllStoragePoolsEnsureACL(conn) < 0)\n        return -1;\n\n    return virStoragePoolObjListExport(conn, driver->pools, pools,\n                                       virConnectListAllStoragePoolsCheckACL,\n                                       flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjListExport",
          "args": [
            "conn",
            "driver->pools",
            "pools",
            "virConnectListAllStoragePoolsCheckACL",
            "flags"
          ],
          "line": 2765
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjListExport",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "2067-2100",
          "snippet": "int\nvirStoragePoolObjListExport(virConnectPtr conn,\n                            virStoragePoolObjListPtr poolobjs,\n                            virStoragePoolPtr **pools,\n                            virStoragePoolObjListFilter filter,\n                            unsigned int flags)\n{\n    virStoragePoolObjListExportData data = {\n        .conn = conn, .filter = filter, .flags = flags, .error = false,\n        .nPools = 0, .pools = NULL };\n\n    virObjectRWLockRead(poolobjs);\n\n    if (pools && VIR_ALLOC_N(data.pools, virHashSize(poolobjs->objs) + 1) < 0)\n        goto error;\n\n    virHashForEach(poolobjs->objs, virStoragePoolObjListExportCallback, &data);\n    virObjectRWUnlock(poolobjs);\n\n    if (data.error)\n        goto error;\n\n    if (data.pools) {\n        /* trim the array to the final size */\n        ignore_value(VIR_REALLOC_N(data.pools, data.nPools + 1));\n        *pools = data.pools;\n    }\n\n    return data.nPools;\n\n error:\n    virObjectListFree(data.pools);\n    return -1;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjListExport(virConnectPtr conn,\n                            virStoragePoolObjListPtr poolobjs,\n                            virStoragePoolPtr **pools,\n                            virStoragePoolObjListFilter filter,\n                            unsigned int flags)\n{\n    virStoragePoolObjListExportData data = {\n        .conn = conn, .filter = filter, .flags = flags, .error = false,\n        .nPools = 0, .pools = NULL };\n\n    virObjectRWLockRead(poolobjs);\n\n    if (pools && VIR_ALLOC_N(data.pools, virHashSize(poolobjs->objs) + 1) < 0)\n        goto error;\n\n    virHashForEach(poolobjs->objs, virStoragePoolObjListExportCallback, &data);\n    virObjectRWUnlock(poolobjs);\n\n    if (data.error)\n        goto error;\n\n    if (data.pools) {\n        /* trim the array to the final size */\n        ignore_value(VIR_REALLOC_N(data.pools, data.nPools + 1));\n        *pools = data.pools;\n    }\n\n    return data.nPools;\n\n error:\n    virObjectListFree(data.pools);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectListAllStoragePoolsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 2762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_ALL",
            "-1"
          ],
          "line": 2760
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstorageConnectListAllStoragePools(virConnectPtr conn,\n                                  virStoragePoolPtr **pools,\n                                  unsigned int flags)\n{\n    virCheckFlags(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_ALL, -1);\n\n    if (virConnectListAllStoragePoolsEnsureACL(conn) < 0)\n        return -1;\n\n    return virStoragePoolObjListExport(conn, driver->pools, pools,\n                                       virConnectListAllStoragePoolsCheckACL,\n                                       flags);\n}"
  },
  {
    "function_name": "storageVolGetPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2734-2753",
    "snippet": "static char *\nstorageVolGetPath(virStorageVolPtr vol)\n{\n    virStoragePoolObjPtr obj;\n    virStorageVolDefPtr voldef;\n    char *ret = NULL;\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, NULL)))\n        return NULL;\n\n    if (virStorageVolGetPathEnsureACL(vol->conn, virStoragePoolObjGetDef(obj),\n                                      voldef) < 0)\n        goto cleanup;\n\n    ret = g_strdup(voldef->target.path);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 2751
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "voldef->target.path"
          ],
          "line": 2748
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolGetPathEnsureACL",
          "args": [
            "vol->conn",
            "virStoragePoolObjGetDef(obj)",
            "voldef"
          ],
          "line": 2744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 2744
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolDefFromVol",
          "args": [
            "vol",
            "&obj",
            "NULL"
          ],
          "line": 2741
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefFromVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1806-1843",
          "snippet": "static virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *\nstorageVolGetPath(virStorageVolPtr vol)\n{\n    virStoragePoolObjPtr obj;\n    virStorageVolDefPtr voldef;\n    char *ret = NULL;\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, NULL)))\n        return NULL;\n\n    if (virStorageVolGetPathEnsureACL(vol->conn, virStoragePoolObjGetDef(obj),\n                                      voldef) < 0)\n        goto cleanup;\n\n    ret = g_strdup(voldef->target.path);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "storageVolGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2703-2732",
    "snippet": "static char *\nstorageVolGetXMLDesc(virStorageVolPtr vol,\n                     unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldef;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStorageVolGetXMLDescEnsureACL(vol->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldef) < 0)\n        goto cleanup;\n\n    ret = virStorageVolDefFormat(def, voldef);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 2729
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolDefFormat",
          "args": [
            "def",
            "voldef"
          ],
          "line": 2726
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1594-1670",
          "snippet": "char *\nvirStorageVolDefFormat(virStoragePoolDefPtr pool,\n                       virStorageVolDefPtr def)\n{\n    virStorageVolOptionsPtr options;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    options = virStorageVolOptionsForPoolType(pool->type);\n    if (options == NULL)\n        return NULL;\n\n    virBufferAsprintf(&buf, \"<volume type='%s'>\\n\",\n                      virStorageVolTypeToString(def->type));\n    virBufferAdjustIndent(&buf, 2);\n\n    virBufferEscapeString(&buf, \"<name>%s</name>\\n\", def->name);\n    virBufferEscapeString(&buf, \"<key>%s</key>\\n\", def->key);\n    virBufferAddLit(&buf, \"<source>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (def->source.nextent) {\n        size_t i;\n        const char *thispath = NULL;\n        for (i = 0; i < def->source.nextent; i++) {\n            if (thispath == NULL ||\n                STRNEQ(thispath, def->source.extents[i].path)) {\n                if (thispath != NULL)\n                    virBufferAddLit(&buf, \"</device>\\n\");\n\n                virBufferEscapeString(&buf, \"<device path='%s'>\\n\",\n                                      def->source.extents[i].path);\n            }\n\n            virBufferAdjustIndent(&buf, 2);\n            virBufferAsprintf(&buf, \"<extent start='%llu' end='%llu'/>\\n\",\n                              def->source.extents[i].start,\n                              def->source.extents[i].end);\n            virBufferAdjustIndent(&buf, -2);\n            thispath = def->source.extents[i].path;\n        }\n        if (thispath != NULL)\n            virBufferAddLit(&buf, \"</device>\\n\");\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</source>\\n\");\n\n    virBufferAsprintf(&buf, \"<capacity unit='bytes'>%llu</capacity>\\n\",\n                      def->target.capacity);\n    virBufferAsprintf(&buf, \"<allocation unit='bytes'>%llu</allocation>\\n\",\n                      def->target.allocation);\n    /* NB: Display only - since virStorageVolInfo is limited to just\n     * 'capacity' and 'allocation' on output. Since we don't read this\n     * in, be sure it was filled in before printing */\n    if (def->target.physical)\n        virBufferAsprintf(&buf, \"<physical unit='bytes'>%llu</physical>\\n\",\n                          def->target.physical);\n\n    if (virStorageVolTargetDefFormat(options, &buf,\n                                     &def->target, \"target\") < 0)\n        goto cleanup;\n\n    if (virStorageSourceHasBacking(&def->target) &&\n        virStorageVolTargetDefFormat(options, &buf,\n                                     def->target.backingStore,\n                                     \"backingStore\") < 0)\n        goto cleanup;\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</volume>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n cleanup:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nvirStorageVolDefFormat(virStoragePoolDefPtr pool,\n                       virStorageVolDefPtr def)\n{\n    virStorageVolOptionsPtr options;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    options = virStorageVolOptionsForPoolType(pool->type);\n    if (options == NULL)\n        return NULL;\n\n    virBufferAsprintf(&buf, \"<volume type='%s'>\\n\",\n                      virStorageVolTypeToString(def->type));\n    virBufferAdjustIndent(&buf, 2);\n\n    virBufferEscapeString(&buf, \"<name>%s</name>\\n\", def->name);\n    virBufferEscapeString(&buf, \"<key>%s</key>\\n\", def->key);\n    virBufferAddLit(&buf, \"<source>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (def->source.nextent) {\n        size_t i;\n        const char *thispath = NULL;\n        for (i = 0; i < def->source.nextent; i++) {\n            if (thispath == NULL ||\n                STRNEQ(thispath, def->source.extents[i].path)) {\n                if (thispath != NULL)\n                    virBufferAddLit(&buf, \"</device>\\n\");\n\n                virBufferEscapeString(&buf, \"<device path='%s'>\\n\",\n                                      def->source.extents[i].path);\n            }\n\n            virBufferAdjustIndent(&buf, 2);\n            virBufferAsprintf(&buf, \"<extent start='%llu' end='%llu'/>\\n\",\n                              def->source.extents[i].start,\n                              def->source.extents[i].end);\n            virBufferAdjustIndent(&buf, -2);\n            thispath = def->source.extents[i].path;\n        }\n        if (thispath != NULL)\n            virBufferAddLit(&buf, \"</device>\\n\");\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</source>\\n\");\n\n    virBufferAsprintf(&buf, \"<capacity unit='bytes'>%llu</capacity>\\n\",\n                      def->target.capacity);\n    virBufferAsprintf(&buf, \"<allocation unit='bytes'>%llu</allocation>\\n\",\n                      def->target.allocation);\n    /* NB: Display only - since virStorageVolInfo is limited to just\n     * 'capacity' and 'allocation' on output. Since we don't read this\n     * in, be sure it was filled in before printing */\n    if (def->target.physical)\n        virBufferAsprintf(&buf, \"<physical unit='bytes'>%llu</physical>\\n\",\n                          def->target.physical);\n\n    if (virStorageVolTargetDefFormat(options, &buf,\n                                     &def->target, \"target\") < 0)\n        goto cleanup;\n\n    if (virStorageSourceHasBacking(&def->target) &&\n        virStorageVolTargetDefFormat(options, &buf,\n                                     def->target.backingStore,\n                                     \"backingStore\") < 0)\n        goto cleanup;\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</volume>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n cleanup:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->refreshVol",
          "args": [
            "obj",
            "voldef"
          ],
          "line": 2723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolGetXMLDescEnsureACL",
          "args": [
            "vol->conn",
            "def",
            "voldef"
          ],
          "line": 2719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 2717
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolDefFromVol",
          "args": [
            "vol",
            "&obj",
            "&backend"
          ],
          "line": 2715
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefFromVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1806-1843",
          "snippet": "static virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "NULL"
          ],
          "line": 2713
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *\nstorageVolGetXMLDesc(virStorageVolPtr vol,\n                     unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldef;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStorageVolGetXMLDescEnsureACL(vol->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldef) < 0)\n        goto cleanup;\n\n    ret = virStorageVolDefFormat(def, voldef);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}"
  },
  {
    "function_name": "storageVolGetInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2695-2700",
    "snippet": "static int\nstorageVolGetInfo(virStorageVolPtr vol,\n                  virStorageVolInfoPtr info)\n{\n    return storageVolGetInfoFlags(vol, info, 0);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "storageVolGetInfoFlags",
          "args": [
            "vol",
            "info",
            "0"
          ],
          "line": 2699
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolGetInfoFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2656-2692",
          "snippet": "static int\nstorageVolGetInfoFlags(virStorageVolPtr vol,\n                       virStorageVolInfoPtr info,\n                       unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldef;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_GET_PHYSICAL, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolGetInfoFlagsEnsureACL(vol->conn,\n                                           virStoragePoolObjGetDef(obj),\n                                           voldef) < 0)\n        goto cleanup;\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldef) < 0)\n        goto cleanup;\n\n    memset(info, 0, sizeof(*info));\n    info->type = voldef->type;\n    info->capacity = voldef->target.capacity;\n    if (flags & VIR_STORAGE_VOL_GET_PHYSICAL)\n        info->allocation = voldef->target.physical;\n    else\n        info->allocation = voldef->target.allocation;\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolGetInfoFlags(virStorageVolPtr vol,\n                       virStorageVolInfoPtr info,\n                       unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldef;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_GET_PHYSICAL, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolGetInfoFlagsEnsureACL(vol->conn,\n                                           virStoragePoolObjGetDef(obj),\n                                           voldef) < 0)\n        goto cleanup;\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldef) < 0)\n        goto cleanup;\n\n    memset(info, 0, sizeof(*info));\n    info->type = voldef->type;\n    info->capacity = voldef->target.capacity;\n    if (flags & VIR_STORAGE_VOL_GET_PHYSICAL)\n        info->allocation = voldef->target.physical;\n    else\n        info->allocation = voldef->target.allocation;\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolGetInfo(virStorageVolPtr vol,\n                  virStorageVolInfoPtr info)\n{\n    return storageVolGetInfoFlags(vol, info, 0);\n}"
  },
  {
    "function_name": "storageVolGetInfoFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2656-2692",
    "snippet": "static int\nstorageVolGetInfoFlags(virStorageVolPtr vol,\n                       virStorageVolInfoPtr info,\n                       unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldef;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_GET_PHYSICAL, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolGetInfoFlagsEnsureACL(vol->conn,\n                                           virStoragePoolObjGetDef(obj),\n                                           voldef) < 0)\n        goto cleanup;\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldef) < 0)\n        goto cleanup;\n\n    memset(info, 0, sizeof(*info));\n    info->type = voldef->type;\n    info->capacity = voldef->target.capacity;\n    if (flags & VIR_STORAGE_VOL_GET_PHYSICAL)\n        info->allocation = voldef->target.physical;\n    else\n        info->allocation = voldef->target.allocation;\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 2690
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "info",
            "0",
            "sizeof(*info)"
          ],
          "line": 2680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "backend->refreshVol",
          "args": [
            "obj",
            "voldef"
          ],
          "line": 2677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolGetInfoFlagsEnsureACL",
          "args": [
            "vol->conn",
            "virStoragePoolObjGetDef(obj)",
            "voldef"
          ],
          "line": 2671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 2672
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolDefFromVol",
          "args": [
            "vol",
            "&obj",
            "&backend"
          ],
          "line": 2668
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefFromVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1806-1843",
          "snippet": "static virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_STORAGE_VOL_GET_PHYSICAL",
            "-1"
          ],
          "line": 2666
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolGetInfoFlags(virStorageVolPtr vol,\n                       virStorageVolInfoPtr info,\n                       unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldef;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_GET_PHYSICAL, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolGetInfoFlagsEnsureACL(vol->conn,\n                                           virStoragePoolObjGetDef(obj),\n                                           voldef) < 0)\n        goto cleanup;\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldef) < 0)\n        goto cleanup;\n\n    memset(info, 0, sizeof(*info));\n    info->type = voldef->type;\n    info->capacity = voldef->target.capacity;\n    if (flags & VIR_STORAGE_VOL_GET_PHYSICAL)\n        info->allocation = voldef->target.physical;\n    else\n        info->allocation = voldef->target.allocation;\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "storageVolWipe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2648-2653",
    "snippet": "static int\nstorageVolWipe(virStorageVolPtr vol,\n               unsigned int flags)\n{\n    return storageVolWipePattern(vol, VIR_STORAGE_VOL_WIPE_ALG_ZERO, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "storageVolWipePattern",
          "args": [
            "vol",
            "VIR_STORAGE_VOL_WIPE_ALG_ZERO",
            "flags"
          ],
          "line": 2652
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolWipePattern",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2567-2646",
          "snippet": "static int\nstorageVolWipePattern(virStorageVolPtr vol,\n                      unsigned int algorithm,\n                      unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStorageVolDefPtr voldef = NULL;\n    int rc;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (algorithm >= VIR_STORAGE_VOL_WIPE_ALG_LAST) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"wiping algorithm %d not supported\"),\n                       algorithm);\n        return -1;\n    }\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolWipePatternEnsureACL(vol->conn,\n                                          virStoragePoolObjGetDef(obj),\n                                          voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->wipeVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool doesn't support volume wiping\"));\n        goto cleanup;\n    }\n\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->in_use++;\n    virObjectUnlock(obj);\n\n    rc = backend->wipeVol(obj, voldef, algorithm, flags);\n\n    virObjectLock(obj);\n    voldef->in_use--;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n    if (rc < 0)\n        goto cleanup;\n\n    /* For local volumes, Instead of using the refreshVol, since\n     * much changes on the target volume, let's update using the\n     * same function as refreshPool would use when it discovers a\n     * volume. The only failure to capture is -1, we can ignore\n     * -2. */\n    if ((backend->type == VIR_STORAGE_POOL_DIR ||\n         backend->type == VIR_STORAGE_POOL_FS ||\n         backend->type == VIR_STORAGE_POOL_NETFS ||\n         backend->type == VIR_STORAGE_POOL_VSTORAGE) &&\n        virStorageBackendRefreshVolTargetUpdate(voldef) == -1)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolWipePattern(virStorageVolPtr vol,\n                      unsigned int algorithm,\n                      unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStorageVolDefPtr voldef = NULL;\n    int rc;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (algorithm >= VIR_STORAGE_VOL_WIPE_ALG_LAST) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"wiping algorithm %d not supported\"),\n                       algorithm);\n        return -1;\n    }\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolWipePatternEnsureACL(vol->conn,\n                                          virStoragePoolObjGetDef(obj),\n                                          voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->wipeVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool doesn't support volume wiping\"));\n        goto cleanup;\n    }\n\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->in_use++;\n    virObjectUnlock(obj);\n\n    rc = backend->wipeVol(obj, voldef, algorithm, flags);\n\n    virObjectLock(obj);\n    voldef->in_use--;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n    if (rc < 0)\n        goto cleanup;\n\n    /* For local volumes, Instead of using the refreshVol, since\n     * much changes on the target volume, let's update using the\n     * same function as refreshPool would use when it discovers a\n     * volume. The only failure to capture is -1, we can ignore\n     * -2. */\n    if ((backend->type == VIR_STORAGE_POOL_DIR ||\n         backend->type == VIR_STORAGE_POOL_FS ||\n         backend->type == VIR_STORAGE_POOL_NETFS ||\n         backend->type == VIR_STORAGE_POOL_VSTORAGE) &&\n        virStorageBackendRefreshVolTargetUpdate(voldef) == -1)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolWipe(virStorageVolPtr vol,\n               unsigned int flags)\n{\n    return storageVolWipePattern(vol, VIR_STORAGE_VOL_WIPE_ALG_ZERO, flags);\n}"
  },
  {
    "function_name": "storageVolWipePattern",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2567-2646",
    "snippet": "static int\nstorageVolWipePattern(virStorageVolPtr vol,\n                      unsigned int algorithm,\n                      unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStorageVolDefPtr voldef = NULL;\n    int rc;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (algorithm >= VIR_STORAGE_VOL_WIPE_ALG_LAST) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"wiping algorithm %d not supported\"),\n                       algorithm);\n        return -1;\n    }\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolWipePatternEnsureACL(vol->conn,\n                                          virStoragePoolObjGetDef(obj),\n                                          voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->wipeVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool doesn't support volume wiping\"));\n        goto cleanup;\n    }\n\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->in_use++;\n    virObjectUnlock(obj);\n\n    rc = backend->wipeVol(obj, voldef, algorithm, flags);\n\n    virObjectLock(obj);\n    voldef->in_use--;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n    if (rc < 0)\n        goto cleanup;\n\n    /* For local volumes, Instead of using the refreshVol, since\n     * much changes on the target volume, let's update using the\n     * same function as refreshPool would use when it discovers a\n     * volume. The only failure to capture is -1, we can ignore\n     * -2. */\n    if ((backend->type == VIR_STORAGE_POOL_DIR ||\n         backend->type == VIR_STORAGE_POOL_FS ||\n         backend->type == VIR_STORAGE_POOL_NETFS ||\n         backend->type == VIR_STORAGE_POOL_VSTORAGE) &&\n        virStorageBackendRefreshVolTargetUpdate(voldef) == -1)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 2643
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageBackendRefreshVolTargetUpdate",
          "args": [
            "voldef"
          ],
          "line": 2637
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendRefreshVolTargetUpdate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_util.c",
          "lines": "3442-3483",
          "snippet": "int\nvirStorageBackendRefreshVolTargetUpdate(virStorageVolDefPtr vol)\n{\n    int err;\n\n    /* Real value is filled in during probe */\n    vol->target.format = VIR_STORAGE_FILE_RAW;\n\n    if ((err = storageBackendProbeTarget(&vol->target,\n                                         &vol->target.encryption)) < 0) {\n        if (err == -2) {\n            return -2;\n        } else if (err == -3) {\n            /* The backing file is currently unavailable, its format is not\n             * explicitly specified, the probe to auto detect the format\n             * failed: continue with faked RAW format, since AUTO will\n             * break virStorageVolTargetDefFormat() generating the line\n             * <format type='...'/>. */\n        } else {\n            return -1;\n        }\n    }\n\n    /* directory based volume */\n    if (vol->target.format == VIR_STORAGE_FILE_DIR)\n        vol->type = VIR_STORAGE_VOL_DIR;\n\n    if (vol->target.format == VIR_STORAGE_FILE_PLOOP)\n        vol->type = VIR_STORAGE_VOL_PLOOP;\n\n    if (virStorageSourceHasBacking(&vol->target)) {\n        ignore_value(storageBackendUpdateVolTargetInfo(VIR_STORAGE_VOL_FILE,\n                                                       vol->target.backingStore,\n                                                       false,\n                                                       VIR_STORAGE_VOL_OPEN_DEFAULT, 0));\n        /* If this failed, the backing file is currently unavailable,\n         * the capacity, allocation, owner, group and mode are unknown.\n         * An error message was raised, but we just continue. */\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"virqemu.h\"",
            "#include \"virjson.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_util.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"viruuid.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virsecret.h\"",
            "#include \"secret_conf.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "# include <xfs/xfs.h>",
            "# include <linux/btrfs.h>",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <linux/fs.h>",
            "# include <sys/ioctl.h>",
            "#include <dirent.h>",
            "#include <sys/param.h>",
            "#include <sys/statvfs.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virfdstream.h\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"virqemu.h\"\n#include \"virjson.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_util.h\"\n#include \"virstoragefile.h\"\n#include \"viruuid.h\"\n#include \"vircrypto.h\"\n#include \"virsecret.h\"\n#include \"secret_conf.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n# include <xfs/xfs.h>\n# include <linux/btrfs.h>\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <linux/fs.h>\n# include <sys/ioctl.h>\n#include <dirent.h>\n#include <sys/param.h>\n#include <sys/statvfs.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirStorageBackendRefreshVolTargetUpdate(virStorageVolDefPtr vol)\n{\n    int err;\n\n    /* Real value is filled in during probe */\n    vol->target.format = VIR_STORAGE_FILE_RAW;\n\n    if ((err = storageBackendProbeTarget(&vol->target,\n                                         &vol->target.encryption)) < 0) {\n        if (err == -2) {\n            return -2;\n        } else if (err == -3) {\n            /* The backing file is currently unavailable, its format is not\n             * explicitly specified, the probe to auto detect the format\n             * failed: continue with faked RAW format, since AUTO will\n             * break virStorageVolTargetDefFormat() generating the line\n             * <format type='...'/>. */\n        } else {\n            return -1;\n        }\n    }\n\n    /* directory based volume */\n    if (vol->target.format == VIR_STORAGE_FILE_DIR)\n        vol->type = VIR_STORAGE_VOL_DIR;\n\n    if (vol->target.format == VIR_STORAGE_FILE_PLOOP)\n        vol->type = VIR_STORAGE_VOL_PLOOP;\n\n    if (virStorageSourceHasBacking(&vol->target)) {\n        ignore_value(storageBackendUpdateVolTargetInfo(VIR_STORAGE_VOL_FILE,\n                                                       vol->target.backingStore,\n                                                       false,\n                                                       VIR_STORAGE_VOL_OPEN_DEFAULT, 0));\n        /* If this failed, the backing file is currently unavailable,\n         * the capacity, allocation, owner, group and mode are unknown.\n         * An error message was raised, but we just continue. */\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjDecrAsyncjobs",
          "args": [
            "obj"
          ],
          "line": 2623
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjDecrAsyncjobs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "363-367",
          "snippet": "void\nvirStoragePoolObjDecrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs--;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjDecrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 2621
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->wipeVol",
          "args": [
            "obj",
            "voldef",
            "algorithm",
            "flags"
          ],
          "line": 2619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 2617
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIncrAsyncjobs",
          "args": [
            "obj"
          ],
          "line": 2615
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIncrAsyncjobs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "356-360",
          "snippet": "void\nvirStoragePoolObjIncrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs++;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjIncrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_SUPPORT",
            "\"%s\"",
            "_(\"storage pool doesn't support volume wiping\")"
          ],
          "line": 2610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"storage pool doesn't support volume wiping\""
          ],
          "line": 2611
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"volume '%s' is still being allocated.\")",
            "voldef->name"
          ],
          "line": 2603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"volume '%s' is still in use.\")",
            "voldef->name"
          ],
          "line": 2596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolWipePatternEnsureACL",
          "args": [
            "vol->conn",
            "virStoragePoolObjGetDef(obj)",
            "voldef"
          ],
          "line": 2590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 2591
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolDefFromVol",
          "args": [
            "vol",
            "&obj",
            "&backend"
          ],
          "line": 2587
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefFromVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1806-1843",
          "snippet": "static virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"wiping algorithm %d not supported\")",
            "algorithm"
          ],
          "line": 2581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 2578
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolWipePattern(virStorageVolPtr vol,\n                      unsigned int algorithm,\n                      unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStorageVolDefPtr voldef = NULL;\n    int rc;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (algorithm >= VIR_STORAGE_VOL_WIPE_ALG_LAST) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"wiping algorithm %d not supported\"),\n                       algorithm);\n        return -1;\n    }\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolWipePatternEnsureACL(vol->conn,\n                                          virStoragePoolObjGetDef(obj),\n                                          voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->wipeVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool doesn't support volume wiping\"));\n        goto cleanup;\n    }\n\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->in_use++;\n    virObjectUnlock(obj);\n\n    rc = backend->wipeVol(obj, voldef, algorithm, flags);\n\n    virObjectLock(obj);\n    voldef->in_use--;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n    if (rc < 0)\n        goto cleanup;\n\n    /* For local volumes, Instead of using the refreshVol, since\n     * much changes on the target volume, let's update using the\n     * same function as refreshPool would use when it discovers a\n     * volume. The only failure to capture is -1, we can ignore\n     * -2. */\n    if ((backend->type == VIR_STORAGE_POOL_DIR ||\n         backend->type == VIR_STORAGE_POOL_FS ||\n         backend->type == VIR_STORAGE_POOL_NETFS ||\n         backend->type == VIR_STORAGE_POOL_VSTORAGE) &&\n        virStorageBackendRefreshVolTargetUpdate(voldef) == -1)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}"
  },
  {
    "function_name": "storageVolResize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2466-2564",
    "snippet": "static int\nstorageVolResize(virStorageVolPtr vol,\n                 unsigned long long capacity,\n                 unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStorageVolDefPtr voldef = NULL;\n    unsigned long long abs_capacity, delta = 0;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_RESIZE_ALLOCATE |\n                  VIR_STORAGE_VOL_RESIZE_DELTA |\n                  VIR_STORAGE_VOL_RESIZE_SHRINK, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStorageVolResizeEnsureACL(vol->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (flags & VIR_STORAGE_VOL_RESIZE_DELTA) {\n        if (flags & VIR_STORAGE_VOL_RESIZE_SHRINK)\n            abs_capacity = voldef->target.capacity - MIN(capacity, voldef->target.capacity);\n        else\n            abs_capacity = voldef->target.capacity + capacity;\n        flags &= ~VIR_STORAGE_VOL_RESIZE_DELTA;\n    } else {\n        abs_capacity = capacity;\n    }\n\n    if (abs_capacity < voldef->target.allocation) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"can't shrink capacity below \"\n                         \"existing allocation\"));\n        goto cleanup;\n    }\n\n    if (abs_capacity < voldef->target.capacity &&\n        !(flags & VIR_STORAGE_VOL_RESIZE_SHRINK)) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Can't shrink capacity below current \"\n                         \"capacity unless shrink flag explicitly specified\"));\n        goto cleanup;\n    }\n\n    if (flags & VIR_STORAGE_VOL_RESIZE_ALLOCATE)\n        delta = abs_capacity - voldef->target.allocation;\n\n    if (delta > def->available) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"Not enough space left in storage pool\"));\n        goto cleanup;\n    }\n\n    if (!backend->resizeVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool does not support changing of \"\n                         \"volume capacity\"));\n        goto cleanup;\n    }\n\n    if (backend->resizeVol(obj, voldef, abs_capacity, flags) < 0)\n        goto cleanup;\n\n    voldef->target.capacity = abs_capacity;\n    /* Only update the allocation and pool values if we actually did the\n     * allocation; otherwise, this is akin to a create operation with a\n     * capacity value different and potentially much larger than available\n     */\n    if (flags & VIR_STORAGE_VOL_RESIZE_ALLOCATE) {\n        voldef->target.allocation = abs_capacity;\n        def->allocation += delta;\n        def->available -= delta;\n    }\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 2561
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->resizeVol",
          "args": [
            "obj",
            "voldef",
            "abs_capacity",
            "flags"
          ],
          "line": 2544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_SUPPORT",
            "\"%s\"",
            "_(\"storage pool does not support changing of \"\n                         \"volume capacity\")"
          ],
          "line": 2538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"storage pool does not support changing of \"\n                         \"volume capacity\""
          ],
          "line": 2539
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "_(\"Not enough space left in storage pool\")"
          ],
          "line": 2532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"Can't shrink capacity below current \"\n                         \"capacity unless shrink flag explicitly specified\")"
          ],
          "line": 2522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"can't shrink capacity below \"\n                         \"existing allocation\")"
          ],
          "line": 2514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MIN",
          "args": [
            "capacity",
            "voldef->target.capacity"
          ],
          "line": 2505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"volume '%s' is still being allocated.\")",
            "voldef->name"
          ],
          "line": 2497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"volume '%s' is still in use.\")",
            "voldef->name"
          ],
          "line": 2490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolResizeEnsureACL",
          "args": [
            "vol->conn",
            "def",
            "voldef"
          ],
          "line": 2486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 2484
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolDefFromVol",
          "args": [
            "vol",
            "&obj",
            "&backend"
          ],
          "line": 2482
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefFromVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1806-1843",
          "snippet": "static virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_STORAGE_VOL_RESIZE_ALLOCATE |\n                  VIR_STORAGE_VOL_RESIZE_DELTA |\n                  VIR_STORAGE_VOL_RESIZE_SHRINK",
            "-1"
          ],
          "line": 2478
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolResize(virStorageVolPtr vol,\n                 unsigned long long capacity,\n                 unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStorageVolDefPtr voldef = NULL;\n    unsigned long long abs_capacity, delta = 0;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_RESIZE_ALLOCATE |\n                  VIR_STORAGE_VOL_RESIZE_DELTA |\n                  VIR_STORAGE_VOL_RESIZE_SHRINK, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStorageVolResizeEnsureACL(vol->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (flags & VIR_STORAGE_VOL_RESIZE_DELTA) {\n        if (flags & VIR_STORAGE_VOL_RESIZE_SHRINK)\n            abs_capacity = voldef->target.capacity - MIN(capacity, voldef->target.capacity);\n        else\n            abs_capacity = voldef->target.capacity + capacity;\n        flags &= ~VIR_STORAGE_VOL_RESIZE_DELTA;\n    } else {\n        abs_capacity = capacity;\n    }\n\n    if (abs_capacity < voldef->target.allocation) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"can't shrink capacity below \"\n                         \"existing allocation\"));\n        goto cleanup;\n    }\n\n    if (abs_capacity < voldef->target.capacity &&\n        !(flags & VIR_STORAGE_VOL_RESIZE_SHRINK)) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Can't shrink capacity below current \"\n                         \"capacity unless shrink flag explicitly specified\"));\n        goto cleanup;\n    }\n\n    if (flags & VIR_STORAGE_VOL_RESIZE_ALLOCATE)\n        delta = abs_capacity - voldef->target.allocation;\n\n    if (delta > def->available) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"Not enough space left in storage pool\"));\n        goto cleanup;\n    }\n\n    if (!backend->resizeVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool does not support changing of \"\n                         \"volume capacity\"));\n        goto cleanup;\n    }\n\n    if (backend->resizeVol(obj, voldef, abs_capacity, flags) < 0)\n        goto cleanup;\n\n    voldef->target.capacity = abs_capacity;\n    /* Only update the allocation and pool values if we actually did the\n     * allocation; otherwise, this is akin to a create operation with a\n     * capacity value different and potentially much larger than available\n     */\n    if (flags & VIR_STORAGE_VOL_RESIZE_ALLOCATE) {\n        voldef->target.allocation = abs_capacity;\n        def->allocation += delta;\n        def->available -= delta;\n    }\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}"
  },
  {
    "function_name": "storageVolUpload",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2381-2464",
    "snippet": "static int\nstorageVolUpload(virStorageVolPtr vol,\n                 virStreamPtr stream,\n                 unsigned long long offset,\n                 unsigned long long length,\n                 unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStorageVolDefPtr voldef = NULL;\n    virStorageVolStreamInfoPtr cbdata = NULL;\n    int rc;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_UPLOAD_SPARSE_STREAM, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStorageVolUploadEnsureACL(vol->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->uploadVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool doesn't support volume upload\"));\n        goto cleanup;\n    }\n\n    /* Use the callback routine in order to\n     * refresh the pool after the volume upload stream closes. This way\n     * we make sure the volume and pool data are refreshed without user\n     * interaction and we can just lookup the backend in the callback\n     * routine in order to call the refresh API.\n     */\n    if (VIR_ALLOC(cbdata) < 0)\n        goto cleanup;\n    cbdata->pool_name = g_strdup(def->name);\n    if (voldef->type == VIR_STORAGE_VOL_PLOOP)\n        cbdata->vol_path = g_strdup(voldef->target.path);\n\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->in_use++;\n    virObjectUnlock(obj);\n\n    rc = backend->uploadVol(obj, voldef, stream, offset, length, flags);\n\n    virObjectLock(obj);\n    voldef->in_use--;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n    if (rc < 0)\n        goto cleanup;\n\n    /* Add cleanup callback - call after uploadVol since the stream\n     * is then fully set up\n     */\n    virFDStreamSetInternalCloseCb(stream,\n                                  virStorageVolFDStreamCloseCb,\n                                  cbdata, NULL);\n    cbdata = NULL;\n    ret = 0;\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    if (cbdata)\n        virStorageVolPoolRefreshDataFree(cbdata);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStorageVolPoolRefreshDataFree",
          "args": [
            "cbdata"
          ],
          "line": 2461
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolPoolRefreshDataFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2271-2278",
          "snippet": "static void\nvirStorageVolPoolRefreshDataFree(void *opaque)\n{\n    virStorageVolStreamInfoPtr cbdata = opaque;\n\n    VIR_FREE(cbdata->pool_name);\n    VIR_FREE(cbdata);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirStorageVolPoolRefreshDataFree(void *opaque)\n{\n    virStorageVolStreamInfoPtr cbdata = opaque;\n\n    VIR_FREE(cbdata->pool_name);\n    VIR_FREE(cbdata);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 2459
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFDStreamSetInternalCloseCb",
          "args": [
            "stream",
            "virStorageVolFDStreamCloseCb",
            "cbdata",
            "NULL"
          ],
          "line": 2453
        },
        "resolved": true,
        "details": {
          "function_name": "virFDStreamSetInternalCloseCb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfdstream.c",
          "lines": "1500-1509",
          "snippet": "int\nvirFDStreamSetInternalCloseCb(virStreamPtr st G_GNUC_UNUSED,\n                              virFDStreamInternalCloseCb cb G_GNUC_UNUSED,\n                              void *opaque G_GNUC_UNUSED,\n                              virFDStreamInternalCloseCbFreeOpaque fcb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"File streams are not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virprocess.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virfdstream.h\"",
            "# include <termios.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virprocess.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virfdstream.h\"\n# include <termios.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirFDStreamSetInternalCloseCb(virStreamPtr st G_GNUC_UNUSED,\n                              virFDStreamInternalCloseCb cb G_GNUC_UNUSED,\n                              void *opaque G_GNUC_UNUSED,\n                              virFDStreamInternalCloseCbFreeOpaque fcb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"File streams are not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjDecrAsyncjobs",
          "args": [
            "obj"
          ],
          "line": 2445
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjDecrAsyncjobs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "363-367",
          "snippet": "void\nvirStoragePoolObjDecrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs--;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjDecrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 2443
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->uploadVol",
          "args": [
            "obj",
            "voldef",
            "stream",
            "offset",
            "length",
            "flags"
          ],
          "line": 2441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 2439
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIncrAsyncjobs",
          "args": [
            "obj"
          ],
          "line": 2437
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIncrAsyncjobs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "356-360",
          "snippet": "void\nvirStoragePoolObjIncrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs++;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjIncrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "voldef->target.path"
          ],
          "line": 2435
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "cbdata"
          ],
          "line": 2431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_SUPPORT",
            "\"%s\"",
            "_(\"storage pool doesn't support volume upload\")"
          ],
          "line": 2420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"volume '%s' is still being allocated.\")",
            "voldef->name"
          ],
          "line": 2413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"volume '%s' is still in use.\")",
            "voldef->name"
          ],
          "line": 2406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolUploadEnsureACL",
          "args": [
            "vol->conn",
            "def",
            "voldef"
          ],
          "line": 2402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 2400
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolDefFromVol",
          "args": [
            "vol",
            "&obj",
            "&backend"
          ],
          "line": 2398
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefFromVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1806-1843",
          "snippet": "static virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_STORAGE_VOL_UPLOAD_SPARSE_STREAM",
            "-1"
          ],
          "line": 2396
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolUpload(virStorageVolPtr vol,\n                 virStreamPtr stream,\n                 unsigned long long offset,\n                 unsigned long long length,\n                 unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStorageVolDefPtr voldef = NULL;\n    virStorageVolStreamInfoPtr cbdata = NULL;\n    int rc;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_UPLOAD_SPARSE_STREAM, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStorageVolUploadEnsureACL(vol->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->uploadVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool doesn't support volume upload\"));\n        goto cleanup;\n    }\n\n    /* Use the callback routine in order to\n     * refresh the pool after the volume upload stream closes. This way\n     * we make sure the volume and pool data are refreshed without user\n     * interaction and we can just lookup the backend in the callback\n     * routine in order to call the refresh API.\n     */\n    if (VIR_ALLOC(cbdata) < 0)\n        goto cleanup;\n    cbdata->pool_name = g_strdup(def->name);\n    if (voldef->type == VIR_STORAGE_VOL_PLOOP)\n        cbdata->vol_path = g_strdup(voldef->target.path);\n\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->in_use++;\n    virObjectUnlock(obj);\n\n    rc = backend->uploadVol(obj, voldef, stream, offset, length, flags);\n\n    virObjectLock(obj);\n    voldef->in_use--;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n    if (rc < 0)\n        goto cleanup;\n\n    /* Add cleanup callback - call after uploadVol since the stream\n     * is then fully set up\n     */\n    virFDStreamSetInternalCloseCb(stream,\n                                  virStorageVolFDStreamCloseCb,\n                                  cbdata, NULL);\n    cbdata = NULL;\n    ret = 0;\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    if (cbdata)\n        virStorageVolPoolRefreshDataFree(cbdata);\n\n    return ret;\n}"
  },
  {
    "function_name": "virStorageVolFDStreamCloseCb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2363-2379",
    "snippet": "static void\nvirStorageVolFDStreamCloseCb(virStreamPtr st G_GNUC_UNUSED,\n                             void *opaque)\n{\n    virThread thread;\n\n    if (virThreadCreateFull(&thread, false, virStorageVolPoolRefreshThread,\n                            \"vol-refresh\", false, opaque) < 0) {\n        /* Not much else can be done */\n        VIR_ERROR(_(\"Failed to create thread to handle pool refresh\"));\n        goto error;\n    }\n    return; /* Thread will free opaque data */\n\n error:\n    virStorageVolPoolRefreshDataFree(opaque);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStorageVolPoolRefreshDataFree",
          "args": [
            "opaque"
          ],
          "line": 2378
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolPoolRefreshDataFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2271-2278",
          "snippet": "static void\nvirStorageVolPoolRefreshDataFree(void *opaque)\n{\n    virStorageVolStreamInfoPtr cbdata = opaque;\n\n    VIR_FREE(cbdata->pool_name);\n    VIR_FREE(cbdata);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirStorageVolPoolRefreshDataFree(void *opaque)\n{\n    virStorageVolStreamInfoPtr cbdata = opaque;\n\n    VIR_FREE(cbdata->pool_name);\n    VIR_FREE(cbdata);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Failed to create thread to handle pool refresh\")"
          ],
          "line": 2372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to create thread to handle pool refresh\""
          ],
          "line": 2372
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virThreadCreateFull",
          "args": [
            "&thread",
            "false",
            "virStorageVolPoolRefreshThread",
            "\"vol-refresh\"",
            "false",
            "opaque"
          ],
          "line": 2369
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadCreateFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "242-283",
          "snippet": "int virThreadCreateFull(virThreadPtr thread,\n                        bool joinable,\n                        virThreadFunc func,\n                        const char *name,\n                        bool worker,\n                        void *opaque)\n{\n    struct virThreadArgs *args;\n    pthread_attr_t attr;\n    int ret = -1;\n    int err;\n\n    if ((err = pthread_attr_init(&attr)) != 0)\n        goto cleanup;\n    if (VIR_ALLOC_QUIET(args) < 0) {\n        err = ENOMEM;\n        goto cleanup;\n    }\n\n    args->func = func;\n    args->name = g_strdup(name);\n    args->worker = worker;\n    args->opaque = opaque;\n\n    if (!joinable)\n        pthread_attr_setdetachstate(&attr, 1);\n\n    err = pthread_create(&thread->thread, &attr, virThreadHelper, args);\n    if (err != 0) {\n        g_free(args->name);\n        g_free(args);\n        goto cleanup;\n    }\n    /* New thread owns 'args' in success case, so don't free */\n\n    ret = 0;\n cleanup:\n    pthread_attr_destroy(&attr);\n    if (ret < 0)\n        errno = err;\n    return ret;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virThreadCreateFull(virThreadPtr thread,\n                        bool joinable,\n                        virThreadFunc func,\n                        const char *name,\n                        bool worker,\n                        void *opaque)\n{\n    struct virThreadArgs *args;\n    pthread_attr_t attr;\n    int ret = -1;\n    int err;\n\n    if ((err = pthread_attr_init(&attr)) != 0)\n        goto cleanup;\n    if (VIR_ALLOC_QUIET(args) < 0) {\n        err = ENOMEM;\n        goto cleanup;\n    }\n\n    args->func = func;\n    args->name = g_strdup(name);\n    args->worker = worker;\n    args->opaque = opaque;\n\n    if (!joinable)\n        pthread_attr_setdetachstate(&attr, 1);\n\n    err = pthread_create(&thread->thread, &attr, virThreadHelper, args);\n    if (err != 0) {\n        g_free(args->name);\n        g_free(args);\n        goto cleanup;\n    }\n    /* New thread owns 'args' in success case, so don't free */\n\n    ret = 0;\n cleanup:\n    pthread_attr_destroy(&attr);\n    if (ret < 0)\n        errno = err;\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirStorageVolFDStreamCloseCb(virStreamPtr st G_GNUC_UNUSED,\n                             void *opaque)\n{\n    virThread thread;\n\n    if (virThreadCreateFull(&thread, false, virStorageVolPoolRefreshThread,\n                            \"vol-refresh\", false, opaque) < 0) {\n        /* Not much else can be done */\n        VIR_ERROR(_(\"Failed to create thread to handle pool refresh\"));\n        goto error;\n    }\n    return; /* Thread will free opaque data */\n\n error:\n    virStorageVolPoolRefreshDataFree(opaque);\n}"
  },
  {
    "function_name": "virStorageVolPoolRefreshThread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2317-2354",
    "snippet": "static void\nvirStorageVolPoolRefreshThread(void *opaque)\n{\n    virStorageVolStreamInfoPtr cbdata = opaque;\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n\n    if (cbdata->vol_path) {\n        if (virStorageBackendPloopRestoreDesc(cbdata->vol_path) < 0)\n            goto cleanup;\n    }\n    if (!(obj = virStoragePoolObjFindByName(driver->pools,\n                                            cbdata->pool_name)))\n        goto cleanup;\n    def = virStoragePoolObjGetDef(obj);\n\n    /* If some thread is building a new volume in the pool, then we cannot\n     * clear out all vols and refresh the pool. So we'll just pass. */\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        VIR_DEBUG(\"Asyncjob in process, cannot refresh storage pool\");\n        goto cleanup;\n    }\n\n    if (!(backend = virStorageBackendForType(def->type)))\n        goto cleanup;\n\n    if (storagePoolRefreshImpl(backend, obj, NULL) < 0)\n        VIR_DEBUG(\"Failed to refresh storage pool\");\n\n    event = virStoragePoolEventRefreshNew(def->name, def->uuid);\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    virStorageVolPoolRefreshDataFree(cbdata);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStorageVolPoolRefreshDataFree",
          "args": [
            "cbdata"
          ],
          "line": 2353
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolPoolRefreshDataFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2271-2278",
          "snippet": "static void\nvirStorageVolPoolRefreshDataFree(void *opaque)\n{\n    virStorageVolStreamInfoPtr cbdata = opaque;\n\n    VIR_FREE(cbdata->pool_name);\n    VIR_FREE(cbdata);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirStorageVolPoolRefreshDataFree(void *opaque)\n{\n    virStorageVolStreamInfoPtr cbdata = opaque;\n\n    VIR_FREE(cbdata->pool_name);\n    VIR_FREE(cbdata);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 2352
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->storageEventState",
            "event"
          ],
          "line": 2351
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolEventRefreshNew",
          "args": [
            "def->name",
            "def->uuid"
          ],
          "line": 2348
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolEventRefreshNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
          "lines": "279-297",
          "snippet": "virObjectEventPtr\nvirStoragePoolEventRefreshNew(const char *name,\n                              const unsigned char *uuid)\n{\n    virStoragePoolEventRefreshPtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventRefreshClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_REFRESH,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    return (virObjectEventPtr)event;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"storage_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virStoragePoolEventRefreshClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolEventRefreshClass;\n\nvirObjectEventPtr\nvirStoragePoolEventRefreshNew(const char *name,\n                              const unsigned char *uuid)\n{\n    virStoragePoolEventRefreshPtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventRefreshClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_REFRESH,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    return (virObjectEventPtr)event;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Failed to refresh storage pool\""
          ],
          "line": 2346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "storagePoolRefreshImpl",
          "args": [
            "backend",
            "obj",
            "NULL"
          ],
          "line": 2345
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolRefreshImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "97-109",
          "snippet": "static int\nstoragePoolRefreshImpl(virStorageBackendPtr backend,\n                       virStoragePoolObjPtr obj,\n                       const char *stateFile)\n{\n    virStoragePoolObjClearVols(obj);\n    if (backend->refreshPool(obj) < 0) {\n        storagePoolRefreshFailCleanup(backend, obj, stateFile);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolRefreshImpl(virStorageBackendPtr backend,\n                       virStoragePoolObjPtr obj,\n                       const char *stateFile)\n{\n    virStoragePoolObjClearVols(obj);\n    if (backend->refreshPool(obj) < 0) {\n        storagePoolRefreshFailCleanup(backend, obj, stateFile);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageBackendForType",
          "args": [
            "def->type"
          ],
          "line": 2342
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendForType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
          "lines": "172-184",
          "snippet": "virStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}",
          "includes": [
            "# include \"storage_backend_vstorage.h\"",
            "# include \"storage_backend_zfs.h\"",
            "# include \"storage_backend_gluster.h\"",
            "# include \"storage_backend_sheepdog.h\"",
            "# include \"storage_backend_rbd.h\"",
            "# include \"storage_backend_fs.h\"",
            "# include \"storage_backend_disk.h\"",
            "# include \"storage_backend_mpath.h\"",
            "# include \"storage_backend_scsi.h\"",
            "# include \"storage_backend_iscsi_direct.h\"",
            "# include \"storage_backend_iscsi.h\"",
            "# include \"storage_backend_logical.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
            "static size_t virStorageBackendsCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Asyncjob in process, cannot refresh storage pool\""
          ],
          "line": 2338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetAsyncjobs",
          "args": [
            "obj"
          ],
          "line": 2337
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetAsyncjobs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "349-353",
          "snippet": "unsigned int\nvirStoragePoolObjGetAsyncjobs(virStoragePoolObjPtr obj)\n{\n    return obj->asyncjobs;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nunsigned int\nvirStoragePoolObjGetAsyncjobs(virStoragePoolObjPtr obj)\n{\n    return obj->asyncjobs;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 2333
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFindByName",
          "args": [
            "driver->pools",
            "cbdata->pool_name"
          ],
          "line": 2330
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "596-609",
          "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjFindByName(virStoragePoolObjListPtr pools,\n                            const char *name)\n{\n    virStoragePoolObjPtr obj;\n\n    virObjectRWLockRead(pools);\n    obj = virStoragePoolObjFindByNameLocked(pools, name);\n    virObjectRWUnlock(pools);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolObjPtr\nvirStoragePoolObjFindByName(virStoragePoolObjListPtr pools,\n                            const char *name)\n{\n    virStoragePoolObjPtr obj;\n\n    virObjectRWLockRead(pools);\n    obj = virStoragePoolObjFindByNameLocked(pools, name);\n    virObjectRWUnlock(pools);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageBackendPloopRestoreDesc",
          "args": [
            "cbdata->vol_path"
          ],
          "line": 2327
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendPloopRestoreDesc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2280-2307",
          "snippet": "static int\nvirStorageBackendPloopRestoreDesc(char *path)\n{\n    g_autoptr(virCommand) cmd = NULL;\n    g_autofree char *refresh_tool = NULL;\n    g_autofree char *desc = NULL;\n\n    desc = g_strdup_printf(\"%s/DiskDescriptor.xml\", path);\n\n    if (virFileRemove(desc, 0, 0) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"refresh ploop failed:\"\n                         \" unable to delete DiskDescriptor.xml\"));\n        return -1;\n    }\n\n    refresh_tool = virFindFileInPath(\"ploop\");\n    if (!refresh_tool) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"unable to find ploop, please install ploop tools\"));\n        return -1;\n    }\n\n    cmd = virCommandNewArgList(refresh_tool, \"restore-descriptor\",\n                               path, NULL);\n    virCommandAddArgFormat(cmd, \"%s/root.hds\", path);\n    return virCommandRun(cmd, NULL);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirStorageBackendPloopRestoreDesc(char *path)\n{\n    g_autoptr(virCommand) cmd = NULL;\n    g_autofree char *refresh_tool = NULL;\n    g_autofree char *desc = NULL;\n\n    desc = g_strdup_printf(\"%s/DiskDescriptor.xml\", path);\n\n    if (virFileRemove(desc, 0, 0) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"refresh ploop failed:\"\n                         \" unable to delete DiskDescriptor.xml\"));\n        return -1;\n    }\n\n    refresh_tool = virFindFileInPath(\"ploop\");\n    if (!refresh_tool) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"unable to find ploop, please install ploop tools\"));\n        return -1;\n    }\n\n    cmd = virCommandNewArgList(refresh_tool, \"restore-descriptor\",\n                               path, NULL);\n    virCommandAddArgFormat(cmd, \"%s/root.hds\", path);\n    return virCommandRun(cmd, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void\nvirStorageVolPoolRefreshThread(void *opaque)\n{\n    virStorageVolStreamInfoPtr cbdata = opaque;\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n\n    if (cbdata->vol_path) {\n        if (virStorageBackendPloopRestoreDesc(cbdata->vol_path) < 0)\n            goto cleanup;\n    }\n    if (!(obj = virStoragePoolObjFindByName(driver->pools,\n                                            cbdata->pool_name)))\n        goto cleanup;\n    def = virStoragePoolObjGetDef(obj);\n\n    /* If some thread is building a new volume in the pool, then we cannot\n     * clear out all vols and refresh the pool. So we'll just pass. */\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        VIR_DEBUG(\"Asyncjob in process, cannot refresh storage pool\");\n        goto cleanup;\n    }\n\n    if (!(backend = virStorageBackendForType(def->type)))\n        goto cleanup;\n\n    if (storagePoolRefreshImpl(backend, obj, NULL) < 0)\n        VIR_DEBUG(\"Failed to refresh storage pool\");\n\n    event = virStoragePoolEventRefreshNew(def->name, def->uuid);\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    virStorageVolPoolRefreshDataFree(cbdata);\n}"
  },
  {
    "function_name": "virStorageBackendPloopRestoreDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2280-2307",
    "snippet": "static int\nvirStorageBackendPloopRestoreDesc(char *path)\n{\n    g_autoptr(virCommand) cmd = NULL;\n    g_autofree char *refresh_tool = NULL;\n    g_autofree char *desc = NULL;\n\n    desc = g_strdup_printf(\"%s/DiskDescriptor.xml\", path);\n\n    if (virFileRemove(desc, 0, 0) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"refresh ploop failed:\"\n                         \" unable to delete DiskDescriptor.xml\"));\n        return -1;\n    }\n\n    refresh_tool = virFindFileInPath(\"ploop\");\n    if (!refresh_tool) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"unable to find ploop, please install ploop tools\"));\n        return -1;\n    }\n\n    cmd = virCommandNewArgList(refresh_tool, \"restore-descriptor\",\n                               path, NULL);\n    virCommandAddArgFormat(cmd, \"%s/root.hds\", path);\n    return virCommandRun(cmd, NULL);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 2306
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAddArgFormat",
          "args": [
            "cmd",
            "\"%s/root.hds\"",
            "path"
          ],
          "line": 2305
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddArgFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1569-1590",
          "snippet": "void\nvirCommandAddArgFormat(virCommandPtr cmd, const char *format, ...)\n{\n    char *arg;\n    va_list list;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, format);\n    arg = g_strdup_vprintf(format, list);\n    va_end(list);\n\n    /* Arg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, 1 + 1) < 0) {\n        VIR_FREE(arg);\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    cmd->args[cmd->nargs++] = arg;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddArgFormat(virCommandPtr cmd, const char *format, ...)\n{\n    char *arg;\n    va_list list;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, format);\n    arg = g_strdup_vprintf(format, list);\n    va_end(list);\n\n    /* Arg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, 1 + 1) < 0) {\n        VIR_FREE(arg);\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    cmd->args[cmd->nargs++] = arg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNewArgList",
          "args": [
            "refresh_tool",
            "\"restore-descriptor\"",
            "path",
            "NULL"
          ],
          "line": 2303
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"unable to find ploop, please install ploop tools\")"
          ],
          "line": 2298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unable to find ploop, please install ploop tools\""
          ],
          "line": 2299
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFindFileInPath",
          "args": [
            "\"ploop\""
          ],
          "line": 2296
        },
        "resolved": true,
        "details": {
          "function_name": "virFindFileInPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1657-1709",
          "snippet": "char *\nvirFindFileInPath(const char *file)\n{\n    const char *origpath = NULL;\n    VIR_AUTOSTRINGLIST paths = NULL;\n    char **pathiter;\n\n    if (file == NULL)\n        return NULL;\n\n    /* if we are passed an absolute path (starting with /), return a\n     * copy of that path, after validating that it is executable\n     */\n    if (g_path_is_absolute(file)) {\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        return g_strdup(file);\n    }\n\n    /* If we are passed an anchored path (containing a /), then there\n     * is no path search - it must exist in the current directory\n     */\n    if (strchr(file, '/')) {\n        char *abspath = NULL;\n\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        ignore_value(virFileAbsPath(file, &abspath));\n        return abspath;\n    }\n\n    /* copy PATH env so we can tweak it */\n    origpath = getenv(\"PATH\");\n    if (!origpath)\n        origpath = \"/bin:/usr/bin\";\n\n    /* for each path segment, append the file to search for and test for\n     * it. return it if found.\n     */\n\n    if (!(paths = virStringSplit(origpath, \":\", 0)))\n        return NULL;\n\n    for (pathiter = paths; *pathiter; pathiter++) {\n        g_autofree char *fullpath = g_strdup_printf(\"%s/%s\", *pathiter, file);\n        if (virFileIsExecutable(fullpath))\n            return g_steal_pointer(&fullpath);\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFindFileInPath(const char *file)\n{\n    const char *origpath = NULL;\n    VIR_AUTOSTRINGLIST paths = NULL;\n    char **pathiter;\n\n    if (file == NULL)\n        return NULL;\n\n    /* if we are passed an absolute path (starting with /), return a\n     * copy of that path, after validating that it is executable\n     */\n    if (g_path_is_absolute(file)) {\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        return g_strdup(file);\n    }\n\n    /* If we are passed an anchored path (containing a /), then there\n     * is no path search - it must exist in the current directory\n     */\n    if (strchr(file, '/')) {\n        char *abspath = NULL;\n\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        ignore_value(virFileAbsPath(file, &abspath));\n        return abspath;\n    }\n\n    /* copy PATH env so we can tweak it */\n    origpath = getenv(\"PATH\");\n    if (!origpath)\n        origpath = \"/bin:/usr/bin\";\n\n    /* for each path segment, append the file to search for and test for\n     * it. return it if found.\n     */\n\n    if (!(paths = virStringSplit(origpath, \":\", 0)))\n        return NULL;\n\n    for (pathiter = paths; *pathiter; pathiter++) {\n        g_autofree char *fullpath = g_strdup_printf(\"%s/%s\", *pathiter, file);\n        if (virFileIsExecutable(fullpath))\n            return g_steal_pointer(&fullpath);\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"refresh ploop failed:\"\n                         \" unable to delete DiskDescriptor.xml\")"
          ],
          "line": 2290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileRemove",
          "args": [
            "desc",
            "0",
            "0"
          ],
          "line": 2289
        },
        "resolved": true,
        "details": {
          "function_name": "virFileRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2844-2856",
          "snippet": "int\nvirFileRemove(const char *path,\n              uid_t uid G_GNUC_UNUSED,\n              gid_t gid G_GNUC_UNUSED)\n{\n    if (unlink(path) < 0) {\n        virReportSystemError(errno, _(\"Unable to unlink path '%s'\"),\n                             path);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileRemove(const char *path,\n              uid_t uid G_GNUC_UNUSED,\n              gid_t gid G_GNUC_UNUSED)\n{\n    if (unlink(path) < 0) {\n        virReportSystemError(errno, _(\"Unable to unlink path '%s'\"),\n                             path);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirStorageBackendPloopRestoreDesc(char *path)\n{\n    g_autoptr(virCommand) cmd = NULL;\n    g_autofree char *refresh_tool = NULL;\n    g_autofree char *desc = NULL;\n\n    desc = g_strdup_printf(\"%s/DiskDescriptor.xml\", path);\n\n    if (virFileRemove(desc, 0, 0) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"refresh ploop failed:\"\n                         \" unable to delete DiskDescriptor.xml\"));\n        return -1;\n    }\n\n    refresh_tool = virFindFileInPath(\"ploop\");\n    if (!refresh_tool) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"unable to find ploop, please install ploop tools\"));\n        return -1;\n    }\n\n    cmd = virCommandNewArgList(refresh_tool, \"restore-descriptor\",\n                               path, NULL);\n    virCommandAddArgFormat(cmd, \"%s/root.hds\", path);\n    return virCommandRun(cmd, NULL);\n}"
  },
  {
    "function_name": "virStorageVolPoolRefreshDataFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2271-2278",
    "snippet": "static void\nvirStorageVolPoolRefreshDataFree(void *opaque)\n{\n    virStorageVolStreamInfoPtr cbdata = opaque;\n\n    VIR_FREE(cbdata->pool_name);\n    VIR_FREE(cbdata);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cbdata"
          ],
          "line": 2277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cbdata->pool_name"
          ],
          "line": 2276
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirStorageVolPoolRefreshDataFree(void *opaque)\n{\n    virStorageVolStreamInfoPtr cbdata = opaque;\n\n    VIR_FREE(cbdata->pool_name);\n    VIR_FREE(cbdata);\n}"
  },
  {
    "function_name": "storageVolDownload",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2215-2263",
    "snippet": "static int\nstorageVolDownload(virStorageVolPtr vol,\n                   virStreamPtr stream,\n                   unsigned long long offset,\n                   unsigned long long length,\n                   unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStorageVolDefPtr voldef = NULL;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_DOWNLOAD_SPARSE_STREAM, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolDownloadEnsureACL(vol->conn, virStoragePoolObjGetDef(obj),\n                                       voldef) < 0)\n        goto cleanup;\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->downloadVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool doesn't support volume download\"));\n        goto cleanup;\n    }\n\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->in_use++;\n    virObjectUnlock(obj);\n\n    ret = backend->downloadVol(obj, voldef, stream, offset, length, flags);\n\n    virObjectLock(obj);\n    voldef->in_use--;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 2260
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjDecrAsyncjobs",
          "args": [
            "obj"
          ],
          "line": 2257
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjDecrAsyncjobs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "363-367",
          "snippet": "void\nvirStoragePoolObjDecrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs--;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjDecrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 2255
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->downloadVol",
          "args": [
            "obj",
            "voldef",
            "stream",
            "offset",
            "length",
            "flags"
          ],
          "line": 2253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 2251
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIncrAsyncjobs",
          "args": [
            "obj"
          ],
          "line": 2249
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIncrAsyncjobs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "356-360",
          "snippet": "void\nvirStoragePoolObjIncrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs++;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjIncrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_SUPPORT",
            "\"%s\"",
            "_(\"storage pool doesn't support volume download\")"
          ],
          "line": 2244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"storage pool doesn't support volume download\""
          ],
          "line": 2245
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"volume '%s' is still being allocated.\")",
            "voldef->name"
          ],
          "line": 2237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolDownloadEnsureACL",
          "args": [
            "vol->conn",
            "virStoragePoolObjGetDef(obj)",
            "voldef"
          ],
          "line": 2232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 2232
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolDefFromVol",
          "args": [
            "vol",
            "&obj",
            "&backend"
          ],
          "line": 2229
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefFromVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1806-1843",
          "snippet": "static virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_STORAGE_VOL_DOWNLOAD_SPARSE_STREAM",
            "-1"
          ],
          "line": 2227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolDownload(virStorageVolPtr vol,\n                   virStreamPtr stream,\n                   unsigned long long offset,\n                   unsigned long long length,\n                   unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStorageVolDefPtr voldef = NULL;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_DOWNLOAD_SPARSE_STREAM, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolDownloadEnsureACL(vol->conn, virStoragePoolObjGetDef(obj),\n                                       voldef) < 0)\n        goto cleanup;\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->downloadVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool doesn't support volume download\"));\n        goto cleanup;\n    }\n\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->in_use++;\n    virObjectUnlock(obj);\n\n    ret = backend->downloadVol(obj, voldef, stream, offset, length, flags);\n\n    virObjectLock(obj);\n    voldef->in_use--;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}"
  },
  {
    "function_name": "storageVolCreateXMLFrom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "2020-2212",
    "snippet": "static virStorageVolPtr\nstorageVolCreateXMLFrom(virStoragePoolPtr pool,\n                        const char *xmldesc,\n                        virStorageVolPtr volsrc,\n                        unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolObjPtr objsrc = NULL;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldefsrc = NULL;\n    virStorageVolDefPtr shadowvol = NULL;\n    virStorageVolPtr newvol = NULL;\n    virStorageVolPtr vol = NULL;\n    int buildret;\n    g_autoptr(virStorageVolDef) voldef = NULL;\n\n    virCheckFlags(VIR_STORAGE_VOL_CREATE_PREALLOC_METADATA |\n                  VIR_STORAGE_VOL_CREATE_REFLINK,\n                  NULL);\n\n    obj = virStoragePoolObjFindByUUID(driver->pools, pool->uuid);\n    if (obj && STRNEQ(pool->name, volsrc->pool)) {\n        virObjectUnlock(obj);\n        objsrc = virStoragePoolObjFindByName(driver->pools, volsrc->pool);\n        virObjectLock(obj);\n    }\n    if (!obj) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(pool->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_STORAGE_POOL,\n                       _(\"no storage pool with matching uuid '%s' (%s)\"),\n                       uuidstr, pool->name);\n        goto cleanup;\n    }\n    def = virStoragePoolObjGetDef(obj);\n\n    if (STRNEQ(pool->name, volsrc->pool) && !objsrc) {\n        virReportError(VIR_ERR_NO_STORAGE_POOL,\n                       _(\"no storage pool with matching name '%s'\"),\n                       volsrc->pool);\n        goto cleanup;\n    }\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    if (objsrc && !virStoragePoolObjIsActive(objsrc)) {\n        virStoragePoolDefPtr objsrcdef = virStoragePoolObjGetDef(objsrc);\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       objsrcdef->name);\n        goto cleanup;\n    }\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    voldefsrc = virStorageVolDefFindByName(objsrc ?\n                                           objsrc : obj, volsrc->name);\n    if (!voldefsrc) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       volsrc->name);\n        goto cleanup;\n    }\n\n    voldef = virStorageVolDefParseString(def, xmldesc,\n                                         VIR_VOL_XML_PARSE_NO_CAPACITY);\n    if (voldef == NULL)\n        goto cleanup;\n\n    if (virStorageVolCreateXMLFromEnsureACL(pool->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (virStorageVolDefFindByName(obj, voldef->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"storage volume name '%s' already in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    /* Use the original volume's capacity in case the new capacity\n     * is less than that, or it was omitted */\n    if (voldef->target.capacity < voldefsrc->target.capacity)\n        voldef->target.capacity = voldefsrc->target.capacity;\n\n    /* If the allocation was not provided in the XML, then use capacity\n     * as it's specifically documented \"If omitted when creating a volume,\n     * the  volume will be fully allocated at time of creation.\". This\n     * is especially important for logical volume creation. */\n    if (!voldef->target.has_allocation)\n        voldef->target.allocation = voldef->target.capacity;\n\n    if (!backend->buildVolFrom) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"storage pool does not support\"\n                               \" volume creation from an existing volume\"));\n        goto cleanup;\n    }\n\n    if (voldefsrc->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldefsrc->name);\n        goto cleanup;\n    }\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldefsrc) < 0)\n        goto cleanup;\n\n    /* 'Define' the new volume so we get async progress reporting.\n     * Wipe any key the user may have suggested, as volume creation\n     * will generate the canonical key.  */\n    VIR_FREE(voldef->key);\n    if (backend->createVol(obj, voldef) < 0)\n        goto cleanup;\n\n    /* Make a shallow copy of the 'defined' volume definition, since the\n     * original allocation value will change as the user polls 'info',\n     * but we only need the initial requested values\n     */\n    if (VIR_ALLOC(shadowvol) < 0)\n        goto cleanup;\n\n    memcpy(shadowvol, voldef, sizeof(*voldef));\n\n    if (!(newvol = virGetStorageVol(pool->conn, def->name, voldef->name,\n                                    voldef->key, NULL, NULL)))\n        goto cleanup;\n\n    /* NB: Upon success voldef \"owned\" by storage pool for deletion purposes */\n    if (virStoragePoolObjAddVol(obj, voldef) < 0)\n        goto cleanup;\n\n    /* Drop the pool lock during volume allocation */\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->building = true;\n    voldefsrc->in_use++;\n    virObjectUnlock(obj);\n\n    if (objsrc) {\n        virStoragePoolObjIncrAsyncjobs(objsrc);\n        virObjectUnlock(objsrc);\n    }\n\n    buildret = backend->buildVolFrom(obj, shadowvol, voldefsrc, flags);\n\n    virObjectLock(obj);\n    if (objsrc)\n        virObjectLock(objsrc);\n\n    voldefsrc->in_use--;\n    voldef->building = false;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n    if (objsrc) {\n        virStoragePoolObjDecrAsyncjobs(objsrc);\n        virStoragePoolObjEndAPI(&objsrc);\n    }\n\n    if (buildret < 0 ||\n        (backend->refreshVol &&\n         backend->refreshVol(obj, voldef) < 0)) {\n        storageVolDeleteInternal(backend, obj, voldef, 0, false);\n        voldef = NULL;\n        goto cleanup;\n    }\n\n    /* Updating pool metadata ignoring the disk backend since\n     * it updates the pool values\n     */\n    if (def->type != VIR_STORAGE_POOL_DISK) {\n        def->allocation += voldef->target.allocation;\n        def->available -= voldef->target.allocation;\n    }\n\n    VIR_INFO(\"Creating volume '%s' in storage pool '%s'\",\n             newvol->name, def->name);\n    vol = g_steal_pointer(&newvol);\n    voldef = NULL;\n\n cleanup:\n    virObjectUnref(newvol);\n    VIR_FREE(shadowvol);\n    virStoragePoolObjEndAPI(&obj);\n    virStoragePoolObjEndAPI(&objsrc);\n    return vol;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&objsrc"
          ],
          "line": 2210
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "shadowvol"
          ],
          "line": 2208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "newvol"
          ],
          "line": 2207
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&newvol"
          ],
          "line": 2203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Creating volume '%s' in storage pool '%s'\"",
            "newvol->name",
            "def->name"
          ],
          "line": 2201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "storageVolDeleteInternal",
          "args": [
            "backend",
            "obj",
            "voldef",
            "0",
            "false"
          ],
          "line": 2188
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolDeleteInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1766-1803",
          "snippet": "static int\nstorageVolDeleteInternal(virStorageBackendPtr backend,\n                         virStoragePoolObjPtr obj,\n                         virStorageVolDefPtr voldef,\n                         unsigned int flags,\n                         bool updateMeta)\n{\n    virStoragePoolDefPtr def = virStoragePoolObjGetDef(obj);\n\n    if (!backend->deleteVol) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"storage pool does not support vol deletion\"));\n\n        return -1;\n    }\n\n    if (backend->deleteVol(obj, voldef, flags) < 0)\n        return -1;\n\n    /* The disk backend updated the pool data including removing the\n     * voldef from the pool (for both the deleteVol and the createVol\n     * failure path. */\n    if (def->type == VIR_STORAGE_POOL_DISK)\n        return 0;\n\n    /* Update pool metadata - don't update meta data from error paths\n     * in this module since the allocation/available weren't adjusted yet.\n     * Ignore the disk backend since it updates the pool values.\n     */\n    if (updateMeta) {\n        def->allocation -= voldef->target.allocation;\n        def->available += voldef->target.allocation;\n    }\n\n    virStoragePoolObjRemoveVol(obj, voldef);\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolDeleteInternal(virStorageBackendPtr backend,\n                         virStoragePoolObjPtr obj,\n                         virStorageVolDefPtr voldef,\n                         unsigned int flags,\n                         bool updateMeta)\n{\n    virStoragePoolDefPtr def = virStoragePoolObjGetDef(obj);\n\n    if (!backend->deleteVol) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"storage pool does not support vol deletion\"));\n\n        return -1;\n    }\n\n    if (backend->deleteVol(obj, voldef, flags) < 0)\n        return -1;\n\n    /* The disk backend updated the pool data including removing the\n     * voldef from the pool (for both the deleteVol and the createVol\n     * failure path. */\n    if (def->type == VIR_STORAGE_POOL_DISK)\n        return 0;\n\n    /* Update pool metadata - don't update meta data from error paths\n     * in this module since the allocation/available weren't adjusted yet.\n     * Ignore the disk backend since it updates the pool values.\n     */\n    if (updateMeta) {\n        def->allocation -= voldef->target.allocation;\n        def->available += voldef->target.allocation;\n    }\n\n    virStoragePoolObjRemoveVol(obj, voldef);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->refreshVol",
          "args": [
            "obj",
            "voldef"
          ],
          "line": 2187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjDecrAsyncjobs",
          "args": [
            "objsrc"
          ],
          "line": 2181
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjDecrAsyncjobs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "363-367",
          "snippet": "void\nvirStoragePoolObjDecrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs--;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjDecrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "objsrc"
          ],
          "line": 2174
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->buildVolFrom",
          "args": [
            "obj",
            "shadowvol",
            "voldefsrc",
            "flags"
          ],
          "line": 2170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "objsrc"
          ],
          "line": 2167
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIncrAsyncjobs",
          "args": [
            "objsrc"
          ],
          "line": 2166
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIncrAsyncjobs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "356-360",
          "snippet": "void\nvirStoragePoolObjIncrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs++;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjIncrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjAddVol",
          "args": [
            "obj",
            "voldef"
          ],
          "line": 2156
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjAddVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "641-679",
          "snippet": "int\nvirStoragePoolObjAddVol(virStoragePoolObjPtr obj,\n                        virStorageVolDefPtr voldef)\n{\n    virStorageVolObjPtr volobj = NULL;\n    virStorageVolObjListPtr volumes = obj->volumes;\n\n    virObjectRWLockWrite(volumes);\n\n    if (!(volobj = virStorageVolObjNew()))\n        goto error;\n\n    if (virHashAddEntry(volumes->objsKey, voldef->key, volobj) < 0)\n        goto error;\n    virObjectRef(volobj);\n\n    if (virHashAddEntry(volumes->objsName, voldef->name, volobj) < 0) {\n        virHashRemoveEntry(volumes->objsKey, voldef->key);\n        goto error;\n    }\n    virObjectRef(volobj);\n\n    if (virHashAddEntry(volumes->objsPath, voldef->target.path, volobj) < 0) {\n        virHashRemoveEntry(volumes->objsKey, voldef->key);\n        virHashRemoveEntry(volumes->objsName, voldef->name);\n        goto error;\n    }\n    virObjectRef(volobj);\n\n    volobj->voldef = voldef;\n    virObjectRWUnlock(volumes);\n    virStorageVolObjEndAPI(&volobj);\n    return 0;\n\n error:\n    virStorageVolObjEndAPI(&volobj);\n    virObjectRWUnlock(volumes);\n    return -1;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjAddVol(virStoragePoolObjPtr obj,\n                        virStorageVolDefPtr voldef)\n{\n    virStorageVolObjPtr volobj = NULL;\n    virStorageVolObjListPtr volumes = obj->volumes;\n\n    virObjectRWLockWrite(volumes);\n\n    if (!(volobj = virStorageVolObjNew()))\n        goto error;\n\n    if (virHashAddEntry(volumes->objsKey, voldef->key, volobj) < 0)\n        goto error;\n    virObjectRef(volobj);\n\n    if (virHashAddEntry(volumes->objsName, voldef->name, volobj) < 0) {\n        virHashRemoveEntry(volumes->objsKey, voldef->key);\n        goto error;\n    }\n    virObjectRef(volobj);\n\n    if (virHashAddEntry(volumes->objsPath, voldef->target.path, volobj) < 0) {\n        virHashRemoveEntry(volumes->objsKey, voldef->key);\n        virHashRemoveEntry(volumes->objsName, voldef->name);\n        goto error;\n    }\n    virObjectRef(volobj);\n\n    volobj->voldef = voldef;\n    virObjectRWUnlock(volumes);\n    virStorageVolObjEndAPI(&volobj);\n    return 0;\n\n error:\n    virStorageVolObjEndAPI(&volobj);\n    virObjectRWUnlock(volumes);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetStorageVol",
          "args": [
            "pool->conn",
            "def->name",
            "voldef->name",
            "voldef->key",
            "NULL",
            "NULL"
          ],
          "line": 2151
        },
        "resolved": true,
        "details": {
          "function_name": "virGetStorageVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "600-632",
          "snippet": "virStorageVolPtr\nvirGetStorageVol(virConnectPtr conn, const char *pool, const char *name,\n                 const char *key, void *privateData, virFreeCallback freeFunc)\n{\n    virStorageVolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(pool, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(key, error);\n\n    if (!(ret = virObjectNew(virStorageVolClass)))\n        goto error;\n\n    ret->pool = g_strdup(pool);\n    ret->name = g_strdup(name);\n    ret->key = g_strdup(key);\n\n    ret->conn = virObjectRef(conn);\n\n    /* set driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virStorageVolClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virStorageVolClass;\n\nvirStorageVolPtr\nvirGetStorageVol(virConnectPtr conn, const char *pool, const char *name,\n                 const char *key, void *privateData, virFreeCallback freeFunc)\n{\n    virStorageVolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(pool, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(key, error);\n\n    if (!(ret = virObjectNew(virStorageVolClass)))\n        goto error;\n\n    ret->pool = g_strdup(pool);\n    ret->name = g_strdup(name);\n    ret->key = g_strdup(key);\n\n    ret->conn = virObjectRef(conn);\n\n    /* set driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "shadowvol",
            "voldef",
            "sizeof(*voldef)"
          ],
          "line": 2149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "shadowvol"
          ],
          "line": 2146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "backend->createVol",
          "args": [
            "obj",
            "voldef"
          ],
          "line": 2139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "voldef->key"
          ],
          "line": 2138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "backend->refreshVol",
          "args": [
            "obj",
            "voldefsrc"
          ],
          "line": 2132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"volume '%s' is still being allocated.\")",
            "voldefsrc->name"
          ],
          "line": 2125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"volume '%s' is still being allocated.\""
          ],
          "line": 2126
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_SUPPORT",
            "\"%s\"",
            "_(\"storage pool does not support\"\n                               \" volume creation from an existing volume\")"
          ],
          "line": 2118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"storage volume name '%s' already in use.\")",
            "voldef->name"
          ],
          "line": 2099
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolDefFindByName",
          "args": [
            "obj",
            "voldef->name"
          ],
          "line": 2098
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "841-854",
          "snippet": "virStorageVolDefPtr\nvirStorageVolDefFindByName(virStoragePoolObjPtr obj,\n                           const char *name)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsName, name);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStorageVolDefPtr\nvirStorageVolDefFindByName(virStoragePoolObjPtr obj,\n                           const char *name)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsName, name);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolCreateXMLFromEnsureACL",
          "args": [
            "pool->conn",
            "def",
            "voldef"
          ],
          "line": 2095
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolDefParseString",
          "args": [
            "def",
            "xmldesc",
            "VIR_VOL_XML_PARSE_NO_CAPACITY"
          ],
          "line": 2090
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1470-1476",
          "snippet": "virStorageVolDefPtr\nvirStorageVolDefParseString(virStoragePoolDefPtr pool,\n                            const char *xmlStr,\n                            unsigned int flags)\n{\n    return virStorageVolDefParse(pool, xmlStr, NULL, flags);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStorageVolDefPtr\nvirStorageVolDefParseString(virStoragePoolDefPtr pool,\n                            const char *xmlStr,\n                            unsigned int flags)\n{\n    return virStorageVolDefParse(pool, xmlStr, NULL, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_STORAGE_VOL",
            "_(\"no storage vol with matching name '%s'\")",
            "volsrc->name"
          ],
          "line": 2084
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageBackendForType",
          "args": [
            "def->type"
          ],
          "line": 2078
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendForType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
          "lines": "172-184",
          "snippet": "virStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}",
          "includes": [
            "# include \"storage_backend_vstorage.h\"",
            "# include \"storage_backend_zfs.h\"",
            "# include \"storage_backend_gluster.h\"",
            "# include \"storage_backend_sheepdog.h\"",
            "# include \"storage_backend_rbd.h\"",
            "# include \"storage_backend_fs.h\"",
            "# include \"storage_backend_disk.h\"",
            "# include \"storage_backend_mpath.h\"",
            "# include \"storage_backend_scsi.h\"",
            "# include \"storage_backend_iscsi_direct.h\"",
            "# include \"storage_backend_iscsi.h\"",
            "# include \"storage_backend_logical.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
            "static size_t virStorageBackendsCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is not active\")",
            "objsrcdef->name"
          ],
          "line": 2072
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "objsrc"
          ],
          "line": 2071
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "objsrc"
          ],
          "line": 2070
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is not active\")",
            "def->name"
          ],
          "line": 2065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_STORAGE_POOL",
            "_(\"no storage pool with matching name '%s'\")",
            "volsrc->pool"
          ],
          "line": 2058
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "pool->name",
            "volsrc->pool"
          ],
          "line": 2057
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_STORAGE_POOL",
            "_(\"no storage pool with matching uuid '%s' (%s)\")",
            "uuidstr",
            "pool->name"
          ],
          "line": 2050
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "pool->uuid",
            "uuidstr"
          ],
          "line": 2049
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFindByName",
          "args": [
            "driver->pools",
            "volsrc->pool"
          ],
          "line": 2044
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "596-609",
          "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjFindByName(virStoragePoolObjListPtr pools,\n                            const char *name)\n{\n    virStoragePoolObjPtr obj;\n\n    virObjectRWLockRead(pools);\n    obj = virStoragePoolObjFindByNameLocked(pools, name);\n    virObjectRWUnlock(pools);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolObjPtr\nvirStoragePoolObjFindByName(virStoragePoolObjListPtr pools,\n                            const char *name)\n{\n    virStoragePoolObjPtr obj;\n\n    virObjectRWLockRead(pools);\n    obj = virStoragePoolObjFindByNameLocked(pools, name);\n    virObjectRWUnlock(pools);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "pool->name",
            "volsrc->pool"
          ],
          "line": 2042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFindByUUID",
          "args": [
            "driver->pools",
            "pool->uuid"
          ],
          "line": 2041
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "563-576",
          "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjFindByUUID(virStoragePoolObjListPtr pools,\n                            const unsigned char *uuid)\n{\n    virStoragePoolObjPtr obj;\n\n    virObjectRWLockRead(pools);\n    obj = virStoragePoolObjFindByUUIDLocked(pools, uuid);\n    virObjectRWUnlock(pools);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolObjPtr\nvirStoragePoolObjFindByUUID(virStoragePoolObjListPtr pools,\n                            const unsigned char *uuid)\n{\n    virStoragePoolObjPtr obj;\n\n    virObjectRWLockRead(pools);\n    obj = virStoragePoolObjFindByUUIDLocked(pools, uuid);\n    virObjectRWUnlock(pools);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_STORAGE_VOL_CREATE_PREALLOC_METADATA |\n                  VIR_STORAGE_VOL_CREATE_REFLINK",
            "NULL"
          ],
          "line": 2037
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStorageVolPtr\nstorageVolCreateXMLFrom(virStoragePoolPtr pool,\n                        const char *xmldesc,\n                        virStorageVolPtr volsrc,\n                        unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolObjPtr objsrc = NULL;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldefsrc = NULL;\n    virStorageVolDefPtr shadowvol = NULL;\n    virStorageVolPtr newvol = NULL;\n    virStorageVolPtr vol = NULL;\n    int buildret;\n    g_autoptr(virStorageVolDef) voldef = NULL;\n\n    virCheckFlags(VIR_STORAGE_VOL_CREATE_PREALLOC_METADATA |\n                  VIR_STORAGE_VOL_CREATE_REFLINK,\n                  NULL);\n\n    obj = virStoragePoolObjFindByUUID(driver->pools, pool->uuid);\n    if (obj && STRNEQ(pool->name, volsrc->pool)) {\n        virObjectUnlock(obj);\n        objsrc = virStoragePoolObjFindByName(driver->pools, volsrc->pool);\n        virObjectLock(obj);\n    }\n    if (!obj) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(pool->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_STORAGE_POOL,\n                       _(\"no storage pool with matching uuid '%s' (%s)\"),\n                       uuidstr, pool->name);\n        goto cleanup;\n    }\n    def = virStoragePoolObjGetDef(obj);\n\n    if (STRNEQ(pool->name, volsrc->pool) && !objsrc) {\n        virReportError(VIR_ERR_NO_STORAGE_POOL,\n                       _(\"no storage pool with matching name '%s'\"),\n                       volsrc->pool);\n        goto cleanup;\n    }\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    if (objsrc && !virStoragePoolObjIsActive(objsrc)) {\n        virStoragePoolDefPtr objsrcdef = virStoragePoolObjGetDef(objsrc);\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       objsrcdef->name);\n        goto cleanup;\n    }\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    voldefsrc = virStorageVolDefFindByName(objsrc ?\n                                           objsrc : obj, volsrc->name);\n    if (!voldefsrc) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       volsrc->name);\n        goto cleanup;\n    }\n\n    voldef = virStorageVolDefParseString(def, xmldesc,\n                                         VIR_VOL_XML_PARSE_NO_CAPACITY);\n    if (voldef == NULL)\n        goto cleanup;\n\n    if (virStorageVolCreateXMLFromEnsureACL(pool->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (virStorageVolDefFindByName(obj, voldef->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"storage volume name '%s' already in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    /* Use the original volume's capacity in case the new capacity\n     * is less than that, or it was omitted */\n    if (voldef->target.capacity < voldefsrc->target.capacity)\n        voldef->target.capacity = voldefsrc->target.capacity;\n\n    /* If the allocation was not provided in the XML, then use capacity\n     * as it's specifically documented \"If omitted when creating a volume,\n     * the  volume will be fully allocated at time of creation.\". This\n     * is especially important for logical volume creation. */\n    if (!voldef->target.has_allocation)\n        voldef->target.allocation = voldef->target.capacity;\n\n    if (!backend->buildVolFrom) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"storage pool does not support\"\n                               \" volume creation from an existing volume\"));\n        goto cleanup;\n    }\n\n    if (voldefsrc->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldefsrc->name);\n        goto cleanup;\n    }\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldefsrc) < 0)\n        goto cleanup;\n\n    /* 'Define' the new volume so we get async progress reporting.\n     * Wipe any key the user may have suggested, as volume creation\n     * will generate the canonical key.  */\n    VIR_FREE(voldef->key);\n    if (backend->createVol(obj, voldef) < 0)\n        goto cleanup;\n\n    /* Make a shallow copy of the 'defined' volume definition, since the\n     * original allocation value will change as the user polls 'info',\n     * but we only need the initial requested values\n     */\n    if (VIR_ALLOC(shadowvol) < 0)\n        goto cleanup;\n\n    memcpy(shadowvol, voldef, sizeof(*voldef));\n\n    if (!(newvol = virGetStorageVol(pool->conn, def->name, voldef->name,\n                                    voldef->key, NULL, NULL)))\n        goto cleanup;\n\n    /* NB: Upon success voldef \"owned\" by storage pool for deletion purposes */\n    if (virStoragePoolObjAddVol(obj, voldef) < 0)\n        goto cleanup;\n\n    /* Drop the pool lock during volume allocation */\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->building = true;\n    voldefsrc->in_use++;\n    virObjectUnlock(obj);\n\n    if (objsrc) {\n        virStoragePoolObjIncrAsyncjobs(objsrc);\n        virObjectUnlock(objsrc);\n    }\n\n    buildret = backend->buildVolFrom(obj, shadowvol, voldefsrc, flags);\n\n    virObjectLock(obj);\n    if (objsrc)\n        virObjectLock(objsrc);\n\n    voldefsrc->in_use--;\n    voldef->building = false;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n    if (objsrc) {\n        virStoragePoolObjDecrAsyncjobs(objsrc);\n        virStoragePoolObjEndAPI(&objsrc);\n    }\n\n    if (buildret < 0 ||\n        (backend->refreshVol &&\n         backend->refreshVol(obj, voldef) < 0)) {\n        storageVolDeleteInternal(backend, obj, voldef, 0, false);\n        voldef = NULL;\n        goto cleanup;\n    }\n\n    /* Updating pool metadata ignoring the disk backend since\n     * it updates the pool values\n     */\n    if (def->type != VIR_STORAGE_POOL_DISK) {\n        def->allocation += voldef->target.allocation;\n        def->available -= voldef->target.allocation;\n    }\n\n    VIR_INFO(\"Creating volume '%s' in storage pool '%s'\",\n             newvol->name, def->name);\n    vol = g_steal_pointer(&newvol);\n    voldef = NULL;\n\n cleanup:\n    virObjectUnref(newvol);\n    VIR_FREE(shadowvol);\n    virStoragePoolObjEndAPI(&obj);\n    virStoragePoolObjEndAPI(&objsrc);\n    return vol;\n}"
  },
  {
    "function_name": "storageVolCreateXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1887-2018",
    "snippet": "static virStorageVolPtr\nstorageVolCreateXML(virStoragePoolPtr pool,\n                    const char *xmldesc,\n                    unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virStorageVolPtr vol = NULL, newvol = NULL;\n    g_autoptr(virStorageVolDef) voldef = NULL;\n\n    virCheckFlags(VIR_STORAGE_VOL_CREATE_PREALLOC_METADATA, NULL);\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    voldef = virStorageVolDefParseString(def, xmldesc,\n                                         VIR_VOL_XML_PARSE_OPT_CAPACITY);\n    if (voldef == NULL)\n        goto cleanup;\n\n    if (!voldef->target.capacity && !backend->buildVol) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"volume capacity required for this \"\n                               \"storage pool\"));\n        goto cleanup;\n    }\n\n    if (virStorageVolCreateXMLEnsureACL(pool->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (virStorageVolDefFindByName(obj, voldef->name)) {\n        virReportError(VIR_ERR_STORAGE_VOL_EXIST,\n                       _(\"'%s'\"), voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->createVol) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"storage pool does not support volume \"\n                               \"creation\"));\n        goto cleanup;\n    }\n\n    /* Wipe any key the user may have suggested, as volume creation\n     * will generate the canonical key.  */\n    VIR_FREE(voldef->key);\n    if (backend->createVol(obj, voldef) < 0)\n        goto cleanup;\n\n    if (!(newvol = virGetStorageVol(pool->conn, def->name, voldef->name,\n                                    voldef->key, NULL, NULL)))\n        goto cleanup;\n\n    /* NB: Upon success voldef \"owned\" by storage pool for deletion purposes */\n    if (virStoragePoolObjAddVol(obj, voldef) < 0)\n        goto cleanup;\n\n    if (backend->buildVol) {\n        int buildret;\n        virStorageVolDefPtr buildvoldef = NULL;\n\n        if (VIR_ALLOC(buildvoldef) < 0) {\n            voldef = NULL;\n            goto cleanup;\n        }\n\n        /* Make a shallow copy of the 'defined' volume definition, since the\n         * original allocation value will change as the user polls 'info',\n         * but we only need the initial requested values\n         */\n        memcpy(buildvoldef, voldef, sizeof(*voldef));\n\n        /* Drop the pool lock during volume allocation */\n        virStoragePoolObjIncrAsyncjobs(obj);\n        voldef->building = true;\n        virObjectUnlock(obj);\n\n        buildret = backend->buildVol(obj, buildvoldef, flags);\n\n        VIR_FREE(buildvoldef);\n\n        virObjectLock(obj);\n\n        voldef->building = false;\n        virStoragePoolObjDecrAsyncjobs(obj);\n\n        if (buildret < 0) {\n            /* buildVol handles deleting volume on failure */\n            virStoragePoolObjRemoveVol(obj, voldef);\n            voldef = NULL;\n            goto cleanup;\n        }\n\n    }\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldef) < 0) {\n        storageVolDeleteInternal(backend, obj, voldef,\n                                 0, false);\n        voldef = NULL;\n        goto cleanup;\n    }\n\n    /* Update pool metadata ignoring the disk backend since\n     * it updates the pool values.\n     */\n    if (def->type != VIR_STORAGE_POOL_DISK) {\n        def->allocation += voldef->target.allocation;\n        def->available -= voldef->target.allocation;\n    }\n\n    VIR_INFO(\"Creating volume '%s' in storage pool '%s'\",\n             newvol->name, def->name);\n    vol = g_steal_pointer(&newvol);\n    voldef = NULL;\n\n cleanup:\n    virObjectUnref(newvol);\n    virStoragePoolObjEndAPI(&obj);\n    return vol;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 2016
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "newvol"
          ],
          "line": 2015
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&newvol"
          ],
          "line": 2011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Creating volume '%s' in storage pool '%s'\"",
            "newvol->name",
            "def->name"
          ],
          "line": 2009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "storageVolDeleteInternal",
          "args": [
            "backend",
            "obj",
            "voldef",
            "0",
            "false"
          ],
          "line": 1995
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolDeleteInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1766-1803",
          "snippet": "static int\nstorageVolDeleteInternal(virStorageBackendPtr backend,\n                         virStoragePoolObjPtr obj,\n                         virStorageVolDefPtr voldef,\n                         unsigned int flags,\n                         bool updateMeta)\n{\n    virStoragePoolDefPtr def = virStoragePoolObjGetDef(obj);\n\n    if (!backend->deleteVol) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"storage pool does not support vol deletion\"));\n\n        return -1;\n    }\n\n    if (backend->deleteVol(obj, voldef, flags) < 0)\n        return -1;\n\n    /* The disk backend updated the pool data including removing the\n     * voldef from the pool (for both the deleteVol and the createVol\n     * failure path. */\n    if (def->type == VIR_STORAGE_POOL_DISK)\n        return 0;\n\n    /* Update pool metadata - don't update meta data from error paths\n     * in this module since the allocation/available weren't adjusted yet.\n     * Ignore the disk backend since it updates the pool values.\n     */\n    if (updateMeta) {\n        def->allocation -= voldef->target.allocation;\n        def->available += voldef->target.allocation;\n    }\n\n    virStoragePoolObjRemoveVol(obj, voldef);\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolDeleteInternal(virStorageBackendPtr backend,\n                         virStoragePoolObjPtr obj,\n                         virStorageVolDefPtr voldef,\n                         unsigned int flags,\n                         bool updateMeta)\n{\n    virStoragePoolDefPtr def = virStoragePoolObjGetDef(obj);\n\n    if (!backend->deleteVol) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"storage pool does not support vol deletion\"));\n\n        return -1;\n    }\n\n    if (backend->deleteVol(obj, voldef, flags) < 0)\n        return -1;\n\n    /* The disk backend updated the pool data including removing the\n     * voldef from the pool (for both the deleteVol and the createVol\n     * failure path. */\n    if (def->type == VIR_STORAGE_POOL_DISK)\n        return 0;\n\n    /* Update pool metadata - don't update meta data from error paths\n     * in this module since the allocation/available weren't adjusted yet.\n     * Ignore the disk backend since it updates the pool values.\n     */\n    if (updateMeta) {\n        def->allocation -= voldef->target.allocation;\n        def->available += voldef->target.allocation;\n    }\n\n    virStoragePoolObjRemoveVol(obj, voldef);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->refreshVol",
          "args": [
            "obj",
            "voldef"
          ],
          "line": 1994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjRemoveVol",
          "args": [
            "obj",
            "voldef"
          ],
          "line": 1986
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjRemoveVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "682-708",
          "snippet": "void\nvirStoragePoolObjRemoveVol(virStoragePoolObjPtr obj,\n                           virStorageVolDefPtr voldef)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockWrite(volumes);\n    volobj = virHashLookup(volumes->objsName, voldef->name);\n    if (!volobj) {\n        VIR_INFO(\"Cannot find volume '%s' from storage pool '%s'\",\n                 voldef->name, obj->def->name);\n        virObjectRWUnlock(volumes);\n        return;\n    }\n    VIR_INFO(\"Deleting volume '%s' from storage pool '%s'\",\n             voldef->name, obj->def->name);\n\n    virObjectRef(volobj);\n    virObjectLock(volobj);\n    virHashRemoveEntry(volumes->objsKey, voldef->key);\n    virHashRemoveEntry(volumes->objsName, voldef->name);\n    virHashRemoveEntry(volumes->objsPath, voldef->target.path);\n    virStorageVolObjEndAPI(&volobj);\n\n    virObjectRWUnlock(volumes);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjRemoveVol(virStoragePoolObjPtr obj,\n                           virStorageVolDefPtr voldef)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockWrite(volumes);\n    volobj = virHashLookup(volumes->objsName, voldef->name);\n    if (!volobj) {\n        VIR_INFO(\"Cannot find volume '%s' from storage pool '%s'\",\n                 voldef->name, obj->def->name);\n        virObjectRWUnlock(volumes);\n        return;\n    }\n    VIR_INFO(\"Deleting volume '%s' from storage pool '%s'\",\n             voldef->name, obj->def->name);\n\n    virObjectRef(volobj);\n    virObjectLock(volobj);\n    virHashRemoveEntry(volumes->objsKey, voldef->key);\n    virHashRemoveEntry(volumes->objsName, voldef->name);\n    virHashRemoveEntry(volumes->objsPath, voldef->target.path);\n    virStorageVolObjEndAPI(&volobj);\n\n    virObjectRWUnlock(volumes);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjDecrAsyncjobs",
          "args": [
            "obj"
          ],
          "line": 1982
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjDecrAsyncjobs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "363-367",
          "snippet": "void\nvirStoragePoolObjDecrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs--;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjDecrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 1979
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "buildvoldef"
          ],
          "line": 1977
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "backend->buildVol",
          "args": [
            "obj",
            "buildvoldef",
            "flags"
          ],
          "line": 1975
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 1973
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIncrAsyncjobs",
          "args": [
            "obj"
          ],
          "line": 1971
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIncrAsyncjobs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "356-360",
          "snippet": "void\nvirStoragePoolObjIncrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs++;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjIncrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buildvoldef",
            "voldef",
            "sizeof(*voldef)"
          ],
          "line": 1968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "buildvoldef"
          ],
          "line": 1959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjAddVol",
          "args": [
            "obj",
            "voldef"
          ],
          "line": 1952
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjAddVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "641-679",
          "snippet": "int\nvirStoragePoolObjAddVol(virStoragePoolObjPtr obj,\n                        virStorageVolDefPtr voldef)\n{\n    virStorageVolObjPtr volobj = NULL;\n    virStorageVolObjListPtr volumes = obj->volumes;\n\n    virObjectRWLockWrite(volumes);\n\n    if (!(volobj = virStorageVolObjNew()))\n        goto error;\n\n    if (virHashAddEntry(volumes->objsKey, voldef->key, volobj) < 0)\n        goto error;\n    virObjectRef(volobj);\n\n    if (virHashAddEntry(volumes->objsName, voldef->name, volobj) < 0) {\n        virHashRemoveEntry(volumes->objsKey, voldef->key);\n        goto error;\n    }\n    virObjectRef(volobj);\n\n    if (virHashAddEntry(volumes->objsPath, voldef->target.path, volobj) < 0) {\n        virHashRemoveEntry(volumes->objsKey, voldef->key);\n        virHashRemoveEntry(volumes->objsName, voldef->name);\n        goto error;\n    }\n    virObjectRef(volobj);\n\n    volobj->voldef = voldef;\n    virObjectRWUnlock(volumes);\n    virStorageVolObjEndAPI(&volobj);\n    return 0;\n\n error:\n    virStorageVolObjEndAPI(&volobj);\n    virObjectRWUnlock(volumes);\n    return -1;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjAddVol(virStoragePoolObjPtr obj,\n                        virStorageVolDefPtr voldef)\n{\n    virStorageVolObjPtr volobj = NULL;\n    virStorageVolObjListPtr volumes = obj->volumes;\n\n    virObjectRWLockWrite(volumes);\n\n    if (!(volobj = virStorageVolObjNew()))\n        goto error;\n\n    if (virHashAddEntry(volumes->objsKey, voldef->key, volobj) < 0)\n        goto error;\n    virObjectRef(volobj);\n\n    if (virHashAddEntry(volumes->objsName, voldef->name, volobj) < 0) {\n        virHashRemoveEntry(volumes->objsKey, voldef->key);\n        goto error;\n    }\n    virObjectRef(volobj);\n\n    if (virHashAddEntry(volumes->objsPath, voldef->target.path, volobj) < 0) {\n        virHashRemoveEntry(volumes->objsKey, voldef->key);\n        virHashRemoveEntry(volumes->objsName, voldef->name);\n        goto error;\n    }\n    virObjectRef(volobj);\n\n    volobj->voldef = voldef;\n    virObjectRWUnlock(volumes);\n    virStorageVolObjEndAPI(&volobj);\n    return 0;\n\n error:\n    virStorageVolObjEndAPI(&volobj);\n    virObjectRWUnlock(volumes);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetStorageVol",
          "args": [
            "pool->conn",
            "def->name",
            "voldef->name",
            "voldef->key",
            "NULL",
            "NULL"
          ],
          "line": 1947
        },
        "resolved": true,
        "details": {
          "function_name": "virGetStorageVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "600-632",
          "snippet": "virStorageVolPtr\nvirGetStorageVol(virConnectPtr conn, const char *pool, const char *name,\n                 const char *key, void *privateData, virFreeCallback freeFunc)\n{\n    virStorageVolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(pool, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(key, error);\n\n    if (!(ret = virObjectNew(virStorageVolClass)))\n        goto error;\n\n    ret->pool = g_strdup(pool);\n    ret->name = g_strdup(name);\n    ret->key = g_strdup(key);\n\n    ret->conn = virObjectRef(conn);\n\n    /* set driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virStorageVolClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virStorageVolClass;\n\nvirStorageVolPtr\nvirGetStorageVol(virConnectPtr conn, const char *pool, const char *name,\n                 const char *key, void *privateData, virFreeCallback freeFunc)\n{\n    virStorageVolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(pool, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(key, error);\n\n    if (!(ret = virObjectNew(virStorageVolClass)))\n        goto error;\n\n    ret->pool = g_strdup(pool);\n    ret->name = g_strdup(name);\n    ret->key = g_strdup(key);\n\n    ret->conn = virObjectRef(conn);\n\n    /* set driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->createVol",
          "args": [
            "obj",
            "voldef"
          ],
          "line": 1944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "voldef->key"
          ],
          "line": 1943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_SUPPORT",
            "\"%s\"",
            "_(\"storage pool does not support volume \"\n                               \"creation\")"
          ],
          "line": 1935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"storage pool does not support volume \"\n                               \"creation\""
          ],
          "line": 1936
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_STORAGE_VOL_EXIST",
            "_(\"'%s'\")",
            "voldef->name"
          ],
          "line": 1929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolDefFindByName",
          "args": [
            "obj",
            "voldef->name"
          ],
          "line": 1928
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "841-854",
          "snippet": "virStorageVolDefPtr\nvirStorageVolDefFindByName(virStoragePoolObjPtr obj,\n                           const char *name)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsName, name);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStorageVolDefPtr\nvirStorageVolDefFindByName(virStoragePoolObjPtr obj,\n                           const char *name)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsName, name);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolCreateXMLEnsureACL",
          "args": [
            "pool->conn",
            "def",
            "voldef"
          ],
          "line": 1925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_SUPPORT",
            "\"%s\"",
            "_(\"volume capacity required for this \"\n                               \"storage pool\")"
          ],
          "line": 1919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolDefParseString",
          "args": [
            "def",
            "xmldesc",
            "VIR_VOL_XML_PARSE_OPT_CAPACITY"
          ],
          "line": 1913
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1470-1476",
          "snippet": "virStorageVolDefPtr\nvirStorageVolDefParseString(virStoragePoolDefPtr pool,\n                            const char *xmlStr,\n                            unsigned int flags)\n{\n    return virStorageVolDefParse(pool, xmlStr, NULL, flags);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStorageVolDefPtr\nvirStorageVolDefParseString(virStoragePoolDefPtr pool,\n                            const char *xmlStr,\n                            unsigned int flags)\n{\n    return virStorageVolDefParse(pool, xmlStr, NULL, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageBackendForType",
          "args": [
            "def->type"
          ],
          "line": 1910
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendForType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
          "lines": "172-184",
          "snippet": "virStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}",
          "includes": [
            "# include \"storage_backend_vstorage.h\"",
            "# include \"storage_backend_zfs.h\"",
            "# include \"storage_backend_gluster.h\"",
            "# include \"storage_backend_sheepdog.h\"",
            "# include \"storage_backend_rbd.h\"",
            "# include \"storage_backend_fs.h\"",
            "# include \"storage_backend_disk.h\"",
            "# include \"storage_backend_mpath.h\"",
            "# include \"storage_backend_scsi.h\"",
            "# include \"storage_backend_iscsi_direct.h\"",
            "# include \"storage_backend_iscsi.h\"",
            "# include \"storage_backend_logical.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
            "static size_t virStorageBackendsCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is not active\")",
            "def->name"
          ],
          "line": 1905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1904
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1902
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFromStoragePool",
          "args": [
            "pool"
          ],
          "line": 1900
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFromStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "474-478",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_STORAGE_VOL_CREATE_PREALLOC_METADATA",
            "NULL"
          ],
          "line": 1898
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageVolPtr\nstorageVolCreateXML(virStoragePoolPtr pool,\n                    const char *xmldesc,\n                    unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virStorageVolPtr vol = NULL, newvol = NULL;\n    g_autoptr(virStorageVolDef) voldef = NULL;\n\n    virCheckFlags(VIR_STORAGE_VOL_CREATE_PREALLOC_METADATA, NULL);\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    voldef = virStorageVolDefParseString(def, xmldesc,\n                                         VIR_VOL_XML_PARSE_OPT_CAPACITY);\n    if (voldef == NULL)\n        goto cleanup;\n\n    if (!voldef->target.capacity && !backend->buildVol) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"volume capacity required for this \"\n                               \"storage pool\"));\n        goto cleanup;\n    }\n\n    if (virStorageVolCreateXMLEnsureACL(pool->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (virStorageVolDefFindByName(obj, voldef->name)) {\n        virReportError(VIR_ERR_STORAGE_VOL_EXIST,\n                       _(\"'%s'\"), voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->createVol) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"storage pool does not support volume \"\n                               \"creation\"));\n        goto cleanup;\n    }\n\n    /* Wipe any key the user may have suggested, as volume creation\n     * will generate the canonical key.  */\n    VIR_FREE(voldef->key);\n    if (backend->createVol(obj, voldef) < 0)\n        goto cleanup;\n\n    if (!(newvol = virGetStorageVol(pool->conn, def->name, voldef->name,\n                                    voldef->key, NULL, NULL)))\n        goto cleanup;\n\n    /* NB: Upon success voldef \"owned\" by storage pool for deletion purposes */\n    if (virStoragePoolObjAddVol(obj, voldef) < 0)\n        goto cleanup;\n\n    if (backend->buildVol) {\n        int buildret;\n        virStorageVolDefPtr buildvoldef = NULL;\n\n        if (VIR_ALLOC(buildvoldef) < 0) {\n            voldef = NULL;\n            goto cleanup;\n        }\n\n        /* Make a shallow copy of the 'defined' volume definition, since the\n         * original allocation value will change as the user polls 'info',\n         * but we only need the initial requested values\n         */\n        memcpy(buildvoldef, voldef, sizeof(*voldef));\n\n        /* Drop the pool lock during volume allocation */\n        virStoragePoolObjIncrAsyncjobs(obj);\n        voldef->building = true;\n        virObjectUnlock(obj);\n\n        buildret = backend->buildVol(obj, buildvoldef, flags);\n\n        VIR_FREE(buildvoldef);\n\n        virObjectLock(obj);\n\n        voldef->building = false;\n        virStoragePoolObjDecrAsyncjobs(obj);\n\n        if (buildret < 0) {\n            /* buildVol handles deleting volume on failure */\n            virStoragePoolObjRemoveVol(obj, voldef);\n            voldef = NULL;\n            goto cleanup;\n        }\n\n    }\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldef) < 0) {\n        storageVolDeleteInternal(backend, obj, voldef,\n                                 0, false);\n        voldef = NULL;\n        goto cleanup;\n    }\n\n    /* Update pool metadata ignoring the disk backend since\n     * it updates the pool values.\n     */\n    if (def->type != VIR_STORAGE_POOL_DISK) {\n        def->allocation += voldef->target.allocation;\n        def->available -= voldef->target.allocation;\n    }\n\n    VIR_INFO(\"Creating volume '%s' in storage pool '%s'\",\n             newvol->name, def->name);\n    vol = g_steal_pointer(&newvol);\n    voldef = NULL;\n\n cleanup:\n    virObjectUnref(newvol);\n    virStoragePoolObjEndAPI(&obj);\n    return vol;\n}"
  },
  {
    "function_name": "storageVolDelete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1846-1884",
    "snippet": "static int\nstorageVolDelete(virStorageVolPtr vol,\n                 unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldef = NULL;\n    int ret = -1;\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolDeleteEnsureACL(vol->conn, virStoragePoolObjGetDef(obj),\n                                     voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (storageVolDeleteInternal(backend, obj, voldef, flags, true) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1882
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storageVolDeleteInternal",
          "args": [
            "backend",
            "obj",
            "voldef",
            "flags",
            "true"
          ],
          "line": 1876
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolDeleteInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1766-1803",
          "snippet": "static int\nstorageVolDeleteInternal(virStorageBackendPtr backend,\n                         virStoragePoolObjPtr obj,\n                         virStorageVolDefPtr voldef,\n                         unsigned int flags,\n                         bool updateMeta)\n{\n    virStoragePoolDefPtr def = virStoragePoolObjGetDef(obj);\n\n    if (!backend->deleteVol) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"storage pool does not support vol deletion\"));\n\n        return -1;\n    }\n\n    if (backend->deleteVol(obj, voldef, flags) < 0)\n        return -1;\n\n    /* The disk backend updated the pool data including removing the\n     * voldef from the pool (for both the deleteVol and the createVol\n     * failure path. */\n    if (def->type == VIR_STORAGE_POOL_DISK)\n        return 0;\n\n    /* Update pool metadata - don't update meta data from error paths\n     * in this module since the allocation/available weren't adjusted yet.\n     * Ignore the disk backend since it updates the pool values.\n     */\n    if (updateMeta) {\n        def->allocation -= voldef->target.allocation;\n        def->available += voldef->target.allocation;\n    }\n\n    virStoragePoolObjRemoveVol(obj, voldef);\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolDeleteInternal(virStorageBackendPtr backend,\n                         virStoragePoolObjPtr obj,\n                         virStorageVolDefPtr voldef,\n                         unsigned int flags,\n                         bool updateMeta)\n{\n    virStoragePoolDefPtr def = virStoragePoolObjGetDef(obj);\n\n    if (!backend->deleteVol) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"storage pool does not support vol deletion\"));\n\n        return -1;\n    }\n\n    if (backend->deleteVol(obj, voldef, flags) < 0)\n        return -1;\n\n    /* The disk backend updated the pool data including removing the\n     * voldef from the pool (for both the deleteVol and the createVol\n     * failure path. */\n    if (def->type == VIR_STORAGE_POOL_DISK)\n        return 0;\n\n    /* Update pool metadata - don't update meta data from error paths\n     * in this module since the allocation/available weren't adjusted yet.\n     * Ignore the disk backend since it updates the pool values.\n     */\n    if (updateMeta) {\n        def->allocation -= voldef->target.allocation;\n        def->available += voldef->target.allocation;\n    }\n\n    virStoragePoolObjRemoveVol(obj, voldef);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"volume '%s' is still being allocated.\")",
            "voldef->name"
          ],
          "line": 1870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"volume '%s' is still being allocated.\""
          ],
          "line": 1871
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"volume '%s' is still in use.\")",
            "voldef->name"
          ],
          "line": 1863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolDeleteEnsureACL",
          "args": [
            "vol->conn",
            "virStoragePoolObjGetDef(obj)",
            "voldef"
          ],
          "line": 1858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1858
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolDefFromVol",
          "args": [
            "vol",
            "&obj",
            "&backend"
          ],
          "line": 1855
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefFromVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1806-1843",
          "snippet": "static virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolDelete(virStorageVolPtr vol,\n                 unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldef = NULL;\n    int ret = -1;\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolDeleteEnsureACL(vol->conn, virStoragePoolObjGetDef(obj),\n                                     voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (storageVolDeleteInternal(backend, obj, voldef, flags, true) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "virStorageVolDefFromVol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1806-1843",
    "snippet": "static virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "obj"
          ],
          "line": 1840
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageBackendForType",
          "args": [
            "def->type"
          ],
          "line": 1833
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendForType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
          "lines": "172-184",
          "snippet": "virStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}",
          "includes": [
            "# include \"storage_backend_vstorage.h\"",
            "# include \"storage_backend_zfs.h\"",
            "# include \"storage_backend_gluster.h\"",
            "# include \"storage_backend_sheepdog.h\"",
            "# include \"storage_backend_rbd.h\"",
            "# include \"storage_backend_fs.h\"",
            "# include \"storage_backend_disk.h\"",
            "# include \"storage_backend_mpath.h\"",
            "# include \"storage_backend_scsi.h\"",
            "# include \"storage_backend_iscsi_direct.h\"",
            "# include \"storage_backend_iscsi.h\"",
            "# include \"storage_backend_logical.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
            "static size_t virStorageBackendsCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_STORAGE_VOL",
            "_(\"no storage vol with matching name '%s'\")",
            "vol->name"
          ],
          "line": 1826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no storage vol with matching name '%s'\""
          ],
          "line": 1827
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolDefFindByName",
          "args": [
            "*obj",
            "vol->name"
          ],
          "line": 1825
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "841-854",
          "snippet": "virStorageVolDefPtr\nvirStorageVolDefFindByName(virStoragePoolObjPtr obj,\n                           const char *name)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsName, name);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStorageVolDefPtr\nvirStorageVolDefFindByName(virStoragePoolObjPtr obj,\n                           const char *name)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsName, name);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is not active\")",
            "def->name"
          ],
          "line": 1819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "*obj"
          ],
          "line": 1818
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "*obj"
          ],
          "line": 1816
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storagePoolObjFindByName",
          "args": [
            "vol->pool"
          ],
          "line": 1814
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolObjFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "481-490",
          "snippet": "static virStoragePoolObjPtr\nstoragePoolObjFindByName(const char *name)\n{\n    virStoragePoolObjPtr obj;\n\n    if (!(obj = virStoragePoolObjFindByName(driver->pools, name)))\n        virReportError(VIR_ERR_NO_STORAGE_POOL,\n                       _(\"no storage pool with matching name '%s'\"), name);\n    return obj;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStoragePoolObjPtr\nstoragePoolObjFindByName(const char *name)\n{\n    virStoragePoolObjPtr obj;\n\n    if (!(obj = virStoragePoolObjFindByName(driver->pools, name)))\n        virReportError(VIR_ERR_NO_STORAGE_POOL,\n                       _(\"no storage pool with matching name '%s'\"), name);\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageVolDefPtr\nvirStorageVolDefFromVol(virStorageVolPtr vol,\n                        virStoragePoolObjPtr *obj,\n                        virStorageBackendPtr *backend)\n{\n    virStorageVolDefPtr voldef = NULL;\n    virStoragePoolDefPtr def;\n\n    if (!(*obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(*obj);\n\n    if (!virStoragePoolObjIsActive(*obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       def->name);\n        goto error;\n    }\n\n    if (!(voldef = virStorageVolDefFindByName(*obj, vol->name))) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       vol->name);\n        goto error;\n    }\n\n    if (backend) {\n        if (!(*backend = virStorageBackendForType(def->type)))\n            goto error;\n    }\n\n    return voldef;\n\n error:\n    virStoragePoolObjEndAPI(obj);\n\n    return NULL;\n}"
  },
  {
    "function_name": "storageVolDeleteInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1766-1803",
    "snippet": "static int\nstorageVolDeleteInternal(virStorageBackendPtr backend,\n                         virStoragePoolObjPtr obj,\n                         virStorageVolDefPtr voldef,\n                         unsigned int flags,\n                         bool updateMeta)\n{\n    virStoragePoolDefPtr def = virStoragePoolObjGetDef(obj);\n\n    if (!backend->deleteVol) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"storage pool does not support vol deletion\"));\n\n        return -1;\n    }\n\n    if (backend->deleteVol(obj, voldef, flags) < 0)\n        return -1;\n\n    /* The disk backend updated the pool data including removing the\n     * voldef from the pool (for both the deleteVol and the createVol\n     * failure path. */\n    if (def->type == VIR_STORAGE_POOL_DISK)\n        return 0;\n\n    /* Update pool metadata - don't update meta data from error paths\n     * in this module since the allocation/available weren't adjusted yet.\n     * Ignore the disk backend since it updates the pool values.\n     */\n    if (updateMeta) {\n        def->allocation -= voldef->target.allocation;\n        def->available += voldef->target.allocation;\n    }\n\n    virStoragePoolObjRemoveVol(obj, voldef);\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjRemoveVol",
          "args": [
            "obj",
            "voldef"
          ],
          "line": 1800
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjRemoveVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "682-708",
          "snippet": "void\nvirStoragePoolObjRemoveVol(virStoragePoolObjPtr obj,\n                           virStorageVolDefPtr voldef)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockWrite(volumes);\n    volobj = virHashLookup(volumes->objsName, voldef->name);\n    if (!volobj) {\n        VIR_INFO(\"Cannot find volume '%s' from storage pool '%s'\",\n                 voldef->name, obj->def->name);\n        virObjectRWUnlock(volumes);\n        return;\n    }\n    VIR_INFO(\"Deleting volume '%s' from storage pool '%s'\",\n             voldef->name, obj->def->name);\n\n    virObjectRef(volobj);\n    virObjectLock(volobj);\n    virHashRemoveEntry(volumes->objsKey, voldef->key);\n    virHashRemoveEntry(volumes->objsName, voldef->name);\n    virHashRemoveEntry(volumes->objsPath, voldef->target.path);\n    virStorageVolObjEndAPI(&volobj);\n\n    virObjectRWUnlock(volumes);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjRemoveVol(virStoragePoolObjPtr obj,\n                           virStorageVolDefPtr voldef)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockWrite(volumes);\n    volobj = virHashLookup(volumes->objsName, voldef->name);\n    if (!volobj) {\n        VIR_INFO(\"Cannot find volume '%s' from storage pool '%s'\",\n                 voldef->name, obj->def->name);\n        virObjectRWUnlock(volumes);\n        return;\n    }\n    VIR_INFO(\"Deleting volume '%s' from storage pool '%s'\",\n             voldef->name, obj->def->name);\n\n    virObjectRef(volobj);\n    virObjectLock(volobj);\n    virHashRemoveEntry(volumes->objsKey, voldef->key);\n    virHashRemoveEntry(volumes->objsName, voldef->name);\n    virHashRemoveEntry(volumes->objsPath, voldef->target.path);\n    virStorageVolObjEndAPI(&volobj);\n\n    virObjectRWUnlock(volumes);\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->deleteVol",
          "args": [
            "obj",
            "voldef",
            "flags"
          ],
          "line": 1782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_SUPPORT",
            "\"%s\"",
            "_(\"storage pool does not support vol deletion\")"
          ],
          "line": 1776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"storage pool does not support vol deletion\""
          ],
          "line": 1777
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1773
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolDeleteInternal(virStorageBackendPtr backend,\n                         virStoragePoolObjPtr obj,\n                         virStorageVolDefPtr voldef,\n                         unsigned int flags,\n                         bool updateMeta)\n{\n    virStoragePoolDefPtr def = virStoragePoolObjGetDef(obj);\n\n    if (!backend->deleteVol) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"storage pool does not support vol deletion\"));\n\n        return -1;\n    }\n\n    if (backend->deleteVol(obj, voldef, flags) < 0)\n        return -1;\n\n    /* The disk backend updated the pool data including removing the\n     * voldef from the pool (for both the deleteVol and the createVol\n     * failure path. */\n    if (def->type == VIR_STORAGE_POOL_DISK)\n        return 0;\n\n    /* Update pool metadata - don't update meta data from error paths\n     * in this module since the allocation/available weren't adjusted yet.\n     * Ignore the disk backend since it updates the pool values.\n     */\n    if (updateMeta) {\n        def->allocation -= voldef->target.allocation;\n        def->available += voldef->target.allocation;\n    }\n\n    virStoragePoolObjRemoveVol(obj, voldef);\n\n    return 0;\n}"
  },
  {
    "function_name": "storagePoolLookupByTargetPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1726-1763",
    "snippet": "virStoragePoolPtr\nstoragePoolLookupByTargetPath(virConnectPtr conn,\n                              const char *path)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n    g_autofree char *cleanpath = NULL;\n\n    cleanpath = virFileSanitizePath(path);\n    if (!cleanpath)\n        return NULL;\n\n    if ((obj = virStoragePoolObjListSearch(driver->pools,\n                                           storagePoolLookupByTargetPathCallback,\n                                           cleanpath))) {\n        def = virStoragePoolObjGetDef(obj);\n        if (virStoragePoolLookupByTargetPathEnsureACL(conn, def) < 0)\n            return NULL;\n\n        pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    if (!pool) {\n        if (STREQ(path, cleanpath)) {\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching target path '%s'\"),\n                           path);\n        } else {\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching target path '%s' (%s)\"),\n                           path, cleanpath);\n        }\n    }\n\n    return pool;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_STORAGE_POOL",
            "_(\"no storage pool with matching target path '%s' (%s)\")",
            "path",
            "cleanpath"
          ],
          "line": 1756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no storage pool with matching target path '%s' (%s)\""
          ],
          "line": 1757
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_STORAGE_POOL",
            "_(\"no storage pool with matching target path '%s'\")",
            "path"
          ],
          "line": 1752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "path",
            "cleanpath"
          ],
          "line": 1751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1747
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetStoragePool",
          "args": [
            "conn",
            "def->name",
            "def->uuid",
            "NULL",
            "NULL"
          ],
          "line": 1746
        },
        "resolved": true,
        "details": {
          "function_name": "virGetStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "525-556",
          "snippet": "virStoragePoolPtr\nvirGetStoragePool(virConnectPtr conn, const char *name,\n                  const unsigned char *uuid,\n                  void *privateData, virFreeCallback freeFunc)\n{\n    virStoragePoolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virStoragePoolClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    /* set the driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virStoragePoolClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virStoragePoolClass;\n\nvirStoragePoolPtr\nvirGetStoragePool(virConnectPtr conn, const char *name,\n                  const unsigned char *uuid,\n                  void *privateData, virFreeCallback freeFunc)\n{\n    virStoragePoolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virStoragePoolClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    /* set the driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolLookupByTargetPathEnsureACL",
          "args": [
            "conn",
            "def"
          ],
          "line": 1743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1742
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjListSearch",
          "args": [
            "driver->pools",
            "storagePoolLookupByTargetPathCallback",
            "cleanpath"
          ],
          "line": 1739
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjListSearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "507-521",
          "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjListSearch(virStoragePoolObjListPtr pools,\n                            virStoragePoolObjListSearcher searcher,\n                            const void *opaque)\n{\n    virStoragePoolObjPtr obj = NULL;\n    struct _virStoragePoolObjListSearchData data = { .searcher = searcher,\n                                                     .opaque = opaque };\n\n    virObjectRWLockRead(pools);\n    obj = virHashSearch(pools->objs, virStoragePoolObjListSearchCb, &data, NULL);\n    virObjectRWUnlock(pools);\n\n    return virObjectRef(obj);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nvirStoragePoolObjDispose(void *opaque);",
            "static void\nvirStoragePoolObjListDispose(void *opaque);",
            "static void\nvirStorageVolObjDispose(void *opaque);",
            "static void\nvirStorageVolObjListDispose(void *opaque);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nvirStoragePoolObjPtr\nvirStoragePoolObjListSearch(virStoragePoolObjListPtr pools,\n                            virStoragePoolObjListSearcher searcher,\n                            const void *opaque)\n{\n    virStoragePoolObjPtr obj = NULL;\n    struct _virStoragePoolObjListSearchData data = { .searcher = searcher,\n                                                     .opaque = opaque };\n\n    virObjectRWLockRead(pools);\n    obj = virHashSearch(pools->objs, virStoragePoolObjListSearchCb, &data, NULL);\n    virObjectRWUnlock(pools);\n\n    return virObjectRef(obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileSanitizePath",
          "args": [
            "path"
          ],
          "line": 1735
        },
        "resolved": true,
        "details": {
          "function_name": "virFileSanitizePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3242-3290",
          "snippet": "char *\nvirFileSanitizePath(const char *path)\n{\n    const char *cur = path;\n    char *uri;\n    char *cleanpath;\n    int idx = 0;\n\n    cleanpath = g_strdup(path);\n\n    /* don't sanitize URIs - rfc3986 states that two slashes may lead to a\n     * different resource, thus removing them would possibly change the path */\n    if ((uri = strstr(path, \"://\")) && strchr(path, '/') > uri)\n        return cleanpath;\n\n    /* Need to sanitize:\n     * //           -> //\n     * ///          -> /\n     * /../foo      -> /../foo\n     * /foo///bar/  -> /foo/bar\n     */\n\n    /* Starting with // is valid posix, but ///foo == /foo */\n    if (cur[0] == '/' && cur[1] == '/' && cur[2] != '/') {\n        idx = 2;\n        cur += 2;\n    }\n\n    /* Sanitize path in place */\n    while (*cur != '\\0') {\n        if (*cur != '/') {\n            cleanpath[idx++] = *cur++;\n            continue;\n        }\n\n        /* Skip all extra / */\n        while (*++cur == '/')\n            continue;\n\n        /* Don't add a trailing / */\n        if (idx != 0 && *cur == '\\0')\n            break;\n\n        cleanpath[idx++] = '/';\n    }\n    cleanpath[idx] = '\\0';\n\n    return cleanpath;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileSanitizePath(const char *path)\n{\n    const char *cur = path;\n    char *uri;\n    char *cleanpath;\n    int idx = 0;\n\n    cleanpath = g_strdup(path);\n\n    /* don't sanitize URIs - rfc3986 states that two slashes may lead to a\n     * different resource, thus removing them would possibly change the path */\n    if ((uri = strstr(path, \"://\")) && strchr(path, '/') > uri)\n        return cleanpath;\n\n    /* Need to sanitize:\n     * //           -> //\n     * ///          -> /\n     * /../foo      -> /../foo\n     * /foo///bar/  -> /foo/bar\n     */\n\n    /* Starting with // is valid posix, but ///foo == /foo */\n    if (cur[0] == '/' && cur[1] == '/' && cur[2] != '/') {\n        idx = 2;\n        cur += 2;\n    }\n\n    /* Sanitize path in place */\n    while (*cur != '\\0') {\n        if (*cur != '/') {\n            cleanpath[idx++] = *cur++;\n            continue;\n        }\n\n        /* Skip all extra / */\n        while (*++cur == '/')\n            continue;\n\n        /* Don't add a trailing / */\n        if (idx != 0 && *cur == '\\0')\n            break;\n\n        cleanpath[idx++] = '/';\n    }\n    cleanpath[idx] = '\\0';\n\n    return cleanpath;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nvirStoragePoolPtr\nstoragePoolLookupByTargetPath(virConnectPtr conn,\n                              const char *path)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n    g_autofree char *cleanpath = NULL;\n\n    cleanpath = virFileSanitizePath(path);\n    if (!cleanpath)\n        return NULL;\n\n    if ((obj = virStoragePoolObjListSearch(driver->pools,\n                                           storagePoolLookupByTargetPathCallback,\n                                           cleanpath))) {\n        def = virStoragePoolObjGetDef(obj);\n        if (virStoragePoolLookupByTargetPathEnsureACL(conn, def) < 0)\n            return NULL;\n\n        pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    if (!pool) {\n        if (STREQ(path, cleanpath)) {\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching target path '%s'\"),\n                           path);\n        } else {\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching target path '%s' (%s)\"),\n                           path, cleanpath);\n        }\n    }\n\n    return pool;\n}"
  },
  {
    "function_name": "storagePoolLookupByTargetPathCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1711-1723",
    "snippet": "static bool\nstoragePoolLookupByTargetPathCallback(virStoragePoolObjPtr obj,\n                                      const void *opaque)\n{\n    const char *path = opaque;\n    virStoragePoolDefPtr def;\n\n    if (!virStoragePoolObjIsActive(obj))\n        return false;\n\n    def = virStoragePoolObjGetDef(obj);\n    return STREQ_NULLABLE(path, def->target.path);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "path",
            "def->target.path"
          ],
          "line": 1722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1721
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1718
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic bool\nstoragePoolLookupByTargetPathCallback(virStoragePoolObjPtr obj,\n                                      const void *opaque)\n{\n    const char *path = opaque;\n    virStoragePoolDefPtr def;\n\n    if (!virStoragePoolObjIsActive(obj))\n        return false;\n\n    def = virStoragePoolObjGetDef(obj);\n    return STREQ_NULLABLE(path, def->target.path);\n}"
  },
  {
    "function_name": "storageVolLookupByPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1669-1708",
    "snippet": "static virStorageVolPtr\nstorageVolLookupByPath(virConnectPtr conn,\n                       const char *path)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    struct storageVolLookupData data = {\n        .path = path, .voldef = NULL };\n    virStorageVolPtr vol = NULL;\n\n    if (!(data.cleanpath = virFileSanitizePath(path)))\n        return NULL;\n\n    if ((obj = virStoragePoolObjListSearch(driver->pools,\n                                           storageVolLookupByPathCallback,\n                                           &data)) && data.voldef) {\n        def = virStoragePoolObjGetDef(obj);\n\n        if (virStorageVolLookupByPathEnsureACL(conn, def, data.voldef) == 0) {\n            vol = virGetStorageVol(conn, def->name,\n                                   data.voldef->name, data.voldef->key,\n                                   NULL, NULL);\n        }\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    if (!vol) {\n        if (STREQ(path, data.cleanpath)) {\n            virReportError(VIR_ERR_NO_STORAGE_VOL,\n                           _(\"no storage vol with matching path '%s'\"), path);\n        } else {\n            virReportError(VIR_ERR_NO_STORAGE_VOL,\n                           _(\"no storage vol with matching path '%s' (%s)\"),\n                           path, data.cleanpath);\n        }\n    }\n\n    VIR_FREE(data.cleanpath);\n    return vol;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data.cleanpath"
          ],
          "line": 1706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_STORAGE_VOL",
            "_(\"no storage vol with matching path '%s' (%s)\")",
            "path",
            "data.cleanpath"
          ],
          "line": 1700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no storage vol with matching path '%s' (%s)\""
          ],
          "line": 1701
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_STORAGE_VOL",
            "_(\"no storage vol with matching path '%s'\")",
            "path"
          ],
          "line": 1697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "path",
            "data.cleanpath"
          ],
          "line": 1696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1692
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetStorageVol",
          "args": [
            "conn",
            "def->name",
            "data.voldef->name",
            "data.voldef->key",
            "NULL",
            "NULL"
          ],
          "line": 1688
        },
        "resolved": true,
        "details": {
          "function_name": "virGetStorageVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "600-632",
          "snippet": "virStorageVolPtr\nvirGetStorageVol(virConnectPtr conn, const char *pool, const char *name,\n                 const char *key, void *privateData, virFreeCallback freeFunc)\n{\n    virStorageVolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(pool, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(key, error);\n\n    if (!(ret = virObjectNew(virStorageVolClass)))\n        goto error;\n\n    ret->pool = g_strdup(pool);\n    ret->name = g_strdup(name);\n    ret->key = g_strdup(key);\n\n    ret->conn = virObjectRef(conn);\n\n    /* set driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virStorageVolClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virStorageVolClass;\n\nvirStorageVolPtr\nvirGetStorageVol(virConnectPtr conn, const char *pool, const char *name,\n                 const char *key, void *privateData, virFreeCallback freeFunc)\n{\n    virStorageVolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(pool, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(key, error);\n\n    if (!(ret = virObjectNew(virStorageVolClass)))\n        goto error;\n\n    ret->pool = g_strdup(pool);\n    ret->name = g_strdup(name);\n    ret->key = g_strdup(key);\n\n    ret->conn = virObjectRef(conn);\n\n    /* set driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolLookupByPathEnsureACL",
          "args": [
            "conn",
            "def",
            "data.voldef"
          ],
          "line": 1687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1685
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjListSearch",
          "args": [
            "driver->pools",
            "storageVolLookupByPathCallback",
            "&data"
          ],
          "line": 1682
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjListSearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "507-521",
          "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjListSearch(virStoragePoolObjListPtr pools,\n                            virStoragePoolObjListSearcher searcher,\n                            const void *opaque)\n{\n    virStoragePoolObjPtr obj = NULL;\n    struct _virStoragePoolObjListSearchData data = { .searcher = searcher,\n                                                     .opaque = opaque };\n\n    virObjectRWLockRead(pools);\n    obj = virHashSearch(pools->objs, virStoragePoolObjListSearchCb, &data, NULL);\n    virObjectRWUnlock(pools);\n\n    return virObjectRef(obj);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nvirStoragePoolObjDispose(void *opaque);",
            "static void\nvirStoragePoolObjListDispose(void *opaque);",
            "static void\nvirStorageVolObjDispose(void *opaque);",
            "static void\nvirStorageVolObjListDispose(void *opaque);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nvirStoragePoolObjPtr\nvirStoragePoolObjListSearch(virStoragePoolObjListPtr pools,\n                            virStoragePoolObjListSearcher searcher,\n                            const void *opaque)\n{\n    virStoragePoolObjPtr obj = NULL;\n    struct _virStoragePoolObjListSearchData data = { .searcher = searcher,\n                                                     .opaque = opaque };\n\n    virObjectRWLockRead(pools);\n    obj = virHashSearch(pools->objs, virStoragePoolObjListSearchCb, &data, NULL);\n    virObjectRWUnlock(pools);\n\n    return virObjectRef(obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileSanitizePath",
          "args": [
            "path"
          ],
          "line": 1679
        },
        "resolved": true,
        "details": {
          "function_name": "virFileSanitizePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3242-3290",
          "snippet": "char *\nvirFileSanitizePath(const char *path)\n{\n    const char *cur = path;\n    char *uri;\n    char *cleanpath;\n    int idx = 0;\n\n    cleanpath = g_strdup(path);\n\n    /* don't sanitize URIs - rfc3986 states that two slashes may lead to a\n     * different resource, thus removing them would possibly change the path */\n    if ((uri = strstr(path, \"://\")) && strchr(path, '/') > uri)\n        return cleanpath;\n\n    /* Need to sanitize:\n     * //           -> //\n     * ///          -> /\n     * /../foo      -> /../foo\n     * /foo///bar/  -> /foo/bar\n     */\n\n    /* Starting with // is valid posix, but ///foo == /foo */\n    if (cur[0] == '/' && cur[1] == '/' && cur[2] != '/') {\n        idx = 2;\n        cur += 2;\n    }\n\n    /* Sanitize path in place */\n    while (*cur != '\\0') {\n        if (*cur != '/') {\n            cleanpath[idx++] = *cur++;\n            continue;\n        }\n\n        /* Skip all extra / */\n        while (*++cur == '/')\n            continue;\n\n        /* Don't add a trailing / */\n        if (idx != 0 && *cur == '\\0')\n            break;\n\n        cleanpath[idx++] = '/';\n    }\n    cleanpath[idx] = '\\0';\n\n    return cleanpath;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileSanitizePath(const char *path)\n{\n    const char *cur = path;\n    char *uri;\n    char *cleanpath;\n    int idx = 0;\n\n    cleanpath = g_strdup(path);\n\n    /* don't sanitize URIs - rfc3986 states that two slashes may lead to a\n     * different resource, thus removing them would possibly change the path */\n    if ((uri = strstr(path, \"://\")) && strchr(path, '/') > uri)\n        return cleanpath;\n\n    /* Need to sanitize:\n     * //           -> //\n     * ///          -> /\n     * /../foo      -> /../foo\n     * /foo///bar/  -> /foo/bar\n     */\n\n    /* Starting with // is valid posix, but ///foo == /foo */\n    if (cur[0] == '/' && cur[1] == '/' && cur[2] != '/') {\n        idx = 2;\n        cur += 2;\n    }\n\n    /* Sanitize path in place */\n    while (*cur != '\\0') {\n        if (*cur != '/') {\n            cleanpath[idx++] = *cur++;\n            continue;\n        }\n\n        /* Skip all extra / */\n        while (*++cur == '/')\n            continue;\n\n        /* Don't add a trailing / */\n        if (idx != 0 && *cur == '\\0')\n            break;\n\n        cleanpath[idx++] = '/';\n    }\n    cleanpath[idx] = '\\0';\n\n    return cleanpath;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStorageVolPtr\nstorageVolLookupByPath(virConnectPtr conn,\n                       const char *path)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    struct storageVolLookupData data = {\n        .path = path, .voldef = NULL };\n    virStorageVolPtr vol = NULL;\n\n    if (!(data.cleanpath = virFileSanitizePath(path)))\n        return NULL;\n\n    if ((obj = virStoragePoolObjListSearch(driver->pools,\n                                           storageVolLookupByPathCallback,\n                                           &data)) && data.voldef) {\n        def = virStoragePoolObjGetDef(obj);\n\n        if (virStorageVolLookupByPathEnsureACL(conn, def, data.voldef) == 0) {\n            vol = virGetStorageVol(conn, def->name,\n                                   data.voldef->name, data.voldef->key,\n                                   NULL, NULL);\n        }\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    if (!vol) {\n        if (STREQ(path, data.cleanpath)) {\n            virReportError(VIR_ERR_NO_STORAGE_VOL,\n                           _(\"no storage vol with matching path '%s'\"), path);\n        } else {\n            virReportError(VIR_ERR_NO_STORAGE_VOL,\n                           _(\"no storage vol with matching path '%s' (%s)\"),\n                           path, data.cleanpath);\n        }\n    }\n\n    VIR_FREE(data.cleanpath);\n    return vol;\n}"
  },
  {
    "function_name": "storageVolLookupByPathCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1619-1666",
    "snippet": "static bool\nstorageVolLookupByPathCallback(virStoragePoolObjPtr obj,\n                               const void *opaque)\n{\n    struct storageVolLookupData *data = (struct storageVolLookupData *)opaque;\n    virStoragePoolDefPtr def;\n    g_autofree char *stable_path = NULL;\n\n    if (!virStoragePoolObjIsActive(obj))\n        return false;\n\n    def = virStoragePoolObjGetDef(obj);\n\n    switch ((virStoragePoolType)def->type) {\n        case VIR_STORAGE_POOL_DIR:\n        case VIR_STORAGE_POOL_FS:\n        case VIR_STORAGE_POOL_NETFS:\n        case VIR_STORAGE_POOL_LOGICAL:\n        case VIR_STORAGE_POOL_DISK:\n        case VIR_STORAGE_POOL_ISCSI:\n        case VIR_STORAGE_POOL_ISCSI_DIRECT:\n        case VIR_STORAGE_POOL_SCSI:\n        case VIR_STORAGE_POOL_MPATH:\n        case VIR_STORAGE_POOL_VSTORAGE:\n            stable_path = virStorageBackendStablePath(obj, data->cleanpath,\n                                                      false);\n            break;\n\n        case VIR_STORAGE_POOL_GLUSTER:\n        case VIR_STORAGE_POOL_RBD:\n        case VIR_STORAGE_POOL_SHEEPDOG:\n        case VIR_STORAGE_POOL_ZFS:\n        case VIR_STORAGE_POOL_LAST:\n            stable_path = g_strdup(data->path);\n            break;\n    }\n\n    /* Don't break the whole lookup process if it fails on\n     * getting the stable path for some of the pools. */\n    if (!stable_path) {\n        VIR_WARN(\"Failed to get stable path for pool '%s'\", def->name);\n        return false;\n    }\n\n    data->voldef = virStorageVolDefFindByPath(obj, stable_path);\n\n    return !!data->voldef;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStorageVolDefFindByPath",
          "args": [
            "obj",
            "stable_path"
          ],
          "line": 1663
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefFindByPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "825-838",
          "snippet": "virStorageVolDefPtr\nvirStorageVolDefFindByPath(virStoragePoolObjPtr obj,\n                           const char *path)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsPath, path);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStorageVolDefPtr\nvirStorageVolDefFindByPath(virStoragePoolObjPtr obj,\n                           const char *path)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsPath, path);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Failed to get stable path for pool '%s'\"",
            "def->name"
          ],
          "line": 1659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "data->path"
          ],
          "line": 1652
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageBackendStablePath",
          "args": [
            "obj",
            "data->cleanpath",
            "false"
          ],
          "line": 1643
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendStablePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_util.c",
          "lines": "1904-1975",
          "snippet": "char *\nvirStorageBackendStablePath(virStoragePoolObjPtr pool,\n                            const char *devpath,\n                            bool loop)\n{\n    virStoragePoolDefPtr def = virStoragePoolObjGetDef(pool);\n    DIR *dh;\n    struct dirent *dent;\n    char *stablepath;\n    int opentries = 0;\n    int retry = 0;\n    int direrr;\n\n    /* Logical pools are under /dev but already have stable paths */\n    if (def->type == VIR_STORAGE_POOL_LOGICAL ||\n        !virStorageBackendPoolPathIsStable(def->target.path))\n        goto ret_strdup;\n\n    /* We loop here because /dev/disk/by-{id,path} may not have existed\n     * before we started this operation, so we have to give it some time to\n     * get created.\n     */\n reopen:\n    if (virDirOpenQuiet(&dh, def->target.path) < 0) {\n        opentries++;\n        if (loop && errno == ENOENT && opentries < 50) {\n            g_usleep(100 * 1000);\n            goto reopen;\n        }\n        virReportSystemError(errno,\n                             _(\"cannot read dir '%s'\"),\n                             def->target.path);\n        return NULL;\n    }\n\n    /* The pool is pointing somewhere like /dev/disk/by-path\n     * or /dev/disk/by-id, so we need to check all symlinks in\n     * the target directory and figure out which one points\n     * to this device node.\n     *\n     * And it might need some time till the stable path shows\n     * up, so add timeout to retry here.  Ignore readdir failures,\n     * since we have a fallback.\n     */\n retry:\n    while ((direrr = virDirRead(dh, &dent, NULL)) > 0) {\n        stablepath = g_strdup_printf(\"%s/%s\", def->target.path, dent->d_name);\n\n        if (virFileLinkPointsTo(stablepath, devpath)) {\n            VIR_DIR_CLOSE(dh);\n            return stablepath;\n        }\n\n        VIR_FREE(stablepath);\n    }\n\n    if (!direrr && loop && ++retry < 100) {\n        g_usleep(100 * 1000);\n        goto retry;\n    }\n\n    VIR_DIR_CLOSE(dh);\n\n ret_strdup:\n    /* Couldn't find any matching stable link so give back\n     * the original non-stable dev path\n     */\n\n    stablepath = g_strdup(devpath);\n\n    return stablepath;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"virqemu.h\"",
            "#include \"virjson.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_util.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"viruuid.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virsecret.h\"",
            "#include \"secret_conf.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "# include <xfs/xfs.h>",
            "# include <linux/btrfs.h>",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <linux/fs.h>",
            "# include <sys/ioctl.h>",
            "#include <dirent.h>",
            "#include <sys/param.h>",
            "#include <sys/statvfs.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virfdstream.h\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"virqemu.h\"\n#include \"virjson.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_util.h\"\n#include \"virstoragefile.h\"\n#include \"viruuid.h\"\n#include \"vircrypto.h\"\n#include \"virsecret.h\"\n#include \"secret_conf.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n# include <xfs/xfs.h>\n# include <linux/btrfs.h>\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <linux/fs.h>\n# include <sys/ioctl.h>\n#include <dirent.h>\n#include <sys/param.h>\n#include <sys/statvfs.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nvirStorageBackendStablePath(virStoragePoolObjPtr pool,\n                            const char *devpath,\n                            bool loop)\n{\n    virStoragePoolDefPtr def = virStoragePoolObjGetDef(pool);\n    DIR *dh;\n    struct dirent *dent;\n    char *stablepath;\n    int opentries = 0;\n    int retry = 0;\n    int direrr;\n\n    /* Logical pools are under /dev but already have stable paths */\n    if (def->type == VIR_STORAGE_POOL_LOGICAL ||\n        !virStorageBackendPoolPathIsStable(def->target.path))\n        goto ret_strdup;\n\n    /* We loop here because /dev/disk/by-{id,path} may not have existed\n     * before we started this operation, so we have to give it some time to\n     * get created.\n     */\n reopen:\n    if (virDirOpenQuiet(&dh, def->target.path) < 0) {\n        opentries++;\n        if (loop && errno == ENOENT && opentries < 50) {\n            g_usleep(100 * 1000);\n            goto reopen;\n        }\n        virReportSystemError(errno,\n                             _(\"cannot read dir '%s'\"),\n                             def->target.path);\n        return NULL;\n    }\n\n    /* The pool is pointing somewhere like /dev/disk/by-path\n     * or /dev/disk/by-id, so we need to check all symlinks in\n     * the target directory and figure out which one points\n     * to this device node.\n     *\n     * And it might need some time till the stable path shows\n     * up, so add timeout to retry here.  Ignore readdir failures,\n     * since we have a fallback.\n     */\n retry:\n    while ((direrr = virDirRead(dh, &dent, NULL)) > 0) {\n        stablepath = g_strdup_printf(\"%s/%s\", def->target.path, dent->d_name);\n\n        if (virFileLinkPointsTo(stablepath, devpath)) {\n            VIR_DIR_CLOSE(dh);\n            return stablepath;\n        }\n\n        VIR_FREE(stablepath);\n    }\n\n    if (!direrr && loop && ++retry < 100) {\n        g_usleep(100 * 1000);\n        goto retry;\n    }\n\n    VIR_DIR_CLOSE(dh);\n\n ret_strdup:\n    /* Couldn't find any matching stable link so give back\n     * the original non-stable dev path\n     */\n\n    stablepath = g_strdup(devpath);\n\n    return stablepath;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1630
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1627
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic bool\nstorageVolLookupByPathCallback(virStoragePoolObjPtr obj,\n                               const void *opaque)\n{\n    struct storageVolLookupData *data = (struct storageVolLookupData *)opaque;\n    virStoragePoolDefPtr def;\n    g_autofree char *stable_path = NULL;\n\n    if (!virStoragePoolObjIsActive(obj))\n        return false;\n\n    def = virStoragePoolObjGetDef(obj);\n\n    switch ((virStoragePoolType)def->type) {\n        case VIR_STORAGE_POOL_DIR:\n        case VIR_STORAGE_POOL_FS:\n        case VIR_STORAGE_POOL_NETFS:\n        case VIR_STORAGE_POOL_LOGICAL:\n        case VIR_STORAGE_POOL_DISK:\n        case VIR_STORAGE_POOL_ISCSI:\n        case VIR_STORAGE_POOL_ISCSI_DIRECT:\n        case VIR_STORAGE_POOL_SCSI:\n        case VIR_STORAGE_POOL_MPATH:\n        case VIR_STORAGE_POOL_VSTORAGE:\n            stable_path = virStorageBackendStablePath(obj, data->cleanpath,\n                                                      false);\n            break;\n\n        case VIR_STORAGE_POOL_GLUSTER:\n        case VIR_STORAGE_POOL_RBD:\n        case VIR_STORAGE_POOL_SHEEPDOG:\n        case VIR_STORAGE_POOL_ZFS:\n        case VIR_STORAGE_POOL_LAST:\n            stable_path = g_strdup(data->path);\n            break;\n    }\n\n    /* Don't break the whole lookup process if it fails on\n     * getting the stable path for some of the pools. */\n    if (!stable_path) {\n        VIR_WARN(\"Failed to get stable path for pool '%s'\", def->name);\n        return false;\n    }\n\n    data->voldef = virStorageVolDefFindByPath(obj, stable_path);\n\n    return !!data->voldef;\n}"
  },
  {
    "function_name": "storageVolLookupByKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1589-1616",
    "snippet": "static virStorageVolPtr\nstorageVolLookupByKey(virConnectPtr conn,\n                      const char *key)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    struct storageVolLookupData data = {\n        .key = key, .voldef = NULL };\n    virStorageVolPtr vol = NULL;\n\n    if ((obj = virStoragePoolObjListSearch(driver->pools,\n                                           storageVolLookupByKeyCallback,\n                                           &data)) && data.voldef) {\n        def = virStoragePoolObjGetDef(obj);\n        if (virStorageVolLookupByKeyEnsureACL(conn, def, data.voldef) == 0) {\n            vol = virGetStorageVol(conn, def->name,\n                                   data.voldef->name, data.voldef->key,\n                                   NULL, NULL);\n        }\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    if (!vol)\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching key %s\"), key);\n\n    return vol;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_STORAGE_VOL",
            "_(\"no storage vol with matching key %s\")",
            "key"
          ],
          "line": 1612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no storage vol with matching key %s\""
          ],
          "line": 1613
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1608
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetStorageVol",
          "args": [
            "conn",
            "def->name",
            "data.voldef->name",
            "data.voldef->key",
            "NULL",
            "NULL"
          ],
          "line": 1604
        },
        "resolved": true,
        "details": {
          "function_name": "virGetStorageVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "600-632",
          "snippet": "virStorageVolPtr\nvirGetStorageVol(virConnectPtr conn, const char *pool, const char *name,\n                 const char *key, void *privateData, virFreeCallback freeFunc)\n{\n    virStorageVolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(pool, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(key, error);\n\n    if (!(ret = virObjectNew(virStorageVolClass)))\n        goto error;\n\n    ret->pool = g_strdup(pool);\n    ret->name = g_strdup(name);\n    ret->key = g_strdup(key);\n\n    ret->conn = virObjectRef(conn);\n\n    /* set driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virStorageVolClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virStorageVolClass;\n\nvirStorageVolPtr\nvirGetStorageVol(virConnectPtr conn, const char *pool, const char *name,\n                 const char *key, void *privateData, virFreeCallback freeFunc)\n{\n    virStorageVolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(pool, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(key, error);\n\n    if (!(ret = virObjectNew(virStorageVolClass)))\n        goto error;\n\n    ret->pool = g_strdup(pool);\n    ret->name = g_strdup(name);\n    ret->key = g_strdup(key);\n\n    ret->conn = virObjectRef(conn);\n\n    /* set driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolLookupByKeyEnsureACL",
          "args": [
            "conn",
            "def",
            "data.voldef"
          ],
          "line": 1603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1602
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjListSearch",
          "args": [
            "driver->pools",
            "storageVolLookupByKeyCallback",
            "&data"
          ],
          "line": 1599
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjListSearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "507-521",
          "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjListSearch(virStoragePoolObjListPtr pools,\n                            virStoragePoolObjListSearcher searcher,\n                            const void *opaque)\n{\n    virStoragePoolObjPtr obj = NULL;\n    struct _virStoragePoolObjListSearchData data = { .searcher = searcher,\n                                                     .opaque = opaque };\n\n    virObjectRWLockRead(pools);\n    obj = virHashSearch(pools->objs, virStoragePoolObjListSearchCb, &data, NULL);\n    virObjectRWUnlock(pools);\n\n    return virObjectRef(obj);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nvirStoragePoolObjDispose(void *opaque);",
            "static void\nvirStoragePoolObjListDispose(void *opaque);",
            "static void\nvirStorageVolObjDispose(void *opaque);",
            "static void\nvirStorageVolObjListDispose(void *opaque);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nvirStoragePoolObjPtr\nvirStoragePoolObjListSearch(virStoragePoolObjListPtr pools,\n                            virStoragePoolObjListSearcher searcher,\n                            const void *opaque)\n{\n    virStoragePoolObjPtr obj = NULL;\n    struct _virStoragePoolObjListSearchData data = { .searcher = searcher,\n                                                     .opaque = opaque };\n\n    virObjectRWLockRead(pools);\n    obj = virHashSearch(pools->objs, virStoragePoolObjListSearchCb, &data, NULL);\n    virObjectRWUnlock(pools);\n\n    return virObjectRef(obj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStorageVolPtr\nstorageVolLookupByKey(virConnectPtr conn,\n                      const char *key)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    struct storageVolLookupData data = {\n        .key = key, .voldef = NULL };\n    virStorageVolPtr vol = NULL;\n\n    if ((obj = virStoragePoolObjListSearch(driver->pools,\n                                           storageVolLookupByKeyCallback,\n                                           &data)) && data.voldef) {\n        def = virStoragePoolObjGetDef(obj);\n        if (virStorageVolLookupByKeyEnsureACL(conn, def, data.voldef) == 0) {\n            vol = virGetStorageVol(conn, def->name,\n                                   data.voldef->name, data.voldef->key,\n                                   NULL, NULL);\n        }\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    if (!vol)\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching key %s\"), key);\n\n    return vol;\n}"
  },
  {
    "function_name": "storageVolLookupByKeyCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1576-1586",
    "snippet": "static bool\nstorageVolLookupByKeyCallback(virStoragePoolObjPtr obj,\n                              const void *opaque)\n{\n    struct storageVolLookupData *data = (struct storageVolLookupData *)opaque;\n\n    if (virStoragePoolObjIsActive(obj))\n        data->voldef = virStorageVolDefFindByKey(obj, data->key);\n\n    return !!data->voldef;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStorageVolDefFindByKey",
          "args": [
            "obj",
            "data->key"
          ],
          "line": 1583
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefFindByKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "809-822",
          "snippet": "virStorageVolDefPtr\nvirStorageVolDefFindByKey(virStoragePoolObjPtr obj,\n                          const char *key)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsKey, key);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStorageVolDefPtr\nvirStorageVolDefFindByKey(virStoragePoolObjPtr obj,\n                          const char *key)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsKey, key);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1582
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic bool\nstorageVolLookupByKeyCallback(virStoragePoolObjPtr obj,\n                              const void *opaque)\n{\n    struct storageVolLookupData *data = (struct storageVolLookupData *)opaque;\n\n    if (virStoragePoolObjIsActive(obj))\n        data->voldef = virStorageVolDefFindByKey(obj, data->key);\n\n    return !!data->voldef;\n}"
  },
  {
    "function_name": "storageVolLookupByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1529-1566",
    "snippet": "static virStorageVolPtr\nstorageVolLookupByName(virStoragePoolPtr pool,\n                       const char *name)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageVolDefPtr voldef;\n    virStorageVolPtr vol = NULL;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    voldef = virStorageVolDefFindByName(obj, name);\n\n    if (!voldef) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       name);\n        goto cleanup;\n    }\n\n    if (virStorageVolLookupByNameEnsureACL(pool->conn, def, voldef) < 0)\n        goto cleanup;\n\n    vol = virGetStorageVol(pool->conn, def->name, voldef->name,\n                           voldef->key, NULL, NULL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return vol;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1564
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetStorageVol",
          "args": [
            "pool->conn",
            "def->name",
            "voldef->name",
            "voldef->key",
            "NULL",
            "NULL"
          ],
          "line": 1560
        },
        "resolved": true,
        "details": {
          "function_name": "virGetStorageVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "600-632",
          "snippet": "virStorageVolPtr\nvirGetStorageVol(virConnectPtr conn, const char *pool, const char *name,\n                 const char *key, void *privateData, virFreeCallback freeFunc)\n{\n    virStorageVolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(pool, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(key, error);\n\n    if (!(ret = virObjectNew(virStorageVolClass)))\n        goto error;\n\n    ret->pool = g_strdup(pool);\n    ret->name = g_strdup(name);\n    ret->key = g_strdup(key);\n\n    ret->conn = virObjectRef(conn);\n\n    /* set driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virStorageVolClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virStorageVolClass;\n\nvirStorageVolPtr\nvirGetStorageVol(virConnectPtr conn, const char *pool, const char *name,\n                 const char *key, void *privateData, virFreeCallback freeFunc)\n{\n    virStorageVolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(pool, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(key, error);\n\n    if (!(ret = virObjectNew(virStorageVolClass)))\n        goto error;\n\n    ret->pool = g_strdup(pool);\n    ret->name = g_strdup(name);\n    ret->key = g_strdup(key);\n\n    ret->conn = virObjectRef(conn);\n\n    /* set driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolLookupByNameEnsureACL",
          "args": [
            "pool->conn",
            "def",
            "voldef"
          ],
          "line": 1557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_STORAGE_VOL",
            "_(\"no storage vol with matching name '%s'\")",
            "name"
          ],
          "line": 1551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no storage vol with matching name '%s'\""
          ],
          "line": 1552
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolDefFindByName",
          "args": [
            "obj",
            "name"
          ],
          "line": 1548
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "841-854",
          "snippet": "virStorageVolDefPtr\nvirStorageVolDefFindByName(virStoragePoolObjPtr obj,\n                           const char *name)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsName, name);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStorageVolDefPtr\nvirStorageVolDefFindByName(virStoragePoolObjPtr obj,\n                           const char *name)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsName, name);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is not active\")",
            "def->name"
          ],
          "line": 1543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1542
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1540
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFromStoragePool",
          "args": [
            "pool"
          ],
          "line": 1538
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFromStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "474-478",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageVolPtr\nstorageVolLookupByName(virStoragePoolPtr pool,\n                       const char *name)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageVolDefPtr voldef;\n    virStorageVolPtr vol = NULL;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    voldef = virStorageVolDefFindByName(obj, name);\n\n    if (!voldef) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       name);\n        goto cleanup;\n    }\n\n    if (virStorageVolLookupByNameEnsureACL(pool->conn, def, voldef) < 0)\n        goto cleanup;\n\n    vol = virGetStorageVol(pool->conn, def->name, voldef->name,\n                           voldef->key, NULL, NULL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return vol;\n}"
  },
  {
    "function_name": "storagePoolListAllVolumes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1495-1527",
    "snippet": "static int\nstoragePoolListAllVolumes(virStoragePoolPtr pool,\n                          virStorageVolPtr **vols,\n                          unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolListAllVolumesEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    ret = virStoragePoolObjVolumeListExport(pool->conn, obj, vols,\n                                            virStoragePoolListAllVolumesCheckACL);\n\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1524
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjVolumeListExport",
          "args": [
            "pool->conn",
            "obj",
            "vols",
            "virStoragePoolListAllVolumesCheckACL"
          ],
          "line": 1519
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjVolumeListExport",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1020-1057",
          "snippet": "int\nvirStoragePoolObjVolumeListExport(virConnectPtr conn,\n                                  virStoragePoolObjPtr obj,\n                                  virStorageVolPtr **vols,\n                                  virStoragePoolVolumeACLFilter filter)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    virStoragePoolObjVolumeListExportData data = {\n        .conn = conn, .filter = filter, .pooldef = obj->def, .error = false,\n        .nvols = 0, .vols = NULL };\n\n    virObjectRWLockRead(volumes);\n\n    if (!vols) {\n        int ret = virHashSize(volumes->objsName);\n        virObjectRWUnlock(volumes);\n        return ret;\n    }\n\n    if (VIR_ALLOC_N(data.vols, virHashSize(volumes->objsName) + 1) < 0) {\n        virObjectRWUnlock(volumes);\n        return -1;\n    }\n\n    virHashForEach(volumes->objsName, virStoragePoolObjVolumeListExportCallback, &data);\n    virObjectRWUnlock(volumes);\n\n    if (data.error)\n        goto error;\n\n    *vols = data.vols;\n\n    return data.nvols;\n\n error:\n    virObjectListFree(data.vols);\n    return -1;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjVolumeListExport(virConnectPtr conn,\n                                  virStoragePoolObjPtr obj,\n                                  virStorageVolPtr **vols,\n                                  virStoragePoolVolumeACLFilter filter)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    virStoragePoolObjVolumeListExportData data = {\n        .conn = conn, .filter = filter, .pooldef = obj->def, .error = false,\n        .nvols = 0, .vols = NULL };\n\n    virObjectRWLockRead(volumes);\n\n    if (!vols) {\n        int ret = virHashSize(volumes->objsName);\n        virObjectRWUnlock(volumes);\n        return ret;\n    }\n\n    if (VIR_ALLOC_N(data.vols, virHashSize(volumes->objsName) + 1) < 0) {\n        virObjectRWUnlock(volumes);\n        return -1;\n    }\n\n    virHashForEach(volumes->objsName, virStoragePoolObjVolumeListExportCallback, &data);\n    virObjectRWUnlock(volumes);\n\n    if (data.error)\n        goto error;\n\n    *vols = data.vols;\n\n    return data.nvols;\n\n error:\n    virObjectListFree(data.vols);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is not active\")",
            "def->name"
          ],
          "line": 1514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"storage pool '%s' is not active\""
          ],
          "line": 1515
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1513
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolListAllVolumesEnsureACL",
          "args": [
            "pool->conn",
            "def"
          ],
          "line": 1510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1508
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFromStoragePool",
          "args": [
            "pool"
          ],
          "line": 1506
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFromStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "474-478",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1504
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolListAllVolumes(virStoragePoolPtr pool,\n                          virStorageVolPtr **vols,\n                          unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolListAllVolumesEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    ret = virStoragePoolObjVolumeListExport(pool->conn, obj, vols,\n                                            virStoragePoolListAllVolumesCheckACL);\n\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}"
  },
  {
    "function_name": "storagePoolListVolumes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1464-1492",
    "snippet": "static int\nstoragePoolListVolumes(virStoragePoolPtr pool,\n                       char **const names,\n                       int maxnames)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int n = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolListVolumesEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    n = virStoragePoolObjVolumeGetNames(obj, pool->conn,\n                                        virStoragePoolListVolumesCheckACL,\n                                        names, maxnames);\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return n;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1490
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjVolumeGetNames",
          "args": [
            "obj",
            "pool->conn",
            "virStoragePoolListVolumesCheckACL",
            "names",
            "maxnames"
          ],
          "line": 1486
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjVolumeGetNames",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "945-970",
          "snippet": "int\nvirStoragePoolObjVolumeGetNames(virStoragePoolObjPtr obj,\n                                virConnectPtr conn,\n                                virStoragePoolVolumeACLFilter filter,\n                                char **const names,\n                                int maxnames)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    struct _virStorageVolObjNameData data = {\n        .conn = conn, .filter = filter, .pooldef = obj->def, .error = false,\n        .nnames = 0, .maxnames = maxnames, .names = names };\n\n    virObjectRWLockRead(volumes);\n    virHashForEach(volumes->objsName, virStoragePoolObjVolumeGetNamesCb, &data);\n    virObjectRWUnlock(volumes);\n\n    if (data.error)\n        goto error;\n\n    return data.nnames;\n\n error:\n    while (--data.nnames)\n        VIR_FREE(data.names[data.nnames]);\n    return -1;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjVolumeGetNames(virStoragePoolObjPtr obj,\n                                virConnectPtr conn,\n                                virStoragePoolVolumeACLFilter filter,\n                                char **const names,\n                                int maxnames)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    struct _virStorageVolObjNameData data = {\n        .conn = conn, .filter = filter, .pooldef = obj->def, .error = false,\n        .nnames = 0, .maxnames = maxnames, .names = names };\n\n    virObjectRWLockRead(volumes);\n    virHashForEach(volumes->objsName, virStoragePoolObjVolumeGetNamesCb, &data);\n    virObjectRWUnlock(volumes);\n\n    if (data.error)\n        goto error;\n\n    return data.nnames;\n\n error:\n    while (--data.nnames)\n        VIR_FREE(data.names[data.nnames]);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is not active\")",
            "def->name"
          ],
          "line": 1481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"storage pool '%s' is not active\""
          ],
          "line": 1482
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1480
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolListVolumesEnsureACL",
          "args": [
            "pool->conn",
            "def"
          ],
          "line": 1477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1475
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFromStoragePool",
          "args": [
            "pool"
          ],
          "line": 1473
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFromStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "474-478",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolListVolumes(virStoragePoolPtr pool,\n                       char **const names,\n                       int maxnames)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int n = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolListVolumesEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    n = virStoragePoolObjVolumeGetNames(obj, pool->conn,\n                                        virStoragePoolListVolumesCheckACL,\n                                        names, maxnames);\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return n;\n}"
  },
  {
    "function_name": "storagePoolNumOfVolumes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1435-1461",
    "snippet": "static int\nstoragePoolNumOfVolumes(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolNumOfVolumesEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    ret = virStoragePoolObjNumOfVolumes(obj, pool->conn,\n                                        virStoragePoolNumOfVolumesCheckACL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1459
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjNumOfVolumes",
          "args": [
            "obj",
            "pool->conn",
            "virStoragePoolNumOfVolumesCheckACL"
          ],
          "line": 1455
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjNumOfVolumes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "887-901",
          "snippet": "int\nvirStoragePoolObjNumOfVolumes(virStoragePoolObjPtr obj,\n                              virConnectPtr conn,\n                              virStoragePoolVolumeACLFilter filter)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    struct _virStorageVolObjCountData data = {\n        .conn = conn, .filter = filter, .pooldef = obj->def, .count = 0 };\n\n    virObjectRWLockRead(volumes);\n    virHashForEach(volumes->objsName, virStoragePoolObjNumOfVolumesCb, &data);\n    virObjectRWUnlock(volumes);\n\n    return data.count;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjNumOfVolumes(virStoragePoolObjPtr obj,\n                              virConnectPtr conn,\n                              virStoragePoolVolumeACLFilter filter)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    struct _virStorageVolObjCountData data = {\n        .conn = conn, .filter = filter, .pooldef = obj->def, .count = 0 };\n\n    virObjectRWLockRead(volumes);\n    virHashForEach(volumes->objsName, virStoragePoolObjNumOfVolumesCb, &data);\n    virObjectRWUnlock(volumes);\n\n    return data.count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is not active\")",
            "def->name"
          ],
          "line": 1450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"storage pool '%s' is not active\""
          ],
          "line": 1451
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1449
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolNumOfVolumesEnsureACL",
          "args": [
            "pool->conn",
            "def"
          ],
          "line": 1446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1444
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFromStoragePool",
          "args": [
            "pool"
          ],
          "line": 1442
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFromStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "474-478",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolNumOfVolumes(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolNumOfVolumesEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    ret = virStoragePoolObjNumOfVolumes(obj, pool->conn,\n                                        virStoragePoolNumOfVolumesCheckACL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "storagePoolSetAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1372-1432",
    "snippet": "static int\nstoragePoolSetAutostart(virStoragePoolPtr pool,\n                        int autostart)\n{\n    virStoragePoolObjPtr obj;\n    const char *configFile;\n    const char *autostartLink;\n    bool new_autostart;\n    bool cur_autostart;\n    int ret = -1;\n\n    if (!(obj = storagePoolObjFindByUUID(pool->uuid, pool->name)))\n        goto cleanup;\n\n    if (virStoragePoolSetAutostartEnsureACL(pool->conn,\n                                            virStoragePoolObjGetDef(obj)) < 0)\n        goto cleanup;\n\n    if (!(configFile = virStoragePoolObjGetConfigFile(obj))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"pool has no config file\"));\n        goto cleanup;\n    }\n\n    autostartLink = virStoragePoolObjGetAutostartLink(obj);\n\n    new_autostart = (autostart != 0);\n    cur_autostart = virStoragePoolObjIsAutostart(obj);\n    if (cur_autostart != new_autostart) {\n        if (new_autostart) {\n            if (virFileMakePath(driver->autostartDir) < 0) {\n                virReportSystemError(errno,\n                                     _(\"cannot create autostart directory %s\"),\n                                     driver->autostartDir);\n                goto cleanup;\n            }\n\n            if (symlink(configFile, autostartLink) < 0) {\n                virReportSystemError(errno,\n                                     _(\"Failed to create symlink '%s' to '%s'\"),\n                                     autostartLink, configFile);\n                goto cleanup;\n            }\n        } else {\n            if (autostartLink && unlink(autostartLink) < 0 &&\n                errno != ENOENT && errno != ENOTDIR) {\n                virReportSystemError(errno,\n                                     _(\"Failed to delete symlink '%s'\"),\n                                     autostartLink);\n                goto cleanup;\n            }\n        }\n        virStoragePoolObjSetAutostart(obj, new_autostart);\n    }\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1430
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjSetAutostart",
          "args": [
            "obj",
            "new_autostart"
          ],
          "line": 1424
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjSetAutostart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "341-346",
          "snippet": "void\nvirStoragePoolObjSetAutostart(virStoragePoolObjPtr obj,\n                              bool autostart)\n{\n    obj->autostart = autostart;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjSetAutostart(virStoragePoolObjPtr obj,\n                              bool autostart)\n{\n    obj->autostart = autostart;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to delete symlink '%s'\")",
            "autostartLink"
          ],
          "line": 1418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to delete symlink '%s'\""
          ],
          "line": 1419
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "autostartLink"
          ],
          "line": 1416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to create symlink '%s' to '%s'\")",
            "autostartLink",
            "configFile"
          ],
          "line": 1410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "symlink",
          "args": [
            "configFile",
            "autostartLink"
          ],
          "line": 1409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot create autostart directory %s\")",
            "driver->autostartDir"
          ],
          "line": 1403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileMakePath",
          "args": [
            "driver->autostartDir"
          ],
          "line": 1402
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3076-3080",
          "snippet": "int\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsAutostart",
          "args": [
            "obj"
          ],
          "line": 1399
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsAutostart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "331-338",
          "snippet": "bool\nvirStoragePoolObjIsAutostart(virStoragePoolObjPtr obj)\n{\n    if (!obj->configFile)\n        return 0;\n\n    return obj->autostart;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsAutostart(virStoragePoolObjPtr obj)\n{\n    if (!obj->configFile)\n        return 0;\n\n    return obj->autostart;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetAutostartLink",
          "args": [
            "obj"
          ],
          "line": 1396
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetAutostartLink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "294-298",
          "snippet": "const char *\nvirStoragePoolObjGetAutostartLink(virStoragePoolObjPtr obj)\n{\n    return obj->autostartLink;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nconst char *\nvirStoragePoolObjGetAutostartLink(virStoragePoolObjPtr obj)\n{\n    return obj->autostartLink;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"pool has no config file\")"
          ],
          "line": 1391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetConfigFile",
          "args": [
            "obj"
          ],
          "line": 1390
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetConfigFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "278-282",
          "snippet": "const char *\nvirStoragePoolObjGetConfigFile(virStoragePoolObjPtr obj)\n{\n    return obj->configFile;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nconst char *\nvirStoragePoolObjGetConfigFile(virStoragePoolObjPtr obj)\n{\n    return obj->configFile;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolSetAutostartEnsureACL",
          "args": [
            "pool->conn",
            "virStoragePoolObjGetDef(obj)"
          ],
          "line": 1386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1387
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storagePoolObjFindByUUID",
          "args": [
            "pool->uuid",
            "pool->name"
          ],
          "line": 1383
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolObjFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "451-471",
          "snippet": "static virStoragePoolObjPtr\nstoragePoolObjFindByUUID(const unsigned char *uuid,\n                         const char *name)\n{\n    virStoragePoolObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virStoragePoolObjFindByUUID(driver->pools, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        if (name)\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s' (%s)\"),\n                           uuidstr, name);\n        else\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s'\"),\n                           uuidstr);\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStoragePoolObjPtr\nstoragePoolObjFindByUUID(const unsigned char *uuid,\n                         const char *name)\n{\n    virStoragePoolObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virStoragePoolObjFindByUUID(driver->pools, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        if (name)\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s' (%s)\"),\n                           uuidstr, name);\n        else\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s'\"),\n                           uuidstr);\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstoragePoolSetAutostart(virStoragePoolPtr pool,\n                        int autostart)\n{\n    virStoragePoolObjPtr obj;\n    const char *configFile;\n    const char *autostartLink;\n    bool new_autostart;\n    bool cur_autostart;\n    int ret = -1;\n\n    if (!(obj = storagePoolObjFindByUUID(pool->uuid, pool->name)))\n        goto cleanup;\n\n    if (virStoragePoolSetAutostartEnsureACL(pool->conn,\n                                            virStoragePoolObjGetDef(obj)) < 0)\n        goto cleanup;\n\n    if (!(configFile = virStoragePoolObjGetConfigFile(obj))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"pool has no config file\"));\n        goto cleanup;\n    }\n\n    autostartLink = virStoragePoolObjGetAutostartLink(obj);\n\n    new_autostart = (autostart != 0);\n    cur_autostart = virStoragePoolObjIsAutostart(obj);\n    if (cur_autostart != new_autostart) {\n        if (new_autostart) {\n            if (virFileMakePath(driver->autostartDir) < 0) {\n                virReportSystemError(errno,\n                                     _(\"cannot create autostart directory %s\"),\n                                     driver->autostartDir);\n                goto cleanup;\n            }\n\n            if (symlink(configFile, autostartLink) < 0) {\n                virReportSystemError(errno,\n                                     _(\"Failed to create symlink '%s' to '%s'\"),\n                                     autostartLink, configFile);\n                goto cleanup;\n            }\n        } else {\n            if (autostartLink && unlink(autostartLink) < 0 &&\n                errno != ENOENT && errno != ENOTDIR) {\n                virReportSystemError(errno,\n                                     _(\"Failed to delete symlink '%s'\"),\n                                     autostartLink);\n                goto cleanup;\n            }\n        }\n        virStoragePoolObjSetAutostart(obj, new_autostart);\n    }\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "storagePoolGetAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1349-1370",
    "snippet": "static int\nstoragePoolGetAutostart(virStoragePoolPtr pool,\n                        int *autostart)\n{\n    virStoragePoolObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n\n    if (virStoragePoolGetAutostartEnsureACL(pool->conn,\n                                            virStoragePoolObjGetDef(obj)) < 0)\n        goto cleanup;\n\n    *autostart = virStoragePoolObjIsAutostart(obj) ? 1 : 0;\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1368
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsAutostart",
          "args": [
            "obj"
          ],
          "line": 1363
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsAutostart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "331-338",
          "snippet": "bool\nvirStoragePoolObjIsAutostart(virStoragePoolObjPtr obj)\n{\n    if (!obj->configFile)\n        return 0;\n\n    return obj->autostart;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsAutostart(virStoragePoolObjPtr obj)\n{\n    if (!obj->configFile)\n        return 0;\n\n    return obj->autostart;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolGetAutostartEnsureACL",
          "args": [
            "pool->conn",
            "virStoragePoolObjGetDef(obj)"
          ],
          "line": 1359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1360
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFromStoragePool",
          "args": [
            "pool"
          ],
          "line": 1356
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFromStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "474-478",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolGetAutostart(virStoragePoolPtr pool,\n                        int *autostart)\n{\n    virStoragePoolObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n\n    if (virStoragePoolGetAutostartEnsureACL(pool->conn,\n                                            virStoragePoolObjGetDef(obj)) < 0)\n        goto cleanup;\n\n    *autostart = virStoragePoolObjIsAutostart(obj) ? 1 : 0;\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "storagePoolGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1317-1347",
    "snippet": "static char *\nstoragePoolGetXMLDesc(virStoragePoolPtr pool,\n                      unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolDefPtr newDef;\n    virStoragePoolDefPtr curDef;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_STORAGE_XML_INACTIVE, NULL);\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n    newDef = virStoragePoolObjGetNewDef(obj);\n\n    if (virStoragePoolGetXMLDescEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((flags & VIR_STORAGE_XML_INACTIVE) && newDef)\n        curDef = newDef;\n    else\n        curDef = def;\n\n    ret = virStoragePoolDefFormat(curDef);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1345
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolDefFormat",
          "args": [
            "curDef"
          ],
          "line": 1342
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1225-1238",
          "snippet": "char *\nvirStoragePoolDefFormat(virStoragePoolDefPtr def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virStoragePoolDefFormatBuf(&buf, def) < 0)\n        goto error;\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nvirStoragePoolDefFormat(virStoragePoolDefPtr def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virStoragePoolDefFormatBuf(&buf, def) < 0)\n        goto error;\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolGetXMLDescEnsureACL",
          "args": [
            "pool->conn",
            "def"
          ],
          "line": 1334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetNewDef",
          "args": [
            "obj"
          ],
          "line": 1332
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetNewDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "262-266",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetNewDef(virStoragePoolObjPtr obj)\n{\n    return obj->newDef;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetNewDef(virStoragePoolObjPtr obj)\n{\n    return obj->newDef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1331
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFromStoragePool",
          "args": [
            "pool"
          ],
          "line": 1329
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFromStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "474-478",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_STORAGE_XML_INACTIVE",
            "NULL"
          ],
          "line": 1327
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *\nstoragePoolGetXMLDesc(virStoragePoolPtr pool,\n                      unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolDefPtr newDef;\n    virStoragePoolDefPtr curDef;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_STORAGE_XML_INACTIVE, NULL);\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n    newDef = virStoragePoolObjGetNewDef(obj);\n\n    if (virStoragePoolGetXMLDescEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((flags & VIR_STORAGE_XML_INACTIVE) && newDef)\n        curDef = newDef;\n    else\n        curDef = def;\n\n    ret = virStoragePoolDefFormat(curDef);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "storagePoolGetInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1284-1315",
    "snippet": "static int\nstoragePoolGetInfo(virStoragePoolPtr pool,\n                   virStoragePoolInfoPtr info)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolGetInfoEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (virStorageBackendForType(def->type) == NULL)\n        goto cleanup;\n\n    memset(info, 0, sizeof(virStoragePoolInfo));\n    if (virStoragePoolObjIsActive(obj))\n        info->state = VIR_STORAGE_POOL_RUNNING;\n    else\n        info->state = VIR_STORAGE_POOL_INACTIVE;\n    info->capacity = def->capacity;\n    info->allocation = def->allocation;\n    info->available = def->available;\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1313
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1303
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "info",
            "0",
            "sizeof(virStoragePoolInfo)"
          ],
          "line": 1302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageBackendForType",
          "args": [
            "def->type"
          ],
          "line": 1299
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendForType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
          "lines": "172-184",
          "snippet": "virStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}",
          "includes": [
            "# include \"storage_backend_vstorage.h\"",
            "# include \"storage_backend_zfs.h\"",
            "# include \"storage_backend_gluster.h\"",
            "# include \"storage_backend_sheepdog.h\"",
            "# include \"storage_backend_rbd.h\"",
            "# include \"storage_backend_fs.h\"",
            "# include \"storage_backend_disk.h\"",
            "# include \"storage_backend_mpath.h\"",
            "# include \"storage_backend_scsi.h\"",
            "# include \"storage_backend_iscsi_direct.h\"",
            "# include \"storage_backend_iscsi.h\"",
            "# include \"storage_backend_logical.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
            "static size_t virStorageBackendsCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolGetInfoEnsureACL",
          "args": [
            "pool->conn",
            "def"
          ],
          "line": 1296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1294
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFromStoragePool",
          "args": [
            "pool"
          ],
          "line": 1292
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFromStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "474-478",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolGetInfo(virStoragePoolPtr pool,\n                   virStoragePoolInfoPtr info)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolGetInfoEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (virStorageBackendForType(def->type) == NULL)\n        goto cleanup;\n\n    memset(info, 0, sizeof(virStoragePoolInfo));\n    if (virStoragePoolObjIsActive(obj))\n        info->state = VIR_STORAGE_POOL_RUNNING;\n    else\n        info->state = VIR_STORAGE_POOL_INACTIVE;\n    info->capacity = def->capacity;\n    info->allocation = def->allocation;\n    info->available = def->available;\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "storagePoolRefresh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1217-1281",
    "snippet": "static int\nstoragePoolRefresh(virStoragePoolPtr pool,\n                   unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    g_autofree char *stateFile = NULL;\n    int ret = -1;\n    virObjectEventPtr event = NULL;\n\n    virCheckFlags(0, -1);\n\n    if (!(obj = storagePoolObjFindByUUID(pool->uuid, pool->name)))\n        goto cleanup;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolRefreshEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"pool '%s' has asynchronous jobs running.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\");\n    if (storagePoolRefreshImpl(backend, obj, stateFile) < 0) {\n        event = virStoragePoolEventLifecycleNew(def->name,\n                                                def->uuid,\n                                                VIR_STORAGE_POOL_EVENT_STOPPED,\n                                                0);\n        virStoragePoolObjSetActive(obj, false);\n\n        virStoragePoolUpdateInactive(obj);\n\n        goto cleanup;\n    }\n\n    event = virStoragePoolEventRefreshNew(def->name,\n                                          def->uuid);\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1279
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->storageEventState",
            "event"
          ],
          "line": 1278
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolEventRefreshNew",
          "args": [
            "def->name",
            "def->uuid"
          ],
          "line": 1273
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolEventRefreshNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
          "lines": "279-297",
          "snippet": "virObjectEventPtr\nvirStoragePoolEventRefreshNew(const char *name,\n                              const unsigned char *uuid)\n{\n    virStoragePoolEventRefreshPtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventRefreshClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_REFRESH,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    return (virObjectEventPtr)event;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"storage_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virStoragePoolEventRefreshClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolEventRefreshClass;\n\nvirObjectEventPtr\nvirStoragePoolEventRefreshNew(const char *name,\n                              const unsigned char *uuid)\n{\n    virStoragePoolEventRefreshPtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventRefreshClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_REFRESH,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    return (virObjectEventPtr)event;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolUpdateInactive",
          "args": [
            "obj"
          ],
          "line": 1268
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolUpdateInactive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "120-128",
          "snippet": "static void\nvirStoragePoolUpdateInactive(virStoragePoolObjPtr obj)\n{\n    if (!virStoragePoolObjGetConfigFile(obj)) {\n        virStoragePoolObjRemove(driver->pools, obj);\n    } else if (virStoragePoolObjGetNewDef(obj)) {\n        virStoragePoolObjDefUseNewDef(obj);\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void\nvirStoragePoolUpdateInactive(virStoragePoolObjPtr obj)\n{\n    if (!virStoragePoolObjGetConfigFile(obj)) {\n        virStoragePoolObjRemove(driver->pools, obj);\n    } else if (virStoragePoolObjGetNewDef(obj)) {\n        virStoragePoolObjDefUseNewDef(obj);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjSetActive",
          "args": [
            "obj",
            "false"
          ],
          "line": 1266
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjSetActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "308-313",
          "snippet": "void\nvirStoragePoolObjSetActive(virStoragePoolObjPtr obj,\n                           bool active)\n{\n    obj->active = active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjSetActive(virStoragePoolObjPtr obj,\n                           bool active)\n{\n    obj->active = active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolEventLifecycleNew",
          "args": [
            "def->name",
            "def->uuid",
            "VIR_STORAGE_POOL_EVENT_STOPPED",
            "0"
          ],
          "line": 1262
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolEventLifecycleNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
          "lines": "246-269",
          "snippet": "virObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"storage_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virStoragePoolEventLifecycleClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolEventLifecycleClass;\n\nvirObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storagePoolRefreshImpl",
          "args": [
            "backend",
            "obj",
            "stateFile"
          ],
          "line": 1261
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolRefreshImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "97-109",
          "snippet": "static int\nstoragePoolRefreshImpl(virStorageBackendPtr backend,\n                       virStoragePoolObjPtr obj,\n                       const char *stateFile)\n{\n    virStoragePoolObjClearVols(obj);\n    if (backend->refreshPool(obj) < 0) {\n        storagePoolRefreshFailCleanup(backend, obj, stateFile);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolRefreshImpl(virStorageBackendPtr backend,\n                       virStoragePoolObjPtr obj,\n                       const char *stateFile)\n{\n    virStoragePoolObjClearVols(obj);\n    if (backend->refreshPool(obj) < 0) {\n        storagePoolRefreshFailCleanup(backend, obj, stateFile);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileBuildPath",
          "args": [
            "driver->stateDir",
            "def->name",
            "\".xml\""
          ],
          "line": 1260
        },
        "resolved": true,
        "details": {
          "function_name": "virFileBuildPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3116-3128",
          "snippet": "char *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"pool '%s' has asynchronous jobs running.\")",
            "def->name"
          ],
          "line": 1254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"pool '%s' has asynchronous jobs running.\""
          ],
          "line": 1255
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetAsyncjobs",
          "args": [
            "obj"
          ],
          "line": 1253
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetAsyncjobs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "349-353",
          "snippet": "unsigned int\nvirStoragePoolObjGetAsyncjobs(virStoragePoolObjPtr obj)\n{\n    return obj->asyncjobs;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nunsigned int\nvirStoragePoolObjGetAsyncjobs(virStoragePoolObjPtr obj)\n{\n    return obj->asyncjobs;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is starting up\")",
            "def->name"
          ],
          "line": 1247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsStarting",
          "args": [
            "obj"
          ],
          "line": 1246
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsStarting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "324-328",
          "snippet": "bool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is not active\")",
            "def->name"
          ],
          "line": 1241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1240
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageBackendForType",
          "args": [
            "def->type"
          ],
          "line": 1237
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendForType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
          "lines": "172-184",
          "snippet": "virStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}",
          "includes": [
            "# include \"storage_backend_vstorage.h\"",
            "# include \"storage_backend_zfs.h\"",
            "# include \"storage_backend_gluster.h\"",
            "# include \"storage_backend_sheepdog.h\"",
            "# include \"storage_backend_rbd.h\"",
            "# include \"storage_backend_fs.h\"",
            "# include \"storage_backend_disk.h\"",
            "# include \"storage_backend_mpath.h\"",
            "# include \"storage_backend_scsi.h\"",
            "# include \"storage_backend_iscsi_direct.h\"",
            "# include \"storage_backend_iscsi.h\"",
            "# include \"storage_backend_logical.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
            "static size_t virStorageBackendsCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolRefreshEnsureACL",
          "args": [
            "pool->conn",
            "def"
          ],
          "line": 1234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1232
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storagePoolObjFindByUUID",
          "args": [
            "pool->uuid",
            "pool->name"
          ],
          "line": 1230
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolObjFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "451-471",
          "snippet": "static virStoragePoolObjPtr\nstoragePoolObjFindByUUID(const unsigned char *uuid,\n                         const char *name)\n{\n    virStoragePoolObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virStoragePoolObjFindByUUID(driver->pools, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        if (name)\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s' (%s)\"),\n                           uuidstr, name);\n        else\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s'\"),\n                           uuidstr);\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStoragePoolObjPtr\nstoragePoolObjFindByUUID(const unsigned char *uuid,\n                         const char *name)\n{\n    virStoragePoolObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virStoragePoolObjFindByUUID(driver->pools, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        if (name)\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s' (%s)\"),\n                           uuidstr, name);\n        else\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s'\"),\n                           uuidstr);\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1228
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstoragePoolRefresh(virStoragePoolPtr pool,\n                   unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    g_autofree char *stateFile = NULL;\n    int ret = -1;\n    virObjectEventPtr event = NULL;\n\n    virCheckFlags(0, -1);\n\n    if (!(obj = storagePoolObjFindByUUID(pool->uuid, pool->name)))\n        goto cleanup;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolRefreshEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"pool '%s' has asynchronous jobs running.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\");\n    if (storagePoolRefreshImpl(backend, obj, stateFile) < 0) {\n        event = virStoragePoolEventLifecycleNew(def->name,\n                                                def->uuid,\n                                                VIR_STORAGE_POOL_EVENT_STOPPED,\n                                                0);\n        virStoragePoolObjSetActive(obj, false);\n\n        virStoragePoolUpdateInactive(obj);\n\n        goto cleanup;\n    }\n\n    event = virStoragePoolEventRefreshNew(def->name,\n                                          def->uuid);\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "storagePoolDelete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1146-1214",
    "snippet": "static int\nstoragePoolDelete(virStoragePoolPtr pool,\n                  unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    g_autofree char *stateFile = NULL;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolDeleteEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    VIR_INFO(\"Deleting storage pool '%s'\", def->name);\n\n    if (virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is still active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"pool '%s' has asynchronous jobs running.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (!(stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\")))\n        goto cleanup;\n\n    unlink(stateFile);\n\n    if (!backend->deletePool) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"pool does not support pool deletion\"));\n        goto cleanup;\n    }\n    if (backend->deletePool(obj, flags) < 0)\n        goto cleanup;\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_DELETED,\n                                            0);\n\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1212
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->storageEventState",
            "event"
          ],
          "line": 1211
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolEventLifecycleNew",
          "args": [
            "def->name",
            "def->uuid",
            "VIR_STORAGE_POOL_EVENT_DELETED",
            "0"
          ],
          "line": 1203
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolEventLifecycleNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
          "lines": "246-269",
          "snippet": "virObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"storage_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virStoragePoolEventLifecycleClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolEventLifecycleClass;\n\nvirObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->deletePool",
          "args": [
            "obj",
            "flags"
          ],
          "line": 1200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_SUPPORT",
            "\"%s\"",
            "_(\"pool does not support pool deletion\")"
          ],
          "line": 1196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"pool does not support pool deletion\""
          ],
          "line": 1197
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "stateFile"
          ],
          "line": 1193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileBuildPath",
          "args": [
            "driver->stateDir",
            "def->name",
            "\".xml\""
          ],
          "line": 1190
        },
        "resolved": true,
        "details": {
          "function_name": "virFileBuildPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3116-3128",
          "snippet": "char *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"pool '%s' has asynchronous jobs running.\")",
            "def->name"
          ],
          "line": 1184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetAsyncjobs",
          "args": [
            "obj"
          ],
          "line": 1183
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetAsyncjobs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "349-353",
          "snippet": "unsigned int\nvirStoragePoolObjGetAsyncjobs(virStoragePoolObjPtr obj)\n{\n    return obj->asyncjobs;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nunsigned int\nvirStoragePoolObjGetAsyncjobs(virStoragePoolObjPtr obj)\n{\n    return obj->asyncjobs;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is starting up\")",
            "def->name"
          ],
          "line": 1177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsStarting",
          "args": [
            "obj"
          ],
          "line": 1176
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsStarting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "324-328",
          "snippet": "bool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is still active\")",
            "def->name"
          ],
          "line": 1170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1169
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Deleting storage pool '%s'\"",
            "def->name"
          ],
          "line": 1167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageBackendForType",
          "args": [
            "def->type"
          ],
          "line": 1164
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendForType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
          "lines": "172-184",
          "snippet": "virStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}",
          "includes": [
            "# include \"storage_backend_vstorage.h\"",
            "# include \"storage_backend_zfs.h\"",
            "# include \"storage_backend_gluster.h\"",
            "# include \"storage_backend_sheepdog.h\"",
            "# include \"storage_backend_rbd.h\"",
            "# include \"storage_backend_fs.h\"",
            "# include \"storage_backend_disk.h\"",
            "# include \"storage_backend_mpath.h\"",
            "# include \"storage_backend_scsi.h\"",
            "# include \"storage_backend_iscsi_direct.h\"",
            "# include \"storage_backend_iscsi.h\"",
            "# include \"storage_backend_logical.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
            "static size_t virStorageBackendsCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolDeleteEnsureACL",
          "args": [
            "pool->conn",
            "def"
          ],
          "line": 1161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1159
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFromStoragePool",
          "args": [
            "pool"
          ],
          "line": 1157
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFromStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "474-478",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstoragePoolDelete(virStoragePoolPtr pool,\n                  unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    g_autofree char *stateFile = NULL;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolDeleteEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    VIR_INFO(\"Deleting storage pool '%s'\", def->name);\n\n    if (virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is still active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"pool '%s' has asynchronous jobs running.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (!(stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\")))\n        goto cleanup;\n\n    unlink(stateFile);\n\n    if (!backend->deletePool) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"pool does not support pool deletion\"));\n        goto cleanup;\n    }\n    if (backend->deletePool(obj, flags) < 0)\n        goto cleanup;\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_DELETED,\n                                            0);\n\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "storagePoolDestroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1076-1144",
    "snippet": "static int\nstoragePoolDestroy(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    g_autofree char *stateFile = NULL;\n\n    if (!(obj = storagePoolObjFindByUUID(pool->uuid, pool->name)))\n        goto cleanup;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolDestroyEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    VIR_INFO(\"Destroying storage pool '%s'\", def->name);\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"pool '%s' has asynchronous jobs running.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (!(stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\")))\n        goto cleanup;\n\n    unlink(stateFile);\n\n    if (backend->stopPool &&\n        backend->stopPool(obj) < 0)\n        goto cleanup;\n\n    virStoragePoolObjClearVols(obj);\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_STOPPED,\n                                            0);\n\n    virStoragePoolObjSetActive(obj, false);\n\n    virStoragePoolUpdateInactive(obj);\n\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1142
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->storageEventState",
            "event"
          ],
          "line": 1141
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolUpdateInactive",
          "args": [
            "obj"
          ],
          "line": 1136
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolUpdateInactive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "120-128",
          "snippet": "static void\nvirStoragePoolUpdateInactive(virStoragePoolObjPtr obj)\n{\n    if (!virStoragePoolObjGetConfigFile(obj)) {\n        virStoragePoolObjRemove(driver->pools, obj);\n    } else if (virStoragePoolObjGetNewDef(obj)) {\n        virStoragePoolObjDefUseNewDef(obj);\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void\nvirStoragePoolUpdateInactive(virStoragePoolObjPtr obj)\n{\n    if (!virStoragePoolObjGetConfigFile(obj)) {\n        virStoragePoolObjRemove(driver->pools, obj);\n    } else if (virStoragePoolObjGetNewDef(obj)) {\n        virStoragePoolObjDefUseNewDef(obj);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjSetActive",
          "args": [
            "obj",
            "false"
          ],
          "line": 1134
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjSetActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "308-313",
          "snippet": "void\nvirStoragePoolObjSetActive(virStoragePoolObjPtr obj,\n                           bool active)\n{\n    obj->active = active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjSetActive(virStoragePoolObjPtr obj,\n                           bool active)\n{\n    obj->active = active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolEventLifecycleNew",
          "args": [
            "def->name",
            "def->uuid",
            "VIR_STORAGE_POOL_EVENT_STOPPED",
            "0"
          ],
          "line": 1129
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolEventLifecycleNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
          "lines": "246-269",
          "snippet": "virObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"storage_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virStoragePoolEventLifecycleClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolEventLifecycleClass;\n\nvirObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjClearVols",
          "args": [
            "obj"
          ],
          "line": 1127
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjClearVols",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "629-638",
          "snippet": "void\nvirStoragePoolObjClearVols(virStoragePoolObjPtr obj)\n{\n    if (!obj->volumes)\n        return;\n\n    virHashRemoveAll(obj->volumes->objsKey);\n    virHashRemoveAll(obj->volumes->objsName);\n    virHashRemoveAll(obj->volumes->objsPath);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjClearVols(virStoragePoolObjPtr obj)\n{\n    if (!obj->volumes)\n        return;\n\n    virHashRemoveAll(obj->volumes->objsKey);\n    virHashRemoveAll(obj->volumes->objsName);\n    virHashRemoveAll(obj->volumes->objsPath);\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->stopPool",
          "args": [
            "obj"
          ],
          "line": 1124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "stateFile"
          ],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileBuildPath",
          "args": [
            "driver->stateDir",
            "def->name",
            "\".xml\""
          ],
          "line": 1118
        },
        "resolved": true,
        "details": {
          "function_name": "virFileBuildPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3116-3128",
          "snippet": "char *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"pool '%s' has asynchronous jobs running.\")",
            "def->name"
          ],
          "line": 1112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"pool '%s' has asynchronous jobs running.\""
          ],
          "line": 1113
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetAsyncjobs",
          "args": [
            "obj"
          ],
          "line": 1111
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetAsyncjobs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "349-353",
          "snippet": "unsigned int\nvirStoragePoolObjGetAsyncjobs(virStoragePoolObjPtr obj)\n{\n    return obj->asyncjobs;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nunsigned int\nvirStoragePoolObjGetAsyncjobs(virStoragePoolObjPtr obj)\n{\n    return obj->asyncjobs;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is starting up\")",
            "def->name"
          ],
          "line": 1105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsStarting",
          "args": [
            "obj"
          ],
          "line": 1104
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsStarting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "324-328",
          "snippet": "bool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is not active\")",
            "def->name"
          ],
          "line": 1099
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1098
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Destroying storage pool '%s'\"",
            "def->name"
          ],
          "line": 1096
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageBackendForType",
          "args": [
            "def->type"
          ],
          "line": 1093
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendForType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
          "lines": "172-184",
          "snippet": "virStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}",
          "includes": [
            "# include \"storage_backend_vstorage.h\"",
            "# include \"storage_backend_zfs.h\"",
            "# include \"storage_backend_gluster.h\"",
            "# include \"storage_backend_sheepdog.h\"",
            "# include \"storage_backend_rbd.h\"",
            "# include \"storage_backend_fs.h\"",
            "# include \"storage_backend_disk.h\"",
            "# include \"storage_backend_mpath.h\"",
            "# include \"storage_backend_scsi.h\"",
            "# include \"storage_backend_iscsi_direct.h\"",
            "# include \"storage_backend_iscsi.h\"",
            "# include \"storage_backend_logical.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
            "static size_t virStorageBackendsCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolDestroyEnsureACL",
          "args": [
            "pool->conn",
            "def"
          ],
          "line": 1090
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1088
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storagePoolObjFindByUUID",
          "args": [
            "pool->uuid",
            "pool->name"
          ],
          "line": 1086
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolObjFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "451-471",
          "snippet": "static virStoragePoolObjPtr\nstoragePoolObjFindByUUID(const unsigned char *uuid,\n                         const char *name)\n{\n    virStoragePoolObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virStoragePoolObjFindByUUID(driver->pools, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        if (name)\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s' (%s)\"),\n                           uuidstr, name);\n        else\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s'\"),\n                           uuidstr);\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStoragePoolObjPtr\nstoragePoolObjFindByUUID(const unsigned char *uuid,\n                         const char *name)\n{\n    virStoragePoolObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virStoragePoolObjFindByUUID(driver->pools, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        if (name)\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s' (%s)\"),\n                           uuidstr, name);\n        else\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s'\"),\n                           uuidstr);\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstoragePoolDestroy(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    g_autofree char *stateFile = NULL;\n\n    if (!(obj = storagePoolObjFindByUUID(pool->uuid, pool->name)))\n        goto cleanup;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolDestroyEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    VIR_INFO(\"Destroying storage pool '%s'\", def->name);\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"pool '%s' has asynchronous jobs running.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (!(stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\")))\n        goto cleanup;\n\n    unlink(stateFile);\n\n    if (backend->stopPool &&\n        backend->stopPool(obj) < 0)\n        goto cleanup;\n\n    virStoragePoolObjClearVols(obj);\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_STOPPED,\n                                            0);\n\n    virStoragePoolObjSetActive(obj, false);\n\n    virStoragePoolUpdateInactive(obj);\n\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "storagePoolBuild",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "1015-1073",
    "snippet": "static int\nstoragePoolBuild(virStoragePoolPtr pool,\n                 unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    bool restoreStarting = false;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolBuildEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    if (virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is already active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    virStoragePoolObjSetStarting(obj, true);\n    restoreStarting = true;\n\n    if (backend->buildPool &&\n        backend->buildPool(obj, flags) < 0)\n        goto cleanup;\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_CREATED,\n                                            0);\n\n    ret = 0;\n\n cleanup:\n    if (restoreStarting &&\n        virStoragePoolObjIsStarting(obj)) {\n        virStoragePoolUpdateInactive(obj);\n        virStoragePoolObjSetStarting(obj, false);\n    }\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1071
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->storageEventState",
            "event"
          ],
          "line": 1070
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjSetStarting",
          "args": [
            "obj",
            "false"
          ],
          "line": 1068
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjSetStarting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "316-321",
          "snippet": "void\nvirStoragePoolObjSetStarting(virStoragePoolObjPtr obj,\n                             bool starting)\n{\n    obj->starting = starting;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjSetStarting(virStoragePoolObjPtr obj,\n                             bool starting)\n{\n    obj->starting = starting;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolUpdateInactive",
          "args": [
            "obj"
          ],
          "line": 1067
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolUpdateInactive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "120-128",
          "snippet": "static void\nvirStoragePoolUpdateInactive(virStoragePoolObjPtr obj)\n{\n    if (!virStoragePoolObjGetConfigFile(obj)) {\n        virStoragePoolObjRemove(driver->pools, obj);\n    } else if (virStoragePoolObjGetNewDef(obj)) {\n        virStoragePoolObjDefUseNewDef(obj);\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void\nvirStoragePoolUpdateInactive(virStoragePoolObjPtr obj)\n{\n    if (!virStoragePoolObjGetConfigFile(obj)) {\n        virStoragePoolObjRemove(driver->pools, obj);\n    } else if (virStoragePoolObjGetNewDef(obj)) {\n        virStoragePoolObjDefUseNewDef(obj);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsStarting",
          "args": [
            "obj"
          ],
          "line": 1066
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsStarting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "324-328",
          "snippet": "bool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolEventLifecycleNew",
          "args": [
            "def->name",
            "def->uuid",
            "VIR_STORAGE_POOL_EVENT_CREATED",
            "0"
          ],
          "line": 1057
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolEventLifecycleNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
          "lines": "246-269",
          "snippet": "virObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"storage_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virStoragePoolEventLifecycleClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolEventLifecycleClass;\n\nvirObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->buildPool",
          "args": [
            "obj",
            "flags"
          ],
          "line": 1054
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is starting up\")",
            "def->name"
          ],
          "line": 1044
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"storage pool '%s' is starting up\""
          ],
          "line": 1045
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is already active\")",
            "def->name"
          ],
          "line": 1037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1036
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageBackendForType",
          "args": [
            "def->type"
          ],
          "line": 1033
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendForType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
          "lines": "172-184",
          "snippet": "virStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}",
          "includes": [
            "# include \"storage_backend_vstorage.h\"",
            "# include \"storage_backend_zfs.h\"",
            "# include \"storage_backend_gluster.h\"",
            "# include \"storage_backend_sheepdog.h\"",
            "# include \"storage_backend_rbd.h\"",
            "# include \"storage_backend_fs.h\"",
            "# include \"storage_backend_disk.h\"",
            "# include \"storage_backend_mpath.h\"",
            "# include \"storage_backend_scsi.h\"",
            "# include \"storage_backend_iscsi_direct.h\"",
            "# include \"storage_backend_iscsi.h\"",
            "# include \"storage_backend_logical.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
            "static size_t virStorageBackendsCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolBuildEnsureACL",
          "args": [
            "pool->conn",
            "def"
          ],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 1028
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFromStoragePool",
          "args": [
            "pool"
          ],
          "line": 1026
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFromStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "474-478",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstoragePoolBuild(virStoragePoolPtr pool,\n                 unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    bool restoreStarting = false;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolBuildEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    if (virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is already active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    virStoragePoolObjSetStarting(obj, true);\n    restoreStarting = true;\n\n    if (backend->buildPool &&\n        backend->buildPool(obj, flags) < 0)\n        goto cleanup;\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_CREATED,\n                                            0);\n\n    ret = 0;\n\n cleanup:\n    if (restoreStarting &&\n        virStoragePoolObjIsStarting(obj)) {\n        virStoragePoolUpdateInactive(obj);\n        virStoragePoolObjSetStarting(obj, false);\n    }\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "storagePoolCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "922-1013",
    "snippet": "static int\nstoragePoolCreate(virStoragePoolPtr pool,\n                  unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    unsigned int build_flags = 0;\n    g_autofree char *stateFile = NULL;\n    bool restoreStarting = false;\n\n    virCheckFlags(VIR_STORAGE_POOL_CREATE_WITH_BUILD |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE, -1);\n\n    VIR_EXCLUSIVE_FLAGS_RET(VIR_STORAGE_POOL_BUILD_OVERWRITE,\n                            VIR_STORAGE_POOL_BUILD_NO_OVERWRITE, -1);\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolCreateEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    if (virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is already active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    virStoragePoolObjSetStarting(obj, true);\n    restoreStarting = true;\n\n    if (backend->buildPool) {\n        if (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE)\n            build_flags |= VIR_STORAGE_POOL_BUILD_OVERWRITE;\n        else if (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE)\n            build_flags |= VIR_STORAGE_POOL_BUILD_NO_OVERWRITE;\n\n        if (build_flags ||\n            (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD)) {\n            if (backend->buildPool(obj, build_flags) < 0)\n                goto cleanup;\n        }\n    }\n\n    VIR_INFO(\"Starting up storage pool '%s'\", def->name);\n    if (backend->startPool &&\n        backend->startPool(obj) < 0)\n        goto cleanup;\n\n    stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\");\n\n    if (!stateFile ||\n        virStoragePoolSaveState(stateFile, def) < 0 ||\n        storagePoolRefreshImpl(backend, obj, stateFile) < 0) {\n        goto cleanup;\n    }\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_STARTED,\n                                            0);\n\n    virStoragePoolObjSetActive(obj, true);\n    ret = 0;\n\n cleanup:\n    if (restoreStarting &&\n        virStoragePoolObjIsStarting(obj)) {\n        if (!virStoragePoolObjIsActive(obj))\n            virStoragePoolUpdateInactive(obj);\n        virStoragePoolObjSetStarting(obj, false);\n    }\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1011
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->storageEventState",
            "event"
          ],
          "line": 1010
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjSetStarting",
          "args": [
            "obj",
            "false"
          ],
          "line": 1008
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjSetStarting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "316-321",
          "snippet": "void\nvirStoragePoolObjSetStarting(virStoragePoolObjPtr obj,\n                             bool starting)\n{\n    obj->starting = starting;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjSetStarting(virStoragePoolObjPtr obj,\n                             bool starting)\n{\n    obj->starting = starting;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolUpdateInactive",
          "args": [
            "obj"
          ],
          "line": 1007
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolUpdateInactive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "120-128",
          "snippet": "static void\nvirStoragePoolUpdateInactive(virStoragePoolObjPtr obj)\n{\n    if (!virStoragePoolObjGetConfigFile(obj)) {\n        virStoragePoolObjRemove(driver->pools, obj);\n    } else if (virStoragePoolObjGetNewDef(obj)) {\n        virStoragePoolObjDefUseNewDef(obj);\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void\nvirStoragePoolUpdateInactive(virStoragePoolObjPtr obj)\n{\n    if (!virStoragePoolObjGetConfigFile(obj)) {\n        virStoragePoolObjRemove(driver->pools, obj);\n    } else if (virStoragePoolObjGetNewDef(obj)) {\n        virStoragePoolObjDefUseNewDef(obj);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1006
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsStarting",
          "args": [
            "obj"
          ],
          "line": 1005
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsStarting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "324-328",
          "snippet": "bool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjSetActive",
          "args": [
            "obj",
            "true"
          ],
          "line": 1000
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjSetActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "308-313",
          "snippet": "void\nvirStoragePoolObjSetActive(virStoragePoolObjPtr obj,\n                           bool active)\n{\n    obj->active = active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjSetActive(virStoragePoolObjPtr obj,\n                           bool active)\n{\n    obj->active = active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolEventLifecycleNew",
          "args": [
            "def->name",
            "def->uuid",
            "VIR_STORAGE_POOL_EVENT_STARTED",
            "0"
          ],
          "line": 995
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolEventLifecycleNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
          "lines": "246-269",
          "snippet": "virObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"storage_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virStoragePoolEventLifecycleClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolEventLifecycleClass;\n\nvirObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storagePoolRefreshImpl",
          "args": [
            "backend",
            "obj",
            "stateFile"
          ],
          "line": 991
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolRefreshImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "97-109",
          "snippet": "static int\nstoragePoolRefreshImpl(virStorageBackendPtr backend,\n                       virStoragePoolObjPtr obj,\n                       const char *stateFile)\n{\n    virStoragePoolObjClearVols(obj);\n    if (backend->refreshPool(obj) < 0) {\n        storagePoolRefreshFailCleanup(backend, obj, stateFile);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolRefreshImpl(virStorageBackendPtr backend,\n                       virStoragePoolObjPtr obj,\n                       const char *stateFile)\n{\n    virStoragePoolObjClearVols(obj);\n    if (backend->refreshPool(obj) < 0) {\n        storagePoolRefreshFailCleanup(backend, obj, stateFile);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolSaveState",
          "args": [
            "stateFile",
            "def"
          ],
          "line": 990
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolSaveState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1687-1710",
          "snippet": "int\nvirStoragePoolSaveState(const char *stateFile,\n                        virStoragePoolDefPtr def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    g_autofree char *xml = NULL;\n\n    virBufferAddLit(&buf, \"<poolstate>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virStoragePoolDefFormatBuf(&buf, def) < 0)\n        return -1;\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</poolstate>\\n\");\n\n    if (!(xml = virBufferContentAndReset(&buf)))\n        return -1;\n\n    if (virStoragePoolSaveXML(stateFile, def, xml))\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirStoragePoolSaveState(const char *stateFile,\n                        virStoragePoolDefPtr def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    g_autofree char *xml = NULL;\n\n    virBufferAddLit(&buf, \"<poolstate>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virStoragePoolDefFormatBuf(&buf, def) < 0)\n        return -1;\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</poolstate>\\n\");\n\n    if (!(xml = virBufferContentAndReset(&buf)))\n        return -1;\n\n    if (virStoragePoolSaveXML(stateFile, def, xml))\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileBuildPath",
          "args": [
            "driver->stateDir",
            "def->name",
            "\".xml\""
          ],
          "line": 987
        },
        "resolved": true,
        "details": {
          "function_name": "virFileBuildPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3116-3128",
          "snippet": "char *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->startPool",
          "args": [
            "obj"
          ],
          "line": 984
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Starting up storage pool '%s'\"",
            "def->name"
          ],
          "line": 982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "backend->buildPool",
          "args": [
            "obj",
            "build_flags"
          ],
          "line": 977
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is starting up\")",
            "def->name"
          ],
          "line": 960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"storage pool '%s' is starting up\""
          ],
          "line": 961
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is already active\")",
            "def->name"
          ],
          "line": 953
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageBackendForType",
          "args": [
            "def->type"
          ],
          "line": 949
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendForType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
          "lines": "172-184",
          "snippet": "virStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}",
          "includes": [
            "# include \"storage_backend_vstorage.h\"",
            "# include \"storage_backend_zfs.h\"",
            "# include \"storage_backend_gluster.h\"",
            "# include \"storage_backend_sheepdog.h\"",
            "# include \"storage_backend_rbd.h\"",
            "# include \"storage_backend_fs.h\"",
            "# include \"storage_backend_disk.h\"",
            "# include \"storage_backend_mpath.h\"",
            "# include \"storage_backend_scsi.h\"",
            "# include \"storage_backend_iscsi_direct.h\"",
            "# include \"storage_backend_iscsi.h\"",
            "# include \"storage_backend_logical.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
            "static size_t virStorageBackendsCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolCreateEnsureACL",
          "args": [
            "pool->conn",
            "def"
          ],
          "line": 946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 944
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFromStoragePool",
          "args": [
            "pool"
          ],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFromStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "474-478",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_RET",
          "args": [
            "VIR_STORAGE_POOL_BUILD_OVERWRITE",
            "VIR_STORAGE_POOL_BUILD_NO_OVERWRITE",
            "-1"
          ],
          "line": 939
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_STORAGE_POOL_CREATE_WITH_BUILD |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE",
            "-1"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstoragePoolCreate(virStoragePoolPtr pool,\n                  unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    unsigned int build_flags = 0;\n    g_autofree char *stateFile = NULL;\n    bool restoreStarting = false;\n\n    virCheckFlags(VIR_STORAGE_POOL_CREATE_WITH_BUILD |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE, -1);\n\n    VIR_EXCLUSIVE_FLAGS_RET(VIR_STORAGE_POOL_BUILD_OVERWRITE,\n                            VIR_STORAGE_POOL_BUILD_NO_OVERWRITE, -1);\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolCreateEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    if (virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is already active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    virStoragePoolObjSetStarting(obj, true);\n    restoreStarting = true;\n\n    if (backend->buildPool) {\n        if (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE)\n            build_flags |= VIR_STORAGE_POOL_BUILD_OVERWRITE;\n        else if (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE)\n            build_flags |= VIR_STORAGE_POOL_BUILD_NO_OVERWRITE;\n\n        if (build_flags ||\n            (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD)) {\n            if (backend->buildPool(obj, build_flags) < 0)\n                goto cleanup;\n        }\n    }\n\n    VIR_INFO(\"Starting up storage pool '%s'\", def->name);\n    if (backend->startPool &&\n        backend->startPool(obj) < 0)\n        goto cleanup;\n\n    stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\");\n\n    if (!stateFile ||\n        virStoragePoolSaveState(stateFile, def) < 0 ||\n        storagePoolRefreshImpl(backend, obj, stateFile) < 0) {\n        goto cleanup;\n    }\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_STARTED,\n                                            0);\n\n    virStoragePoolObjSetActive(obj, true);\n    ret = 0;\n\n cleanup:\n    if (restoreStarting &&\n        virStoragePoolObjIsStarting(obj)) {\n        if (!virStoragePoolObjIsActive(obj))\n            virStoragePoolUpdateInactive(obj);\n        virStoragePoolObjSetStarting(obj, false);\n    }\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "storagePoolUndefine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "860-920",
    "snippet": "static int\nstoragePoolUndefine(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    const char *autostartLink;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n\n    if (!(obj = storagePoolObjFindByUUID(pool->uuid, pool->name)))\n        goto cleanup;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolUndefineEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is still active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"pool '%s' has asynchronous jobs running.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    autostartLink = virStoragePoolObjGetAutostartLink(obj);\n    if (virStoragePoolObjDeleteDef(obj) < 0)\n        goto cleanup;\n\n    if (autostartLink && unlink(autostartLink) < 0 &&\n        errno != ENOENT && errno != ENOTDIR) {\n        VIR_ERROR(_(\"Failed to delete autostart link '%s': %s\"),\n                  autostartLink, g_strerror(errno));\n    }\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_UNDEFINED,\n                                            0);\n\n    VIR_INFO(\"Undefining storage pool '%s'\", def->name);\n    virStoragePoolObjRemove(driver->pools, obj);\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 918
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->storageEventState",
            "event"
          ],
          "line": 917
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjRemove",
          "args": [
            "driver->pools",
            "obj"
          ],
          "line": 913
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjRemoveVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "682-708",
          "snippet": "void\nvirStoragePoolObjRemoveVol(virStoragePoolObjPtr obj,\n                           virStorageVolDefPtr voldef)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockWrite(volumes);\n    volobj = virHashLookup(volumes->objsName, voldef->name);\n    if (!volobj) {\n        VIR_INFO(\"Cannot find volume '%s' from storage pool '%s'\",\n                 voldef->name, obj->def->name);\n        virObjectRWUnlock(volumes);\n        return;\n    }\n    VIR_INFO(\"Deleting volume '%s' from storage pool '%s'\",\n             voldef->name, obj->def->name);\n\n    virObjectRef(volobj);\n    virObjectLock(volobj);\n    virHashRemoveEntry(volumes->objsKey, voldef->key);\n    virHashRemoveEntry(volumes->objsName, voldef->name);\n    virHashRemoveEntry(volumes->objsPath, voldef->target.path);\n    virStorageVolObjEndAPI(&volobj);\n\n    virObjectRWUnlock(volumes);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjRemoveVol(virStoragePoolObjPtr obj,\n                           virStorageVolDefPtr voldef)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockWrite(volumes);\n    volobj = virHashLookup(volumes->objsName, voldef->name);\n    if (!volobj) {\n        VIR_INFO(\"Cannot find volume '%s' from storage pool '%s'\",\n                 voldef->name, obj->def->name);\n        virObjectRWUnlock(volumes);\n        return;\n    }\n    VIR_INFO(\"Deleting volume '%s' from storage pool '%s'\",\n             voldef->name, obj->def->name);\n\n    virObjectRef(volobj);\n    virObjectLock(volobj);\n    virHashRemoveEntry(volumes->objsKey, voldef->key);\n    virHashRemoveEntry(volumes->objsName, voldef->name);\n    virHashRemoveEntry(volumes->objsPath, voldef->target.path);\n    virStorageVolObjEndAPI(&volobj);\n\n    virObjectRWUnlock(volumes);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Undefining storage pool '%s'\"",
            "def->name"
          ],
          "line": 912
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolEventLifecycleNew",
          "args": [
            "def->name",
            "def->uuid",
            "VIR_STORAGE_POOL_EVENT_UNDEFINED",
            "0"
          ],
          "line": 907
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolEventLifecycleNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
          "lines": "246-269",
          "snippet": "virObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"storage_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virStoragePoolEventLifecycleClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolEventLifecycleClass;\n\nvirObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Failed to delete autostart link '%s': %s\")",
            "autostartLink",
            "g_strerror(errno)"
          ],
          "line": 903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strerror",
          "args": [
            "errno"
          ],
          "line": 904
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to delete autostart link '%s': %s\""
          ],
          "line": 903
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "autostartLink"
          ],
          "line": 901
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjDeleteDef",
          "args": [
            "obj"
          ],
          "line": 898
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjDeleteDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1807-1824",
          "snippet": "int\nvirStoragePoolObjDeleteDef(virStoragePoolObjPtr obj)\n{\n    if (!obj->configFile) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"no config file for %s\"), obj->def->name);\n        return -1;\n    }\n\n    if (unlink(obj->configFile) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot remove config for %s\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjDeleteDef(virStoragePoolObjPtr obj)\n{\n    if (!obj->configFile) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"no config file for %s\"), obj->def->name);\n        return -1;\n    }\n\n    if (unlink(obj->configFile) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot remove config for %s\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetAutostartLink",
          "args": [
            "obj"
          ],
          "line": 897
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetAutostartLink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "294-298",
          "snippet": "const char *\nvirStoragePoolObjGetAutostartLink(virStoragePoolObjPtr obj)\n{\n    return obj->autostartLink;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nconst char *\nvirStoragePoolObjGetAutostartLink(virStoragePoolObjPtr obj)\n{\n    return obj->autostartLink;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"pool '%s' has asynchronous jobs running.\")",
            "def->name"
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetAsyncjobs",
          "args": [
            "obj"
          ],
          "line": 890
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetAsyncjobs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "349-353",
          "snippet": "unsigned int\nvirStoragePoolObjGetAsyncjobs(virStoragePoolObjPtr obj)\n{\n    return obj->asyncjobs;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nunsigned int\nvirStoragePoolObjGetAsyncjobs(virStoragePoolObjPtr obj)\n{\n    return obj->asyncjobs;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is starting up\")",
            "def->name"
          ],
          "line": 884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsStarting",
          "args": [
            "obj"
          ],
          "line": 883
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsStarting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "324-328",
          "snippet": "bool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"storage pool '%s' is still active\")",
            "def->name"
          ],
          "line": 877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 876
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolUndefineEnsureACL",
          "args": [
            "pool->conn",
            "def"
          ],
          "line": 873
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 871
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storagePoolObjFindByUUID",
          "args": [
            "pool->uuid",
            "pool->name"
          ],
          "line": 869
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolObjFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "451-471",
          "snippet": "static virStoragePoolObjPtr\nstoragePoolObjFindByUUID(const unsigned char *uuid,\n                         const char *name)\n{\n    virStoragePoolObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virStoragePoolObjFindByUUID(driver->pools, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        if (name)\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s' (%s)\"),\n                           uuidstr, name);\n        else\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s'\"),\n                           uuidstr);\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStoragePoolObjPtr\nstoragePoolObjFindByUUID(const unsigned char *uuid,\n                         const char *name)\n{\n    virStoragePoolObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virStoragePoolObjFindByUUID(driver->pools, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        if (name)\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s' (%s)\"),\n                           uuidstr, name);\n        else\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s'\"),\n                           uuidstr);\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstoragePoolUndefine(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    const char *autostartLink;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n\n    if (!(obj = storagePoolObjFindByUUID(pool->uuid, pool->name)))\n        goto cleanup;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolUndefineEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is still active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"pool '%s' has asynchronous jobs running.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    autostartLink = virStoragePoolObjGetAutostartLink(obj);\n    if (virStoragePoolObjDeleteDef(obj) < 0)\n        goto cleanup;\n\n    if (autostartLink && unlink(autostartLink) < 0 &&\n        errno != ENOENT && errno != ENOTDIR) {\n        VIR_ERROR(_(\"Failed to delete autostart link '%s': %s\"),\n                  autostartLink, g_strerror(errno));\n    }\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_UNDEFINED,\n                                            0);\n\n    VIR_INFO(\"Undefining storage pool '%s'\", def->name);\n    virStoragePoolObjRemove(driver->pools, obj);\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "storagePoolDefineXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "810-858",
    "snippet": "static virStoragePoolPtr\nstoragePoolDefineXML(virConnectPtr conn,\n                     const char *xml,\n                     unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n    virObjectEventPtr event = NULL;\n    g_autoptr(virStoragePoolDef) newDef = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!(newDef = virStoragePoolDefParseString(xml)))\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", newDef->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (virStoragePoolDefineXMLEnsureACL(conn, newDef) < 0)\n        goto cleanup;\n\n    if (virStorageBackendForType(newDef->type) == NULL)\n        goto cleanup;\n\n    if (!(obj = virStoragePoolObjListAdd(driver->pools, newDef, 0)))\n        goto cleanup;\n    newDef = virStoragePoolObjGetNewDef(obj);\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolObjSaveDef(driver, obj, newDef ? newDef : def) < 0) {\n        virStoragePoolObjRemove(driver->pools, obj);\n        newDef = NULL;\n        goto cleanup;\n    }\n\n    event = virStoragePoolEventLifecycleNew(def->name, def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_DEFINED,\n                                            0);\n\n    VIR_INFO(\"Defining storage pool '%s'\", def->name);\n    pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n    newDef = NULL;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 856
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->storageEventState",
            "event"
          ],
          "line": 855
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetStoragePool",
          "args": [
            "conn",
            "def->name",
            "def->uuid",
            "NULL",
            "NULL"
          ],
          "line": 851
        },
        "resolved": true,
        "details": {
          "function_name": "virGetStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "525-556",
          "snippet": "virStoragePoolPtr\nvirGetStoragePool(virConnectPtr conn, const char *name,\n                  const unsigned char *uuid,\n                  void *privateData, virFreeCallback freeFunc)\n{\n    virStoragePoolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virStoragePoolClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    /* set the driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virStoragePoolClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virStoragePoolClass;\n\nvirStoragePoolPtr\nvirGetStoragePool(virConnectPtr conn, const char *name,\n                  const unsigned char *uuid,\n                  void *privateData, virFreeCallback freeFunc)\n{\n    virStoragePoolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virStoragePoolClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    /* set the driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Defining storage pool '%s'\"",
            "def->name"
          ],
          "line": 850
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolEventLifecycleNew",
          "args": [
            "def->name",
            "def->uuid",
            "VIR_STORAGE_POOL_EVENT_DEFINED",
            "0"
          ],
          "line": 846
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolEventLifecycleNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
          "lines": "246-269",
          "snippet": "virObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"storage_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virStoragePoolEventLifecycleClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolEventLifecycleClass;\n\nvirObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjRemove",
          "args": [
            "driver->pools",
            "obj"
          ],
          "line": 841
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjRemoveVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "682-708",
          "snippet": "void\nvirStoragePoolObjRemoveVol(virStoragePoolObjPtr obj,\n                           virStorageVolDefPtr voldef)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockWrite(volumes);\n    volobj = virHashLookup(volumes->objsName, voldef->name);\n    if (!volobj) {\n        VIR_INFO(\"Cannot find volume '%s' from storage pool '%s'\",\n                 voldef->name, obj->def->name);\n        virObjectRWUnlock(volumes);\n        return;\n    }\n    VIR_INFO(\"Deleting volume '%s' from storage pool '%s'\",\n             voldef->name, obj->def->name);\n\n    virObjectRef(volobj);\n    virObjectLock(volobj);\n    virHashRemoveEntry(volumes->objsKey, voldef->key);\n    virHashRemoveEntry(volumes->objsName, voldef->name);\n    virHashRemoveEntry(volumes->objsPath, voldef->target.path);\n    virStorageVolObjEndAPI(&volobj);\n\n    virObjectRWUnlock(volumes);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjRemoveVol(virStoragePoolObjPtr obj,\n                           virStorageVolDefPtr voldef)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockWrite(volumes);\n    volobj = virHashLookup(volumes->objsName, voldef->name);\n    if (!volobj) {\n        VIR_INFO(\"Cannot find volume '%s' from storage pool '%s'\",\n                 voldef->name, obj->def->name);\n        virObjectRWUnlock(volumes);\n        return;\n    }\n    VIR_INFO(\"Deleting volume '%s' from storage pool '%s'\",\n             voldef->name, obj->def->name);\n\n    virObjectRef(volobj);\n    virObjectLock(volobj);\n    virHashRemoveEntry(volumes->objsKey, voldef->key);\n    virHashRemoveEntry(volumes->objsName, voldef->name);\n    virHashRemoveEntry(volumes->objsPath, voldef->target.path);\n    virStorageVolObjEndAPI(&volobj);\n\n    virObjectRWUnlock(volumes);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjSaveDef",
          "args": [
            "driver",
            "obj",
            "newDef ? newDef : def"
          ],
          "line": 840
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjSaveDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1778-1804",
          "snippet": "int\nvirStoragePoolObjSaveDef(virStorageDriverStatePtr driver,\n                         virStoragePoolObjPtr obj,\n                         virStoragePoolDefPtr def)\n{\n    if (!obj->configFile) {\n        if (virFileMakePath(driver->configDir) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot create config directory %s\"),\n                                 driver->configDir);\n            return -1;\n        }\n\n        if (!(obj->configFile = virFileBuildPath(driver->configDir,\n                                                 def->name, \".xml\"))) {\n            return -1;\n        }\n\n        if (!(obj->autostartLink = virFileBuildPath(driver->autostartDir,\n                                                    def->name, \".xml\"))) {\n            VIR_FREE(obj->configFile);\n            return -1;\n        }\n    }\n\n    return virStoragePoolSaveConfig(obj->configFile, def);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjSaveDef(virStorageDriverStatePtr driver,\n                         virStoragePoolObjPtr obj,\n                         virStoragePoolDefPtr def)\n{\n    if (!obj->configFile) {\n        if (virFileMakePath(driver->configDir) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot create config directory %s\"),\n                                 driver->configDir);\n            return -1;\n        }\n\n        if (!(obj->configFile = virFileBuildPath(driver->configDir,\n                                                 def->name, \".xml\"))) {\n            return -1;\n        }\n\n        if (!(obj->autostartLink = virFileBuildPath(driver->autostartDir,\n                                                    def->name, \".xml\"))) {\n            VIR_FREE(obj->configFile);\n            return -1;\n        }\n    }\n\n    return virStoragePoolSaveConfig(obj->configFile, def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 838
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetNewDef",
          "args": [
            "obj"
          ],
          "line": 837
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetNewDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "262-266",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetNewDef(virStoragePoolObjPtr obj)\n{\n    return obj->newDef;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetNewDef(virStoragePoolObjPtr obj)\n{\n    return obj->newDef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjListAdd",
          "args": [
            "driver->pools",
            "newDef",
            "0"
          ],
          "line": 835
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjListAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1565-1612",
          "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjListAdd(virStoragePoolObjListPtr pools,\n                         virStoragePoolDefPtr def,\n                         unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    int rc;\n\n    virObjectRWLockWrite(pools);\n\n    if (virStoragePoolObjSourceFindDuplicate(pools, def) < 0)\n        goto error;\n\n    rc = virStoragePoolObjIsDuplicate(pools, def,\n                                      !!(flags & VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE),\n                                      &obj);\n\n    if (rc < 0)\n        goto error;\n    if (rc > 0) {\n        virStoragePoolObjAssignDef(obj, def, flags);\n        virObjectRWUnlock(pools);\n        return obj;\n    }\n\n    if (!(obj = virStoragePoolObjNew()))\n        goto error;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    if (virHashAddEntry(pools->objs, uuidstr, obj) < 0)\n        goto error;\n    virObjectRef(obj);\n\n    if (virHashAddEntry(pools->objsName, def->name, obj) < 0) {\n        virHashRemoveEntry(pools->objs, uuidstr);\n        goto error;\n    }\n    virObjectRef(obj);\n    obj->def = def;\n    virObjectRWUnlock(pools);\n    return obj;\n\n error:\n    virStoragePoolObjEndAPI(&obj);\n    virObjectRWUnlock(pools);\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolObjPtr\nvirStoragePoolObjListAdd(virStoragePoolObjListPtr pools,\n                         virStoragePoolDefPtr def,\n                         unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    int rc;\n\n    virObjectRWLockWrite(pools);\n\n    if (virStoragePoolObjSourceFindDuplicate(pools, def) < 0)\n        goto error;\n\n    rc = virStoragePoolObjIsDuplicate(pools, def,\n                                      !!(flags & VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE),\n                                      &obj);\n\n    if (rc < 0)\n        goto error;\n    if (rc > 0) {\n        virStoragePoolObjAssignDef(obj, def, flags);\n        virObjectRWUnlock(pools);\n        return obj;\n    }\n\n    if (!(obj = virStoragePoolObjNew()))\n        goto error;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    if (virHashAddEntry(pools->objs, uuidstr, obj) < 0)\n        goto error;\n    virObjectRef(obj);\n\n    if (virHashAddEntry(pools->objsName, def->name, obj) < 0) {\n        virHashRemoveEntry(pools->objs, uuidstr);\n        goto error;\n    }\n    virObjectRef(obj);\n    obj->def = def;\n    virObjectRWUnlock(pools);\n    return obj;\n\n error:\n    virStoragePoolObjEndAPI(&obj);\n    virObjectRWUnlock(pools);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageBackendForType",
          "args": [
            "newDef->type"
          ],
          "line": 832
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendForType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
          "lines": "172-184",
          "snippet": "virStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}",
          "includes": [
            "# include \"storage_backend_vstorage.h\"",
            "# include \"storage_backend_zfs.h\"",
            "# include \"storage_backend_gluster.h\"",
            "# include \"storage_backend_sheepdog.h\"",
            "# include \"storage_backend_rbd.h\"",
            "# include \"storage_backend_fs.h\"",
            "# include \"storage_backend_disk.h\"",
            "# include \"storage_backend_mpath.h\"",
            "# include \"storage_backend_scsi.h\"",
            "# include \"storage_backend_iscsi_direct.h\"",
            "# include \"storage_backend_iscsi.h\"",
            "# include \"storage_backend_logical.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
            "static size_t virStorageBackendsCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolDefineXMLEnsureACL",
          "args": [
            "conn",
            "newDef"
          ],
          "line": 829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLCheckIllegalChars",
          "args": [
            "\"name\"",
            "newDef->name",
            "\"\\n\""
          ],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLCheckIllegalChars",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "490-502",
          "snippet": "int\nvirXMLCheckIllegalChars(const char *nodeName,\n                        const char *str,\n                        const char *illegal)\n{\n    char *c;\n    if ((c = strpbrk(str, illegal))) {\n        virReportError(VIR_ERR_XML_DETAIL,\n                       _(\"invalid char in %s: %c\"), nodeName, *c);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXMLCheckIllegalChars(const char *nodeName,\n                        const char *str,\n                        const char *illegal)\n{\n    char *c;\n    if ((c = strpbrk(str, illegal))) {\n        virReportError(VIR_ERR_XML_DETAIL,\n                       _(\"invalid char in %s: %c\"), nodeName, *c);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolDefParseString",
          "args": [
            "xml"
          ],
          "line": 823
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1036-1040",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolDefParseString(const char *xmlStr)\n{\n    return virStoragePoolDefParse(xmlStr, NULL);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolDefParseString(const char *xmlStr)\n{\n    return virStoragePoolDefParse(xmlStr, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "NULL"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStoragePoolPtr\nstoragePoolDefineXML(virConnectPtr conn,\n                     const char *xml,\n                     unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n    virObjectEventPtr event = NULL;\n    g_autoptr(virStoragePoolDef) newDef = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!(newDef = virStoragePoolDefParseString(xml)))\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", newDef->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (virStoragePoolDefineXMLEnsureACL(conn, newDef) < 0)\n        goto cleanup;\n\n    if (virStorageBackendForType(newDef->type) == NULL)\n        goto cleanup;\n\n    if (!(obj = virStoragePoolObjListAdd(driver->pools, newDef, 0)))\n        goto cleanup;\n    newDef = virStoragePoolObjGetNewDef(obj);\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolObjSaveDef(driver, obj, newDef ? newDef : def) < 0) {\n        virStoragePoolObjRemove(driver->pools, obj);\n        newDef = NULL;\n        goto cleanup;\n    }\n\n    event = virStoragePoolEventLifecycleNew(def->name, def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_DEFINED,\n                                            0);\n\n    VIR_INFO(\"Defining storage pool '%s'\", def->name);\n    pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n    newDef = NULL;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n}"
  },
  {
    "function_name": "storagePoolCreateXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "721-808",
    "snippet": "static virStoragePoolPtr\nstoragePoolCreateXML(virConnectPtr conn,\n                     const char *xml,\n                     unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    unsigned int build_flags = 0;\n    g_autoptr(virStoragePoolDef) newDef = NULL;\n    g_autofree char *stateFile = NULL;\n\n    virCheckFlags(VIR_STORAGE_POOL_CREATE_WITH_BUILD |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE, NULL);\n\n    VIR_EXCLUSIVE_FLAGS_RET(VIR_STORAGE_POOL_BUILD_OVERWRITE,\n                            VIR_STORAGE_POOL_BUILD_NO_OVERWRITE, NULL);\n\n    if (!(newDef = virStoragePoolDefParseString(xml)))\n        goto cleanup;\n\n    if (virStoragePoolCreateXMLEnsureACL(conn, newDef) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(newDef->type)) == NULL)\n        goto cleanup;\n\n    if (!(obj = virStoragePoolObjListAdd(driver->pools, newDef,\n                                         VIR_STORAGE_POOL_OBJ_LIST_ADD_LIVE |\n                                         VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE)))\n        goto cleanup;\n    newDef = NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    virStoragePoolObjSetStarting(obj, true);\n\n    if (backend->buildPool) {\n        if (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE)\n            build_flags |= VIR_STORAGE_POOL_BUILD_OVERWRITE;\n        else if (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE)\n            build_flags |= VIR_STORAGE_POOL_BUILD_NO_OVERWRITE;\n\n        if (build_flags ||\n            (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD)) {\n            if (backend->buildPool(obj, build_flags) < 0)\n                goto error;\n        }\n    }\n\n    if (backend->startPool &&\n        backend->startPool(obj) < 0)\n        goto error;\n\n    stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\");\n\n    if (!stateFile ||\n        virStoragePoolSaveState(stateFile, def) < 0 ||\n        storagePoolRefreshImpl(backend, obj, stateFile) < 0) {\n        goto error;\n    }\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_STARTED,\n                                            0);\n\n    VIR_INFO(\"Creating storage pool '%s'\", def->name);\n    virStoragePoolObjSetActive(obj, true);\n\n    pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n\n cleanup:\n    if (obj && virStoragePoolObjIsStarting(obj)) {\n        if (!virStoragePoolObjIsActive(obj))\n            virStoragePoolUpdateInactive(obj);\n        virStoragePoolObjSetStarting(obj, false);\n    }\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n\n error:\n    virStoragePoolUpdateInactive(obj);\n    goto cleanup;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolUpdateInactive",
          "args": [
            "obj"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolUpdateInactive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "120-128",
          "snippet": "static void\nvirStoragePoolUpdateInactive(virStoragePoolObjPtr obj)\n{\n    if (!virStoragePoolObjGetConfigFile(obj)) {\n        virStoragePoolObjRemove(driver->pools, obj);\n    } else if (virStoragePoolObjGetNewDef(obj)) {\n        virStoragePoolObjDefUseNewDef(obj);\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void\nvirStoragePoolUpdateInactive(virStoragePoolObjPtr obj)\n{\n    if (!virStoragePoolObjGetConfigFile(obj)) {\n        virStoragePoolObjRemove(driver->pools, obj);\n    } else if (virStoragePoolObjGetNewDef(obj)) {\n        virStoragePoolObjDefUseNewDef(obj);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 802
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->storageEventState",
            "event"
          ],
          "line": 801
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjSetStarting",
          "args": [
            "obj",
            "false"
          ],
          "line": 799
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjSetStarting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "316-321",
          "snippet": "void\nvirStoragePoolObjSetStarting(virStoragePoolObjPtr obj,\n                             bool starting)\n{\n    obj->starting = starting;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjSetStarting(virStoragePoolObjPtr obj,\n                             bool starting)\n{\n    obj->starting = starting;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 797
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsStarting",
          "args": [
            "obj"
          ],
          "line": 796
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsStarting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "324-328",
          "snippet": "bool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetStoragePool",
          "args": [
            "conn",
            "def->name",
            "def->uuid",
            "NULL",
            "NULL"
          ],
          "line": 793
        },
        "resolved": true,
        "details": {
          "function_name": "virGetStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "525-556",
          "snippet": "virStoragePoolPtr\nvirGetStoragePool(virConnectPtr conn, const char *name,\n                  const unsigned char *uuid,\n                  void *privateData, virFreeCallback freeFunc)\n{\n    virStoragePoolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virStoragePoolClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    /* set the driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virStoragePoolClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virStoragePoolClass;\n\nvirStoragePoolPtr\nvirGetStoragePool(virConnectPtr conn, const char *name,\n                  const unsigned char *uuid,\n                  void *privateData, virFreeCallback freeFunc)\n{\n    virStoragePoolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virStoragePoolClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    /* set the driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjSetActive",
          "args": [
            "obj",
            "true"
          ],
          "line": 791
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjSetActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "308-313",
          "snippet": "void\nvirStoragePoolObjSetActive(virStoragePoolObjPtr obj,\n                           bool active)\n{\n    obj->active = active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjSetActive(virStoragePoolObjPtr obj,\n                           bool active)\n{\n    obj->active = active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Creating storage pool '%s'\"",
            "def->name"
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolEventLifecycleNew",
          "args": [
            "def->name",
            "def->uuid",
            "VIR_STORAGE_POOL_EVENT_STARTED",
            "0"
          ],
          "line": 785
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolEventLifecycleNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_event.c",
          "lines": "246-269",
          "snippet": "virObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"storage_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virStoragePoolEventLifecycleClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"storage_event.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolEventLifecycleClass;\n\nvirObjectEventPtr\nvirStoragePoolEventLifecycleNew(const char *name,\n                                const unsigned char *uuid,\n                                int type,\n                                int detail)\n{\n    virStoragePoolEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virStoragePoolEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virStoragePoolEventLifecycleClass,\n                                    virStoragePoolEventDispatchDefaultFunc,\n                                    VIR_STORAGE_POOL_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storagePoolRefreshImpl",
          "args": [
            "backend",
            "obj",
            "stateFile"
          ],
          "line": 781
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolRefreshImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "97-109",
          "snippet": "static int\nstoragePoolRefreshImpl(virStorageBackendPtr backend,\n                       virStoragePoolObjPtr obj,\n                       const char *stateFile)\n{\n    virStoragePoolObjClearVols(obj);\n    if (backend->refreshPool(obj) < 0) {\n        storagePoolRefreshFailCleanup(backend, obj, stateFile);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolRefreshImpl(virStorageBackendPtr backend,\n                       virStoragePoolObjPtr obj,\n                       const char *stateFile)\n{\n    virStoragePoolObjClearVols(obj);\n    if (backend->refreshPool(obj) < 0) {\n        storagePoolRefreshFailCleanup(backend, obj, stateFile);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolSaveState",
          "args": [
            "stateFile",
            "def"
          ],
          "line": 780
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolSaveState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1687-1710",
          "snippet": "int\nvirStoragePoolSaveState(const char *stateFile,\n                        virStoragePoolDefPtr def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    g_autofree char *xml = NULL;\n\n    virBufferAddLit(&buf, \"<poolstate>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virStoragePoolDefFormatBuf(&buf, def) < 0)\n        return -1;\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</poolstate>\\n\");\n\n    if (!(xml = virBufferContentAndReset(&buf)))\n        return -1;\n\n    if (virStoragePoolSaveXML(stateFile, def, xml))\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirStoragePoolSaveState(const char *stateFile,\n                        virStoragePoolDefPtr def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    g_autofree char *xml = NULL;\n\n    virBufferAddLit(&buf, \"<poolstate>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virStoragePoolDefFormatBuf(&buf, def) < 0)\n        return -1;\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</poolstate>\\n\");\n\n    if (!(xml = virBufferContentAndReset(&buf)))\n        return -1;\n\n    if (virStoragePoolSaveXML(stateFile, def, xml))\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileBuildPath",
          "args": [
            "driver->stateDir",
            "def->name",
            "\".xml\""
          ],
          "line": 777
        },
        "resolved": true,
        "details": {
          "function_name": "virFileBuildPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3116-3128",
          "snippet": "char *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->startPool",
          "args": [
            "obj"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "backend->buildPool",
          "args": [
            "obj",
            "build_flags"
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 756
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjListAdd",
          "args": [
            "driver->pools",
            "newDef",
            "VIR_STORAGE_POOL_OBJ_LIST_ADD_LIVE |\n                                         VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE"
          ],
          "line": 751
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjListAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1565-1612",
          "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjListAdd(virStoragePoolObjListPtr pools,\n                         virStoragePoolDefPtr def,\n                         unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    int rc;\n\n    virObjectRWLockWrite(pools);\n\n    if (virStoragePoolObjSourceFindDuplicate(pools, def) < 0)\n        goto error;\n\n    rc = virStoragePoolObjIsDuplicate(pools, def,\n                                      !!(flags & VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE),\n                                      &obj);\n\n    if (rc < 0)\n        goto error;\n    if (rc > 0) {\n        virStoragePoolObjAssignDef(obj, def, flags);\n        virObjectRWUnlock(pools);\n        return obj;\n    }\n\n    if (!(obj = virStoragePoolObjNew()))\n        goto error;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    if (virHashAddEntry(pools->objs, uuidstr, obj) < 0)\n        goto error;\n    virObjectRef(obj);\n\n    if (virHashAddEntry(pools->objsName, def->name, obj) < 0) {\n        virHashRemoveEntry(pools->objs, uuidstr);\n        goto error;\n    }\n    virObjectRef(obj);\n    obj->def = def;\n    virObjectRWUnlock(pools);\n    return obj;\n\n error:\n    virStoragePoolObjEndAPI(&obj);\n    virObjectRWUnlock(pools);\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolObjPtr\nvirStoragePoolObjListAdd(virStoragePoolObjListPtr pools,\n                         virStoragePoolDefPtr def,\n                         unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    int rc;\n\n    virObjectRWLockWrite(pools);\n\n    if (virStoragePoolObjSourceFindDuplicate(pools, def) < 0)\n        goto error;\n\n    rc = virStoragePoolObjIsDuplicate(pools, def,\n                                      !!(flags & VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE),\n                                      &obj);\n\n    if (rc < 0)\n        goto error;\n    if (rc > 0) {\n        virStoragePoolObjAssignDef(obj, def, flags);\n        virObjectRWUnlock(pools);\n        return obj;\n    }\n\n    if (!(obj = virStoragePoolObjNew()))\n        goto error;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    if (virHashAddEntry(pools->objs, uuidstr, obj) < 0)\n        goto error;\n    virObjectRef(obj);\n\n    if (virHashAddEntry(pools->objsName, def->name, obj) < 0) {\n        virHashRemoveEntry(pools->objs, uuidstr);\n        goto error;\n    }\n    virObjectRef(obj);\n    obj->def = def;\n    virObjectRWUnlock(pools);\n    return obj;\n\n error:\n    virStoragePoolObjEndAPI(&obj);\n    virObjectRWUnlock(pools);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageBackendForType",
          "args": [
            "newDef->type"
          ],
          "line": 748
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendForType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
          "lines": "172-184",
          "snippet": "virStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}",
          "includes": [
            "# include \"storage_backend_vstorage.h\"",
            "# include \"storage_backend_zfs.h\"",
            "# include \"storage_backend_gluster.h\"",
            "# include \"storage_backend_sheepdog.h\"",
            "# include \"storage_backend_rbd.h\"",
            "# include \"storage_backend_fs.h\"",
            "# include \"storage_backend_disk.h\"",
            "# include \"storage_backend_mpath.h\"",
            "# include \"storage_backend_scsi.h\"",
            "# include \"storage_backend_iscsi_direct.h\"",
            "# include \"storage_backend_iscsi.h\"",
            "# include \"storage_backend_logical.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
            "static size_t virStorageBackendsCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolCreateXMLEnsureACL",
          "args": [
            "conn",
            "newDef"
          ],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolDefParseString",
          "args": [
            "xml"
          ],
          "line": 742
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1036-1040",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolDefParseString(const char *xmlStr)\n{\n    return virStoragePoolDefParse(xmlStr, NULL);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolDefParseString(const char *xmlStr)\n{\n    return virStoragePoolDefParse(xmlStr, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_RET",
          "args": [
            "VIR_STORAGE_POOL_BUILD_OVERWRITE",
            "VIR_STORAGE_POOL_BUILD_NO_OVERWRITE",
            "NULL"
          ],
          "line": 739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_STORAGE_POOL_CREATE_WITH_BUILD |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE",
            "NULL"
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStoragePoolPtr\nstoragePoolCreateXML(virConnectPtr conn,\n                     const char *xml,\n                     unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    unsigned int build_flags = 0;\n    g_autoptr(virStoragePoolDef) newDef = NULL;\n    g_autofree char *stateFile = NULL;\n\n    virCheckFlags(VIR_STORAGE_POOL_CREATE_WITH_BUILD |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE, NULL);\n\n    VIR_EXCLUSIVE_FLAGS_RET(VIR_STORAGE_POOL_BUILD_OVERWRITE,\n                            VIR_STORAGE_POOL_BUILD_NO_OVERWRITE, NULL);\n\n    if (!(newDef = virStoragePoolDefParseString(xml)))\n        goto cleanup;\n\n    if (virStoragePoolCreateXMLEnsureACL(conn, newDef) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(newDef->type)) == NULL)\n        goto cleanup;\n\n    if (!(obj = virStoragePoolObjListAdd(driver->pools, newDef,\n                                         VIR_STORAGE_POOL_OBJ_LIST_ADD_LIVE |\n                                         VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE)))\n        goto cleanup;\n    newDef = NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    virStoragePoolObjSetStarting(obj, true);\n\n    if (backend->buildPool) {\n        if (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE)\n            build_flags |= VIR_STORAGE_POOL_BUILD_OVERWRITE;\n        else if (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE)\n            build_flags |= VIR_STORAGE_POOL_BUILD_NO_OVERWRITE;\n\n        if (build_flags ||\n            (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD)) {\n            if (backend->buildPool(obj, build_flags) < 0)\n                goto error;\n        }\n    }\n\n    if (backend->startPool &&\n        backend->startPool(obj) < 0)\n        goto error;\n\n    stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\");\n\n    if (!stateFile ||\n        virStoragePoolSaveState(stateFile, def) < 0 ||\n        storagePoolRefreshImpl(backend, obj, stateFile) < 0) {\n        goto error;\n    }\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_STARTED,\n                                            0);\n\n    VIR_INFO(\"Creating storage pool '%s'\", def->name);\n    virStoragePoolObjSetActive(obj, true);\n\n    pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n\n cleanup:\n    if (obj && virStoragePoolObjIsStarting(obj)) {\n        if (!virStoragePoolObjIsActive(obj))\n            virStoragePoolUpdateInactive(obj);\n        virStoragePoolObjSetStarting(obj, false);\n    }\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n\n error:\n    virStoragePoolUpdateInactive(obj);\n    goto cleanup;\n}"
  },
  {
    "function_name": "storagePoolIsPersistent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "699-718",
    "snippet": "static int\nstoragePoolIsPersistent(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolIsPersistentEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    ret = virStoragePoolObjGetConfigFile(obj) ? 1 : 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 716
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetConfigFile",
          "args": [
            "obj"
          ],
          "line": 713
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetConfigFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "278-282",
          "snippet": "const char *\nvirStoragePoolObjGetConfigFile(virStoragePoolObjPtr obj)\n{\n    return obj->configFile;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nconst char *\nvirStoragePoolObjGetConfigFile(virStoragePoolObjPtr obj)\n{\n    return obj->configFile;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolIsPersistentEnsureACL",
          "args": [
            "pool->conn",
            "def"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 708
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFromStoragePool",
          "args": [
            "pool"
          ],
          "line": 706
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFromStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "474-478",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolIsPersistent(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolIsPersistentEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    ret = virStoragePoolObjGetConfigFile(obj) ? 1 : 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "storagePoolIsActive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "677-696",
    "snippet": "static int\nstoragePoolIsActive(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolIsActiveEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    ret = virStoragePoolObjIsActive(obj);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 694
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 691
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolIsActiveEnsureACL",
          "args": [
            "pool->conn",
            "def"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 686
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFromStoragePool",
          "args": [
            "pool"
          ],
          "line": 684
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFromStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "474-478",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolIsActive(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolIsActiveEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    ret = virStoragePoolObjIsActive(obj);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "storageConnectGetStoragePoolCapabilities",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "655-674",
    "snippet": "static char *\nstorageConnectGetStoragePoolCapabilities(virConnectPtr conn,\n                                         unsigned int flags)\n{\n    virStoragePoolCapsPtr caps = NULL;\n    char *ret;\n\n    virCheckFlags(0, NULL);\n\n    if (virConnectGetStoragePoolCapabilitiesEnsureACL(conn) < 0)\n        return NULL;\n\n    if (!(caps = virStoragePoolCapsNew(driver->caps)))\n        return NULL;\n\n    ret = virStoragePoolCapsFormat(caps);\n\n    virObjectUnref(caps);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "caps"
          ],
          "line": 672
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolCapsFormat",
          "args": [
            "caps"
          ],
          "line": 670
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolCapsFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_capabilities.c",
          "lines": "117-135",
          "snippet": "char *\nvirStoragePoolCapsFormat(const virStoragePoolCaps *caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    size_t i;\n\n    virBufferAddLit(&buf, \"<storagepoolCapabilities>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n    for (i = 0; i < VIR_STORAGE_POOL_LAST; i++) {\n        if (virStoragePoolCapsFormatPool(&buf, i, caps) < 0) {\n            virBufferFreeAndReset(&buf);\n            return NULL;\n        }\n    }\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</storagepoolCapabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"capabilities.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"capabilities.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nchar *\nvirStoragePoolCapsFormat(const virStoragePoolCaps *caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    size_t i;\n\n    virBufferAddLit(&buf, \"<storagepoolCapabilities>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n    for (i = 0; i < VIR_STORAGE_POOL_LAST; i++) {\n        if (virStoragePoolCapsFormatPool(&buf, i, caps) < 0) {\n            virBufferFreeAndReset(&buf);\n            return NULL;\n        }\n    }\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</storagepoolCapabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolCapsNew",
          "args": [
            "driver->caps"
          ],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolCapsNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_capabilities.c",
          "lines": "58-72",
          "snippet": "virStoragePoolCapsPtr\nvirStoragePoolCapsNew(virCapsPtr driverCaps)\n{\n    virStoragePoolCapsPtr caps = NULL;\n\n    if (virStoragePoolCapsInitialize() < 0)\n        return NULL;\n\n    if (!(caps = virObjectLockableNew(virStoragePoolCapsClass)))\n        return NULL;\n\n    caps->driverCaps = virObjectRef(driverCaps);\n\n    return caps;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"capabilities.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virStoragePoolCapsClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"capabilities.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolCapsClass;\n\nvirStoragePoolCapsPtr\nvirStoragePoolCapsNew(virCapsPtr driverCaps)\n{\n    virStoragePoolCapsPtr caps = NULL;\n\n    if (virStoragePoolCapsInitialize() < 0)\n        return NULL;\n\n    if (!(caps = virObjectLockableNew(virStoragePoolCapsClass)))\n        return NULL;\n\n    caps->driverCaps = virObjectRef(driverCaps);\n\n    return caps;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectGetStoragePoolCapabilitiesEnsureACL",
          "args": [
            "conn"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "NULL"
          ],
          "line": 662
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic char *\nstorageConnectGetStoragePoolCapabilities(virConnectPtr conn,\n                                         unsigned int flags)\n{\n    virStoragePoolCapsPtr caps = NULL;\n    char *ret;\n\n    virCheckFlags(0, NULL);\n\n    if (virConnectGetStoragePoolCapabilitiesEnsureACL(conn) < 0)\n        return NULL;\n\n    if (!(caps = virStoragePoolCapsNew(driver->caps)))\n        return NULL;\n\n    ret = virStoragePoolCapsFormat(caps);\n\n    virObjectUnref(caps);\n    return ret;\n}"
  },
  {
    "function_name": "storageConnectFindStoragePoolSources",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "621-652",
    "snippet": "static char *\nstorageConnectFindStoragePoolSources(virConnectPtr conn,\n                                     const char *type,\n                                     const char *srcSpec,\n                                     unsigned int flags)\n{\n    int backend_type;\n    virStorageBackendPtr backend;\n\n    if (virConnectFindStoragePoolSourcesEnsureACL(conn) < 0)\n        return NULL;\n\n    backend_type = virStoragePoolTypeFromString(type);\n    if (backend_type < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unknown storage pool type %s\"), type);\n        return NULL;\n    }\n\n    backend = virStorageBackendForType(backend_type);\n    if (backend == NULL)\n        return NULL;\n\n    if (!backend->findPoolSources) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       _(\"pool type '%s' does not support source \"\n                         \"discovery\"), type);\n        return NULL;\n    }\n\n    return backend->findPoolSources(srcSpec, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "backend->findPoolSources",
          "args": [
            "srcSpec",
            "flags"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_SUPPORT",
            "_(\"pool type '%s' does not support source \"\n                         \"discovery\")",
            "type"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"pool type '%s' does not support source \"\n                         \"discovery\""
          ],
          "line": 646
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageBackendForType",
          "args": [
            "backend_type"
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendForType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
          "lines": "172-184",
          "snippet": "virStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}",
          "includes": [
            "# include \"storage_backend_vstorage.h\"",
            "# include \"storage_backend_zfs.h\"",
            "# include \"storage_backend_gluster.h\"",
            "# include \"storage_backend_sheepdog.h\"",
            "# include \"storage_backend_rbd.h\"",
            "# include \"storage_backend_fs.h\"",
            "# include \"storage_backend_disk.h\"",
            "# include \"storage_backend_mpath.h\"",
            "# include \"storage_backend_scsi.h\"",
            "# include \"storage_backend_iscsi_direct.h\"",
            "# include \"storage_backend_iscsi.h\"",
            "# include \"storage_backend_logical.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
            "static size_t virStorageBackendsCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unknown storage pool type %s\")",
            "type"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolTypeFromString",
          "args": [
            "type"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConnectFindStoragePoolSourcesEnsureACL",
          "args": [
            "conn"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *\nstorageConnectFindStoragePoolSources(virConnectPtr conn,\n                                     const char *type,\n                                     const char *srcSpec,\n                                     unsigned int flags)\n{\n    int backend_type;\n    virStorageBackendPtr backend;\n\n    if (virConnectFindStoragePoolSourcesEnsureACL(conn) < 0)\n        return NULL;\n\n    backend_type = virStoragePoolTypeFromString(type);\n    if (backend_type < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unknown storage pool type %s\"), type);\n        return NULL;\n    }\n\n    backend = virStorageBackendForType(backend_type);\n    if (backend == NULL)\n        return NULL;\n\n    if (!backend->findPoolSources) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       _(\"pool type '%s' does not support source \"\n                         \"discovery\"), type);\n        return NULL;\n    }\n\n    return backend->findPoolSources(srcSpec, flags);\n}"
  },
  {
    "function_name": "storageConnectListDefinedStoragePools",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "606-617",
    "snippet": "static int\nstorageConnectListDefinedStoragePools(virConnectPtr conn,\n                                      char **const names,\n                                      int maxnames)\n{\n    if (virConnectListDefinedStoragePoolsEnsureACL(conn) < 0)\n        return -1;\n\n    return virStoragePoolObjGetNames(driver->pools, conn, false,\n                                     virConnectListDefinedStoragePoolsCheckACL,\n                                     names, maxnames);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjGetNames",
          "args": [
            "driver->pools",
            "conn",
            "false",
            "virConnectListDefinedStoragePoolsCheckACL",
            "names",
            "maxnames"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetNames",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1920-1945",
          "snippet": "int\nvirStoragePoolObjGetNames(virStoragePoolObjListPtr pools,\n                          virConnectPtr conn,\n                          bool wantActive,\n                          virStoragePoolObjListACLFilter filter,\n                          char **const names,\n                          int maxnames)\n{\n    struct _virStoragePoolNameData data = {\n        .conn = conn, .filter = filter, .wantActive = wantActive,\n        .error = false, .nnames = 0, .maxnames = maxnames, .names = names };\n\n    virObjectRWLockRead(pools);\n    virHashForEach(pools->objs, virStoragePoolObjGetNamesCb, &data);\n    virObjectRWUnlock(pools);\n\n    if (data.error)\n        goto error;\n\n    return data.nnames;\n\n error:\n    while (data.nnames)\n        VIR_FREE(data.names[--data.nnames]);\n    return -1;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjGetNames(virStoragePoolObjListPtr pools,\n                          virConnectPtr conn,\n                          bool wantActive,\n                          virStoragePoolObjListACLFilter filter,\n                          char **const names,\n                          int maxnames)\n{\n    struct _virStoragePoolNameData data = {\n        .conn = conn, .filter = filter, .wantActive = wantActive,\n        .error = false, .nnames = 0, .maxnames = maxnames, .names = names };\n\n    virObjectRWLockRead(pools);\n    virHashForEach(pools->objs, virStoragePoolObjGetNamesCb, &data);\n    virObjectRWUnlock(pools);\n\n    if (data.error)\n        goto error;\n\n    return data.nnames;\n\n error:\n    while (data.nnames)\n        VIR_FREE(data.names[--data.nnames]);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectListDefinedStoragePoolsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstorageConnectListDefinedStoragePools(virConnectPtr conn,\n                                      char **const names,\n                                      int maxnames)\n{\n    if (virConnectListDefinedStoragePoolsEnsureACL(conn) < 0)\n        return -1;\n\n    return virStoragePoolObjGetNames(driver->pools, conn, false,\n                                     virConnectListDefinedStoragePoolsCheckACL,\n                                     names, maxnames);\n}"
  },
  {
    "function_name": "storageConnectNumOfDefinedStoragePools",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "595-603",
    "snippet": "static int\nstorageConnectNumOfDefinedStoragePools(virConnectPtr conn)\n{\n    if (virConnectNumOfDefinedStoragePoolsEnsureACL(conn) < 0)\n        return -1;\n\n    return virStoragePoolObjNumOfStoragePools(driver->pools, conn, false,\n                                               virConnectNumOfDefinedStoragePoolsCheckACL);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjNumOfStoragePools",
          "args": [
            "driver->pools",
            "conn",
            "false",
            "virConnectNumOfDefinedStoragePoolsCheckACL"
          ],
          "line": 601
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjNumOfStoragePools",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1859-1873",
          "snippet": "int\nvirStoragePoolObjNumOfStoragePools(virStoragePoolObjListPtr pools,\n                                   virConnectPtr conn,\n                                   bool wantActive,\n                                   virStoragePoolObjListACLFilter filter)\n{\n    struct _virStoragePoolCountData data = {\n        .conn = conn, .filter = filter, .wantActive = wantActive, .count = 0 };\n\n    virObjectRWLockRead(pools);\n    virHashForEach(pools->objs, virStoragePoolObjNumOfStoragePoolsCb, &data);\n    virObjectRWUnlock(pools);\n\n    return data.count;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjNumOfStoragePools(virStoragePoolObjListPtr pools,\n                                   virConnectPtr conn,\n                                   bool wantActive,\n                                   virStoragePoolObjListACLFilter filter)\n{\n    struct _virStoragePoolCountData data = {\n        .conn = conn, .filter = filter, .wantActive = wantActive, .count = 0 };\n\n    virObjectRWLockRead(pools);\n    virHashForEach(pools->objs, virStoragePoolObjNumOfStoragePoolsCb, &data);\n    virObjectRWUnlock(pools);\n\n    return data.count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectNumOfDefinedStoragePoolsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstorageConnectNumOfDefinedStoragePools(virConnectPtr conn)\n{\n    if (virConnectNumOfDefinedStoragePoolsEnsureACL(conn) < 0)\n        return -1;\n\n    return virStoragePoolObjNumOfStoragePools(driver->pools, conn, false,\n                                               virConnectNumOfDefinedStoragePoolsCheckACL);\n}"
  },
  {
    "function_name": "storageConnectGetCapabilities",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "584-592",
    "snippet": "static char *\nstorageConnectGetCapabilities(virConnectPtr conn)\n{\n\n    if (virConnectGetCapabilitiesEnsureACL(conn) < 0)\n        return NULL;\n\n    return virCapabilitiesFormatXML(driver->caps);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCapabilitiesFormatXML",
          "args": [
            "driver->caps"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesFormatXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "1335-1358",
          "snippet": "char *\nvirCapabilitiesFormatXML(virCapsPtr caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"<capabilities>\\n\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virCapabilitiesFormatHostXML(&caps->host, &buf) < 0)\n        goto error;\n\n    virCapabilitiesFormatGuestXML(caps->guests, caps->nguests, &buf);\n\n    virCapabilitiesFormatStoragePoolXML(caps->pools, caps->npools, &buf);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</capabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirCapabilitiesFormatXML(virCapsPtr caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"<capabilities>\\n\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virCapabilitiesFormatHostXML(&caps->host, &buf) < 0)\n        goto error;\n\n    virCapabilitiesFormatGuestXML(caps->guests, caps->nguests, &buf);\n\n    virCapabilitiesFormatStoragePoolXML(caps->pools, caps->npools, &buf);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</capabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectGetCapabilitiesEnsureACL",
          "args": [
            "conn"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic char *\nstorageConnectGetCapabilities(virConnectPtr conn)\n{\n\n    if (virConnectGetCapabilitiesEnsureACL(conn) < 0)\n        return NULL;\n\n    return virCapabilitiesFormatXML(driver->caps);\n}"
  },
  {
    "function_name": "storageConnectListStoragePools",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "570-581",
    "snippet": "static int\nstorageConnectListStoragePools(virConnectPtr conn,\n                               char **const names,\n                               int maxnames)\n{\n    if (virConnectListStoragePoolsEnsureACL(conn) < 0)\n        return -1;\n\n    return virStoragePoolObjGetNames(driver->pools, conn, true,\n                                     virConnectListStoragePoolsCheckACL,\n                                     names, maxnames);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjGetNames",
          "args": [
            "driver->pools",
            "conn",
            "true",
            "virConnectListStoragePoolsCheckACL",
            "names",
            "maxnames"
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetNames",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1920-1945",
          "snippet": "int\nvirStoragePoolObjGetNames(virStoragePoolObjListPtr pools,\n                          virConnectPtr conn,\n                          bool wantActive,\n                          virStoragePoolObjListACLFilter filter,\n                          char **const names,\n                          int maxnames)\n{\n    struct _virStoragePoolNameData data = {\n        .conn = conn, .filter = filter, .wantActive = wantActive,\n        .error = false, .nnames = 0, .maxnames = maxnames, .names = names };\n\n    virObjectRWLockRead(pools);\n    virHashForEach(pools->objs, virStoragePoolObjGetNamesCb, &data);\n    virObjectRWUnlock(pools);\n\n    if (data.error)\n        goto error;\n\n    return data.nnames;\n\n error:\n    while (data.nnames)\n        VIR_FREE(data.names[--data.nnames]);\n    return -1;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjGetNames(virStoragePoolObjListPtr pools,\n                          virConnectPtr conn,\n                          bool wantActive,\n                          virStoragePoolObjListACLFilter filter,\n                          char **const names,\n                          int maxnames)\n{\n    struct _virStoragePoolNameData data = {\n        .conn = conn, .filter = filter, .wantActive = wantActive,\n        .error = false, .nnames = 0, .maxnames = maxnames, .names = names };\n\n    virObjectRWLockRead(pools);\n    virHashForEach(pools->objs, virStoragePoolObjGetNamesCb, &data);\n    virObjectRWUnlock(pools);\n\n    if (data.error)\n        goto error;\n\n    return data.nnames;\n\n error:\n    while (data.nnames)\n        VIR_FREE(data.names[--data.nnames]);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectListStoragePoolsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstorageConnectListStoragePools(virConnectPtr conn,\n                               char **const names,\n                               int maxnames)\n{\n    if (virConnectListStoragePoolsEnsureACL(conn) < 0)\n        return -1;\n\n    return virStoragePoolObjGetNames(driver->pools, conn, true,\n                                     virConnectListStoragePoolsCheckACL,\n                                     names, maxnames);\n}"
  },
  {
    "function_name": "storageConnectNumOfStoragePools",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "559-567",
    "snippet": "static int\nstorageConnectNumOfStoragePools(virConnectPtr conn)\n{\n    if (virConnectNumOfStoragePoolsEnsureACL(conn) < 0)\n        return -1;\n\n    return virStoragePoolObjNumOfStoragePools(driver->pools, conn, true,\n                                              virConnectNumOfStoragePoolsCheckACL);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjNumOfStoragePools",
          "args": [
            "driver->pools",
            "conn",
            "true",
            "virConnectNumOfStoragePoolsCheckACL"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjNumOfStoragePools",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1859-1873",
          "snippet": "int\nvirStoragePoolObjNumOfStoragePools(virStoragePoolObjListPtr pools,\n                                   virConnectPtr conn,\n                                   bool wantActive,\n                                   virStoragePoolObjListACLFilter filter)\n{\n    struct _virStoragePoolCountData data = {\n        .conn = conn, .filter = filter, .wantActive = wantActive, .count = 0 };\n\n    virObjectRWLockRead(pools);\n    virHashForEach(pools->objs, virStoragePoolObjNumOfStoragePoolsCb, &data);\n    virObjectRWUnlock(pools);\n\n    return data.count;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjNumOfStoragePools(virStoragePoolObjListPtr pools,\n                                   virConnectPtr conn,\n                                   bool wantActive,\n                                   virStoragePoolObjListACLFilter filter)\n{\n    struct _virStoragePoolCountData data = {\n        .conn = conn, .filter = filter, .wantActive = wantActive, .count = 0 };\n\n    virObjectRWLockRead(pools);\n    virHashForEach(pools->objs, virStoragePoolObjNumOfStoragePoolsCb, &data);\n    virObjectRWUnlock(pools);\n\n    return data.count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectNumOfStoragePoolsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstorageConnectNumOfStoragePools(virConnectPtr conn)\n{\n    if (virConnectNumOfStoragePoolsEnsureACL(conn) < 0)\n        return -1;\n\n    return virStoragePoolObjNumOfStoragePools(driver->pools, conn, true,\n                                              virConnectNumOfStoragePoolsCheckACL);\n}"
  },
  {
    "function_name": "storagePoolLookupByVolume",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "538-557",
    "snippet": "static virStoragePoolPtr\nstoragePoolLookupByVolume(virStorageVolPtr vol)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n\n    if (!(obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolLookupByVolumeEnsureACL(vol->conn, def) < 0)\n        goto cleanup;\n\n    pool = virGetStoragePool(vol->conn, def->name, def->uuid, NULL, NULL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetStoragePool",
          "args": [
            "vol->conn",
            "def->name",
            "def->uuid",
            "NULL",
            "NULL"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "virGetStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "525-556",
          "snippet": "virStoragePoolPtr\nvirGetStoragePool(virConnectPtr conn, const char *name,\n                  const unsigned char *uuid,\n                  void *privateData, virFreeCallback freeFunc)\n{\n    virStoragePoolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virStoragePoolClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    /* set the driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virStoragePoolClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virStoragePoolClass;\n\nvirStoragePoolPtr\nvirGetStoragePool(virConnectPtr conn, const char *name,\n                  const unsigned char *uuid,\n                  void *privateData, virFreeCallback freeFunc)\n{\n    virStoragePoolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virStoragePoolClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    /* set the driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolLookupByVolumeEnsureACL",
          "args": [
            "vol->conn",
            "def"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storagePoolObjFindByName",
          "args": [
            "vol->pool"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolObjFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "481-490",
          "snippet": "static virStoragePoolObjPtr\nstoragePoolObjFindByName(const char *name)\n{\n    virStoragePoolObjPtr obj;\n\n    if (!(obj = virStoragePoolObjFindByName(driver->pools, name)))\n        virReportError(VIR_ERR_NO_STORAGE_POOL,\n                       _(\"no storage pool with matching name '%s'\"), name);\n    return obj;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStoragePoolObjPtr\nstoragePoolObjFindByName(const char *name)\n{\n    virStoragePoolObjPtr obj;\n\n    if (!(obj = virStoragePoolObjFindByName(driver->pools, name)))\n        virReportError(VIR_ERR_NO_STORAGE_POOL,\n                       _(\"no storage pool with matching name '%s'\"), name);\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolPtr\nstoragePoolLookupByVolume(virStorageVolPtr vol)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n\n    if (!(obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolLookupByVolumeEnsureACL(vol->conn, def) < 0)\n        goto cleanup;\n\n    pool = virGetStoragePool(vol->conn, def->name, def->uuid, NULL, NULL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n}"
  },
  {
    "function_name": "storagePoolLookupByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "516-536",
    "snippet": "static virStoragePoolPtr\nstoragePoolLookupByName(virConnectPtr conn,\n                        const char *name)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n\n    if (!(obj = storagePoolObjFindByName(name)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolLookupByNameEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 534
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetStoragePool",
          "args": [
            "conn",
            "def->name",
            "def->uuid",
            "NULL",
            "NULL"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "virGetStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "525-556",
          "snippet": "virStoragePoolPtr\nvirGetStoragePool(virConnectPtr conn, const char *name,\n                  const unsigned char *uuid,\n                  void *privateData, virFreeCallback freeFunc)\n{\n    virStoragePoolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virStoragePoolClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    /* set the driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virStoragePoolClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virStoragePoolClass;\n\nvirStoragePoolPtr\nvirGetStoragePool(virConnectPtr conn, const char *name,\n                  const unsigned char *uuid,\n                  void *privateData, virFreeCallback freeFunc)\n{\n    virStoragePoolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virStoragePoolClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    /* set the driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolLookupByNameEnsureACL",
          "args": [
            "conn",
            "def"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storagePoolObjFindByName",
          "args": [
            "name"
          ],
          "line": 524
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolObjFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "481-490",
          "snippet": "static virStoragePoolObjPtr\nstoragePoolObjFindByName(const char *name)\n{\n    virStoragePoolObjPtr obj;\n\n    if (!(obj = virStoragePoolObjFindByName(driver->pools, name)))\n        virReportError(VIR_ERR_NO_STORAGE_POOL,\n                       _(\"no storage pool with matching name '%s'\"), name);\n    return obj;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStoragePoolObjPtr\nstoragePoolObjFindByName(const char *name)\n{\n    virStoragePoolObjPtr obj;\n\n    if (!(obj = virStoragePoolObjFindByName(driver->pools, name)))\n        virReportError(VIR_ERR_NO_STORAGE_POOL,\n                       _(\"no storage pool with matching name '%s'\"), name);\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolPtr\nstoragePoolLookupByName(virConnectPtr conn,\n                        const char *name)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n\n    if (!(obj = storagePoolObjFindByName(name)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolLookupByNameEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n}"
  },
  {
    "function_name": "storagePoolLookupByUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "493-514",
    "snippet": "static virStoragePoolPtr\nstoragePoolLookupByUUID(virConnectPtr conn,\n                        const unsigned char *uuid)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n\n    obj = storagePoolObjFindByUUID(uuid, NULL);\n    if (!obj)\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolLookupByUUIDEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 512
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetStoragePool",
          "args": [
            "conn",
            "def->name",
            "def->uuid",
            "NULL",
            "NULL"
          ],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "virGetStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "525-556",
          "snippet": "virStoragePoolPtr\nvirGetStoragePool(virConnectPtr conn, const char *name,\n                  const unsigned char *uuid,\n                  void *privateData, virFreeCallback freeFunc)\n{\n    virStoragePoolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virStoragePoolClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    /* set the driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virStoragePoolClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virStoragePoolClass;\n\nvirStoragePoolPtr\nvirGetStoragePool(virConnectPtr conn, const char *name,\n                  const unsigned char *uuid,\n                  void *privateData, virFreeCallback freeFunc)\n{\n    virStoragePoolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virStoragePoolClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    /* set the driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolLookupByUUIDEnsureACL",
          "args": [
            "conn",
            "def"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storagePoolObjFindByUUID",
          "args": [
            "uuid",
            "NULL"
          ],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolObjFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "451-471",
          "snippet": "static virStoragePoolObjPtr\nstoragePoolObjFindByUUID(const unsigned char *uuid,\n                         const char *name)\n{\n    virStoragePoolObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virStoragePoolObjFindByUUID(driver->pools, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        if (name)\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s' (%s)\"),\n                           uuidstr, name);\n        else\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s'\"),\n                           uuidstr);\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStoragePoolObjPtr\nstoragePoolObjFindByUUID(const unsigned char *uuid,\n                         const char *name)\n{\n    virStoragePoolObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virStoragePoolObjFindByUUID(driver->pools, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        if (name)\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s' (%s)\"),\n                           uuidstr, name);\n        else\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s'\"),\n                           uuidstr);\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolPtr\nstoragePoolLookupByUUID(virConnectPtr conn,\n                        const unsigned char *uuid)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n\n    obj = storagePoolObjFindByUUID(uuid, NULL);\n    if (!obj)\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolLookupByUUIDEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n}"
  },
  {
    "function_name": "storagePoolObjFindByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "481-490",
    "snippet": "static virStoragePoolObjPtr\nstoragePoolObjFindByName(const char *name)\n{\n    virStoragePoolObjPtr obj;\n\n    if (!(obj = virStoragePoolObjFindByName(driver->pools, name)))\n        virReportError(VIR_ERR_NO_STORAGE_POOL,\n                       _(\"no storage pool with matching name '%s'\"), name);\n    return obj;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_STORAGE_POOL",
            "_(\"no storage pool with matching name '%s'\")",
            "name"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no storage pool with matching name '%s'\""
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFindByName",
          "args": [
            "driver->pools",
            "name"
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "596-609",
          "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjFindByName(virStoragePoolObjListPtr pools,\n                            const char *name)\n{\n    virStoragePoolObjPtr obj;\n\n    virObjectRWLockRead(pools);\n    obj = virStoragePoolObjFindByNameLocked(pools, name);\n    virObjectRWUnlock(pools);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolObjPtr\nvirStoragePoolObjFindByName(virStoragePoolObjListPtr pools,\n                            const char *name)\n{\n    virStoragePoolObjPtr obj;\n\n    virObjectRWLockRead(pools);\n    obj = virStoragePoolObjFindByNameLocked(pools, name);\n    virObjectRWUnlock(pools);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStoragePoolObjPtr\nstoragePoolObjFindByName(const char *name)\n{\n    virStoragePoolObjPtr obj;\n\n    if (!(obj = virStoragePoolObjFindByName(driver->pools, name)))\n        virReportError(VIR_ERR_NO_STORAGE_POOL,\n                       _(\"no storage pool with matching name '%s'\"), name);\n    return obj;\n}"
  },
  {
    "function_name": "virStoragePoolObjFromStoragePool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "474-478",
    "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "storagePoolObjFindByUUID",
          "args": [
            "pool->uuid",
            "pool->name"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolObjFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "451-471",
          "snippet": "static virStoragePoolObjPtr\nstoragePoolObjFindByUUID(const unsigned char *uuid,\n                         const char *name)\n{\n    virStoragePoolObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virStoragePoolObjFindByUUID(driver->pools, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        if (name)\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s' (%s)\"),\n                           uuidstr, name);\n        else\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s'\"),\n                           uuidstr);\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStoragePoolObjPtr\nstoragePoolObjFindByUUID(const unsigned char *uuid,\n                         const char *name)\n{\n    virStoragePoolObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virStoragePoolObjFindByUUID(driver->pools, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        if (name)\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s' (%s)\"),\n                           uuidstr, name);\n        else\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s'\"),\n                           uuidstr);\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFromStoragePool(virStoragePoolPtr pool)\n{\n    return storagePoolObjFindByUUID(pool->uuid, pool->name);\n}"
  },
  {
    "function_name": "storagePoolObjFindByUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "451-471",
    "snippet": "static virStoragePoolObjPtr\nstoragePoolObjFindByUUID(const unsigned char *uuid,\n                         const char *name)\n{\n    virStoragePoolObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virStoragePoolObjFindByUUID(driver->pools, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        if (name)\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s' (%s)\"),\n                           uuidstr, name);\n        else\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s'\"),\n                           uuidstr);\n    }\n\n    return obj;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_STORAGE_POOL",
            "_(\"no storage pool with matching uuid '%s'\")",
            "uuidstr"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no storage pool with matching uuid '%s'\""
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_STORAGE_POOL",
            "_(\"no storage pool with matching uuid '%s' (%s)\")",
            "uuidstr",
            "name"
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "uuid",
            "uuidstr"
          ],
          "line": 459
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFindByUUID",
          "args": [
            "driver->pools",
            "uuid"
          ],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "563-576",
          "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjFindByUUID(virStoragePoolObjListPtr pools,\n                            const unsigned char *uuid)\n{\n    virStoragePoolObjPtr obj;\n\n    virObjectRWLockRead(pools);\n    obj = virStoragePoolObjFindByUUIDLocked(pools, uuid);\n    virObjectRWUnlock(pools);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolObjPtr\nvirStoragePoolObjFindByUUID(virStoragePoolObjListPtr pools,\n                            const unsigned char *uuid)\n{\n    virStoragePoolObjPtr obj;\n\n    virObjectRWLockRead(pools);\n    obj = virStoragePoolObjFindByUUIDLocked(pools, uuid);\n    virObjectRWUnlock(pools);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStoragePoolObjPtr\nstoragePoolObjFindByUUID(const unsigned char *uuid,\n                         const char *name)\n{\n    virStoragePoolObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virStoragePoolObjFindByUUID(driver->pools, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        if (name)\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s' (%s)\"),\n                           uuidstr, name);\n        else\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching uuid '%s'\"),\n                           uuidstr);\n    }\n\n    return obj;\n}"
  },
  {
    "function_name": "storageConnectIsAlive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "445-448",
    "snippet": "static int storageConnectIsAlive(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return 1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int storageConnectIsAlive(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return 1;\n}"
  },
  {
    "function_name": "storageConnectIsEncrypted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "438-442",
    "snippet": "static int storageConnectIsEncrypted(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Not encrypted, but remote driver takes care of that */\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int storageConnectIsEncrypted(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Not encrypted, but remote driver takes care of that */\n    return 0;\n}"
  },
  {
    "function_name": "storageConnectIsSecure",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "431-435",
    "snippet": "static int storageConnectIsSecure(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Trivially secure, since always inside the daemon */\n    return 1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int storageConnectIsSecure(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Trivially secure, since always inside the daemon */\n    return 1;\n}"
  },
  {
    "function_name": "storageConnectClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "425-428",
    "snippet": "static int storageConnectClose(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int storageConnectClose(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return 0;\n}"
  },
  {
    "function_name": "storageConnectOpen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "400-423",
    "snippet": "static virDrvOpenStatus\nstorageConnectOpen(virConnectPtr conn,\n                   virConnectAuthPtr auth G_GNUC_UNUSED,\n                   virConfPtr conf G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(VIR_CONNECT_RO, VIR_DRV_OPEN_ERROR);\n\n    if (driver == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"storage state driver is not active\"));\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (!virConnectValidateURIPath(conn->uri->path,\n                                   \"storage\",\n                                   driver->privileged))\n        return VIR_DRV_OPEN_ERROR;\n\n    if (virConnectOpenEnsureACL(conn) < 0)\n        return VIR_DRV_OPEN_ERROR;\n\n    return VIR_DRV_OPEN_SUCCESS;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConnectOpenEnsureACL",
          "args": [
            "conn"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConnectValidateURIPath",
          "args": [
            "conn->uri->path",
            "\"storage\"",
            "driver->privileged"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "virConnectValidateURIPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/driver.c",
          "lines": "260-296",
          "snippet": "bool\nvirConnectValidateURIPath(const char *uriPath,\n                          const char *entityName,\n                          bool privileged)\n{\n    if (privileged) {\n        /* TODO: qemu and vbox drivers allow '/session'\n         * connections as root. This is not ideal, but changing\n         * these drivers to refuse privileged '/session'\n         * connections, like everyone else is already doing, can\n         * break existing applications. Until we decide what to do,\n         * for now we can handle them as exception in this validate\n         * function.\n         */\n        bool compatSessionRoot = (STREQ(entityName, \"qemu\") ||\n                                  STREQ(entityName, \"vbox\")) &&\n                                  STREQ(uriPath, \"/session\");\n\n        if (STRNEQ(uriPath, \"/system\") && !compatSessionRoot) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unexpected %s URI path '%s', try \"\n                             \"%s:///system\"),\n                           entityName, uriPath, entityName);\n            return false;\n        }\n    } else {\n        if (STRNEQ(uriPath, \"/session\")) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unexpected %s URI path '%s', try \"\n                             \"%s:///session\"),\n                           entityName, uriPath, entityName);\n            return false;\n        }\n    }\n\n    return true;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"driver.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"driver.h\"\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirConnectValidateURIPath(const char *uriPath,\n                          const char *entityName,\n                          bool privileged)\n{\n    if (privileged) {\n        /* TODO: qemu and vbox drivers allow '/session'\n         * connections as root. This is not ideal, but changing\n         * these drivers to refuse privileged '/session'\n         * connections, like everyone else is already doing, can\n         * break existing applications. Until we decide what to do,\n         * for now we can handle them as exception in this validate\n         * function.\n         */\n        bool compatSessionRoot = (STREQ(entityName, \"qemu\") ||\n                                  STREQ(entityName, \"vbox\")) &&\n                                  STREQ(uriPath, \"/session\");\n\n        if (STRNEQ(uriPath, \"/system\") && !compatSessionRoot) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unexpected %s URI path '%s', try \"\n                             \"%s:///system\"),\n                           entityName, uriPath, entityName);\n            return false;\n        }\n    } else {\n        if (STRNEQ(uriPath, \"/session\")) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unexpected %s URI path '%s', try \"\n                             \"%s:///session\"),\n                           entityName, uriPath, entityName);\n            return false;\n        }\n    }\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"storage state driver is not active\")"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"storage state driver is not active\""
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_CONNECT_RO",
            "VIR_DRV_OPEN_ERROR"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virDrvOpenStatus\nstorageConnectOpen(virConnectPtr conn,\n                   virConnectAuthPtr auth G_GNUC_UNUSED,\n                   virConfPtr conf G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(VIR_CONNECT_RO, VIR_DRV_OPEN_ERROR);\n\n    if (driver == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"storage state driver is not active\"));\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (!virConnectValidateURIPath(conn->uri->path,\n                                   \"storage\",\n                                   driver->privileged))\n        return VIR_DRV_OPEN_ERROR;\n\n    if (virConnectOpenEnsureACL(conn) < 0)\n        return VIR_DRV_OPEN_ERROR;\n\n    return VIR_DRV_OPEN_SUCCESS;\n}"
  },
  {
    "function_name": "storageStateCleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "372-398",
    "snippet": "static int\nstorageStateCleanup(void)\n{\n    if (!driver)\n        return -1;\n\n    storageDriverLock();\n\n    virObjectUnref(driver->caps);\n    virObjectUnref(driver->storageEventState);\n\n    /* free inactive pools */\n    virObjectUnref(driver->pools);\n\n    if (driver->lockFD != -1)\n        virPidFileRelease(driver->stateDir, \"driver\",\n                          driver->lockFD);\n\n    VIR_FREE(driver->configDir);\n    VIR_FREE(driver->autostartDir);\n    VIR_FREE(driver->stateDir);\n    storageDriverUnlock();\n    virMutexDestroy(&driver->lock);\n    VIR_FREE(driver);\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;",
      "static int storageStateCleanup(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "driver"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMutexDestroy",
          "args": [
            "&driver->lock"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexDestroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "76-79",
          "snippet": "void virMutexDestroy(virMutexPtr m)\n{\n    pthread_mutex_destroy(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexDestroy(virMutexPtr m)\n{\n    pthread_mutex_destroy(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "storageDriverUnlock",
          "args": [],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "storageDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "73-76",
          "snippet": "static void storageDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void storageDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "driver->stateDir"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "driver->autostartDir"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "driver->configDir"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virPidFileRelease",
          "args": [
            "driver->stateDir",
            "\"driver\"",
            "driver->lockFD"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "virPidFileRelease",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpidfile.c",
          "lines": "453-466",
          "snippet": "int virPidFileRelease(const char *dir,\n                      const char *name,\n                      int fd)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileReleasePath(pidfile, fd);\n}",
          "includes": [
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virpidfile.h\"",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virpidfile.h\"\n#include <sys/stat.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virPidFileRelease(const char *dir,\n                      const char *name,\n                      int fd)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileReleasePath(pidfile, fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "driver->pools"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storageDriverLock",
          "args": [],
          "line": 378
        },
        "resolved": true,
        "details": {
          "function_name": "storageDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "69-72",
          "snippet": "static void storageDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void storageDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\nstatic int storageStateCleanup(void);\n\nstatic int\nstorageStateCleanup(void)\n{\n    if (!driver)\n        return -1;\n\n    storageDriverLock();\n\n    virObjectUnref(driver->caps);\n    virObjectUnref(driver->storageEventState);\n\n    /* free inactive pools */\n    virObjectUnref(driver->pools);\n\n    if (driver->lockFD != -1)\n        virPidFileRelease(driver->stateDir, \"driver\",\n                          driver->lockFD);\n\n    VIR_FREE(driver->configDir);\n    VIR_FREE(driver->autostartDir);\n    VIR_FREE(driver->stateDir);\n    storageDriverUnlock();\n    virMutexDestroy(&driver->lock);\n    VIR_FREE(driver);\n\n    return 0;\n}"
  },
  {
    "function_name": "storageStateReload",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "348-364",
    "snippet": "static int\nstorageStateReload(void)\n{\n    if (!driver)\n        return -1;\n\n    storageDriverLock();\n    virStoragePoolObjLoadAllState(driver->pools,\n                                  driver->stateDir);\n    virStoragePoolObjLoadAllConfigs(driver->pools,\n                                    driver->configDir,\n                                    driver->autostartDir);\n    storageDriverAutostart();\n    storageDriverUnlock();\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "storageDriverUnlock",
          "args": [],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "storageDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "73-76",
          "snippet": "static void storageDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void storageDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "storageDriverAutostart",
          "args": [],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "storageDriverAutostart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "239-245",
          "snippet": "static void\nstorageDriverAutostart(void)\n{\n    virStoragePoolObjListForEach(driver->pools,\n                                 storageDriverAutostartCallback,\n                                 NULL);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void\nstorageDriverAutostart(void)\n{\n    virStoragePoolObjListForEach(driver->pools,\n                                 storageDriverAutostartCallback,\n                                 NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjLoadAllConfigs",
          "args": [
            "driver->pools",
            "driver->configDir",
            "driver->autostartDir"
          ],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjLoadAllConfigs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1736-1775",
          "snippet": "int\nvirStoragePoolObjLoadAllConfigs(virStoragePoolObjListPtr pools,\n                                const char *configDir,\n                                const char *autostartDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        char *path;\n        char *autostartLink;\n        virStoragePoolObjPtr obj;\n\n        if (!virStringHasSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        if (!(path = virFileBuildPath(configDir, entry->d_name, NULL)))\n            continue;\n\n        if (!(autostartLink = virFileBuildPath(autostartDir, entry->d_name,\n                                               NULL))) {\n            VIR_FREE(path);\n            continue;\n        }\n\n        obj = virStoragePoolObjLoad(pools, entry->d_name, path, autostartLink);\n        virStoragePoolObjEndAPI(&obj);\n\n        VIR_FREE(path);\n        VIR_FREE(autostartLink);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjLoadAllConfigs(virStoragePoolObjListPtr pools,\n                                const char *configDir,\n                                const char *autostartDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        char *path;\n        char *autostartLink;\n        virStoragePoolObjPtr obj;\n\n        if (!virStringHasSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        if (!(path = virFileBuildPath(configDir, entry->d_name, NULL)))\n            continue;\n\n        if (!(autostartLink = virFileBuildPath(autostartDir, entry->d_name,\n                                               NULL))) {\n            VIR_FREE(path);\n            continue;\n        }\n\n        obj = virStoragePoolObjLoad(pools, entry->d_name, path, autostartLink);\n        virStoragePoolObjEndAPI(&obj);\n\n        VIR_FREE(path);\n        VIR_FREE(autostartLink);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjLoadAllState",
          "args": [
            "driver->pools",
            "driver->stateDir"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjLoadAllState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1708-1733",
          "snippet": "int\nvirStoragePoolObjLoadAllState(virStoragePoolObjListPtr pools,\n                              const char *stateDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, stateDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, stateDir)) > 0) {\n        virStoragePoolObjPtr obj;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        if (!(obj = virStoragePoolObjLoadState(pools, stateDir, entry->d_name)))\n            continue;\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjLoadAllState(virStoragePoolObjListPtr pools,\n                              const char *stateDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, stateDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, stateDir)) > 0) {\n        virStoragePoolObjPtr obj;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        if (!(obj = virStoragePoolObjLoadState(pools, stateDir, entry->d_name)))\n            continue;\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storageDriverLock",
          "args": [],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "storageDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "69-72",
          "snippet": "static void storageDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void storageDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstorageStateReload(void)\n{\n    if (!driver)\n        return -1;\n\n    storageDriverLock();\n    virStoragePoolObjLoadAllState(driver->pools,\n                                  driver->stateDir);\n    virStoragePoolObjLoadAllConfigs(driver->pools,\n                                    driver->configDir,\n                                    driver->autostartDir);\n    storageDriverAutostart();\n    storageDriverUnlock();\n\n    return 0;\n}"
  },
  {
    "function_name": "storageStateInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "252-340",
    "snippet": "static int\nstorageStateInitialize(bool privileged,\n                       const char *root,\n                       virStateInhibitCallback callback G_GNUC_UNUSED,\n                       void *opaque G_GNUC_UNUSED)\n{\n    g_autofree char *configdir = NULL;\n    g_autofree char *rundir = NULL;\n    bool autostart = true;\n\n    if (root != NULL) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Driver does not support embedded mode\"));\n        return -1;\n    }\n\n    if (VIR_ALLOC(driver) < 0)\n        return VIR_DRV_STATE_INIT_ERROR;\n\n    driver->lockFD = -1;\n    if (virMutexInit(&driver->lock) < 0) {\n        VIR_FREE(driver);\n        return VIR_DRV_STATE_INIT_ERROR;\n    }\n    storageDriverLock();\n\n    if (!(driver->pools = virStoragePoolObjListNew()))\n        goto error;\n\n    if (privileged) {\n        driver->configDir = g_strdup(SYSCONFDIR \"/libvirt/storage\");\n        driver->autostartDir = g_strdup(SYSCONFDIR \"/libvirt/storage/autostart\");\n        driver->stateDir = g_strdup(RUNSTATEDIR \"/libvirt/storage\");\n    } else {\n        configdir = virGetUserConfigDirectory();\n        rundir = virGetUserRuntimeDirectory();\n\n        driver->configDir = g_strdup_printf(\"%s/storage\", configdir);\n        driver->autostartDir = g_strdup_printf(\"%s/storage/autostart\", configdir);\n        driver->stateDir = g_strdup_printf(\"%s/storage/run\", rundir);\n    }\n    driver->privileged = privileged;\n\n    if (virFileMakePath(driver->stateDir) < 0) {\n        virReportError(errno,\n                       _(\"cannot create directory %s\"),\n                       driver->stateDir);\n        goto error;\n    }\n\n    if ((driver->lockFD =\n         virPidFileAcquire(driver->stateDir, \"driver\",\n                           false, getpid())) < 0)\n        goto error;\n\n    if (virStoragePoolObjLoadAllState(driver->pools,\n                                      driver->stateDir) < 0)\n        goto error;\n\n    if (virStoragePoolObjLoadAllConfigs(driver->pools,\n                                        driver->configDir,\n                                        driver->autostartDir) < 0)\n        goto error;\n\n    storagePoolUpdateAllState();\n\n    if (virDriverShouldAutostart(driver->stateDir, &autostart) < 0)\n        goto error;\n\n    if (autostart)\n        storageDriverAutostart();\n\n    driver->storageEventState = virObjectEventStateNew();\n\n    /* Only one load of storage driver plus backends exists. Unlike\n     * domains where new binaries could change the capabilities. A\n     * new/changed backend requires a reinitialization. */\n    if (!(driver->caps = virStorageBackendGetCapabilities()))\n        goto error;\n\n    storageDriverUnlock();\n\n    return VIR_DRV_STATE_INIT_COMPLETE;\n\n error:\n    storageDriverUnlock();\n    storageStateCleanup();\n    return VIR_DRV_STATE_INIT_ERROR;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;",
      "static int storageStateCleanup(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "storageStateCleanup",
          "args": [],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "storageStateCleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "372-398",
          "snippet": "static int\nstorageStateCleanup(void)\n{\n    if (!driver)\n        return -1;\n\n    storageDriverLock();\n\n    virObjectUnref(driver->caps);\n    virObjectUnref(driver->storageEventState);\n\n    /* free inactive pools */\n    virObjectUnref(driver->pools);\n\n    if (driver->lockFD != -1)\n        virPidFileRelease(driver->stateDir, \"driver\",\n                          driver->lockFD);\n\n    VIR_FREE(driver->configDir);\n    VIR_FREE(driver->autostartDir);\n    VIR_FREE(driver->stateDir);\n    storageDriverUnlock();\n    virMutexDestroy(&driver->lock);\n    VIR_FREE(driver);\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;",
            "static int storageStateCleanup(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\nstatic int storageStateCleanup(void);\n\nstatic int\nstorageStateCleanup(void)\n{\n    if (!driver)\n        return -1;\n\n    storageDriverLock();\n\n    virObjectUnref(driver->caps);\n    virObjectUnref(driver->storageEventState);\n\n    /* free inactive pools */\n    virObjectUnref(driver->pools);\n\n    if (driver->lockFD != -1)\n        virPidFileRelease(driver->stateDir, \"driver\",\n                          driver->lockFD);\n\n    VIR_FREE(driver->configDir);\n    VIR_FREE(driver->autostartDir);\n    VIR_FREE(driver->stateDir);\n    storageDriverUnlock();\n    virMutexDestroy(&driver->lock);\n    VIR_FREE(driver);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storageDriverUnlock",
          "args": [],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "storageDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "73-76",
          "snippet": "static void storageDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void storageDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageBackendGetCapabilities",
          "args": [],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendGetCapabilities",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
          "lines": "187-200",
          "snippet": "virCapsPtr\nvirStorageBackendGetCapabilities(void)\n{\n    virCapsPtr caps;\n    size_t i;\n\n    if (!(caps = virCapabilitiesNew(VIR_ARCH_NONE, false, false)))\n        return NULL;\n\n    for (i = 0; i < virStorageBackendsCount; i++)\n        virCapabilitiesAddStoragePool(caps, virStorageBackends[i]->type);\n\n    return caps;\n}",
          "includes": [
            "# include \"storage_backend_vstorage.h\"",
            "# include \"storage_backend_zfs.h\"",
            "# include \"storage_backend_gluster.h\"",
            "# include \"storage_backend_sheepdog.h\"",
            "# include \"storage_backend_rbd.h\"",
            "# include \"storage_backend_fs.h\"",
            "# include \"storage_backend_disk.h\"",
            "# include \"storage_backend_mpath.h\"",
            "# include \"storage_backend_scsi.h\"",
            "# include \"storage_backend_iscsi_direct.h\"",
            "# include \"storage_backend_iscsi.h\"",
            "# include \"storage_backend_logical.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
            "static size_t virStorageBackendsCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirCapsPtr\nvirStorageBackendGetCapabilities(void)\n{\n    virCapsPtr caps;\n    size_t i;\n\n    if (!(caps = virCapabilitiesNew(VIR_ARCH_NONE, false, false)))\n        return NULL;\n\n    for (i = 0; i < virStorageBackendsCount; i++)\n        virCapabilitiesAddStoragePool(caps, virStorageBackends[i]->type);\n\n    return caps;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateNew",
          "args": [],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "558-582",
          "snippet": "virObjectEventStatePtr\nvirObjectEventStateNew(void)\n{\n    virObjectEventStatePtr state = NULL;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!(state = virObjectLockableNew(virObjectEventStateClass)))\n        return NULL;\n\n    if (VIR_ALLOC(state->callbacks) < 0)\n        goto error;\n\n    if (!(state->queue = virObjectEventQueueNew()))\n        goto error;\n\n    state->timer = -1;\n\n    return state;\n\n error:\n    virObjectUnref(state);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectEventStateClass;",
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectEventStateClass;\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvirObjectEventStatePtr\nvirObjectEventStateNew(void)\n{\n    virObjectEventStatePtr state = NULL;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!(state = virObjectLockableNew(virObjectEventStateClass)))\n        return NULL;\n\n    if (VIR_ALLOC(state->callbacks) < 0)\n        goto error;\n\n    if (!(state->queue = virObjectEventQueueNew()))\n        goto error;\n\n    state->timer = -1;\n\n    return state;\n\n error:\n    virObjectUnref(state);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storageDriverAutostart",
          "args": [],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "storageDriverAutostart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "239-245",
          "snippet": "static void\nstorageDriverAutostart(void)\n{\n    virStoragePoolObjListForEach(driver->pools,\n                                 storageDriverAutostartCallback,\n                                 NULL);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void\nstorageDriverAutostart(void)\n{\n    virStoragePoolObjListForEach(driver->pools,\n                                 storageDriverAutostartCallback,\n                                 NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDriverShouldAutostart",
          "args": [
            "driver->stateDir",
            "&autostart"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "virDriverShouldAutostart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/driver.c",
          "lines": "86-108",
          "snippet": "int\nvirDriverShouldAutostart(const char *dir,\n                         bool *autostart)\n{\n    g_autofree char *path = NULL;\n\n    *autostart = false;\n\n    path = g_strdup_printf(\"%s/autostarted\", dir);\n\n    if (virFileExists(path)) {\n        VIR_DEBUG(\"Autostart file %s exists, skipping autostart\", path);\n        return 0;\n    }\n\n    VIR_DEBUG(\"Autostart file %s does not exist, do autostart\", path);\n    *autostart = true;\n\n    if (virFileTouch(path, 0600) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"driver.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"driver.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirDriverShouldAutostart(const char *dir,\n                         bool *autostart)\n{\n    g_autofree char *path = NULL;\n\n    *autostart = false;\n\n    path = g_strdup_printf(\"%s/autostarted\", dir);\n\n    if (virFileExists(path)) {\n        VIR_DEBUG(\"Autostart file %s exists, skipping autostart\", path);\n        return 0;\n    }\n\n    VIR_DEBUG(\"Autostart file %s does not exist, do autostart\", path);\n    *autostart = true;\n\n    if (virFileTouch(path, 0600) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storagePoolUpdateAllState",
          "args": [],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolUpdateAllState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "181-187",
          "snippet": "static void\nstoragePoolUpdateAllState(void)\n{\n    virStoragePoolObjListForEach(driver->pools,\n                                 storagePoolUpdateStateCallback,\n                                 NULL);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void\nstoragePoolUpdateAllState(void)\n{\n    virStoragePoolObjListForEach(driver->pools,\n                                 storagePoolUpdateStateCallback,\n                                 NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjLoadAllConfigs",
          "args": [
            "driver->pools",
            "driver->configDir",
            "driver->autostartDir"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjLoadAllConfigs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1736-1775",
          "snippet": "int\nvirStoragePoolObjLoadAllConfigs(virStoragePoolObjListPtr pools,\n                                const char *configDir,\n                                const char *autostartDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        char *path;\n        char *autostartLink;\n        virStoragePoolObjPtr obj;\n\n        if (!virStringHasSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        if (!(path = virFileBuildPath(configDir, entry->d_name, NULL)))\n            continue;\n\n        if (!(autostartLink = virFileBuildPath(autostartDir, entry->d_name,\n                                               NULL))) {\n            VIR_FREE(path);\n            continue;\n        }\n\n        obj = virStoragePoolObjLoad(pools, entry->d_name, path, autostartLink);\n        virStoragePoolObjEndAPI(&obj);\n\n        VIR_FREE(path);\n        VIR_FREE(autostartLink);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjLoadAllConfigs(virStoragePoolObjListPtr pools,\n                                const char *configDir,\n                                const char *autostartDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        char *path;\n        char *autostartLink;\n        virStoragePoolObjPtr obj;\n\n        if (!virStringHasSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        if (!(path = virFileBuildPath(configDir, entry->d_name, NULL)))\n            continue;\n\n        if (!(autostartLink = virFileBuildPath(autostartDir, entry->d_name,\n                                               NULL))) {\n            VIR_FREE(path);\n            continue;\n        }\n\n        obj = virStoragePoolObjLoad(pools, entry->d_name, path, autostartLink);\n        virStoragePoolObjEndAPI(&obj);\n\n        VIR_FREE(path);\n        VIR_FREE(autostartLink);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjLoadAllState",
          "args": [
            "driver->pools",
            "driver->stateDir"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjLoadAllState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1708-1733",
          "snippet": "int\nvirStoragePoolObjLoadAllState(virStoragePoolObjListPtr pools,\n                              const char *stateDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, stateDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, stateDir)) > 0) {\n        virStoragePoolObjPtr obj;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        if (!(obj = virStoragePoolObjLoadState(pools, stateDir, entry->d_name)))\n            continue;\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjLoadAllState(virStoragePoolObjListPtr pools,\n                              const char *stateDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, stateDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, stateDir)) > 0) {\n        virStoragePoolObjPtr obj;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        if (!(obj = virStoragePoolObjLoadState(pools, stateDir, entry->d_name)))\n            continue;\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPidFileAcquire",
          "args": [
            "driver->stateDir",
            "\"driver\"",
            "false",
            "getpid()"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "virPidFileAcquire",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpidfile.c",
          "lines": "413-427",
          "snippet": "int virPidFileAcquire(const char *dir,\n                      const char *name,\n                      bool waitForLock,\n                      pid_t pid)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileAcquirePath(pidfile, waitForLock, pid);\n}",
          "includes": [
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virpidfile.h\"",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virpidfile.h\"\n#include <sys/stat.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virPidFileAcquire(const char *dir,\n                      const char *name,\n                      bool waitForLock,\n                      pid_t pid)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileAcquirePath(pidfile, waitForLock, pid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "getpid",
          "args": [],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "errno",
            "_(\"cannot create directory %s\")",
            "driver->stateDir"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot create directory %s\""
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileMakePath",
          "args": [
            "driver->stateDir"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3076-3080",
          "snippet": "int\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUserRuntimeDirectory",
          "args": [],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserRuntimeDirectory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "594-601",
          "snippet": "char *virGetUserRuntimeDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_runtime_dir());\n#else\n    return g_build_filename(g_get_user_runtime_dir(), \"libvirt\", NULL);\n#endif\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virGetUserRuntimeDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_runtime_dir());\n#else\n    return g_build_filename(g_get_user_runtime_dir(), \"libvirt\", NULL);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUserConfigDirectory",
          "args": [],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserConfigDirectory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "574-581",
          "snippet": "char *virGetUserConfigDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_config_dir());\n#else\n    return g_build_filename(g_get_user_config_dir(), \"libvirt\", NULL);\n#endif\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virGetUserConfigDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_config_dir());\n#else\n    return g_build_filename(g_get_user_config_dir(), \"libvirt\", NULL);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjListNew",
          "args": [],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjListNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "396-414",
          "snippet": "virStoragePoolObjListPtr\nvirStoragePoolObjListNew(void)\n{\n    virStoragePoolObjListPtr pools;\n\n    if (virStoragePoolObjInitialize() < 0)\n        return NULL;\n\n    if (!(pools = virObjectRWLockableNew(virStoragePoolObjListClass)))\n        return NULL;\n\n    if (!(pools->objs = virHashCreate(20, virObjectFreeHashData)) ||\n        !(pools->objsName = virHashCreate(20, virObjectFreeHashData))) {\n        virObjectUnref(pools);\n        return NULL;\n    }\n\n    return pools;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virStoragePoolObjListClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virClassPtr virStoragePoolObjListClass;\n\nvirStoragePoolObjListPtr\nvirStoragePoolObjListNew(void)\n{\n    virStoragePoolObjListPtr pools;\n\n    if (virStoragePoolObjInitialize() < 0)\n        return NULL;\n\n    if (!(pools = virObjectRWLockableNew(virStoragePoolObjListClass)))\n        return NULL;\n\n    if (!(pools->objs = virHashCreate(20, virObjectFreeHashData)) ||\n        !(pools->objsName = virHashCreate(20, virObjectFreeHashData))) {\n        virObjectUnref(pools);\n        return NULL;\n    }\n\n    return pools;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storageDriverLock",
          "args": [],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "storageDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "69-72",
          "snippet": "static void storageDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void storageDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "driver"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMutexInit",
          "args": [
            "&driver->lock"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexInitRecursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "61-74",
          "snippet": "int virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "driver"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"Driver does not support embedded mode\")"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\nstatic int storageStateCleanup(void);\n\nstatic int\nstorageStateInitialize(bool privileged,\n                       const char *root,\n                       virStateInhibitCallback callback G_GNUC_UNUSED,\n                       void *opaque G_GNUC_UNUSED)\n{\n    g_autofree char *configdir = NULL;\n    g_autofree char *rundir = NULL;\n    bool autostart = true;\n\n    if (root != NULL) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Driver does not support embedded mode\"));\n        return -1;\n    }\n\n    if (VIR_ALLOC(driver) < 0)\n        return VIR_DRV_STATE_INIT_ERROR;\n\n    driver->lockFD = -1;\n    if (virMutexInit(&driver->lock) < 0) {\n        VIR_FREE(driver);\n        return VIR_DRV_STATE_INIT_ERROR;\n    }\n    storageDriverLock();\n\n    if (!(driver->pools = virStoragePoolObjListNew()))\n        goto error;\n\n    if (privileged) {\n        driver->configDir = g_strdup(SYSCONFDIR \"/libvirt/storage\");\n        driver->autostartDir = g_strdup(SYSCONFDIR \"/libvirt/storage/autostart\");\n        driver->stateDir = g_strdup(RUNSTATEDIR \"/libvirt/storage\");\n    } else {\n        configdir = virGetUserConfigDirectory();\n        rundir = virGetUserRuntimeDirectory();\n\n        driver->configDir = g_strdup_printf(\"%s/storage\", configdir);\n        driver->autostartDir = g_strdup_printf(\"%s/storage/autostart\", configdir);\n        driver->stateDir = g_strdup_printf(\"%s/storage/run\", rundir);\n    }\n    driver->privileged = privileged;\n\n    if (virFileMakePath(driver->stateDir) < 0) {\n        virReportError(errno,\n                       _(\"cannot create directory %s\"),\n                       driver->stateDir);\n        goto error;\n    }\n\n    if ((driver->lockFD =\n         virPidFileAcquire(driver->stateDir, \"driver\",\n                           false, getpid())) < 0)\n        goto error;\n\n    if (virStoragePoolObjLoadAllState(driver->pools,\n                                      driver->stateDir) < 0)\n        goto error;\n\n    if (virStoragePoolObjLoadAllConfigs(driver->pools,\n                                        driver->configDir,\n                                        driver->autostartDir) < 0)\n        goto error;\n\n    storagePoolUpdateAllState();\n\n    if (virDriverShouldAutostart(driver->stateDir, &autostart) < 0)\n        goto error;\n\n    if (autostart)\n        storageDriverAutostart();\n\n    driver->storageEventState = virObjectEventStateNew();\n\n    /* Only one load of storage driver plus backends exists. Unlike\n     * domains where new binaries could change the capabilities. A\n     * new/changed backend requires a reinitialization. */\n    if (!(driver->caps = virStorageBackendGetCapabilities()))\n        goto error;\n\n    storageDriverUnlock();\n\n    return VIR_DRV_STATE_INIT_COMPLETE;\n\n error:\n    storageDriverUnlock();\n    storageStateCleanup();\n    return VIR_DRV_STATE_INIT_ERROR;\n}"
  },
  {
    "function_name": "storageDriverAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "239-245",
    "snippet": "static void\nstorageDriverAutostart(void)\n{\n    virStoragePoolObjListForEach(driver->pools,\n                                 storageDriverAutostartCallback,\n                                 NULL);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjListForEach",
          "args": [
            "driver->pools",
            "storageDriverAutostartCallback",
            "NULL"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjListForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "460-469",
          "snippet": "void\nvirStoragePoolObjListForEach(virStoragePoolObjListPtr pools,\n                             virStoragePoolObjListIterator iter,\n                             const void *opaque)\n{\n    struct _virStoragePoolObjListForEachData data = { .iter = iter,\n                                                      .opaque = opaque };\n\n    virHashForEach(pools->objs, virStoragePoolObjListForEachCb, &data);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nvirStoragePoolObjDispose(void *opaque);",
            "static void\nvirStoragePoolObjListDispose(void *opaque);",
            "static void\nvirStorageVolObjDispose(void *opaque);",
            "static void\nvirStorageVolObjListDispose(void *opaque);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nvoid\nvirStoragePoolObjListForEach(virStoragePoolObjListPtr pools,\n                             virStoragePoolObjListIterator iter,\n                             const void *opaque)\n{\n    struct _virStoragePoolObjListForEachData data = { .iter = iter,\n                                                      .opaque = opaque };\n\n    virHashForEach(pools->objs, virStoragePoolObjListForEachCb, &data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void\nstorageDriverAutostart(void)\n{\n    virStoragePoolObjListForEach(driver->pools,\n                                 storageDriverAutostartCallback,\n                                 NULL);\n}"
  },
  {
    "function_name": "storageDriverAutostartCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "190-236",
    "snippet": "static void\nstorageDriverAutostartCallback(virStoragePoolObjPtr obj,\n                               const void *opaque G_GNUC_UNUSED)\n{\n    virStoragePoolDefPtr def = virStoragePoolObjGetDef(obj);\n    virStorageBackendPtr backend;\n    bool started = false;\n\n    if (!(backend = virStorageBackendForType(def->type)))\n        return;\n\n    if (virStoragePoolObjIsAutostart(obj) &&\n        !virStoragePoolObjIsActive(obj)) {\n\n        virStoragePoolObjSetStarting(obj, true);\n        if (backend->startPool &&\n            backend->startPool(obj) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Failed to autostart storage pool '%s': %s\"),\n                           def->name, virGetLastErrorMessage());\n            goto cleanup;\n        }\n        started = true;\n    }\n\n    if (started) {\n        g_autofree char *stateFile = NULL;\n\n        stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\");\n        if (!stateFile ||\n            virStoragePoolSaveState(stateFile, def) < 0 ||\n            storagePoolRefreshImpl(backend, obj, stateFile) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Failed to autostart storage pool '%s': %s\"),\n                           def->name, virGetLastErrorMessage());\n        } else {\n            virStoragePoolObjSetActive(obj, true);\n        }\n    }\n\n cleanup:\n    if (virStoragePoolObjIsStarting(obj)) {\n        if (!virStoragePoolObjIsActive(obj))\n            virStoragePoolUpdateInactive(obj);\n        virStoragePoolObjSetStarting(obj, false);\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjSetStarting",
          "args": [
            "obj",
            "false"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjSetStarting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "316-321",
          "snippet": "void\nvirStoragePoolObjSetStarting(virStoragePoolObjPtr obj,\n                             bool starting)\n{\n    obj->starting = starting;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjSetStarting(virStoragePoolObjPtr obj,\n                             bool starting)\n{\n    obj->starting = starting;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolUpdateInactive",
          "args": [
            "obj"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolUpdateInactive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "120-128",
          "snippet": "static void\nvirStoragePoolUpdateInactive(virStoragePoolObjPtr obj)\n{\n    if (!virStoragePoolObjGetConfigFile(obj)) {\n        virStoragePoolObjRemove(driver->pools, obj);\n    } else if (virStoragePoolObjGetNewDef(obj)) {\n        virStoragePoolObjDefUseNewDef(obj);\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void\nvirStoragePoolUpdateInactive(virStoragePoolObjPtr obj)\n{\n    if (!virStoragePoolObjGetConfigFile(obj)) {\n        virStoragePoolObjRemove(driver->pools, obj);\n    } else if (virStoragePoolObjGetNewDef(obj)) {\n        virStoragePoolObjDefUseNewDef(obj);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsStarting",
          "args": [
            "obj"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsStarting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "324-328",
          "snippet": "bool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjSetActive",
          "args": [
            "obj",
            "true"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjSetActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "308-313",
          "snippet": "void\nvirStoragePoolObjSetActive(virStoragePoolObjPtr obj,\n                           bool active)\n{\n    obj->active = active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjSetActive(virStoragePoolObjPtr obj,\n                           bool active)\n{\n    obj->active = active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to autostart storage pool '%s': %s\")",
            "def->name",
            "virGetLastErrorMessage()"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetLastErrorMessage",
          "args": [],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to autostart storage pool '%s': %s\""
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storagePoolRefreshImpl",
          "args": [
            "backend",
            "obj",
            "stateFile"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolRefreshImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "97-109",
          "snippet": "static int\nstoragePoolRefreshImpl(virStorageBackendPtr backend,\n                       virStoragePoolObjPtr obj,\n                       const char *stateFile)\n{\n    virStoragePoolObjClearVols(obj);\n    if (backend->refreshPool(obj) < 0) {\n        storagePoolRefreshFailCleanup(backend, obj, stateFile);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolRefreshImpl(virStorageBackendPtr backend,\n                       virStoragePoolObjPtr obj,\n                       const char *stateFile)\n{\n    virStoragePoolObjClearVols(obj);\n    if (backend->refreshPool(obj) < 0) {\n        storagePoolRefreshFailCleanup(backend, obj, stateFile);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolSaveState",
          "args": [
            "stateFile",
            "def"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolSaveState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1687-1710",
          "snippet": "int\nvirStoragePoolSaveState(const char *stateFile,\n                        virStoragePoolDefPtr def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    g_autofree char *xml = NULL;\n\n    virBufferAddLit(&buf, \"<poolstate>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virStoragePoolDefFormatBuf(&buf, def) < 0)\n        return -1;\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</poolstate>\\n\");\n\n    if (!(xml = virBufferContentAndReset(&buf)))\n        return -1;\n\n    if (virStoragePoolSaveXML(stateFile, def, xml))\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirStoragePoolSaveState(const char *stateFile,\n                        virStoragePoolDefPtr def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    g_autofree char *xml = NULL;\n\n    virBufferAddLit(&buf, \"<poolstate>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virStoragePoolDefFormatBuf(&buf, def) < 0)\n        return -1;\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</poolstate>\\n\");\n\n    if (!(xml = virBufferContentAndReset(&buf)))\n        return -1;\n\n    if (virStoragePoolSaveXML(stateFile, def, xml))\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileBuildPath",
          "args": [
            "driver->stateDir",
            "def->name",
            "\".xml\""
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "virFileBuildPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3116-3128",
          "snippet": "char *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to autostart storage pool '%s': %s\")",
            "def->name",
            "virGetLastErrorMessage()"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "backend->startPool",
          "args": [
            "obj"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsAutostart",
          "args": [
            "obj"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsAutostart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "331-338",
          "snippet": "bool\nvirStoragePoolObjIsAutostart(virStoragePoolObjPtr obj)\n{\n    if (!obj->configFile)\n        return 0;\n\n    return obj->autostart;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsAutostart(virStoragePoolObjPtr obj)\n{\n    if (!obj->configFile)\n        return 0;\n\n    return obj->autostart;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageBackendForType",
          "args": [
            "def->type"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendForType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
          "lines": "172-184",
          "snippet": "virStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}",
          "includes": [
            "# include \"storage_backend_vstorage.h\"",
            "# include \"storage_backend_zfs.h\"",
            "# include \"storage_backend_gluster.h\"",
            "# include \"storage_backend_sheepdog.h\"",
            "# include \"storage_backend_rbd.h\"",
            "# include \"storage_backend_fs.h\"",
            "# include \"storage_backend_disk.h\"",
            "# include \"storage_backend_mpath.h\"",
            "# include \"storage_backend_scsi.h\"",
            "# include \"storage_backend_iscsi_direct.h\"",
            "# include \"storage_backend_iscsi.h\"",
            "# include \"storage_backend_logical.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
            "static size_t virStorageBackendsCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void\nstorageDriverAutostartCallback(virStoragePoolObjPtr obj,\n                               const void *opaque G_GNUC_UNUSED)\n{\n    virStoragePoolDefPtr def = virStoragePoolObjGetDef(obj);\n    virStorageBackendPtr backend;\n    bool started = false;\n\n    if (!(backend = virStorageBackendForType(def->type)))\n        return;\n\n    if (virStoragePoolObjIsAutostart(obj) &&\n        !virStoragePoolObjIsActive(obj)) {\n\n        virStoragePoolObjSetStarting(obj, true);\n        if (backend->startPool &&\n            backend->startPool(obj) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Failed to autostart storage pool '%s': %s\"),\n                           def->name, virGetLastErrorMessage());\n            goto cleanup;\n        }\n        started = true;\n    }\n\n    if (started) {\n        g_autofree char *stateFile = NULL;\n\n        stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\");\n        if (!stateFile ||\n            virStoragePoolSaveState(stateFile, def) < 0 ||\n            storagePoolRefreshImpl(backend, obj, stateFile) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Failed to autostart storage pool '%s': %s\"),\n                           def->name, virGetLastErrorMessage());\n        } else {\n            virStoragePoolObjSetActive(obj, true);\n        }\n    }\n\n cleanup:\n    if (virStoragePoolObjIsStarting(obj)) {\n        if (!virStoragePoolObjIsActive(obj))\n            virStoragePoolUpdateInactive(obj);\n        virStoragePoolObjSetStarting(obj, false);\n    }\n}"
  },
  {
    "function_name": "storagePoolUpdateAllState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "181-187",
    "snippet": "static void\nstoragePoolUpdateAllState(void)\n{\n    virStoragePoolObjListForEach(driver->pools,\n                                 storagePoolUpdateStateCallback,\n                                 NULL);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjListForEach",
          "args": [
            "driver->pools",
            "storagePoolUpdateStateCallback",
            "NULL"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjListForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "460-469",
          "snippet": "void\nvirStoragePoolObjListForEach(virStoragePoolObjListPtr pools,\n                             virStoragePoolObjListIterator iter,\n                             const void *opaque)\n{\n    struct _virStoragePoolObjListForEachData data = { .iter = iter,\n                                                      .opaque = opaque };\n\n    virHashForEach(pools->objs, virStoragePoolObjListForEachCb, &data);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nvirStoragePoolObjDispose(void *opaque);",
            "static void\nvirStoragePoolObjListDispose(void *opaque);",
            "static void\nvirStorageVolObjDispose(void *opaque);",
            "static void\nvirStorageVolObjListDispose(void *opaque);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nvoid\nvirStoragePoolObjListForEach(virStoragePoolObjListPtr pools,\n                             virStoragePoolObjListIterator iter,\n                             const void *opaque)\n{\n    struct _virStoragePoolObjListForEachData data = { .iter = iter,\n                                                      .opaque = opaque };\n\n    virHashForEach(pools->objs, virStoragePoolObjListForEachCb, &data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void\nstoragePoolUpdateAllState(void)\n{\n    virStoragePoolObjListForEach(driver->pools,\n                                 storagePoolUpdateStateCallback,\n                                 NULL);\n}"
  },
  {
    "function_name": "storagePoolUpdateStateCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "131-178",
    "snippet": "static void\nstoragePoolUpdateStateCallback(virStoragePoolObjPtr obj,\n                               const void *opaque G_GNUC_UNUSED)\n{\n    virStoragePoolDefPtr def = virStoragePoolObjGetDef(obj);\n    bool active = false;\n    virStorageBackendPtr backend;\n    g_autofree char *stateFile = NULL;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Missing backend %d\"), def->type);\n        return;\n    }\n\n    if (!(stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\")))\n        return;\n\n    /* Backends which do not support 'checkPool' are considered\n     * inactive by default. */\n    if (backend->checkPool &&\n        backend->checkPool(obj, &active) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to initialize storage pool '%s': %s\"),\n                       def->name, virGetLastErrorMessage());\n        unlink(stateFile);\n        active = false;\n    }\n\n    /* We can pass NULL as connection, most backends do not use\n     * it anyway, but if they do and fail, we want to log error and\n     * continue with other pools.\n     */\n    if (active &&\n        storagePoolRefreshImpl(backend, obj, stateFile) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to restart storage pool '%s': %s\"),\n                       def->name, virGetLastErrorMessage());\n        active = false;\n    }\n\n    virStoragePoolObjSetActive(obj, active);\n\n    if (!virStoragePoolObjIsActive(obj))\n        virStoragePoolUpdateInactive(obj);\n\n    return;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolUpdateInactive",
          "args": [
            "obj"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolUpdateInactive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "120-128",
          "snippet": "static void\nvirStoragePoolUpdateInactive(virStoragePoolObjPtr obj)\n{\n    if (!virStoragePoolObjGetConfigFile(obj)) {\n        virStoragePoolObjRemove(driver->pools, obj);\n    } else if (virStoragePoolObjGetNewDef(obj)) {\n        virStoragePoolObjDefUseNewDef(obj);\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void\nvirStoragePoolUpdateInactive(virStoragePoolObjPtr obj)\n{\n    if (!virStoragePoolObjGetConfigFile(obj)) {\n        virStoragePoolObjRemove(driver->pools, obj);\n    } else if (virStoragePoolObjGetNewDef(obj)) {\n        virStoragePoolObjDefUseNewDef(obj);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjSetActive",
          "args": [
            "obj",
            "active"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjSetActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "308-313",
          "snippet": "void\nvirStoragePoolObjSetActive(virStoragePoolObjPtr obj,\n                           bool active)\n{\n    obj->active = active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjSetActive(virStoragePoolObjPtr obj,\n                           bool active)\n{\n    obj->active = active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to restart storage pool '%s': %s\")",
            "def->name",
            "virGetLastErrorMessage()"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetLastErrorMessage",
          "args": [],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to restart storage pool '%s': %s\""
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "storagePoolRefreshImpl",
          "args": [
            "backend",
            "obj",
            "stateFile"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolRefreshImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "97-109",
          "snippet": "static int\nstoragePoolRefreshImpl(virStorageBackendPtr backend,\n                       virStoragePoolObjPtr obj,\n                       const char *stateFile)\n{\n    virStoragePoolObjClearVols(obj);\n    if (backend->refreshPool(obj) < 0) {\n        storagePoolRefreshFailCleanup(backend, obj, stateFile);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolRefreshImpl(virStorageBackendPtr backend,\n                       virStoragePoolObjPtr obj,\n                       const char *stateFile)\n{\n    virStoragePoolObjClearVols(obj);\n    if (backend->refreshPool(obj) < 0) {\n        storagePoolRefreshFailCleanup(backend, obj, stateFile);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "stateFile"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to initialize storage pool '%s': %s\")",
            "def->name",
            "virGetLastErrorMessage()"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "backend->checkPool",
          "args": [
            "obj",
            "&active"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileBuildPath",
          "args": [
            "driver->stateDir",
            "def->name",
            "\".xml\""
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "virFileBuildPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3116-3128",
          "snippet": "char *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Missing backend %d\")",
            "def->type"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageBackendForType",
          "args": [
            "def->type"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageBackendForType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
          "lines": "172-184",
          "snippet": "virStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}",
          "includes": [
            "# include \"storage_backend_vstorage.h\"",
            "# include \"storage_backend_zfs.h\"",
            "# include \"storage_backend_gluster.h\"",
            "# include \"storage_backend_sheepdog.h\"",
            "# include \"storage_backend_rbd.h\"",
            "# include \"storage_backend_fs.h\"",
            "# include \"storage_backend_disk.h\"",
            "# include \"storage_backend_mpath.h\"",
            "# include \"storage_backend_scsi.h\"",
            "# include \"storage_backend_iscsi_direct.h\"",
            "# include \"storage_backend_iscsi.h\"",
            "# include \"storage_backend_logical.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"internal.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
            "static size_t virStorageBackendsCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetDef",
          "args": [
            "obj"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "246-250",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void\nstoragePoolUpdateStateCallback(virStoragePoolObjPtr obj,\n                               const void *opaque G_GNUC_UNUSED)\n{\n    virStoragePoolDefPtr def = virStoragePoolObjGetDef(obj);\n    bool active = false;\n    virStorageBackendPtr backend;\n    g_autofree char *stateFile = NULL;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Missing backend %d\"), def->type);\n        return;\n    }\n\n    if (!(stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\")))\n        return;\n\n    /* Backends which do not support 'checkPool' are considered\n     * inactive by default. */\n    if (backend->checkPool &&\n        backend->checkPool(obj, &active) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to initialize storage pool '%s': %s\"),\n                       def->name, virGetLastErrorMessage());\n        unlink(stateFile);\n        active = false;\n    }\n\n    /* We can pass NULL as connection, most backends do not use\n     * it anyway, but if they do and fail, we want to log error and\n     * continue with other pools.\n     */\n    if (active &&\n        storagePoolRefreshImpl(backend, obj, stateFile) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to restart storage pool '%s': %s\"),\n                       def->name, virGetLastErrorMessage());\n        active = false;\n    }\n\n    virStoragePoolObjSetActive(obj, active);\n\n    if (!virStoragePoolObjIsActive(obj))\n        virStoragePoolUpdateInactive(obj);\n\n    return;\n}"
  },
  {
    "function_name": "virStoragePoolUpdateInactive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "120-128",
    "snippet": "static void\nvirStoragePoolUpdateInactive(virStoragePoolObjPtr obj)\n{\n    if (!virStoragePoolObjGetConfigFile(obj)) {\n        virStoragePoolObjRemove(driver->pools, obj);\n    } else if (virStoragePoolObjGetNewDef(obj)) {\n        virStoragePoolObjDefUseNewDef(obj);\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjDefUseNewDef",
          "args": [
            "obj"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjDefUseNewDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "269-275",
          "snippet": "void\nvirStoragePoolObjDefUseNewDef(virStoragePoolObjPtr obj)\n{\n    virStoragePoolDefFree(obj->def);\n    obj->def = obj->newDef;\n    obj->newDef = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjDefUseNewDef(virStoragePoolObjPtr obj)\n{\n    virStoragePoolDefFree(obj->def);\n    obj->def = obj->newDef;\n    obj->newDef = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetNewDef",
          "args": [
            "obj"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetNewDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "262-266",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetNewDef(virStoragePoolObjPtr obj)\n{\n    return obj->newDef;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetNewDef(virStoragePoolObjPtr obj)\n{\n    return obj->newDef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjRemove",
          "args": [
            "driver->pools",
            "obj"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjRemoveVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "682-708",
          "snippet": "void\nvirStoragePoolObjRemoveVol(virStoragePoolObjPtr obj,\n                           virStorageVolDefPtr voldef)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockWrite(volumes);\n    volobj = virHashLookup(volumes->objsName, voldef->name);\n    if (!volobj) {\n        VIR_INFO(\"Cannot find volume '%s' from storage pool '%s'\",\n                 voldef->name, obj->def->name);\n        virObjectRWUnlock(volumes);\n        return;\n    }\n    VIR_INFO(\"Deleting volume '%s' from storage pool '%s'\",\n             voldef->name, obj->def->name);\n\n    virObjectRef(volobj);\n    virObjectLock(volobj);\n    virHashRemoveEntry(volumes->objsKey, voldef->key);\n    virHashRemoveEntry(volumes->objsName, voldef->name);\n    virHashRemoveEntry(volumes->objsPath, voldef->target.path);\n    virStorageVolObjEndAPI(&volobj);\n\n    virObjectRWUnlock(volumes);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjRemoveVol(virStoragePoolObjPtr obj,\n                           virStorageVolDefPtr voldef)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockWrite(volumes);\n    volobj = virHashLookup(volumes->objsName, voldef->name);\n    if (!volobj) {\n        VIR_INFO(\"Cannot find volume '%s' from storage pool '%s'\",\n                 voldef->name, obj->def->name);\n        virObjectRWUnlock(volumes);\n        return;\n    }\n    VIR_INFO(\"Deleting volume '%s' from storage pool '%s'\",\n             voldef->name, obj->def->name);\n\n    virObjectRef(volobj);\n    virObjectLock(volobj);\n    virHashRemoveEntry(volumes->objsKey, voldef->key);\n    virHashRemoveEntry(volumes->objsName, voldef->name);\n    virHashRemoveEntry(volumes->objsPath, voldef->target.path);\n    virStorageVolObjEndAPI(&volobj);\n\n    virObjectRWUnlock(volumes);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjGetConfigFile",
          "args": [
            "obj"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjGetConfigFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "278-282",
          "snippet": "const char *\nvirStoragePoolObjGetConfigFile(virStoragePoolObjPtr obj)\n{\n    return obj->configFile;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nconst char *\nvirStoragePoolObjGetConfigFile(virStoragePoolObjPtr obj)\n{\n    return obj->configFile;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void\nvirStoragePoolUpdateInactive(virStoragePoolObjPtr obj)\n{\n    if (!virStoragePoolObjGetConfigFile(obj)) {\n        virStoragePoolObjRemove(driver->pools, obj);\n    } else if (virStoragePoolObjGetNewDef(obj)) {\n        virStoragePoolObjDefUseNewDef(obj);\n    }\n}"
  },
  {
    "function_name": "storagePoolRefreshImpl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "97-109",
    "snippet": "static int\nstoragePoolRefreshImpl(virStorageBackendPtr backend,\n                       virStoragePoolObjPtr obj,\n                       const char *stateFile)\n{\n    virStoragePoolObjClearVols(obj);\n    if (backend->refreshPool(obj) < 0) {\n        storagePoolRefreshFailCleanup(backend, obj, stateFile);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "storagePoolRefreshFailCleanup",
          "args": [
            "backend",
            "obj",
            "stateFile"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolRefreshFailCleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "79-94",
          "snippet": "static void\nstoragePoolRefreshFailCleanup(virStorageBackendPtr backend,\n                              virStoragePoolObjPtr obj,\n                              const char *stateFile)\n{\n    virErrorPtr orig_err;\n\n    virErrorPreserveLast(&orig_err);\n    virStoragePoolObjClearVols(obj);\n\n    if (stateFile)\n        unlink(stateFile);\n    if (backend->stopPool)\n        backend->stopPool(obj);\n    virErrorRestore(&orig_err);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nstoragePoolRefreshFailCleanup(virStorageBackendPtr backend,\n                              virStoragePoolObjPtr obj,\n                              const char *stateFile)\n{\n    virErrorPtr orig_err;\n\n    virErrorPreserveLast(&orig_err);\n    virStoragePoolObjClearVols(obj);\n\n    if (stateFile)\n        unlink(stateFile);\n    if (backend->stopPool)\n        backend->stopPool(obj);\n    virErrorRestore(&orig_err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->refreshPool",
          "args": [
            "obj"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjClearVols",
          "args": [
            "obj"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjClearVols",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "629-638",
          "snippet": "void\nvirStoragePoolObjClearVols(virStoragePoolObjPtr obj)\n{\n    if (!obj->volumes)\n        return;\n\n    virHashRemoveAll(obj->volumes->objsKey);\n    virHashRemoveAll(obj->volumes->objsName);\n    virHashRemoveAll(obj->volumes->objsPath);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjClearVols(virStoragePoolObjPtr obj)\n{\n    if (!obj->volumes)\n        return;\n\n    virHashRemoveAll(obj->volumes->objsKey);\n    virHashRemoveAll(obj->volumes->objsName);\n    virHashRemoveAll(obj->volumes->objsPath);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolRefreshImpl(virStorageBackendPtr backend,\n                       virStoragePoolObjPtr obj,\n                       const char *stateFile)\n{\n    virStoragePoolObjClearVols(obj);\n    if (backend->refreshPool(obj) < 0) {\n        storagePoolRefreshFailCleanup(backend, obj, stateFile);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "storagePoolRefreshFailCleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "79-94",
    "snippet": "static void\nstoragePoolRefreshFailCleanup(virStorageBackendPtr backend,\n                              virStoragePoolObjPtr obj,\n                              const char *stateFile)\n{\n    virErrorPtr orig_err;\n\n    virErrorPreserveLast(&orig_err);\n    virStoragePoolObjClearVols(obj);\n\n    if (stateFile)\n        unlink(stateFile);\n    if (backend->stopPool)\n        backend->stopPool(obj);\n    virErrorRestore(&orig_err);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virErrorRestore",
          "args": [
            "&orig_err"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorRestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "445-457",
          "snippet": "void\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "backend->stopPool",
          "args": [
            "obj"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "stateFile"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjClearVols",
          "args": [
            "obj"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjClearVols",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "629-638",
          "snippet": "void\nvirStoragePoolObjClearVols(virStoragePoolObjPtr obj)\n{\n    if (!obj->volumes)\n        return;\n\n    virHashRemoveAll(obj->volumes->objsKey);\n    virHashRemoveAll(obj->volumes->objsName);\n    virHashRemoveAll(obj->volumes->objsPath);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjClearVols(virStoragePoolObjPtr obj)\n{\n    if (!obj->volumes)\n        return;\n\n    virHashRemoveAll(obj->volumes->objsKey);\n    virHashRemoveAll(obj->volumes->objsName);\n    virHashRemoveAll(obj->volumes->objsPath);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virErrorPreserveLast",
          "args": [
            "&orig_err"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorPreserveLast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "424-436",
          "snippet": "void\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nstoragePoolRefreshFailCleanup(virStorageBackendPtr backend,\n                              virStoragePoolObjPtr obj,\n                              const char *stateFile)\n{\n    virErrorPtr orig_err;\n\n    virErrorPreserveLast(&orig_err);\n    virStoragePoolObjClearVols(obj);\n\n    if (stateFile)\n        unlink(stateFile);\n    if (backend->stopPool)\n        backend->stopPool(obj);\n    virErrorRestore(&orig_err);\n}"
  },
  {
    "function_name": "storageDriverUnlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "73-76",
    "snippet": "static void storageDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexUnlock",
          "args": [
            "&driver->lock"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "86-89",
          "snippet": "void virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void storageDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}"
  },
  {
    "function_name": "storageDriverLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
    "lines": "69-72",
    "snippet": "static void storageDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"storage_util.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"configmake.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_event.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"storage_driver.h\"",
      "#include \"driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "# include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexLock",
          "args": [
            "&driver->lock"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "81-84",
          "snippet": "void virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic void storageDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}"
  }
]