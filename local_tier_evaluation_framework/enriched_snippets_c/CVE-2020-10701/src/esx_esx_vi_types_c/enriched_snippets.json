[
  {
    "function_name": "ESX_VI__TEMPLATE__FREE",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "1730-1835",
    "snippet": "ESX_VI__TEMPLATE__ALLOC(Event)\n\n/* esxVI_Event_Free */\nESX_VI__TEMPLATE__FREE(Event,\n{\n    esxVI_Event_Free(&item->_next);\n    VIR_FREE(item->_actualType);\n\n    esxVI_Int_Free(&item->key);\n    esxVI_Int_Free(&item->chainId);\n    esxVI_DateTime_Free(&item->createdTime);\n    VIR_FREE(item->userName);\n    /* FIXME: datacenter is currently ignored */\n    /* FIXME: computeResource is currently ignored */\n    /* FIXME: host is currently ignored */\n    esxVI_VmEventArgument_Free(&item->vm);\n    VIR_FREE(item->fullFormattedMessage);\n})\n\n/* esxVI_Event_Validate */\nESX_VI__TEMPLATE__VALIDATE(Event,\n{\n    ESX_VI__TEMPLATE__PROPERTY__REQUIRE(key)\n    ESX_VI__TEMPLATE__PROPERTY__REQUIRE(chainId)\n    ESX_VI__TEMPLATE__PROPERTY__REQUIRE(createdTime)\n    ESX_VI__TEMPLATE__PROPERTY__REQUIRE(userName)\n    /* FIXME: datacenter is currently ignored */\n    /* FIXME: computeResource is currently ignored */\n    /* FIXME: host is currently ignored */\n})\n\n/* esxVI_Event_AppendToList */\nESX_VI__TEMPLATE__LIST__APPEND(Event)\n\n/* esxVI_Event_CastFromAnyType */\nESX_VI__TEMPLATE__DYNAMIC_CAST_FROM_ANY_TYPE(Event,\n{\n    case esxVI_Type_Other:\n        /* Just accept everything here */\n        break;\n})\n\n/* esxVI_Event_CastListFromAnyType */\nESX_VI__TEMPLATE__LIST__CAST_FROM_ANY_TYPE(Event)\n\n/* esxVI_Event_Deserialize */\nESX_VI__TEMPLATE__DESERIALIZE_EXTRA(Event, /* nothing */,\n{\n    (*ptrptr)->_actualType =\n      (char *)xmlGetNsProp(node, BAD_CAST \"type\",\n                           BAD_CAST \"http://www.w3.org/2001/XMLSchema-instance\");\n\n    if (!(*ptrptr)->_actualType) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s is missing 'type' property\"),\n                       esxVI_Type_ToString((*ptrptr)->_type));\n        goto failure;\n    }\n},\n{\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE(Int, key)\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE(Int, chainId)\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE(DateTime, createdTime)\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE_VALUE(String, userName)\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE_IGNORE(datacenter) /* FIXME */\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE_IGNORE(computeResource) /* FIXME */\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE_IGNORE(host) /* FIXME */\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE(VmEventArgument, vm)\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE_VALUE(String, fullFormattedMessage)\n\n    /* Don't warn about unexpected properties */\n    continue;\n})\n\n/* esxVI_Event_DeserializeList */\nESX_VI__TEMPLATE__LIST__DESERIALIZE(Event)\n\n\n\n#include \"esx_vi_types.generated.c\"\n\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * VI Enum: VirtualMachinePowerState (Additions)\n */\n\nint\nesxVI_VirtualMachinePowerState_ConvertToLibvirt\n  (esxVI_VirtualMachinePowerState powerState)\n{\n    switch (powerState) {\n      case esxVI_VirtualMachinePowerState_PoweredOff:\n        return VIR_DOMAIN_SHUTOFF;\n\n      case esxVI_VirtualMachinePowerState_PoweredOn:\n        return VIR_DOMAIN_RUNNING;\n\n      case esxVI_VirtualMachinePowerState_Suspended:\n        return VIR_DOMAIN_PAUSED;\n\n      case esxVI_VirtualMachinePowerState_Undefined:\n      default:\n        return VIR_DOMAIN_NOSTATE;\n    }\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "esxVI_VirtualMachinePowerState_ConvertToLibvirt",
          "args": [
            "esxVI_VirtualMachinePowerStatepowerState"
          ],
          "line": 1818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__LIST__DESERIALIZE",
          "args": [
            "Event"
          ],
          "line": 1805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE_VALUE",
          "args": [
            "String",
            "fullFormattedMessage"
          ],
          "line": 1798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE",
          "args": [
            "VmEventArgument",
            "vm"
          ],
          "line": 1797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE_IGNORE",
          "args": [
            "host"
          ],
          "line": 1796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE_VALUE",
          "args": [
            "String",
            "userName"
          ],
          "line": 1793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE",
          "args": [
            "DateTime",
            "createdTime"
          ],
          "line": 1792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE",
          "args": [
            "Int",
            "chainId"
          ],
          "line": 1791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE",
          "args": [
            "Int",
            "key"
          ],
          "line": 1790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s is missing 'type' property\")",
            "esxVI_Type_ToString((*ptrptr)->_type)"
          ],
          "line": 1783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_Type_ToString",
          "args": [
            "(*ptrptr)->_type"
          ],
          "line": 1785
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_Type_ToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "785-834",
          "snippet": "const char *\nesxVI_Type_ToString(esxVI_Type type)\n{\n    switch (type) {\n      default:\n      case esxVI_Type_Undefined:\n        return \"<undefined>\";\n\n      case esxVI_Type_Boolean:\n        return \"xsd:boolean\";\n\n      case esxVI_Type_AnyType:\n        return \"xsd:anyType\";\n\n      case esxVI_Type_String:\n        return \"xsd:string\";\n\n      case esxVI_Type_Byte:\n        return \"xsd:byte\";\n\n      case esxVI_Type_Short:\n        return \"xsd:short\";\n\n      case esxVI_Type_Int:\n        return \"xsd:int\";\n\n      case esxVI_Type_Long:\n        return \"xsd:long\";\n\n      case esxVI_Type_DateTime:\n        return \"xsd:dateTime\";\n\n      case esxVI_Type_Fault:\n        return \"Fault\";\n\n      case esxVI_Type_MethodFault:\n        return \"MethodFault\";\n\n      case esxVI_Type_ManagedObjectReference:\n        return \"ManagedObjectReference\";\n\n      case esxVI_Type_Event:\n        return \"Event\";\n\n#include \"esx_vi_types.generated.typetostring\"\n\n      case esxVI_Type_Other:\n        return \"<other>\";\n    }\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nconst char *\nesxVI_Type_ToString(esxVI_Type type)\n{\n    switch (type) {\n      default:\n      case esxVI_Type_Undefined:\n        return \"<undefined>\";\n\n      case esxVI_Type_Boolean:\n        return \"xsd:boolean\";\n\n      case esxVI_Type_AnyType:\n        return \"xsd:anyType\";\n\n      case esxVI_Type_String:\n        return \"xsd:string\";\n\n      case esxVI_Type_Byte:\n        return \"xsd:byte\";\n\n      case esxVI_Type_Short:\n        return \"xsd:short\";\n\n      case esxVI_Type_Int:\n        return \"xsd:int\";\n\n      case esxVI_Type_Long:\n        return \"xsd:long\";\n\n      case esxVI_Type_DateTime:\n        return \"xsd:dateTime\";\n\n      case esxVI_Type_Fault:\n        return \"Fault\";\n\n      case esxVI_Type_MethodFault:\n        return \"MethodFault\";\n\n      case esxVI_Type_ManagedObjectReference:\n        return \"ManagedObjectReference\";\n\n      case esxVI_Type_Event:\n        return \"Event\";\n\n#include \"esx_vi_types.generated.typetostring\"\n\n      case esxVI_Type_Other:\n        return \"<other>\";\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"%s is missing 'type' property\""
          ],
          "line": 1784
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_AnyType_TypeToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "908-916",
          "snippet": "const char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nconst char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlGetNsProp",
          "args": [
            "node",
            "BAD_CAST \"type\"",
            "BAD_CAST \"http://www.w3.org/2001/XMLSchema-instance\""
          ],
          "line": 1779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__LIST__APPEND",
          "args": [
            "Event"
          ],
          "line": 1762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__PROPERTY__REQUIRE",
          "args": [
            "userName"
          ],
          "line": 1755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__PROPERTY__REQUIRE",
          "args": [
            "createdTime"
          ],
          "line": 1754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "item->fullFormattedMessage"
          ],
          "line": 1746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_VmEventArgument_Free",
          "args": [
            "&item->vm"
          ],
          "line": 1745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "item->userName"
          ],
          "line": 1741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_DateTime_Free",
          "args": [
            "&item->createdTime"
          ],
          "line": 1740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_Int_Free",
          "args": [
            "&item->chainId"
          ],
          "line": 1739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_Int_Free",
          "args": [
            "&item->key"
          ],
          "line": 1738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "item->_actualType"
          ],
          "line": 1736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_Event_Free",
          "args": [
            "&item->_next"
          ],
          "line": 1735
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nESX_VI__TEMPLATE__ALLOC(Event)\n\n/* esxVI_Event_Free */\nESX_VI__TEMPLATE__FREE(Event,\n{\n    esxVI_Event_Free(&item->_next);\n    VIR_FREE(item->_actualType);\n\n    esxVI_Int_Free(&item->key);\n    esxVI_Int_Free(&item->chainId);\n    esxVI_DateTime_Free(&item->createdTime);\n    VIR_FREE(item->userName);\n    /* FIXME: datacenter is currently ignored */\n    /* FIXME: computeResource is currently ignored */\n    /* FIXME: host is currently ignored */\n    esxVI_VmEventArgument_Free(&item->vm);\n    VIR_FREE(item->fullFormattedMessage);\n})\n\n/* esxVI_Event_Validate */\nESX_VI__TEMPLATE__VALIDATE(Event,\n{\n    ESX_VI__TEMPLATE__PROPERTY__REQUIRE(key)\n    ESX_VI__TEMPLATE__PROPERTY__REQUIRE(chainId)\n    ESX_VI__TEMPLATE__PROPERTY__REQUIRE(createdTime)\n    ESX_VI__TEMPLATE__PROPERTY__REQUIRE(userName)\n    /* FIXME: datacenter is currently ignored */\n    /* FIXME: computeResource is currently ignored */\n    /* FIXME: host is currently ignored */\n})\n\n/* esxVI_Event_AppendToList */\nESX_VI__TEMPLATE__LIST__APPEND(Event)\n\n/* esxVI_Event_CastFromAnyType */\nESX_VI__TEMPLATE__DYNAMIC_CAST_FROM_ANY_TYPE(Event,\n{\n    case esxVI_Type_Other:\n        /* Just accept everything here */\n        break;\n})\n\n/* esxVI_Event_CastListFromAnyType */\nESX_VI__TEMPLATE__LIST__CAST_FROM_ANY_TYPE(Event)\n\n/* esxVI_Event_Deserialize */\nESX_VI__TEMPLATE__DESERIALIZE_EXTRA(Event, /* nothing */,\n{\n    (*ptrptr)->_actualType =\n      (char *)xmlGetNsProp(node, BAD_CAST \"type\",\n                           BAD_CAST \"http://www.w3.org/2001/XMLSchema-instance\");\n\n    if (!(*ptrptr)->_actualType) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s is missing 'type' property\"),\n                       esxVI_Type_ToString((*ptrptr)->_type));\n        goto failure;\n    }\n},\n{\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE(Int, key)\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE(Int, chainId)\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE(DateTime, createdTime)\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE_VALUE(String, userName)\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE_IGNORE(datacenter) /* FIXME */\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE_IGNORE(computeResource) /* FIXME */\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE_IGNORE(host) /* FIXME */\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE(VmEventArgument, vm)\n    ESX_VI__TEMPLATE__PROPERTY__DESERIALIZE_VALUE(String, fullFormattedMessage)\n\n    /* Don't warn about unexpected properties */\n    continue;\n})\n\n/* esxVI_Event_DeserializeList */\nESX_VI__TEMPLATE__LIST__DESERIALIZE(Event)\n\n\n\n#include \"esx_vi_types.generated.c\"\n\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * VI Enum: VirtualMachinePowerState (Additions)\n */\n\nint\nesxVI_VirtualMachinePowerState_ConvertToLibvirt\n  (esxVI_VirtualMachinePowerState powerState)\n{\n    switch (powerState) {\n      case esxVI_VirtualMachinePowerState_PoweredOff:\n        return VIR_DOMAIN_SHUTOFF;\n\n      case esxVI_VirtualMachinePowerState_PoweredOn:\n        return VIR_DOMAIN_RUNNING;\n\n      case esxVI_VirtualMachinePowerState_Suspended:\n        return VIR_DOMAIN_PAUSED;\n\n      case esxVI_VirtualMachinePowerState_Undefined:\n      default:\n        return VIR_DOMAIN_NOSTATE;\n    }\n}"
  },
  {
    "function_name": "esxVI_ManagedObjectReference_Deserialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "1690-1721",
    "snippet": "ESX_VI__TEMPLATE__LIST__SERIALIZE(ManagedObjectReference)\n\nint\nesxVI_ManagedObjectReference_Deserialize\n  (xmlNodePtr node, esxVI_ManagedObjectReference **managedObjectReference)\n{\n    ESX_VI_CHECK_ARG_LIST(managedObjectReference);\n\n    if (esxVI_ManagedObjectReference_Alloc(managedObjectReference) < 0)\n        return -1;\n\n    (*managedObjectReference)->type =\n      (char *)xmlGetNoNsProp(node, BAD_CAST \"type\");\n\n    if (!(*managedObjectReference)->type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"ManagedObjectReference is missing 'type' property\"));\n        goto failure;\n    }\n\n    if (esxVI_String_DeserializeValue(node,\n                                      &(*managedObjectReference)->value) < 0) {\n        goto failure;\n    }\n\n    return 0;\n\n failure:\n    esxVI_ManagedObjectReference_Free(managedObjectReference);\n\n    return -1;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "esxVI_ManagedObjectReference_Free",
          "args": [
            "managedObjectReference"
          ],
          "line": 1718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_String_DeserializeValue",
          "args": [
            "node",
            "&(*managedObjectReference)->value"
          ],
          "line": 1710
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_String_DeserializeValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "1267-1279",
          "snippet": "ESX_VI__TEMPLATE__LIST__DESERIALIZE(String)\n\nint\nesxVI_String_DeserializeValue(xmlNodePtr node, char **value)\n{\n    ESX_VI_CHECK_ARG_LIST(value);\n\n    *value = (char *)xmlNodeListGetString(node->doc, node->children, 1);\n    if (!*value)\n        *value = g_strdup(\"\");\n\n    return 0;\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nESX_VI__TEMPLATE__LIST__DESERIALIZE(String)\n\nint\nesxVI_String_DeserializeValue(xmlNodePtr node, char **value)\n{\n    ESX_VI_CHECK_ARG_LIST(value);\n\n    *value = (char *)xmlNodeListGetString(node->doc, node->children, 1);\n    if (!*value)\n        *value = g_strdup(\"\");\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"ManagedObjectReference is missing 'type' property\")"
          ],
          "line": 1705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"ManagedObjectReference is missing 'type' property\""
          ],
          "line": 1706
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_AnyType_TypeToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "908-916",
          "snippet": "const char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nconst char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlGetNoNsProp",
          "args": [
            "node",
            "BAD_CAST \"type\""
          ],
          "line": 1702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_ManagedObjectReference_Alloc",
          "args": [
            "managedObjectReference"
          ],
          "line": 1698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI_CHECK_ARG_LIST",
          "args": [
            "managedObjectReference"
          ],
          "line": 1696
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nESX_VI__TEMPLATE__LIST__SERIALIZE(ManagedObjectReference)\n\nint\nesxVI_ManagedObjectReference_Deserialize\n  (xmlNodePtr node, esxVI_ManagedObjectReference **managedObjectReference)\n{\n    ESX_VI_CHECK_ARG_LIST(managedObjectReference);\n\n    if (esxVI_ManagedObjectReference_Alloc(managedObjectReference) < 0)\n        return -1;\n\n    (*managedObjectReference)->type =\n      (char *)xmlGetNoNsProp(node, BAD_CAST \"type\");\n\n    if (!(*managedObjectReference)->type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"ManagedObjectReference is missing 'type' property\"));\n        goto failure;\n    }\n\n    if (esxVI_String_DeserializeValue(node,\n                                      &(*managedObjectReference)->value) < 0) {\n        goto failure;\n    }\n\n    return 0;\n\n failure:\n    esxVI_ManagedObjectReference_Free(managedObjectReference);\n\n    return -1;\n}"
  },
  {
    "function_name": "ESX_VI__TEMPLATE__FREE",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "1635-1687",
    "snippet": "ESX_VI__TEMPLATE__ALLOC(ManagedObjectReference)\n\n/* esxVI_ManagedObjectReference_Free */\nESX_VI__TEMPLATE__FREE(ManagedObjectReference,\n{\n    esxVI_ManagedObjectReference_Free(&item->_next);\n\n    VIR_FREE(item->type);\n    VIR_FREE(item->value);\n})\n\n/* esxVI_ManagedObjectReference_DeepCopy */\nESX_VI__TEMPLATE__DEEP_COPY(ManagedObjectReference,\n{\n    ESX_VI__TEMPLATE__PROPERTY__DEEP_COPY_VALUE(String, type)\n    ESX_VI__TEMPLATE__PROPERTY__DEEP_COPY_VALUE(String, value)\n})\n\n/* esxVI_ManagedObjectReference_AppendToList */\nESX_VI__TEMPLATE__LIST__APPEND(ManagedObjectReference)\n\n/* esxVI_ManagedObjectReference_CastFromAnyType */\nESX_VI__TEMPLATE__CAST_FROM_ANY_TYPE(ManagedObjectReference)\n\n/* esxVI_ManagedObjectReference_CastListFromAnyType */\nESX_VI__TEMPLATE__LIST__CAST_FROM_ANY_TYPE(ManagedObjectReference)\n\nint\nesxVI_ManagedObjectReference_Serialize\n  (esxVI_ManagedObjectReference *managedObjectReference,\n   const char *element, virBufferPtr output)\n{\n    if (!element || !output) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Invalid argument\"));\n        return -1;\n    }\n\n    if (!managedObjectReference)\n        return 0;\n\n    virBufferAddLit(output, \"<\");\n    virBufferAdd(output, element, -1);\n    virBufferAsprintf(output,\n                      \" xmlns=\\\"urn:vim25\\\" \"\n                      \"xsi:type=\\\"ManagedObjectReference\\\" type=\\\"%s\\\">\",\n                      managedObjectReference->type);\n\n    virBufferAdd(output, managedObjectReference->value, -1);\n\n    ESV_VI__XML_TAG__CLOSE(output, element);\n\n    return 0;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ESV_VI__XML_TAG__CLOSE",
          "args": [
            "output",
            "element"
          ],
          "line": 1684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdd",
          "args": [
            "output",
            "managedObjectReference->value",
            "-1"
          ],
          "line": 1682
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "156-169",
          "snippet": "void\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "output",
            "\" xmlns=\\\"urn:vim25\\\" \"\n                      \"xsi:type=\\\"ManagedObjectReference\\\" type=\\\"%s\\\">\"",
            "managedObjectReference->type"
          ],
          "line": 1677
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "output",
            "\"<\""
          ],
          "line": 1675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid argument\")"
          ],
          "line": 1668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid argument\""
          ],
          "line": 1668
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_AnyType_TypeToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "908-916",
          "snippet": "const char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nconst char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "esxVI_ManagedObjectReference_Serialize",
          "args": [
            "esxVI_ManagedObjectReference *managedObjectReference",
            "const char *element",
            "virBufferPtroutput"
          ],
          "line": 1663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__LIST__CAST_FROM_ANY_TYPE",
          "args": [
            "ManagedObjectReference"
          ],
          "line": 1660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__CAST_FROM_ANY_TYPE",
          "args": [
            "ManagedObjectReference"
          ],
          "line": 1657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__LIST__APPEND",
          "args": [
            "ManagedObjectReference"
          ],
          "line": 1654
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__DEEP_COPY",
          "args": [
            "ManagedObjectReference",
            "{\n    ESX_VI__TEMPLATE__PROPERTY__DEEP_COPY_VALUE(String, type)ESX_VI__TEMPLATE__PROPERTY__DEEP_COPY_VALUE(String, value)}"
          ],
          "line": 1647
        },
        "resolved": true,
        "details": {
          "function_name": "ESX_VI__TEMPLATE__DEEP_COPY",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "1390-1405",
          "snippet": "ESX_VI__TEMPLATE__LIST__APPEND(Long)\n\n/* esxVI_Long_DeepCopy */\nESX_VI__TEMPLATE__DEEP_COPY(Long,\n{\n    (*dest)->value = src->value;\n})\n\n/* esxVI_Long_CastFromAnyType */\nESX_VI__TEMPLATE__CAST_FROM_ANY_TYPE(Long)\n\n/* esxVI_Long_Serialize */\nESX_VI__TEMPLATE__SERIALIZE(Long,\n{\n    virBufferAsprintf(output, \"%lld\", (long long int)item->value);\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define ESX_VI__TEMPLATE__SERIALIZE(_type, _serialize) \\\n    ESX_VI__TEMPLATE__SERIALIZE_EXTRA(_type, /* nothing */, _serialize)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\n#define ESX_VI__TEMPLATE__SERIALIZE(_type, _serialize) \\\n    ESX_VI__TEMPLATE__SERIALIZE_EXTRA(_type, /* nothing */, _serialize)\n\nESX_VI__TEMPLATE__LIST__APPEND(Long)\n\n/* esxVI_Long_DeepCopy */\nESX_VI__TEMPLATE__DEEP_COPY(Long,\n{\n    (*dest)->value = src->value;\n})\n\n/* esxVI_Long_CastFromAnyType */\nESX_VI__TEMPLATE__CAST_FROM_ANY_TYPE(Long)\n\n/* esxVI_Long_Serialize */\nESX_VI__TEMPLATE__SERIALIZE(Long,\n{\n    virBufferAsprintf(output, \"%lld\", (long long int)item->value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__PROPERTY__DEEP_COPY_VALUE",
          "args": [
            "String",
            "value"
          ],
          "line": 1650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__PROPERTY__DEEP_COPY_VALUE",
          "args": [
            "String",
            "type"
          ],
          "line": 1649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "item->value"
          ],
          "line": 1643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "item->type"
          ],
          "line": 1642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_ManagedObjectReference_Free",
          "args": [
            "&item->_next"
          ],
          "line": 1640
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nESX_VI__TEMPLATE__ALLOC(ManagedObjectReference)\n\n/* esxVI_ManagedObjectReference_Free */\nESX_VI__TEMPLATE__FREE(ManagedObjectReference,\n{\n    esxVI_ManagedObjectReference_Free(&item->_next);\n\n    VIR_FREE(item->type);\n    VIR_FREE(item->value);\n})\n\n/* esxVI_ManagedObjectReference_DeepCopy */\nESX_VI__TEMPLATE__DEEP_COPY(ManagedObjectReference,\n{\n    ESX_VI__TEMPLATE__PROPERTY__DEEP_COPY_VALUE(String, type)\n    ESX_VI__TEMPLATE__PROPERTY__DEEP_COPY_VALUE(String, value)\n})\n\n/* esxVI_ManagedObjectReference_AppendToList */\nESX_VI__TEMPLATE__LIST__APPEND(ManagedObjectReference)\n\n/* esxVI_ManagedObjectReference_CastFromAnyType */\nESX_VI__TEMPLATE__CAST_FROM_ANY_TYPE(ManagedObjectReference)\n\n/* esxVI_ManagedObjectReference_CastListFromAnyType */\nESX_VI__TEMPLATE__LIST__CAST_FROM_ANY_TYPE(ManagedObjectReference)\n\nint\nesxVI_ManagedObjectReference_Serialize\n  (esxVI_ManagedObjectReference *managedObjectReference,\n   const char *element, virBufferPtr output)\n{\n    if (!element || !output) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Invalid argument\"));\n        return -1;\n    }\n\n    if (!managedObjectReference)\n        return 0;\n\n    virBufferAddLit(output, \"<\");\n    virBufferAdd(output, element, -1);\n    virBufferAsprintf(output,\n                      \" xmlns=\\\"urn:vim25\\\" \"\n                      \"xsi:type=\\\"ManagedObjectReference\\\" type=\\\"%s\\\">\",\n                      managedObjectReference->type);\n\n    virBufferAdd(output, managedObjectReference->value, -1);\n\n    ESV_VI__XML_TAG__CLOSE(output, element);\n\n    return 0;\n}"
  },
  {
    "function_name": "esxVI_MethodFault_Deserialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "1602-1626",
    "snippet": "int\nesxVI_MethodFault_Deserialize(xmlNodePtr node, esxVI_MethodFault **methodFault)\n{\n    ESX_VI_CHECK_ARG_LIST(methodFault);\n\n    if (esxVI_MethodFault_Alloc(methodFault) < 0)\n        return -1;\n\n    (*methodFault)->_actualType =\n      (char *)xmlGetNsProp(node, BAD_CAST \"type\",\n                           BAD_CAST \"http://www.w3.org/2001/XMLSchema-instance\");\n\n    if (!(*methodFault)->_actualType) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"MethodFault is missing 'type' property\"));\n        goto failure;\n    }\n\n    return 0;\n\n failure:\n    esxVI_MethodFault_Free(methodFault);\n\n    return -1;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "esxVI_MethodFault_Free",
          "args": [
            "methodFault"
          ],
          "line": 1623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"MethodFault is missing 'type' property\")"
          ],
          "line": 1615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"MethodFault is missing 'type' property\""
          ],
          "line": 1616
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_AnyType_TypeToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "908-916",
          "snippet": "const char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nconst char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlGetNsProp",
          "args": [
            "node",
            "BAD_CAST \"type\"",
            "BAD_CAST \"http://www.w3.org/2001/XMLSchema-instance\""
          ],
          "line": 1611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_MethodFault_Alloc",
          "args": [
            "methodFault"
          ],
          "line": 1607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI_CHECK_ARG_LIST",
          "args": [
            "methodFault"
          ],
          "line": 1605
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nint\nesxVI_MethodFault_Deserialize(xmlNodePtr node, esxVI_MethodFault **methodFault)\n{\n    ESX_VI_CHECK_ARG_LIST(methodFault);\n\n    if (esxVI_MethodFault_Alloc(methodFault) < 0)\n        return -1;\n\n    (*methodFault)->_actualType =\n      (char *)xmlGetNsProp(node, BAD_CAST \"type\",\n                           BAD_CAST \"http://www.w3.org/2001/XMLSchema-instance\");\n\n    if (!(*methodFault)->_actualType) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"MethodFault is missing 'type' property\"));\n        goto failure;\n    }\n\n    return 0;\n\n failure:\n    esxVI_MethodFault_Free(methodFault);\n\n    return -1;\n}"
  },
  {
    "function_name": "esxVI_DateTime_ConvertToCalendarTime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "1472-1554",
    "snippet": "int\nesxVI_DateTime_ConvertToCalendarTime(esxVI_DateTime *dateTime,\n                                     long long *secondsSinceEpoch)\n{\n    char *tmp;\n    g_autoptr(GDateTime) then = NULL;\n    g_autoptr(GTimeZone) tz = NULL;\n    int year, mon, mday, hour, min, sec, milliseconds;\n\n    if (!dateTime || !secondsSinceEpoch) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Invalid argument\"));\n        return -1;\n    }\n\n    /*\n     * expected format: [-]CCYY-MM-DDTHH:MM:SS[.ssssss][((+|-)HH:MM|Z)]\n     * typical example: 2010-04-05T12:13:55.316789+02:00\n     *\n     * see http://www.w3.org/TR/xmlschema-2/#dateTime\n     *\n     * map negative years to 0, since the base for time_t is the year 1970.\n     */\n    if (dateTime->value[0] == '-') {\n        *secondsSinceEpoch = 0;\n        return 0;\n    }\n\n    if (/* year */\n        virStrToLong_i(dateTime->value, &tmp, 10, &year) < 0 || *tmp != '-' ||\n        /* month */\n        virStrToLong_i(tmp+1, &tmp, 10, &mon) < 0 || *tmp != '-' ||\n        /* day */\n        virStrToLong_i(tmp+1, &tmp, 10, &mday) < 0 || *tmp != 'T' ||\n        /* hour */\n        virStrToLong_i(tmp+1, &tmp, 10, &hour) < 0 || *tmp != ':' ||\n        /* minute */\n        virStrToLong_i(tmp+1, &tmp, 10, &min) < 0 || *tmp != ':' ||\n        /* second */\n        virStrToLong_i(tmp+1, &tmp, 10, &sec) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"xsd:dateTime value '%s' has unexpected format\"),\n                       dateTime->value);\n        return -1;\n    }\n\n    if (*tmp != '\\0') {\n        /* skip .ssssss part if present */\n        if (*tmp == '.' &&\n            virStrToLong_i(tmp + 1, &tmp, 10, &milliseconds) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"xsd:dateTime value '%s' has unexpected format\"),\n                           dateTime->value);\n            return -1;\n        }\n\n        /* parse timezone offset if present. if missing assume UTC */\n        if (*tmp == '+' || *tmp == '-') {\n            tz = g_time_zone_new(tmp);\n        } else if (STREQ(tmp, \"Z\")) {\n            tz = g_time_zone_new_utc();\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"xsd:dateTime value '%s' has unexpected format\"),\n                           dateTime->value);\n            return -1;\n        }\n    } else {\n        tz = g_time_zone_new_utc();\n    }\n\n    /*\n     * xsd:dateTime represents local time relative to the optional timezone\n     * given as offset. pretend the local time is in UTC and use timegm in\n     * order to avoid interference with the timezone to this computer.\n     * apply timezone correction afterwards, because it's simpler than\n     * handling all the possible over- and underflows when trying to apply\n     * it to the tm struct.\n     */\n    then = g_date_time_new(tz, year, mon, mday, hour, min, sec);\n    *secondsSinceEpoch = (long long)g_date_time_to_unix(then);\n\n    return 0;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_date_time_to_unix",
          "args": [
            "then"
          ],
          "line": 1551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_date_time_new",
          "args": [
            "tz",
            "year",
            "mon",
            "mday",
            "hour",
            "min",
            "sec"
          ],
          "line": 1550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_time_zone_new_utc",
          "args": [],
          "line": 1539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"xsd:dateTime value '%s' has unexpected format\")",
            "dateTime->value"
          ],
          "line": 1533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"xsd:dateTime value '%s' has unexpected format\""
          ],
          "line": 1534
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_AnyType_TypeToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "908-916",
          "snippet": "const char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nconst char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_time_zone_new_utc",
          "args": [],
          "line": 1531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "tmp",
            "\"Z\""
          ],
          "line": 1530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_time_zone_new",
          "args": [
            "tmp"
          ],
          "line": 1529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"xsd:dateTime value '%s' has unexpected format\")",
            "dateTime->value"
          ],
          "line": 1521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "tmp + 1",
            "&tmp",
            "10",
            "&milliseconds"
          ],
          "line": 1520
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"xsd:dateTime value '%s' has unexpected format\")",
            "dateTime->value"
          ],
          "line": 1511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid argument\")"
          ],
          "line": 1482
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nint\nesxVI_DateTime_ConvertToCalendarTime(esxVI_DateTime *dateTime,\n                                     long long *secondsSinceEpoch)\n{\n    char *tmp;\n    g_autoptr(GDateTime) then = NULL;\n    g_autoptr(GTimeZone) tz = NULL;\n    int year, mon, mday, hour, min, sec, milliseconds;\n\n    if (!dateTime || !secondsSinceEpoch) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Invalid argument\"));\n        return -1;\n    }\n\n    /*\n     * expected format: [-]CCYY-MM-DDTHH:MM:SS[.ssssss][((+|-)HH:MM|Z)]\n     * typical example: 2010-04-05T12:13:55.316789+02:00\n     *\n     * see http://www.w3.org/TR/xmlschema-2/#dateTime\n     *\n     * map negative years to 0, since the base for time_t is the year 1970.\n     */\n    if (dateTime->value[0] == '-') {\n        *secondsSinceEpoch = 0;\n        return 0;\n    }\n\n    if (/* year */\n        virStrToLong_i(dateTime->value, &tmp, 10, &year) < 0 || *tmp != '-' ||\n        /* month */\n        virStrToLong_i(tmp+1, &tmp, 10, &mon) < 0 || *tmp != '-' ||\n        /* day */\n        virStrToLong_i(tmp+1, &tmp, 10, &mday) < 0 || *tmp != 'T' ||\n        /* hour */\n        virStrToLong_i(tmp+1, &tmp, 10, &hour) < 0 || *tmp != ':' ||\n        /* minute */\n        virStrToLong_i(tmp+1, &tmp, 10, &min) < 0 || *tmp != ':' ||\n        /* second */\n        virStrToLong_i(tmp+1, &tmp, 10, &sec) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"xsd:dateTime value '%s' has unexpected format\"),\n                       dateTime->value);\n        return -1;\n    }\n\n    if (*tmp != '\\0') {\n        /* skip .ssssss part if present */\n        if (*tmp == '.' &&\n            virStrToLong_i(tmp + 1, &tmp, 10, &milliseconds) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"xsd:dateTime value '%s' has unexpected format\"),\n                           dateTime->value);\n            return -1;\n        }\n\n        /* parse timezone offset if present. if missing assume UTC */\n        if (*tmp == '+' || *tmp == '-') {\n            tz = g_time_zone_new(tmp);\n        } else if (STREQ(tmp, \"Z\")) {\n            tz = g_time_zone_new_utc();\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"xsd:dateTime value '%s' has unexpected format\"),\n                           dateTime->value);\n            return -1;\n        }\n    } else {\n        tz = g_time_zone_new_utc();\n    }\n\n    /*\n     * xsd:dateTime represents local time relative to the optional timezone\n     * given as offset. pretend the local time is in UTC and use timegm in\n     * order to avoid interference with the timezone to this computer.\n     * apply timezone correction afterwards, because it's simpler than\n     * handling all the possible over- and underflows when trying to apply\n     * it to the tm struct.\n     */\n    then = g_date_time_new(tz, year, mon, mday, hour, min, sec);\n    *secondsSinceEpoch = (long long)g_date_time_to_unix(then);\n\n    return 0;\n}"
  },
  {
    "function_name": "ESX_VI__TEMPLATE__DEEP_COPY",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "1390-1405",
    "snippet": "ESX_VI__TEMPLATE__LIST__APPEND(Long)\n\n/* esxVI_Long_DeepCopy */\nESX_VI__TEMPLATE__DEEP_COPY(Long,\n{\n    (*dest)->value = src->value;\n})\n\n/* esxVI_Long_CastFromAnyType */\nESX_VI__TEMPLATE__CAST_FROM_ANY_TYPE(Long)\n\n/* esxVI_Long_Serialize */\nESX_VI__TEMPLATE__SERIALIZE(Long,\n{\n    virBufferAsprintf(output, \"%lld\", (long long int)item->value);\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define ESX_VI__TEMPLATE__SERIALIZE(_type, _serialize) \\\n    ESX_VI__TEMPLATE__SERIALIZE_EXTRA(_type, /* nothing */, _serialize)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "output",
            "\"%lld\"",
            "(long long int)item->value"
          ],
          "line": 1404
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__CAST_FROM_ANY_TYPE",
          "args": [
            "Long"
          ],
          "line": 1399
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\n#define ESX_VI__TEMPLATE__SERIALIZE(_type, _serialize) \\\n    ESX_VI__TEMPLATE__SERIALIZE_EXTRA(_type, /* nothing */, _serialize)\n\nESX_VI__TEMPLATE__LIST__APPEND(Long)\n\n/* esxVI_Long_DeepCopy */\nESX_VI__TEMPLATE__DEEP_COPY(Long,\n{\n    (*dest)->value = src->value;\n})\n\n/* esxVI_Long_CastFromAnyType */\nESX_VI__TEMPLATE__CAST_FROM_ANY_TYPE(Long)\n\n/* esxVI_Long_Serialize */\nESX_VI__TEMPLATE__SERIALIZE(Long,\n{\n    virBufferAsprintf(output, \"%lld\", (long long int)item->value);\n}"
  },
  {
    "function_name": "ESX_VI__TEMPLATE__SERIALIZE",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "1355-1382",
    "snippet": "ESX_VI__TEMPLATE__CAST_FROM_ANY_TYPE(Int)\n\n/* esxVI_Int_Serialize */\nESX_VI__TEMPLATE__SERIALIZE(Int,\n{\n    virBufferAsprintf(output, \"%d\", (int)item->value);\n})\n\n/* esxVI_Int_SerializeList */\nESX_VI__TEMPLATE__LIST__SERIALIZE(Int)\n\n/* esxVI_Int_Deserialize */\nESX_VI__TEMPLATE__DESERIALIZE_NUMBER(Int, \"xsd:int\", INT32_MIN, INT32_MAX)\n\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * XSD: Long\n */\n\n/* esxVI_Long_Alloc */\nESX_VI__TEMPLATE__ALLOC(Long)\n\n/* esxVI_Long_Free */\nESX_VI__TEMPLATE__FREE(Long,\n{\n    esxVI_Long_Free(&item->_next);\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define ESX_VI__TEMPLATE__SERIALIZE(_type, _serialize) \\\n    ESX_VI__TEMPLATE__SERIALIZE_EXTRA(_type, /* nothing */, _serialize)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "esxVI_Long_Free",
          "args": [
            "&item->_next"
          ],
          "line": 1381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__ALLOC",
          "args": [
            "Long"
          ],
          "line": 1376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__DESERIALIZE_NUMBER",
          "args": [
            "Int",
            "\"xsd:int\",INT32_MIN",
            "INT32_MAX"
          ],
          "line": 1367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__LIST__SERIALIZE",
          "args": [
            "Int"
          ],
          "line": 1364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "output",
            "\"%d\"",
            "(int)item->value"
          ],
          "line": 1360
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\n#define ESX_VI__TEMPLATE__SERIALIZE(_type, _serialize) \\\n    ESX_VI__TEMPLATE__SERIALIZE_EXTRA(_type, /* nothing */, _serialize)\n\nESX_VI__TEMPLATE__CAST_FROM_ANY_TYPE(Int)\n\n/* esxVI_Int_Serialize */\nESX_VI__TEMPLATE__SERIALIZE(Int,\n{\n    virBufferAsprintf(output, \"%d\", (int)item->value);\n})\n\n/* esxVI_Int_SerializeList */\nESX_VI__TEMPLATE__LIST__SERIALIZE(Int)\n\n/* esxVI_Int_Deserialize */\nESX_VI__TEMPLATE__DESERIALIZE_NUMBER(Int, \"xsd:int\", INT32_MIN, INT32_MAX)\n\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * XSD: Long\n */\n\n/* esxVI_Long_Alloc */\nESX_VI__TEMPLATE__ALLOC(Long)\n\n/* esxVI_Long_Free */\nESX_VI__TEMPLATE__FREE(Long,\n{\n    esxVI_Long_Free(&item->_next);\n}"
  },
  {
    "function_name": "ESX_VI__TEMPLATE__FREE",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "1332-1352",
    "snippet": "ESX_VI__TEMPLATE__ALLOC(Int)\n\n/* esxVI_Int_Free */\nESX_VI__TEMPLATE__FREE(Int,\n{\n    esxVI_Int_Free(&item->_next);\n})\n\n/* esxVI_Int_Validate */\nESX_VI__TEMPLATE__VALIDATE(Int,\n{\n})\n\n/* esxVI_Int_AppendToList */\nESX_VI__TEMPLATE__LIST__APPEND(Int)\n\n/* esxVI_Int_DeepCopy */\nESX_VI__TEMPLATE__DEEP_COPY(Int,\n{\n    (*dest)->value = src->value;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__LIST__APPEND",
          "args": [
            "Int"
          ],
          "line": 1346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__VALIDATE",
          "args": [
            "Int,\n{\n}"
          ],
          "line": 1341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_Int_Free",
          "args": [
            "&item->_next"
          ],
          "line": 1337
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nESX_VI__TEMPLATE__ALLOC(Int)\n\n/* esxVI_Int_Free */\nESX_VI__TEMPLATE__FREE(Int,\n{\n    esxVI_Int_Free(&item->_next);\n})\n\n/* esxVI_Int_Validate */\nESX_VI__TEMPLATE__VALIDATE(Int,\n{\n})\n\n/* esxVI_Int_AppendToList */\nESX_VI__TEMPLATE__LIST__APPEND(Int)\n\n/* esxVI_Int_DeepCopy */\nESX_VI__TEMPLATE__DEEP_COPY(Int,\n{\n    (*dest)->value = src->value;\n}"
  },
  {
    "function_name": "ESX_VI__TEMPLATE__FREE",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "1288-1308",
    "snippet": "ESX_VI__TEMPLATE__ALLOC(Byte)\n\n/* esxVI_Byte_Free */\nESX_VI__TEMPLATE__FREE(Byte,\n{\n    esxVI_Byte_Free(&item->_next);\n})\n\n/* esxVI_Byte_Validate */\nESX_VI__TEMPLATE__VALIDATE(Byte,\n{\n})\n\n/* esxVI_Byte_AppendToList */\nESX_VI__TEMPLATE__LIST__APPEND(Byte)\n\n/* esxVI_Byte_DeepCopy */\nESX_VI__TEMPLATE__DEEP_COPY(Byte,\n{\n    (*dest)->value = src->value;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__LIST__APPEND",
          "args": [
            "Byte"
          ],
          "line": 1302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__VALIDATE",
          "args": [
            "Byte,\n{\n}"
          ],
          "line": 1297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_Byte_Free",
          "args": [
            "&item->_next"
          ],
          "line": 1293
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nESX_VI__TEMPLATE__ALLOC(Byte)\n\n/* esxVI_Byte_Free */\nESX_VI__TEMPLATE__FREE(Byte,\n{\n    esxVI_Byte_Free(&item->_next);\n})\n\n/* esxVI_Byte_Validate */\nESX_VI__TEMPLATE__VALIDATE(Byte,\n{\n})\n\n/* esxVI_Byte_AppendToList */\nESX_VI__TEMPLATE__LIST__APPEND(Byte)\n\n/* esxVI_Byte_DeepCopy */\nESX_VI__TEMPLATE__DEEP_COPY(Byte,\n{\n    (*dest)->value = src->value;\n}"
  },
  {
    "function_name": "esxVI_String_DeserializeValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "1267-1279",
    "snippet": "ESX_VI__TEMPLATE__LIST__DESERIALIZE(String)\n\nint\nesxVI_String_DeserializeValue(xmlNodePtr node, char **value)\n{\n    ESX_VI_CHECK_ARG_LIST(value);\n\n    *value = (char *)xmlNodeListGetString(node->doc, node->children, 1);\n    if (!*value)\n        *value = g_strdup(\"\");\n\n    return 0;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"\""
          ],
          "line": 1276
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlNodeListGetString",
          "args": [
            "node->doc",
            "node->children",
            "1"
          ],
          "line": 1274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI_CHECK_ARG_LIST",
          "args": [
            "value"
          ],
          "line": 1272
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nESX_VI__TEMPLATE__LIST__DESERIALIZE(String)\n\nint\nesxVI_String_DeserializeValue(xmlNodePtr node, char **value)\n{\n    ESX_VI_CHECK_ARG_LIST(value);\n\n    *value = (char *)xmlNodeListGetString(node->doc, node->children, 1);\n    if (!*value)\n        *value = g_strdup(\"\");\n\n    return 0;\n}"
  },
  {
    "function_name": "esxVI_String_Deserialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "1248-1264",
    "snippet": "int\nesxVI_String_Deserialize(xmlNodePtr node, esxVI_String **string)\n{\n    ESX_VI_CHECK_ARG_LIST(string);\n\n    if (esxVI_String_Alloc(string) < 0 ||\n        esxVI_String_DeserializeValue(node, &(*string)->value) < 0) {\n        goto failure;\n    }\n\n    return 0;\n\n failure:\n    esxVI_String_Free(string);\n\n    return -1;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "esxVI_String_Free",
          "args": [
            "string"
          ],
          "line": 1261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_String_DeserializeValue",
          "args": [
            "node",
            "&(*string)->value"
          ],
          "line": 1254
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_String_DeserializeValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "1267-1279",
          "snippet": "ESX_VI__TEMPLATE__LIST__DESERIALIZE(String)\n\nint\nesxVI_String_DeserializeValue(xmlNodePtr node, char **value)\n{\n    ESX_VI_CHECK_ARG_LIST(value);\n\n    *value = (char *)xmlNodeListGetString(node->doc, node->children, 1);\n    if (!*value)\n        *value = g_strdup(\"\");\n\n    return 0;\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nESX_VI__TEMPLATE__LIST__DESERIALIZE(String)\n\nint\nesxVI_String_DeserializeValue(xmlNodePtr node, char **value)\n{\n    ESX_VI_CHECK_ARG_LIST(value);\n\n    *value = (char *)xmlNodeListGetString(node->doc, node->children, 1);\n    if (!*value)\n        *value = g_strdup(\"\");\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "esxVI_String_Alloc",
          "args": [
            "string"
          ],
          "line": 1253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI_CHECK_ARG_LIST",
          "args": [
            "string"
          ],
          "line": 1251
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nint\nesxVI_String_Deserialize(xmlNodePtr node, esxVI_String **string)\n{\n    ESX_VI_CHECK_ARG_LIST(string);\n\n    if (esxVI_String_Alloc(string) < 0 ||\n        esxVI_String_DeserializeValue(node, &(*string)->value) < 0) {\n        goto failure;\n    }\n\n    return 0;\n\n failure:\n    esxVI_String_Free(string);\n\n    return -1;\n}"
  },
  {
    "function_name": "ESX_VI__TEMPLATE__CAST_VALUE_FROM_ANY_TYPE",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "1211-1246",
    "snippet": "ESX_VI__TEMPLATE__CAST_FROM_ANY_TYPE(String)\n\n/* esxVI_String_CastValueFromAnyType */\nESX_VI__TEMPLATE__CAST_VALUE_FROM_ANY_TYPE(String, char)\n\nint\nesxVI_String_Serialize(esxVI_String *string, const char *element,\n                       virBufferPtr output)\n{\n    return esxVI_String_SerializeValue(string ? string->value : NULL,\n                                       element, output);\n}\n\n/* esxVI_String_SerializeList */\nESX_VI__TEMPLATE__LIST__SERIALIZE(String)\n\nint\nesxVI_String_SerializeValue(const char *value, const char *element,\n                            virBufferPtr output)\n{\n    if (!element || !output) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Invalid argument\"));\n        return -1;\n    }\n\n    if (!value)\n        return 0;\n\n    ESV_VI__XML_TAG__OPEN(output, element, \"xsd:string\");\n\n    virBufferAdd(output, value, -1);\n\n    ESV_VI__XML_TAG__CLOSE(output, element);\n\n    return 0;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ESV_VI__XML_TAG__CLOSE",
          "args": [
            "output",
            "element"
          ],
          "line": 1243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdd",
          "args": [
            "output",
            "value",
            "-1"
          ],
          "line": 1241
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "156-169",
          "snippet": "void\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ESV_VI__XML_TAG__OPEN",
          "args": [
            "output",
            "element",
            "\"xsd:string\""
          ],
          "line": 1239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid argument\")"
          ],
          "line": 1232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid argument\""
          ],
          "line": 1232
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_AnyType_TypeToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "908-916",
          "snippet": "const char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nconst char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nESX_VI__TEMPLATE__CAST_FROM_ANY_TYPE(String)\n\n/* esxVI_String_CastValueFromAnyType */\nESX_VI__TEMPLATE__CAST_VALUE_FROM_ANY_TYPE(String, char)\n\nint\nesxVI_String_Serialize(esxVI_String *string, const char *element,\n                       virBufferPtr output)\n{\n    return esxVI_String_SerializeValue(string ? string->value : NULL,\n                                       element, output);\n}\n\n/* esxVI_String_SerializeList */\nESX_VI__TEMPLATE__LIST__SERIALIZE(String)\n\nint\nesxVI_String_SerializeValue(const char *value, const char *element,\n                            virBufferPtr output)\n{\n    if (!element || !output) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Invalid argument\"));\n        return -1;\n    }\n\n    if (!value)\n        return 0;\n\n    ESV_VI__XML_TAG__OPEN(output, element, \"xsd:string\");\n\n    virBufferAdd(output, value, -1);\n\n    ESV_VI__XML_TAG__CLOSE(output, element);\n\n    return 0;\n}"
  },
  {
    "function_name": "esxVI_String_DeepCopyValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "1199-1208",
    "snippet": "ESX_VI__TEMPLATE__LIST__DEEP_COPY(String)\n\nint\nesxVI_String_DeepCopyValue(char **dest, const char *src)\n{\n    ESX_VI_CHECK_ARG_LIST(dest);\n\n    *dest = g_strdup(src);\n    return 0;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "src"
          ],
          "line": 1206
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ESX_VI_CHECK_ARG_LIST",
          "args": [
            "dest"
          ],
          "line": 1204
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nESX_VI__TEMPLATE__LIST__DEEP_COPY(String)\n\nint\nesxVI_String_DeepCopyValue(char **dest, const char *src)\n{\n    ESX_VI_CHECK_ARG_LIST(dest);\n\n    *dest = g_strdup(src);\n    return 0;\n}"
  },
  {
    "function_name": "esxVI_String_AppendValueListToList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "1167-1190",
    "snippet": "int\nesxVI_String_AppendValueListToList(esxVI_String **stringList,\n                                   const char *valueList)\n{\n    esxVI_String *stringListToAppend = NULL;\n    const char *value = valueList;\n\n    while (value && *value != '\\0') {\n        if (esxVI_String_AppendValueToList(&stringListToAppend, value) < 0)\n            goto failure;\n\n        value += strlen(value) + 1;\n    }\n\n    if (esxVI_String_AppendToList(stringList, stringListToAppend) < 0)\n        goto failure;\n\n    return 0;\n\n failure:\n    esxVI_String_Free(&stringListToAppend);\n\n    return -1;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "esxVI_String_Free",
          "args": [
            "&stringListToAppend"
          ],
          "line": 1187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_String_AppendToList",
          "args": [
            "stringList",
            "stringListToAppend"
          ],
          "line": 1181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 1178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_String_AppendValueToList",
          "args": [
            "&stringListToAppend",
            "value"
          ],
          "line": 1175
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_String_AppendValueToList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "1144-1165",
          "snippet": "ESX_VI__TEMPLATE__LIST__APPEND(String)\n\nint\nesxVI_String_AppendValueToList(esxVI_String **stringList, const char *value)\n{\n    esxVI_String *string = NULL;\n\n    if (esxVI_String_Alloc(&string) < 0)\n        return -1;\n\n    string->value = g_strdup(value);\n\n    if (esxVI_String_AppendToList(stringList, string) < 0)\n        goto failure;\n\n    return 0;\n\n failure:\n    esxVI_String_Free(&string);\n\n    return -1;\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nESX_VI__TEMPLATE__LIST__APPEND(String)\n\nint\nesxVI_String_AppendValueToList(esxVI_String **stringList, const char *value)\n{\n    esxVI_String *string = NULL;\n\n    if (esxVI_String_Alloc(&string) < 0)\n        return -1;\n\n    string->value = g_strdup(value);\n\n    if (esxVI_String_AppendToList(stringList, string) < 0)\n        goto failure;\n\n    return 0;\n\n failure:\n    esxVI_String_Free(&string);\n\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nint\nesxVI_String_AppendValueListToList(esxVI_String **stringList,\n                                   const char *valueList)\n{\n    esxVI_String *stringListToAppend = NULL;\n    const char *value = valueList;\n\n    while (value && *value != '\\0') {\n        if (esxVI_String_AppendValueToList(&stringListToAppend, value) < 0)\n            goto failure;\n\n        value += strlen(value) + 1;\n    }\n\n    if (esxVI_String_AppendToList(stringList, stringListToAppend) < 0)\n        goto failure;\n\n    return 0;\n\n failure:\n    esxVI_String_Free(&stringListToAppend);\n\n    return -1;\n}"
  },
  {
    "function_name": "esxVI_String_AppendValueToList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "1144-1165",
    "snippet": "ESX_VI__TEMPLATE__LIST__APPEND(String)\n\nint\nesxVI_String_AppendValueToList(esxVI_String **stringList, const char *value)\n{\n    esxVI_String *string = NULL;\n\n    if (esxVI_String_Alloc(&string) < 0)\n        return -1;\n\n    string->value = g_strdup(value);\n\n    if (esxVI_String_AppendToList(stringList, string) < 0)\n        goto failure;\n\n    return 0;\n\n failure:\n    esxVI_String_Free(&string);\n\n    return -1;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "esxVI_String_Free",
          "args": [
            "&string"
          ],
          "line": 1162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_String_AppendToList",
          "args": [
            "stringList",
            "string"
          ],
          "line": 1156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "value"
          ],
          "line": 1154
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "esxVI_String_Alloc",
          "args": [
            "&string"
          ],
          "line": 1151
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nESX_VI__TEMPLATE__LIST__APPEND(String)\n\nint\nesxVI_String_AppendValueToList(esxVI_String **stringList, const char *value)\n{\n    esxVI_String *string = NULL;\n\n    if (esxVI_String_Alloc(&string) < 0)\n        return -1;\n\n    string->value = g_strdup(value);\n\n    if (esxVI_String_AppendToList(stringList, string) < 0)\n        goto failure;\n\n    return 0;\n\n failure:\n    esxVI_String_Free(&string);\n\n    return -1;\n}"
  },
  {
    "function_name": "ESX_VI__TEMPLATE__FREE",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "1114-1141",
    "snippet": "ESX_VI__TEMPLATE__ALLOC(String)\n\n/* esxVI_String_Free */\nESX_VI__TEMPLATE__FREE(String,\n{\n    esxVI_String_Free(&item->_next);\n\n    VIR_FREE(item->value);\n})\n\n/* esxVI_String_Validate */\nESX_VI__TEMPLATE__VALIDATE(String,\n{\n    ESX_VI__TEMPLATE__PROPERTY__REQUIRE(value)\n})\n\nbool\nesxVI_String_ListContainsValue(esxVI_String *stringList, const char *value)\n{\n    esxVI_String *string;\n\n    for (string = stringList; string; string = string->_next) {\n        if (STREQ(string->value, value))\n            return true;\n    }\n\n    return false;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "string->value",
            "value"
          ],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_String_ListContainsValue",
          "args": [
            "esxVI_String *stringList",
            "const char *value"
          ],
          "line": 1131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__VALIDATE",
          "args": [
            "String",
            "{ESX_VI__TEMPLATE__PROPERTY__REQUIRE(value)}"
          ],
          "line": 1125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__PROPERTY__REQUIRE",
          "args": [
            "value"
          ],
          "line": 1127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "item->value"
          ],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_String_Free",
          "args": [
            "&item->_next"
          ],
          "line": 1119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nESX_VI__TEMPLATE__ALLOC(String)\n\n/* esxVI_String_Free */\nESX_VI__TEMPLATE__FREE(String,\n{\n    esxVI_String_Free(&item->_next);\n\n    VIR_FREE(item->value);\n})\n\n/* esxVI_String_Validate */\nESX_VI__TEMPLATE__VALIDATE(String,\n{\n    ESX_VI__TEMPLATE__PROPERTY__REQUIRE(value)\n})\n\nbool\nesxVI_String_ListContainsValue(esxVI_String *stringList, const char *value)\n{\n    esxVI_String *string;\n\n    for (string = stringList; string; string = string->_next) {\n        if (STREQ(string->value, value))\n            return true;\n    }\n\n    return false;\n}"
  },
  {
    "function_name": "esxVI_AnyType_Deserialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "994-1105",
    "snippet": "int\nesxVI_AnyType_Deserialize(xmlNodePtr node, esxVI_AnyType **anyType)\n{\n    long long int number;\n\n    ESX_VI_CHECK_ARG_LIST(anyType);\n\n    if (esxVI_AnyType_Alloc(anyType) < 0)\n        return -1;\n\n    (*anyType)->node = xmlCopyNode(node, 1);\n\n    if (!(*anyType)->node) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not copy an XML node\"));\n        goto failure;\n    }\n\n    (*anyType)->other =\n      (char *)xmlGetNsProp\n                (node, BAD_CAST \"type\",\n                 BAD_CAST \"http://www.w3.org/2001/XMLSchema-instance\");\n\n    if (!(*anyType)->other) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"AnyType is missing 'type' property\"));\n        goto failure;\n    }\n\n    (*anyType)->type = esxVI_Type_FromString((*anyType)->other);\n\n    if ((*anyType)->type == esxVI_Type_Undefined) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unknown value '%s' for AnyType 'type' property\"),\n                       (*anyType)->other);\n        goto failure;\n    }\n\n    (*anyType)->value =\n      (char *)xmlNodeListGetString(node->doc, node->children, 1);\n\n    if (!(*anyType)->value)\n        (*anyType)->value = g_strdup(\"\");\n\n#define _DESERIALIZE_NUMBER(_type, _xsdType, _name, _min, _max) \\\n        do { \\\n            if (virStrToLong_ll((*anyType)->value, NULL, 10, &number) < 0) { \\\n                virReportError(VIR_ERR_INTERNAL_ERROR, \\\n                               _(\"Unknown value '%s' for %s\"), \\\n                               (*anyType)->value, _xsdType); \\\n                goto failure; \\\n            } \\\n \\\n            if (((_min) != INT64_MIN && number < (_min)) \\\n                || ((_max) != INT64_MAX && number > (_max))) { \\\n                virReportError(VIR_ERR_INTERNAL_ERROR, \\\n                               _(\"Value '%s' is out of %s range\"), \\\n                               (*anyType)->value, _xsdType); \\\n                goto failure; \\\n            } \\\n \\\n            (*anyType)->_name = number; \\\n        } while (0)\n\n    switch ((int)(*anyType)->type) {\n      case esxVI_Type_Boolean:\n        if (STREQ((*anyType)->value, \"true\")) {\n            (*anyType)->boolean = esxVI_Boolean_True;\n        } else if (STREQ((*anyType)->value, \"false\")) {\n            (*anyType)->boolean = esxVI_Boolean_False;\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unknown value '%s' for xsd:boolean\"),\n                           (*anyType)->value);\n            goto failure;\n        }\n\n        break;\n\n      case esxVI_Type_String:\n        (*anyType)->string = (*anyType)->value;\n        break;\n\n      case esxVI_Type_Byte:\n        _DESERIALIZE_NUMBER(Byte, \"xsd:byte\", int8, INT8_MIN, INT8_MAX);\n        break;\n\n      case esxVI_Type_Short:\n        _DESERIALIZE_NUMBER(Short, \"xsd:short\", int16, INT16_MIN, INT16_MAX);\n        break;\n\n      case esxVI_Type_Int:\n        _DESERIALIZE_NUMBER(Int, \"xsd:int\", int32, INT32_MIN, INT32_MAX);\n        break;\n\n      case esxVI_Type_Long:\n        _DESERIALIZE_NUMBER(Long, \"xsd:long\", int64, INT64_MIN, INT64_MAX);\n        break;\n\n      default:\n        break;\n    }\n\n#undef _DESERIALIZE_NUMBER\n\n    return 0;\n\n failure:\n    esxVI_AnyType_Free(anyType);\n\n    return -1;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "esxVI_AnyType_Free",
          "args": [
            "anyType"
          ],
          "line": 1102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_DESERIALIZE_NUMBER",
          "args": [
            "Long",
            "\"xsd:long\"",
            "int64",
            "INT64_MIN",
            "INT64_MAX"
          ],
          "line": 1090
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_DESERIALIZE_NUMBER",
          "args": [
            "Int",
            "\"xsd:int\"",
            "int32",
            "INT32_MIN",
            "INT32_MAX"
          ],
          "line": 1086
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_DESERIALIZE_NUMBER",
          "args": [
            "Short",
            "\"xsd:short\"",
            "int16",
            "INT16_MIN",
            "INT16_MAX"
          ],
          "line": 1082
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_DESERIALIZE_NUMBER",
          "args": [
            "Byte",
            "\"xsd:byte\"",
            "int8",
            "INT8_MIN",
            "INT8_MAX"
          ],
          "line": 1078
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unknown value '%s' for xsd:boolean\")",
            "(*anyType)->value"
          ],
          "line": 1065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unknown value '%s' for xsd:boolean\""
          ],
          "line": 1066
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_AnyType_TypeToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "908-916",
          "snippet": "const char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nconst char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "(*anyType)->value",
            "\"false\""
          ],
          "line": 1062
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "(*anyType)->value",
            "\"true\""
          ],
          "line": 1060
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"\""
          ],
          "line": 1036
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlNodeListGetString",
          "args": [
            "node->doc",
            "node->children",
            "1"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unknown value '%s' for AnyType 'type' property\")",
            "(*anyType)->other"
          ],
          "line": 1026
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_Type_FromString",
          "args": [
            "(*anyType)->other"
          ],
          "line": 1023
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_Type_FromString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "836-870",
          "snippet": "esxVI_Type\nesxVI_Type_FromString(const char *type)\n{\n    if (!type || STREQ(type, \"<undefined>\")) {\n        return esxVI_Type_Undefined;\n    } else if (STREQ(type, \"xsd:boolean\")) {\n        return esxVI_Type_Boolean;\n    } else if (STREQ(type, \"xsd:anyType\")) {\n        return esxVI_Type_AnyType;\n    } else if (STREQ(type, \"xsd:string\")) {\n        return esxVI_Type_String;\n    } else if (STREQ(type, \"xsd:byte\")) {\n        return esxVI_Type_Byte;\n    } else if (STREQ(type, \"xsd:short\")) {\n        return esxVI_Type_Short;\n    } else if (STREQ(type, \"xsd:int\")) {\n        return esxVI_Type_Int;\n    } else if (STREQ(type, \"xsd:long\")) {\n        return esxVI_Type_Long;\n    } else if (STREQ(type, \"xsd:dateTime\")) {\n        return esxVI_Type_DateTime;\n    } else if (STREQ(type, \"Fault\")) {\n        return esxVI_Type_Fault;\n    } else if (STREQ(type, \"MethodFault\")) {\n        return esxVI_Type_MethodFault;\n    } else if (STREQ(type, \"ManagedObjectReference\")) {\n        return esxVI_Type_ManagedObjectReference;\n    } else if (STREQ(type, \"Event\")) {\n        return esxVI_Type_Event;\n    }\n\n#include \"esx_vi_types.generated.typefromstring\"\n\n    return esxVI_Type_Other;\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nesxVI_Type\nesxVI_Type_FromString(const char *type)\n{\n    if (!type || STREQ(type, \"<undefined>\")) {\n        return esxVI_Type_Undefined;\n    } else if (STREQ(type, \"xsd:boolean\")) {\n        return esxVI_Type_Boolean;\n    } else if (STREQ(type, \"xsd:anyType\")) {\n        return esxVI_Type_AnyType;\n    } else if (STREQ(type, \"xsd:string\")) {\n        return esxVI_Type_String;\n    } else if (STREQ(type, \"xsd:byte\")) {\n        return esxVI_Type_Byte;\n    } else if (STREQ(type, \"xsd:short\")) {\n        return esxVI_Type_Short;\n    } else if (STREQ(type, \"xsd:int\")) {\n        return esxVI_Type_Int;\n    } else if (STREQ(type, \"xsd:long\")) {\n        return esxVI_Type_Long;\n    } else if (STREQ(type, \"xsd:dateTime\")) {\n        return esxVI_Type_DateTime;\n    } else if (STREQ(type, \"Fault\")) {\n        return esxVI_Type_Fault;\n    } else if (STREQ(type, \"MethodFault\")) {\n        return esxVI_Type_MethodFault;\n    } else if (STREQ(type, \"ManagedObjectReference\")) {\n        return esxVI_Type_ManagedObjectReference;\n    } else if (STREQ(type, \"Event\")) {\n        return esxVI_Type_Event;\n    }\n\n#include \"esx_vi_types.generated.typefromstring\"\n\n    return esxVI_Type_Other;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"AnyType is missing 'type' property\")"
          ],
          "line": 1018
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlGetNsProp",
          "args": [
            "node",
            "BAD_CAST \"type\"",
            "BAD_CAST \"http://www.w3.org/2001/XMLSchema-instance\""
          ],
          "line": 1013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not copy an XML node\")"
          ],
          "line": 1007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlCopyNode",
          "args": [
            "node",
            "1"
          ],
          "line": 1004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_AnyType_Alloc",
          "args": [
            "anyType"
          ],
          "line": 1001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI_CHECK_ARG_LIST",
          "args": [
            "anyType"
          ],
          "line": 999
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nint\nesxVI_AnyType_Deserialize(xmlNodePtr node, esxVI_AnyType **anyType)\n{\n    long long int number;\n\n    ESX_VI_CHECK_ARG_LIST(anyType);\n\n    if (esxVI_AnyType_Alloc(anyType) < 0)\n        return -1;\n\n    (*anyType)->node = xmlCopyNode(node, 1);\n\n    if (!(*anyType)->node) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not copy an XML node\"));\n        goto failure;\n    }\n\n    (*anyType)->other =\n      (char *)xmlGetNsProp\n                (node, BAD_CAST \"type\",\n                 BAD_CAST \"http://www.w3.org/2001/XMLSchema-instance\");\n\n    if (!(*anyType)->other) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"AnyType is missing 'type' property\"));\n        goto failure;\n    }\n\n    (*anyType)->type = esxVI_Type_FromString((*anyType)->other);\n\n    if ((*anyType)->type == esxVI_Type_Undefined) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unknown value '%s' for AnyType 'type' property\"),\n                       (*anyType)->other);\n        goto failure;\n    }\n\n    (*anyType)->value =\n      (char *)xmlNodeListGetString(node->doc, node->children, 1);\n\n    if (!(*anyType)->value)\n        (*anyType)->value = g_strdup(\"\");\n\n#define _DESERIALIZE_NUMBER(_type, _xsdType, _name, _min, _max) \\\n        do { \\\n            if (virStrToLong_ll((*anyType)->value, NULL, 10, &number) < 0) { \\\n                virReportError(VIR_ERR_INTERNAL_ERROR, \\\n                               _(\"Unknown value '%s' for %s\"), \\\n                               (*anyType)->value, _xsdType); \\\n                goto failure; \\\n            } \\\n \\\n            if (((_min) != INT64_MIN && number < (_min)) \\\n                || ((_max) != INT64_MAX && number > (_max))) { \\\n                virReportError(VIR_ERR_INTERNAL_ERROR, \\\n                               _(\"Value '%s' is out of %s range\"), \\\n                               (*anyType)->value, _xsdType); \\\n                goto failure; \\\n            } \\\n \\\n            (*anyType)->_name = number; \\\n        } while (0)\n\n    switch ((int)(*anyType)->type) {\n      case esxVI_Type_Boolean:\n        if (STREQ((*anyType)->value, \"true\")) {\n            (*anyType)->boolean = esxVI_Boolean_True;\n        } else if (STREQ((*anyType)->value, \"false\")) {\n            (*anyType)->boolean = esxVI_Boolean_False;\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unknown value '%s' for xsd:boolean\"),\n                           (*anyType)->value);\n            goto failure;\n        }\n\n        break;\n\n      case esxVI_Type_String:\n        (*anyType)->string = (*anyType)->value;\n        break;\n\n      case esxVI_Type_Byte:\n        _DESERIALIZE_NUMBER(Byte, \"xsd:byte\", int8, INT8_MIN, INT8_MAX);\n        break;\n\n      case esxVI_Type_Short:\n        _DESERIALIZE_NUMBER(Short, \"xsd:short\", int16, INT16_MIN, INT16_MAX);\n        break;\n\n      case esxVI_Type_Int:\n        _DESERIALIZE_NUMBER(Int, \"xsd:int\", int32, INT32_MIN, INT32_MAX);\n        break;\n\n      case esxVI_Type_Long:\n        _DESERIALIZE_NUMBER(Long, \"xsd:long\", int64, INT64_MIN, INT64_MAX);\n        break;\n\n      default:\n        break;\n    }\n\n#undef _DESERIALIZE_NUMBER\n\n    return 0;\n\n failure:\n    esxVI_AnyType_Free(anyType);\n\n    return -1;\n}"
  },
  {
    "function_name": "esxVI_AnyType_DeepCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "932-992",
    "snippet": "int\nesxVI_AnyType_DeepCopy(esxVI_AnyType **dest, esxVI_AnyType *src)\n{\n    ESX_VI_CHECK_ARG_LIST(dest);\n\n    if (!src)\n        return 0;\n\n    if (esxVI_AnyType_Alloc(dest) < 0)\n        goto failure;\n\n    (*dest)->_type = src->_type;\n    (*dest)->node = xmlCopyNode(src->node, 1);\n\n    if (!(*dest)->node) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not copy an XML node\"));\n        goto failure;\n    }\n\n    (*dest)->type = src->type;\n\n    (*dest)->other = g_strdup(src->other);\n    (*dest)->value = g_strdup(src->value);\n\n    switch ((int)src->type) {\n      case esxVI_Type_Boolean:\n        (*dest)->boolean = src->boolean;\n        break;\n\n      case esxVI_Type_String:\n        (*dest)->string = (*dest)->value;\n        break;\n\n      case esxVI_Type_Byte:\n        (*dest)->int8 = src->int8;\n        break;\n\n      case esxVI_Type_Short:\n        (*dest)->int16 = src->int16;\n        break;\n\n      case esxVI_Type_Int:\n        (*dest)->int32 = src->int32;\n        break;\n\n      case esxVI_Type_Long:\n        (*dest)->int64 = src->int64;\n        break;\n\n      default:\n        break;\n    }\n\n    return 0;\n\n failure:\n    esxVI_AnyType_Free(dest);\n\n    return -1;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "esxVI_AnyType_Free",
          "args": [
            "dest"
          ],
          "line": 989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "src->value"
          ],
          "line": 955
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not copy an XML node\")"
          ],
          "line": 947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not copy an XML node\""
          ],
          "line": 948
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_AnyType_TypeToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "908-916",
          "snippet": "const char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nconst char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlCopyNode",
          "args": [
            "src->node",
            "1"
          ],
          "line": 944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_AnyType_Alloc",
          "args": [
            "dest"
          ],
          "line": 940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI_CHECK_ARG_LIST",
          "args": [
            "dest"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nint\nesxVI_AnyType_DeepCopy(esxVI_AnyType **dest, esxVI_AnyType *src)\n{\n    ESX_VI_CHECK_ARG_LIST(dest);\n\n    if (!src)\n        return 0;\n\n    if (esxVI_AnyType_Alloc(dest) < 0)\n        goto failure;\n\n    (*dest)->_type = src->_type;\n    (*dest)->node = xmlCopyNode(src->node, 1);\n\n    if (!(*dest)->node) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not copy an XML node\"));\n        goto failure;\n    }\n\n    (*dest)->type = src->type;\n\n    (*dest)->other = g_strdup(src->other);\n    (*dest)->value = g_strdup(src->value);\n\n    switch ((int)src->type) {\n      case esxVI_Type_Boolean:\n        (*dest)->boolean = src->boolean;\n        break;\n\n      case esxVI_Type_String:\n        (*dest)->string = (*dest)->value;\n        break;\n\n      case esxVI_Type_Byte:\n        (*dest)->int8 = src->int8;\n        break;\n\n      case esxVI_Type_Short:\n        (*dest)->int16 = src->int16;\n        break;\n\n      case esxVI_Type_Int:\n        (*dest)->int32 = src->int32;\n        break;\n\n      case esxVI_Type_Long:\n        (*dest)->int64 = src->int64;\n        break;\n\n      default:\n        break;\n    }\n\n    return 0;\n\n failure:\n    esxVI_AnyType_Free(dest);\n\n    return -1;\n}"
  },
  {
    "function_name": "esxVI_AnyType_ExpectType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "918-930",
    "snippet": "int\nesxVI_AnyType_ExpectType(esxVI_AnyType *anyType, esxVI_Type type)\n{\n    if (anyType->type != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Expecting type '%s' but found '%s'\"),\n                       esxVI_Type_ToString(type),\n                       esxVI_AnyType_TypeToString(anyType));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Expecting type '%s' but found '%s'\")",
            "esxVI_Type_ToString(type)",
            "esxVI_AnyType_TypeToString(anyType)"
          ],
          "line": 922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_AnyType_TypeToString",
          "args": [
            "anyType"
          ],
          "line": 925
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_AnyType_TypeToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "908-916",
          "snippet": "const char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nconst char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "esxVI_Type_ToString",
          "args": [
            "type"
          ],
          "line": 924
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_Type_ToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "785-834",
          "snippet": "const char *\nesxVI_Type_ToString(esxVI_Type type)\n{\n    switch (type) {\n      default:\n      case esxVI_Type_Undefined:\n        return \"<undefined>\";\n\n      case esxVI_Type_Boolean:\n        return \"xsd:boolean\";\n\n      case esxVI_Type_AnyType:\n        return \"xsd:anyType\";\n\n      case esxVI_Type_String:\n        return \"xsd:string\";\n\n      case esxVI_Type_Byte:\n        return \"xsd:byte\";\n\n      case esxVI_Type_Short:\n        return \"xsd:short\";\n\n      case esxVI_Type_Int:\n        return \"xsd:int\";\n\n      case esxVI_Type_Long:\n        return \"xsd:long\";\n\n      case esxVI_Type_DateTime:\n        return \"xsd:dateTime\";\n\n      case esxVI_Type_Fault:\n        return \"Fault\";\n\n      case esxVI_Type_MethodFault:\n        return \"MethodFault\";\n\n      case esxVI_Type_ManagedObjectReference:\n        return \"ManagedObjectReference\";\n\n      case esxVI_Type_Event:\n        return \"Event\";\n\n#include \"esx_vi_types.generated.typetostring\"\n\n      case esxVI_Type_Other:\n        return \"<other>\";\n    }\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nconst char *\nesxVI_Type_ToString(esxVI_Type type)\n{\n    switch (type) {\n      default:\n      case esxVI_Type_Undefined:\n        return \"<undefined>\";\n\n      case esxVI_Type_Boolean:\n        return \"xsd:boolean\";\n\n      case esxVI_Type_AnyType:\n        return \"xsd:anyType\";\n\n      case esxVI_Type_String:\n        return \"xsd:string\";\n\n      case esxVI_Type_Byte:\n        return \"xsd:byte\";\n\n      case esxVI_Type_Short:\n        return \"xsd:short\";\n\n      case esxVI_Type_Int:\n        return \"xsd:int\";\n\n      case esxVI_Type_Long:\n        return \"xsd:long\";\n\n      case esxVI_Type_DateTime:\n        return \"xsd:dateTime\";\n\n      case esxVI_Type_Fault:\n        return \"Fault\";\n\n      case esxVI_Type_MethodFault:\n        return \"MethodFault\";\n\n      case esxVI_Type_ManagedObjectReference:\n        return \"ManagedObjectReference\";\n\n      case esxVI_Type_Event:\n        return \"Event\";\n\n#include \"esx_vi_types.generated.typetostring\"\n\n      case esxVI_Type_Other:\n        return \"<other>\";\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nint\nesxVI_AnyType_ExpectType(esxVI_AnyType *anyType, esxVI_Type type)\n{\n    if (anyType->type != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Expecting type '%s' but found '%s'\"),\n                       esxVI_Type_ToString(type),\n                       esxVI_AnyType_TypeToString(anyType));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "esxVI_AnyType_TypeToString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "908-916",
    "snippet": "const char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "esxVI_Type_ToString",
          "args": [
            "anyType->type"
          ],
          "line": 914
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_Type_ToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "785-834",
          "snippet": "const char *\nesxVI_Type_ToString(esxVI_Type type)\n{\n    switch (type) {\n      default:\n      case esxVI_Type_Undefined:\n        return \"<undefined>\";\n\n      case esxVI_Type_Boolean:\n        return \"xsd:boolean\";\n\n      case esxVI_Type_AnyType:\n        return \"xsd:anyType\";\n\n      case esxVI_Type_String:\n        return \"xsd:string\";\n\n      case esxVI_Type_Byte:\n        return \"xsd:byte\";\n\n      case esxVI_Type_Short:\n        return \"xsd:short\";\n\n      case esxVI_Type_Int:\n        return \"xsd:int\";\n\n      case esxVI_Type_Long:\n        return \"xsd:long\";\n\n      case esxVI_Type_DateTime:\n        return \"xsd:dateTime\";\n\n      case esxVI_Type_Fault:\n        return \"Fault\";\n\n      case esxVI_Type_MethodFault:\n        return \"MethodFault\";\n\n      case esxVI_Type_ManagedObjectReference:\n        return \"ManagedObjectReference\";\n\n      case esxVI_Type_Event:\n        return \"Event\";\n\n#include \"esx_vi_types.generated.typetostring\"\n\n      case esxVI_Type_Other:\n        return \"<other>\";\n    }\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nconst char *\nesxVI_Type_ToString(esxVI_Type type)\n{\n    switch (type) {\n      default:\n      case esxVI_Type_Undefined:\n        return \"<undefined>\";\n\n      case esxVI_Type_Boolean:\n        return \"xsd:boolean\";\n\n      case esxVI_Type_AnyType:\n        return \"xsd:anyType\";\n\n      case esxVI_Type_String:\n        return \"xsd:string\";\n\n      case esxVI_Type_Byte:\n        return \"xsd:byte\";\n\n      case esxVI_Type_Short:\n        return \"xsd:short\";\n\n      case esxVI_Type_Int:\n        return \"xsd:int\";\n\n      case esxVI_Type_Long:\n        return \"xsd:long\";\n\n      case esxVI_Type_DateTime:\n        return \"xsd:dateTime\";\n\n      case esxVI_Type_Fault:\n        return \"Fault\";\n\n      case esxVI_Type_MethodFault:\n        return \"MethodFault\";\n\n      case esxVI_Type_ManagedObjectReference:\n        return \"ManagedObjectReference\";\n\n      case esxVI_Type_Event:\n        return \"Event\";\n\n#include \"esx_vi_types.generated.typetostring\"\n\n      case esxVI_Type_Other:\n        return \"<other>\";\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nconst char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}"
  },
  {
    "function_name": "ESX_VI__TEMPLATE__ENUMERATION__DESERIALIZE",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "886-906",
    "snippet": "ESX_VI__TEMPLATE__ENUMERATION__SERIALIZE(Boolean)\n\n/* esxVI_Boolean_Deserialize */\nESX_VI__TEMPLATE__ENUMERATION__DESERIALIZE(Boolean)\n\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * XSD: AnyType\n */\n\n/* esxVI_AnyType_Alloc */\nESX_VI__TEMPLATE__ALLOC(AnyType)\n\n/* esxVI_AnyType_Free */\nESX_VI__TEMPLATE__FREE(AnyType,\n{\n    xmlFreeNode(item->node);\n    VIR_FREE(item->other);\n    VIR_FREE(item->value);\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "item->value"
          ],
          "line": 905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "item->other"
          ],
          "line": 904
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlFreeNode",
          "args": [
            "item->node"
          ],
          "line": 903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESX_VI__TEMPLATE__ALLOC",
          "args": [
            "AnyType"
          ],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nESX_VI__TEMPLATE__ENUMERATION__SERIALIZE(Boolean)\n\n/* esxVI_Boolean_Deserialize */\nESX_VI__TEMPLATE__ENUMERATION__DESERIALIZE(Boolean)\n\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * XSD: AnyType\n */\n\n/* esxVI_AnyType_Alloc */\nESX_VI__TEMPLATE__ALLOC(AnyType)\n\n/* esxVI_AnyType_Free */\nESX_VI__TEMPLATE__FREE(AnyType,\n{\n    xmlFreeNode(item->node);\n    VIR_FREE(item->other);\n    VIR_FREE(item->value);\n}"
  },
  {
    "function_name": "esxVI_Type_FromString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "836-870",
    "snippet": "esxVI_Type\nesxVI_Type_FromString(const char *type)\n{\n    if (!type || STREQ(type, \"<undefined>\")) {\n        return esxVI_Type_Undefined;\n    } else if (STREQ(type, \"xsd:boolean\")) {\n        return esxVI_Type_Boolean;\n    } else if (STREQ(type, \"xsd:anyType\")) {\n        return esxVI_Type_AnyType;\n    } else if (STREQ(type, \"xsd:string\")) {\n        return esxVI_Type_String;\n    } else if (STREQ(type, \"xsd:byte\")) {\n        return esxVI_Type_Byte;\n    } else if (STREQ(type, \"xsd:short\")) {\n        return esxVI_Type_Short;\n    } else if (STREQ(type, \"xsd:int\")) {\n        return esxVI_Type_Int;\n    } else if (STREQ(type, \"xsd:long\")) {\n        return esxVI_Type_Long;\n    } else if (STREQ(type, \"xsd:dateTime\")) {\n        return esxVI_Type_DateTime;\n    } else if (STREQ(type, \"Fault\")) {\n        return esxVI_Type_Fault;\n    } else if (STREQ(type, \"MethodFault\")) {\n        return esxVI_Type_MethodFault;\n    } else if (STREQ(type, \"ManagedObjectReference\")) {\n        return esxVI_Type_ManagedObjectReference;\n    } else if (STREQ(type, \"Event\")) {\n        return esxVI_Type_Event;\n    }\n\n#include \"esx_vi_types.generated.typefromstring\"\n\n    return esxVI_Type_Other;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "\"Event\""
          ],
          "line": 863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "\"ManagedObjectReference\""
          ],
          "line": 861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "\"MethodFault\""
          ],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "\"Fault\""
          ],
          "line": 857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "\"xsd:dateTime\""
          ],
          "line": 855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "\"xsd:long\""
          ],
          "line": 853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "\"xsd:int\""
          ],
          "line": 851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "\"xsd:short\""
          ],
          "line": 849
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "\"xsd:byte\""
          ],
          "line": 847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "\"xsd:string\""
          ],
          "line": 845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "\"xsd:anyType\""
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "\"xsd:boolean\""
          ],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "\"<undefined>\""
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nesxVI_Type\nesxVI_Type_FromString(const char *type)\n{\n    if (!type || STREQ(type, \"<undefined>\")) {\n        return esxVI_Type_Undefined;\n    } else if (STREQ(type, \"xsd:boolean\")) {\n        return esxVI_Type_Boolean;\n    } else if (STREQ(type, \"xsd:anyType\")) {\n        return esxVI_Type_AnyType;\n    } else if (STREQ(type, \"xsd:string\")) {\n        return esxVI_Type_String;\n    } else if (STREQ(type, \"xsd:byte\")) {\n        return esxVI_Type_Byte;\n    } else if (STREQ(type, \"xsd:short\")) {\n        return esxVI_Type_Short;\n    } else if (STREQ(type, \"xsd:int\")) {\n        return esxVI_Type_Int;\n    } else if (STREQ(type, \"xsd:long\")) {\n        return esxVI_Type_Long;\n    } else if (STREQ(type, \"xsd:dateTime\")) {\n        return esxVI_Type_DateTime;\n    } else if (STREQ(type, \"Fault\")) {\n        return esxVI_Type_Fault;\n    } else if (STREQ(type, \"MethodFault\")) {\n        return esxVI_Type_MethodFault;\n    } else if (STREQ(type, \"ManagedObjectReference\")) {\n        return esxVI_Type_ManagedObjectReference;\n    } else if (STREQ(type, \"Event\")) {\n        return esxVI_Type_Event;\n    }\n\n#include \"esx_vi_types.generated.typefromstring\"\n\n    return esxVI_Type_Other;\n}"
  },
  {
    "function_name": "esxVI_Type_ToString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "785-834",
    "snippet": "const char *\nesxVI_Type_ToString(esxVI_Type type)\n{\n    switch (type) {\n      default:\n      case esxVI_Type_Undefined:\n        return \"<undefined>\";\n\n      case esxVI_Type_Boolean:\n        return \"xsd:boolean\";\n\n      case esxVI_Type_AnyType:\n        return \"xsd:anyType\";\n\n      case esxVI_Type_String:\n        return \"xsd:string\";\n\n      case esxVI_Type_Byte:\n        return \"xsd:byte\";\n\n      case esxVI_Type_Short:\n        return \"xsd:short\";\n\n      case esxVI_Type_Int:\n        return \"xsd:int\";\n\n      case esxVI_Type_Long:\n        return \"xsd:long\";\n\n      case esxVI_Type_DateTime:\n        return \"xsd:dateTime\";\n\n      case esxVI_Type_Fault:\n        return \"Fault\";\n\n      case esxVI_Type_MethodFault:\n        return \"MethodFault\";\n\n      case esxVI_Type_ManagedObjectReference:\n        return \"ManagedObjectReference\";\n\n      case esxVI_Type_Event:\n        return \"Event\";\n\n#include \"esx_vi_types.generated.typetostring\"\n\n      case esxVI_Type_Other:\n        return \"<other>\";\n    }\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nconst char *\nesxVI_Type_ToString(esxVI_Type type)\n{\n    switch (type) {\n      default:\n      case esxVI_Type_Undefined:\n        return \"<undefined>\";\n\n      case esxVI_Type_Boolean:\n        return \"xsd:boolean\";\n\n      case esxVI_Type_AnyType:\n        return \"xsd:anyType\";\n\n      case esxVI_Type_String:\n        return \"xsd:string\";\n\n      case esxVI_Type_Byte:\n        return \"xsd:byte\";\n\n      case esxVI_Type_Short:\n        return \"xsd:short\";\n\n      case esxVI_Type_Int:\n        return \"xsd:int\";\n\n      case esxVI_Type_Long:\n        return \"xsd:long\";\n\n      case esxVI_Type_DateTime:\n        return \"xsd:dateTime\";\n\n      case esxVI_Type_Fault:\n        return \"Fault\";\n\n      case esxVI_Type_MethodFault:\n        return \"MethodFault\";\n\n      case esxVI_Type_ManagedObjectReference:\n        return \"ManagedObjectReference\";\n\n      case esxVI_Type_Event:\n        return \"Event\";\n\n#include \"esx_vi_types.generated.typetostring\"\n\n      case esxVI_Type_Other:\n        return \"<other>\";\n    }\n}"
  },
  {
    "function_name": "esxVI_GetActualObjectType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
    "lines": "702-739",
    "snippet": "static int\nesxVI_GetActualObjectType(xmlNodePtr node, esxVI_Type baseType,\n                          esxVI_Type *actualType)\n{\n    int result = -1;\n    char *type = NULL;\n\n    if (!actualType || *actualType != esxVI_Type_Undefined) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Invalid argument\"));\n        return -1;\n    }\n\n    type = (char *)xmlGetNsProp\n                     (node, BAD_CAST \"type\",\n                      BAD_CAST \"http://www.w3.org/2001/XMLSchema-instance\");\n\n    if (!type) {\n        /* no actual type specified, use base type instead */\n        *actualType = baseType;\n        return 0;\n    }\n\n    *actualType = esxVI_Type_FromString(type);\n\n    if (*actualType == esxVI_Type_Undefined || *actualType == esxVI_Type_Other) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unknown value '%s' for %s 'type' property\"),\n                       type, esxVI_Type_ToString(baseType));\n        goto cleanup;\n    }\n\n    result = 0;\n\n cleanup:\n    VIR_FREE(type);\n\n    return result;\n}",
    "includes": [
      "#include \"esx_vi_types.generated.typefromstring\"",
      "#include \"esx_vi_types.generated.typetostring\"",
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"esx_vi_types.h\"",
      "#include \"esx_vi.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <libxml/parser.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "type"
          ],
          "line": 736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unknown value '%s' for %s 'type' property\")",
            "type",
            "esxVI_Type_ToString(baseType)"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esxVI_Type_ToString",
          "args": [
            "baseType"
          ],
          "line": 729
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_Type_ToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "785-834",
          "snippet": "const char *\nesxVI_Type_ToString(esxVI_Type type)\n{\n    switch (type) {\n      default:\n      case esxVI_Type_Undefined:\n        return \"<undefined>\";\n\n      case esxVI_Type_Boolean:\n        return \"xsd:boolean\";\n\n      case esxVI_Type_AnyType:\n        return \"xsd:anyType\";\n\n      case esxVI_Type_String:\n        return \"xsd:string\";\n\n      case esxVI_Type_Byte:\n        return \"xsd:byte\";\n\n      case esxVI_Type_Short:\n        return \"xsd:short\";\n\n      case esxVI_Type_Int:\n        return \"xsd:int\";\n\n      case esxVI_Type_Long:\n        return \"xsd:long\";\n\n      case esxVI_Type_DateTime:\n        return \"xsd:dateTime\";\n\n      case esxVI_Type_Fault:\n        return \"Fault\";\n\n      case esxVI_Type_MethodFault:\n        return \"MethodFault\";\n\n      case esxVI_Type_ManagedObjectReference:\n        return \"ManagedObjectReference\";\n\n      case esxVI_Type_Event:\n        return \"Event\";\n\n#include \"esx_vi_types.generated.typetostring\"\n\n      case esxVI_Type_Other:\n        return \"<other>\";\n    }\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nconst char *\nesxVI_Type_ToString(esxVI_Type type)\n{\n    switch (type) {\n      default:\n      case esxVI_Type_Undefined:\n        return \"<undefined>\";\n\n      case esxVI_Type_Boolean:\n        return \"xsd:boolean\";\n\n      case esxVI_Type_AnyType:\n        return \"xsd:anyType\";\n\n      case esxVI_Type_String:\n        return \"xsd:string\";\n\n      case esxVI_Type_Byte:\n        return \"xsd:byte\";\n\n      case esxVI_Type_Short:\n        return \"xsd:short\";\n\n      case esxVI_Type_Int:\n        return \"xsd:int\";\n\n      case esxVI_Type_Long:\n        return \"xsd:long\";\n\n      case esxVI_Type_DateTime:\n        return \"xsd:dateTime\";\n\n      case esxVI_Type_Fault:\n        return \"Fault\";\n\n      case esxVI_Type_MethodFault:\n        return \"MethodFault\";\n\n      case esxVI_Type_ManagedObjectReference:\n        return \"ManagedObjectReference\";\n\n      case esxVI_Type_Event:\n        return \"Event\";\n\n#include \"esx_vi_types.generated.typetostring\"\n\n      case esxVI_Type_Other:\n        return \"<other>\";\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unknown value '%s' for %s 'type' property\""
          ],
          "line": 728
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_AnyType_TypeToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "908-916",
          "snippet": "const char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nconst char *\nesxVI_AnyType_TypeToString(esxVI_AnyType *anyType)\n{\n    if (anyType->type == esxVI_Type_Other) {\n        return anyType->other;\n    } else {\n        return esxVI_Type_ToString(anyType->type);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "esxVI_Type_FromString",
          "args": [
            "type"
          ],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "esxVI_Type_FromString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/esx/esx_vi_types.c",
          "lines": "836-870",
          "snippet": "esxVI_Type\nesxVI_Type_FromString(const char *type)\n{\n    if (!type || STREQ(type, \"<undefined>\")) {\n        return esxVI_Type_Undefined;\n    } else if (STREQ(type, \"xsd:boolean\")) {\n        return esxVI_Type_Boolean;\n    } else if (STREQ(type, \"xsd:anyType\")) {\n        return esxVI_Type_AnyType;\n    } else if (STREQ(type, \"xsd:string\")) {\n        return esxVI_Type_String;\n    } else if (STREQ(type, \"xsd:byte\")) {\n        return esxVI_Type_Byte;\n    } else if (STREQ(type, \"xsd:short\")) {\n        return esxVI_Type_Short;\n    } else if (STREQ(type, \"xsd:int\")) {\n        return esxVI_Type_Int;\n    } else if (STREQ(type, \"xsd:long\")) {\n        return esxVI_Type_Long;\n    } else if (STREQ(type, \"xsd:dateTime\")) {\n        return esxVI_Type_DateTime;\n    } else if (STREQ(type, \"Fault\")) {\n        return esxVI_Type_Fault;\n    } else if (STREQ(type, \"MethodFault\")) {\n        return esxVI_Type_MethodFault;\n    } else if (STREQ(type, \"ManagedObjectReference\")) {\n        return esxVI_Type_ManagedObjectReference;\n    } else if (STREQ(type, \"Event\")) {\n        return esxVI_Type_Event;\n    }\n\n#include \"esx_vi_types.generated.typefromstring\"\n\n    return esxVI_Type_Other;\n}",
          "includes": [
            "#include \"esx_vi_types.generated.typefromstring\"",
            "#include \"esx_vi_types.generated.typetostring\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"esx_vi_types.h\"",
            "#include \"esx_vi.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/parser.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nesxVI_Type\nesxVI_Type_FromString(const char *type)\n{\n    if (!type || STREQ(type, \"<undefined>\")) {\n        return esxVI_Type_Undefined;\n    } else if (STREQ(type, \"xsd:boolean\")) {\n        return esxVI_Type_Boolean;\n    } else if (STREQ(type, \"xsd:anyType\")) {\n        return esxVI_Type_AnyType;\n    } else if (STREQ(type, \"xsd:string\")) {\n        return esxVI_Type_String;\n    } else if (STREQ(type, \"xsd:byte\")) {\n        return esxVI_Type_Byte;\n    } else if (STREQ(type, \"xsd:short\")) {\n        return esxVI_Type_Short;\n    } else if (STREQ(type, \"xsd:int\")) {\n        return esxVI_Type_Int;\n    } else if (STREQ(type, \"xsd:long\")) {\n        return esxVI_Type_Long;\n    } else if (STREQ(type, \"xsd:dateTime\")) {\n        return esxVI_Type_DateTime;\n    } else if (STREQ(type, \"Fault\")) {\n        return esxVI_Type_Fault;\n    } else if (STREQ(type, \"MethodFault\")) {\n        return esxVI_Type_MethodFault;\n    } else if (STREQ(type, \"ManagedObjectReference\")) {\n        return esxVI_Type_ManagedObjectReference;\n    } else if (STREQ(type, \"Event\")) {\n        return esxVI_Type_Event;\n    }\n\n#include \"esx_vi_types.generated.typefromstring\"\n\n    return esxVI_Type_Other;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlGetNsProp",
          "args": [
            "node",
            "BAD_CAST \"type\"",
            "BAD_CAST \"http://www.w3.org/2001/XMLSchema-instance\""
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid argument\")"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"esx_vi_types.generated.typefromstring\"\n#include \"esx_vi_types.generated.typetostring\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"esx_vi_types.h\"\n#include \"esx_vi.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/parser.h>\n#include <config.h>\n\nstatic int\nesxVI_GetActualObjectType(xmlNodePtr node, esxVI_Type baseType,\n                          esxVI_Type *actualType)\n{\n    int result = -1;\n    char *type = NULL;\n\n    if (!actualType || *actualType != esxVI_Type_Undefined) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Invalid argument\"));\n        return -1;\n    }\n\n    type = (char *)xmlGetNsProp\n                     (node, BAD_CAST \"type\",\n                      BAD_CAST \"http://www.w3.org/2001/XMLSchema-instance\");\n\n    if (!type) {\n        /* no actual type specified, use base type instead */\n        *actualType = baseType;\n        return 0;\n    }\n\n    *actualType = esxVI_Type_FromString(type);\n\n    if (*actualType == esxVI_Type_Undefined || *actualType == esxVI_Type_Other) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unknown value '%s' for %s 'type' property\"),\n                       type, esxVI_Type_ToString(baseType));\n        goto cleanup;\n    }\n\n    result = 0;\n\n cleanup:\n    VIR_FREE(type);\n\n    return result;\n}"
  }
]