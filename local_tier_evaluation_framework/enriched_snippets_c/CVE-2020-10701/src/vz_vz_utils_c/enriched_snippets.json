[
  {
    "function_name": "vzDomainJobUpdateTime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
    "lines": "637-656",
    "snippet": "int\nvzDomainJobUpdateTime(vzDomainJobObjPtr job)\n{\n    unsigned long long now;\n\n    if (!job->started)\n        return 0;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    if (now < job->started) {\n        VIR_WARN(\"Async job starts in the future\");\n        job->started = 0;\n        return 0;\n    }\n\n    job->elapsed = now - job->started;\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtime.h\"",
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"virstring.h\"",
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"virjson.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Async job starts in the future\""
          ],
          "line": 649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTimeMillisNow",
          "args": [
            "&now"
          ],
          "line": 645
        },
        "resolved": true,
        "details": {
          "function_name": "virTimeMillisNow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
          "lines": "214-222",
          "snippet": "int virTimeMillisNow(unsigned long long *now)\n{\n    if (virTimeMillisNowRaw(now) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to get current time\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtime.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeMillisNow(unsigned long long *now)\n{\n    if (virTimeMillisNowRaw(now) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to get current time\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvzDomainJobUpdateTime(vzDomainJobObjPtr job)\n{\n    unsigned long long now;\n\n    if (!job->started)\n        return 0;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    if (now < job->started) {\n        VIR_WARN(\"Async job starts in the future\");\n        job->started = 0;\n        return 0;\n    }\n\n    job->elapsed = now - job->started;\n    return 0;\n}"
  },
  {
    "function_name": "vzDomainObjEndJob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
    "lines": "627-635",
    "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtime.h\"",
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"virstring.h\"",
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"virjson.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCondSignal",
          "args": [
            "&pdom->job.cond"
          ],
          "line": 634
        },
        "resolved": true,
        "details": {
          "function_name": "virCondSignal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "170-173",
          "snippet": "void virCondSignal(virCondPtr c)\n{\n    pthread_cond_signal(&c->cond);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virCondSignal(virCondPtr c)\n{\n    pthread_cond_signal(&c->cond);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
  },
  {
    "function_name": "vzDomainObjBeginJob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
    "lines": "591-625",
    "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtime.h\"",
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"virstring.h\"",
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"virjson.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VZ_JOB_WAIT_TIME (1000 * 30)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"cannot acquire job mutex\")"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot acquire job mutex\""
          ],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_TIMEOUT",
            "\"%s\"",
            "_(\"cannot acquire state change lock\")"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTimeMillisNow",
          "args": [
            "&now"
          ],
          "line": 607
        },
        "resolved": true,
        "details": {
          "function_name": "virTimeMillisNow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
          "lines": "214-222",
          "snippet": "int virTimeMillisNow(unsigned long long *now)\n{\n    if (virTimeMillisNowRaw(now) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to get current time\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtime.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeMillisNow(unsigned long long *now)\n{\n    if (virTimeMillisNowRaw(now) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to get current time\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCondWaitUntil",
          "args": [
            "&pdom->job.cond",
            "&dom->parent.lock",
            "then"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "virCondWaitUntil",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "155-168",
          "snippet": "int virCondWaitUntil(virCondPtr c, virMutexPtr m, unsigned long long whenms)\n{\n    int ret;\n    struct timespec ts;\n\n    ts.tv_sec = whenms / 1000;\n    ts.tv_nsec = (whenms % 1000) * 1000000;\n\n    if ((ret = pthread_cond_timedwait(&c->cond, &m->lock, &ts)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virCondWaitUntil(virCondPtr c, virMutexPtr m, unsigned long long whenms)\n{\n    int ret;\n    struct timespec ts;\n\n    ts.tv_sec = whenms / 1000;\n    ts.tv_nsec = (whenms % 1000) * 1000000;\n\n    if ((ret = pthread_cond_timedwait(&c->cond, &m->lock, &ts)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
  },
  {
    "function_name": "vzDomObjFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
    "lines": "575-587",
    "snippet": "void\nvzDomObjFree(void* p)\n{\n    vzDomObjPtr pdom = p;\n\n    if (!pdom)\n        return;\n\n    PrlHandle_Free(pdom->sdkdom);\n    PrlHandle_Free(pdom->stats);\n    virCondDestroy(&pdom->job.cond);\n    VIR_FREE(pdom);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtime.h\"",
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"virstring.h\"",
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"virjson.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "pdom"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCondDestroy",
          "args": [
            "&pdom->job.cond"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "virCondDestroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "135-143",
          "snippet": "int virCondDestroy(virCondPtr c)\n{\n    int ret;\n    if ((ret = pthread_cond_destroy(&c->cond)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virCondDestroy(virCondPtr c)\n{\n    int ret;\n    if ((ret = pthread_cond_destroy(&c->cond)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PrlHandle_Free",
          "args": [
            "pdom->stats"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PrlHandle_Free",
          "args": [
            "pdom->sdkdom"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomObjFree(void* p)\n{\n    vzDomObjPtr pdom = p;\n\n    if (!pdom)\n        return;\n\n    PrlHandle_Free(pdom->sdkdom);\n    PrlHandle_Free(pdom->stats);\n    virCondDestroy(&pdom->job.cond);\n    VIR_FREE(pdom);\n}"
  },
  {
    "function_name": "vzDomObjAlloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
    "lines": "554-573",
    "snippet": "void*\nvzDomObjAlloc(void *opaque G_GNUC_UNUSED)\n{\n    vzDomObjPtr pdom = NULL;\n\n    if (VIR_ALLOC(pdom) < 0)\n        return NULL;\n\n    if (virCondInit(&pdom->job.cond) < 0)\n        goto error;\n\n    pdom->stats = PRL_INVALID_HANDLE;\n\n    return pdom;\n\n error:\n    VIR_FREE(pdom);\n\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtime.h\"",
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"virstring.h\"",
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"virjson.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "pdom"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCondInit",
          "args": [
            "&pdom->job.cond"
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "virCondInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "125-133",
          "snippet": "int virCondInit(virCondPtr c)\n{\n    int ret;\n    if ((ret = pthread_cond_init(&c->cond, NULL)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virCondInit(virCondPtr c)\n{\n    int ret;\n    if ((ret = pthread_cond_init(&c->cond, NULL)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "pdom"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid*\nvzDomObjAlloc(void *opaque G_GNUC_UNUSED)\n{\n    vzDomObjPtr pdom = NULL;\n\n    if (VIR_ALLOC(pdom) < 0)\n        return NULL;\n\n    if (virCondInit(&pdom->job.cond) < 0)\n        goto error;\n\n    pdom->stats = PRL_INVALID_HANDLE;\n\n    return pdom;\n\n error:\n    VIR_FREE(pdom);\n\n    return NULL;\n}"
  },
  {
    "function_name": "vzCheckUnsupportedGraphics",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
    "lines": "491-552",
    "snippet": "int vzCheckUnsupportedGraphics(virDomainGraphicsDefPtr gr)\n{\n    if (gr->type != VIR_DOMAIN_GRAPHICS_TYPE_VNC) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver supports only \"\n                         \"VNC graphics.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.websocket != 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver doesn't support \"\n                         \"websockets for VNC graphics.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.keymap != 0 &&\n        STRNEQ(gr->data.vnc.keymap, \"en-us\")) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver supports only \"\n                         \"\\\"en-us\\\" keymap for VNC graphics.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.sharePolicy == VIR_DOMAIN_GRAPHICS_VNC_SHARE_ALLOW_EXCLUSIVE) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver doesn't support \"\n                         \"exclusive share policy for VNC graphics.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.auth.connected == VIR_DOMAIN_GRAPHICS_AUTH_CONNECTED_FAIL ||\n        gr->data.vnc.auth.connected == VIR_DOMAIN_GRAPHICS_AUTH_CONNECTED_KEEP) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver doesn't support \"\n                         \"given action in case of password change.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.auth.expires) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver doesn't support \"\n                         \"setting password expire time.\"));\n        return -1;\n    }\n\n    if (gr->nListens > 1) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"vz driver doesn't support more than \"\n                         \"one listening VNC server per domain\"));\n        return -1;\n    }\n\n    if (gr->nListens == 1 &&\n        gr->listens[0].type != VIR_DOMAIN_GRAPHICS_LISTEN_TYPE_ADDRESS) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"vz driver supports only address-based VNC listening\"));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtime.h\"",
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"virstring.h\"",
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"virjson.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"vz driver supports only address-based VNC listening\")"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"vz driver supports only address-based VNC listening\""
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"vz driver doesn't support more than \"\n                         \"one listening VNC server per domain\")"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"vz driver doesn't support \"\n                         \"setting password expire time.\")"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"vz driver doesn't support \"\n                         \"given action in case of password change.\")"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"vz driver doesn't support \"\n                         \"exclusive share policy for VNC graphics.\")"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"vz driver supports only \"\n                         \"\\\"en-us\\\" keymap for VNC graphics.\")"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "gr->data.vnc.keymap",
            "\"en-us\""
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"vz driver doesn't support \"\n                         \"websockets for VNC graphics.\")"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"vz driver supports only \"\n                         \"VNC graphics.\")"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint vzCheckUnsupportedGraphics(virDomainGraphicsDefPtr gr)\n{\n    if (gr->type != VIR_DOMAIN_GRAPHICS_TYPE_VNC) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver supports only \"\n                         \"VNC graphics.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.websocket != 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver doesn't support \"\n                         \"websockets for VNC graphics.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.keymap != 0 &&\n        STRNEQ(gr->data.vnc.keymap, \"en-us\")) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver supports only \"\n                         \"\\\"en-us\\\" keymap for VNC graphics.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.sharePolicy == VIR_DOMAIN_GRAPHICS_VNC_SHARE_ALLOW_EXCLUSIVE) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver doesn't support \"\n                         \"exclusive share policy for VNC graphics.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.auth.connected == VIR_DOMAIN_GRAPHICS_AUTH_CONNECTED_FAIL ||\n        gr->data.vnc.auth.connected == VIR_DOMAIN_GRAPHICS_AUTH_CONNECTED_KEEP) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver doesn't support \"\n                         \"given action in case of password change.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.auth.expires) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver doesn't support \"\n                         \"setting password expire time.\"));\n        return -1;\n    }\n\n    if (gr->nListens > 1) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"vz driver doesn't support more than \"\n                         \"one listening VNC server per domain\"));\n        return -1;\n    }\n\n    if (gr->nListens == 1 &&\n        gr->listens[0].type != VIR_DOMAIN_GRAPHICS_LISTEN_TYPE_ADDRESS) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"vz driver supports only address-based VNC listening\"));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "vzGetDefaultSCSIModel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
    "lines": "471-489",
    "snippet": "int vzGetDefaultSCSIModel(vzDriverPtr driver,\n                          PRL_CLUSTERED_DEVICE_SUBTYPE *scsiModel)\n{\n    switch ((int)driver->vzCaps.scsiControllerModel) {\n    case VIR_DOMAIN_CONTROLLER_MODEL_SCSI_VIRTIO_SCSI:\n        *scsiModel = PCD_VIRTIO_SCSI;\n        break;\n    case VIR_DOMAIN_CONTROLLER_MODEL_SCSI_BUSLOGIC:\n        *scsiModel = PCD_BUSLOGIC;\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unknown SCSI controller model %s\"),\n                       virDomainControllerModelSCSITypeToString(\n                           driver->vzCaps.scsiControllerModel));\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtime.h\"",
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"virstring.h\"",
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"virjson.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unknown SCSI controller model %s\")",
            "virDomainControllerModelSCSITypeToString(\n                           driver->vzCaps.scsiControllerModel)"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainControllerModelSCSITypeToString",
          "args": [
            "driver->vzCaps.scsiControllerModel"
          ],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unknown SCSI controller model %s\""
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint vzGetDefaultSCSIModel(vzDriverPtr driver,\n                          PRL_CLUSTERED_DEVICE_SUBTYPE *scsiModel)\n{\n    switch ((int)driver->vzCaps.scsiControllerModel) {\n    case VIR_DOMAIN_CONTROLLER_MODEL_SCSI_VIRTIO_SCSI:\n        *scsiModel = PCD_VIRTIO_SCSI;\n        break;\n    case VIR_DOMAIN_CONTROLLER_MODEL_SCSI_BUSLOGIC:\n        *scsiModel = PCD_BUSLOGIC;\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unknown SCSI controller model %s\"),\n                       virDomainControllerModelSCSITypeToString(\n                           driver->vzCaps.scsiControllerModel));\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "vzCheckUnsupportedControllers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
    "lines": "436-469",
    "snippet": "int\nvzCheckUnsupportedControllers(const virDomainDef *def, vzCapabilitiesPtr vzCaps)\n{\n    size_t i, j;\n    virDomainControllerDefPtr controller;\n\n    for (i = 0; i < def->ncontrollers; i++) {\n        controller = def->controllers[i];\n\n        for (j = 0; vzCaps->controllerTypes[j] != VIR_DOMAIN_CONTROLLER_TYPE_LAST; j++) {\n            if (controller->type == vzCaps->controllerTypes[j])\n                break;\n        }\n\n        if (vzCaps->controllerTypes[j] == VIR_DOMAIN_CONTROLLER_TYPE_LAST) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unsupported controller type %s\"),\n                           virDomainControllerTypeToString(controller->type));\n            return -1;\n        }\n\n        if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_SCSI &&\n            controller->model != -1 &&\n            controller->model != VIR_DOMAIN_CONTROLLER_MODEL_SCSI_AUTO &&\n            controller->model != vzCaps->scsiControllerModel) {\n\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"Unsupported SCSI controller model %s\"),\n                               virDomainControllerModelSCSITypeToString(controller->model));\n                return -1;\n        }\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtime.h\"",
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"virstring.h\"",
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"virjson.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Unsupported SCSI controller model %s\")",
            "virDomainControllerModelSCSITypeToString(controller->model)"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainControllerModelSCSITypeToString",
          "args": [
            "controller->model"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unsupported SCSI controller model %s\""
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Unsupported controller type %s\")",
            "virDomainControllerTypeToString(controller->type)"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainControllerTypeToString",
          "args": [
            "controller->type"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvzCheckUnsupportedControllers(const virDomainDef *def, vzCapabilitiesPtr vzCaps)\n{\n    size_t i, j;\n    virDomainControllerDefPtr controller;\n\n    for (i = 0; i < def->ncontrollers; i++) {\n        controller = def->controllers[i];\n\n        for (j = 0; vzCaps->controllerTypes[j] != VIR_DOMAIN_CONTROLLER_TYPE_LAST; j++) {\n            if (controller->type == vzCaps->controllerTypes[j])\n                break;\n        }\n\n        if (vzCaps->controllerTypes[j] == VIR_DOMAIN_CONTROLLER_TYPE_LAST) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unsupported controller type %s\"),\n                           virDomainControllerTypeToString(controller->type));\n            return -1;\n        }\n\n        if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_SCSI &&\n            controller->model != -1 &&\n            controller->model != VIR_DOMAIN_CONTROLLER_MODEL_SCSI_AUTO &&\n            controller->model != vzCaps->scsiControllerModel) {\n\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"Unsupported SCSI controller model %s\"),\n                               virDomainControllerModelSCSITypeToString(controller->model));\n                return -1;\n        }\n    }\n    return 0;\n}"
  },
  {
    "function_name": "vzCheckUnsupportedDisk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
    "lines": "389-434",
    "snippet": "int\nvzCheckUnsupportedDisk(const virDomainDef *def,\n                       virDomainDiskDefPtr disk,\n                       vzCapabilitiesPtr vzCaps)\n{\n    size_t i;\n    virStorageFileFormat diskFormat;\n\n    if (vzCheckDiskUnsupportedParams(disk) < 0)\n        return -1;\n\n    if (disk->src->type == VIR_STORAGE_TYPE_FILE) {\n        if (disk->device == VIR_DOMAIN_DISK_DEVICE_DISK) {\n            if (IS_CT(def))\n                diskFormat = vzCaps->ctDiskFormat;\n            else\n                diskFormat = vzCaps->vmDiskFormat;\n        } else {\n            diskFormat = VIR_STORAGE_FILE_RAW;\n        }\n    } else {\n        diskFormat = VIR_STORAGE_FILE_RAW;\n    }\n\n    if (virDomainDiskGetFormat(disk) != VIR_STORAGE_FILE_NONE &&\n        virDomainDiskGetFormat(disk) != diskFormat) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported format of disk %s\"),\n                       disk->src->path);\n        return -1;\n    }\n\n    for (i = 0; vzCaps->diskBuses[i] != VIR_DOMAIN_DISK_BUS_LAST; i++) {\n        if (disk->bus == vzCaps->diskBuses[i])\n            break;\n    }\n\n    if (vzCaps->diskBuses[i] == VIR_DOMAIN_DISK_BUS_LAST) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported disk bus type %s\"),\n                       virDomainDiskBusTypeToString(disk->bus));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtime.h\"",
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"virstring.h\"",
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"virjson.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Unsupported disk bus type %s\")",
            "virDomainDiskBusTypeToString(disk->bus)"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskBusTypeToString",
          "args": [
            "disk->bus"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unsupported disk bus type %s\""
          ],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Unsupported format of disk %s\")",
            "disk->src->path"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskGetFormat",
          "args": [
            "disk"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskGetFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2202-2206",
          "snippet": "int\nvirDomainDiskGetFormat(virDomainDiskDefPtr def)\n{\n    return def->src->format;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDiskGetFormat(virDomainDiskDefPtr def)\n{\n    return def->src->format;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_CT",
          "args": [
            "def"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzCheckDiskUnsupportedParams",
          "args": [
            "disk"
          ],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "vzCheckDiskUnsupportedParams",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "264-387",
          "snippet": "static int\nvzCheckDiskUnsupportedParams(virDomainDiskDefPtr disk)\n{\n    if (disk->device != VIR_DOMAIN_DISK_DEVICE_DISK &&\n        disk->device != VIR_DOMAIN_DISK_DEVICE_CDROM) {\n\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only hard disks and cdroms are supported \"\n                         \"by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->blockio.logical_block_size ||\n        disk->blockio.physical_block_size) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk block sizes is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->blkdeviotune.total_bytes_sec ||\n        disk->blkdeviotune.read_bytes_sec ||\n        disk->blkdeviotune.write_bytes_sec ||\n        disk->blkdeviotune.total_iops_sec ||\n        disk->blkdeviotune.read_iops_sec ||\n        disk->blkdeviotune.write_iops_sec) {\n\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk io limits is not \"\n                         \"supported by vz driver yet.\"));\n        return -1;\n    }\n\n    if (disk->serial && disk->device != VIR_DOMAIN_DISK_DEVICE_DISK) {\n        VIR_INFO(\"%s\", _(\"Setting disk serial number is \"\n                         \"supported only for disk devices.\"));\n    }\n\n    if (disk->wwn) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk wwn id is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->vendor) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk vendor is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->product) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk product id is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->error_policy != VIR_DOMAIN_DISK_ERROR_POLICY_DEFAULT) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk error policy is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->iomode != VIR_DOMAIN_DISK_IO_DEFAULT &&\n        disk->iomode != VIR_DOMAIN_DISK_IO_NATIVE) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only native iomode is \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->copy_on_read) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Disk copy_on_read is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->startupPolicy != VIR_DOMAIN_STARTUP_POLICY_DEFAULT) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting up disk startup policy is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->transient) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Transient disks are not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->discard) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting up disk discard parameter is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->iothread) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting up disk io thread # is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->src->type != VIR_STORAGE_TYPE_FILE &&\n        disk->src->type != VIR_STORAGE_TYPE_BLOCK) {\n\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only disk and block storage types are \"\n                         \"supported by vz driver.\"));\n        return -1;\n\n    }\n\n    if (vzCheckDiskAddressDriveUnsupportedParams(disk) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvzCheckDiskUnsupportedParams(virDomainDiskDefPtr disk)\n{\n    if (disk->device != VIR_DOMAIN_DISK_DEVICE_DISK &&\n        disk->device != VIR_DOMAIN_DISK_DEVICE_CDROM) {\n\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only hard disks and cdroms are supported \"\n                         \"by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->blockio.logical_block_size ||\n        disk->blockio.physical_block_size) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk block sizes is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->blkdeviotune.total_bytes_sec ||\n        disk->blkdeviotune.read_bytes_sec ||\n        disk->blkdeviotune.write_bytes_sec ||\n        disk->blkdeviotune.total_iops_sec ||\n        disk->blkdeviotune.read_iops_sec ||\n        disk->blkdeviotune.write_iops_sec) {\n\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk io limits is not \"\n                         \"supported by vz driver yet.\"));\n        return -1;\n    }\n\n    if (disk->serial && disk->device != VIR_DOMAIN_DISK_DEVICE_DISK) {\n        VIR_INFO(\"%s\", _(\"Setting disk serial number is \"\n                         \"supported only for disk devices.\"));\n    }\n\n    if (disk->wwn) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk wwn id is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->vendor) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk vendor is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->product) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk product id is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->error_policy != VIR_DOMAIN_DISK_ERROR_POLICY_DEFAULT) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk error policy is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->iomode != VIR_DOMAIN_DISK_IO_DEFAULT &&\n        disk->iomode != VIR_DOMAIN_DISK_IO_NATIVE) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only native iomode is \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->copy_on_read) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Disk copy_on_read is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->startupPolicy != VIR_DOMAIN_STARTUP_POLICY_DEFAULT) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting up disk startup policy is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->transient) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Transient disks are not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->discard) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting up disk discard parameter is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->iothread) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting up disk io thread # is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->src->type != VIR_STORAGE_TYPE_FILE &&\n        disk->src->type != VIR_STORAGE_TYPE_BLOCK) {\n\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only disk and block storage types are \"\n                         \"supported by vz driver.\"));\n        return -1;\n\n    }\n\n    if (vzCheckDiskAddressDriveUnsupportedParams(disk) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvzCheckUnsupportedDisk(const virDomainDef *def,\n                       virDomainDiskDefPtr disk,\n                       vzCapabilitiesPtr vzCaps)\n{\n    size_t i;\n    virStorageFileFormat diskFormat;\n\n    if (vzCheckDiskUnsupportedParams(disk) < 0)\n        return -1;\n\n    if (disk->src->type == VIR_STORAGE_TYPE_FILE) {\n        if (disk->device == VIR_DOMAIN_DISK_DEVICE_DISK) {\n            if (IS_CT(def))\n                diskFormat = vzCaps->ctDiskFormat;\n            else\n                diskFormat = vzCaps->vmDiskFormat;\n        } else {\n            diskFormat = VIR_STORAGE_FILE_RAW;\n        }\n    } else {\n        diskFormat = VIR_STORAGE_FILE_RAW;\n    }\n\n    if (virDomainDiskGetFormat(disk) != VIR_STORAGE_FILE_NONE &&\n        virDomainDiskGetFormat(disk) != diskFormat) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported format of disk %s\"),\n                       disk->src->path);\n        return -1;\n    }\n\n    for (i = 0; vzCaps->diskBuses[i] != VIR_DOMAIN_DISK_BUS_LAST; i++) {\n        if (disk->bus == vzCaps->diskBuses[i])\n            break;\n    }\n\n    if (vzCaps->diskBuses[i] == VIR_DOMAIN_DISK_BUS_LAST) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported disk bus type %s\"),\n                       virDomainDiskBusTypeToString(disk->bus));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "vzCheckDiskUnsupportedParams",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
    "lines": "264-387",
    "snippet": "static int\nvzCheckDiskUnsupportedParams(virDomainDiskDefPtr disk)\n{\n    if (disk->device != VIR_DOMAIN_DISK_DEVICE_DISK &&\n        disk->device != VIR_DOMAIN_DISK_DEVICE_CDROM) {\n\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only hard disks and cdroms are supported \"\n                         \"by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->blockio.logical_block_size ||\n        disk->blockio.physical_block_size) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk block sizes is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->blkdeviotune.total_bytes_sec ||\n        disk->blkdeviotune.read_bytes_sec ||\n        disk->blkdeviotune.write_bytes_sec ||\n        disk->blkdeviotune.total_iops_sec ||\n        disk->blkdeviotune.read_iops_sec ||\n        disk->blkdeviotune.write_iops_sec) {\n\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk io limits is not \"\n                         \"supported by vz driver yet.\"));\n        return -1;\n    }\n\n    if (disk->serial && disk->device != VIR_DOMAIN_DISK_DEVICE_DISK) {\n        VIR_INFO(\"%s\", _(\"Setting disk serial number is \"\n                         \"supported only for disk devices.\"));\n    }\n\n    if (disk->wwn) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk wwn id is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->vendor) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk vendor is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->product) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk product id is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->error_policy != VIR_DOMAIN_DISK_ERROR_POLICY_DEFAULT) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk error policy is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->iomode != VIR_DOMAIN_DISK_IO_DEFAULT &&\n        disk->iomode != VIR_DOMAIN_DISK_IO_NATIVE) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only native iomode is \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->copy_on_read) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Disk copy_on_read is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->startupPolicy != VIR_DOMAIN_STARTUP_POLICY_DEFAULT) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting up disk startup policy is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->transient) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Transient disks are not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->discard) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting up disk discard parameter is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->iothread) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting up disk io thread # is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->src->type != VIR_STORAGE_TYPE_FILE &&\n        disk->src->type != VIR_STORAGE_TYPE_BLOCK) {\n\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only disk and block storage types are \"\n                         \"supported by vz driver.\"));\n        return -1;\n\n    }\n\n    if (vzCheckDiskAddressDriveUnsupportedParams(disk) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtime.h\"",
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"virstring.h\"",
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"virjson.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzCheckDiskAddressDriveUnsupportedParams",
          "args": [
            "disk"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "vzCheckDiskAddressDriveUnsupportedParams",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "199-262",
          "snippet": "static int\nvzCheckDiskAddressDriveUnsupportedParams(virDomainDiskDefPtr disk)\n{\n    virDomainDeviceDriveAddressPtr drive = &disk->info.addr.drive;\n    int devIdx, busIdx;\n\n    if (drive->controller > 0) {\n        /* We have only one controller of each type */\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Invalid drive address of disk %s, vz driver \"\n                         \"supports only one controller.\"), disk->dst);\n        return -1;\n    }\n\n    if (drive->target > 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Invalid drive address of disk %s, vz driver \"\n                         \"supports only target 0.\"), disk->dst);\n        return -1;\n    }\n\n    switch (disk->bus) {\n    case VIR_DOMAIN_DISK_BUS_IDE:\n        if (drive->unit > 1) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Invalid drive address of disk %s, vz driver \"\n                             \"supports only units 0-1 for IDE bus.\"),\n                           disk->dst);\n            return -1;\n        }\n        break;\n    case VIR_DOMAIN_DISK_BUS_SCSI:\n    case VIR_DOMAIN_DISK_BUS_SATA:\n        if (drive->bus > 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Invalid drive address of disk %s, vz driver \"\n                             \"supports only bus 0 for SATA and SCSI bus.\"),\n                           disk->dst);\n            return -1;\n        }\n        break;\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Specified disk bus is not supported by vz driver.\"));\n        return -1;\n    }\n\n    if (virDiskNameToBusDeviceIndex(disk, &busIdx, &devIdx) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot convert disk '%s' to bus/device index\"),\n                       disk->dst);\n        return -1;\n    }\n\n    if (busIdx != drive->bus || devIdx != drive->unit) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Invalid drive address of disk %s, vz driver \"\n                         \"does not support non default name mappings.\"),\n                       disk->dst);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvzCheckDiskAddressDriveUnsupportedParams(virDomainDiskDefPtr disk)\n{\n    virDomainDeviceDriveAddressPtr drive = &disk->info.addr.drive;\n    int devIdx, busIdx;\n\n    if (drive->controller > 0) {\n        /* We have only one controller of each type */\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Invalid drive address of disk %s, vz driver \"\n                         \"supports only one controller.\"), disk->dst);\n        return -1;\n    }\n\n    if (drive->target > 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Invalid drive address of disk %s, vz driver \"\n                         \"supports only target 0.\"), disk->dst);\n        return -1;\n    }\n\n    switch (disk->bus) {\n    case VIR_DOMAIN_DISK_BUS_IDE:\n        if (drive->unit > 1) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Invalid drive address of disk %s, vz driver \"\n                             \"supports only units 0-1 for IDE bus.\"),\n                           disk->dst);\n            return -1;\n        }\n        break;\n    case VIR_DOMAIN_DISK_BUS_SCSI:\n    case VIR_DOMAIN_DISK_BUS_SATA:\n        if (drive->bus > 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Invalid drive address of disk %s, vz driver \"\n                             \"supports only bus 0 for SATA and SCSI bus.\"),\n                           disk->dst);\n            return -1;\n        }\n        break;\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Specified disk bus is not supported by vz driver.\"));\n        return -1;\n    }\n\n    if (virDiskNameToBusDeviceIndex(disk, &busIdx, &devIdx) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot convert disk '%s' to bus/device index\"),\n                       disk->dst);\n        return -1;\n    }\n\n    if (busIdx != drive->bus || devIdx != drive->unit) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Invalid drive address of disk %s, vz driver \"\n                         \"does not support non default name mappings.\"),\n                       disk->dst);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Only disk and block storage types are \"\n                         \"supported by vz driver.\")"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Only disk and block storage types are \"\n                         \"supported by vz driver.\""
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Setting up disk io thread # is not \"\n                         \"supported by vz driver.\")"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Setting up disk discard parameter is not \"\n                         \"supported by vz driver.\")"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Transient disks are not \"\n                         \"supported by vz driver.\")"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Setting up disk startup policy is not \"\n                         \"supported by vz driver.\")"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Disk copy_on_read is not \"\n                         \"supported by vz driver.\")"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Only native iomode is \"\n                         \"supported by vz driver.\")"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Setting disk error policy is not \"\n                         \"supported by vz driver.\")"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Setting disk product id is not \"\n                         \"supported by vz driver.\")"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Setting disk vendor is not \"\n                         \"supported by vz driver.\")"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Setting disk wwn id is not \"\n                         \"supported by vz driver.\")"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"%s\"",
            "_(\"Setting disk serial number is \"\n                         \"supported only for disk devices.\")"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Setting disk io limits is not \"\n                         \"supported by vz driver yet.\")"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Setting disk block sizes is not \"\n                         \"supported by vz driver.\")"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Only hard disks and cdroms are supported \"\n                         \"by vz driver.\")"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvzCheckDiskUnsupportedParams(virDomainDiskDefPtr disk)\n{\n    if (disk->device != VIR_DOMAIN_DISK_DEVICE_DISK &&\n        disk->device != VIR_DOMAIN_DISK_DEVICE_CDROM) {\n\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only hard disks and cdroms are supported \"\n                         \"by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->blockio.logical_block_size ||\n        disk->blockio.physical_block_size) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk block sizes is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->blkdeviotune.total_bytes_sec ||\n        disk->blkdeviotune.read_bytes_sec ||\n        disk->blkdeviotune.write_bytes_sec ||\n        disk->blkdeviotune.total_iops_sec ||\n        disk->blkdeviotune.read_iops_sec ||\n        disk->blkdeviotune.write_iops_sec) {\n\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk io limits is not \"\n                         \"supported by vz driver yet.\"));\n        return -1;\n    }\n\n    if (disk->serial && disk->device != VIR_DOMAIN_DISK_DEVICE_DISK) {\n        VIR_INFO(\"%s\", _(\"Setting disk serial number is \"\n                         \"supported only for disk devices.\"));\n    }\n\n    if (disk->wwn) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk wwn id is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->vendor) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk vendor is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->product) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk product id is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->error_policy != VIR_DOMAIN_DISK_ERROR_POLICY_DEFAULT) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting disk error policy is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->iomode != VIR_DOMAIN_DISK_IO_DEFAULT &&\n        disk->iomode != VIR_DOMAIN_DISK_IO_NATIVE) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only native iomode is \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->copy_on_read) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Disk copy_on_read is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->startupPolicy != VIR_DOMAIN_STARTUP_POLICY_DEFAULT) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting up disk startup policy is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->transient) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Transient disks are not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->discard) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting up disk discard parameter is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->iothread) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Setting up disk io thread # is not \"\n                         \"supported by vz driver.\"));\n        return -1;\n    }\n\n    if (disk->src->type != VIR_STORAGE_TYPE_FILE &&\n        disk->src->type != VIR_STORAGE_TYPE_BLOCK) {\n\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only disk and block storage types are \"\n                         \"supported by vz driver.\"));\n        return -1;\n\n    }\n\n    if (vzCheckDiskAddressDriveUnsupportedParams(disk) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "vzCheckDiskAddressDriveUnsupportedParams",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
    "lines": "199-262",
    "snippet": "static int\nvzCheckDiskAddressDriveUnsupportedParams(virDomainDiskDefPtr disk)\n{\n    virDomainDeviceDriveAddressPtr drive = &disk->info.addr.drive;\n    int devIdx, busIdx;\n\n    if (drive->controller > 0) {\n        /* We have only one controller of each type */\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Invalid drive address of disk %s, vz driver \"\n                         \"supports only one controller.\"), disk->dst);\n        return -1;\n    }\n\n    if (drive->target > 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Invalid drive address of disk %s, vz driver \"\n                         \"supports only target 0.\"), disk->dst);\n        return -1;\n    }\n\n    switch (disk->bus) {\n    case VIR_DOMAIN_DISK_BUS_IDE:\n        if (drive->unit > 1) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Invalid drive address of disk %s, vz driver \"\n                             \"supports only units 0-1 for IDE bus.\"),\n                           disk->dst);\n            return -1;\n        }\n        break;\n    case VIR_DOMAIN_DISK_BUS_SCSI:\n    case VIR_DOMAIN_DISK_BUS_SATA:\n        if (drive->bus > 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Invalid drive address of disk %s, vz driver \"\n                             \"supports only bus 0 for SATA and SCSI bus.\"),\n                           disk->dst);\n            return -1;\n        }\n        break;\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Specified disk bus is not supported by vz driver.\"));\n        return -1;\n    }\n\n    if (virDiskNameToBusDeviceIndex(disk, &busIdx, &devIdx) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot convert disk '%s' to bus/device index\"),\n                       disk->dst);\n        return -1;\n    }\n\n    if (busIdx != drive->bus || devIdx != drive->unit) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Invalid drive address of disk %s, vz driver \"\n                         \"does not support non default name mappings.\"),\n                       disk->dst);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtime.h\"",
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"virstring.h\"",
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"virjson.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Invalid drive address of disk %s, vz driver \"\n                         \"does not support non default name mappings.\")",
            "disk->dst"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid drive address of disk %s, vz driver \"\n                         \"does not support non default name mappings.\""
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot convert disk '%s' to bus/device index\")",
            "disk->dst"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDiskNameToBusDeviceIndex",
          "args": [
            "disk",
            "&busIdx",
            "&devIdx"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "virDiskNameToBusDeviceIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29773-29803",
          "snippet": "int\nvirDiskNameToBusDeviceIndex(virDomainDiskDefPtr disk,\n                            int *busIdx,\n                            int *devIdx)\n{\n    int idx = virDiskNameToIndex(disk->dst);\n    if (idx < 0)\n        return -1;\n\n    switch (disk->bus) {\n        case VIR_DOMAIN_DISK_BUS_IDE:\n            *busIdx = idx / 2;\n            *devIdx = idx % 2;\n            break;\n        case VIR_DOMAIN_DISK_BUS_SCSI:\n            *busIdx = idx / 7;\n            *devIdx = idx % 7;\n            break;\n        case VIR_DOMAIN_DISK_BUS_FDC:\n        case VIR_DOMAIN_DISK_BUS_USB:\n        case VIR_DOMAIN_DISK_BUS_VIRTIO:\n        case VIR_DOMAIN_DISK_BUS_XEN:\n        case VIR_DOMAIN_DISK_BUS_SD:\n        default:\n            *busIdx = 0;\n            *devIdx = idx;\n            break;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDiskNameToBusDeviceIndex(virDomainDiskDefPtr disk,\n                            int *busIdx,\n                            int *devIdx)\n{\n    int idx = virDiskNameToIndex(disk->dst);\n    if (idx < 0)\n        return -1;\n\n    switch (disk->bus) {\n        case VIR_DOMAIN_DISK_BUS_IDE:\n            *busIdx = idx / 2;\n            *devIdx = idx % 2;\n            break;\n        case VIR_DOMAIN_DISK_BUS_SCSI:\n            *busIdx = idx / 7;\n            *devIdx = idx % 7;\n            break;\n        case VIR_DOMAIN_DISK_BUS_FDC:\n        case VIR_DOMAIN_DISK_BUS_USB:\n        case VIR_DOMAIN_DISK_BUS_VIRTIO:\n        case VIR_DOMAIN_DISK_BUS_XEN:\n        case VIR_DOMAIN_DISK_BUS_SD:\n        default:\n            *busIdx = 0;\n            *devIdx = idx;\n            break;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Specified disk bus is not supported by vz driver.\")"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Invalid drive address of disk %s, vz driver \"\n                             \"supports only bus 0 for SATA and SCSI bus.\")",
            "disk->dst"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Invalid drive address of disk %s, vz driver \"\n                             \"supports only units 0-1 for IDE bus.\")",
            "disk->dst"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Invalid drive address of disk %s, vz driver \"\n                         \"supports only target 0.\")",
            "disk->dst"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Invalid drive address of disk %s, vz driver \"\n                         \"supports only one controller.\")",
            "disk->dst"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvzCheckDiskAddressDriveUnsupportedParams(virDomainDiskDefPtr disk)\n{\n    virDomainDeviceDriveAddressPtr drive = &disk->info.addr.drive;\n    int devIdx, busIdx;\n\n    if (drive->controller > 0) {\n        /* We have only one controller of each type */\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Invalid drive address of disk %s, vz driver \"\n                         \"supports only one controller.\"), disk->dst);\n        return -1;\n    }\n\n    if (drive->target > 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Invalid drive address of disk %s, vz driver \"\n                         \"supports only target 0.\"), disk->dst);\n        return -1;\n    }\n\n    switch (disk->bus) {\n    case VIR_DOMAIN_DISK_BUS_IDE:\n        if (drive->unit > 1) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Invalid drive address of disk %s, vz driver \"\n                             \"supports only units 0-1 for IDE bus.\"),\n                           disk->dst);\n            return -1;\n        }\n        break;\n    case VIR_DOMAIN_DISK_BUS_SCSI:\n    case VIR_DOMAIN_DISK_BUS_SATA:\n        if (drive->bus > 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Invalid drive address of disk %s, vz driver \"\n                             \"supports only bus 0 for SATA and SCSI bus.\"),\n                           disk->dst);\n            return -1;\n        }\n        break;\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Specified disk bus is not supported by vz driver.\"));\n        return -1;\n    }\n\n    if (virDiskNameToBusDeviceIndex(disk, &busIdx, &devIdx) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot convert disk '%s' to bus/device index\"),\n                       disk->dst);\n        return -1;\n    }\n\n    if (busIdx != drive->bus || devIdx != drive->unit) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Invalid drive address of disk %s, vz driver \"\n                         \"does not support non default name mappings.\"),\n                       disk->dst);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "vzInitVersion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
    "lines": "152-197",
    "snippet": "int\nvzInitVersion(vzDriverPtr driver)\n{\n    char *output, *sVer, *tmp;\n    const char *searchStr = \"prlsrvctl version \";\n    int ret = -1;\n\n    output = vzGetOutput(PRLSRVCTL, \"--help\", NULL);\n\n    if (!output) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    if (!(sVer = strstr(output, searchStr))) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    sVer = sVer + strlen(searchStr);\n\n    /* parallels server has versions number like 6.0.17977.782218 or 7.0.0,\n     * In libvirt we handle only first two numbers. */\n    if (!(tmp = strchr(sVer, '.'))) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    if (!(tmp = strchr(tmp + 1, '.'))) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    tmp[0] = '\\0';\n    if (virParseVersionString(sVer, &(driver->vzVersion), true) < 0) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    vzInitCaps(driver->vzVersion, &driver->vzCaps);\n    ret = 0;\n\n cleanup:\n    VIR_FREE(output);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtime.h\"",
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"virstring.h\"",
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"virjson.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define PRLSRVCTL \"prlsrvctl\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "output"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzInitCaps",
          "args": [
            "driver->vzVersion",
            "&driver->vzCaps"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "vzInitCaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "134-150",
          "snippet": "static void\nvzInitCaps(unsigned long vzVersion, vzCapabilitiesPtr vzCaps)\n{\n    if (vzVersion < VIRTUOZZO_VER_7) {\n        vzCaps->ctDiskFormat = VIR_STORAGE_FILE_PLOOP;\n        vzCaps->vmDiskFormat = VIR_STORAGE_FILE_PLOOP;\n        vzCaps->diskBuses = vz6DiskBuses;\n        vzCaps->controllerTypes = vz6ControllerTypes;\n        vzCaps->scsiControllerModel = VIR_DOMAIN_CONTROLLER_MODEL_SCSI_BUSLOGIC;\n    } else {\n        vzCaps->ctDiskFormat = VIR_STORAGE_FILE_PLOOP;\n        vzCaps->vmDiskFormat = VIR_STORAGE_FILE_QCOW2;\n        vzCaps->diskBuses = vz7DiskBuses;\n        vzCaps->controllerTypes = vz7ControllerTypes;\n        vzCaps->scsiControllerModel = VIR_DOMAIN_CONTROLLER_MODEL_SCSI_VIRTIO_SCSI;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virDomainDiskBus vz6DiskBuses[] = {VIR_DOMAIN_DISK_BUS_IDE,\n                                          VIR_DOMAIN_DISK_BUS_SCSI,\n                                          VIR_DOMAIN_DISK_BUS_SATA,\n                                          VIR_DOMAIN_DISK_BUS_LAST};",
            "static virDomainDiskBus vz7DiskBuses[] = {VIR_DOMAIN_DISK_BUS_IDE,\n                                          VIR_DOMAIN_DISK_BUS_SCSI,\n                                          VIR_DOMAIN_DISK_BUS_LAST};",
            "static virDomainControllerType vz6ControllerTypes[] = {VIR_DOMAIN_CONTROLLER_TYPE_SCSI,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_IDE,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_SATA,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_LAST};",
            "static virDomainControllerType vz7ControllerTypes[] = {VIR_DOMAIN_CONTROLLER_TYPE_SCSI,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_IDE,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_LAST};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic virDomainDiskBus vz6DiskBuses[] = {VIR_DOMAIN_DISK_BUS_IDE,\n                                          VIR_DOMAIN_DISK_BUS_SCSI,\n                                          VIR_DOMAIN_DISK_BUS_SATA,\n                                          VIR_DOMAIN_DISK_BUS_LAST};\nstatic virDomainDiskBus vz7DiskBuses[] = {VIR_DOMAIN_DISK_BUS_IDE,\n                                          VIR_DOMAIN_DISK_BUS_SCSI,\n                                          VIR_DOMAIN_DISK_BUS_LAST};\nstatic virDomainControllerType vz6ControllerTypes[] = {VIR_DOMAIN_CONTROLLER_TYPE_SCSI,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_IDE,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_SATA,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_LAST};\nstatic virDomainControllerType vz7ControllerTypes[] = {VIR_DOMAIN_CONTROLLER_TYPE_SCSI,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_IDE,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_LAST};\n\nstatic void\nvzInitCaps(unsigned long vzVersion, vzCapabilitiesPtr vzCaps)\n{\n    if (vzVersion < VIRTUOZZO_VER_7) {\n        vzCaps->ctDiskFormat = VIR_STORAGE_FILE_PLOOP;\n        vzCaps->vmDiskFormat = VIR_STORAGE_FILE_PLOOP;\n        vzCaps->diskBuses = vz6DiskBuses;\n        vzCaps->controllerTypes = vz6ControllerTypes;\n        vzCaps->scsiControllerModel = VIR_DOMAIN_CONTROLLER_MODEL_SCSI_BUSLOGIC;\n    } else {\n        vzCaps->ctDiskFormat = VIR_STORAGE_FILE_PLOOP;\n        vzCaps->vmDiskFormat = VIR_STORAGE_FILE_QCOW2;\n        vzCaps->diskBuses = vz7DiskBuses;\n        vzCaps->controllerTypes = vz7ControllerTypes;\n        vzCaps->scsiControllerModel = VIR_DOMAIN_CONTROLLER_MODEL_SCSI_VIRTIO_SCSI;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzParseError",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virParseVersionString",
          "args": [
            "sVer",
            "&(driver->vzVersion)",
            "true"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "virParseVersionString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "254-282",
          "snippet": "int\nvirParseVersionString(const char *str, unsigned long *version,\n                      bool allowMissing)\n{\n    unsigned int major, minor = 0, micro = 0;\n    char *tmp;\n\n    if (virStrToLong_ui(str, &tmp, 10, &major) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &minor) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &micro) < 0)\n        return -1;\n\n    if (major > UINT_MAX / 1000000 || minor > 999 || micro > 999)\n        return -1;\n\n    *version = 1000000 * major + 1000 * minor + micro;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirParseVersionString(const char *str, unsigned long *version,\n                      bool allowMissing)\n{\n    unsigned int major, minor = 0, micro = 0;\n    char *tmp;\n\n    if (virStrToLong_ui(str, &tmp, 10, &major) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &minor) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &micro) < 0)\n        return -1;\n\n    if (major > UINT_MAX / 1000000 || minor > 999 || micro > 999)\n        return -1;\n\n    *version = 1000000 * major + 1000 * minor + micro;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzParseError",
          "args": [],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "tmp + 1",
            "'.'"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzParseError",
          "args": [],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "sVer",
            "'.'"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "searchStr"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzParseError",
          "args": [],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "output",
            "searchStr"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzParseError",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzGetOutput",
          "args": [
            "PRLSRVCTL",
            "\"--help\"",
            "NULL"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "vzGetOutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "118-132",
          "snippet": "char *\nvzGetOutput(const char *binary, ...)\n{\n    char *outbuf;\n    va_list list;\n    int ret;\n\n    va_start(list, binary);\n    ret = vzDoCmdRun(&outbuf, binary, list);\n    va_end(list);\n    if (ret)\n        return NULL;\n\n    return outbuf;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvzGetOutput(const char *binary, ...)\n{\n    char *outbuf;\n    va_list list;\n    int ret;\n\n    va_start(list, binary);\n    ret = vzDoCmdRun(&outbuf, binary, list);\n    va_end(list);\n    if (ret)\n        return NULL;\n\n    return outbuf;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define PRLSRVCTL \"prlsrvctl\"\n\nint\nvzInitVersion(vzDriverPtr driver)\n{\n    char *output, *sVer, *tmp;\n    const char *searchStr = \"prlsrvctl version \";\n    int ret = -1;\n\n    output = vzGetOutput(PRLSRVCTL, \"--help\", NULL);\n\n    if (!output) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    if (!(sVer = strstr(output, searchStr))) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    sVer = sVer + strlen(searchStr);\n\n    /* parallels server has versions number like 6.0.17977.782218 or 7.0.0,\n     * In libvirt we handle only first two numbers. */\n    if (!(tmp = strchr(sVer, '.'))) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    if (!(tmp = strchr(tmp + 1, '.'))) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    tmp[0] = '\\0';\n    if (virParseVersionString(sVer, &(driver->vzVersion), true) < 0) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    vzInitCaps(driver->vzVersion, &driver->vzCaps);\n    ret = 0;\n\n cleanup:\n    VIR_FREE(output);\n    return ret;\n}"
  },
  {
    "function_name": "vzInitCaps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
    "lines": "134-150",
    "snippet": "static void\nvzInitCaps(unsigned long vzVersion, vzCapabilitiesPtr vzCaps)\n{\n    if (vzVersion < VIRTUOZZO_VER_7) {\n        vzCaps->ctDiskFormat = VIR_STORAGE_FILE_PLOOP;\n        vzCaps->vmDiskFormat = VIR_STORAGE_FILE_PLOOP;\n        vzCaps->diskBuses = vz6DiskBuses;\n        vzCaps->controllerTypes = vz6ControllerTypes;\n        vzCaps->scsiControllerModel = VIR_DOMAIN_CONTROLLER_MODEL_SCSI_BUSLOGIC;\n    } else {\n        vzCaps->ctDiskFormat = VIR_STORAGE_FILE_PLOOP;\n        vzCaps->vmDiskFormat = VIR_STORAGE_FILE_QCOW2;\n        vzCaps->diskBuses = vz7DiskBuses;\n        vzCaps->controllerTypes = vz7ControllerTypes;\n        vzCaps->scsiControllerModel = VIR_DOMAIN_CONTROLLER_MODEL_SCSI_VIRTIO_SCSI;\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtime.h\"",
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"virstring.h\"",
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"virjson.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virDomainDiskBus vz6DiskBuses[] = {VIR_DOMAIN_DISK_BUS_IDE,\n                                          VIR_DOMAIN_DISK_BUS_SCSI,\n                                          VIR_DOMAIN_DISK_BUS_SATA,\n                                          VIR_DOMAIN_DISK_BUS_LAST};",
      "static virDomainDiskBus vz7DiskBuses[] = {VIR_DOMAIN_DISK_BUS_IDE,\n                                          VIR_DOMAIN_DISK_BUS_SCSI,\n                                          VIR_DOMAIN_DISK_BUS_LAST};",
      "static virDomainControllerType vz6ControllerTypes[] = {VIR_DOMAIN_CONTROLLER_TYPE_SCSI,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_IDE,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_SATA,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_LAST};",
      "static virDomainControllerType vz7ControllerTypes[] = {VIR_DOMAIN_CONTROLLER_TYPE_SCSI,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_IDE,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_LAST};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic virDomainDiskBus vz6DiskBuses[] = {VIR_DOMAIN_DISK_BUS_IDE,\n                                          VIR_DOMAIN_DISK_BUS_SCSI,\n                                          VIR_DOMAIN_DISK_BUS_SATA,\n                                          VIR_DOMAIN_DISK_BUS_LAST};\nstatic virDomainDiskBus vz7DiskBuses[] = {VIR_DOMAIN_DISK_BUS_IDE,\n                                          VIR_DOMAIN_DISK_BUS_SCSI,\n                                          VIR_DOMAIN_DISK_BUS_LAST};\nstatic virDomainControllerType vz6ControllerTypes[] = {VIR_DOMAIN_CONTROLLER_TYPE_SCSI,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_IDE,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_SATA,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_LAST};\nstatic virDomainControllerType vz7ControllerTypes[] = {VIR_DOMAIN_CONTROLLER_TYPE_SCSI,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_IDE,\n                                                       VIR_DOMAIN_CONTROLLER_TYPE_LAST};\n\nstatic void\nvzInitCaps(unsigned long vzVersion, vzCapabilitiesPtr vzCaps)\n{\n    if (vzVersion < VIRTUOZZO_VER_7) {\n        vzCaps->ctDiskFormat = VIR_STORAGE_FILE_PLOOP;\n        vzCaps->vmDiskFormat = VIR_STORAGE_FILE_PLOOP;\n        vzCaps->diskBuses = vz6DiskBuses;\n        vzCaps->controllerTypes = vz6ControllerTypes;\n        vzCaps->scsiControllerModel = VIR_DOMAIN_CONTROLLER_MODEL_SCSI_BUSLOGIC;\n    } else {\n        vzCaps->ctDiskFormat = VIR_STORAGE_FILE_PLOOP;\n        vzCaps->vmDiskFormat = VIR_STORAGE_FILE_QCOW2;\n        vzCaps->diskBuses = vz7DiskBuses;\n        vzCaps->controllerTypes = vz7ControllerTypes;\n        vzCaps->scsiControllerModel = VIR_DOMAIN_CONTROLLER_MODEL_SCSI_VIRTIO_SCSI;\n    }\n}"
  },
  {
    "function_name": "vzGetOutput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
    "lines": "118-132",
    "snippet": "char *\nvzGetOutput(const char *binary, ...)\n{\n    char *outbuf;\n    va_list list;\n    int ret;\n\n    va_start(list, binary);\n    ret = vzDoCmdRun(&outbuf, binary, list);\n    va_end(list);\n    if (ret)\n        return NULL;\n\n    return outbuf;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtime.h\"",
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"virstring.h\"",
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"virjson.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "list"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDoCmdRun",
          "args": [
            "&outbuf",
            "binary",
            "list"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "vzDoCmdRun",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "92-111",
          "snippet": "static int\nvzDoCmdRun(char **outbuf, const char *binary, va_list list)\n{\n    virCommandPtr cmd = virCommandNewVAList(binary, list);\n    int ret = -1;\n\n    if (outbuf)\n        virCommandSetOutputBuffer(cmd, outbuf);\n\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    if (ret && outbuf)\n        VIR_FREE(*outbuf);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvzDoCmdRun(char **outbuf, const char *binary, va_list list)\n{\n    virCommandPtr cmd = virCommandNewVAList(binary, list);\n    int ret = -1;\n\n    if (outbuf)\n        virCommandSetOutputBuffer(cmd, outbuf);\n\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    if (ret && outbuf)\n        VIR_FREE(*outbuf);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "list",
            "binary"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvzGetOutput(const char *binary, ...)\n{\n    char *outbuf;\n    va_list list;\n    int ret;\n\n    va_start(list, binary);\n    ret = vzDoCmdRun(&outbuf, binary, list);\n    va_end(list);\n    if (ret)\n        return NULL;\n\n    return outbuf;\n}"
  },
  {
    "function_name": "vzDoCmdRun",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
    "lines": "92-111",
    "snippet": "static int\nvzDoCmdRun(char **outbuf, const char *binary, va_list list)\n{\n    virCommandPtr cmd = virCommandNewVAList(binary, list);\n    int ret = -1;\n\n    if (outbuf)\n        virCommandSetOutputBuffer(cmd, outbuf);\n\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    if (ret && outbuf)\n        VIR_FREE(*outbuf);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtime.h\"",
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"virstring.h\"",
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"virjson.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*outbuf"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandSetOutputBuffer",
          "args": [
            "cmd",
            "outbuf"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandSetOutputBuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1869-1884",
          "snippet": "void\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNewVAList",
          "args": [
            "binary",
            "list"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewVAList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "990-1002",
          "snippet": "virCommandPtr\nvirCommandNewVAList(const char *binary, va_list list)\n{\n    virCommandPtr cmd = virCommandNew(binary);\n    const char *arg;\n\n    if (!cmd || cmd->has_error)\n        return cmd;\n\n    while ((arg = va_arg(list, const char *)) != NULL)\n        virCommandAddArg(cmd, arg);\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewVAList(const char *binary, va_list list)\n{\n    virCommandPtr cmd = virCommandNew(binary);\n    const char *arg;\n\n    if (!cmd || cmd->has_error)\n        return cmd;\n\n    while ((arg = va_arg(list, const char *)) != NULL)\n        virCommandAddArg(cmd, arg);\n    return cmd;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvzDoCmdRun(char **outbuf, const char *binary, va_list list)\n{\n    virCommandPtr cmd = virCommandNewVAList(binary, list);\n    int ret = -1;\n\n    if (outbuf)\n        virCommandSetOutputBuffer(cmd, outbuf);\n\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    if (ret && outbuf)\n        VIR_FREE(*outbuf);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomObjFromDomain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
    "lines": "72-90",
    "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtime.h\"",
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"virstring.h\"",
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"virjson.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN",
            "_(\"no domain with matching uuid '%s' (%s)\")",
            "uuidstr",
            "domain->name"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no domain with matching uuid '%s' (%s)\""
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "domain->uuid",
            "uuidstr"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByUUID",
          "args": [
            "driver->domains",
            "domain->uuid"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "162-179",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByUUID(virDomainObjListPtr doms,\n                           const unsigned char *uuid)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByUUIDLocked(doms, uuid);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByUUID(virDomainObjListPtr doms,\n                           const unsigned char *uuid)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByUUIDLocked(doms, uuid);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
  }
]