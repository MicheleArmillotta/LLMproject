[
  {
    "function_name": "virNWFilterBindingDefFormatBuf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
    "lines": "237-270",
    "snippet": "int\nvirNWFilterBindingDefFormatBuf(virBufferPtr buf,\n                               const virNWFilterBindingDef *def)\n{\n    char uuid[VIR_UUID_STRING_BUFLEN];\n    char mac[VIR_MAC_STRING_BUFLEN];\n\n    virBufferAddLit(buf, \"<filterbinding>\\n\");\n\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferAddLit(buf, \"<owner>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->ownername);\n    virUUIDFormat(def->owneruuid, uuid);\n    virBufferAsprintf(buf, \"<uuid>%s</uuid>\\n\", uuid);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</owner>\\n\");\n\n    virBufferEscapeString(buf, \"<portdev name='%s'/>\\n\", def->portdevname);\n    if (def->linkdevname)\n        virBufferEscapeString(buf, \"<linkdev name='%s'/>\\n\", def->linkdevname);\n\n    virMacAddrFormat(&def->mac, mac);\n    virBufferAsprintf(buf, \"<mac address='%s'/>\\n\", mac);\n\n    if (virNWFilterFormatParamAttributes(buf, def->filterparams, def->filter) < 0)\n        return -1;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</filterbinding>\\n\");\n\n    return 0;\n}",
    "includes": [
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingdef.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</filterbinding>\\n\""
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterFormatParamAttributes",
          "args": [
            "buf",
            "def->filterparams",
            "def->filter"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterFormatParamAttributes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "783-830",
          "snippet": "int\nvirNWFilterFormatParamAttributes(virBufferPtr buf,\n                                 virHashTablePtr table,\n                                 const char *filterref)\n{\n    virHashKeyValuePairPtr items;\n    size_t i, j;\n    int card, numKeys;\n\n    numKeys = virHashSize(table);\n\n    if (numKeys < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing filter parameter table\"));\n        return -1;\n    }\n\n    items = virHashGetItems(table,\n                            virNWFilterFormatParameterNameSorter);\n    if (!items)\n        return -1;\n\n    virBufferAsprintf(buf, \"<filterref filter='%s'\", filterref);\n    if (numKeys) {\n        virBufferAddLit(buf, \">\\n\");\n        virBufferAdjustIndent(buf, 2);\n        for (i = 0; i < numKeys; i++) {\n            const virNWFilterVarValue *value = items[i].value;\n\n            card = virNWFilterVarValueGetCardinality(value);\n\n            for (j = 0; j < card; j++)\n                virBufferAsprintf(buf,\n                                  \"<parameter name='%s' value='%s'/>\\n\",\n                                  (const char *)items[i].key,\n                                  virNWFilterVarValueGetNthValue(value, j));\n\n        }\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</filterref>\\n\");\n    } else {\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    VIR_FREE(items);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nint\nvirNWFilterFormatParamAttributes(virBufferPtr buf,\n                                 virHashTablePtr table,\n                                 const char *filterref)\n{\n    virHashKeyValuePairPtr items;\n    size_t i, j;\n    int card, numKeys;\n\n    numKeys = virHashSize(table);\n\n    if (numKeys < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing filter parameter table\"));\n        return -1;\n    }\n\n    items = virHashGetItems(table,\n                            virNWFilterFormatParameterNameSorter);\n    if (!items)\n        return -1;\n\n    virBufferAsprintf(buf, \"<filterref filter='%s'\", filterref);\n    if (numKeys) {\n        virBufferAddLit(buf, \">\\n\");\n        virBufferAdjustIndent(buf, 2);\n        for (i = 0; i < numKeys; i++) {\n            const virNWFilterVarValue *value = items[i].value;\n\n            card = virNWFilterVarValueGetCardinality(value);\n\n            for (j = 0; j < card; j++)\n                virBufferAsprintf(buf,\n                                  \"<parameter name='%s' value='%s'/>\\n\",\n                                  (const char *)items[i].key,\n                                  virNWFilterVarValueGetNthValue(value, j));\n\n        }\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</filterref>\\n\");\n    } else {\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    VIR_FREE(items);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<mac address='%s'/>\\n\"",
            "mac"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "&def->mac",
            "mac"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\"<linkdev name='%s'/>\\n\"",
            "def->linkdevname"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</owner>\\n\""
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "def->owneruuid",
            "uuid"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<owner>\\n\""
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<filterbinding>\\n\""
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint\nvirNWFilterBindingDefFormatBuf(virBufferPtr buf,\n                               const virNWFilterBindingDef *def)\n{\n    char uuid[VIR_UUID_STRING_BUFLEN];\n    char mac[VIR_MAC_STRING_BUFLEN];\n\n    virBufferAddLit(buf, \"<filterbinding>\\n\");\n\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferAddLit(buf, \"<owner>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->ownername);\n    virUUIDFormat(def->owneruuid, uuid);\n    virBufferAsprintf(buf, \"<uuid>%s</uuid>\\n\", uuid);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</owner>\\n\");\n\n    virBufferEscapeString(buf, \"<portdev name='%s'/>\\n\", def->portdevname);\n    if (def->linkdevname)\n        virBufferEscapeString(buf, \"<linkdev name='%s'/>\\n\", def->linkdevname);\n\n    virMacAddrFormat(&def->mac, mac);\n    virBufferAsprintf(buf, \"<mac address='%s'/>\\n\", mac);\n\n    if (virNWFilterFormatParamAttributes(buf, def->filterparams, def->filter) < 0)\n        return -1;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</filterbinding>\\n\");\n\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterBindingDefFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
    "lines": "223-234",
    "snippet": "char *\nvirNWFilterBindingDefFormat(const virNWFilterBindingDef *def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virNWFilterBindingDefFormatBuf(&buf, def) < 0) {\n        virBufferFreeAndReset(&buf);\n        return NULL;\n    }\n\n    return virBufferContentAndReset(&buf);\n}",
    "includes": [
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingdef.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "&buf"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingDefFormatBuf",
          "args": [
            "&buf",
            "def"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefFormatBuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
          "lines": "237-270",
          "snippet": "int\nvirNWFilterBindingDefFormatBuf(virBufferPtr buf,\n                               const virNWFilterBindingDef *def)\n{\n    char uuid[VIR_UUID_STRING_BUFLEN];\n    char mac[VIR_MAC_STRING_BUFLEN];\n\n    virBufferAddLit(buf, \"<filterbinding>\\n\");\n\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferAddLit(buf, \"<owner>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->ownername);\n    virUUIDFormat(def->owneruuid, uuid);\n    virBufferAsprintf(buf, \"<uuid>%s</uuid>\\n\", uuid);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</owner>\\n\");\n\n    virBufferEscapeString(buf, \"<portdev name='%s'/>\\n\", def->portdevname);\n    if (def->linkdevname)\n        virBufferEscapeString(buf, \"<linkdev name='%s'/>\\n\", def->linkdevname);\n\n    virMacAddrFormat(&def->mac, mac);\n    virBufferAsprintf(buf, \"<mac address='%s'/>\\n\", mac);\n\n    if (virNWFilterFormatParamAttributes(buf, def->filterparams, def->filter) < 0)\n        return -1;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</filterbinding>\\n\");\n\n    return 0;\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint\nvirNWFilterBindingDefFormatBuf(virBufferPtr buf,\n                               const virNWFilterBindingDef *def)\n{\n    char uuid[VIR_UUID_STRING_BUFLEN];\n    char mac[VIR_MAC_STRING_BUFLEN];\n\n    virBufferAddLit(buf, \"<filterbinding>\\n\");\n\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferAddLit(buf, \"<owner>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->ownername);\n    virUUIDFormat(def->owneruuid, uuid);\n    virBufferAsprintf(buf, \"<uuid>%s</uuid>\\n\", uuid);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</owner>\\n\");\n\n    virBufferEscapeString(buf, \"<portdev name='%s'/>\\n\", def->portdevname);\n    if (def->linkdevname)\n        virBufferEscapeString(buf, \"<linkdev name='%s'/>\\n\", def->linkdevname);\n\n    virMacAddrFormat(&def->mac, mac);\n    virBufferAsprintf(buf, \"<mac address='%s'/>\\n\", mac);\n\n    if (virNWFilterFormatParamAttributes(buf, def->filterparams, def->filter) < 0)\n        return -1;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</filterbinding>\\n\");\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nchar *\nvirNWFilterBindingDefFormat(const virNWFilterBindingDef *def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virNWFilterBindingDefFormatBuf(&buf, def) < 0) {\n        virBufferFreeAndReset(&buf);\n        return NULL;\n    }\n\n    return virBufferContentAndReset(&buf);\n}"
  },
  {
    "function_name": "virNWFilterBindingDefParseFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
    "lines": "216-220",
    "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingDefParseFile(const char *filename)\n{\n    return virNWFilterBindingDefParse(NULL, filename);\n}",
    "includes": [
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingdef.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBindingDefParse",
          "args": [
            "NULL",
            "filename"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
          "lines": "193-206",
          "snippet": "static virNWFilterBindingDefPtr\nvirNWFilterBindingDefParse(const char *xmlStr,\n                           const char *filename)\n{\n    virNWFilterBindingDefPtr def = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(nwfilterbinding_definition)\")))) {\n        def = virNWFilterBindingDefParseNode(xml, xmlDocGetRootElement(xml));\n        xmlFreeDoc(xml);\n    }\n\n    return def;\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virNWFilterBindingDefPtr\nvirNWFilterBindingDefParse(const char *xmlStr,\n                           const char *filename)\n{\n    virNWFilterBindingDefPtr def = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(nwfilterbinding_definition)\")))) {\n        def = virNWFilterBindingDefParseNode(xml, xmlDocGetRootElement(xml));\n        xmlFreeDoc(xml);\n    }\n\n    return def;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingDefParseFile(const char *filename)\n{\n    return virNWFilterBindingDefParse(NULL, filename);\n}"
  },
  {
    "function_name": "virNWFilterBindingDefParseString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
    "lines": "209-213",
    "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingDefParseString(const char *xmlStr)\n{\n    return virNWFilterBindingDefParse(xmlStr, NULL);\n}",
    "includes": [
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingdef.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBindingDefParse",
          "args": [
            "xmlStr",
            "NULL"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
          "lines": "193-206",
          "snippet": "static virNWFilterBindingDefPtr\nvirNWFilterBindingDefParse(const char *xmlStr,\n                           const char *filename)\n{\n    virNWFilterBindingDefPtr def = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(nwfilterbinding_definition)\")))) {\n        def = virNWFilterBindingDefParseNode(xml, xmlDocGetRootElement(xml));\n        xmlFreeDoc(xml);\n    }\n\n    return def;\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virNWFilterBindingDefPtr\nvirNWFilterBindingDefParse(const char *xmlStr,\n                           const char *filename)\n{\n    virNWFilterBindingDefPtr def = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(nwfilterbinding_definition)\")))) {\n        def = virNWFilterBindingDefParseNode(xml, xmlDocGetRootElement(xml));\n        xmlFreeDoc(xml);\n    }\n\n    return def;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingDefParseString(const char *xmlStr)\n{\n    return virNWFilterBindingDefParse(xmlStr, NULL);\n}"
  },
  {
    "function_name": "virNWFilterBindingDefParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
    "lines": "193-206",
    "snippet": "static virNWFilterBindingDefPtr\nvirNWFilterBindingDefParse(const char *xmlStr,\n                           const char *filename)\n{\n    virNWFilterBindingDefPtr def = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(nwfilterbinding_definition)\")))) {\n        def = virNWFilterBindingDefParseNode(xml, xmlDocGetRootElement(xml));\n        xmlFreeDoc(xml);\n    }\n\n    return def;\n}",
    "includes": [
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingdef.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlFreeDoc",
          "args": [
            "xml"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingDefParseNode",
          "args": [
            "xml",
            "xmlDocGetRootElement(xml)"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefParseNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
          "lines": "167-190",
          "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingDefParseNode(xmlDocPtr xml,\n                               xmlNodePtr root)\n{\n    xmlXPathContextPtr ctxt = NULL;\n    virNWFilterBindingDefPtr def = NULL;\n\n    if (STRNEQ((const char *)root->name, \"filterbinding\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       \"%s\",\n                       _(\"unknown root element for nwfilter binding\"));\n        goto cleanup;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        goto cleanup;\n\n    ctxt->node = root;\n    def = virNWFilterBindingDefParseXML(ctxt);\n\n cleanup:\n    xmlXPathFreeContext(ctxt);\n    return def;\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingDefParseNode(xmlDocPtr xml,\n                               xmlNodePtr root)\n{\n    xmlXPathContextPtr ctxt = NULL;\n    virNWFilterBindingDefPtr def = NULL;\n\n    if (STRNEQ((const char *)root->name, \"filterbinding\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       \"%s\",\n                       _(\"unknown root element for nwfilter binding\"));\n        goto cleanup;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        goto cleanup;\n\n    ctxt->node = root;\n    def = virNWFilterBindingDefParseXML(ctxt);\n\n cleanup:\n    xmlXPathFreeContext(ctxt);\n    return def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlDocGetRootElement",
          "args": [
            "xml"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLParse",
          "args": [
            "filename",
            "xmlStr",
            "_(\"(nwfilterbinding_definition)\")"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"(nwfilterbinding_definition)\""
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virNWFilterBindingDefPtr\nvirNWFilterBindingDefParse(const char *xmlStr,\n                           const char *filename)\n{\n    virNWFilterBindingDefPtr def = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(nwfilterbinding_definition)\")))) {\n        def = virNWFilterBindingDefParseNode(xml, xmlDocGetRootElement(xml));\n        xmlFreeDoc(xml);\n    }\n\n    return def;\n}"
  },
  {
    "function_name": "virNWFilterBindingDefParseNode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
    "lines": "167-190",
    "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingDefParseNode(xmlDocPtr xml,\n                               xmlNodePtr root)\n{\n    xmlXPathContextPtr ctxt = NULL;\n    virNWFilterBindingDefPtr def = NULL;\n\n    if (STRNEQ((const char *)root->name, \"filterbinding\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       \"%s\",\n                       _(\"unknown root element for nwfilter binding\"));\n        goto cleanup;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        goto cleanup;\n\n    ctxt->node = root;\n    def = virNWFilterBindingDefParseXML(ctxt);\n\n cleanup:\n    xmlXPathFreeContext(ctxt);\n    return def;\n}",
    "includes": [
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingdef.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlXPathFreeContext",
          "args": [
            "ctxt"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingDefParseXML",
          "args": [
            "ctxt"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefParseXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
          "lines": "83-164",
          "snippet": "static virNWFilterBindingDefPtr\nvirNWFilterBindingDefParseXML(xmlXPathContextPtr ctxt)\n{\n    virNWFilterBindingDefPtr ret;\n    char *uuid = NULL;\n    char *mac = NULL;\n    xmlNodePtr node;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->portdevname = virXPathString(\"string(./portdev/@name)\", ctxt);\n    if (!ret->portdevname) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no port dev name\"));\n        goto cleanup;\n    }\n\n    if (virXPathNode(\"./linkdev\", ctxt)) {\n        ret->linkdevname = virXPathString(\"string(./linkdev/@name)\", ctxt);\n        if (!ret->linkdevname) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           \"%s\", _(\"filter binding has no link dev name\"));\n            goto cleanup;\n        }\n    }\n\n    ret->ownername = virXPathString(\"string(./owner/name)\", ctxt);\n    if (!ret->ownername) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no owner name\"));\n        goto cleanup;\n    }\n\n    uuid = virXPathString(\"string(./owner/uuid)\", ctxt);\n    if (!uuid) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no owner UUID\"));\n        goto cleanup;\n    }\n\n    if (virUUIDParse(uuid, ret->owneruuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse UUID '%s'\"), uuid);\n        VIR_FREE(uuid);\n        goto cleanup;\n    }\n    VIR_FREE(uuid);\n\n    mac = virXPathString(\"string(./mac/@address)\", ctxt);\n    if (!mac) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no MAC address\"));\n        goto cleanup;\n    }\n\n    if (virMacAddrParse(mac, &ret->mac) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse MAC '%s'\"), mac);\n        VIR_FREE(mac);\n        goto cleanup;\n    }\n    VIR_FREE(mac);\n\n    ret->filter = virXPathString(\"string(./filterref/@filter)\", ctxt);\n    if (!ret->filter) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no filter reference\"));\n        goto cleanup;\n    }\n\n    node = virXPathNode(\"./filterref\", ctxt);\n    if (node &&\n        !(ret->filterparams = virNWFilterParseParamAttributes(node)))\n        goto cleanup;\n\n    return ret;\n\n cleanup:\n    virNWFilterBindingDefFree(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virNWFilterBindingDefPtr\nvirNWFilterBindingDefParseXML(xmlXPathContextPtr ctxt)\n{\n    virNWFilterBindingDefPtr ret;\n    char *uuid = NULL;\n    char *mac = NULL;\n    xmlNodePtr node;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->portdevname = virXPathString(\"string(./portdev/@name)\", ctxt);\n    if (!ret->portdevname) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no port dev name\"));\n        goto cleanup;\n    }\n\n    if (virXPathNode(\"./linkdev\", ctxt)) {\n        ret->linkdevname = virXPathString(\"string(./linkdev/@name)\", ctxt);\n        if (!ret->linkdevname) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           \"%s\", _(\"filter binding has no link dev name\"));\n            goto cleanup;\n        }\n    }\n\n    ret->ownername = virXPathString(\"string(./owner/name)\", ctxt);\n    if (!ret->ownername) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no owner name\"));\n        goto cleanup;\n    }\n\n    uuid = virXPathString(\"string(./owner/uuid)\", ctxt);\n    if (!uuid) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no owner UUID\"));\n        goto cleanup;\n    }\n\n    if (virUUIDParse(uuid, ret->owneruuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse UUID '%s'\"), uuid);\n        VIR_FREE(uuid);\n        goto cleanup;\n    }\n    VIR_FREE(uuid);\n\n    mac = virXPathString(\"string(./mac/@address)\", ctxt);\n    if (!mac) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no MAC address\"));\n        goto cleanup;\n    }\n\n    if (virMacAddrParse(mac, &ret->mac) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse MAC '%s'\"), mac);\n        VIR_FREE(mac);\n        goto cleanup;\n    }\n    VIR_FREE(mac);\n\n    ret->filter = virXPathString(\"string(./filterref/@filter)\", ctxt);\n    if (!ret->filter) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no filter reference\"));\n        goto cleanup;\n    }\n\n    node = virXPathNode(\"./filterref\", ctxt);\n    if (node &&\n        !(ret->filterparams = virNWFilterParseParamAttributes(node)))\n        goto cleanup;\n\n    return ret;\n\n cleanup:\n    virNWFilterBindingDefFree(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLXPathContextNew",
          "args": [
            "xml"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLXPathContextNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "48-59",
          "snippet": "xmlXPathContextPtr\nvirXMLXPathContextNew(xmlDocPtr xml)\n{\n    xmlXPathContextPtr ctxt;\n\n    if (!(ctxt = xmlXPathNewContext(xml))) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    return ctxt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlXPathContextPtr\nvirXMLXPathContextNew(xmlDocPtr xml)\n{\n    xmlXPathContextPtr ctxt;\n\n    if (!(ctxt = xmlXPathNewContext(xml))) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    return ctxt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"unknown root element for nwfilter binding\")"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown root element for nwfilter binding\""
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "(const char *)root->name",
            "\"filterbinding\""
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingDefParseNode(xmlDocPtr xml,\n                               xmlNodePtr root)\n{\n    xmlXPathContextPtr ctxt = NULL;\n    virNWFilterBindingDefPtr def = NULL;\n\n    if (STRNEQ((const char *)root->name, \"filterbinding\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       \"%s\",\n                       _(\"unknown root element for nwfilter binding\"));\n        goto cleanup;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        goto cleanup;\n\n    ctxt->node = root;\n    def = virNWFilterBindingDefParseXML(ctxt);\n\n cleanup:\n    xmlXPathFreeContext(ctxt);\n    return def;\n}"
  },
  {
    "function_name": "virNWFilterBindingDefParseXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
    "lines": "83-164",
    "snippet": "static virNWFilterBindingDefPtr\nvirNWFilterBindingDefParseXML(xmlXPathContextPtr ctxt)\n{\n    virNWFilterBindingDefPtr ret;\n    char *uuid = NULL;\n    char *mac = NULL;\n    xmlNodePtr node;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->portdevname = virXPathString(\"string(./portdev/@name)\", ctxt);\n    if (!ret->portdevname) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no port dev name\"));\n        goto cleanup;\n    }\n\n    if (virXPathNode(\"./linkdev\", ctxt)) {\n        ret->linkdevname = virXPathString(\"string(./linkdev/@name)\", ctxt);\n        if (!ret->linkdevname) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           \"%s\", _(\"filter binding has no link dev name\"));\n            goto cleanup;\n        }\n    }\n\n    ret->ownername = virXPathString(\"string(./owner/name)\", ctxt);\n    if (!ret->ownername) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no owner name\"));\n        goto cleanup;\n    }\n\n    uuid = virXPathString(\"string(./owner/uuid)\", ctxt);\n    if (!uuid) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no owner UUID\"));\n        goto cleanup;\n    }\n\n    if (virUUIDParse(uuid, ret->owneruuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse UUID '%s'\"), uuid);\n        VIR_FREE(uuid);\n        goto cleanup;\n    }\n    VIR_FREE(uuid);\n\n    mac = virXPathString(\"string(./mac/@address)\", ctxt);\n    if (!mac) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no MAC address\"));\n        goto cleanup;\n    }\n\n    if (virMacAddrParse(mac, &ret->mac) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse MAC '%s'\"), mac);\n        VIR_FREE(mac);\n        goto cleanup;\n    }\n    VIR_FREE(mac);\n\n    ret->filter = virXPathString(\"string(./filterref/@filter)\", ctxt);\n    if (!ret->filter) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no filter reference\"));\n        goto cleanup;\n    }\n\n    node = virXPathNode(\"./filterref\", ctxt);\n    if (node &&\n        !(ret->filterparams = virNWFilterParseParamAttributes(node)))\n        goto cleanup;\n\n    return ret;\n\n cleanup:\n    virNWFilterBindingDefFree(ret);\n    return NULL;\n}",
    "includes": [
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingdef.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBindingDefFree",
          "args": [
            "ret"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
          "lines": "33-46",
          "snippet": "void\nvirNWFilterBindingDefFree(virNWFilterBindingDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->portdevname);\n    VIR_FREE(def->linkdevname);\n    VIR_FREE(def->filter);\n    virHashFree(def->filterparams);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirNWFilterBindingDefFree(virNWFilterBindingDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->portdevname);\n    VIR_FREE(def->linkdevname);\n    VIR_FREE(def->filter);\n    virHashFree(def->filterparams);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterParseParamAttributes",
          "args": [
            "node"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterParseParamAttributes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "717-773",
          "snippet": "virHashTablePtr\nvirNWFilterParseParamAttributes(xmlNodePtr cur)\n{\n    char *nam, *val;\n    virNWFilterVarValuePtr value;\n\n    virHashTablePtr table = virNWFilterHashTableCreate(0);\n    if (!table)\n        return NULL;\n\n    cur = cur->children;\n\n    while (cur != NULL) {\n        if (cur->type == XML_ELEMENT_NODE) {\n            if (virXMLNodeNameEqual(cur, \"parameter\")) {\n                nam = virXMLPropString(cur, \"name\");\n                val = virXMLPropString(cur, \"value\");\n                value = NULL;\n                if (nam != NULL && val != NULL) {\n                    if (!isValidVarName(nam))\n                        goto skip_entry;\n                    if (!isValidVarValue(val))\n                        goto skip_entry;\n                    value = virHashLookup(table, nam);\n                    if (value) {\n                        /* add value to existing value -> list */\n                        if (virNWFilterVarValueAddValue(value, val) < 0) {\n                            value = NULL;\n                            goto err_exit;\n                        }\n                        val = NULL;\n                    } else {\n                        value = virNWFilterParseVarValue(val);\n                        if (!value)\n                            goto skip_entry;\n                        if (virHashUpdateEntry(table, nam, value) < 0)\n                            goto err_exit;\n                    }\n                    value = NULL;\n                }\n skip_entry:\n                virNWFilterVarValueFree(value);\n                VIR_FREE(nam);\n                VIR_FREE(val);\n            }\n        }\n        cur = cur->next;\n    }\n    return table;\n\n err_exit:\n    VIR_FREE(nam);\n    VIR_FREE(val);\n    virNWFilterVarValueFree(value);\n    virHashFree(table);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nvirHashTablePtr\nvirNWFilterParseParamAttributes(xmlNodePtr cur)\n{\n    char *nam, *val;\n    virNWFilterVarValuePtr value;\n\n    virHashTablePtr table = virNWFilterHashTableCreate(0);\n    if (!table)\n        return NULL;\n\n    cur = cur->children;\n\n    while (cur != NULL) {\n        if (cur->type == XML_ELEMENT_NODE) {\n            if (virXMLNodeNameEqual(cur, \"parameter\")) {\n                nam = virXMLPropString(cur, \"name\");\n                val = virXMLPropString(cur, \"value\");\n                value = NULL;\n                if (nam != NULL && val != NULL) {\n                    if (!isValidVarName(nam))\n                        goto skip_entry;\n                    if (!isValidVarValue(val))\n                        goto skip_entry;\n                    value = virHashLookup(table, nam);\n                    if (value) {\n                        /* add value to existing value -> list */\n                        if (virNWFilterVarValueAddValue(value, val) < 0) {\n                            value = NULL;\n                            goto err_exit;\n                        }\n                        val = NULL;\n                    } else {\n                        value = virNWFilterParseVarValue(val);\n                        if (!value)\n                            goto skip_entry;\n                        if (virHashUpdateEntry(table, nam, value) < 0)\n                            goto err_exit;\n                    }\n                    value = NULL;\n                }\n skip_entry:\n                virNWFilterVarValueFree(value);\n                VIR_FREE(nam);\n                VIR_FREE(val);\n            }\n        }\n        cur = cur->next;\n    }\n    return table;\n\n err_exit:\n    VIR_FREE(nam);\n    VIR_FREE(val);\n    virNWFilterVarValueFree(value);\n    virHashFree(table);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathNode",
          "args": [
            "\"./filterref\"",
            "ctxt"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "608-634",
          "snippet": "xmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"filter binding has no filter reference\")"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"filter binding has no filter reference\""
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathString",
          "args": [
            "\"string(./filterref/@filter)\"",
            "ctxt"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "72-96",
          "snippet": "char *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "mac"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "mac"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse MAC '%s'\")",
            "mac"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMacAddrParse",
          "args": [
            "mac",
            "&ret->mac"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrParseHex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "205-218",
          "snippet": "int\nvirMacAddrParseHex(const char *str, virMacAddrPtr addr)\n{\n    size_t i;\n\n    if (strspn(str, \"0123456789abcdefABCDEF\") != VIR_MAC_HEXLEN ||\n        str[VIR_MAC_HEXLEN])\n        return -1;\n\n    for (i = 0; i < VIR_MAC_BUFLEN; i++)\n        addr->addr[i] = (g_ascii_xdigit_value(str[2 * i]) << 4 |\n                         g_ascii_xdigit_value(str[2 * i + 1]));\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint\nvirMacAddrParseHex(const char *str, virMacAddrPtr addr)\n{\n    size_t i;\n\n    if (strspn(str, \"0123456789abcdefABCDEF\") != VIR_MAC_HEXLEN ||\n        str[VIR_MAC_HEXLEN])\n        return -1;\n\n    for (i = 0; i < VIR_MAC_BUFLEN; i++)\n        addr->addr[i] = (g_ascii_xdigit_value(str[2 * i]) << 4 |\n                         g_ascii_xdigit_value(str[2 * i + 1]));\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"filter binding has no MAC address\")"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "uuid"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "uuid"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse UUID '%s'\")",
            "uuid"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDParse",
          "args": [
            "uuid",
            "ret->owneruuid"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "91-135",
          "snippet": "int\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nint\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"filter binding has no owner UUID\")"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"filter binding has no owner name\")"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"filter binding has no link dev name\")"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"filter binding has no port dev name\")"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ret"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virNWFilterBindingDefPtr\nvirNWFilterBindingDefParseXML(xmlXPathContextPtr ctxt)\n{\n    virNWFilterBindingDefPtr ret;\n    char *uuid = NULL;\n    char *mac = NULL;\n    xmlNodePtr node;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->portdevname = virXPathString(\"string(./portdev/@name)\", ctxt);\n    if (!ret->portdevname) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no port dev name\"));\n        goto cleanup;\n    }\n\n    if (virXPathNode(\"./linkdev\", ctxt)) {\n        ret->linkdevname = virXPathString(\"string(./linkdev/@name)\", ctxt);\n        if (!ret->linkdevname) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           \"%s\", _(\"filter binding has no link dev name\"));\n            goto cleanup;\n        }\n    }\n\n    ret->ownername = virXPathString(\"string(./owner/name)\", ctxt);\n    if (!ret->ownername) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no owner name\"));\n        goto cleanup;\n    }\n\n    uuid = virXPathString(\"string(./owner/uuid)\", ctxt);\n    if (!uuid) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no owner UUID\"));\n        goto cleanup;\n    }\n\n    if (virUUIDParse(uuid, ret->owneruuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse UUID '%s'\"), uuid);\n        VIR_FREE(uuid);\n        goto cleanup;\n    }\n    VIR_FREE(uuid);\n\n    mac = virXPathString(\"string(./mac/@address)\", ctxt);\n    if (!mac) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no MAC address\"));\n        goto cleanup;\n    }\n\n    if (virMacAddrParse(mac, &ret->mac) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse MAC '%s'\"), mac);\n        VIR_FREE(mac);\n        goto cleanup;\n    }\n    VIR_FREE(mac);\n\n    ret->filter = virXPathString(\"string(./filterref/@filter)\", ctxt);\n    if (!ret->filter) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"filter binding has no filter reference\"));\n        goto cleanup;\n    }\n\n    node = virXPathNode(\"./filterref\", ctxt);\n    if (node &&\n        !(ret->filterparams = virNWFilterParseParamAttributes(node)))\n        goto cleanup;\n\n    return ret;\n\n cleanup:\n    virNWFilterBindingDefFree(ret);\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterBindingDefCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
    "lines": "49-80",
    "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingDefCopy(virNWFilterBindingDefPtr src)\n{\n    virNWFilterBindingDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->ownername = g_strdup(src->ownername);\n\n    memcpy(ret->owneruuid, src->owneruuid, sizeof(ret->owneruuid));\n\n    ret->portdevname = g_strdup(src->portdevname);\n\n    ret->linkdevname = g_strdup(src->linkdevname);\n\n    ret->mac = src->mac;\n\n    ret->filter = g_strdup(src->filter);\n\n    if (!(ret->filterparams = virNWFilterHashTableCreate(0)))\n        goto error;\n\n    if (virNWFilterHashTablePutAll(src->filterparams, ret->filterparams) < 0)\n        goto error;\n\n    return ret;\n\n error:\n    virNWFilterBindingDefFree(ret);\n    return NULL;\n}",
    "includes": [
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingdef.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBindingDefFree",
          "args": [
            "ret"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
          "lines": "33-46",
          "snippet": "void\nvirNWFilterBindingDefFree(virNWFilterBindingDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->portdevname);\n    VIR_FREE(def->linkdevname);\n    VIR_FREE(def->filter);\n    virHashFree(def->filterparams);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirNWFilterBindingDefFree(virNWFilterBindingDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->portdevname);\n    VIR_FREE(def->linkdevname);\n    VIR_FREE(def->filter);\n    virHashFree(def->filterparams);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterHashTablePutAll",
          "args": [
            "src->filterparams",
            "ret->filterparams"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterHashTablePutAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "664-678",
          "snippet": "int\nvirNWFilterHashTablePutAll(virHashTablePtr src,\n                           virHashTablePtr dest)\n{\n    struct addToTableStruct atts = {\n        .target = dest,\n        .errOccurred = 0,\n    };\n\n    virHashForEach(src, addToTable, &atts);\n    if (atts.errOccurred)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterHashTablePutAll(virHashTablePtr src,\n                           virHashTablePtr dest)\n{\n    struct addToTableStruct atts = {\n        .target = dest,\n        .errOccurred = 0,\n    };\n\n    virHashForEach(src, addToTable, &atts);\n    if (atts.errOccurred)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterHashTableCreate",
          "args": [
            "0"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterHashTableCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "628-632",
          "snippet": "virHashTablePtr\nvirNWFilterHashTableCreate(int n)\n{\n    return virHashCreate(n, hashDataFree);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirHashTablePtr\nvirNWFilterHashTableCreate(int n)\n{\n    return virHashCreate(n, hashDataFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "src->filter"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ret->owneruuid",
            "src->owneruuid",
            "sizeof(ret->owneruuid)"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ret"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingDefCopy(virNWFilterBindingDefPtr src)\n{\n    virNWFilterBindingDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->ownername = g_strdup(src->ownername);\n\n    memcpy(ret->owneruuid, src->owneruuid, sizeof(ret->owneruuid));\n\n    ret->portdevname = g_strdup(src->portdevname);\n\n    ret->linkdevname = g_strdup(src->linkdevname);\n\n    ret->mac = src->mac;\n\n    ret->filter = g_strdup(src->filter);\n\n    if (!(ret->filterparams = virNWFilterHashTableCreate(0)))\n        goto error;\n\n    if (virNWFilterHashTablePutAll(src->filterparams, ret->filterparams) < 0)\n        goto error;\n\n    return ret;\n\n error:\n    virNWFilterBindingDefFree(ret);\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterBindingDefFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
    "lines": "33-46",
    "snippet": "void\nvirNWFilterBindingDefFree(virNWFilterBindingDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->portdevname);\n    VIR_FREE(def->linkdevname);\n    VIR_FREE(def->filter);\n    virHashFree(def->filterparams);\n\n    VIR_FREE(def);\n}",
    "includes": [
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingdef.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "def->filterparams"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->filter"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->linkdevname"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->portdevname"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->ownername"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirNWFilterBindingDefFree(virNWFilterBindingDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->portdevname);\n    VIR_FREE(def->linkdevname);\n    VIR_FREE(def->filter);\n    virHashFree(def->filterparams);\n\n    VIR_FREE(def);\n}"
  }
]