[
  {
    "function_name": "qemuMonitorTextDeleteSnapshot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor_text.c",
    "lines": "202-233",
    "snippet": "int qemuMonitorTextDeleteSnapshot(qemuMonitorPtr mon, const char *name)\n{\n    char *cmd = NULL;\n    char *reply = NULL;\n    int ret = -1;\n\n    cmd = g_strdup_printf(\"delvm \\\"%s\\\"\", name);\n    if (qemuMonitorJSONHumanCommand(mon, cmd, &reply))\n        goto cleanup;\n\n    if (strstr(reply, \"No block device supports snapshots\")) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"this domain does not have a device to delete snapshots\"));\n        goto cleanup;\n    } else if (strstr(reply, \"Snapshots not supported on device\")) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\", reply);\n        goto cleanup;\n    } else if (strstr(reply, \"Error: \") ||\n               (strstr(reply, \"Error\") &&\n                strstr(reply, \"while deleting snapshot\"))) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Failed to delete snapshot: %s\"), reply);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(cmd);\n    VIR_FREE(reply);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_monitor_json.h\"",
      "#include \"qemu_monitor_text.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "reply"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cmd"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"Failed to delete snapshot: %s\")",
            "reply"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to delete snapshot: %s\""
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"while deleting snapshot\""
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"Error\""
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"Error: \""
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "reply"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"Snapshots not supported on device\""
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"this domain does not have a device to delete snapshots\")"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"No block device supports snapshots\""
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMonitorJSONHumanCommand",
          "args": [
            "mon",
            "cmd",
            "&reply"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorJSONHumanCommand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor_json.c",
          "lines": "1567-1609",
          "snippet": "int\nqemuMonitorJSONHumanCommand(qemuMonitorPtr mon,\n                            const char *cmd_str,\n                            char **reply_str)\n{\n    virJSONValuePtr cmd = NULL;\n    virJSONValuePtr reply = NULL;\n    virJSONValuePtr obj;\n    int ret = -1;\n\n    cmd = qemuMonitorJSONMakeCommand(\"human-monitor-command\",\n                                     \"s:command-line\", cmd_str,\n                                     NULL);\n\n    if (!cmd || qemuMonitorJSONCommand(mon, cmd, &reply) < 0)\n        goto cleanup;\n\n    if (qemuMonitorJSONHasError(reply, \"CommandNotFound\")) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED,\n                       _(\"Human monitor command is not available to run %s\"),\n                       cmd_str);\n        goto cleanup;\n    }\n\n    if (qemuMonitorJSONCheckError(cmd, reply))\n        goto cleanup;\n\n    obj = virJSONValueObjectGet(reply, \"return\");\n\n    if (reply_str) {\n        const char *data;\n\n        data = virJSONValueGetString(obj);\n        *reply_str = g_strdup(NULLSTR_EMPTY(data));\n    }\n\n    ret = 0;\n\n cleanup:\n    virJSONValueFree(cmd);\n    virJSONValueFree(reply);\n    return ret;\n}",
          "includes": [
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virsocket.h\"",
            "#include \"virenum.h\"",
            "#include \"cpu/cpu_x86.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virjson.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"driver.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuMonitorJSONHandleShutdown(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleReset(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePowerdown(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleStop(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleResume(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleRTCChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleWatchdog(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleIOError(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleVNCConnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleVNCInitialize(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleVNCDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSPICEConnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSPICEInitialize(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSPICEDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleTrayChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePMWakeup(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePMSuspend(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockJobCompleted(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockJobCanceled(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockJobReady(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleJobStatusChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBalloonChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePMSuspendDisk(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleGuestCrashloaded(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleGuestPanic(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleDeviceDeleted(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleNicRxFilterChanged(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSerialChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSpiceMigrated(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleMigrationStatus(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleMigrationPass(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleAcpiOstInfo(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockThreshold(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleDumpCompleted(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePRManagerStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleRdmaGidStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"libvirt_qemu_probes.h\"\n#include \"virsocket.h\"\n#include \"virenum.h\"\n#include \"cpu/cpu_x86.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virjson.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"driver.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_monitor_json.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nstatic void qemuMonitorJSONHandleShutdown(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleReset(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePowerdown(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleStop(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleResume(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleRTCChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleWatchdog(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleIOError(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleVNCConnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleVNCInitialize(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleVNCDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSPICEConnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSPICEInitialize(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSPICEDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleTrayChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePMWakeup(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePMSuspend(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockJobCompleted(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockJobCanceled(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockJobReady(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleJobStatusChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBalloonChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePMSuspendDisk(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleGuestCrashloaded(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleGuestPanic(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleDeviceDeleted(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleNicRxFilterChanged(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSerialChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSpiceMigrated(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleMigrationStatus(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleMigrationPass(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleAcpiOstInfo(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockThreshold(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleDumpCompleted(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePRManagerStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleRdmaGidStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);\n\nint\nqemuMonitorJSONHumanCommand(qemuMonitorPtr mon,\n                            const char *cmd_str,\n                            char **reply_str)\n{\n    virJSONValuePtr cmd = NULL;\n    virJSONValuePtr reply = NULL;\n    virJSONValuePtr obj;\n    int ret = -1;\n\n    cmd = qemuMonitorJSONMakeCommand(\"human-monitor-command\",\n                                     \"s:command-line\", cmd_str,\n                                     NULL);\n\n    if (!cmd || qemuMonitorJSONCommand(mon, cmd, &reply) < 0)\n        goto cleanup;\n\n    if (qemuMonitorJSONHasError(reply, \"CommandNotFound\")) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED,\n                       _(\"Human monitor command is not available to run %s\"),\n                       cmd_str);\n        goto cleanup;\n    }\n\n    if (qemuMonitorJSONCheckError(cmd, reply))\n        goto cleanup;\n\n    obj = virJSONValueObjectGet(reply, \"return\");\n\n    if (reply_str) {\n        const char *data;\n\n        data = virJSONValueGetString(obj);\n        *reply_str = g_strdup(NULLSTR_EMPTY(data));\n    }\n\n    ret = 0;\n\n cleanup:\n    virJSONValueFree(cmd);\n    virJSONValueFree(reply);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"delvm \\\"%s\\\"\"",
            "name"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include <config.h>\n\nint qemuMonitorTextDeleteSnapshot(qemuMonitorPtr mon, const char *name)\n{\n    char *cmd = NULL;\n    char *reply = NULL;\n    int ret = -1;\n\n    cmd = g_strdup_printf(\"delvm \\\"%s\\\"\", name);\n    if (qemuMonitorJSONHumanCommand(mon, cmd, &reply))\n        goto cleanup;\n\n    if (strstr(reply, \"No block device supports snapshots\")) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"this domain does not have a device to delete snapshots\"));\n        goto cleanup;\n    } else if (strstr(reply, \"Snapshots not supported on device\")) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\", reply);\n        goto cleanup;\n    } else if (strstr(reply, \"Error: \") ||\n               (strstr(reply, \"Error\") &&\n                strstr(reply, \"while deleting snapshot\"))) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Failed to delete snapshot: %s\"), reply);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(cmd);\n    VIR_FREE(reply);\n    return ret;\n}"
  },
  {
    "function_name": "qemuMonitorTextLoadSnapshot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor_text.c",
    "lines": "160-200",
    "snippet": "int qemuMonitorTextLoadSnapshot(qemuMonitorPtr mon, const char *name)\n{\n    char *cmd = NULL;\n    char *reply = NULL;\n    int ret = -1;\n\n    cmd = g_strdup_printf(\"loadvm \\\"%s\\\"\", name);\n\n    if (qemuMonitorJSONHumanCommand(mon, cmd, &reply))\n        goto cleanup;\n\n    if (strstr(reply, \"No block device supports snapshots\")) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"this domain does not have a device to load snapshots\"));\n        goto cleanup;\n    } else if (strstr(reply, \"Could not find snapshot\")) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"the snapshot '%s' does not exist, and was not loaded\"),\n                       name);\n        goto cleanup;\n    } else if (strstr(reply, \"Snapshots not supported on device\")) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"Failed to load snapshot: %s\"), reply);\n        goto cleanup;\n    } else if (strstr(reply, \"Could not open VM state file\") ||\n               strstr(reply, \"Error: \") ||\n               (strstr(reply, \"Error\") &&\n                (strstr(reply, \"while loading VM state\") ||\n                 strstr(reply, \"while activating snapshot on\")))) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Failed to load snapshot: %s\"), reply);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(cmd);\n    VIR_FREE(reply);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_monitor_json.h\"",
      "#include \"qemu_monitor_text.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "reply"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cmd"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"Failed to load snapshot: %s\")",
            "reply"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to load snapshot: %s\""
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"while activating snapshot on\""
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"while loading VM state\""
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"Error\""
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"Error: \""
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"Could not open VM state file\""
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"Failed to load snapshot: %s\")",
            "reply"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"Snapshots not supported on device\""
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"the snapshot '%s' does not exist, and was not loaded\")",
            "name"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"Could not find snapshot\""
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"this domain does not have a device to load snapshots\")"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"No block device supports snapshots\""
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMonitorJSONHumanCommand",
          "args": [
            "mon",
            "cmd",
            "&reply"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorJSONHumanCommand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor_json.c",
          "lines": "1567-1609",
          "snippet": "int\nqemuMonitorJSONHumanCommand(qemuMonitorPtr mon,\n                            const char *cmd_str,\n                            char **reply_str)\n{\n    virJSONValuePtr cmd = NULL;\n    virJSONValuePtr reply = NULL;\n    virJSONValuePtr obj;\n    int ret = -1;\n\n    cmd = qemuMonitorJSONMakeCommand(\"human-monitor-command\",\n                                     \"s:command-line\", cmd_str,\n                                     NULL);\n\n    if (!cmd || qemuMonitorJSONCommand(mon, cmd, &reply) < 0)\n        goto cleanup;\n\n    if (qemuMonitorJSONHasError(reply, \"CommandNotFound\")) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED,\n                       _(\"Human monitor command is not available to run %s\"),\n                       cmd_str);\n        goto cleanup;\n    }\n\n    if (qemuMonitorJSONCheckError(cmd, reply))\n        goto cleanup;\n\n    obj = virJSONValueObjectGet(reply, \"return\");\n\n    if (reply_str) {\n        const char *data;\n\n        data = virJSONValueGetString(obj);\n        *reply_str = g_strdup(NULLSTR_EMPTY(data));\n    }\n\n    ret = 0;\n\n cleanup:\n    virJSONValueFree(cmd);\n    virJSONValueFree(reply);\n    return ret;\n}",
          "includes": [
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virsocket.h\"",
            "#include \"virenum.h\"",
            "#include \"cpu/cpu_x86.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virjson.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"driver.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuMonitorJSONHandleShutdown(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleReset(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePowerdown(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleStop(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleResume(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleRTCChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleWatchdog(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleIOError(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleVNCConnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleVNCInitialize(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleVNCDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSPICEConnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSPICEInitialize(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSPICEDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleTrayChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePMWakeup(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePMSuspend(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockJobCompleted(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockJobCanceled(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockJobReady(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleJobStatusChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBalloonChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePMSuspendDisk(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleGuestCrashloaded(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleGuestPanic(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleDeviceDeleted(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleNicRxFilterChanged(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSerialChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSpiceMigrated(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleMigrationStatus(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleMigrationPass(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleAcpiOstInfo(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockThreshold(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleDumpCompleted(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePRManagerStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleRdmaGidStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"libvirt_qemu_probes.h\"\n#include \"virsocket.h\"\n#include \"virenum.h\"\n#include \"cpu/cpu_x86.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virjson.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"driver.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_monitor_json.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nstatic void qemuMonitorJSONHandleShutdown(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleReset(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePowerdown(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleStop(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleResume(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleRTCChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleWatchdog(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleIOError(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleVNCConnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleVNCInitialize(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleVNCDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSPICEConnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSPICEInitialize(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSPICEDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleTrayChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePMWakeup(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePMSuspend(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockJobCompleted(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockJobCanceled(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockJobReady(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleJobStatusChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBalloonChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePMSuspendDisk(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleGuestCrashloaded(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleGuestPanic(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleDeviceDeleted(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleNicRxFilterChanged(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSerialChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSpiceMigrated(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleMigrationStatus(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleMigrationPass(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleAcpiOstInfo(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockThreshold(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleDumpCompleted(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePRManagerStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleRdmaGidStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);\n\nint\nqemuMonitorJSONHumanCommand(qemuMonitorPtr mon,\n                            const char *cmd_str,\n                            char **reply_str)\n{\n    virJSONValuePtr cmd = NULL;\n    virJSONValuePtr reply = NULL;\n    virJSONValuePtr obj;\n    int ret = -1;\n\n    cmd = qemuMonitorJSONMakeCommand(\"human-monitor-command\",\n                                     \"s:command-line\", cmd_str,\n                                     NULL);\n\n    if (!cmd || qemuMonitorJSONCommand(mon, cmd, &reply) < 0)\n        goto cleanup;\n\n    if (qemuMonitorJSONHasError(reply, \"CommandNotFound\")) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED,\n                       _(\"Human monitor command is not available to run %s\"),\n                       cmd_str);\n        goto cleanup;\n    }\n\n    if (qemuMonitorJSONCheckError(cmd, reply))\n        goto cleanup;\n\n    obj = virJSONValueObjectGet(reply, \"return\");\n\n    if (reply_str) {\n        const char *data;\n\n        data = virJSONValueGetString(obj);\n        *reply_str = g_strdup(NULLSTR_EMPTY(data));\n    }\n\n    ret = 0;\n\n cleanup:\n    virJSONValueFree(cmd);\n    virJSONValueFree(reply);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"loadvm \\\"%s\\\"\"",
            "name"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include <config.h>\n\nint qemuMonitorTextLoadSnapshot(qemuMonitorPtr mon, const char *name)\n{\n    char *cmd = NULL;\n    char *reply = NULL;\n    int ret = -1;\n\n    cmd = g_strdup_printf(\"loadvm \\\"%s\\\"\", name);\n\n    if (qemuMonitorJSONHumanCommand(mon, cmd, &reply))\n        goto cleanup;\n\n    if (strstr(reply, \"No block device supports snapshots\")) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"this domain does not have a device to load snapshots\"));\n        goto cleanup;\n    } else if (strstr(reply, \"Could not find snapshot\")) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"the snapshot '%s' does not exist, and was not loaded\"),\n                       name);\n        goto cleanup;\n    } else if (strstr(reply, \"Snapshots not supported on device\")) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"Failed to load snapshot: %s\"), reply);\n        goto cleanup;\n    } else if (strstr(reply, \"Could not open VM state file\") ||\n               strstr(reply, \"Error: \") ||\n               (strstr(reply, \"Error\") &&\n                (strstr(reply, \"while loading VM state\") ||\n                 strstr(reply, \"while activating snapshot on\")))) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Failed to load snapshot: %s\"), reply);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(cmd);\n    VIR_FREE(reply);\n    return ret;\n}"
  },
  {
    "function_name": "qemuMonitorTextCreateSnapshot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor_text.c",
    "lines": "131-158",
    "snippet": "int\nqemuMonitorTextCreateSnapshot(qemuMonitorPtr mon,\n                              const char *name)\n{\n    g_autofree char *cmd = NULL;\n    g_autofree char *reply = NULL;\n\n    cmd = g_strdup_printf(\"savevm \\\"%s\\\"\", name);\n\n    if (qemuMonitorJSONHumanCommand(mon, cmd, &reply))\n        return -1;\n\n    if (strstr(reply, \"Error while creating snapshot\") ||\n        strstr(reply, \"Could not open VM state file\") ||\n        strstr(reply, \"State blocked by non-migratable device\") ||\n        strstr(reply, \"Error: \") ||\n        (strstr(reply, \"Error\") && strstr(reply, \"while writing VM\"))) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Failed to take snapshot: %s\"), reply);\n        return -1;\n    } else if (strstr(reply, \"No block device can accept snapshots\")) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"this domain does not have a device to take snapshots\"));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_monitor_json.h\"",
      "#include \"qemu_monitor_text.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"this domain does not have a device to take snapshots\")"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"this domain does not have a device to take snapshots\""
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"No block device can accept snapshots\""
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"Failed to take snapshot: %s\")",
            "reply"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"while writing VM\""
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"Error\""
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"Error: \""
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"State blocked by non-migratable device\""
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"Could not open VM state file\""
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"Error while creating snapshot\""
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMonitorJSONHumanCommand",
          "args": [
            "mon",
            "cmd",
            "&reply"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorJSONHumanCommand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor_json.c",
          "lines": "1567-1609",
          "snippet": "int\nqemuMonitorJSONHumanCommand(qemuMonitorPtr mon,\n                            const char *cmd_str,\n                            char **reply_str)\n{\n    virJSONValuePtr cmd = NULL;\n    virJSONValuePtr reply = NULL;\n    virJSONValuePtr obj;\n    int ret = -1;\n\n    cmd = qemuMonitorJSONMakeCommand(\"human-monitor-command\",\n                                     \"s:command-line\", cmd_str,\n                                     NULL);\n\n    if (!cmd || qemuMonitorJSONCommand(mon, cmd, &reply) < 0)\n        goto cleanup;\n\n    if (qemuMonitorJSONHasError(reply, \"CommandNotFound\")) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED,\n                       _(\"Human monitor command is not available to run %s\"),\n                       cmd_str);\n        goto cleanup;\n    }\n\n    if (qemuMonitorJSONCheckError(cmd, reply))\n        goto cleanup;\n\n    obj = virJSONValueObjectGet(reply, \"return\");\n\n    if (reply_str) {\n        const char *data;\n\n        data = virJSONValueGetString(obj);\n        *reply_str = g_strdup(NULLSTR_EMPTY(data));\n    }\n\n    ret = 0;\n\n cleanup:\n    virJSONValueFree(cmd);\n    virJSONValueFree(reply);\n    return ret;\n}",
          "includes": [
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virsocket.h\"",
            "#include \"virenum.h\"",
            "#include \"cpu/cpu_x86.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virjson.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"driver.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuMonitorJSONHandleShutdown(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleReset(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePowerdown(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleStop(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleResume(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleRTCChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleWatchdog(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleIOError(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleVNCConnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleVNCInitialize(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleVNCDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSPICEConnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSPICEInitialize(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSPICEDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleTrayChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePMWakeup(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePMSuspend(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockJobCompleted(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockJobCanceled(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockJobReady(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleJobStatusChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBalloonChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePMSuspendDisk(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleGuestCrashloaded(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleGuestPanic(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleDeviceDeleted(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleNicRxFilterChanged(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSerialChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSpiceMigrated(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleMigrationStatus(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleMigrationPass(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleAcpiOstInfo(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockThreshold(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleDumpCompleted(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePRManagerStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleRdmaGidStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"libvirt_qemu_probes.h\"\n#include \"virsocket.h\"\n#include \"virenum.h\"\n#include \"cpu/cpu_x86.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virjson.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"driver.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_monitor_json.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nstatic void qemuMonitorJSONHandleShutdown(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleReset(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePowerdown(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleStop(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleResume(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleRTCChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleWatchdog(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleIOError(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleVNCConnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleVNCInitialize(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleVNCDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSPICEConnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSPICEInitialize(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSPICEDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleTrayChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePMWakeup(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePMSuspend(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockJobCompleted(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockJobCanceled(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockJobReady(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleJobStatusChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBalloonChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePMSuspendDisk(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleGuestCrashloaded(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleGuestPanic(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleDeviceDeleted(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleNicRxFilterChanged(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSerialChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSpiceMigrated(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleMigrationStatus(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleMigrationPass(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleAcpiOstInfo(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockThreshold(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleDumpCompleted(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePRManagerStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleRdmaGidStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);\n\nint\nqemuMonitorJSONHumanCommand(qemuMonitorPtr mon,\n                            const char *cmd_str,\n                            char **reply_str)\n{\n    virJSONValuePtr cmd = NULL;\n    virJSONValuePtr reply = NULL;\n    virJSONValuePtr obj;\n    int ret = -1;\n\n    cmd = qemuMonitorJSONMakeCommand(\"human-monitor-command\",\n                                     \"s:command-line\", cmd_str,\n                                     NULL);\n\n    if (!cmd || qemuMonitorJSONCommand(mon, cmd, &reply) < 0)\n        goto cleanup;\n\n    if (qemuMonitorJSONHasError(reply, \"CommandNotFound\")) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED,\n                       _(\"Human monitor command is not available to run %s\"),\n                       cmd_str);\n        goto cleanup;\n    }\n\n    if (qemuMonitorJSONCheckError(cmd, reply))\n        goto cleanup;\n\n    obj = virJSONValueObjectGet(reply, \"return\");\n\n    if (reply_str) {\n        const char *data;\n\n        data = virJSONValueGetString(obj);\n        *reply_str = g_strdup(NULLSTR_EMPTY(data));\n    }\n\n    ret = 0;\n\n cleanup:\n    virJSONValueFree(cmd);\n    virJSONValueFree(reply);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"savevm \\\"%s\\\"\"",
            "name"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include <config.h>\n\nint\nqemuMonitorTextCreateSnapshot(qemuMonitorPtr mon,\n                              const char *name)\n{\n    g_autofree char *cmd = NULL;\n    g_autofree char *reply = NULL;\n\n    cmd = g_strdup_printf(\"savevm \\\"%s\\\"\", name);\n\n    if (qemuMonitorJSONHumanCommand(mon, cmd, &reply))\n        return -1;\n\n    if (strstr(reply, \"Error while creating snapshot\") ||\n        strstr(reply, \"Could not open VM state file\") ||\n        strstr(reply, \"State blocked by non-migratable device\") ||\n        strstr(reply, \"Error: \") ||\n        (strstr(reply, \"Error\") && strstr(reply, \"while writing VM\"))) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Failed to take snapshot: %s\"), reply);\n        return -1;\n    } else if (strstr(reply, \"No block device can accept snapshots\")) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"this domain does not have a device to take snapshots\"));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuMonitorTextDriveDel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor_text.c",
    "lines": "94-129",
    "snippet": "int qemuMonitorTextDriveDel(qemuMonitorPtr mon,\n                            const char *drivestr)\n{\n    char *cmd = NULL;\n    char *reply = NULL;\n    int ret = -1;\n\n    cmd = g_strdup_printf(\"drive_del %s\", drivestr);\n\n    if (qemuMonitorJSONHumanCommand(mon, cmd, &reply) < 0)\n        goto cleanup;\n\n    if (strstr(reply, \"unknown command:\")) {\n        VIR_ERROR(_(\"deleting drive is not supported.  \"\n                    \"This may leak data if disk is reassigned\"));\n        ret = 1;\n        goto cleanup;\n\n    /* (qemu) drive_del wark\n     * Device 'wark' not found */\n    } else if (strstr(reply, \"Device '\") && strstr(reply, \"not found\")) {\n        /* NB: device not found errors mean the drive was auto-deleted and we\n         * ignore the error */\n    } else if (STRNEQ(reply, \"\")) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"deleting %s drive failed: %s\"), drivestr, reply);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(cmd);\n    VIR_FREE(reply);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_monitor_json.h\"",
      "#include \"qemu_monitor_text.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "reply"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cmd"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"deleting %s drive failed: %s\")",
            "drivestr",
            "reply"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"deleting %s drive failed: %s\""
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "reply",
            "\"\""
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"not found\""
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"Device '\""
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"deleting drive is not supported.  \"\n                    \"This may leak data if disk is reassigned\")"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"unknown command:\""
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMonitorJSONHumanCommand",
          "args": [
            "mon",
            "cmd",
            "&reply"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorJSONHumanCommand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor_json.c",
          "lines": "1567-1609",
          "snippet": "int\nqemuMonitorJSONHumanCommand(qemuMonitorPtr mon,\n                            const char *cmd_str,\n                            char **reply_str)\n{\n    virJSONValuePtr cmd = NULL;\n    virJSONValuePtr reply = NULL;\n    virJSONValuePtr obj;\n    int ret = -1;\n\n    cmd = qemuMonitorJSONMakeCommand(\"human-monitor-command\",\n                                     \"s:command-line\", cmd_str,\n                                     NULL);\n\n    if (!cmd || qemuMonitorJSONCommand(mon, cmd, &reply) < 0)\n        goto cleanup;\n\n    if (qemuMonitorJSONHasError(reply, \"CommandNotFound\")) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED,\n                       _(\"Human monitor command is not available to run %s\"),\n                       cmd_str);\n        goto cleanup;\n    }\n\n    if (qemuMonitorJSONCheckError(cmd, reply))\n        goto cleanup;\n\n    obj = virJSONValueObjectGet(reply, \"return\");\n\n    if (reply_str) {\n        const char *data;\n\n        data = virJSONValueGetString(obj);\n        *reply_str = g_strdup(NULLSTR_EMPTY(data));\n    }\n\n    ret = 0;\n\n cleanup:\n    virJSONValueFree(cmd);\n    virJSONValueFree(reply);\n    return ret;\n}",
          "includes": [
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virsocket.h\"",
            "#include \"virenum.h\"",
            "#include \"cpu/cpu_x86.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virjson.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"driver.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuMonitorJSONHandleShutdown(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleReset(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePowerdown(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleStop(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleResume(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleRTCChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleWatchdog(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleIOError(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleVNCConnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleVNCInitialize(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleVNCDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSPICEConnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSPICEInitialize(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSPICEDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleTrayChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePMWakeup(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePMSuspend(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockJobCompleted(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockJobCanceled(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockJobReady(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleJobStatusChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBalloonChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePMSuspendDisk(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleGuestCrashloaded(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleGuestPanic(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleDeviceDeleted(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleNicRxFilterChanged(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSerialChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSpiceMigrated(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleMigrationStatus(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleMigrationPass(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleAcpiOstInfo(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockThreshold(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleDumpCompleted(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePRManagerStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleRdmaGidStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"libvirt_qemu_probes.h\"\n#include \"virsocket.h\"\n#include \"virenum.h\"\n#include \"cpu/cpu_x86.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virjson.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"driver.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_monitor_json.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nstatic void qemuMonitorJSONHandleShutdown(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleReset(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePowerdown(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleStop(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleResume(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleRTCChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleWatchdog(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleIOError(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleVNCConnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleVNCInitialize(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleVNCDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSPICEConnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSPICEInitialize(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSPICEDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleTrayChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePMWakeup(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePMSuspend(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockJobCompleted(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockJobCanceled(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockJobReady(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleJobStatusChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBalloonChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePMSuspendDisk(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleGuestCrashloaded(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleGuestPanic(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleDeviceDeleted(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleNicRxFilterChanged(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSerialChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSpiceMigrated(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleMigrationStatus(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleMigrationPass(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleAcpiOstInfo(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockThreshold(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleDumpCompleted(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePRManagerStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleRdmaGidStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);\n\nint\nqemuMonitorJSONHumanCommand(qemuMonitorPtr mon,\n                            const char *cmd_str,\n                            char **reply_str)\n{\n    virJSONValuePtr cmd = NULL;\n    virJSONValuePtr reply = NULL;\n    virJSONValuePtr obj;\n    int ret = -1;\n\n    cmd = qemuMonitorJSONMakeCommand(\"human-monitor-command\",\n                                     \"s:command-line\", cmd_str,\n                                     NULL);\n\n    if (!cmd || qemuMonitorJSONCommand(mon, cmd, &reply) < 0)\n        goto cleanup;\n\n    if (qemuMonitorJSONHasError(reply, \"CommandNotFound\")) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED,\n                       _(\"Human monitor command is not available to run %s\"),\n                       cmd_str);\n        goto cleanup;\n    }\n\n    if (qemuMonitorJSONCheckError(cmd, reply))\n        goto cleanup;\n\n    obj = virJSONValueObjectGet(reply, \"return\");\n\n    if (reply_str) {\n        const char *data;\n\n        data = virJSONValueGetString(obj);\n        *reply_str = g_strdup(NULLSTR_EMPTY(data));\n    }\n\n    ret = 0;\n\n cleanup:\n    virJSONValueFree(cmd);\n    virJSONValueFree(reply);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"drive_del %s\"",
            "drivestr"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include <config.h>\n\nint qemuMonitorTextDriveDel(qemuMonitorPtr mon,\n                            const char *drivestr)\n{\n    char *cmd = NULL;\n    char *reply = NULL;\n    int ret = -1;\n\n    cmd = g_strdup_printf(\"drive_del %s\", drivestr);\n\n    if (qemuMonitorJSONHumanCommand(mon, cmd, &reply) < 0)\n        goto cleanup;\n\n    if (strstr(reply, \"unknown command:\")) {\n        VIR_ERROR(_(\"deleting drive is not supported.  \"\n                    \"This may leak data if disk is reassigned\"));\n        ret = 1;\n        goto cleanup;\n\n    /* (qemu) drive_del wark\n     * Device 'wark' not found */\n    } else if (strstr(reply, \"Device '\") && strstr(reply, \"not found\")) {\n        /* NB: device not found errors mean the drive was auto-deleted and we\n         * ignore the error */\n    } else if (STRNEQ(reply, \"\")) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"deleting %s drive failed: %s\"), drivestr, reply);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(cmd);\n    VIR_FREE(reply);\n    return ret;\n}"
  },
  {
    "function_name": "qemuMonitorTextAddDrive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor_text.c",
    "lines": "36-91",
    "snippet": "int qemuMonitorTextAddDrive(qemuMonitorPtr mon,\n                            const char *drivestr)\n{\n    char *cmd = NULL;\n    char *reply = NULL;\n    int ret = -1;\n\n    /* 'dummy' here is just a placeholder since there is no PCI\n     * address required when attaching drives to a controller */\n    cmd = g_strdup_printf(\"drive_add dummy %s\", drivestr);\n\n    if (qemuMonitorJSONHumanCommand(mon, cmd, &reply) < 0)\n        goto cleanup;\n\n    if (strstr(reply, \"unknown command:\")) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"drive hotplug is not supported\"));\n        goto cleanup;\n    }\n\n    if (strstr(reply, \"could not open disk image\")) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"open disk image file failed\"));\n        goto cleanup;\n    }\n\n    if (strstr(reply, \"Could not open\")) {\n        size_t len = strlen(reply);\n        if (reply[len - 1] == '\\n')\n            reply[len - 1] = '\\0';\n\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       reply);\n        goto cleanup;\n    }\n\n    if (strstr(reply, \"Image is not in\")) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"Incorrect disk format\"));\n        goto cleanup;\n    }\n\n    if (strstr(reply, \"IOMMU\") ||\n        strstr(reply, \"VFIO\")) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       reply);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(cmd);\n    VIR_FREE(reply);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_monitor_json.h\"",
      "#include \"qemu_monitor_text.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "reply"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cmd"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "reply"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"VFIO\""
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"IOMMU\""
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "_(\"Incorrect disk format\")"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Incorrect disk format\""
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"Image is not in\""
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "reply"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "reply"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"Could not open\""
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "_(\"open disk image file failed\")"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"could not open disk image\""
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "_(\"drive hotplug is not supported\")"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "reply",
            "\"unknown command:\""
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMonitorJSONHumanCommand",
          "args": [
            "mon",
            "cmd",
            "&reply"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorJSONHumanCommand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor_json.c",
          "lines": "1567-1609",
          "snippet": "int\nqemuMonitorJSONHumanCommand(qemuMonitorPtr mon,\n                            const char *cmd_str,\n                            char **reply_str)\n{\n    virJSONValuePtr cmd = NULL;\n    virJSONValuePtr reply = NULL;\n    virJSONValuePtr obj;\n    int ret = -1;\n\n    cmd = qemuMonitorJSONMakeCommand(\"human-monitor-command\",\n                                     \"s:command-line\", cmd_str,\n                                     NULL);\n\n    if (!cmd || qemuMonitorJSONCommand(mon, cmd, &reply) < 0)\n        goto cleanup;\n\n    if (qemuMonitorJSONHasError(reply, \"CommandNotFound\")) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED,\n                       _(\"Human monitor command is not available to run %s\"),\n                       cmd_str);\n        goto cleanup;\n    }\n\n    if (qemuMonitorJSONCheckError(cmd, reply))\n        goto cleanup;\n\n    obj = virJSONValueObjectGet(reply, \"return\");\n\n    if (reply_str) {\n        const char *data;\n\n        data = virJSONValueGetString(obj);\n        *reply_str = g_strdup(NULLSTR_EMPTY(data));\n    }\n\n    ret = 0;\n\n cleanup:\n    virJSONValueFree(cmd);\n    virJSONValueFree(reply);\n    return ret;\n}",
          "includes": [
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virsocket.h\"",
            "#include \"virenum.h\"",
            "#include \"cpu/cpu_x86.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virjson.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"driver.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuMonitorJSONHandleShutdown(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleReset(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePowerdown(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleStop(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleResume(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleRTCChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleWatchdog(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleIOError(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleVNCConnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleVNCInitialize(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleVNCDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSPICEConnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSPICEInitialize(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSPICEDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleTrayChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePMWakeup(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePMSuspend(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockJobCompleted(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockJobCanceled(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockJobReady(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleJobStatusChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBalloonChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePMSuspendDisk(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleGuestCrashloaded(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleGuestPanic(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleDeviceDeleted(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleNicRxFilterChanged(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSerialChange(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleSpiceMigrated(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleMigrationStatus(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleMigrationPass(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleAcpiOstInfo(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleBlockThreshold(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleDumpCompleted(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandlePRManagerStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);",
            "static void qemuMonitorJSONHandleRdmaGidStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"libvirt_qemu_probes.h\"\n#include \"virsocket.h\"\n#include \"virenum.h\"\n#include \"cpu/cpu_x86.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virjson.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"driver.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_monitor_json.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nstatic void qemuMonitorJSONHandleShutdown(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleReset(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePowerdown(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleStop(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleResume(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleRTCChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleWatchdog(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleIOError(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleVNCConnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleVNCInitialize(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleVNCDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSPICEConnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSPICEInitialize(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSPICEDisconnect(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleTrayChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePMWakeup(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePMSuspend(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockJobCompleted(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockJobCanceled(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockJobReady(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleJobStatusChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBalloonChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePMSuspendDisk(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleGuestCrashloaded(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleGuestPanic(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleDeviceDeleted(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleNicRxFilterChanged(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSerialChange(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleSpiceMigrated(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleMigrationStatus(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleMigrationPass(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleAcpiOstInfo(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleBlockThreshold(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleDumpCompleted(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandlePRManagerStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);\nstatic void qemuMonitorJSONHandleRdmaGidStatusChanged(qemuMonitorPtr mon, virJSONValuePtr data);\n\nint\nqemuMonitorJSONHumanCommand(qemuMonitorPtr mon,\n                            const char *cmd_str,\n                            char **reply_str)\n{\n    virJSONValuePtr cmd = NULL;\n    virJSONValuePtr reply = NULL;\n    virJSONValuePtr obj;\n    int ret = -1;\n\n    cmd = qemuMonitorJSONMakeCommand(\"human-monitor-command\",\n                                     \"s:command-line\", cmd_str,\n                                     NULL);\n\n    if (!cmd || qemuMonitorJSONCommand(mon, cmd, &reply) < 0)\n        goto cleanup;\n\n    if (qemuMonitorJSONHasError(reply, \"CommandNotFound\")) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED,\n                       _(\"Human monitor command is not available to run %s\"),\n                       cmd_str);\n        goto cleanup;\n    }\n\n    if (qemuMonitorJSONCheckError(cmd, reply))\n        goto cleanup;\n\n    obj = virJSONValueObjectGet(reply, \"return\");\n\n    if (reply_str) {\n        const char *data;\n\n        data = virJSONValueGetString(obj);\n        *reply_str = g_strdup(NULLSTR_EMPTY(data));\n    }\n\n    ret = 0;\n\n cleanup:\n    virJSONValueFree(cmd);\n    virJSONValueFree(reply);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"drive_add dummy %s\"",
            "drivestr"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include <config.h>\n\nint qemuMonitorTextAddDrive(qemuMonitorPtr mon,\n                            const char *drivestr)\n{\n    char *cmd = NULL;\n    char *reply = NULL;\n    int ret = -1;\n\n    /* 'dummy' here is just a placeholder since there is no PCI\n     * address required when attaching drives to a controller */\n    cmd = g_strdup_printf(\"drive_add dummy %s\", drivestr);\n\n    if (qemuMonitorJSONHumanCommand(mon, cmd, &reply) < 0)\n        goto cleanup;\n\n    if (strstr(reply, \"unknown command:\")) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"drive hotplug is not supported\"));\n        goto cleanup;\n    }\n\n    if (strstr(reply, \"could not open disk image\")) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"open disk image file failed\"));\n        goto cleanup;\n    }\n\n    if (strstr(reply, \"Could not open\")) {\n        size_t len = strlen(reply);\n        if (reply[len - 1] == '\\n')\n            reply[len - 1] = '\\0';\n\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       reply);\n        goto cleanup;\n    }\n\n    if (strstr(reply, \"Image is not in\")) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"Incorrect disk format\"));\n        goto cleanup;\n    }\n\n    if (strstr(reply, \"IOMMU\") ||\n        strstr(reply, \"VFIO\")) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       reply);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(cmd);\n    VIR_FREE(reply);\n    return ret;\n}"
  }
]