[
  {
    "function_name": "qemuVhostUserFillDomainFS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
    "lines": "421-457",
    "snippet": "int\nqemuVhostUserFillDomainFS(virQEMUDriverPtr driver,\n                          virDomainFSDefPtr fs)\n{\n    qemuVhostUserPtr *vus = NULL;\n    ssize_t nvus = 0;\n    ssize_t i;\n    int ret = -1;\n\n    if ((nvus = qemuVhostUserFetchParsedConfigs(driver->privileged,\n                                                &vus, NULL)) < 0)\n        goto end;\n\n    for (i = 0; i < nvus; i++) {\n        qemuVhostUserPtr vu = vus[i];\n\n        if (vu->type != QEMU_VHOST_USER_TYPE_FS)\n            continue;\n\n        fs->binary = g_strdup(vu->binary);\n        break;\n    }\n\n    if (i == nvus) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"Unable to find a satisfying virtiofsd\"));\n        goto end;\n    }\n\n    ret = 0;\n\n end:\n    for (i = 0; i < nvus; i++)\n        qemuVhostUserFree(vus[i]);\n    g_free(vus);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virenum.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virjson.h\"",
      "#include \"qemu_interop_config.h\"",
      "#include \"qemu_vhost_user.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "vus"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuVhostUserFree",
          "args": [
            "vus[i]"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "qemuVhostUserFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
          "lines": "123-135",
          "snippet": "void\nqemuVhostUserFree(qemuVhostUserPtr vu)\n{\n    if (!vu)\n        return;\n\n    if (vu->type == QEMU_VHOST_USER_TYPE_GPU)\n        VIR_FREE(vu->capabilities.gpu.features);\n\n    VIR_FREE(vu->binary);\n\n    VIR_FREE(vu);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virjson.h\"",
            "#include \"qemu_interop_config.h\"",
            "#include \"qemu_vhost_user.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nvoid\nqemuVhostUserFree(qemuVhostUserPtr vu)\n{\n    if (!vu)\n        return;\n\n    if (vu->type == QEMU_VHOST_USER_TYPE_GPU)\n        VIR_FREE(vu->capabilities.gpu.features);\n\n    VIR_FREE(vu->binary);\n\n    VIR_FREE(vu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "_(\"Unable to find a satisfying virtiofsd\")"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to find a satisfying virtiofsd\""
          ],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "vu->binary"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuVhostUserFetchParsedConfigs",
          "args": [
            "driver->privileged",
            "&vus",
            "NULL"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "qemuVhostUserFetchParsedConfigs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
          "lines": "241-274",
          "snippet": "static ssize_t\nqemuVhostUserFetchParsedConfigs(bool privileged,\n                                qemuVhostUserPtr **vhostuserRet,\n                                char ***pathsRet)\n{\n    VIR_AUTOSTRINGLIST paths = NULL;\n    size_t npaths;\n    qemuVhostUserPtr *vus = NULL;\n    size_t i;\n\n    if (qemuVhostUserFetchConfigs(&paths, privileged) < 0)\n        return -1;\n\n    npaths = virStringListLength((const char **)paths);\n\n    if (VIR_ALLOC_N(vus, npaths) < 0)\n        return -1;\n\n    for (i = 0; i < npaths; i++) {\n        if (!(vus[i] = qemuVhostUserParse(paths[i])))\n            goto error;\n    }\n\n    *vhostuserRet = g_steal_pointer(&vus);\n    if (pathsRet)\n        *pathsRet = g_steal_pointer(&paths);\n    return npaths;\n\n error:\n    while (i > 0)\n        qemuVhostUserFree(vus[--i]);\n    VIR_FREE(vus);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virjson.h\"",
            "#include \"qemu_interop_config.h\"",
            "#include \"qemu_vhost_user.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nstatic ssize_t\nqemuVhostUserFetchParsedConfigs(bool privileged,\n                                qemuVhostUserPtr **vhostuserRet,\n                                char ***pathsRet)\n{\n    VIR_AUTOSTRINGLIST paths = NULL;\n    size_t npaths;\n    qemuVhostUserPtr *vus = NULL;\n    size_t i;\n\n    if (qemuVhostUserFetchConfigs(&paths, privileged) < 0)\n        return -1;\n\n    npaths = virStringListLength((const char **)paths);\n\n    if (VIR_ALLOC_N(vus, npaths) < 0)\n        return -1;\n\n    for (i = 0; i < npaths; i++) {\n        if (!(vus[i] = qemuVhostUserParse(paths[i])))\n            goto error;\n    }\n\n    *vhostuserRet = g_steal_pointer(&vus);\n    if (pathsRet)\n        *pathsRet = g_steal_pointer(&paths);\n    return npaths;\n\n error:\n    while (i > 0)\n        qemuVhostUserFree(vus[--i]);\n    VIR_FREE(vus);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nint\nqemuVhostUserFillDomainFS(virQEMUDriverPtr driver,\n                          virDomainFSDefPtr fs)\n{\n    qemuVhostUserPtr *vus = NULL;\n    ssize_t nvus = 0;\n    ssize_t i;\n    int ret = -1;\n\n    if ((nvus = qemuVhostUserFetchParsedConfigs(driver->privileged,\n                                                &vus, NULL)) < 0)\n        goto end;\n\n    for (i = 0; i < nvus; i++) {\n        qemuVhostUserPtr vu = vus[i];\n\n        if (vu->type != QEMU_VHOST_USER_TYPE_FS)\n            continue;\n\n        fs->binary = g_strdup(vu->binary);\n        break;\n    }\n\n    if (i == nvus) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"Unable to find a satisfying virtiofsd\"));\n        goto end;\n    }\n\n    ret = 0;\n\n end:\n    for (i = 0; i < nvus; i++)\n        qemuVhostUserFree(vus[i]);\n    g_free(vus);\n    return ret;\n}"
  },
  {
    "function_name": "qemuVhostUserFillDomainGPU",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
    "lines": "335-418",
    "snippet": "int\nqemuVhostUserFillDomainGPU(virQEMUDriverPtr driver,\n                           virDomainVideoDefPtr video)\n{\n    qemuVhostUserPtr *vus = NULL;\n    qemuVhostUserPtr vu = NULL;\n    ssize_t nvus = 0;\n    ssize_t i;\n    int ret = -1;\n\n    if ((nvus = qemuVhostUserFetchParsedConfigs(driver->privileged,\n                                                &vus, NULL)) < 0)\n        goto end;\n\n    for (i = 0; i < nvus; i++) {\n        g_autoptr(virJSONValue) doc = NULL;\n        g_autofree char *output = NULL;\n        g_autoptr(virCommand) cmd = NULL;\n\n        vu = vus[i];\n        if (vu->type != QEMU_VHOST_USER_TYPE_GPU)\n            continue;\n\n        cmd = virCommandNewArgList(vu->binary, \"--print-capabilities\", NULL);\n        virCommandSetOutputBuffer(cmd, &output);\n        if (virCommandRun(cmd, NULL) < 0)\n            continue;\n\n        if (!(doc = virJSONValueFromString(output))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unable to parse json capabilities '%s'\"),\n                           vu->binary);\n            continue;\n        }\n\n        if (qemuVhostUserGPUFillCapabilities(vu, doc) < 0)\n            continue;\n\n        if (video->accel) {\n            if (video->accel->accel3d &&\n                !qemuVhostUserGPUHasFeature(&vu->capabilities.gpu,\n                                            QEMU_VHOST_USER_GPU_FEATURE_VIRGL))\n                continue;\n\n            if (video->accel->rendernode &&\n                !qemuVhostUserGPUHasFeature(&vu->capabilities.gpu,\n                                            QEMU_VHOST_USER_GPU_FEATURE_RENDER_NODE))\n                continue;\n        }\n\n        if (!video->driver && VIR_ALLOC(video->driver) < 0)\n            goto end;\n\n        VIR_FREE(video->driver->vhost_user_binary);\n        video->driver->vhost_user_binary = g_strdup(vu->binary);\n\n        break;\n    }\n\n    if (i == nvus) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"Unable to find a satisfying vhost-user-gpu\"));\n        goto end;\n    }\n\n    if (!video->accel && VIR_ALLOC(video->accel) < 0)\n        goto end;\n\n    if (!video->accel->rendernode &&\n        qemuVhostUserGPUHasFeature(&vu->capabilities.gpu,\n                                   QEMU_VHOST_USER_GPU_FEATURE_RENDER_NODE)) {\n        video->accel->rendernode = virHostGetDRMRenderNode();\n        if (!video->accel->rendernode)\n            goto end;\n    }\n\n    ret = 0;\n\n end:\n    for (i = 0; i < nvus; i++)\n        qemuVhostUserFree(vus[i]);\n    VIR_FREE(vus);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virenum.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virjson.h\"",
      "#include \"qemu_interop_config.h\"",
      "#include \"qemu_vhost_user.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vus"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuVhostUserFree",
          "args": [
            "vus[i]"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "qemuVhostUserFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
          "lines": "123-135",
          "snippet": "void\nqemuVhostUserFree(qemuVhostUserPtr vu)\n{\n    if (!vu)\n        return;\n\n    if (vu->type == QEMU_VHOST_USER_TYPE_GPU)\n        VIR_FREE(vu->capabilities.gpu.features);\n\n    VIR_FREE(vu->binary);\n\n    VIR_FREE(vu);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virjson.h\"",
            "#include \"qemu_interop_config.h\"",
            "#include \"qemu_vhost_user.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nvoid\nqemuVhostUserFree(qemuVhostUserPtr vu)\n{\n    if (!vu)\n        return;\n\n    if (vu->type == QEMU_VHOST_USER_TYPE_GPU)\n        VIR_FREE(vu->capabilities.gpu.features);\n\n    VIR_FREE(vu->binary);\n\n    VIR_FREE(vu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHostGetDRMRenderNode",
          "args": [],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "virHostGetDRMRenderNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1693-1728",
          "snippet": "char *\nvirHostGetDRMRenderNode(void)\n{\n    char *ret = NULL;\n    DIR *driDir = NULL;\n    const char *driPath = \"/dev/dri\";\n    struct dirent *ent = NULL;\n    int dirErr = 0;\n    bool have_rendernode = false;\n\n    if (virDirOpen(&driDir, driPath) < 0)\n        return NULL;\n\n    while ((dirErr = virDirRead(driDir, &ent, driPath)) > 0) {\n        if (STRPREFIX(ent->d_name, \"renderD\")) {\n            have_rendernode = true;\n            break;\n        }\n    }\n\n    if (dirErr < 0)\n        goto cleanup;\n\n    /* even if /dev/dri exists, there might be no renderDX nodes available */\n    if (!have_rendernode) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No DRM render nodes available\"));\n        goto cleanup;\n    }\n\n    ret = g_strdup_printf(\"%s/%s\", driPath, ent->d_name);\n\n cleanup:\n    VIR_DIR_CLOSE(driDir);\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirHostGetDRMRenderNode(void)\n{\n    char *ret = NULL;\n    DIR *driDir = NULL;\n    const char *driPath = \"/dev/dri\";\n    struct dirent *ent = NULL;\n    int dirErr = 0;\n    bool have_rendernode = false;\n\n    if (virDirOpen(&driDir, driPath) < 0)\n        return NULL;\n\n    while ((dirErr = virDirRead(driDir, &ent, driPath)) > 0) {\n        if (STRPREFIX(ent->d_name, \"renderD\")) {\n            have_rendernode = true;\n            break;\n        }\n    }\n\n    if (dirErr < 0)\n        goto cleanup;\n\n    /* even if /dev/dri exists, there might be no renderDX nodes available */\n    if (!have_rendernode) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No DRM render nodes available\"));\n        goto cleanup;\n    }\n\n    ret = g_strdup_printf(\"%s/%s\", driPath, ent->d_name);\n\n cleanup:\n    VIR_DIR_CLOSE(driDir);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuVhostUserGPUHasFeature",
          "args": [
            "&vu->capabilities.gpu",
            "QEMU_VHOST_USER_GPU_FEATURE_RENDER_NODE"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "qemuVhostUserGPUHasFeature",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
          "lines": "320-332",
          "snippet": "static bool\nqemuVhostUserGPUHasFeature(qemuVhostUserGPUPtr gpu,\n                           qemuVhostUserGPUFeature feature)\n{\n    size_t i;\n\n    for (i = 0; i < gpu->nfeatures; i++) {\n        if (gpu->features[i] == feature)\n            return true;\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virjson.h\"",
            "#include \"qemu_interop_config.h\"",
            "#include \"qemu_vhost_user.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nstatic bool\nqemuVhostUserGPUHasFeature(qemuVhostUserGPUPtr gpu,\n                           qemuVhostUserGPUFeature feature)\n{\n    size_t i;\n\n    for (i = 0; i < gpu->nfeatures; i++) {\n        if (gpu->features[i] == feature)\n            return true;\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "video->accel"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "_(\"Unable to find a satisfying vhost-user-gpu\")"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to find a satisfying vhost-user-gpu\""
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "vu->binary"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "video->driver->vhost_user_binary"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "video->driver"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuVhostUserGPUFillCapabilities",
          "args": [
            "vu",
            "doc"
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "qemuVhostUserGPUFillCapabilities",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
          "lines": "277-317",
          "snippet": "static int\nqemuVhostUserGPUFillCapabilities(qemuVhostUserPtr vu,\n                                 virJSONValuePtr doc)\n{\n    qemuVhostUserGPUPtr gpu = &vu->capabilities.gpu;\n    virJSONValuePtr featuresJSON;\n    size_t nfeatures;\n    size_t i;\n    g_autoptr(qemuVhostUserGPUFeature) features = NULL;\n\n    if (!(featuresJSON = virJSONValueObjectGetArray(doc, \"features\"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to get features from '%s'\"),\n                       vu->binary);\n        return -1;\n    }\n\n    nfeatures = virJSONValueArraySize(featuresJSON);\n    if (VIR_ALLOC_N(features, nfeatures) < 0)\n        return -1;\n\n    for (i = 0; i < nfeatures; i++) {\n        virJSONValuePtr item = virJSONValueArrayGet(featuresJSON, i);\n        const char *tmpStr = virJSONValueGetString(item);\n        int tmp;\n\n        if ((tmp = qemuVhostUserGPUFeatureTypeFromString(tmpStr)) <= 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unknown feature %s\"),\n                           tmpStr);\n            continue;\n        }\n\n        features[i] = tmp;\n    }\n\n    gpu->features = g_steal_pointer(&features);\n    gpu->nfeatures = nfeatures;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virjson.h\"",
            "#include \"qemu_interop_config.h\"",
            "#include \"qemu_vhost_user.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nstatic int\nqemuVhostUserGPUFillCapabilities(qemuVhostUserPtr vu,\n                                 virJSONValuePtr doc)\n{\n    qemuVhostUserGPUPtr gpu = &vu->capabilities.gpu;\n    virJSONValuePtr featuresJSON;\n    size_t nfeatures;\n    size_t i;\n    g_autoptr(qemuVhostUserGPUFeature) features = NULL;\n\n    if (!(featuresJSON = virJSONValueObjectGetArray(doc, \"features\"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to get features from '%s'\"),\n                       vu->binary);\n        return -1;\n    }\n\n    nfeatures = virJSONValueArraySize(featuresJSON);\n    if (VIR_ALLOC_N(features, nfeatures) < 0)\n        return -1;\n\n    for (i = 0; i < nfeatures; i++) {\n        virJSONValuePtr item = virJSONValueArrayGet(featuresJSON, i);\n        const char *tmpStr = virJSONValueGetString(item);\n        int tmp;\n\n        if ((tmp = qemuVhostUserGPUFeatureTypeFromString(tmpStr)) <= 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unknown feature %s\"),\n                           tmpStr);\n            continue;\n        }\n\n        features[i] = tmp;\n    }\n\n    gpu->features = g_steal_pointer(&features);\n    gpu->nfeatures = nfeatures;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unable to parse json capabilities '%s'\")",
            "vu->binary"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueFromString",
          "args": [
            "output"
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFromString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1993-1999",
          "snippet": "virJSONValuePtr\nvirJSONValueFromString(const char *jsonstring G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"No JSON parser implementation is available\"));\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueFromString(const char *jsonstring G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"No JSON parser implementation is available\"));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandSetOutputBuffer",
          "args": [
            "cmd",
            "&output"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandSetOutputBuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1869-1884",
          "snippet": "void\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNewArgList",
          "args": [
            "vu->binary",
            "\"--print-capabilities\"",
            "NULL"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuVhostUserFetchParsedConfigs",
          "args": [
            "driver->privileged",
            "&vus",
            "NULL"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "qemuVhostUserFetchParsedConfigs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
          "lines": "241-274",
          "snippet": "static ssize_t\nqemuVhostUserFetchParsedConfigs(bool privileged,\n                                qemuVhostUserPtr **vhostuserRet,\n                                char ***pathsRet)\n{\n    VIR_AUTOSTRINGLIST paths = NULL;\n    size_t npaths;\n    qemuVhostUserPtr *vus = NULL;\n    size_t i;\n\n    if (qemuVhostUserFetchConfigs(&paths, privileged) < 0)\n        return -1;\n\n    npaths = virStringListLength((const char **)paths);\n\n    if (VIR_ALLOC_N(vus, npaths) < 0)\n        return -1;\n\n    for (i = 0; i < npaths; i++) {\n        if (!(vus[i] = qemuVhostUserParse(paths[i])))\n            goto error;\n    }\n\n    *vhostuserRet = g_steal_pointer(&vus);\n    if (pathsRet)\n        *pathsRet = g_steal_pointer(&paths);\n    return npaths;\n\n error:\n    while (i > 0)\n        qemuVhostUserFree(vus[--i]);\n    VIR_FREE(vus);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virjson.h\"",
            "#include \"qemu_interop_config.h\"",
            "#include \"qemu_vhost_user.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nstatic ssize_t\nqemuVhostUserFetchParsedConfigs(bool privileged,\n                                qemuVhostUserPtr **vhostuserRet,\n                                char ***pathsRet)\n{\n    VIR_AUTOSTRINGLIST paths = NULL;\n    size_t npaths;\n    qemuVhostUserPtr *vus = NULL;\n    size_t i;\n\n    if (qemuVhostUserFetchConfigs(&paths, privileged) < 0)\n        return -1;\n\n    npaths = virStringListLength((const char **)paths);\n\n    if (VIR_ALLOC_N(vus, npaths) < 0)\n        return -1;\n\n    for (i = 0; i < npaths; i++) {\n        if (!(vus[i] = qemuVhostUserParse(paths[i])))\n            goto error;\n    }\n\n    *vhostuserRet = g_steal_pointer(&vus);\n    if (pathsRet)\n        *pathsRet = g_steal_pointer(&paths);\n    return npaths;\n\n error:\n    while (i > 0)\n        qemuVhostUserFree(vus[--i]);\n    VIR_FREE(vus);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nint\nqemuVhostUserFillDomainGPU(virQEMUDriverPtr driver,\n                           virDomainVideoDefPtr video)\n{\n    qemuVhostUserPtr *vus = NULL;\n    qemuVhostUserPtr vu = NULL;\n    ssize_t nvus = 0;\n    ssize_t i;\n    int ret = -1;\n\n    if ((nvus = qemuVhostUserFetchParsedConfigs(driver->privileged,\n                                                &vus, NULL)) < 0)\n        goto end;\n\n    for (i = 0; i < nvus; i++) {\n        g_autoptr(virJSONValue) doc = NULL;\n        g_autofree char *output = NULL;\n        g_autoptr(virCommand) cmd = NULL;\n\n        vu = vus[i];\n        if (vu->type != QEMU_VHOST_USER_TYPE_GPU)\n            continue;\n\n        cmd = virCommandNewArgList(vu->binary, \"--print-capabilities\", NULL);\n        virCommandSetOutputBuffer(cmd, &output);\n        if (virCommandRun(cmd, NULL) < 0)\n            continue;\n\n        if (!(doc = virJSONValueFromString(output))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unable to parse json capabilities '%s'\"),\n                           vu->binary);\n            continue;\n        }\n\n        if (qemuVhostUserGPUFillCapabilities(vu, doc) < 0)\n            continue;\n\n        if (video->accel) {\n            if (video->accel->accel3d &&\n                !qemuVhostUserGPUHasFeature(&vu->capabilities.gpu,\n                                            QEMU_VHOST_USER_GPU_FEATURE_VIRGL))\n                continue;\n\n            if (video->accel->rendernode &&\n                !qemuVhostUserGPUHasFeature(&vu->capabilities.gpu,\n                                            QEMU_VHOST_USER_GPU_FEATURE_RENDER_NODE))\n                continue;\n        }\n\n        if (!video->driver && VIR_ALLOC(video->driver) < 0)\n            goto end;\n\n        VIR_FREE(video->driver->vhost_user_binary);\n        video->driver->vhost_user_binary = g_strdup(vu->binary);\n\n        break;\n    }\n\n    if (i == nvus) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"Unable to find a satisfying vhost-user-gpu\"));\n        goto end;\n    }\n\n    if (!video->accel && VIR_ALLOC(video->accel) < 0)\n        goto end;\n\n    if (!video->accel->rendernode &&\n        qemuVhostUserGPUHasFeature(&vu->capabilities.gpu,\n                                   QEMU_VHOST_USER_GPU_FEATURE_RENDER_NODE)) {\n        video->accel->rendernode = virHostGetDRMRenderNode();\n        if (!video->accel->rendernode)\n            goto end;\n    }\n\n    ret = 0;\n\n end:\n    for (i = 0; i < nvus; i++)\n        qemuVhostUserFree(vus[i]);\n    VIR_FREE(vus);\n    return ret;\n}"
  },
  {
    "function_name": "qemuVhostUserGPUHasFeature",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
    "lines": "320-332",
    "snippet": "static bool\nqemuVhostUserGPUHasFeature(qemuVhostUserGPUPtr gpu,\n                           qemuVhostUserGPUFeature feature)\n{\n    size_t i;\n\n    for (i = 0; i < gpu->nfeatures; i++) {\n        if (gpu->features[i] == feature)\n            return true;\n    }\n\n    return false;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virenum.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virjson.h\"",
      "#include \"qemu_interop_config.h\"",
      "#include \"qemu_vhost_user.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nstatic bool\nqemuVhostUserGPUHasFeature(qemuVhostUserGPUPtr gpu,\n                           qemuVhostUserGPUFeature feature)\n{\n    size_t i;\n\n    for (i = 0; i < gpu->nfeatures; i++) {\n        if (gpu->features[i] == feature)\n            return true;\n    }\n\n    return false;\n}"
  },
  {
    "function_name": "qemuVhostUserGPUFillCapabilities",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
    "lines": "277-317",
    "snippet": "static int\nqemuVhostUserGPUFillCapabilities(qemuVhostUserPtr vu,\n                                 virJSONValuePtr doc)\n{\n    qemuVhostUserGPUPtr gpu = &vu->capabilities.gpu;\n    virJSONValuePtr featuresJSON;\n    size_t nfeatures;\n    size_t i;\n    g_autoptr(qemuVhostUserGPUFeature) features = NULL;\n\n    if (!(featuresJSON = virJSONValueObjectGetArray(doc, \"features\"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to get features from '%s'\"),\n                       vu->binary);\n        return -1;\n    }\n\n    nfeatures = virJSONValueArraySize(featuresJSON);\n    if (VIR_ALLOC_N(features, nfeatures) < 0)\n        return -1;\n\n    for (i = 0; i < nfeatures; i++) {\n        virJSONValuePtr item = virJSONValueArrayGet(featuresJSON, i);\n        const char *tmpStr = virJSONValueGetString(item);\n        int tmp;\n\n        if ((tmp = qemuVhostUserGPUFeatureTypeFromString(tmpStr)) <= 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unknown feature %s\"),\n                           tmpStr);\n            continue;\n        }\n\n        features[i] = tmp;\n    }\n\n    gpu->features = g_steal_pointer(&features);\n    gpu->nfeatures = nfeatures;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virenum.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virjson.h\"",
      "#include \"qemu_interop_config.h\"",
      "#include \"qemu_vhost_user.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&features"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unknown feature %s\")",
            "tmpStr"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown feature %s\""
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuVhostUserGPUFeatureTypeFromString",
          "args": [
            "tmpStr"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueGetString",
          "args": [
            "item"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueGetString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1115-1122",
          "snippet": "const char *\nvirJSONValueGetString(virJSONValuePtr string)\n{\n    if (string->type != VIR_JSON_TYPE_STRING)\n        return NULL;\n\n    return string->data.string;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueGetString(virJSONValuePtr string)\n{\n    if (string->type != VIR_JSON_TYPE_STRING)\n        return NULL;\n\n    return string->data.string;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayGet",
          "args": [
            "featuresJSON",
            "i"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1024-1035",
          "snippet": "virJSONValuePtr\nvirJSONValueArrayGet(virJSONValuePtr array,\n                     unsigned int element)\n{\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return NULL;\n\n    if (element >= array->data.array.nvalues)\n        return NULL;\n\n    return array->data.array.values[element];\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueArrayGet(virJSONValuePtr array,\n                     unsigned int element)\n{\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return NULL;\n\n    if (element >= array->data.array.nvalues)\n        return NULL;\n\n    return array->data.array.values[element];\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "features",
            "nfeatures"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueArraySize",
          "args": [
            "featuresJSON"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArraySize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1017-1021",
          "snippet": "size_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nsize_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"failed to get features from '%s'\")",
            "vu->binary"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetArray",
          "args": [
            "doc",
            "\"features\""
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nstatic int\nqemuVhostUserGPUFillCapabilities(qemuVhostUserPtr vu,\n                                 virJSONValuePtr doc)\n{\n    qemuVhostUserGPUPtr gpu = &vu->capabilities.gpu;\n    virJSONValuePtr featuresJSON;\n    size_t nfeatures;\n    size_t i;\n    g_autoptr(qemuVhostUserGPUFeature) features = NULL;\n\n    if (!(featuresJSON = virJSONValueObjectGetArray(doc, \"features\"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to get features from '%s'\"),\n                       vu->binary);\n        return -1;\n    }\n\n    nfeatures = virJSONValueArraySize(featuresJSON);\n    if (VIR_ALLOC_N(features, nfeatures) < 0)\n        return -1;\n\n    for (i = 0; i < nfeatures; i++) {\n        virJSONValuePtr item = virJSONValueArrayGet(featuresJSON, i);\n        const char *tmpStr = virJSONValueGetString(item);\n        int tmp;\n\n        if ((tmp = qemuVhostUserGPUFeatureTypeFromString(tmpStr)) <= 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unknown feature %s\"),\n                           tmpStr);\n            continue;\n        }\n\n        features[i] = tmp;\n    }\n\n    gpu->features = g_steal_pointer(&features);\n    gpu->nfeatures = nfeatures;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuVhostUserFetchParsedConfigs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
    "lines": "241-274",
    "snippet": "static ssize_t\nqemuVhostUserFetchParsedConfigs(bool privileged,\n                                qemuVhostUserPtr **vhostuserRet,\n                                char ***pathsRet)\n{\n    VIR_AUTOSTRINGLIST paths = NULL;\n    size_t npaths;\n    qemuVhostUserPtr *vus = NULL;\n    size_t i;\n\n    if (qemuVhostUserFetchConfigs(&paths, privileged) < 0)\n        return -1;\n\n    npaths = virStringListLength((const char **)paths);\n\n    if (VIR_ALLOC_N(vus, npaths) < 0)\n        return -1;\n\n    for (i = 0; i < npaths; i++) {\n        if (!(vus[i] = qemuVhostUserParse(paths[i])))\n            goto error;\n    }\n\n    *vhostuserRet = g_steal_pointer(&vus);\n    if (pathsRet)\n        *pathsRet = g_steal_pointer(&paths);\n    return npaths;\n\n error:\n    while (i > 0)\n        qemuVhostUserFree(vus[--i]);\n    VIR_FREE(vus);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virenum.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virjson.h\"",
      "#include \"qemu_interop_config.h\"",
      "#include \"qemu_vhost_user.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vus"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuVhostUserFree",
          "args": [
            "vus[--i]"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "qemuVhostUserFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
          "lines": "123-135",
          "snippet": "void\nqemuVhostUserFree(qemuVhostUserPtr vu)\n{\n    if (!vu)\n        return;\n\n    if (vu->type == QEMU_VHOST_USER_TYPE_GPU)\n        VIR_FREE(vu->capabilities.gpu.features);\n\n    VIR_FREE(vu->binary);\n\n    VIR_FREE(vu);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virjson.h\"",
            "#include \"qemu_interop_config.h\"",
            "#include \"qemu_vhost_user.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nvoid\nqemuVhostUserFree(qemuVhostUserPtr vu)\n{\n    if (!vu)\n        return;\n\n    if (vu->type == QEMU_VHOST_USER_TYPE_GPU)\n        VIR_FREE(vu->capabilities.gpu.features);\n\n    VIR_FREE(vu->binary);\n\n    VIR_FREE(vu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&paths"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&vus"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuVhostUserParse",
          "args": [
            "paths[i]"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "qemuVhostUserParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
          "lines": "182-209",
          "snippet": "qemuVhostUserPtr\nqemuVhostUserParse(const char *path)\n{\n    g_autofree char *cont = NULL;\n    g_autoptr(virJSONValue) doc = NULL;\n    g_autoptr(qemuVhostUser) vu = NULL;\n\n    if (virFileReadAll(path, DOCUMENT_SIZE, &cont) < 0)\n        return NULL;\n\n    if (!(doc = virJSONValueFromString(cont))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unable to parse json file '%s'\"),\n                       path);\n        return NULL;\n    }\n\n    if (VIR_ALLOC(vu) < 0)\n        return NULL;\n\n    if (qemuVhostUserTypeParse(path, doc, vu) < 0)\n        return NULL;\n\n    if (qemuVhostUserBinaryParse(path, doc, vu) < 0)\n        return NULL;\n\n    return g_steal_pointer(&vu);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virjson.h\"",
            "#include \"qemu_interop_config.h\"",
            "#include \"qemu_vhost_user.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define DOCUMENT_SIZE (1024 * 1024)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\n#define DOCUMENT_SIZE (1024 * 1024)\n\nqemuVhostUserPtr\nqemuVhostUserParse(const char *path)\n{\n    g_autofree char *cont = NULL;\n    g_autoptr(virJSONValue) doc = NULL;\n    g_autoptr(qemuVhostUser) vu = NULL;\n\n    if (virFileReadAll(path, DOCUMENT_SIZE, &cont) < 0)\n        return NULL;\n\n    if (!(doc = virJSONValueFromString(cont))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unable to parse json file '%s'\"),\n                       path);\n        return NULL;\n    }\n\n    if (VIR_ALLOC(vu) < 0)\n        return NULL;\n\n    if (qemuVhostUserTypeParse(path, doc, vu) < 0)\n        return NULL;\n\n    if (qemuVhostUserBinaryParse(path, doc, vu) < 0)\n        return NULL;\n\n    return g_steal_pointer(&vu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "vus",
            "npaths"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringListLength",
          "args": [
            "(const char **)paths"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "893-901",
          "snippet": "size_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nsize_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuVhostUserFetchConfigs",
          "args": [
            "&paths",
            "privileged"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "qemuVhostUserFetchConfigs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
          "lines": "233-238",
          "snippet": "int\nqemuVhostUserFetchConfigs(char ***configs,\n                          bool privileged)\n{\n    return qemuInteropFetchConfigs(\"vhost-user\", configs, privileged);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virjson.h\"",
            "#include \"qemu_interop_config.h\"",
            "#include \"qemu_vhost_user.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nint\nqemuVhostUserFetchConfigs(char ***configs,\n                          bool privileged)\n{\n    return qemuInteropFetchConfigs(\"vhost-user\", configs, privileged);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nstatic ssize_t\nqemuVhostUserFetchParsedConfigs(bool privileged,\n                                qemuVhostUserPtr **vhostuserRet,\n                                char ***pathsRet)\n{\n    VIR_AUTOSTRINGLIST paths = NULL;\n    size_t npaths;\n    qemuVhostUserPtr *vus = NULL;\n    size_t i;\n\n    if (qemuVhostUserFetchConfigs(&paths, privileged) < 0)\n        return -1;\n\n    npaths = virStringListLength((const char **)paths);\n\n    if (VIR_ALLOC_N(vus, npaths) < 0)\n        return -1;\n\n    for (i = 0; i < npaths; i++) {\n        if (!(vus[i] = qemuVhostUserParse(paths[i])))\n            goto error;\n    }\n\n    *vhostuserRet = g_steal_pointer(&vus);\n    if (pathsRet)\n        *pathsRet = g_steal_pointer(&paths);\n    return npaths;\n\n error:\n    while (i > 0)\n        qemuVhostUserFree(vus[--i]);\n    VIR_FREE(vus);\n    return -1;\n}"
  },
  {
    "function_name": "qemuVhostUserFetchConfigs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
    "lines": "233-238",
    "snippet": "int\nqemuVhostUserFetchConfigs(char ***configs,\n                          bool privileged)\n{\n    return qemuInteropFetchConfigs(\"vhost-user\", configs, privileged);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virenum.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virjson.h\"",
      "#include \"qemu_interop_config.h\"",
      "#include \"qemu_vhost_user.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuInteropFetchConfigs",
          "args": [
            "\"vhost-user\"",
            "configs",
            "privileged"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "qemuInteropFetchConfigs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_interop_config.c",
          "lines": "96-176",
          "snippet": "int\nqemuInteropFetchConfigs(const char *name,\n                        char ***configs,\n                        bool privileged)\n{\n    g_autoptr(virHashTable) files = NULL;\n    g_autofree char *homeConfig = NULL;\n    g_autofree char *xdgConfig = NULL;\n    g_autofree char *sysLocation = virFileBuildPath(QEMU_SYSTEM_LOCATION, name, NULL);\n    g_autofree char *etcLocation = virFileBuildPath(QEMU_ETC_LOCATION, name, NULL);\n    g_autofree virHashKeyValuePairPtr pairs = NULL;\n    virHashKeyValuePairPtr tmp = NULL;\n\n    *configs = NULL;\n\n    if (!privileged) {\n        /* This is a slight divergence from the specification.\n         * Since the system daemon runs as root, it doesn't make\n         * much sense to parse files in root's home directory. It\n         * makes sense only for session daemon which runs under\n         * regular user. */\n        xdgConfig = g_strdup(getenv(\"XDG_CONFIG_HOME\"));\n\n        if (!xdgConfig) {\n            g_autofree char *home = virGetUserDirectory();\n\n            xdgConfig = g_strdup_printf(\"%s/.config\", home);\n        }\n\n        homeConfig = g_strdup_printf(\"%s/qemu/%s\", xdgConfig, name);\n    }\n\n    if (!(files = virHashCreate(10, virHashValueFree)))\n        return -1;\n\n    if (qemuBuildFileList(files, sysLocation) < 0)\n        return -1;\n\n    if (qemuBuildFileList(files, etcLocation) < 0)\n        return -1;\n\n    if (homeConfig &&\n        qemuBuildFileList(files, homeConfig) < 0)\n        return -1;\n\n    /* At this point, the @files hash table contains unique set of filenames\n     * where each filename (as key) has the highest priority full pathname\n     * associated with it. */\n\n    if (virHashSize(files) == 0)\n        return 0;\n\n    if (!(pairs = virHashGetItems(files, qemuConfigFilesSorter)))\n        return -1;\n\n    for (tmp = pairs; tmp->key; tmp++) {\n        const char *path = tmp->value;\n        off_t len;\n\n        if ((len = virFileLength(path, -1)) < 0) {\n            virReportSystemError(errno,\n                                 _(\"unable to get size of '%s'\"),\n                                 path);\n            return -1;\n        }\n\n        VIR_DEBUG(\"%s description path '%s' len=%jd\",\n                  name, path, (intmax_t) len);\n\n        if (len == 0) {\n            /* Empty files are used to mask less specific instances\n             * of the same file. */\n            continue;\n        }\n\n        if (virStringListAdd(configs, path) < 0)\n            return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virenum.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"qemu_interop_config.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define QEMU_ETC_LOCATION SYSCONFDIR \"/qemu\"",
            "#define QEMU_SYSTEM_LOCATION PREFIX \"/share/qemu\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"qemu_interop_config.h\"\n#include <config.h>\n\n#define QEMU_ETC_LOCATION SYSCONFDIR \"/qemu\"\n#define QEMU_SYSTEM_LOCATION PREFIX \"/share/qemu\"\n\nint\nqemuInteropFetchConfigs(const char *name,\n                        char ***configs,\n                        bool privileged)\n{\n    g_autoptr(virHashTable) files = NULL;\n    g_autofree char *homeConfig = NULL;\n    g_autofree char *xdgConfig = NULL;\n    g_autofree char *sysLocation = virFileBuildPath(QEMU_SYSTEM_LOCATION, name, NULL);\n    g_autofree char *etcLocation = virFileBuildPath(QEMU_ETC_LOCATION, name, NULL);\n    g_autofree virHashKeyValuePairPtr pairs = NULL;\n    virHashKeyValuePairPtr tmp = NULL;\n\n    *configs = NULL;\n\n    if (!privileged) {\n        /* This is a slight divergence from the specification.\n         * Since the system daemon runs as root, it doesn't make\n         * much sense to parse files in root's home directory. It\n         * makes sense only for session daemon which runs under\n         * regular user. */\n        xdgConfig = g_strdup(getenv(\"XDG_CONFIG_HOME\"));\n\n        if (!xdgConfig) {\n            g_autofree char *home = virGetUserDirectory();\n\n            xdgConfig = g_strdup_printf(\"%s/.config\", home);\n        }\n\n        homeConfig = g_strdup_printf(\"%s/qemu/%s\", xdgConfig, name);\n    }\n\n    if (!(files = virHashCreate(10, virHashValueFree)))\n        return -1;\n\n    if (qemuBuildFileList(files, sysLocation) < 0)\n        return -1;\n\n    if (qemuBuildFileList(files, etcLocation) < 0)\n        return -1;\n\n    if (homeConfig &&\n        qemuBuildFileList(files, homeConfig) < 0)\n        return -1;\n\n    /* At this point, the @files hash table contains unique set of filenames\n     * where each filename (as key) has the highest priority full pathname\n     * associated with it. */\n\n    if (virHashSize(files) == 0)\n        return 0;\n\n    if (!(pairs = virHashGetItems(files, qemuConfigFilesSorter)))\n        return -1;\n\n    for (tmp = pairs; tmp->key; tmp++) {\n        const char *path = tmp->value;\n        off_t len;\n\n        if ((len = virFileLength(path, -1)) < 0) {\n            virReportSystemError(errno,\n                                 _(\"unable to get size of '%s'\"),\n                                 path);\n            return -1;\n        }\n\n        VIR_DEBUG(\"%s description path '%s' len=%jd\",\n                  name, path, (intmax_t) len);\n\n        if (len == 0) {\n            /* Empty files are used to mask less specific instances\n             * of the same file. */\n            continue;\n        }\n\n        if (virStringListAdd(configs, path) < 0)\n            return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nint\nqemuVhostUserFetchConfigs(char ***configs,\n                          bool privileged)\n{\n    return qemuInteropFetchConfigs(\"vhost-user\", configs, privileged);\n}"
  },
  {
    "function_name": "qemuVhostUserFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
    "lines": "212-230",
    "snippet": "char *\nqemuVhostUserFormat(qemuVhostUserPtr vu)\n{\n    g_autoptr(virJSONValue) doc = NULL;\n\n    if (!vu)\n        return NULL;\n\n    doc = virJSONValueNewObject();\n\n    if (virJSONValueObjectAppendString(doc, \"type\",\n                                       qemuVhostUserTypeTypeToString(vu->type)) < 0)\n        return NULL;\n\n    if (virJSONValueObjectAppendString(doc, \"binary\", vu->binary) < 0)\n        return NULL;\n\n    return virJSONValueToString(doc, true);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virenum.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virjson.h\"",
      "#include \"qemu_interop_config.h\"",
      "#include \"qemu_vhost_user.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueToString",
          "args": [
            "doc",
            "true"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "2014-2024",
          "snippet": "char *\nvirJSONValueToString(virJSONValuePtr object,\n                     bool pretty)\n{\n    g_auto(virBuffer) buf = VIR_BUFFER_INITIALIZER;\n\n    if (virJSONValueToBuffer(object, &buf, pretty) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nchar *\nvirJSONValueToString(virJSONValuePtr object,\n                     bool pretty)\n{\n    g_auto(virBuffer) buf = VIR_BUFFER_INITIALIZER;\n\n    if (virJSONValueToBuffer(object, &buf, pretty) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendString",
          "args": [
            "doc",
            "\"binary\"",
            "vu->binary"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "643-649",
          "snippet": "int\nvirJSONValueObjectAppendString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, false);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuVhostUserTypeTypeToString",
          "args": [
            "vu->type"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueNewObject",
          "args": [],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "571-579",
          "snippet": "virJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nchar *\nqemuVhostUserFormat(qemuVhostUserPtr vu)\n{\n    g_autoptr(virJSONValue) doc = NULL;\n\n    if (!vu)\n        return NULL;\n\n    doc = virJSONValueNewObject();\n\n    if (virJSONValueObjectAppendString(doc, \"type\",\n                                       qemuVhostUserTypeTypeToString(vu->type)) < 0)\n        return NULL;\n\n    if (virJSONValueObjectAppendString(doc, \"binary\", vu->binary) < 0)\n        return NULL;\n\n    return virJSONValueToString(doc, true);\n}"
  },
  {
    "function_name": "qemuVhostUserParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
    "lines": "182-209",
    "snippet": "qemuVhostUserPtr\nqemuVhostUserParse(const char *path)\n{\n    g_autofree char *cont = NULL;\n    g_autoptr(virJSONValue) doc = NULL;\n    g_autoptr(qemuVhostUser) vu = NULL;\n\n    if (virFileReadAll(path, DOCUMENT_SIZE, &cont) < 0)\n        return NULL;\n\n    if (!(doc = virJSONValueFromString(cont))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unable to parse json file '%s'\"),\n                       path);\n        return NULL;\n    }\n\n    if (VIR_ALLOC(vu) < 0)\n        return NULL;\n\n    if (qemuVhostUserTypeParse(path, doc, vu) < 0)\n        return NULL;\n\n    if (qemuVhostUserBinaryParse(path, doc, vu) < 0)\n        return NULL;\n\n    return g_steal_pointer(&vu);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virenum.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virjson.h\"",
      "#include \"qemu_interop_config.h\"",
      "#include \"qemu_vhost_user.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define DOCUMENT_SIZE (1024 * 1024)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&vu"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuVhostUserBinaryParse",
          "args": [
            "path",
            "doc",
            "vu"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "qemuVhostUserBinaryParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
          "lines": "166-179",
          "snippet": "static int\nqemuVhostUserBinaryParse(const char *path,\n                         virJSONValuePtr doc,\n                         qemuVhostUserPtr vu)\n{\n    const char *binary = virJSONValueObjectGetString(doc, \"binary\");\n\n    VIR_DEBUG(\"vhost-user description path '%s' binary : %s\",\n              path, binary);\n\n    vu->binary = g_strdup(binary);\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virjson.h\"",
            "#include \"qemu_interop_config.h\"",
            "#include \"qemu_vhost_user.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nstatic int\nqemuVhostUserBinaryParse(const char *path,\n                         virJSONValuePtr doc,\n                         qemuVhostUserPtr vu)\n{\n    const char *binary = virJSONValueObjectGetString(doc, \"binary\");\n\n    VIR_DEBUG(\"vhost-user description path '%s' binary : %s\",\n              path, binary);\n\n    vu->binary = g_strdup(binary);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuVhostUserTypeParse",
          "args": [
            "path",
            "doc",
            "vu"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "qemuVhostUserTypeParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
          "lines": "142-163",
          "snippet": "static int\nqemuVhostUserTypeParse(const char *path,\n                       virJSONValuePtr doc,\n                       qemuVhostUserPtr vu)\n{\n    const char *type = virJSONValueObjectGetString(doc, \"type\");\n    int tmp;\n\n    VIR_DEBUG(\"vhost-user description path '%s' type : %s\",\n              path, type);\n\n    if ((tmp = qemuVhostUserTypeTypeFromString(type)) <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unknown vhost-user type: '%s'\"),\n                       type);\n        return -1;\n    }\n\n    vu->type = tmp;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virjson.h\"",
            "#include \"qemu_interop_config.h\"",
            "#include \"qemu_vhost_user.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nstatic int\nqemuVhostUserTypeParse(const char *path,\n                       virJSONValuePtr doc,\n                       qemuVhostUserPtr vu)\n{\n    const char *type = virJSONValueObjectGetString(doc, \"type\");\n    int tmp;\n\n    VIR_DEBUG(\"vhost-user description path '%s' type : %s\",\n              path, type);\n\n    if ((tmp = qemuVhostUserTypeTypeFromString(type)) <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unknown vhost-user type: '%s'\"),\n                       type);\n        return -1;\n    }\n\n    vu->type = tmp;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "vu"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unable to parse json file '%s'\")",
            "path"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unable to parse json file '%s'\""
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueFromString",
          "args": [
            "cont"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFromString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1993-1999",
          "snippet": "virJSONValuePtr\nvirJSONValueFromString(const char *jsonstring G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"No JSON parser implementation is available\"));\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueFromString(const char *jsonstring G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"No JSON parser implementation is available\"));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "path",
            "DOCUMENT_SIZE",
            "&cont"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\n#define DOCUMENT_SIZE (1024 * 1024)\n\nqemuVhostUserPtr\nqemuVhostUserParse(const char *path)\n{\n    g_autofree char *cont = NULL;\n    g_autoptr(virJSONValue) doc = NULL;\n    g_autoptr(qemuVhostUser) vu = NULL;\n\n    if (virFileReadAll(path, DOCUMENT_SIZE, &cont) < 0)\n        return NULL;\n\n    if (!(doc = virJSONValueFromString(cont))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unable to parse json file '%s'\"),\n                       path);\n        return NULL;\n    }\n\n    if (VIR_ALLOC(vu) < 0)\n        return NULL;\n\n    if (qemuVhostUserTypeParse(path, doc, vu) < 0)\n        return NULL;\n\n    if (qemuVhostUserBinaryParse(path, doc, vu) < 0)\n        return NULL;\n\n    return g_steal_pointer(&vu);\n}"
  },
  {
    "function_name": "qemuVhostUserBinaryParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
    "lines": "166-179",
    "snippet": "static int\nqemuVhostUserBinaryParse(const char *path,\n                         virJSONValuePtr doc,\n                         qemuVhostUserPtr vu)\n{\n    const char *binary = virJSONValueObjectGetString(doc, \"binary\");\n\n    VIR_DEBUG(\"vhost-user description path '%s' binary : %s\",\n              path, binary);\n\n    vu->binary = g_strdup(binary);\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virenum.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virjson.h\"",
      "#include \"qemu_interop_config.h\"",
      "#include \"qemu_vhost_user.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "binary"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vhost-user description path '%s' binary : %s\"",
            "path",
            "binary"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetString",
          "args": [
            "doc",
            "\"binary\""
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetStringOrNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1313-1328",
          "snippet": "const char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nstatic int\nqemuVhostUserBinaryParse(const char *path,\n                         virJSONValuePtr doc,\n                         qemuVhostUserPtr vu)\n{\n    const char *binary = virJSONValueObjectGetString(doc, \"binary\");\n\n    VIR_DEBUG(\"vhost-user description path '%s' binary : %s\",\n              path, binary);\n\n    vu->binary = g_strdup(binary);\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuVhostUserTypeParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
    "lines": "142-163",
    "snippet": "static int\nqemuVhostUserTypeParse(const char *path,\n                       virJSONValuePtr doc,\n                       qemuVhostUserPtr vu)\n{\n    const char *type = virJSONValueObjectGetString(doc, \"type\");\n    int tmp;\n\n    VIR_DEBUG(\"vhost-user description path '%s' type : %s\",\n              path, type);\n\n    if ((tmp = qemuVhostUserTypeTypeFromString(type)) <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unknown vhost-user type: '%s'\"),\n                       type);\n        return -1;\n    }\n\n    vu->type = tmp;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virenum.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virjson.h\"",
      "#include \"qemu_interop_config.h\"",
      "#include \"qemu_vhost_user.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unknown vhost-user type: '%s'\")",
            "type"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown vhost-user type: '%s'\""
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuVhostUserTypeTypeFromString",
          "args": [
            "type"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vhost-user description path '%s' type : %s\"",
            "path",
            "type"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetString",
          "args": [
            "doc",
            "\"type\""
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetStringOrNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1313-1328",
          "snippet": "const char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nstatic int\nqemuVhostUserTypeParse(const char *path,\n                       virJSONValuePtr doc,\n                       qemuVhostUserPtr vu)\n{\n    const char *type = virJSONValueObjectGetString(doc, \"type\");\n    int tmp;\n\n    VIR_DEBUG(\"vhost-user description path '%s' type : %s\",\n              path, type);\n\n    if ((tmp = qemuVhostUserTypeTypeFromString(type)) <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unknown vhost-user type: '%s'\"),\n                       type);\n        return -1;\n    }\n\n    vu->type = tmp;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuVhostUserFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
    "lines": "123-135",
    "snippet": "void\nqemuVhostUserFree(qemuVhostUserPtr vu)\n{\n    if (!vu)\n        return;\n\n    if (vu->type == QEMU_VHOST_USER_TYPE_GPU)\n        VIR_FREE(vu->capabilities.gpu.features);\n\n    VIR_FREE(vu->binary);\n\n    VIR_FREE(vu);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virenum.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virjson.h\"",
      "#include \"qemu_interop_config.h\"",
      "#include \"qemu_vhost_user.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vu"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vu->binary"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vu->capabilities.gpu.features"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nvoid\nqemuVhostUserFree(qemuVhostUserPtr vu)\n{\n    if (!vu)\n        return;\n\n    if (vu->type == QEMU_VHOST_USER_TYPE_GPU)\n        VIR_FREE(vu->capabilities.gpu.features);\n\n    VIR_FREE(vu->binary);\n\n    VIR_FREE(vu);\n}"
  },
  {
    "function_name": "qemuVhostUserGPUFeatureFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_vhost_user.c",
    "lines": "113-117",
    "snippet": "static void\nqemuVhostUserGPUFeatureFree(qemuVhostUserGPUFeature *features)\n{\n    VIR_FREE(features);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virenum.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virjson.h\"",
      "#include \"qemu_interop_config.h\"",
      "#include \"qemu_vhost_user.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "features"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_vhost_user.h\"\n#include <config.h>\n\nstatic void\nqemuVhostUserGPUFeatureFree(qemuVhostUserGPUFeature *features)\n{\n    VIR_FREE(features);\n}"
  }
]