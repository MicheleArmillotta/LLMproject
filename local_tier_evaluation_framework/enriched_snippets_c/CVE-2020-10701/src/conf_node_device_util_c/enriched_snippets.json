[
  {
    "function_name": "virNodeDeviceDeleteVport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/node_device_util.c",
    "lines": "160-229",
    "snippet": "int\nvirNodeDeviceDeleteVport(virConnectPtr conn,\n                         virStorageAdapterFCHostPtr fchost)\n{\n    char *name = NULL;\n    char *scsi_host_name = NULL;\n    unsigned int parent_host;\n    char *vhba_parent = NULL;\n    int ret = -1;\n\n    VIR_DEBUG(\"conn=%p parent='%s', managed='%d' wwnn='%s' wwpn='%s'\",\n              conn, NULLSTR(fchost->parent), fchost->managed,\n              fchost->wwnn, fchost->wwpn);\n\n    /* If we're not managing the deletion of the vHBA, then just return */\n    if (fchost->managed != VIR_TRISTATE_BOOL_YES)\n        return 0;\n\n    /* Find our vHBA by searching the fc_host sysfs tree for our wwnn/wwpn */\n    if (!(name = virVHBAGetHostByWWN(NULL, fchost->wwnn, fchost->wwpn))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to find fc_host for wwnn='%s' and wwpn='%s'\"),\n                       fchost->wwnn, fchost->wwpn);\n        goto cleanup;\n    }\n\n    scsi_host_name = g_strdup_printf(\"scsi_%s\", name);\n\n    /* If at startup time we provided a parent, then use that to\n     * get the parent_host value; otherwise, we have to determine\n     * the parent scsi_host which we did not save at startup time\n     */\n    if (fchost->parent) {\n        /* Someone provided a parent string at startup time that\n         * was the same as the scsi_host - meaning we have a pool\n         * backed to an HBA, so there won't be a vHBA to delete */\n        if (STREQ(scsi_host_name, fchost->parent)) {\n            ret = 0;\n            goto cleanup;\n        }\n\n        if (virSCSIHostGetNumber(fchost->parent, &parent_host) < 0)\n            goto cleanup;\n    } else {\n        if (!(vhba_parent = virNodeDeviceGetParentName(conn, scsi_host_name)))\n            goto cleanup;\n\n        /* If the parent is not a scsi_host, then this is a pool backed\n         * directly to an HBA and there's no vHBA to remove - so we're done */\n        if (!STRPREFIX(vhba_parent, \"scsi_host\")) {\n            ret = 0;\n            goto cleanup;\n        }\n\n        if (virSCSIHostGetNumber(vhba_parent, &parent_host) < 0)\n            goto cleanup;\n    }\n\n    if (virVHBAManageVport(parent_host, fchost->wwpn, fchost->wwnn,\n                           VPORT_DELETE) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(name);\n    VIR_FREE(vhba_parent);\n    VIR_FREE(scsi_host_name);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"node_device_util.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "scsi_host_name"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vhba_parent"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "name"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virVHBAManageVport",
          "args": [
            "parent_host",
            "fchost->wwpn",
            "fchost->wwnn",
            "VPORT_DELETE"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "virVHBAManageVport",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virvhba.c",
          "lines": "489-497",
          "snippet": "int\nvirVHBAManageVport(const int parent_host G_GNUC_UNUSED,\n                   const char *wwpn G_GNUC_UNUSED,\n                   const char *wwnn G_GNUC_UNUSED,\n                   int operation G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint\nvirVHBAManageVport(const int parent_host G_GNUC_UNUSED,\n                   const char *wwpn G_GNUC_UNUSED,\n                   const char *wwnn G_GNUC_UNUSED,\n                   int operation G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSCSIHostGetNumber",
          "args": [
            "vhba_parent",
            "&parent_host"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "virSCSIHostGetNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsihost.c",
          "lines": "272-278",
          "snippet": "int\nvirSCSIHostGetNumber(const char *adapter_name G_GNUC_UNUSED,\n                     unsigned int *result G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirSCSIHostGetNumber(const char *adapter_name G_GNUC_UNUSED,\n                     unsigned int *result G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "vhba_parent",
            "\"scsi_host\""
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNodeDeviceGetParentName",
          "args": [
            "conn",
            "scsi_host_name"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceGetParentName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/node_device_util.c",
          "lines": "44-62",
          "snippet": "char *\nvirNodeDeviceGetParentName(virConnectPtr conn,\n                           const char *nodedev_name)\n{\n    virNodeDevicePtr device = NULL;\n    char *parent;\n\n    if (!(device = virNodeDeviceLookupByName(conn, nodedev_name))) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Cannot find '%s' in node device database\"),\n                       nodedev_name);\n        return NULL;\n    }\n\n    parent = g_strdup(virNodeDeviceGetParent(device));\n    virObjectUnref(device);\n\n    return parent;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"node_device_util.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"node_device_util.h\"\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirNodeDeviceGetParentName(virConnectPtr conn,\n                           const char *nodedev_name)\n{\n    virNodeDevicePtr device = NULL;\n    char *parent;\n\n    if (!(device = virNodeDeviceLookupByName(conn, nodedev_name))) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Cannot find '%s' in node device database\"),\n                       nodedev_name);\n        return NULL;\n    }\n\n    parent = g_strdup(virNodeDeviceGetParent(device));\n    virObjectUnref(device);\n\n    return parent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "scsi_host_name",
            "fchost->parent"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"scsi_%s\"",
            "name"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to find fc_host for wwnn='%s' and wwpn='%s'\")",
            "fchost->wwnn",
            "fchost->wwpn"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to find fc_host for wwnn='%s' and wwpn='%s'\""
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virVHBAGetHostByWWN",
          "args": [
            "NULL",
            "fchost->wwnn",
            "fchost->wwpn"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "virVHBAGetHostByWWN",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virvhba.c",
          "lines": "500-507",
          "snippet": "char *\nvirVHBAGetHostByWWN(const char *sysfs_prefix G_GNUC_UNUSED,\n                    const char *wwnn G_GNUC_UNUSED,\n                    const char *wwpn G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nchar *\nvirVHBAGetHostByWWN(const char *sysfs_prefix G_GNUC_UNUSED,\n                    const char *wwnn G_GNUC_UNUSED,\n                    const char *wwpn G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p parent='%s', managed='%d' wwnn='%s' wwpn='%s'\"",
            "conn",
            "NULLSTR(fchost->parent)",
            "fchost->managed",
            "fchost->wwnn",
            "fchost->wwpn"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "fchost->parent"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"node_device_util.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNodeDeviceDeleteVport(virConnectPtr conn,\n                         virStorageAdapterFCHostPtr fchost)\n{\n    char *name = NULL;\n    char *scsi_host_name = NULL;\n    unsigned int parent_host;\n    char *vhba_parent = NULL;\n    int ret = -1;\n\n    VIR_DEBUG(\"conn=%p parent='%s', managed='%d' wwnn='%s' wwpn='%s'\",\n              conn, NULLSTR(fchost->parent), fchost->managed,\n              fchost->wwnn, fchost->wwpn);\n\n    /* If we're not managing the deletion of the vHBA, then just return */\n    if (fchost->managed != VIR_TRISTATE_BOOL_YES)\n        return 0;\n\n    /* Find our vHBA by searching the fc_host sysfs tree for our wwnn/wwpn */\n    if (!(name = virVHBAGetHostByWWN(NULL, fchost->wwnn, fchost->wwpn))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to find fc_host for wwnn='%s' and wwpn='%s'\"),\n                       fchost->wwnn, fchost->wwpn);\n        goto cleanup;\n    }\n\n    scsi_host_name = g_strdup_printf(\"scsi_%s\", name);\n\n    /* If at startup time we provided a parent, then use that to\n     * get the parent_host value; otherwise, we have to determine\n     * the parent scsi_host which we did not save at startup time\n     */\n    if (fchost->parent) {\n        /* Someone provided a parent string at startup time that\n         * was the same as the scsi_host - meaning we have a pool\n         * backed to an HBA, so there won't be a vHBA to delete */\n        if (STREQ(scsi_host_name, fchost->parent)) {\n            ret = 0;\n            goto cleanup;\n        }\n\n        if (virSCSIHostGetNumber(fchost->parent, &parent_host) < 0)\n            goto cleanup;\n    } else {\n        if (!(vhba_parent = virNodeDeviceGetParentName(conn, scsi_host_name)))\n            goto cleanup;\n\n        /* If the parent is not a scsi_host, then this is a pool backed\n         * directly to an HBA and there's no vHBA to remove - so we're done */\n        if (!STRPREFIX(vhba_parent, \"scsi_host\")) {\n            ret = 0;\n            goto cleanup;\n        }\n\n        if (virSCSIHostGetNumber(vhba_parent, &parent_host) < 0)\n            goto cleanup;\n    }\n\n    if (virVHBAManageVport(parent_host, fchost->wwpn, fchost->wwnn,\n                           VPORT_DELETE) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(name);\n    VIR_FREE(vhba_parent);\n    VIR_FREE(scsi_host_name);\n    return ret;\n}"
  },
  {
    "function_name": "virNodeDeviceCreateVport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/node_device_util.c",
    "lines": "77-147",
    "snippet": "char *\nvirNodeDeviceCreateVport(virStorageAdapterFCHostPtr fchost)\n{\n    unsigned int parent_host;\n    char *name = NULL;\n    char *parent_hoststr = NULL;\n    bool skip_capable_check = false;\n\n    VIR_DEBUG(\"parent='%s', wwnn='%s' wwpn='%s'\",\n              NULLSTR(fchost->parent), fchost->wwnn, fchost->wwpn);\n\n    if (fchost->parent) {\n        parent_hoststr = g_strdup(fchost->parent);\n    } else if (fchost->parent_wwnn && fchost->parent_wwpn) {\n        if (!(parent_hoststr = virVHBAGetHostByWWN(NULL, fchost->parent_wwnn,\n                                                   fchost->parent_wwpn))) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"cannot find parent using provided wwnn/wwpn\"));\n            goto cleanup;\n        }\n    } else if (fchost->parent_fabric_wwn) {\n        if (!(parent_hoststr =\n              virVHBAGetHostByFabricWWN(NULL, fchost->parent_fabric_wwn))) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"cannot find parent using provided fabric_wwn\"));\n            goto cleanup;\n        }\n    } else {\n        if (!(parent_hoststr = virVHBAFindVportHost(NULL))) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"'parent' for vHBA not specified, and \"\n                             \"cannot find one on this host\"));\n            goto cleanup;\n        }\n        skip_capable_check = true;\n    }\n\n    if (virSCSIHostGetNumber(parent_hoststr, &parent_host) < 0)\n        goto cleanup;\n\n    /* NOTE:\n     * We do not save the parent_hoststr in fchost->parent since\n     * we could be writing out the 'def' to the saved XML config.\n     * If we wrote out the name in the XML, then future starts would\n     * always use the same parent rather than finding the \"best available\"\n     * parent. Besides we have a way to determine the parent based on\n     * the 'name' field.\n     */\n    if (!skip_capable_check && !virVHBAPathExists(NULL, parent_host)) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"parent '%s' specified for vHBA does not exist\"),\n                       parent_hoststr);\n        goto cleanup;\n    }\n\n    if (virVHBAManageVport(parent_host, fchost->wwpn, fchost->wwnn,\n                           VPORT_CREATE) < 0)\n        goto cleanup;\n\n    /* Let's ensure the device was created */\n    virWaitForDevices();\n    if (!(name = virVHBAGetHostByWWN(NULL, fchost->wwnn, fchost->wwpn))) {\n        ignore_value(virVHBAManageVport(parent_host, fchost->wwpn, fchost->wwnn,\n                                        VPORT_DELETE));\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(parent_hoststr);\n    return name;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"node_device_util.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "parent_hoststr"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virVHBAManageVport(parent_host, fchost->wwpn, fchost->wwnn,\n                                        VPORT_DELETE)"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virVHBAManageVport",
          "args": [
            "parent_host",
            "fchost->wwpn",
            "fchost->wwnn",
            "VPORT_DELETE"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "virVHBAManageVport",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virvhba.c",
          "lines": "489-497",
          "snippet": "int\nvirVHBAManageVport(const int parent_host G_GNUC_UNUSED,\n                   const char *wwpn G_GNUC_UNUSED,\n                   const char *wwnn G_GNUC_UNUSED,\n                   int operation G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint\nvirVHBAManageVport(const int parent_host G_GNUC_UNUSED,\n                   const char *wwpn G_GNUC_UNUSED,\n                   const char *wwnn G_GNUC_UNUSED,\n                   int operation G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virVHBAGetHostByWWN",
          "args": [
            "NULL",
            "fchost->wwnn",
            "fchost->wwpn"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "virVHBAGetHostByWWN",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virvhba.c",
          "lines": "500-507",
          "snippet": "char *\nvirVHBAGetHostByWWN(const char *sysfs_prefix G_GNUC_UNUSED,\n                    const char *wwnn G_GNUC_UNUSED,\n                    const char *wwpn G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nchar *\nvirVHBAGetHostByWWN(const char *sysfs_prefix G_GNUC_UNUSED,\n                    const char *wwnn G_GNUC_UNUSED,\n                    const char *wwpn G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virWaitForDevices",
          "args": [],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "virWaitForDevices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1324-1341",
          "snippet": "void virWaitForDevices(void)\n{\n    g_autoptr(virCommand) cmd = NULL;\n    g_autofree char *udev = NULL;\n    int exitstatus;\n\n    if (!(udev = virFindFileInPath(UDEVADM)))\n        return;\n\n    if (!(cmd = virCommandNewArgList(udev, \"settle\", NULL)))\n        return;\n\n    /*\n     * NOTE: we ignore errors here; this is just to make sure that any device\n     * nodes that are being created finish before we try to scan them.\n     */\n    ignore_value(virCommandRun(cmd, &exitstatus));\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid virWaitForDevices(void)\n{\n    g_autoptr(virCommand) cmd = NULL;\n    g_autofree char *udev = NULL;\n    int exitstatus;\n\n    if (!(udev = virFindFileInPath(UDEVADM)))\n        return;\n\n    if (!(cmd = virCommandNewArgList(udev, \"settle\", NULL)))\n        return;\n\n    /*\n     * NOTE: we ignore errors here; this is just to make sure that any device\n     * nodes that are being created finish before we try to scan them.\n     */\n    ignore_value(virCommandRun(cmd, &exitstatus));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"parent '%s' specified for vHBA does not exist\")",
            "parent_hoststr"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"parent '%s' specified for vHBA does not exist\""
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virVHBAPathExists",
          "args": [
            "NULL",
            "parent_host"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "virVHBAPathExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virvhba.c",
          "lines": "453-459",
          "snippet": "bool\nvirVHBAPathExists(const char *sysfs_prefix G_GNUC_UNUSED,\n                  int host G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return false;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nbool\nvirVHBAPathExists(const char *sysfs_prefix G_GNUC_UNUSED,\n                  int host G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSCSIHostGetNumber",
          "args": [
            "parent_hoststr",
            "&parent_host"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "virSCSIHostGetNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsihost.c",
          "lines": "272-278",
          "snippet": "int\nvirSCSIHostGetNumber(const char *adapter_name G_GNUC_UNUSED,\n                     unsigned int *result G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirSCSIHostGetNumber(const char *adapter_name G_GNUC_UNUSED,\n                     unsigned int *result G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"'parent' for vHBA not specified, and \"\n                             \"cannot find one on this host\")"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virVHBAFindVportHost",
          "args": [
            "NULL"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "virVHBAFindVportHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virvhba.c",
          "lines": "481-486",
          "snippet": "char *\nvirVHBAFindVportHost(const char *sysfs_prefix G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nchar *\nvirVHBAFindVportHost(const char *sysfs_prefix G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"cannot find parent using provided fabric_wwn\")"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virVHBAGetHostByFabricWWN",
          "args": [
            "NULL",
            "fchost->parent_fabric_wwn"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "virVHBAGetHostByFabricWWN",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virvhba.c",
          "lines": "510-516",
          "snippet": "char *\nvirVHBAGetHostByFabricWWN(const char *sysfs_prefix G_GNUC_UNUSED,\n                          const char *fabric_wwn G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nchar *\nvirVHBAGetHostByFabricWWN(const char *sysfs_prefix G_GNUC_UNUSED,\n                          const char *fabric_wwn G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"cannot find parent using provided wwnn/wwpn\")"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "fchost->parent"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"parent='%s', wwnn='%s' wwpn='%s'\"",
            "NULLSTR(fchost->parent)",
            "fchost->wwnn",
            "fchost->wwpn"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "fchost->parent"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"node_device_util.h\"\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirNodeDeviceCreateVport(virStorageAdapterFCHostPtr fchost)\n{\n    unsigned int parent_host;\n    char *name = NULL;\n    char *parent_hoststr = NULL;\n    bool skip_capable_check = false;\n\n    VIR_DEBUG(\"parent='%s', wwnn='%s' wwpn='%s'\",\n              NULLSTR(fchost->parent), fchost->wwnn, fchost->wwpn);\n\n    if (fchost->parent) {\n        parent_hoststr = g_strdup(fchost->parent);\n    } else if (fchost->parent_wwnn && fchost->parent_wwpn) {\n        if (!(parent_hoststr = virVHBAGetHostByWWN(NULL, fchost->parent_wwnn,\n                                                   fchost->parent_wwpn))) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"cannot find parent using provided wwnn/wwpn\"));\n            goto cleanup;\n        }\n    } else if (fchost->parent_fabric_wwn) {\n        if (!(parent_hoststr =\n              virVHBAGetHostByFabricWWN(NULL, fchost->parent_fabric_wwn))) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"cannot find parent using provided fabric_wwn\"));\n            goto cleanup;\n        }\n    } else {\n        if (!(parent_hoststr = virVHBAFindVportHost(NULL))) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"'parent' for vHBA not specified, and \"\n                             \"cannot find one on this host\"));\n            goto cleanup;\n        }\n        skip_capable_check = true;\n    }\n\n    if (virSCSIHostGetNumber(parent_hoststr, &parent_host) < 0)\n        goto cleanup;\n\n    /* NOTE:\n     * We do not save the parent_hoststr in fchost->parent since\n     * we could be writing out the 'def' to the saved XML config.\n     * If we wrote out the name in the XML, then future starts would\n     * always use the same parent rather than finding the \"best available\"\n     * parent. Besides we have a way to determine the parent based on\n     * the 'name' field.\n     */\n    if (!skip_capable_check && !virVHBAPathExists(NULL, parent_host)) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"parent '%s' specified for vHBA does not exist\"),\n                       parent_hoststr);\n        goto cleanup;\n    }\n\n    if (virVHBAManageVport(parent_host, fchost->wwpn, fchost->wwnn,\n                           VPORT_CREATE) < 0)\n        goto cleanup;\n\n    /* Let's ensure the device was created */\n    virWaitForDevices();\n    if (!(name = virVHBAGetHostByWWN(NULL, fchost->wwnn, fchost->wwpn))) {\n        ignore_value(virVHBAManageVport(parent_host, fchost->wwpn, fchost->wwnn,\n                                        VPORT_DELETE));\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(parent_hoststr);\n    return name;\n}"
  },
  {
    "function_name": "virNodeDeviceGetParentName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/node_device_util.c",
    "lines": "44-62",
    "snippet": "char *\nvirNodeDeviceGetParentName(virConnectPtr conn,\n                           const char *nodedev_name)\n{\n    virNodeDevicePtr device = NULL;\n    char *parent;\n\n    if (!(device = virNodeDeviceLookupByName(conn, nodedev_name))) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Cannot find '%s' in node device database\"),\n                       nodedev_name);\n        return NULL;\n    }\n\n    parent = g_strdup(virNodeDeviceGetParent(device));\n    virObjectUnref(device);\n\n    return parent;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"node_device_util.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "device"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "virNodeDeviceGetParent(device)"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceGetParent",
          "args": [
            "device"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceGetParent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
          "lines": "340-359",
          "snippet": "const char *\nvirNodeDeviceGetParent(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p\", dev, dev ? dev->conn : NULL);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, NULL);\n\n    if (!dev->parentName) {\n        if (dev->conn->nodeDeviceDriver && dev->conn->nodeDeviceDriver->nodeDeviceGetParent) {\n            dev->parentName = dev->conn->nodeDeviceDriver->nodeDeviceGetParent(dev);\n        } else {\n            virReportUnsupportedError();\n            virDispatchError(dev->conn);\n            return NULL;\n        }\n    }\n    return dev->parentName;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nconst char *\nvirNodeDeviceGetParent(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p\", dev, dev ? dev->conn : NULL);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, NULL);\n\n    if (!dev->parentName) {\n        if (dev->conn->nodeDeviceDriver && dev->conn->nodeDeviceDriver->nodeDeviceGetParent) {\n            dev->parentName = dev->conn->nodeDeviceDriver->nodeDeviceGetParent(dev);\n        } else {\n            virReportUnsupportedError();\n            virDispatchError(dev->conn);\n            return NULL;\n        }\n    }\n    return dev->parentName;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"Cannot find '%s' in node device database\")",
            "nodedev_name"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot find '%s' in node device database\""
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceLookupByName",
          "args": [
            "conn",
            "nodedev_name"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceLookupByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
          "lines": "203-226",
          "snippet": "virNodeDevicePtr\nvirNodeDeviceLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->nodeDeviceDriver && conn->nodeDeviceDriver->nodeDeviceLookupByName) {\n        virNodeDevicePtr ret;\n        ret = conn->nodeDeviceDriver->nodeDeviceLookupByName(conn, name);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNodeDevicePtr\nvirNodeDeviceLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->nodeDeviceDriver && conn->nodeDeviceDriver->nodeDeviceLookupByName) {\n        virNodeDevicePtr ret;\n        ret = conn->nodeDeviceDriver->nodeDeviceLookupByName(conn, name);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"node_device_util.h\"\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirNodeDeviceGetParentName(virConnectPtr conn,\n                           const char *nodedev_name)\n{\n    virNodeDevicePtr device = NULL;\n    char *parent;\n\n    if (!(device = virNodeDeviceLookupByName(conn, nodedev_name))) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Cannot find '%s' in node device database\"),\n                       nodedev_name);\n        return NULL;\n    }\n\n    parent = g_strdup(virNodeDeviceGetParent(device));\n    virObjectUnref(device);\n\n    return parent;\n}"
  }
]