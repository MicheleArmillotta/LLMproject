[
  {
    "function_name": "virNWFilterBindingObjFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
    "lines": "284-302",
    "snippet": "char *\nvirNWFilterBindingObjFormat(const virNWFilterBindingObj *obj)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"<filterbindingstatus>\\n\");\n\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virNWFilterBindingDefFormatBuf(&buf, obj->def) < 0) {\n        virBufferFreeAndReset(&buf);\n        return NULL;\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</filterbindingstatus>\\n\");\n\n    return virBufferContentAndReset(&buf);\n}",
    "includes": [
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingobj.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterBindingObjDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"</filterbindingstatus>\\n\""
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "&buf",
            "-2"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "&buf"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingDefFormatBuf",
          "args": [
            "&buf",
            "obj->def"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefFormatBuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
          "lines": "237-270",
          "snippet": "int\nvirNWFilterBindingDefFormatBuf(virBufferPtr buf,\n                               const virNWFilterBindingDef *def)\n{\n    char uuid[VIR_UUID_STRING_BUFLEN];\n    char mac[VIR_MAC_STRING_BUFLEN];\n\n    virBufferAddLit(buf, \"<filterbinding>\\n\");\n\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferAddLit(buf, \"<owner>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->ownername);\n    virUUIDFormat(def->owneruuid, uuid);\n    virBufferAsprintf(buf, \"<uuid>%s</uuid>\\n\", uuid);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</owner>\\n\");\n\n    virBufferEscapeString(buf, \"<portdev name='%s'/>\\n\", def->portdevname);\n    if (def->linkdevname)\n        virBufferEscapeString(buf, \"<linkdev name='%s'/>\\n\", def->linkdevname);\n\n    virMacAddrFormat(&def->mac, mac);\n    virBufferAsprintf(buf, \"<mac address='%s'/>\\n\", mac);\n\n    if (virNWFilterFormatParamAttributes(buf, def->filterparams, def->filter) < 0)\n        return -1;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</filterbinding>\\n\");\n\n    return 0;\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint\nvirNWFilterBindingDefFormatBuf(virBufferPtr buf,\n                               const virNWFilterBindingDef *def)\n{\n    char uuid[VIR_UUID_STRING_BUFLEN];\n    char mac[VIR_MAC_STRING_BUFLEN];\n\n    virBufferAddLit(buf, \"<filterbinding>\\n\");\n\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferAddLit(buf, \"<owner>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->ownername);\n    virUUIDFormat(def->owneruuid, uuid);\n    virBufferAsprintf(buf, \"<uuid>%s</uuid>\\n\", uuid);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</owner>\\n\");\n\n    virBufferEscapeString(buf, \"<portdev name='%s'/>\\n\", def->portdevname);\n    if (def->linkdevname)\n        virBufferEscapeString(buf, \"<linkdev name='%s'/>\\n\", def->linkdevname);\n\n    virMacAddrFormat(&def->mac, mac);\n    virBufferAsprintf(buf, \"<mac address='%s'/>\\n\", mac);\n\n    if (virNWFilterFormatParamAttributes(buf, def->filterparams, def->filter) < 0)\n        return -1;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</filterbinding>\\n\");\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"<filterbindingstatus>\\n\""
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nchar *\nvirNWFilterBindingObjFormat(const virNWFilterBindingObj *obj)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"<filterbindingstatus>\\n\");\n\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virNWFilterBindingDefFormatBuf(&buf, obj->def) < 0) {\n        virBufferFreeAndReset(&buf);\n        return NULL;\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</filterbindingstatus>\\n\");\n\n    return virBufferContentAndReset(&buf);\n}"
  },
  {
    "function_name": "virNWFilterBindingObjParseFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
    "lines": "277-281",
    "snippet": "virNWFilterBindingObjPtr\nvirNWFilterBindingObjParseFile(const char *filename)\n{\n    return virNWFilterBindingObjParse(NULL, filename);\n}",
    "includes": [
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingobj.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBindingObjParse",
          "args": [
            "NULL",
            "filename"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "261-274",
          "snippet": "static virNWFilterBindingObjPtr\nvirNWFilterBindingObjParse(const char *xmlStr,\n                           const char *filename)\n{\n    virNWFilterBindingObjPtr obj = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(nwfilterbinding_status)\")))) {\n        obj = virNWFilterBindingObjParseNode(xml, xmlDocGetRootElement(xml));\n        xmlFreeDoc(xml);\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nstatic virNWFilterBindingObjPtr\nvirNWFilterBindingObjParse(const char *xmlStr,\n                           const char *filename)\n{\n    virNWFilterBindingObjPtr obj = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(nwfilterbinding_status)\")))) {\n        obj = virNWFilterBindingObjParseNode(xml, xmlDocGetRootElement(xml));\n        xmlFreeDoc(xml);\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirNWFilterBindingObjPtr\nvirNWFilterBindingObjParseFile(const char *filename)\n{\n    return virNWFilterBindingObjParse(NULL, filename);\n}"
  },
  {
    "function_name": "virNWFilterBindingObjParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
    "lines": "261-274",
    "snippet": "static virNWFilterBindingObjPtr\nvirNWFilterBindingObjParse(const char *xmlStr,\n                           const char *filename)\n{\n    virNWFilterBindingObjPtr obj = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(nwfilterbinding_status)\")))) {\n        obj = virNWFilterBindingObjParseNode(xml, xmlDocGetRootElement(xml));\n        xmlFreeDoc(xml);\n    }\n\n    return obj;\n}",
    "includes": [
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingobj.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterBindingObjDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlFreeDoc",
          "args": [
            "xml"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjParseNode",
          "args": [
            "xml",
            "xmlDocGetRootElement(xml)"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjParseNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "235-258",
          "snippet": "static virNWFilterBindingObjPtr\nvirNWFilterBindingObjParseNode(xmlDocPtr doc,\n                               xmlNodePtr root)\n{\n    xmlXPathContextPtr ctxt = NULL;\n    virNWFilterBindingObjPtr obj = NULL;\n\n    if (STRNEQ((const char *)root->name, \"filterbindingstatus\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"unknown root element '%s' for filter binding\"),\n                       root->name);\n        goto cleanup;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(doc)))\n        goto cleanup;\n\n    ctxt->node = root;\n    obj = virNWFilterBindingObjParseXML(doc, ctxt);\n\n cleanup:\n    xmlXPathFreeContext(ctxt);\n    return obj;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nstatic virNWFilterBindingObjPtr\nvirNWFilterBindingObjParseNode(xmlDocPtr doc,\n                               xmlNodePtr root)\n{\n    xmlXPathContextPtr ctxt = NULL;\n    virNWFilterBindingObjPtr obj = NULL;\n\n    if (STRNEQ((const char *)root->name, \"filterbindingstatus\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"unknown root element '%s' for filter binding\"),\n                       root->name);\n        goto cleanup;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(doc)))\n        goto cleanup;\n\n    ctxt->node = root;\n    obj = virNWFilterBindingObjParseXML(doc, ctxt);\n\n cleanup:\n    xmlXPathFreeContext(ctxt);\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlDocGetRootElement",
          "args": [
            "xml"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLParse",
          "args": [
            "filename",
            "xmlStr",
            "_(\"(nwfilterbinding_status)\")"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"(nwfilterbinding_status)\""
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nstatic virNWFilterBindingObjPtr\nvirNWFilterBindingObjParse(const char *xmlStr,\n                           const char *filename)\n{\n    virNWFilterBindingObjPtr obj = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(nwfilterbinding_status)\")))) {\n        obj = virNWFilterBindingObjParseNode(xml, xmlDocGetRootElement(xml));\n        xmlFreeDoc(xml);\n    }\n\n    return obj;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjParseNode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
    "lines": "235-258",
    "snippet": "static virNWFilterBindingObjPtr\nvirNWFilterBindingObjParseNode(xmlDocPtr doc,\n                               xmlNodePtr root)\n{\n    xmlXPathContextPtr ctxt = NULL;\n    virNWFilterBindingObjPtr obj = NULL;\n\n    if (STRNEQ((const char *)root->name, \"filterbindingstatus\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"unknown root element '%s' for filter binding\"),\n                       root->name);\n        goto cleanup;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(doc)))\n        goto cleanup;\n\n    ctxt->node = root;\n    obj = virNWFilterBindingObjParseXML(doc, ctxt);\n\n cleanup:\n    xmlXPathFreeContext(ctxt);\n    return obj;\n}",
    "includes": [
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingobj.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterBindingObjDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlXPathFreeContext",
          "args": [
            "ctxt"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjParseXML",
          "args": [
            "doc",
            "ctxt"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjParseXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "208-232",
          "snippet": "static virNWFilterBindingObjPtr\nvirNWFilterBindingObjParseXML(xmlDocPtr doc,\n                              xmlXPathContextPtr ctxt)\n{\n    virNWFilterBindingObjPtr ret;\n    xmlNodePtr node;\n\n    if (!(ret = virNWFilterBindingObjNew()))\n        return NULL;\n\n    if (!(node = virXPathNode(\"./filterbinding\", ctxt))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"filter binding status missing content\"));\n        goto cleanup;\n    }\n\n    if (!(ret->def = virNWFilterBindingDefParseNode(doc, node)))\n        goto cleanup;\n\n    return ret;\n\n cleanup:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic virNWFilterBindingObjPtr\nvirNWFilterBindingObjParseXML(xmlDocPtr doc,\n                              xmlXPathContextPtr ctxt)\n{\n    virNWFilterBindingObjPtr ret;\n    xmlNodePtr node;\n\n    if (!(ret = virNWFilterBindingObjNew()))\n        return NULL;\n\n    if (!(node = virXPathNode(\"./filterbinding\", ctxt))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"filter binding status missing content\"));\n        goto cleanup;\n    }\n\n    if (!(ret->def = virNWFilterBindingDefParseNode(doc, node)))\n        goto cleanup;\n\n    return ret;\n\n cleanup:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLXPathContextNew",
          "args": [
            "doc"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLXPathContextNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "48-59",
          "snippet": "xmlXPathContextPtr\nvirXMLXPathContextNew(xmlDocPtr xml)\n{\n    xmlXPathContextPtr ctxt;\n\n    if (!(ctxt = xmlXPathNewContext(xml))) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    return ctxt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlXPathContextPtr\nvirXMLXPathContextNew(xmlDocPtr xml)\n{\n    xmlXPathContextPtr ctxt;\n\n    if (!(ctxt = xmlXPathNewContext(xml))) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    return ctxt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"unknown root element '%s' for filter binding\")",
            "root->name"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown root element '%s' for filter binding\""
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "(const char *)root->name",
            "\"filterbindingstatus\""
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nstatic virNWFilterBindingObjPtr\nvirNWFilterBindingObjParseNode(xmlDocPtr doc,\n                               xmlNodePtr root)\n{\n    xmlXPathContextPtr ctxt = NULL;\n    virNWFilterBindingObjPtr obj = NULL;\n\n    if (STRNEQ((const char *)root->name, \"filterbindingstatus\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"unknown root element '%s' for filter binding\"),\n                       root->name);\n        goto cleanup;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(doc)))\n        goto cleanup;\n\n    ctxt->node = root;\n    obj = virNWFilterBindingObjParseXML(doc, ctxt);\n\n cleanup:\n    xmlXPathFreeContext(ctxt);\n    return obj;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjParseXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
    "lines": "208-232",
    "snippet": "static virNWFilterBindingObjPtr\nvirNWFilterBindingObjParseXML(xmlDocPtr doc,\n                              xmlXPathContextPtr ctxt)\n{\n    virNWFilterBindingObjPtr ret;\n    xmlNodePtr node;\n\n    if (!(ret = virNWFilterBindingObjNew()))\n        return NULL;\n\n    if (!(node = virXPathNode(\"./filterbinding\", ctxt))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"filter binding status missing content\"));\n        goto cleanup;\n    }\n\n    if (!(ret->def = virNWFilterBindingDefParseNode(doc, node)))\n        goto cleanup;\n\n    return ret;\n\n cleanup:\n    virObjectUnref(ret);\n    return NULL;\n}",
    "includes": [
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingobj.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "ret"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingDefParseNode",
          "args": [
            "doc",
            "node"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefParseNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
          "lines": "167-190",
          "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingDefParseNode(xmlDocPtr xml,\n                               xmlNodePtr root)\n{\n    xmlXPathContextPtr ctxt = NULL;\n    virNWFilterBindingDefPtr def = NULL;\n\n    if (STRNEQ((const char *)root->name, \"filterbinding\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       \"%s\",\n                       _(\"unknown root element for nwfilter binding\"));\n        goto cleanup;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        goto cleanup;\n\n    ctxt->node = root;\n    def = virNWFilterBindingDefParseXML(ctxt);\n\n cleanup:\n    xmlXPathFreeContext(ctxt);\n    return def;\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingDefParseNode(xmlDocPtr xml,\n                               xmlNodePtr root)\n{\n    xmlXPathContextPtr ctxt = NULL;\n    virNWFilterBindingDefPtr def = NULL;\n\n    if (STRNEQ((const char *)root->name, \"filterbinding\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       \"%s\",\n                       _(\"unknown root element for nwfilter binding\"));\n        goto cleanup;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        goto cleanup;\n\n    ctxt->node = root;\n    def = virNWFilterBindingDefParseXML(ctxt);\n\n cleanup:\n    xmlXPathFreeContext(ctxt);\n    return def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"filter binding status missing content\")"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"filter binding status missing content\""
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathNode",
          "args": [
            "\"./filterbinding\"",
            "ctxt"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "608-634",
          "snippet": "xmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjNew",
          "args": [],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "57-64",
          "snippet": "virNWFilterBindingObjPtr\nvirNWFilterBindingObjNew(void)\n{\n    if (virNWFilterBindingObjInitialize() < 0)\n        return NULL;\n\n    return virObjectNew(virNWFilterBindingObjClass);\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virNWFilterBindingObjClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic virClassPtr virNWFilterBindingObjClass;\n\nvirNWFilterBindingObjPtr\nvirNWFilterBindingObjNew(void)\n{\n    if (virNWFilterBindingObjInitialize() < 0)\n        return NULL;\n\n    return virObjectNew(virNWFilterBindingObjClass);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic virNWFilterBindingObjPtr\nvirNWFilterBindingObjParseXML(xmlDocPtr doc,\n                              xmlXPathContextPtr ctxt)\n{\n    virNWFilterBindingObjPtr ret;\n    xmlNodePtr node;\n\n    if (!(ret = virNWFilterBindingObjNew()))\n        return NULL;\n\n    if (!(node = virXPathNode(\"./filterbinding\", ctxt))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"filter binding status missing content\"));\n        goto cleanup;\n    }\n\n    if (!(ret->def = virNWFilterBindingDefParseNode(doc, node)))\n        goto cleanup;\n\n    return ret;\n\n cleanup:\n    virObjectUnref(ret);\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjDelete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
    "lines": "181-205",
    "snippet": "int\nvirNWFilterBindingObjDelete(const virNWFilterBindingObj *obj,\n                            const char *statusDir)\n{\n    char *filename;\n    int ret = -1;\n\n    if (!(filename = virNWFilterBindingObjConfigFile(statusDir,\n                                                     obj->def->portdevname)))\n        return -1;\n\n    if (unlink(filename) < 0 &&\n        errno != ENOENT) {\n        virReportSystemError(errno,\n                             _(\"Unable to remove status '%s' for nwfilter binding %s'\"),\n                             filename, obj->def->portdevname);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(filename);\n    return ret;\n}",
    "includes": [
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingobj.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterBindingObjDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "filename"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to remove status '%s' for nwfilter binding %s'\")",
            "filename",
            "obj->def->portdevname"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to remove status '%s' for nwfilter binding %s'\""
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "filename"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjConfigFile",
          "args": [
            "statusDir",
            "obj->def->portdevname"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjConfigFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "137-145",
          "snippet": "char *\nvirNWFilterBindingObjConfigFile(const char *dir,\n                                const char *name)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirNWFilterBindingObjConfigFile(const char *dir,\n                                const char *name)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nint\nvirNWFilterBindingObjDelete(const virNWFilterBindingObj *obj,\n                            const char *statusDir)\n{\n    char *filename;\n    int ret = -1;\n\n    if (!(filename = virNWFilterBindingObjConfigFile(statusDir,\n                                                     obj->def->portdevname)))\n        return -1;\n\n    if (unlink(filename) < 0 &&\n        errno != ENOENT) {\n        virReportSystemError(errno,\n                             _(\"Unable to remove status '%s' for nwfilter binding %s'\"),\n                             filename, obj->def->portdevname);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(filename);\n    return ret;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjSave",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
    "lines": "148-178",
    "snippet": "int\nvirNWFilterBindingObjSave(const virNWFilterBindingObj *obj,\n                          const char *statusDir)\n{\n    char *filename;\n    char *xml = NULL;\n    int ret = -1;\n\n    if (!(filename = virNWFilterBindingObjConfigFile(statusDir,\n                                                     obj->def->portdevname)))\n        return -1;\n\n    if (!(xml = virNWFilterBindingObjFormat(obj)))\n        goto cleanup;\n\n    if (virFileMakePath(statusDir) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot create config directory '%s'\"),\n                             statusDir);\n        goto cleanup;\n    }\n\n    ret = virXMLSaveFile(filename,\n                         obj->def->portdevname, \"nwfilter-binding-create\",\n                         xml);\n\n cleanup:\n    VIR_FREE(xml);\n    VIR_FREE(filename);\n    return ret;\n}",
    "includes": [
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingobj.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterBindingObjDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "filename"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "xml"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLSaveFile",
          "args": [
            "filename",
            "obj->def->portdevname",
            "\"nwfilter-binding-create\"",
            "xml"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLSaveFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "941-950",
          "snippet": "int\nvirXMLSaveFile(const char *path,\n               const char *warnName,\n               const char *warnCommand,\n               const char *xml)\n{\n    struct virXMLRewriteFileData data = { warnName, warnCommand, xml };\n\n    return virFileRewrite(path, S_IRUSR | S_IWUSR, virXMLRewriteFile, &data);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXMLSaveFile(const char *path,\n               const char *warnName,\n               const char *warnCommand,\n               const char *xml)\n{\n    struct virXMLRewriteFileData data = { warnName, warnCommand, xml };\n\n    return virFileRewrite(path, S_IRUSR | S_IWUSR, virXMLRewriteFile, &data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot create config directory '%s'\")",
            "statusDir"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot create config directory '%s'\""
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileMakePath",
          "args": [
            "statusDir"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3076-3080",
          "snippet": "int\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjFormat",
          "args": [
            "obj"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "284-302",
          "snippet": "char *\nvirNWFilterBindingObjFormat(const virNWFilterBindingObj *obj)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"<filterbindingstatus>\\n\");\n\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virNWFilterBindingDefFormatBuf(&buf, obj->def) < 0) {\n        virBufferFreeAndReset(&buf);\n        return NULL;\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</filterbindingstatus>\\n\");\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nchar *\nvirNWFilterBindingObjFormat(const virNWFilterBindingObj *obj)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"<filterbindingstatus>\\n\");\n\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virNWFilterBindingDefFormatBuf(&buf, obj->def) < 0) {\n        virBufferFreeAndReset(&buf);\n        return NULL;\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</filterbindingstatus>\\n\");\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjConfigFile",
          "args": [
            "statusDir",
            "obj->def->portdevname"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjConfigFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "137-145",
          "snippet": "char *\nvirNWFilterBindingObjConfigFile(const char *dir,\n                                const char *name)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirNWFilterBindingObjConfigFile(const char *dir,\n                                const char *name)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nint\nvirNWFilterBindingObjSave(const virNWFilterBindingObj *obj,\n                          const char *statusDir)\n{\n    char *filename;\n    char *xml = NULL;\n    int ret = -1;\n\n    if (!(filename = virNWFilterBindingObjConfigFile(statusDir,\n                                                     obj->def->portdevname)))\n        return -1;\n\n    if (!(xml = virNWFilterBindingObjFormat(obj)))\n        goto cleanup;\n\n    if (virFileMakePath(statusDir) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot create config directory '%s'\"),\n                             statusDir);\n        goto cleanup;\n    }\n\n    ret = virXMLSaveFile(filename,\n                         obj->def->portdevname, \"nwfilter-binding-create\",\n                         xml);\n\n cleanup:\n    VIR_FREE(xml);\n    VIR_FREE(filename);\n    return ret;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjConfigFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
    "lines": "137-145",
    "snippet": "char *\nvirNWFilterBindingObjConfigFile(const char *dir,\n                                const char *name)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}",
    "includes": [
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingobj.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s.xml\"",
            "dir",
            "name"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirNWFilterBindingObjConfigFile(const char *dir,\n                                const char *name)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjEndAPI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
    "lines": "125-134",
    "snippet": "void\nvirNWFilterBindingObjEndAPI(virNWFilterBindingObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
    "includes": [
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingobj.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterBindingObjDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "*obj"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "*obj"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvoid\nvirNWFilterBindingObjEndAPI(virNWFilterBindingObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjSetRemoving",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
    "lines": "106-111",
    "snippet": "void\nvirNWFilterBindingObjSetRemoving(virNWFilterBindingObjPtr obj,\n                                 bool removing)\n{\n    obj->removing = removing;\n}",
    "includes": [
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingobj.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterBindingObjDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvoid\nvirNWFilterBindingObjSetRemoving(virNWFilterBindingObjPtr obj,\n                                 bool removing)\n{\n    obj->removing = removing;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjGetRemoving",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
    "lines": "99-103",
    "snippet": "bool\nvirNWFilterBindingObjGetRemoving(virNWFilterBindingObjPtr obj)\n{\n    return obj->removing;\n}",
    "includes": [
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingobj.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterBindingObjDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nbool\nvirNWFilterBindingObjGetRemoving(virNWFilterBindingObjPtr obj)\n{\n    return obj->removing;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjStealDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
    "lines": "92-96",
    "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingObjStealDef(virNWFilterBindingObjPtr obj)\n{\n    return g_steal_pointer(&obj->def);\n}",
    "includes": [
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingobj.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterBindingObjDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&obj->def"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingObjStealDef(virNWFilterBindingObjPtr obj)\n{\n    return g_steal_pointer(&obj->def);\n}"
  },
  {
    "function_name": "virNWFilterBindingObjSetDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
    "lines": "83-89",
    "snippet": "void\nvirNWFilterBindingObjSetDef(virNWFilterBindingObjPtr obj,\n                            virNWFilterBindingDefPtr def)\n{\n    virNWFilterBindingDefFree(obj->def);\n    obj->def = def;\n}",
    "includes": [
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingobj.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterBindingObjDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBindingDefFree",
          "args": [
            "obj->def"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
          "lines": "33-46",
          "snippet": "void\nvirNWFilterBindingDefFree(virNWFilterBindingDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->portdevname);\n    VIR_FREE(def->linkdevname);\n    VIR_FREE(def->filter);\n    virHashFree(def->filterparams);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirNWFilterBindingDefFree(virNWFilterBindingDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->portdevname);\n    VIR_FREE(def->linkdevname);\n    VIR_FREE(def->filter);\n    virHashFree(def->filterparams);\n\n    VIR_FREE(def);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvoid\nvirNWFilterBindingObjSetDef(virNWFilterBindingObjPtr obj,\n                            virNWFilterBindingDefPtr def)\n{\n    virNWFilterBindingDefFree(obj->def);\n    obj->def = def;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjGetDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
    "lines": "76-80",
    "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}",
    "includes": [
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingobj.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterBindingObjDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
    "lines": "67-73",
    "snippet": "static void\nvirNWFilterBindingObjDispose(void *obj)\n{\n    virNWFilterBindingObjPtr bobj = obj;\n\n    virNWFilterBindingDefFree(bobj->def);\n}",
    "includes": [
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingobj.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterBindingObjDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBindingDefFree",
          "args": [
            "bobj->def"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
          "lines": "33-46",
          "snippet": "void\nvirNWFilterBindingDefFree(virNWFilterBindingDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->portdevname);\n    VIR_FREE(def->linkdevname);\n    VIR_FREE(def->filter);\n    virHashFree(def->filterparams);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirNWFilterBindingDefFree(virNWFilterBindingDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->portdevname);\n    VIR_FREE(def->linkdevname);\n    VIR_FREE(def->filter);\n    virHashFree(def->filterparams);\n\n    VIR_FREE(def);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nstatic void\nvirNWFilterBindingObjDispose(void *obj)\n{\n    virNWFilterBindingObjPtr bobj = obj;\n\n    virNWFilterBindingDefFree(bobj->def);\n}"
  },
  {
    "function_name": "virNWFilterBindingObjNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
    "lines": "57-64",
    "snippet": "virNWFilterBindingObjPtr\nvirNWFilterBindingObjNew(void)\n{\n    if (virNWFilterBindingObjInitialize() < 0)\n        return NULL;\n\n    return virObjectNew(virNWFilterBindingObjClass);\n}",
    "includes": [
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingobj.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virNWFilterBindingObjClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectNew",
          "args": [
            "virNWFilterBindingObjClass"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "236-253",
          "snippet": "void *\nvirObjectNew(virClassPtr klass)\n{\n    virObjectPtr obj = NULL;\n\n    if (VIR_ALLOC_VAR(obj,\n                      char,\n                      klass->objectSize - sizeof(virObject)) < 0)\n        return NULL;\n\n    obj->u.s.magic = klass->magic;\n    obj->klass = klass;\n    g_atomic_int_set(&obj->u.s.refs, 1);\n\n    PROBE(OBJECT_NEW, \"obj=%p classname=%s\", obj, obj->klass->name);\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectNew(virClassPtr klass)\n{\n    virObjectPtr obj = NULL;\n\n    if (VIR_ALLOC_VAR(obj,\n                      char,\n                      klass->objectSize - sizeof(virObject)) < 0)\n        return NULL;\n\n    obj->u.s.magic = klass->magic;\n    obj->klass = klass;\n    g_atomic_int_set(&obj->u.s.refs, 1);\n\n    PROBE(OBJECT_NEW, \"obj=%p classname=%s\", obj, obj->klass->name);\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjInitialize",
          "args": [],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic virClassPtr virNWFilterBindingObjClass;\n\nvirNWFilterBindingObjPtr\nvirNWFilterBindingObjNew(void)\n{\n    if (virNWFilterBindingObjInitialize() < 0)\n        return NULL;\n\n    return virObjectNew(virNWFilterBindingObjClass);\n}"
  },
  {
    "function_name": "virNWFilterBindingObjOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
    "lines": "46-53",
    "snippet": "static int\nvirNWFilterBindingObjOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNWFilterBindingObj, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virnwfilterbindingobj.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virNWFilterBindingObj",
            "virClassForObjectLockable()"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirNWFilterBindingObjOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNWFilterBindingObj, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}"
  }
]