[
  {
    "function_name": "virDomainCheckpointRedefinePrep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
    "lines": "518-570",
    "snippet": "int\nvirDomainCheckpointRedefinePrep(virDomainObjPtr vm,\n                                virDomainCheckpointDefPtr *defptr,\n                                virDomainMomentObjPtr *chk,\n                                virDomainXMLOptionPtr xmlopt,\n                                bool *update_current)\n{\n    virDomainCheckpointDefPtr def = *defptr;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virDomainMomentObjPtr parent = NULL;\n    virDomainMomentObjPtr other = NULL;\n    virDomainCheckpointDefPtr otherdef = NULL;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (virDomainCheckpointCheckCycles(vm->checkpoints, def, vm->def->name) < 0)\n        return -1;\n\n    if (!def->parent.dom ||\n        memcmp(def->parent.dom->uuid, vm->def->uuid, VIR_UUID_BUFLEN)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"definition for checkpoint %s must use uuid %s\"),\n                       def->parent.name, uuidstr);\n        return -1;\n    }\n    if (virDomainCheckpointAlignDisks(def) < 0)\n        return -1;\n\n    if (def->parent.parent_name &&\n         (parent = virDomainCheckpointFindByName(vm->checkpoints,\n                                                 def->parent.parent_name))) {\n        if (parent == virDomainCheckpointGetCurrent(vm->checkpoints))\n            *update_current = true;\n    }\n\n    other = virDomainCheckpointFindByName(vm->checkpoints, def->parent.name);\n    if (other) {\n        otherdef = virDomainCheckpointObjGetDef(other);\n        if (!virDomainDefCheckABIStability(otherdef->parent.dom,\n                                           def->parent.dom, xmlopt))\n            return -1;\n\n        /* Drop and rebuild the parent relationship, but keep all\n         * child relations by reusing chk.  */\n        virDomainMomentDropParent(other);\n        virObjectUnref(otherdef);\n        other->def = &(*defptr)->parent;\n        *defptr = NULL;\n        *chk = other;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virstring.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virbitmap.h\"",
      "#include \"internal.h\"",
      "#include \"configmake.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "otherdef"
          ],
          "line": 563
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainMomentDropParent",
          "args": [
            "other"
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentDropParent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "119-141",
          "snippet": "void\nvirDomainMomentDropParent(virDomainMomentObjPtr moment)\n{\n    virDomainMomentObjPtr prev = NULL;\n    virDomainMomentObjPtr curr = NULL;\n\n    moment->parent->nchildren--;\n    curr = moment->parent->first_child;\n    while (curr != moment) {\n        if (!curr) {\n            VIR_WARN(\"inconsistent moment relations\");\n            return;\n        }\n        prev = curr;\n        curr = curr->sibling;\n    }\n    if (prev)\n        prev->sibling = moment->sibling;\n    else\n        moment->parent->first_child = moment->sibling;\n    moment->parent = NULL;\n    moment->sibling = NULL;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentDropParent(virDomainMomentObjPtr moment)\n{\n    virDomainMomentObjPtr prev = NULL;\n    virDomainMomentObjPtr curr = NULL;\n\n    moment->parent->nchildren--;\n    curr = moment->parent->first_child;\n    while (curr != moment) {\n        if (!curr) {\n            VIR_WARN(\"inconsistent moment relations\");\n            return;\n        }\n        prev = curr;\n        curr = curr->sibling;\n    }\n    if (prev)\n        prev->sibling = moment->sibling;\n    else\n        moment->parent->first_child = moment->sibling;\n    moment->parent = NULL;\n    moment->sibling = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefCheckABIStability",
          "args": [
            "otherdef->parent.dom",
            "def->parent.dom",
            "xmlopt"
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefCheckABIStability",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "24133-24139",
          "snippet": "bool\nvirDomainDefCheckABIStability(virDomainDefPtr src,\n                              virDomainDefPtr dst,\n                              virDomainXMLOptionPtr xmlopt)\n{\n    return virDomainDefCheckABIStabilityFlags(src, dst, xmlopt, 0);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nbool\nvirDomainDefCheckABIStability(virDomainDefPtr src,\n                              virDomainDefPtr dst,\n                              virDomainXMLOptionPtr xmlopt)\n{\n    return virDomainDefCheckABIStabilityFlags(src, dst, xmlopt, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCheckpointObjGetDef",
          "args": [
            "other"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCheckpointObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.h",
          "lines": "92-96",
          "snippet": "static inline virDomainCheckpointDefPtr\nvirDomainCheckpointObjGetDef(virDomainMomentObjPtr obj)\n{\n    return (virDomainCheckpointDefPtr) obj->def;\n}",
          "includes": [
            "#include \"virbuffer.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "virDomainMomentObjPtr\nvirDomainCheckpointAssignDef(virDomainCheckpointObjListPtr checkpoints,\n                             virDomainCheckpointDefPtr def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virbuffer.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n\nvirDomainMomentObjPtr\nvirDomainCheckpointAssignDef(virDomainCheckpointObjListPtr checkpoints,\n                             virDomainCheckpointDefPtr def);\n\nstatic inline virDomainCheckpointDefPtr\nvirDomainCheckpointObjGetDef(virDomainMomentObjPtr obj)\n{\n    return (virDomainCheckpointDefPtr) obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCheckpointFindByName",
          "args": [
            "vm->checkpoints",
            "def->parent.name"
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCheckpointFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
          "lines": "109-114",
          "snippet": "virDomainMomentObjPtr\nvirDomainCheckpointFindByName(virDomainCheckpointObjListPtr checkpoints,\n                              const char *name)\n{\n    return virDomainMomentFindByName(checkpoints->base, name);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainCheckpointFindByName(virDomainCheckpointObjListPtr checkpoints,\n                              const char *name)\n{\n    return virDomainMomentFindByName(checkpoints->base, name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCheckpointGetCurrent",
          "args": [
            "vm->checkpoints"
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCheckpointGetCurrentName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
          "lines": "126-130",
          "snippet": "const char *\nvirDomainCheckpointGetCurrentName(virDomainCheckpointObjListPtr checkpoints)\n{\n    return virDomainMomentGetCurrentName(checkpoints->base);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nconst char *\nvirDomainCheckpointGetCurrentName(virDomainCheckpointObjListPtr checkpoints)\n{\n    return virDomainMomentGetCurrentName(checkpoints->base);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCheckpointAlignDisks",
          "args": [
            "def"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCheckpointAlignDisks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
          "lines": "292-398",
          "snippet": "int\nvirDomainCheckpointAlignDisks(virDomainCheckpointDefPtr def)\n{\n    int ret = -1;\n    virBitmapPtr map = NULL;\n    size_t i;\n    int ndisks;\n    int checkpoint_default = VIR_DOMAIN_CHECKPOINT_TYPE_NONE;\n\n    if (!def->parent.dom) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing domain in checkpoint\"));\n        goto cleanup;\n    }\n\n    if (def->ndisks > def->parent.dom->ndisks) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"too many disk checkpoint requests for domain\"));\n        goto cleanup;\n    }\n\n    /* Unlikely to have a guest without disks but technically possible.  */\n    if (!def->parent.dom->ndisks) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"domain must have at least one disk to perform \"\n                         \"checkpoints\"));\n        goto cleanup;\n    }\n\n    /* If <disks> omitted, do bitmap on all writeable disks;\n     * otherwise, do nothing for omitted disks */\n    if (!def->ndisks)\n        checkpoint_default = VIR_DOMAIN_CHECKPOINT_TYPE_BITMAP;\n\n    if (!(map = virBitmapNew(def->parent.dom->ndisks)))\n        goto cleanup;\n\n    /* Double check requested disks.  */\n    for (i = 0; i < def->ndisks; i++) {\n        virDomainCheckpointDiskDefPtr disk = &def->disks[i];\n        int idx = virDomainDiskIndexByName(def->parent.dom, disk->name, false);\n\n        if (idx < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"no disk named '%s'\"), disk->name);\n            goto cleanup;\n        }\n\n        if (virBitmapIsBitSet(map, idx)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"disk '%s' specified twice\"),\n                           disk->name);\n            goto cleanup;\n        }\n        if ((virStorageSourceIsEmpty(def->parent.dom->disks[idx]->src) ||\n             def->parent.dom->disks[idx]->src->readonly) &&\n            disk->type != VIR_DOMAIN_CHECKPOINT_TYPE_NONE) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"disk '%s' is empty or readonly\"),\n                           disk->name);\n            goto cleanup;\n        }\n        ignore_value(virBitmapSetBit(map, idx));\n        disk->idx = idx;\n\n        if (STRNEQ(disk->name, def->parent.dom->disks[idx]->dst)) {\n            VIR_FREE(disk->name);\n            disk->name = g_strdup(def->parent.dom->disks[idx]->dst);\n        }\n    }\n\n    /* Provide defaults for all remaining disks.  */\n    ndisks = def->ndisks;\n    if (VIR_EXPAND_N(def->disks, def->ndisks,\n                     def->parent.dom->ndisks - def->ndisks) < 0)\n        goto cleanup;\n\n    for (i = 0; i < def->parent.dom->ndisks; i++) {\n        virDomainCheckpointDiskDefPtr disk;\n\n        if (virBitmapIsBitSet(map, i))\n            continue;\n        disk = &def->disks[ndisks++];\n        disk->name = g_strdup(def->parent.dom->disks[i]->dst);\n        disk->idx = i;\n\n        /* Don't checkpoint empty or readonly drives */\n        if (virStorageSourceIsEmpty(def->parent.dom->disks[i]->src) ||\n            def->parent.dom->disks[i]->src->readonly)\n            disk->type = VIR_DOMAIN_CHECKPOINT_TYPE_NONE;\n        else\n            disk->type = checkpoint_default;\n    }\n\n    qsort(&def->disks[0], def->ndisks, sizeof(def->disks[0]),\n          virDomainCheckpointCompareDiskIndex);\n\n    /* Generate default bitmap names for checkpoint */\n    if (virDomainCheckpointDefAssignBitmapNames(def) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virBitmapFree(map);\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virbitmap.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nint\nvirDomainCheckpointAlignDisks(virDomainCheckpointDefPtr def)\n{\n    int ret = -1;\n    virBitmapPtr map = NULL;\n    size_t i;\n    int ndisks;\n    int checkpoint_default = VIR_DOMAIN_CHECKPOINT_TYPE_NONE;\n\n    if (!def->parent.dom) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing domain in checkpoint\"));\n        goto cleanup;\n    }\n\n    if (def->ndisks > def->parent.dom->ndisks) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"too many disk checkpoint requests for domain\"));\n        goto cleanup;\n    }\n\n    /* Unlikely to have a guest without disks but technically possible.  */\n    if (!def->parent.dom->ndisks) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"domain must have at least one disk to perform \"\n                         \"checkpoints\"));\n        goto cleanup;\n    }\n\n    /* If <disks> omitted, do bitmap on all writeable disks;\n     * otherwise, do nothing for omitted disks */\n    if (!def->ndisks)\n        checkpoint_default = VIR_DOMAIN_CHECKPOINT_TYPE_BITMAP;\n\n    if (!(map = virBitmapNew(def->parent.dom->ndisks)))\n        goto cleanup;\n\n    /* Double check requested disks.  */\n    for (i = 0; i < def->ndisks; i++) {\n        virDomainCheckpointDiskDefPtr disk = &def->disks[i];\n        int idx = virDomainDiskIndexByName(def->parent.dom, disk->name, false);\n\n        if (idx < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"no disk named '%s'\"), disk->name);\n            goto cleanup;\n        }\n\n        if (virBitmapIsBitSet(map, idx)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"disk '%s' specified twice\"),\n                           disk->name);\n            goto cleanup;\n        }\n        if ((virStorageSourceIsEmpty(def->parent.dom->disks[idx]->src) ||\n             def->parent.dom->disks[idx]->src->readonly) &&\n            disk->type != VIR_DOMAIN_CHECKPOINT_TYPE_NONE) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"disk '%s' is empty or readonly\"),\n                           disk->name);\n            goto cleanup;\n        }\n        ignore_value(virBitmapSetBit(map, idx));\n        disk->idx = idx;\n\n        if (STRNEQ(disk->name, def->parent.dom->disks[idx]->dst)) {\n            VIR_FREE(disk->name);\n            disk->name = g_strdup(def->parent.dom->disks[idx]->dst);\n        }\n    }\n\n    /* Provide defaults for all remaining disks.  */\n    ndisks = def->ndisks;\n    if (VIR_EXPAND_N(def->disks, def->ndisks,\n                     def->parent.dom->ndisks - def->ndisks) < 0)\n        goto cleanup;\n\n    for (i = 0; i < def->parent.dom->ndisks; i++) {\n        virDomainCheckpointDiskDefPtr disk;\n\n        if (virBitmapIsBitSet(map, i))\n            continue;\n        disk = &def->disks[ndisks++];\n        disk->name = g_strdup(def->parent.dom->disks[i]->dst);\n        disk->idx = i;\n\n        /* Don't checkpoint empty or readonly drives */\n        if (virStorageSourceIsEmpty(def->parent.dom->disks[i]->src) ||\n            def->parent.dom->disks[i]->src->readonly)\n            disk->type = VIR_DOMAIN_CHECKPOINT_TYPE_NONE;\n        else\n            disk->type = checkpoint_default;\n    }\n\n    qsort(&def->disks[0], def->ndisks, sizeof(def->disks[0]),\n          virDomainCheckpointCompareDiskIndex);\n\n    /* Generate default bitmap names for checkpoint */\n    if (virDomainCheckpointDefAssignBitmapNames(def) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virBitmapFree(map);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"definition for checkpoint %s must use uuid %s\")",
            "def->parent.name",
            "uuidstr"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"definition for checkpoint %s must use uuid %s\""
          ],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "def->parent.dom->uuid",
            "vm->def->uuid",
            "VIR_UUID_BUFLEN"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainCheckpointCheckCycles",
          "args": [
            "vm->checkpoints",
            "def",
            "vm->def->name"
          ],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCheckpointCheckCycles",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
          "lines": "194-200",
          "snippet": "int\nvirDomainCheckpointCheckCycles(virDomainCheckpointObjListPtr checkpoints,\n                               virDomainCheckpointDefPtr def,\n                               const char *domname)\n{\n    return virDomainMomentCheckCycles(checkpoints->base, &def->parent, domname);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainCheckpointCheckCycles(virDomainCheckpointObjListPtr checkpoints,\n                               virDomainCheckpointDefPtr def,\n                               const char *domname)\n{\n    return virDomainMomentCheckCycles(checkpoints->base, &def->parent, domname);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "vm->def->uuid",
            "uuidstr"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nint\nvirDomainCheckpointRedefinePrep(virDomainObjPtr vm,\n                                virDomainCheckpointDefPtr *defptr,\n                                virDomainMomentObjPtr *chk,\n                                virDomainXMLOptionPtr xmlopt,\n                                bool *update_current)\n{\n    virDomainCheckpointDefPtr def = *defptr;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virDomainMomentObjPtr parent = NULL;\n    virDomainMomentObjPtr other = NULL;\n    virDomainCheckpointDefPtr otherdef = NULL;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (virDomainCheckpointCheckCycles(vm->checkpoints, def, vm->def->name) < 0)\n        return -1;\n\n    if (!def->parent.dom ||\n        memcmp(def->parent.dom->uuid, vm->def->uuid, VIR_UUID_BUFLEN)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"definition for checkpoint %s must use uuid %s\"),\n                       def->parent.name, uuidstr);\n        return -1;\n    }\n    if (virDomainCheckpointAlignDisks(def) < 0)\n        return -1;\n\n    if (def->parent.parent_name &&\n         (parent = virDomainCheckpointFindByName(vm->checkpoints,\n                                                 def->parent.parent_name))) {\n        if (parent == virDomainCheckpointGetCurrent(vm->checkpoints))\n            *update_current = true;\n    }\n\n    other = virDomainCheckpointFindByName(vm->checkpoints, def->parent.name);\n    if (other) {\n        otherdef = virDomainCheckpointObjGetDef(other);\n        if (!virDomainDefCheckABIStability(otherdef->parent.dom,\n                                           def->parent.dom, xmlopt))\n            return -1;\n\n        /* Drop and rebuild the parent relationship, but keep all\n         * child relations by reusing chk.  */\n        virDomainMomentDropParent(other);\n        virObjectUnref(otherdef);\n        other->def = &(*defptr)->parent;\n        *defptr = NULL;\n        *chk = other;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virDomainCheckpointDefFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
    "lines": "500-515",
    "snippet": "char *\nvirDomainCheckpointDefFormat(virDomainCheckpointDefPtr def,\n                             virDomainXMLOptionPtr xmlopt,\n                             unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_CHECKPOINT_FORMAT_SECURE |\n                  VIR_DOMAIN_CHECKPOINT_FORMAT_NO_DOMAIN |\n                  VIR_DOMAIN_CHECKPOINT_FORMAT_SIZE, NULL);\n    if (virDomainCheckpointDefFormatInternal(&buf, def, xmlopt,\n                                             flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virstring.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virbitmap.h\"",
      "#include \"internal.h\"",
      "#include \"configmake.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 514
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCheckpointDefFormatInternal",
          "args": [
            "&buf",
            "def",
            "xmlopt",
            "flags"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCheckpointDefFormatInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
          "lines": "441-498",
          "snippet": "static int\nvirDomainCheckpointDefFormatInternal(virBufferPtr buf,\n                                     virDomainCheckpointDefPtr def,\n                                     virDomainXMLOptionPtr xmlopt,\n                                     unsigned int flags)\n{\n    size_t i;\n    unsigned int domainflags = VIR_DOMAIN_DEF_FORMAT_INACTIVE;\n\n    if (flags & VIR_DOMAIN_CHECKPOINT_FORMAT_SECURE)\n        domainflags |= VIR_DOMAIN_DEF_FORMAT_SECURE;\n\n    virBufferAddLit(buf, \"<domaincheckpoint>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->parent.name);\n    virBufferEscapeString(buf, \"<description>%s</description>\\n\",\n                          def->parent.description);\n\n    if (def->parent.parent_name) {\n        virBufferAddLit(buf, \"<parent>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferEscapeString(buf, \"<name>%s</name>\\n\",\n                              def->parent.parent_name);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</parent>\\n\");\n    }\n\n    if (def->parent.creationTime)\n        virBufferAsprintf(buf, \"<creationTime>%lld</creationTime>\\n\",\n                          def->parent.creationTime);\n\n    if (def->ndisks) {\n        virBufferAddLit(buf, \"<disks>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        for (i = 0; i < def->ndisks; i++) {\n            if (virDomainCheckpointDiskDefFormat(buf, &def->disks[i],\n                                                 flags) < 0)\n                goto error;\n        }\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</disks>\\n\");\n    }\n\n    if (!(flags & VIR_DOMAIN_CHECKPOINT_FORMAT_NO_DOMAIN) &&\n        virDomainDefFormatInternal(def->parent.dom, xmlopt,\n                                   buf, domainflags) < 0)\n        goto error;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</domaincheckpoint>\\n\");\n\n    return 0;\n\n error:\n    virBufferFreeAndReset(buf);\n    return -1;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virbitmap.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic int\nvirDomainCheckpointDefFormatInternal(virBufferPtr buf,\n                                     virDomainCheckpointDefPtr def,\n                                     virDomainXMLOptionPtr xmlopt,\n                                     unsigned int flags)\n{\n    size_t i;\n    unsigned int domainflags = VIR_DOMAIN_DEF_FORMAT_INACTIVE;\n\n    if (flags & VIR_DOMAIN_CHECKPOINT_FORMAT_SECURE)\n        domainflags |= VIR_DOMAIN_DEF_FORMAT_SECURE;\n\n    virBufferAddLit(buf, \"<domaincheckpoint>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->parent.name);\n    virBufferEscapeString(buf, \"<description>%s</description>\\n\",\n                          def->parent.description);\n\n    if (def->parent.parent_name) {\n        virBufferAddLit(buf, \"<parent>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferEscapeString(buf, \"<name>%s</name>\\n\",\n                              def->parent.parent_name);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</parent>\\n\");\n    }\n\n    if (def->parent.creationTime)\n        virBufferAsprintf(buf, \"<creationTime>%lld</creationTime>\\n\",\n                          def->parent.creationTime);\n\n    if (def->ndisks) {\n        virBufferAddLit(buf, \"<disks>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        for (i = 0; i < def->ndisks; i++) {\n            if (virDomainCheckpointDiskDefFormat(buf, &def->disks[i],\n                                                 flags) < 0)\n                goto error;\n        }\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</disks>\\n\");\n    }\n\n    if (!(flags & VIR_DOMAIN_CHECKPOINT_FORMAT_NO_DOMAIN) &&\n        virDomainDefFormatInternal(def->parent.dom, xmlopt,\n                                   buf, domainflags) < 0)\n        goto error;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</domaincheckpoint>\\n\");\n\n    return 0;\n\n error:\n    virBufferFreeAndReset(buf);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_CHECKPOINT_FORMAT_SECURE |\n                  VIR_DOMAIN_CHECKPOINT_FORMAT_NO_DOMAIN |\n                  VIR_DOMAIN_CHECKPOINT_FORMAT_SIZE",
            "NULL"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nchar *\nvirDomainCheckpointDefFormat(virDomainCheckpointDefPtr def,\n                             virDomainXMLOptionPtr xmlopt,\n                             unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_CHECKPOINT_FORMAT_SECURE |\n                  VIR_DOMAIN_CHECKPOINT_FORMAT_NO_DOMAIN |\n                  VIR_DOMAIN_CHECKPOINT_FORMAT_SIZE, NULL);\n    if (virDomainCheckpointDefFormatInternal(&buf, def, xmlopt,\n                                             flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}"
  },
  {
    "function_name": "virDomainCheckpointDefFormatInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
    "lines": "441-498",
    "snippet": "static int\nvirDomainCheckpointDefFormatInternal(virBufferPtr buf,\n                                     virDomainCheckpointDefPtr def,\n                                     virDomainXMLOptionPtr xmlopt,\n                                     unsigned int flags)\n{\n    size_t i;\n    unsigned int domainflags = VIR_DOMAIN_DEF_FORMAT_INACTIVE;\n\n    if (flags & VIR_DOMAIN_CHECKPOINT_FORMAT_SECURE)\n        domainflags |= VIR_DOMAIN_DEF_FORMAT_SECURE;\n\n    virBufferAddLit(buf, \"<domaincheckpoint>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->parent.name);\n    virBufferEscapeString(buf, \"<description>%s</description>\\n\",\n                          def->parent.description);\n\n    if (def->parent.parent_name) {\n        virBufferAddLit(buf, \"<parent>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferEscapeString(buf, \"<name>%s</name>\\n\",\n                              def->parent.parent_name);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</parent>\\n\");\n    }\n\n    if (def->parent.creationTime)\n        virBufferAsprintf(buf, \"<creationTime>%lld</creationTime>\\n\",\n                          def->parent.creationTime);\n\n    if (def->ndisks) {\n        virBufferAddLit(buf, \"<disks>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        for (i = 0; i < def->ndisks; i++) {\n            if (virDomainCheckpointDiskDefFormat(buf, &def->disks[i],\n                                                 flags) < 0)\n                goto error;\n        }\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</disks>\\n\");\n    }\n\n    if (!(flags & VIR_DOMAIN_CHECKPOINT_FORMAT_NO_DOMAIN) &&\n        virDomainDefFormatInternal(def->parent.dom, xmlopt,\n                                   buf, domainflags) < 0)\n        goto error;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</domaincheckpoint>\\n\");\n\n    return 0;\n\n error:\n    virBufferFreeAndReset(buf);\n    return -1;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virstring.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virbitmap.h\"",
      "#include \"internal.h\"",
      "#include \"configmake.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "buf"
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</domaincheckpoint>\\n\""
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFormatInternal",
          "args": [
            "def->parent.dom",
            "xmlopt",
            "buf",
            "domainflags"
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFormatInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "28943-28951",
          "snippet": "int\nvirDomainDefFormatInternal(virDomainDefPtr def,\n                           virDomainXMLOptionPtr xmlopt,\n                           virBufferPtr buf,\n                           unsigned int flags)\n{\n    return virDomainDefFormatInternalSetRootName(def, xmlopt, buf,\n                                                 \"domain\", flags);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefFormatInternal(virDomainDefPtr def,\n                           virDomainXMLOptionPtr xmlopt,\n                           virBufferPtr buf,\n                           unsigned int flags)\n{\n    return virDomainDefFormatInternalSetRootName(def, xmlopt, buf,\n                                                 \"domain\", flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</disks>\\n\""
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainCheckpointDiskDefFormat",
          "args": [
            "buf",
            "&def->disks[i]",
            "flags"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCheckpointDiskDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
          "lines": "419-438",
          "snippet": "static int\nvirDomainCheckpointDiskDefFormat(virBufferPtr buf,\n                                 virDomainCheckpointDiskDefPtr disk,\n                                 unsigned int flags)\n{\n    if (!disk->name)\n        return 0;\n\n    virBufferEscapeString(buf, \"<disk name='%s'\", disk->name);\n    if (disk->type)\n        virBufferAsprintf(buf, \" checkpoint='%s'\",\n                          virDomainCheckpointTypeToString(disk->type));\n    if (disk->bitmap) {\n        virBufferEscapeString(buf, \" bitmap='%s'\", disk->bitmap);\n        if (flags & VIR_DOMAIN_CHECKPOINT_FORMAT_SIZE)\n            virBufferAsprintf(buf, \" size='%llu'\", disk->size);\n    }\n    virBufferAddLit(buf, \"/>\\n\");\n    return 0;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virbitmap.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic int\nvirDomainCheckpointDiskDefFormat(virBufferPtr buf,\n                                 virDomainCheckpointDiskDefPtr disk,\n                                 unsigned int flags)\n{\n    if (!disk->name)\n        return 0;\n\n    virBufferEscapeString(buf, \"<disk name='%s'\", disk->name);\n    if (disk->type)\n        virBufferAsprintf(buf, \" checkpoint='%s'\",\n                          virDomainCheckpointTypeToString(disk->type));\n    if (disk->bitmap) {\n        virBufferEscapeString(buf, \" bitmap='%s'\", disk->bitmap);\n        if (flags & VIR_DOMAIN_CHECKPOINT_FORMAT_SIZE)\n            virBufferAsprintf(buf, \" size='%llu'\", disk->size);\n    }\n    virBufferAddLit(buf, \"/>\\n\");\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<disks>\\n\""
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<creationTime>%lld</creationTime>\\n\"",
            "def->parent.creationTime"
          ],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</parent>\\n\""
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\"<name>%s</name>\\n\"",
            "def->parent.parent_name"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<parent>\\n\""
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<domaincheckpoint>\\n\""
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic int\nvirDomainCheckpointDefFormatInternal(virBufferPtr buf,\n                                     virDomainCheckpointDefPtr def,\n                                     virDomainXMLOptionPtr xmlopt,\n                                     unsigned int flags)\n{\n    size_t i;\n    unsigned int domainflags = VIR_DOMAIN_DEF_FORMAT_INACTIVE;\n\n    if (flags & VIR_DOMAIN_CHECKPOINT_FORMAT_SECURE)\n        domainflags |= VIR_DOMAIN_DEF_FORMAT_SECURE;\n\n    virBufferAddLit(buf, \"<domaincheckpoint>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->parent.name);\n    virBufferEscapeString(buf, \"<description>%s</description>\\n\",\n                          def->parent.description);\n\n    if (def->parent.parent_name) {\n        virBufferAddLit(buf, \"<parent>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferEscapeString(buf, \"<name>%s</name>\\n\",\n                              def->parent.parent_name);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</parent>\\n\");\n    }\n\n    if (def->parent.creationTime)\n        virBufferAsprintf(buf, \"<creationTime>%lld</creationTime>\\n\",\n                          def->parent.creationTime);\n\n    if (def->ndisks) {\n        virBufferAddLit(buf, \"<disks>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        for (i = 0; i < def->ndisks; i++) {\n            if (virDomainCheckpointDiskDefFormat(buf, &def->disks[i],\n                                                 flags) < 0)\n                goto error;\n        }\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</disks>\\n\");\n    }\n\n    if (!(flags & VIR_DOMAIN_CHECKPOINT_FORMAT_NO_DOMAIN) &&\n        virDomainDefFormatInternal(def->parent.dom, xmlopt,\n                                   buf, domainflags) < 0)\n        goto error;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</domaincheckpoint>\\n\");\n\n    return 0;\n\n error:\n    virBufferFreeAndReset(buf);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainCheckpointDiskDefFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
    "lines": "419-438",
    "snippet": "static int\nvirDomainCheckpointDiskDefFormat(virBufferPtr buf,\n                                 virDomainCheckpointDiskDefPtr disk,\n                                 unsigned int flags)\n{\n    if (!disk->name)\n        return 0;\n\n    virBufferEscapeString(buf, \"<disk name='%s'\", disk->name);\n    if (disk->type)\n        virBufferAsprintf(buf, \" checkpoint='%s'\",\n                          virDomainCheckpointTypeToString(disk->type));\n    if (disk->bitmap) {\n        virBufferEscapeString(buf, \" bitmap='%s'\", disk->bitmap);\n        if (flags & VIR_DOMAIN_CHECKPOINT_FORMAT_SIZE)\n            virBufferAsprintf(buf, \" size='%llu'\", disk->size);\n    }\n    virBufferAddLit(buf, \"/>\\n\");\n    return 0;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virstring.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virbitmap.h\"",
      "#include \"internal.h\"",
      "#include \"configmake.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"/>\\n\""
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\" size='%llu'\"",
            "disk->size"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\" bitmap='%s'\"",
            "disk->bitmap"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCheckpointTypeToString",
          "args": [
            "disk->type"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic int\nvirDomainCheckpointDiskDefFormat(virBufferPtr buf,\n                                 virDomainCheckpointDiskDefPtr disk,\n                                 unsigned int flags)\n{\n    if (!disk->name)\n        return 0;\n\n    virBufferEscapeString(buf, \"<disk name='%s'\", disk->name);\n    if (disk->type)\n        virBufferAsprintf(buf, \" checkpoint='%s'\",\n                          virDomainCheckpointTypeToString(disk->type));\n    if (disk->bitmap) {\n        virBufferEscapeString(buf, \" bitmap='%s'\", disk->bitmap);\n        if (flags & VIR_DOMAIN_CHECKPOINT_FORMAT_SIZE)\n            virBufferAsprintf(buf, \" size='%llu'\", disk->size);\n    }\n    virBufferAddLit(buf, \"/>\\n\");\n    return 0;\n}"
  },
  {
    "function_name": "virDomainCheckpointFormatConvertXMLFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
    "lines": "404-416",
    "snippet": "unsigned int virDomainCheckpointFormatConvertXMLFlags(unsigned int flags)\n{\n    unsigned int formatFlags = 0;\n\n    if (flags & VIR_DOMAIN_CHECKPOINT_XML_SECURE)\n        formatFlags |= VIR_DOMAIN_CHECKPOINT_FORMAT_SECURE;\n    if (flags & VIR_DOMAIN_CHECKPOINT_XML_NO_DOMAIN)\n        formatFlags |= VIR_DOMAIN_CHECKPOINT_FORMAT_NO_DOMAIN;\n    if (flags & VIR_DOMAIN_CHECKPOINT_XML_SIZE)\n        formatFlags |= VIR_DOMAIN_CHECKPOINT_FORMAT_SIZE;\n\n    return formatFlags;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virstring.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virbitmap.h\"",
      "#include \"internal.h\"",
      "#include \"configmake.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nunsigned int virDomainCheckpointFormatConvertXMLFlags(unsigned int flags)\n{\n    unsigned int formatFlags = 0;\n\n    if (flags & VIR_DOMAIN_CHECKPOINT_XML_SECURE)\n        formatFlags |= VIR_DOMAIN_CHECKPOINT_FORMAT_SECURE;\n    if (flags & VIR_DOMAIN_CHECKPOINT_XML_NO_DOMAIN)\n        formatFlags |= VIR_DOMAIN_CHECKPOINT_FORMAT_NO_DOMAIN;\n    if (flags & VIR_DOMAIN_CHECKPOINT_XML_SIZE)\n        formatFlags |= VIR_DOMAIN_CHECKPOINT_FORMAT_SIZE;\n\n    return formatFlags;\n}"
  },
  {
    "function_name": "virDomainCheckpointAlignDisks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
    "lines": "292-398",
    "snippet": "int\nvirDomainCheckpointAlignDisks(virDomainCheckpointDefPtr def)\n{\n    int ret = -1;\n    virBitmapPtr map = NULL;\n    size_t i;\n    int ndisks;\n    int checkpoint_default = VIR_DOMAIN_CHECKPOINT_TYPE_NONE;\n\n    if (!def->parent.dom) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing domain in checkpoint\"));\n        goto cleanup;\n    }\n\n    if (def->ndisks > def->parent.dom->ndisks) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"too many disk checkpoint requests for domain\"));\n        goto cleanup;\n    }\n\n    /* Unlikely to have a guest without disks but technically possible.  */\n    if (!def->parent.dom->ndisks) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"domain must have at least one disk to perform \"\n                         \"checkpoints\"));\n        goto cleanup;\n    }\n\n    /* If <disks> omitted, do bitmap on all writeable disks;\n     * otherwise, do nothing for omitted disks */\n    if (!def->ndisks)\n        checkpoint_default = VIR_DOMAIN_CHECKPOINT_TYPE_BITMAP;\n\n    if (!(map = virBitmapNew(def->parent.dom->ndisks)))\n        goto cleanup;\n\n    /* Double check requested disks.  */\n    for (i = 0; i < def->ndisks; i++) {\n        virDomainCheckpointDiskDefPtr disk = &def->disks[i];\n        int idx = virDomainDiskIndexByName(def->parent.dom, disk->name, false);\n\n        if (idx < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"no disk named '%s'\"), disk->name);\n            goto cleanup;\n        }\n\n        if (virBitmapIsBitSet(map, idx)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"disk '%s' specified twice\"),\n                           disk->name);\n            goto cleanup;\n        }\n        if ((virStorageSourceIsEmpty(def->parent.dom->disks[idx]->src) ||\n             def->parent.dom->disks[idx]->src->readonly) &&\n            disk->type != VIR_DOMAIN_CHECKPOINT_TYPE_NONE) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"disk '%s' is empty or readonly\"),\n                           disk->name);\n            goto cleanup;\n        }\n        ignore_value(virBitmapSetBit(map, idx));\n        disk->idx = idx;\n\n        if (STRNEQ(disk->name, def->parent.dom->disks[idx]->dst)) {\n            VIR_FREE(disk->name);\n            disk->name = g_strdup(def->parent.dom->disks[idx]->dst);\n        }\n    }\n\n    /* Provide defaults for all remaining disks.  */\n    ndisks = def->ndisks;\n    if (VIR_EXPAND_N(def->disks, def->ndisks,\n                     def->parent.dom->ndisks - def->ndisks) < 0)\n        goto cleanup;\n\n    for (i = 0; i < def->parent.dom->ndisks; i++) {\n        virDomainCheckpointDiskDefPtr disk;\n\n        if (virBitmapIsBitSet(map, i))\n            continue;\n        disk = &def->disks[ndisks++];\n        disk->name = g_strdup(def->parent.dom->disks[i]->dst);\n        disk->idx = i;\n\n        /* Don't checkpoint empty or readonly drives */\n        if (virStorageSourceIsEmpty(def->parent.dom->disks[i]->src) ||\n            def->parent.dom->disks[i]->src->readonly)\n            disk->type = VIR_DOMAIN_CHECKPOINT_TYPE_NONE;\n        else\n            disk->type = checkpoint_default;\n    }\n\n    qsort(&def->disks[0], def->ndisks, sizeof(def->disks[0]),\n          virDomainCheckpointCompareDiskIndex);\n\n    /* Generate default bitmap names for checkpoint */\n    if (virDomainCheckpointDefAssignBitmapNames(def) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virBitmapFree(map);\n    return ret;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virstring.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virbitmap.h\"",
      "#include \"internal.h\"",
      "#include \"configmake.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBitmapFree",
          "args": [
            "map"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "128-135",
          "snippet": "void\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCheckpointDefAssignBitmapNames",
          "args": [
            "def"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCheckpointDefAssignBitmapNames",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
          "lines": "258-274",
          "snippet": "static int\nvirDomainCheckpointDefAssignBitmapNames(virDomainCheckpointDefPtr def)\n{\n    size_t i;\n\n    for (i = 0; i < def->ndisks; i++) {\n        virDomainCheckpointDiskDefPtr disk = &def->disks[i];\n\n        if (disk->type != VIR_DOMAIN_CHECKPOINT_TYPE_BITMAP ||\n            disk->bitmap)\n            continue;\n\n        disk->bitmap = g_strdup(def->parent.name);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virbitmap.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic int\nvirDomainCheckpointDefAssignBitmapNames(virDomainCheckpointDefPtr def)\n{\n    size_t i;\n\n    for (i = 0; i < def->ndisks; i++) {\n        virDomainCheckpointDiskDefPtr disk = &def->disks[i];\n\n        if (disk->type != VIR_DOMAIN_CHECKPOINT_TYPE_BITMAP ||\n            disk->bitmap)\n            continue;\n\n        disk->bitmap = g_strdup(def->parent.name);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qsort",
          "args": [
            "&def->disks[0]",
            "def->ndisks",
            "sizeof(def->disks[0])",
            "virDomainCheckpointCompareDiskIndex"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsEmpty",
          "args": [
            "def->parent.dom->disks[i]->src"
          ],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsEmpty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2619-2633",
          "snippet": "bool\nvirStorageSourceIsEmpty(virStorageSourcePtr src)\n{\n    if (virStorageSourceIsLocalStorage(src) && !src->path)\n        return true;\n\n    if (src->type == VIR_STORAGE_TYPE_NONE)\n        return true;\n\n    if (src->type == VIR_STORAGE_TYPE_NETWORK &&\n        src->protocol == VIR_STORAGE_NET_PROTOCOL_NONE)\n        return true;\n\n    return false;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsEmpty(virStorageSourcePtr src)\n{\n    if (virStorageSourceIsLocalStorage(src) && !src->path)\n        return true;\n\n    if (src->type == VIR_STORAGE_TYPE_NONE)\n        return true;\n\n    if (src->type == VIR_STORAGE_TYPE_NETWORK &&\n        src->protocol == VIR_STORAGE_NET_PROTOCOL_NONE)\n        return true;\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "def->parent.dom->disks[i]->dst"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapIsBitSet",
          "args": [
            "map",
            "i"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapIsBitSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "298-306",
          "snippet": "bool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "def->disks",
            "def->ndisks",
            "def->parent.dom->ndisks - def->ndisks"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "disk->name"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "disk->name",
            "def->parent.dom->disks[idx]->dst"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapSetBit(map, idx)"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "map",
            "idx"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"disk '%s' is empty or readonly\")",
            "disk->name"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"disk '%s' is empty or readonly\""
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"disk '%s' specified twice\")",
            "disk->name"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"no disk named '%s'\")",
            "disk->name"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskIndexByName",
          "args": [
            "def->parent.dom",
            "disk->name",
            "false"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskIndexByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17299-17325",
          "snippet": "int\nvirDomainDiskIndexByName(virDomainDefPtr def, const char *name,\n                         bool allow_ambiguous)\n{\n    virDomainDiskDefPtr vdisk;\n    size_t i;\n    int candidate = -1;\n\n    /* We prefer the <target dev='name'/> name (it's shorter, required\n     * for all disks, and should be unambiguous), but also support\n     * <source file='name'/> (if unambiguous).  Assume dst if there is\n     * no leading slash, source name otherwise.  */\n    for (i = 0; i < def->ndisks; i++) {\n        vdisk = def->disks[i];\n        if (*name != '/') {\n            if (STREQ(vdisk->dst, name))\n                return i;\n        } else if (STREQ_NULLABLE(virDomainDiskGetSource(vdisk), name)) {\n            if (allow_ambiguous)\n                return i;\n            if (candidate >= 0)\n                return -1;\n            candidate = i;\n        }\n    }\n    return candidate;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDiskIndexByName(virDomainDefPtr def, const char *name,\n                         bool allow_ambiguous)\n{\n    virDomainDiskDefPtr vdisk;\n    size_t i;\n    int candidate = -1;\n\n    /* We prefer the <target dev='name'/> name (it's shorter, required\n     * for all disks, and should be unambiguous), but also support\n     * <source file='name'/> (if unambiguous).  Assume dst if there is\n     * no leading slash, source name otherwise.  */\n    for (i = 0; i < def->ndisks; i++) {\n        vdisk = def->disks[i];\n        if (*name != '/') {\n            if (STREQ(vdisk->dst, name))\n                return i;\n        } else if (STREQ_NULLABLE(virDomainDiskGetSource(vdisk), name)) {\n            if (allow_ambiguous)\n                return i;\n            if (candidate >= 0)\n                return -1;\n            candidate = i;\n        }\n    }\n    return candidate;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapNew",
          "args": [
            "def->parent.dom->ndisks"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1144-1168",
          "snippet": "virBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"domain must have at least one disk to perform \"\n                         \"checkpoints\")"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"too many disk checkpoint requests for domain\")"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"missing domain in checkpoint\")"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nint\nvirDomainCheckpointAlignDisks(virDomainCheckpointDefPtr def)\n{\n    int ret = -1;\n    virBitmapPtr map = NULL;\n    size_t i;\n    int ndisks;\n    int checkpoint_default = VIR_DOMAIN_CHECKPOINT_TYPE_NONE;\n\n    if (!def->parent.dom) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing domain in checkpoint\"));\n        goto cleanup;\n    }\n\n    if (def->ndisks > def->parent.dom->ndisks) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"too many disk checkpoint requests for domain\"));\n        goto cleanup;\n    }\n\n    /* Unlikely to have a guest without disks but technically possible.  */\n    if (!def->parent.dom->ndisks) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"domain must have at least one disk to perform \"\n                         \"checkpoints\"));\n        goto cleanup;\n    }\n\n    /* If <disks> omitted, do bitmap on all writeable disks;\n     * otherwise, do nothing for omitted disks */\n    if (!def->ndisks)\n        checkpoint_default = VIR_DOMAIN_CHECKPOINT_TYPE_BITMAP;\n\n    if (!(map = virBitmapNew(def->parent.dom->ndisks)))\n        goto cleanup;\n\n    /* Double check requested disks.  */\n    for (i = 0; i < def->ndisks; i++) {\n        virDomainCheckpointDiskDefPtr disk = &def->disks[i];\n        int idx = virDomainDiskIndexByName(def->parent.dom, disk->name, false);\n\n        if (idx < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"no disk named '%s'\"), disk->name);\n            goto cleanup;\n        }\n\n        if (virBitmapIsBitSet(map, idx)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"disk '%s' specified twice\"),\n                           disk->name);\n            goto cleanup;\n        }\n        if ((virStorageSourceIsEmpty(def->parent.dom->disks[idx]->src) ||\n             def->parent.dom->disks[idx]->src->readonly) &&\n            disk->type != VIR_DOMAIN_CHECKPOINT_TYPE_NONE) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"disk '%s' is empty or readonly\"),\n                           disk->name);\n            goto cleanup;\n        }\n        ignore_value(virBitmapSetBit(map, idx));\n        disk->idx = idx;\n\n        if (STRNEQ(disk->name, def->parent.dom->disks[idx]->dst)) {\n            VIR_FREE(disk->name);\n            disk->name = g_strdup(def->parent.dom->disks[idx]->dst);\n        }\n    }\n\n    /* Provide defaults for all remaining disks.  */\n    ndisks = def->ndisks;\n    if (VIR_EXPAND_N(def->disks, def->ndisks,\n                     def->parent.dom->ndisks - def->ndisks) < 0)\n        goto cleanup;\n\n    for (i = 0; i < def->parent.dom->ndisks; i++) {\n        virDomainCheckpointDiskDefPtr disk;\n\n        if (virBitmapIsBitSet(map, i))\n            continue;\n        disk = &def->disks[ndisks++];\n        disk->name = g_strdup(def->parent.dom->disks[i]->dst);\n        disk->idx = i;\n\n        /* Don't checkpoint empty or readonly drives */\n        if (virStorageSourceIsEmpty(def->parent.dom->disks[i]->src) ||\n            def->parent.dom->disks[i]->src->readonly)\n            disk->type = VIR_DOMAIN_CHECKPOINT_TYPE_NONE;\n        else\n            disk->type = checkpoint_default;\n    }\n\n    qsort(&def->disks[0], def->ndisks, sizeof(def->disks[0]),\n          virDomainCheckpointCompareDiskIndex);\n\n    /* Generate default bitmap names for checkpoint */\n    if (virDomainCheckpointDefAssignBitmapNames(def) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virBitmapFree(map);\n    return ret;\n}"
  },
  {
    "function_name": "virDomainCheckpointCompareDiskIndex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
    "lines": "277-285",
    "snippet": "static int\nvirDomainCheckpointCompareDiskIndex(const void *a, const void *b)\n{\n    const virDomainCheckpointDiskDef *diska = a;\n    const virDomainCheckpointDiskDef *diskb = b;\n\n    /* Integer overflow shouldn't be a problem here.  */\n    return diska->idx - diskb->idx;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virstring.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virbitmap.h\"",
      "#include \"internal.h\"",
      "#include \"configmake.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic int\nvirDomainCheckpointCompareDiskIndex(const void *a, const void *b)\n{\n    const virDomainCheckpointDiskDef *diska = a;\n    const virDomainCheckpointDiskDef *diskb = b;\n\n    /* Integer overflow shouldn't be a problem here.  */\n    return diska->idx - diskb->idx;\n}"
  },
  {
    "function_name": "virDomainCheckpointDefAssignBitmapNames",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
    "lines": "258-274",
    "snippet": "static int\nvirDomainCheckpointDefAssignBitmapNames(virDomainCheckpointDefPtr def)\n{\n    size_t i;\n\n    for (i = 0; i < def->ndisks; i++) {\n        virDomainCheckpointDiskDefPtr disk = &def->disks[i];\n\n        if (disk->type != VIR_DOMAIN_CHECKPOINT_TYPE_BITMAP ||\n            disk->bitmap)\n            continue;\n\n        disk->bitmap = g_strdup(def->parent.name);\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virstring.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virbitmap.h\"",
      "#include \"internal.h\"",
      "#include \"configmake.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "def->parent.name"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic int\nvirDomainCheckpointDefAssignBitmapNames(virDomainCheckpointDefPtr def)\n{\n    size_t i;\n\n    for (i = 0; i < def->ndisks; i++) {\n        virDomainCheckpointDiskDefPtr disk = &def->disks[i];\n\n        if (disk->type != VIR_DOMAIN_CHECKPOINT_TYPE_BITMAP ||\n            disk->bitmap)\n            continue;\n\n        disk->bitmap = g_strdup(def->parent.name);\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virDomainCheckpointDefParseString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
    "lines": "229-248",
    "snippet": "virDomainCheckpointDefPtr\nvirDomainCheckpointDefParseString(const char *xmlStr,\n                                  virDomainXMLOptionPtr xmlopt,\n                                  void *parseOpaque,\n                                  unsigned int flags)\n{\n    virDomainCheckpointDefPtr ret = NULL;\n    xmlDocPtr xml;\n    int keepBlanksDefault = xmlKeepBlanksDefault(0);\n\n    if ((xml = virXMLParse(NULL, xmlStr, _(\"(domain_checkpoint)\")))) {\n        xmlKeepBlanksDefault(keepBlanksDefault);\n        ret = virDomainCheckpointDefParseNode(xml, xmlDocGetRootElement(xml),\n                                              xmlopt, parseOpaque, flags);\n        xmlFreeDoc(xml);\n    }\n    xmlKeepBlanksDefault(keepBlanksDefault);\n\n    return ret;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virstring.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virbitmap.h\"",
      "#include \"internal.h\"",
      "#include \"configmake.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlKeepBlanksDefault",
          "args": [
            "keepBlanksDefault"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlFreeDoc",
          "args": [
            "xml"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainCheckpointDefParseNode",
          "args": [
            "xml",
            "xmlDocGetRootElement(xml)",
            "xmlopt",
            "parseOpaque",
            "flags"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCheckpointDefParseNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
          "lines": "198-227",
          "snippet": "static virDomainCheckpointDefPtr\nvirDomainCheckpointDefParseNode(xmlDocPtr xml,\n                                xmlNodePtr root,\n                                virDomainXMLOptionPtr xmlopt,\n                                void *parseOpaque,\n                                unsigned int flags)\n{\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autofree char *schema = NULL;\n\n    if (!virXMLNodeNameEqual(root, \"domaincheckpoint\")) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\", _(\"domaincheckpoint\"));\n        return NULL;\n    }\n\n    /* This is a new enough API to make schema validation unconditional */\n    schema = virFileFindResource(\"domaincheckpoint.rng\",\n                                 abs_top_srcdir \"/docs/schemas\",\n                                 PKGDATADIR \"/schemas\");\n    if (!schema)\n        return NULL;\n    if (virXMLValidateAgainstSchema(schema, xml) < 0)\n        return NULL;\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        return NULL;\n\n    ctxt->node = root;\n    return virDomainCheckpointDefParse(ctxt, xmlopt, parseOpaque, flags);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virbitmap.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic virDomainCheckpointDefPtr\nvirDomainCheckpointDefParseNode(xmlDocPtr xml,\n                                xmlNodePtr root,\n                                virDomainXMLOptionPtr xmlopt,\n                                void *parseOpaque,\n                                unsigned int flags)\n{\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autofree char *schema = NULL;\n\n    if (!virXMLNodeNameEqual(root, \"domaincheckpoint\")) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\", _(\"domaincheckpoint\"));\n        return NULL;\n    }\n\n    /* This is a new enough API to make schema validation unconditional */\n    schema = virFileFindResource(\"domaincheckpoint.rng\",\n                                 abs_top_srcdir \"/docs/schemas\",\n                                 PKGDATADIR \"/schemas\");\n    if (!schema)\n        return NULL;\n    if (virXMLValidateAgainstSchema(schema, xml) < 0)\n        return NULL;\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        return NULL;\n\n    ctxt->node = root;\n    return virDomainCheckpointDefParse(ctxt, xmlopt, parseOpaque, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlDocGetRootElement",
          "args": [
            "xml"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlKeepBlanksDefault",
          "args": [
            "keepBlanksDefault"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLParse",
          "args": [
            "NULL",
            "xmlStr",
            "_(\"(domain_checkpoint)\")"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"(domain_checkpoint)\""
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlKeepBlanksDefault",
          "args": [
            "0"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nvirDomainCheckpointDefPtr\nvirDomainCheckpointDefParseString(const char *xmlStr,\n                                  virDomainXMLOptionPtr xmlopt,\n                                  void *parseOpaque,\n                                  unsigned int flags)\n{\n    virDomainCheckpointDefPtr ret = NULL;\n    xmlDocPtr xml;\n    int keepBlanksDefault = xmlKeepBlanksDefault(0);\n\n    if ((xml = virXMLParse(NULL, xmlStr, _(\"(domain_checkpoint)\")))) {\n        xmlKeepBlanksDefault(keepBlanksDefault);\n        ret = virDomainCheckpointDefParseNode(xml, xmlDocGetRootElement(xml),\n                                              xmlopt, parseOpaque, flags);\n        xmlFreeDoc(xml);\n    }\n    xmlKeepBlanksDefault(keepBlanksDefault);\n\n    return ret;\n}"
  },
  {
    "function_name": "virDomainCheckpointDefParseNode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
    "lines": "198-227",
    "snippet": "static virDomainCheckpointDefPtr\nvirDomainCheckpointDefParseNode(xmlDocPtr xml,\n                                xmlNodePtr root,\n                                virDomainXMLOptionPtr xmlopt,\n                                void *parseOpaque,\n                                unsigned int flags)\n{\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autofree char *schema = NULL;\n\n    if (!virXMLNodeNameEqual(root, \"domaincheckpoint\")) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\", _(\"domaincheckpoint\"));\n        return NULL;\n    }\n\n    /* This is a new enough API to make schema validation unconditional */\n    schema = virFileFindResource(\"domaincheckpoint.rng\",\n                                 abs_top_srcdir \"/docs/schemas\",\n                                 PKGDATADIR \"/schemas\");\n    if (!schema)\n        return NULL;\n    if (virXMLValidateAgainstSchema(schema, xml) < 0)\n        return NULL;\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        return NULL;\n\n    ctxt->node = root;\n    return virDomainCheckpointDefParse(ctxt, xmlopt, parseOpaque, flags);\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virstring.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virbitmap.h\"",
      "#include \"internal.h\"",
      "#include \"configmake.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainCheckpointDefParse",
          "args": [
            "ctxt",
            "xmlopt",
            "parseOpaque",
            "flags"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCheckpointDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
          "lines": "229-248",
          "snippet": "virDomainCheckpointDefPtr\nvirDomainCheckpointDefParseString(const char *xmlStr,\n                                  virDomainXMLOptionPtr xmlopt,\n                                  void *parseOpaque,\n                                  unsigned int flags)\n{\n    virDomainCheckpointDefPtr ret = NULL;\n    xmlDocPtr xml;\n    int keepBlanksDefault = xmlKeepBlanksDefault(0);\n\n    if ((xml = virXMLParse(NULL, xmlStr, _(\"(domain_checkpoint)\")))) {\n        xmlKeepBlanksDefault(keepBlanksDefault);\n        ret = virDomainCheckpointDefParseNode(xml, xmlDocGetRootElement(xml),\n                                              xmlopt, parseOpaque, flags);\n        xmlFreeDoc(xml);\n    }\n    xmlKeepBlanksDefault(keepBlanksDefault);\n\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virbitmap.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nvirDomainCheckpointDefPtr\nvirDomainCheckpointDefParseString(const char *xmlStr,\n                                  virDomainXMLOptionPtr xmlopt,\n                                  void *parseOpaque,\n                                  unsigned int flags)\n{\n    virDomainCheckpointDefPtr ret = NULL;\n    xmlDocPtr xml;\n    int keepBlanksDefault = xmlKeepBlanksDefault(0);\n\n    if ((xml = virXMLParse(NULL, xmlStr, _(\"(domain_checkpoint)\")))) {\n        xmlKeepBlanksDefault(keepBlanksDefault);\n        ret = virDomainCheckpointDefParseNode(xml, xmlDocGetRootElement(xml),\n                                              xmlopt, parseOpaque, flags);\n        xmlFreeDoc(xml);\n    }\n    xmlKeepBlanksDefault(keepBlanksDefault);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLXPathContextNew",
          "args": [
            "xml"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLXPathContextNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "48-59",
          "snippet": "xmlXPathContextPtr\nvirXMLXPathContextNew(xmlDocPtr xml)\n{\n    xmlXPathContextPtr ctxt;\n\n    if (!(ctxt = xmlXPathNewContext(xml))) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    return ctxt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlXPathContextPtr\nvirXMLXPathContextNew(xmlDocPtr xml)\n{\n    xmlXPathContextPtr ctxt;\n\n    if (!(ctxt = xmlXPathNewContext(xml))) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    return ctxt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLValidateAgainstSchema",
          "args": [
            "schema",
            "xml"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLValidateAgainstSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1325-1342",
          "snippet": "int\nvirXMLValidateAgainstSchema(const char *schemafile,\n                            xmlDocPtr doc)\n{\n    virXMLValidatorPtr validator = NULL;\n    int ret = -1;\n\n    if (!(validator = virXMLValidatorInit(schemafile)))\n        return -1;\n\n    if (virXMLValidatorValidate(validator, doc) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virXMLValidatorFree(validator);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXMLValidateAgainstSchema(const char *schemafile,\n                            xmlDocPtr doc)\n{\n    virXMLValidatorPtr validator = NULL;\n    int ret = -1;\n\n    if (!(validator = virXMLValidatorInit(schemafile)))\n        return -1;\n\n    if (virXMLValidatorValidate(validator, doc) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virXMLValidatorFree(validator);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileFindResource",
          "args": [
            "\"domaincheckpoint.rng\"",
            "abs_top_srcdir \"/docs/schemas\"",
            "PKGDATADIR \"/schemas\""
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFindResource",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1771-1777",
          "snippet": "char *\nvirFileFindResource(const char *filename,\n                    const char *builddir,\n                    const char *installdir)\n{\n    return virFileFindResourceFull(filename, NULL, NULL, builddir, installdir, NULL);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileFindResource(const char *filename,\n                    const char *builddir,\n                    const char *installdir)\n{\n    return virFileFindResourceFull(filename, NULL, NULL, builddir, installdir, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"domaincheckpoint\")"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"domaincheckpoint\""
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLNodeNameEqual",
          "args": [
            "root",
            "\"domaincheckpoint\""
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLNodeNameEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1013-1018",
          "snippet": "bool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nbool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic virDomainCheckpointDefPtr\nvirDomainCheckpointDefParseNode(xmlDocPtr xml,\n                                xmlNodePtr root,\n                                virDomainXMLOptionPtr xmlopt,\n                                void *parseOpaque,\n                                unsigned int flags)\n{\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autofree char *schema = NULL;\n\n    if (!virXMLNodeNameEqual(root, \"domaincheckpoint\")) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\", _(\"domaincheckpoint\"));\n        return NULL;\n    }\n\n    /* This is a new enough API to make schema validation unconditional */\n    schema = virFileFindResource(\"domaincheckpoint.rng\",\n                                 abs_top_srcdir \"/docs/schemas\",\n                                 PKGDATADIR \"/schemas\");\n    if (!schema)\n        return NULL;\n    if (virXMLValidateAgainstSchema(schema, xml) < 0)\n        return NULL;\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        return NULL;\n\n    ctxt->node = root;\n    return virDomainCheckpointDefParse(ctxt, xmlopt, parseOpaque, flags);\n}"
  },
  {
    "function_name": "virDomainCheckpointDefParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
    "lines": "120-196",
    "snippet": "static virDomainCheckpointDefPtr\nvirDomainCheckpointDefParse(xmlXPathContextPtr ctxt,\n                            virDomainXMLOptionPtr xmlopt,\n                            void *parseOpaque,\n                            unsigned int flags)\n{\n    virDomainCheckpointDefPtr ret = NULL;\n    size_t i;\n    int n;\n    char *tmp;\n    g_autofree xmlNodePtr *nodes = NULL;\n    g_autoptr(virDomainCheckpointDef) def = NULL;\n\n    if (!(def = virDomainCheckpointDefNew()))\n        return NULL;\n\n    def->parent.name = virXPathString(\"string(./name)\", ctxt);\n\n    if (def->parent.name == NULL) {\n        if (flags & VIR_DOMAIN_CHECKPOINT_PARSE_REDEFINE) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"a redefined checkpoint must have a name\"));\n            return NULL;\n        }\n    }\n\n    def->parent.description = virXPathString(\"string(./description)\", ctxt);\n\n    if (flags & VIR_DOMAIN_CHECKPOINT_PARSE_REDEFINE) {\n        if (virXPathLongLong(\"string(./creationTime)\", ctxt,\n                             &def->parent.creationTime) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"missing creationTime from existing checkpoint\"));\n            return NULL;\n        }\n\n        def->parent.parent_name = virXPathString(\"string(./parent/name)\", ctxt);\n\n        if ((tmp = virXPathString(\"string(./domain/@type)\", ctxt))) {\n            int domainflags = VIR_DOMAIN_DEF_PARSE_INACTIVE |\n                              VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE;\n            xmlNodePtr domainNode = virXPathNode(\"./domain\", ctxt);\n\n            VIR_FREE(tmp);\n            if (!domainNode) {\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"missing domain in checkpoint\"));\n                return NULL;\n            }\n            def->parent.dom = virDomainDefParseNode(ctxt->node->doc, domainNode,\n                                                    xmlopt, parseOpaque,\n                                                    domainflags);\n            if (!def->parent.dom)\n                return NULL;\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"missing domain in checkpoint redefine\"));\n            return NULL;\n        }\n    } else if (virDomainXMLOptionRunMomentPostParse(xmlopt, &def->parent) < 0) {\n        return NULL;\n    }\n\n    if ((n = virXPathNodeSet(\"./disks/*\", ctxt, &nodes)) < 0)\n        return NULL;\n    if (n && VIR_ALLOC_N(def->disks, n) < 0)\n        return NULL;\n    def->ndisks = n;\n    for (i = 0; i < def->ndisks; i++) {\n        if (virDomainCheckpointDiskDefParseXML(nodes[i], ctxt,\n                                               &def->disks[i]) < 0)\n            return NULL;\n    }\n\n    ret = g_steal_pointer(&def);\n    return ret;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virstring.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virbitmap.h\"",
      "#include \"internal.h\"",
      "#include \"configmake.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&def"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainCheckpointDiskDefParseXML",
          "args": [
            "nodes[i]",
            "ctxt",
            "&def->disks[i]"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCheckpointDiskDefParseXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
          "lines": "93-116",
          "snippet": "static int\nvirDomainCheckpointDiskDefParseXML(xmlNodePtr node,\n                                   xmlXPathContextPtr ctxt,\n                                   virDomainCheckpointDiskDefPtr def)\n{\n    g_autofree char *checkpoint = NULL;\n    VIR_XPATH_NODE_AUTORESTORE(ctxt);\n\n    ctxt->node = node;\n\n    /* Schema guarantees this is non-NULL: */\n    def->name = virXMLPropString(node, \"name\");\n\n    checkpoint = virXMLPropString(node, \"checkpoint\");\n    if (checkpoint)\n        /* Schema guarantees this is in range: */\n        def->type = virDomainCheckpointTypeFromString(checkpoint);\n    else\n        def->type = VIR_DOMAIN_CHECKPOINT_TYPE_BITMAP;\n\n    def->bitmap = virXMLPropString(node, \"bitmap\");\n\n    return 0;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virbitmap.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic int\nvirDomainCheckpointDiskDefParseXML(xmlNodePtr node,\n                                   xmlXPathContextPtr ctxt,\n                                   virDomainCheckpointDiskDefPtr def)\n{\n    g_autofree char *checkpoint = NULL;\n    VIR_XPATH_NODE_AUTORESTORE(ctxt);\n\n    ctxt->node = node;\n\n    /* Schema guarantees this is non-NULL: */\n    def->name = virXMLPropString(node, \"name\");\n\n    checkpoint = virXMLPropString(node, \"checkpoint\");\n    if (checkpoint)\n        /* Schema guarantees this is in range: */\n        def->type = virDomainCheckpointTypeFromString(checkpoint);\n    else\n        def->type = VIR_DOMAIN_CHECKPOINT_TYPE_BITMAP;\n\n    def->bitmap = virXMLPropString(node, \"bitmap\");\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "def->disks",
            "n"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXPathNodeSet",
          "args": [
            "\"./disks/*\"",
            "ctxt",
            "&nodes"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNodeSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "647-694",
          "snippet": "int\nvirXPathNodeSet(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                xmlNodePtr **list)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNodeSet()\"));\n        return -1;\n    }\n\n    if (list != NULL)\n        *list = NULL;\n\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if (obj == NULL)\n        return 0;\n\n    if (obj->type != XPATH_NODESET) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Incorrect xpath '%s'\"), xpath);\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    if ((obj->nodesetval == NULL)  || (obj->nodesetval->nodeNr < 0)) {\n        xmlXPathFreeObject(obj);\n        return 0;\n    }\n\n    ret = obj->nodesetval->nodeNr;\n    if (list != NULL && ret) {\n        if (VIR_ALLOC_N(*list, ret) < 0) {\n            ret = -1;\n        } else {\n            memcpy(*list, obj->nodesetval->nodeTab,\n                   ret * sizeof(xmlNodePtr));\n        }\n    }\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathNodeSet(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                xmlNodePtr **list)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNodeSet()\"));\n        return -1;\n    }\n\n    if (list != NULL)\n        *list = NULL;\n\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if (obj == NULL)\n        return 0;\n\n    if (obj->type != XPATH_NODESET) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Incorrect xpath '%s'\"), xpath);\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    if ((obj->nodesetval == NULL)  || (obj->nodesetval->nodeNr < 0)) {\n        xmlXPathFreeObject(obj);\n        return 0;\n    }\n\n    ret = obj->nodesetval->nodeNr;\n    if (list != NULL && ret) {\n        if (VIR_ALLOC_N(*list, ret) < 0) {\n            ret = -1;\n        } else {\n            memcpy(*list, obj->nodesetval->nodeTab,\n                   ret * sizeof(xmlNodePtr));\n        }\n    }\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainXMLOptionRunMomentPostParse",
          "args": [
            "xmlopt",
            "&def->parent"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainXMLOptionRunMomentPostParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1528-1535",
          "snippet": "int\nvirDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                     virDomainMomentDefPtr def)\n{\n    if (!xmlopt->momentPostParse)\n        return virDomainMomentDefPostParse(def);\n    return xmlopt->momentPostParse(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                     virDomainMomentDefPtr def)\n{\n    if (!xmlopt->momentPostParse)\n        return virDomainMomentDefPostParse(def);\n    return xmlopt->momentPostParse(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"missing domain in checkpoint redefine\")"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"missing domain in checkpoint redefine\""
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefParseNode",
          "args": [
            "ctxt->node->doc",
            "domainNode",
            "xmlopt",
            "parseOpaque",
            "domainflags"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefParseNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "22153-22180",
          "snippet": "virDomainDefPtr\nvirDomainDefParseNode(xmlDocPtr xml,\n                      xmlNodePtr root,\n                      virDomainXMLOptionPtr xmlopt,\n                      void *parseOpaque,\n                      unsigned int flags)\n{\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autoptr(virDomainDef) def = NULL;\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        return NULL;\n\n    ctxt->node = root;\n\n    if (!(def = virDomainDefParseXML(xml, ctxt, xmlopt, flags)))\n        return NULL;\n\n    /* callback to fill driver specific domain aspects */\n    if (virDomainDefPostParse(def, flags, xmlopt, parseOpaque) < 0)\n        return NULL;\n\n    /* validate configuration */\n    if (virDomainDefValidate(def, flags, xmlopt) < 0)\n        return NULL;\n\n    return g_steal_pointer(&def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainDefParseNode(xmlDocPtr xml,\n                      xmlNodePtr root,\n                      virDomainXMLOptionPtr xmlopt,\n                      void *parseOpaque,\n                      unsigned int flags)\n{\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autoptr(virDomainDef) def = NULL;\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        return NULL;\n\n    ctxt->node = root;\n\n    if (!(def = virDomainDefParseXML(xml, ctxt, xmlopt, flags)))\n        return NULL;\n\n    /* callback to fill driver specific domain aspects */\n    if (virDomainDefPostParse(def, flags, xmlopt, parseOpaque) < 0)\n        return NULL;\n\n    /* validate configuration */\n    if (virDomainDefValidate(def, flags, xmlopt) < 0)\n        return NULL;\n\n    return g_steal_pointer(&def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"missing domain in checkpoint\")"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXPathNode",
          "args": [
            "\"./domain\"",
            "ctxt"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "608-634",
          "snippet": "xmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathString",
          "args": [
            "\"string(./domain/@type)\"",
            "ctxt"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "72-96",
          "snippet": "char *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"missing creationTime from existing checkpoint\")"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXPathLongLong",
          "args": [
            "\"string(./creationTime)\"",
            "ctxt",
            "&def->parent.creationTime"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathLongLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "444-476",
          "snippet": "int\nvirXPathLongLong(const char *xpath,\n                 xmlXPathContextPtr ctxt,\n                 long long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathLongLong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ll((char *) obj->stringval, NULL, 10, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (long long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathLongLong(const char *xpath,\n                 xmlXPathContextPtr ctxt,\n                 long long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathLongLong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ll((char *) obj->stringval, NULL, 10, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (long long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"a redefined checkpoint must have a name\")"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainCheckpointDefNew",
          "args": [],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCheckpointDefNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
          "lines": "73-80",
          "snippet": "virDomainCheckpointDefPtr\nvirDomainCheckpointDefNew(void)\n{\n    if (virDomainCheckpointInitialize() < 0)\n        return NULL;\n\n    return virObjectNew(virDomainCheckpointDefClass);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virbitmap.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virDomainCheckpointDefClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic virClassPtr virDomainCheckpointDefClass;\n\nvirDomainCheckpointDefPtr\nvirDomainCheckpointDefNew(void)\n{\n    if (virDomainCheckpointInitialize() < 0)\n        return NULL;\n\n    return virObjectNew(virDomainCheckpointDefClass);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic virDomainCheckpointDefPtr\nvirDomainCheckpointDefParse(xmlXPathContextPtr ctxt,\n                            virDomainXMLOptionPtr xmlopt,\n                            void *parseOpaque,\n                            unsigned int flags)\n{\n    virDomainCheckpointDefPtr ret = NULL;\n    size_t i;\n    int n;\n    char *tmp;\n    g_autofree xmlNodePtr *nodes = NULL;\n    g_autoptr(virDomainCheckpointDef) def = NULL;\n\n    if (!(def = virDomainCheckpointDefNew()))\n        return NULL;\n\n    def->parent.name = virXPathString(\"string(./name)\", ctxt);\n\n    if (def->parent.name == NULL) {\n        if (flags & VIR_DOMAIN_CHECKPOINT_PARSE_REDEFINE) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"a redefined checkpoint must have a name\"));\n            return NULL;\n        }\n    }\n\n    def->parent.description = virXPathString(\"string(./description)\", ctxt);\n\n    if (flags & VIR_DOMAIN_CHECKPOINT_PARSE_REDEFINE) {\n        if (virXPathLongLong(\"string(./creationTime)\", ctxt,\n                             &def->parent.creationTime) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"missing creationTime from existing checkpoint\"));\n            return NULL;\n        }\n\n        def->parent.parent_name = virXPathString(\"string(./parent/name)\", ctxt);\n\n        if ((tmp = virXPathString(\"string(./domain/@type)\", ctxt))) {\n            int domainflags = VIR_DOMAIN_DEF_PARSE_INACTIVE |\n                              VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE;\n            xmlNodePtr domainNode = virXPathNode(\"./domain\", ctxt);\n\n            VIR_FREE(tmp);\n            if (!domainNode) {\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"missing domain in checkpoint\"));\n                return NULL;\n            }\n            def->parent.dom = virDomainDefParseNode(ctxt->node->doc, domainNode,\n                                                    xmlopt, parseOpaque,\n                                                    domainflags);\n            if (!def->parent.dom)\n                return NULL;\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"missing domain in checkpoint redefine\"));\n            return NULL;\n        }\n    } else if (virDomainXMLOptionRunMomentPostParse(xmlopt, &def->parent) < 0) {\n        return NULL;\n    }\n\n    if ((n = virXPathNodeSet(\"./disks/*\", ctxt, &nodes)) < 0)\n        return NULL;\n    if (n && VIR_ALLOC_N(def->disks, n) < 0)\n        return NULL;\n    def->ndisks = n;\n    for (i = 0; i < def->ndisks; i++) {\n        if (virDomainCheckpointDiskDefParseXML(nodes[i], ctxt,\n                                               &def->disks[i]) < 0)\n            return NULL;\n    }\n\n    ret = g_steal_pointer(&def);\n    return ret;\n}"
  },
  {
    "function_name": "virDomainCheckpointDiskDefParseXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
    "lines": "93-116",
    "snippet": "static int\nvirDomainCheckpointDiskDefParseXML(xmlNodePtr node,\n                                   xmlXPathContextPtr ctxt,\n                                   virDomainCheckpointDiskDefPtr def)\n{\n    g_autofree char *checkpoint = NULL;\n    VIR_XPATH_NODE_AUTORESTORE(ctxt);\n\n    ctxt->node = node;\n\n    /* Schema guarantees this is non-NULL: */\n    def->name = virXMLPropString(node, \"name\");\n\n    checkpoint = virXMLPropString(node, \"checkpoint\");\n    if (checkpoint)\n        /* Schema guarantees this is in range: */\n        def->type = virDomainCheckpointTypeFromString(checkpoint);\n    else\n        def->type = VIR_DOMAIN_CHECKPOINT_TYPE_BITMAP;\n\n    def->bitmap = virXMLPropString(node, \"bitmap\");\n\n    return 0;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virstring.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virbitmap.h\"",
      "#include \"internal.h\"",
      "#include \"configmake.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "node",
            "\"bitmap\""
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCheckpointTypeFromString",
          "args": [
            "checkpoint"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_XPATH_NODE_AUTORESTORE",
          "args": [
            "ctxt"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic int\nvirDomainCheckpointDiskDefParseXML(xmlNodePtr node,\n                                   xmlXPathContextPtr ctxt,\n                                   virDomainCheckpointDiskDefPtr def)\n{\n    g_autofree char *checkpoint = NULL;\n    VIR_XPATH_NODE_AUTORESTORE(ctxt);\n\n    ctxt->node = node;\n\n    /* Schema guarantees this is non-NULL: */\n    def->name = virXMLPropString(node, \"name\");\n\n    checkpoint = virXMLPropString(node, \"checkpoint\");\n    if (checkpoint)\n        /* Schema guarantees this is in range: */\n        def->type = virDomainCheckpointTypeFromString(checkpoint);\n    else\n        def->type = VIR_DOMAIN_CHECKPOINT_TYPE_BITMAP;\n\n    def->bitmap = virXMLPropString(node, \"bitmap\");\n\n    return 0;\n}"
  },
  {
    "function_name": "virDomainCheckpointDefDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
    "lines": "82-91",
    "snippet": "static void\nvirDomainCheckpointDefDispose(void *obj)\n{\n    virDomainCheckpointDefPtr def = obj;\n    size_t i;\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainCheckpointDiskDefClear(&def->disks[i]);\n    VIR_FREE(def->disks);\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virstring.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virbitmap.h\"",
      "#include \"internal.h\"",
      "#include \"configmake.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virDomainCheckpointDefDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->disks"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainCheckpointDiskDefClear",
          "args": [
            "&def->disks[i]"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCheckpointDiskDefClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
          "lines": "65-70",
          "snippet": "static void\nvirDomainCheckpointDiskDefClear(virDomainCheckpointDiskDefPtr disk)\n{\n    VIR_FREE(disk->name);\n    VIR_FREE(disk->bitmap);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virbitmap.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic void\nvirDomainCheckpointDiskDefClear(virDomainCheckpointDiskDefPtr disk)\n{\n    VIR_FREE(disk->name);\n    VIR_FREE(disk->bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic void virDomainCheckpointDefDispose(void *obj);\n\nstatic void\nvirDomainCheckpointDefDispose(void *obj)\n{\n    virDomainCheckpointDefPtr def = obj;\n    size_t i;\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainCheckpointDiskDefClear(&def->disks[i]);\n    VIR_FREE(def->disks);\n}"
  },
  {
    "function_name": "virDomainCheckpointDefNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
    "lines": "73-80",
    "snippet": "virDomainCheckpointDefPtr\nvirDomainCheckpointDefNew(void)\n{\n    if (virDomainCheckpointInitialize() < 0)\n        return NULL;\n\n    return virObjectNew(virDomainCheckpointDefClass);\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virstring.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virbitmap.h\"",
      "#include \"internal.h\"",
      "#include \"configmake.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virDomainCheckpointDefClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectNew",
          "args": [
            "virDomainCheckpointDefClass"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "236-253",
          "snippet": "void *\nvirObjectNew(virClassPtr klass)\n{\n    virObjectPtr obj = NULL;\n\n    if (VIR_ALLOC_VAR(obj,\n                      char,\n                      klass->objectSize - sizeof(virObject)) < 0)\n        return NULL;\n\n    obj->u.s.magic = klass->magic;\n    obj->klass = klass;\n    g_atomic_int_set(&obj->u.s.refs, 1);\n\n    PROBE(OBJECT_NEW, \"obj=%p classname=%s\", obj, obj->klass->name);\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectNew(virClassPtr klass)\n{\n    virObjectPtr obj = NULL;\n\n    if (VIR_ALLOC_VAR(obj,\n                      char,\n                      klass->objectSize - sizeof(virObject)) < 0)\n        return NULL;\n\n    obj->u.s.magic = klass->magic;\n    obj->klass = klass;\n    g_atomic_int_set(&obj->u.s.refs, 1);\n\n    PROBE(OBJECT_NEW, \"obj=%p classname=%s\", obj, obj->klass->name);\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCheckpointInitialize",
          "args": [],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic virClassPtr virDomainCheckpointDefClass;\n\nvirDomainCheckpointDefPtr\nvirDomainCheckpointDefNew(void)\n{\n    if (virDomainCheckpointInitialize() < 0)\n        return NULL;\n\n    return virObjectNew(virDomainCheckpointDefClass);\n}"
  },
  {
    "function_name": "virDomainCheckpointDiskDefClear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
    "lines": "65-70",
    "snippet": "static void\nvirDomainCheckpointDiskDefClear(virDomainCheckpointDiskDefPtr disk)\n{\n    VIR_FREE(disk->name);\n    VIR_FREE(disk->bitmap);\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virstring.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virbitmap.h\"",
      "#include \"internal.h\"",
      "#include \"configmake.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "disk->bitmap"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "disk->name"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic void\nvirDomainCheckpointDiskDefClear(virDomainCheckpointDiskDefPtr disk)\n{\n    VIR_FREE(disk->name);\n    VIR_FREE(disk->bitmap);\n}"
  },
  {
    "function_name": "virDomainCheckpointOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/checkpoint_conf.c",
    "lines": "48-55",
    "snippet": "static int\nvirDomainCheckpointOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virDomainCheckpointDef, virClassForDomainMomentDef()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virstring.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virbitmap.h\"",
      "#include \"internal.h\"",
      "#include \"configmake.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virDomainCheckpointDef",
            "virClassForDomainMomentDef()"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForDomainMomentDef",
          "args": [],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForDomainMomentDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/moment_conf.c",
          "lines": "51-58",
          "snippet": "virClassPtr\nvirClassForDomainMomentDef(void)\n{\n    if (virDomainMomentInitialize() < 0)\n        return NULL;\n\n    return virDomainMomentDefClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"moment_conf.h\"",
            "#include \"internal.h\"",
            "#include <sys/time.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virDomainMomentDefClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"moment_conf.h\"\n#include \"internal.h\"\n#include <sys/time.h>\n#include <config.h>\n\nstatic virClassPtr virDomainMomentDefClass;\n\nvirClassPtr\nvirClassForDomainMomentDef(void)\n{\n    if (virDomainMomentInitialize() < 0)\n        return NULL;\n\n    return virDomainMomentDefClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"checkpoint_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <config.h>\n\nstatic int\nvirDomainCheckpointOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virDomainCheckpointDef, virClassForDomainMomentDef()))\n        return -1;\n\n    return 0;\n}"
  }
]