[
  {
    "function_name": "virKeyFileGetValueString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
    "lines": "347-354",
    "snippet": "const char *virKeyFileGetValueString(virKeyFilePtr conf,\n                                     const char *groupname,\n                                     const char *valuename)\n{\n    virHashTablePtr group = virHashLookup(conf->groups, groupname);\n    VIR_DEBUG(\"conf=%p groupname=%s valuename=%s\", conf, groupname, valuename);\n    return virHashLookup(group, valuename);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "group",
            "valuename"
          ],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conf=%p groupname=%s valuename=%s\"",
            "conf",
            "groupname",
            "valuename"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nconst char *virKeyFileGetValueString(virKeyFilePtr conf,\n                                     const char *groupname,\n                                     const char *valuename)\n{\n    virHashTablePtr group = virHashLookup(conf->groups, groupname);\n    VIR_DEBUG(\"conf=%p groupname=%s valuename=%s\", conf, groupname, valuename);\n    return virHashLookup(group, valuename);\n}"
  },
  {
    "function_name": "virKeyFileHasValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
    "lines": "338-345",
    "snippet": "bool virKeyFileHasValue(virKeyFilePtr conf,\n                        const char *groupname,\n                        const char *valuename)\n{\n    virHashTablePtr group = virHashLookup(conf->groups, groupname);\n    VIR_DEBUG(\"conf=%p groupname=%s valuename=%s\", conf, groupname, valuename);\n    return group && virHashLookup(group, valuename) != NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "group",
            "valuename"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conf=%p groupname=%s valuename=%s\"",
            "conf",
            "groupname",
            "valuename"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nbool virKeyFileHasValue(virKeyFilePtr conf,\n                        const char *groupname,\n                        const char *valuename)\n{\n    virHashTablePtr group = virHashLookup(conf->groups, groupname);\n    VIR_DEBUG(\"conf=%p groupname=%s valuename=%s\", conf, groupname, valuename);\n    return group && virHashLookup(group, valuename) != NULL;\n}"
  },
  {
    "function_name": "virKeyFileHasGroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
    "lines": "330-335",
    "snippet": "bool virKeyFileHasGroup(virKeyFilePtr conf,\n                        const char *groupname)\n{\n    VIR_DEBUG(\"conf=%p groupname=%s\", conf, groupname);\n    return virHashLookup(conf->groups, groupname) != NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "conf->groups",
            "groupname"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conf=%p groupname=%s\"",
            "conf",
            "groupname"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nbool virKeyFileHasGroup(virKeyFilePtr conf,\n                        const char *groupname)\n{\n    VIR_DEBUG(\"conf=%p groupname=%s\", conf, groupname);\n    return virHashLookup(conf->groups, groupname) != NULL;\n}"
  },
  {
    "function_name": "virKeyFileFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
    "lines": "320-327",
    "snippet": "void virKeyFileFree(virKeyFilePtr conf)\n{\n    if (!conf)\n        return;\n\n    virHashFree(conf->groups);\n    VIR_FREE(conf);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "conf"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "conf->groups"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nvoid virKeyFileFree(virKeyFilePtr conf)\n{\n    if (!conf)\n        return;\n\n    virHashFree(conf->groups);\n    VIR_FREE(conf);\n}"
  },
  {
    "function_name": "virKeyFileLoadData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
    "lines": "311-317",
    "snippet": "int virKeyFileLoadData(virKeyFilePtr conf,\n                       const char *path,\n                       const char *data,\n                       size_t len)\n{\n    return virKeyFileParse(conf, path, data, len);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virKeyFileParse",
          "args": [
            "conf",
            "path",
            "data",
            "len"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "virKeyFileParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
          "lines": "236-263",
          "snippet": "static int virKeyFileParse(virKeyFilePtr conf,\n                           const char *filename,\n                           const char *data,\n                           size_t len)\n{\n    virKeyFileParserCtxt ctxt;\n    int ret = -1;\n\n    VIR_DEBUG(\"Parse %p '%s' %p %zu\", conf, filename, data, len);\n\n    memset(&ctxt, 0, sizeof(ctxt));\n\n    ctxt.filename = filename;\n    ctxt.base = ctxt.cur = data;\n    ctxt.end = data + len - 1;\n    ctxt.line = 1;\n    ctxt.conf = conf;\n\n    while (ctxt.cur < ctxt.end) {\n        if (virKeyFileParseStatement(&ctxt) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(ctxt.groupname);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int virKeyFileParse(virKeyFilePtr conf,\n                           const char *filename,\n                           const char *data,\n                           size_t len)\n{\n    virKeyFileParserCtxt ctxt;\n    int ret = -1;\n\n    VIR_DEBUG(\"Parse %p '%s' %p %zu\", conf, filename, data, len);\n\n    memset(&ctxt, 0, sizeof(ctxt));\n\n    ctxt.filename = filename;\n    ctxt.base = ctxt.cur = data;\n    ctxt.end = data + len - 1;\n    ctxt.line = 1;\n    ctxt.conf = conf;\n\n    while (ctxt.cur < ctxt.end) {\n        if (virKeyFileParseStatement(&ctxt) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(ctxt.groupname);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint virKeyFileLoadData(virKeyFilePtr conf,\n                       const char *path,\n                       const char *data,\n                       size_t len)\n{\n    return virKeyFileParse(conf, path, data, len);\n}"
  },
  {
    "function_name": "virKeyFileLoadFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
    "lines": "293-308",
    "snippet": "int virKeyFileLoadFile(virKeyFilePtr conf,\n                       const char *filename)\n{\n    char *data = NULL;\n    ssize_t len;\n    int ret;\n\n    if ((len = virFileReadAll(filename, MAX_CONFIG_FILE_SIZE, &data)) < 0)\n        return -1;\n\n    ret = virKeyFileParse(conf, filename, data, len);\n\n    VIR_FREE(data);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define MAX_CONFIG_FILE_SIZE (1024 * 1024)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virKeyFileParse",
          "args": [
            "conf",
            "filename",
            "data",
            "len"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "virKeyFileParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
          "lines": "236-263",
          "snippet": "static int virKeyFileParse(virKeyFilePtr conf,\n                           const char *filename,\n                           const char *data,\n                           size_t len)\n{\n    virKeyFileParserCtxt ctxt;\n    int ret = -1;\n\n    VIR_DEBUG(\"Parse %p '%s' %p %zu\", conf, filename, data, len);\n\n    memset(&ctxt, 0, sizeof(ctxt));\n\n    ctxt.filename = filename;\n    ctxt.base = ctxt.cur = data;\n    ctxt.end = data + len - 1;\n    ctxt.line = 1;\n    ctxt.conf = conf;\n\n    while (ctxt.cur < ctxt.end) {\n        if (virKeyFileParseStatement(&ctxt) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(ctxt.groupname);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int virKeyFileParse(virKeyFilePtr conf,\n                           const char *filename,\n                           const char *data,\n                           size_t len)\n{\n    virKeyFileParserCtxt ctxt;\n    int ret = -1;\n\n    VIR_DEBUG(\"Parse %p '%s' %p %zu\", conf, filename, data, len);\n\n    memset(&ctxt, 0, sizeof(ctxt));\n\n    ctxt.filename = filename;\n    ctxt.base = ctxt.cur = data;\n    ctxt.end = data + len - 1;\n    ctxt.line = 1;\n    ctxt.conf = conf;\n\n    while (ctxt.cur < ctxt.end) {\n        if (virKeyFileParseStatement(&ctxt) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(ctxt.groupname);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "filename",
            "MAX_CONFIG_FILE_SIZE",
            "&data"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\n#define MAX_CONFIG_FILE_SIZE (1024 * 1024)\n\nint virKeyFileLoadFile(virKeyFilePtr conf,\n                       const char *filename)\n{\n    char *data = NULL;\n    ssize_t len;\n    int ret;\n\n    if ((len = virFileReadAll(filename, MAX_CONFIG_FILE_SIZE, &data)) < 0)\n        return -1;\n\n    ret = virKeyFileParse(conf, filename, data, len);\n\n    VIR_FREE(data);\n\n    return ret;\n}"
  },
  {
    "function_name": "virKeyFileNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
    "lines": "272-288",
    "snippet": "virKeyFilePtr virKeyFileNew(void)\n{\n    virKeyFilePtr conf;\n\n    if (VIR_ALLOC(conf) < 0)\n        goto error;\n\n    if (!(conf->groups = virHashCreate(10,\n                                       virKeyFileEntryFree)))\n        goto error;\n\n    return conf;\n\n error:\n    virKeyFileFree(conf);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virKeyFileFree",
          "args": [
            "conf"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "virKeyFileFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
          "lines": "320-327",
          "snippet": "void virKeyFileFree(virKeyFilePtr conf)\n{\n    if (!conf)\n        return;\n\n    virHashFree(conf->groups);\n    VIR_FREE(conf);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nvoid virKeyFileFree(virKeyFilePtr conf)\n{\n    if (!conf)\n        return;\n\n    virHashFree(conf->groups);\n    VIR_FREE(conf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "10",
            "virKeyFileEntryFree"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "conf"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nvirKeyFilePtr virKeyFileNew(void)\n{\n    virKeyFilePtr conf;\n\n    if (VIR_ALLOC(conf) < 0)\n        goto error;\n\n    if (!(conf->groups = virHashCreate(10,\n                                       virKeyFileEntryFree)))\n        goto error;\n\n    return conf;\n\n error:\n    virKeyFileFree(conf);\n    return NULL;\n}"
  },
  {
    "function_name": "virKeyFileEntryFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
    "lines": "266-269",
    "snippet": "static void virKeyFileEntryFree(void *payload)\n{\n    virHashFree(payload);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "payload"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic void virKeyFileEntryFree(void *payload)\n{\n    virHashFree(payload);\n}"
  },
  {
    "function_name": "virKeyFileParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
    "lines": "236-263",
    "snippet": "static int virKeyFileParse(virKeyFilePtr conf,\n                           const char *filename,\n                           const char *data,\n                           size_t len)\n{\n    virKeyFileParserCtxt ctxt;\n    int ret = -1;\n\n    VIR_DEBUG(\"Parse %p '%s' %p %zu\", conf, filename, data, len);\n\n    memset(&ctxt, 0, sizeof(ctxt));\n\n    ctxt.filename = filename;\n    ctxt.base = ctxt.cur = data;\n    ctxt.end = data + len - 1;\n    ctxt.line = 1;\n    ctxt.conf = conf;\n\n    while (ctxt.cur < ctxt.end) {\n        if (virKeyFileParseStatement(&ctxt) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(ctxt.groupname);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ctxt.groupname"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virKeyFileParseStatement",
          "args": [
            "&ctxt"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "virKeyFileParseStatement",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
          "lines": "217-234",
          "snippet": "static int virKeyFileParseStatement(virKeyFileParserCtxtPtr ctxt)\n{\n    int ret = -1;\n\n    if (CUR == '[') {\n        ret = virKeyFileParseGroup(ctxt);\n    } else if (g_ascii_isalnum(CUR)) {\n        ret = virKeyFileParseValue(ctxt);\n    } else if (CUR == '#' || CUR == ';') {\n        ret = virKeyFileParseComment(ctxt);\n    } else if (IS_BLANK(CUR) || IS_EOL(CUR)) {\n        ret = virKeyFileParseBlank(ctxt);\n    } else {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"unexpected statement\");\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define CUR (*ctxt->cur)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\n#define CUR (*ctxt->cur)\n\nstatic int virKeyFileParseStatement(virKeyFileParserCtxtPtr ctxt)\n{\n    int ret = -1;\n\n    if (CUR == '[') {\n        ret = virKeyFileParseGroup(ctxt);\n    } else if (g_ascii_isalnum(CUR)) {\n        ret = virKeyFileParseValue(ctxt);\n    } else if (CUR == '#' || CUR == ';') {\n        ret = virKeyFileParseComment(ctxt);\n    } else if (IS_BLANK(CUR) || IS_EOL(CUR)) {\n        ret = virKeyFileParseBlank(ctxt);\n    } else {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"unexpected statement\");\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&ctxt",
            "0",
            "sizeof(ctxt)"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Parse %p '%s' %p %zu\"",
            "conf",
            "filename",
            "data",
            "len"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int virKeyFileParse(virKeyFilePtr conf,\n                           const char *filename,\n                           const char *data,\n                           size_t len)\n{\n    virKeyFileParserCtxt ctxt;\n    int ret = -1;\n\n    VIR_DEBUG(\"Parse %p '%s' %p %zu\", conf, filename, data, len);\n\n    memset(&ctxt, 0, sizeof(ctxt));\n\n    ctxt.filename = filename;\n    ctxt.base = ctxt.cur = data;\n    ctxt.end = data + len - 1;\n    ctxt.line = 1;\n    ctxt.conf = conf;\n\n    while (ctxt.cur < ctxt.end) {\n        if (virKeyFileParseStatement(&ctxt) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(ctxt.groupname);\n    return ret;\n}"
  },
  {
    "function_name": "virKeyFileParseStatement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
    "lines": "217-234",
    "snippet": "static int virKeyFileParseStatement(virKeyFileParserCtxtPtr ctxt)\n{\n    int ret = -1;\n\n    if (CUR == '[') {\n        ret = virKeyFileParseGroup(ctxt);\n    } else if (g_ascii_isalnum(CUR)) {\n        ret = virKeyFileParseValue(ctxt);\n    } else if (CUR == '#' || CUR == ';') {\n        ret = virKeyFileParseComment(ctxt);\n    } else if (IS_BLANK(CUR) || IS_EOL(CUR)) {\n        ret = virKeyFileParseBlank(ctxt);\n    } else {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"unexpected statement\");\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define CUR (*ctxt->cur)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virKeyFileError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "\"unexpected statement\""
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virKeyFileParseBlank",
          "args": [
            "ctxt"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "virKeyFileParseBlank",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
          "lines": "204-215",
          "snippet": "static int virKeyFileParseBlank(virKeyFileParserCtxtPtr ctxt)\n{\n    while ((ctxt->cur < ctxt->end) && IS_BLANK(CUR))\n        ctxt->cur++;\n\n    if (!((ctxt->cur == ctxt->end) || IS_EOL(CUR))) {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"expected newline\");\n        return -1;\n    }\n    NEXT;\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NEXT if (!IS_EOF) ctxt->cur++;",
            "#define CUR (*ctxt->cur)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\n#define NEXT if (!IS_EOF) ctxt->cur++;\n#define CUR (*ctxt->cur)\n\nstatic int virKeyFileParseBlank(virKeyFileParserCtxtPtr ctxt)\n{\n    while ((ctxt->cur < ctxt->end) && IS_BLANK(CUR))\n        ctxt->cur++;\n\n    if (!((ctxt->cur == ctxt->end) || IS_EOL(CUR))) {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"expected newline\");\n        return -1;\n    }\n    NEXT;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_EOL",
          "args": [
            "CUR"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_BLANK",
          "args": [
            "CUR"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virKeyFileParseComment",
          "args": [
            "ctxt"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "virKeyFileParseComment",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
          "lines": "192-202",
          "snippet": "static int virKeyFileParseComment(virKeyFileParserCtxtPtr ctxt)\n{\n    NEXT;\n\n    while (!IS_EOF && !IS_EOL(CUR))\n        ctxt->cur++;\n\n    NEXT;\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NEXT if (!IS_EOF) ctxt->cur++;",
            "#define CUR (*ctxt->cur)",
            "#define IS_EOF (ctxt->cur >= ctxt->end)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\n#define NEXT if (!IS_EOF) ctxt->cur++;\n#define CUR (*ctxt->cur)\n#define IS_EOF (ctxt->cur >= ctxt->end)\n\nstatic int virKeyFileParseComment(virKeyFileParserCtxtPtr ctxt)\n{\n    NEXT;\n\n    while (!IS_EOF && !IS_EOL(CUR))\n        ctxt->cur++;\n\n    NEXT;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virKeyFileParseValue",
          "args": [
            "ctxt"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "virKeyFileParseValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
          "lines": "141-190",
          "snippet": "static int virKeyFileParseValue(virKeyFileParserCtxtPtr ctxt)\n{\n    int ret = -1;\n    const char *keystart;\n    const char *valuestart;\n    char *key = NULL;\n    char *value = NULL;\n    size_t len;\n\n    if (!ctxt->groupname || !ctxt->group) {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"value found before first group\");\n        return -1;\n    }\n\n    keystart = ctxt->cur;\n    while (!IS_EOF && g_ascii_isalnum(CUR) && CUR != '=')\n        ctxt->cur++;\n    if (CUR != '=') {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"expected end of value name, expected '='\");\n        return -1;\n    }\n\n    key = g_strndup(keystart, ctxt->cur - keystart);\n\n    NEXT;\n    valuestart = ctxt->cur;\n    while (!IS_EOF && !IS_EOL(CUR))\n        ctxt->cur++;\n    if (!(IS_EOF || IS_EOL(CUR))) {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"unexpected end of value\");\n        goto cleanup;\n    }\n    len = ctxt->cur - valuestart;\n    if (IS_EOF && !IS_EOL(CUR))\n        len++;\n    value = g_strndup(valuestart, len);\n\n    if (virHashAddEntry(ctxt->group, key, value) < 0) {\n        VIR_FREE(value);\n        goto cleanup;\n    }\n\n    NEXT;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(key);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NEXT if (!IS_EOF) ctxt->cur++;",
            "#define CUR (*ctxt->cur)",
            "#define IS_EOF (ctxt->cur >= ctxt->end)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\n#define NEXT if (!IS_EOF) ctxt->cur++;\n#define CUR (*ctxt->cur)\n#define IS_EOF (ctxt->cur >= ctxt->end)\n\nstatic int virKeyFileParseValue(virKeyFileParserCtxtPtr ctxt)\n{\n    int ret = -1;\n    const char *keystart;\n    const char *valuestart;\n    char *key = NULL;\n    char *value = NULL;\n    size_t len;\n\n    if (!ctxt->groupname || !ctxt->group) {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"value found before first group\");\n        return -1;\n    }\n\n    keystart = ctxt->cur;\n    while (!IS_EOF && g_ascii_isalnum(CUR) && CUR != '=')\n        ctxt->cur++;\n    if (CUR != '=') {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"expected end of value name, expected '='\");\n        return -1;\n    }\n\n    key = g_strndup(keystart, ctxt->cur - keystart);\n\n    NEXT;\n    valuestart = ctxt->cur;\n    while (!IS_EOF && !IS_EOL(CUR))\n        ctxt->cur++;\n    if (!(IS_EOF || IS_EOL(CUR))) {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"unexpected end of value\");\n        goto cleanup;\n    }\n    len = ctxt->cur - valuestart;\n    if (IS_EOF && !IS_EOL(CUR))\n        len++;\n    value = g_strndup(valuestart, len);\n\n    if (virHashAddEntry(ctxt->group, key, value) < 0) {\n        VIR_FREE(value);\n        goto cleanup;\n    }\n\n    NEXT;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(key);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_ascii_isalnum",
          "args": [
            "CUR"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virKeyFileParseGroup",
          "args": [
            "ctxt"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "virKeyFileParseGroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
          "lines": "103-139",
          "snippet": "static int virKeyFileParseGroup(virKeyFileParserCtxtPtr ctxt)\n{\n    int ret = -1;\n    const char *name;\n    NEXT;\n\n    ctxt->group = NULL;\n    VIR_FREE(ctxt->groupname);\n\n    name = ctxt->cur;\n    while (!IS_EOF && IS_ASCII(CUR) && CUR != ']')\n        ctxt->cur++;\n    if (CUR != ']') {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"cannot find end of group name, expected ']'\");\n        return -1;\n    }\n\n    ctxt->groupname = g_strndup(name, ctxt->cur - name);\n\n    NEXT;\n\n    if (!(ctxt->group = virHashCreate(10, virHashValueFree)))\n        goto cleanup;\n\n    if (virHashAddEntry(ctxt->conf->groups, ctxt->groupname, ctxt->group) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    if (ret != 0) {\n        virHashFree(ctxt->group);\n        ctxt->group = NULL;\n        VIR_FREE(ctxt->groupname);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NEXT if (!IS_EOF) ctxt->cur++;",
            "#define CUR (*ctxt->cur)",
            "#define IS_EOF (ctxt->cur >= ctxt->end)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\n#define NEXT if (!IS_EOF) ctxt->cur++;\n#define CUR (*ctxt->cur)\n#define IS_EOF (ctxt->cur >= ctxt->end)\n\nstatic int virKeyFileParseGroup(virKeyFileParserCtxtPtr ctxt)\n{\n    int ret = -1;\n    const char *name;\n    NEXT;\n\n    ctxt->group = NULL;\n    VIR_FREE(ctxt->groupname);\n\n    name = ctxt->cur;\n    while (!IS_EOF && IS_ASCII(CUR) && CUR != ']')\n        ctxt->cur++;\n    if (CUR != ']') {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"cannot find end of group name, expected ']'\");\n        return -1;\n    }\n\n    ctxt->groupname = g_strndup(name, ctxt->cur - name);\n\n    NEXT;\n\n    if (!(ctxt->group = virHashCreate(10, virHashValueFree)))\n        goto cleanup;\n\n    if (virHashAddEntry(ctxt->conf->groups, ctxt->groupname, ctxt->group) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    if (ret != 0) {\n        virHashFree(ctxt->group);\n        ctxt->group = NULL;\n        VIR_FREE(ctxt->groupname);\n    }\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\n#define CUR (*ctxt->cur)\n\nstatic int virKeyFileParseStatement(virKeyFileParserCtxtPtr ctxt)\n{\n    int ret = -1;\n\n    if (CUR == '[') {\n        ret = virKeyFileParseGroup(ctxt);\n    } else if (g_ascii_isalnum(CUR)) {\n        ret = virKeyFileParseValue(ctxt);\n    } else if (CUR == '#' || CUR == ';') {\n        ret = virKeyFileParseComment(ctxt);\n    } else if (IS_BLANK(CUR) || IS_EOL(CUR)) {\n        ret = virKeyFileParseBlank(ctxt);\n    } else {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"unexpected statement\");\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virKeyFileParseBlank",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
    "lines": "204-215",
    "snippet": "static int virKeyFileParseBlank(virKeyFileParserCtxtPtr ctxt)\n{\n    while ((ctxt->cur < ctxt->end) && IS_BLANK(CUR))\n        ctxt->cur++;\n\n    if (!((ctxt->cur == ctxt->end) || IS_EOL(CUR))) {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"expected newline\");\n        return -1;\n    }\n    NEXT;\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NEXT if (!IS_EOF) ctxt->cur++;",
      "#define CUR (*ctxt->cur)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virKeyFileError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "\"expected newline\""
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_EOL",
          "args": [
            "CUR"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_BLANK",
          "args": [
            "CUR"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\n#define NEXT if (!IS_EOF) ctxt->cur++;\n#define CUR (*ctxt->cur)\n\nstatic int virKeyFileParseBlank(virKeyFileParserCtxtPtr ctxt)\n{\n    while ((ctxt->cur < ctxt->end) && IS_BLANK(CUR))\n        ctxt->cur++;\n\n    if (!((ctxt->cur == ctxt->end) || IS_EOL(CUR))) {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"expected newline\");\n        return -1;\n    }\n    NEXT;\n    return 0;\n}"
  },
  {
    "function_name": "virKeyFileParseComment",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
    "lines": "192-202",
    "snippet": "static int virKeyFileParseComment(virKeyFileParserCtxtPtr ctxt)\n{\n    NEXT;\n\n    while (!IS_EOF && !IS_EOL(CUR))\n        ctxt->cur++;\n\n    NEXT;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NEXT if (!IS_EOF) ctxt->cur++;",
      "#define CUR (*ctxt->cur)",
      "#define IS_EOF (ctxt->cur >= ctxt->end)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_EOL",
          "args": [
            "CUR"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\n#define NEXT if (!IS_EOF) ctxt->cur++;\n#define CUR (*ctxt->cur)\n#define IS_EOF (ctxt->cur >= ctxt->end)\n\nstatic int virKeyFileParseComment(virKeyFileParserCtxtPtr ctxt)\n{\n    NEXT;\n\n    while (!IS_EOF && !IS_EOL(CUR))\n        ctxt->cur++;\n\n    NEXT;\n\n    return 0;\n}"
  },
  {
    "function_name": "virKeyFileParseValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
    "lines": "141-190",
    "snippet": "static int virKeyFileParseValue(virKeyFileParserCtxtPtr ctxt)\n{\n    int ret = -1;\n    const char *keystart;\n    const char *valuestart;\n    char *key = NULL;\n    char *value = NULL;\n    size_t len;\n\n    if (!ctxt->groupname || !ctxt->group) {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"value found before first group\");\n        return -1;\n    }\n\n    keystart = ctxt->cur;\n    while (!IS_EOF && g_ascii_isalnum(CUR) && CUR != '=')\n        ctxt->cur++;\n    if (CUR != '=') {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"expected end of value name, expected '='\");\n        return -1;\n    }\n\n    key = g_strndup(keystart, ctxt->cur - keystart);\n\n    NEXT;\n    valuestart = ctxt->cur;\n    while (!IS_EOF && !IS_EOL(CUR))\n        ctxt->cur++;\n    if (!(IS_EOF || IS_EOL(CUR))) {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"unexpected end of value\");\n        goto cleanup;\n    }\n    len = ctxt->cur - valuestart;\n    if (IS_EOF && !IS_EOL(CUR))\n        len++;\n    value = g_strndup(valuestart, len);\n\n    if (virHashAddEntry(ctxt->group, key, value) < 0) {\n        VIR_FREE(value);\n        goto cleanup;\n    }\n\n    NEXT;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(key);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NEXT if (!IS_EOF) ctxt->cur++;",
      "#define CUR (*ctxt->cur)",
      "#define IS_EOF (ctxt->cur >= ctxt->end)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "key"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "ctxt->group",
            "key",
            "value"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "valuestart",
            "len"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_EOL",
          "args": [
            "CUR"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virKeyFileError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "\"unexpected end of value\""
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_EOL",
          "args": [
            "CUR"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_EOL",
          "args": [
            "CUR"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "keystart",
            "ctxt->cur - keystart"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virKeyFileError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "\"expected end of value name, expected '='\""
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ascii_isalnum",
          "args": [
            "CUR"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virKeyFileError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "\"value found before first group\""
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\n#define NEXT if (!IS_EOF) ctxt->cur++;\n#define CUR (*ctxt->cur)\n#define IS_EOF (ctxt->cur >= ctxt->end)\n\nstatic int virKeyFileParseValue(virKeyFileParserCtxtPtr ctxt)\n{\n    int ret = -1;\n    const char *keystart;\n    const char *valuestart;\n    char *key = NULL;\n    char *value = NULL;\n    size_t len;\n\n    if (!ctxt->groupname || !ctxt->group) {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"value found before first group\");\n        return -1;\n    }\n\n    keystart = ctxt->cur;\n    while (!IS_EOF && g_ascii_isalnum(CUR) && CUR != '=')\n        ctxt->cur++;\n    if (CUR != '=') {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"expected end of value name, expected '='\");\n        return -1;\n    }\n\n    key = g_strndup(keystart, ctxt->cur - keystart);\n\n    NEXT;\n    valuestart = ctxt->cur;\n    while (!IS_EOF && !IS_EOL(CUR))\n        ctxt->cur++;\n    if (!(IS_EOF || IS_EOL(CUR))) {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"unexpected end of value\");\n        goto cleanup;\n    }\n    len = ctxt->cur - valuestart;\n    if (IS_EOF && !IS_EOL(CUR))\n        len++;\n    value = g_strndup(valuestart, len);\n\n    if (virHashAddEntry(ctxt->group, key, value) < 0) {\n        VIR_FREE(value);\n        goto cleanup;\n    }\n\n    NEXT;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(key);\n    return ret;\n}"
  },
  {
    "function_name": "virKeyFileParseGroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
    "lines": "103-139",
    "snippet": "static int virKeyFileParseGroup(virKeyFileParserCtxtPtr ctxt)\n{\n    int ret = -1;\n    const char *name;\n    NEXT;\n\n    ctxt->group = NULL;\n    VIR_FREE(ctxt->groupname);\n\n    name = ctxt->cur;\n    while (!IS_EOF && IS_ASCII(CUR) && CUR != ']')\n        ctxt->cur++;\n    if (CUR != ']') {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"cannot find end of group name, expected ']'\");\n        return -1;\n    }\n\n    ctxt->groupname = g_strndup(name, ctxt->cur - name);\n\n    NEXT;\n\n    if (!(ctxt->group = virHashCreate(10, virHashValueFree)))\n        goto cleanup;\n\n    if (virHashAddEntry(ctxt->conf->groups, ctxt->groupname, ctxt->group) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    if (ret != 0) {\n        virHashFree(ctxt->group);\n        ctxt->group = NULL;\n        VIR_FREE(ctxt->groupname);\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NEXT if (!IS_EOF) ctxt->cur++;",
      "#define CUR (*ctxt->cur)",
      "#define IS_EOF (ctxt->cur >= ctxt->end)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ctxt->groupname"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "ctxt->group"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "ctxt->conf->groups",
            "ctxt->groupname",
            "ctxt->group"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "10",
            "virHashValueFree"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "name",
            "ctxt->cur - name"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virKeyFileError",
          "args": [
            "ctxt",
            "VIR_ERR_CONF_SYNTAX",
            "\"cannot find end of group name, expected ']'\""
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ASCII",
          "args": [
            "CUR"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ctxt->groupname"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\n#define NEXT if (!IS_EOF) ctxt->cur++;\n#define CUR (*ctxt->cur)\n#define IS_EOF (ctxt->cur >= ctxt->end)\n\nstatic int virKeyFileParseGroup(virKeyFileParserCtxtPtr ctxt)\n{\n    int ret = -1;\n    const char *name;\n    NEXT;\n\n    ctxt->group = NULL;\n    VIR_FREE(ctxt->groupname);\n\n    name = ctxt->cur;\n    while (!IS_EOF && IS_ASCII(CUR) && CUR != ']')\n        ctxt->cur++;\n    if (CUR != ']') {\n        virKeyFileError(ctxt, VIR_ERR_CONF_SYNTAX, \"cannot find end of group name, expected ']'\");\n        return -1;\n    }\n\n    ctxt->groupname = g_strndup(name, ctxt->cur - name);\n\n    NEXT;\n\n    if (!(ctxt->group = virHashCreate(10, virHashValueFree)))\n        goto cleanup;\n\n    if (virHashAddEntry(ctxt->conf->groups, ctxt->groupname, ctxt->group) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    if (ret != 0) {\n        virHashFree(ctxt->group);\n        ctxt->group = NULL;\n        VIR_FREE(ctxt->groupname);\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virKeyFileErrorHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
    "lines": "87-100",
    "snippet": "static void\nvirKeyFileErrorHelper(const char *file, const char *func, size_t line,\n                      virKeyFileParserCtxtPtr ctxt,\n                      virErrorNumber error, const char *info)\n{\n    /* Construct the string 'filename:line: info' if we have that. */\n    if (ctxt && ctxt->filename) {\n        virReportErrorHelper(VIR_FROM_CONF, error, file, func, line,\n                             _(\"%s:%zu: %s '%s'\"), ctxt->filename, ctxt->line, info, ctxt->cur);\n    } else {\n        virReportErrorHelper(VIR_FROM_CONF, error, file, func, line,\n                             \"%s\", info);\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportErrorHelper",
          "args": [
            "VIR_FROM_CONF",
            "error",
            "file",
            "func",
            "line",
            "\"%s\"",
            "info"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "virReportErrorHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1282-1308",
          "snippet": "void virReportErrorHelper(int domcode,\n                          int errorcode,\n                          const char *filename,\n                          const char *funcname,\n                          size_t linenr,\n                          const char *fmt, ...)\n{\n    int save_errno = errno;\n    va_list args;\n    char errorMessage[VIR_ERROR_MAX_LENGTH];\n    const char *virerr;\n\n    if (fmt) {\n        va_start(args, fmt);\n        g_vsnprintf(errorMessage, sizeof(errorMessage)-1, fmt, args);\n        va_end(args);\n    } else {\n        errorMessage[0] = '\\0';\n    }\n\n    virerr = virErrorMsg(errorcode, (errorMessage[0] ? errorMessage : NULL));\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, errorcode, VIR_ERR_ERROR,\n                      virerr, errorMessage, NULL,\n                      -1, -1, virerr, errorMessage);\n    errno = save_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virReportErrorHelper(int domcode,\n                          int errorcode,\n                          const char *filename,\n                          const char *funcname,\n                          size_t linenr,\n                          const char *fmt, ...)\n{\n    int save_errno = errno;\n    va_list args;\n    char errorMessage[VIR_ERROR_MAX_LENGTH];\n    const char *virerr;\n\n    if (fmt) {\n        va_start(args, fmt);\n        g_vsnprintf(errorMessage, sizeof(errorMessage)-1, fmt, args);\n        va_end(args);\n    } else {\n        errorMessage[0] = '\\0';\n    }\n\n    virerr = virErrorMsg(errorcode, (errorMessage[0] ? errorMessage : NULL));\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, errorcode, VIR_ERR_ERROR,\n                      virerr, errorMessage, NULL,\n                      -1, -1, virerr, errorMessage);\n    errno = save_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"%s:%zu: %s '%s'\""
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic void\nvirKeyFileErrorHelper(const char *file, const char *func, size_t line,\n                      virKeyFileParserCtxtPtr ctxt,\n                      virErrorNumber error, const char *info)\n{\n    /* Construct the string 'filename:line: info' if we have that. */\n    if (ctxt && ctxt->filename) {\n        virReportErrorHelper(VIR_FROM_CONF, error, file, func, line,\n                             _(\"%s:%zu: %s '%s'\"), ctxt->filename, ctxt->line, info, ctxt->cur);\n    } else {\n        virReportErrorHelper(VIR_FROM_CONF, error, file, func, line,\n                             \"%s\", info);\n    }\n}"
  }
]