[
  {
    "function_name": "virStorageGenerateQcowPassphrase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
    "lines": "391-423",
    "snippet": "int\nvirStorageGenerateQcowPassphrase(unsigned char *dest)\n{\n    int fd;\n    size_t i;\n\n    /* A qcow passphrase is up to 16 bytes, with any data following a NUL\n       ignored.  Prohibit control and non-ASCII characters to avoid possible\n       unpleasant surprises with the qemu monitor input mechanism. */\n    fd = open(\"/dev/urandom\", O_RDONLY);\n    if (fd < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot open /dev/urandom\"));\n        return -1;\n    }\n    i = 0;\n    while (i < VIR_STORAGE_QCOW_PASSPHRASE_SIZE) {\n        ssize_t r;\n\n        while ((r = read(fd, dest + i, 1)) == -1 && errno == EINTR)\n            ;\n        if (r <= 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Cannot read from /dev/urandom\"));\n            VIR_FORCE_CLOSE(fd);\n            return -1;\n        }\n        if (dest[i] >= 0x20 && dest[i] <= 0x7E)\n            i++; /* Got an acceptable character */\n    }\n    VIR_FORCE_CLOSE(fd);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virerror.h\"",
      "#include \"virxml.h\"",
      "#include \"virstorageencryption.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"internal.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot read from /dev/urandom\")"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot read from /dev/urandom\""
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "fd",
            "dest + i",
            "1"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "pthread_sigmask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "84-92",
          "snippet": "static inline int pthread_sigmask(int how,\n                                  const void *set,\n                                  void *old)\n{\n    (void) how;\n    (void) set;\n    (void) old;\n    return 0;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int pthread_sigmask(int how,\n                                  const void *set,\n                                  void *old)\n{\n    (void) how;\n    (void) set;\n    (void) old;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot open /dev/urandom\")"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "\"/dev/urandom\"",
            "O_RDONLY"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFdopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "164-177",
          "snippet": "FILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nFILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirStorageGenerateQcowPassphrase(unsigned char *dest)\n{\n    int fd;\n    size_t i;\n\n    /* A qcow passphrase is up to 16 bytes, with any data following a NUL\n       ignored.  Prohibit control and non-ASCII characters to avoid possible\n       unpleasant surprises with the qemu monitor input mechanism. */\n    fd = open(\"/dev/urandom\", O_RDONLY);\n    if (fd < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot open /dev/urandom\"));\n        return -1;\n    }\n    i = 0;\n    while (i < VIR_STORAGE_QCOW_PASSPHRASE_SIZE) {\n        ssize_t r;\n\n        while ((r = read(fd, dest + i, 1)) == -1 && errno == EINTR)\n            ;\n        if (r <= 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Cannot read from /dev/urandom\"));\n            VIR_FORCE_CLOSE(fd);\n            return -1;\n        }\n        if (dest[i] >= 0x20 && dest[i] <= 0x7E)\n            i++; /* Got an acceptable character */\n    }\n    VIR_FORCE_CLOSE(fd);\n    return 0;\n}"
  },
  {
    "function_name": "virStorageEncryptionFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
    "lines": "361-389",
    "snippet": "int\nvirStorageEncryptionFormat(virBufferPtr buf,\n                           virStorageEncryptionPtr enc)\n{\n    const char *format;\n    size_t i;\n\n    if (!(format = virStorageEncryptionFormatTypeToString(enc->format))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"unexpected encryption format\"));\n        return -1;\n    }\n    virBufferAsprintf(buf, \"<encryption format='%s'>\\n\", format);\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < enc->nsecrets; i++) {\n        if (virStorageEncryptionSecretFormat(buf, enc->secrets[i]) < 0)\n            return -1;\n    }\n\n    if (enc->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS &&\n        enc->encinfo.cipher_name)\n        virStorageEncryptionInfoDefFormat(buf, &enc->encinfo);\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</encryption>\\n\");\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virerror.h\"",
      "#include \"virxml.h\"",
      "#include \"virstorageencryption.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"internal.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</encryption>\\n\""
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageEncryptionInfoDefFormat",
          "args": [
            "buf",
            "&enc->encinfo"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageEncryptionInfoDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
          "lines": "340-358",
          "snippet": "static void\nvirStorageEncryptionInfoDefFormat(virBufferPtr buf,\n                                  const virStorageEncryptionInfoDef *enc)\n{\n    virBufferEscapeString(buf, \"<cipher name='%s'\", enc->cipher_name);\n    virBufferAsprintf(buf, \" size='%u'\", enc->cipher_size);\n    if (enc->cipher_mode)\n        virBufferEscapeString(buf, \" mode='%s'\", enc->cipher_mode);\n    if (enc->cipher_hash)\n        virBufferEscapeString(buf, \" hash='%s'\", enc->cipher_hash);\n    virBufferAddLit(buf, \"/>\\n\");\n\n    if (enc->ivgen_name) {\n        virBufferEscapeString(buf, \"<ivgen name='%s'\", enc->ivgen_name);\n        if (enc->ivgen_hash)\n            virBufferEscapeString(buf, \" hash='%s'\", enc->ivgen_hash);\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virerror.h\"",
            "#include \"virxml.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void\nvirStorageEncryptionInfoDefFormat(virBufferPtr buf,\n                                  const virStorageEncryptionInfoDef *enc)\n{\n    virBufferEscapeString(buf, \"<cipher name='%s'\", enc->cipher_name);\n    virBufferAsprintf(buf, \" size='%u'\", enc->cipher_size);\n    if (enc->cipher_mode)\n        virBufferEscapeString(buf, \" mode='%s'\", enc->cipher_mode);\n    if (enc->cipher_hash)\n        virBufferEscapeString(buf, \" hash='%s'\", enc->cipher_hash);\n    virBufferAddLit(buf, \"/>\\n\");\n\n    if (enc->ivgen_name) {\n        virBufferEscapeString(buf, \"<ivgen name='%s'\", enc->ivgen_name);\n        if (enc->ivgen_hash)\n            virBufferEscapeString(buf, \" hash='%s'\", enc->ivgen_hash);\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageEncryptionSecretFormat",
          "args": [
            "buf",
            "enc->secrets[i]"
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageEncryptionSecretFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
          "lines": "322-337",
          "snippet": "static int\nvirStorageEncryptionSecretFormat(virBufferPtr buf,\n                                 virStorageEncryptionSecretPtr secret)\n{\n    const char *type;\n\n    if (!(type = virStorageEncryptionSecretTypeToString(secret->type))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"unexpected volume encryption secret type\"));\n        return -1;\n    }\n\n    virSecretLookupFormatSecret(buf, type, &secret->seclookupdef);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virerror.h\"",
            "#include \"virxml.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirStorageEncryptionSecretFormat(virBufferPtr buf,\n                                 virStorageEncryptionSecretPtr secret)\n{\n    const char *type;\n\n    if (!(type = virStorageEncryptionSecretTypeToString(secret->type))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"unexpected volume encryption secret type\"));\n        return -1;\n    }\n\n    virSecretLookupFormatSecret(buf, type, &secret->seclookupdef);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<encryption format='%s'>\\n\"",
            "format"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"unexpected encryption format\")"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unexpected encryption format\""
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageEncryptionFormatTypeToString",
          "args": [
            "enc->format"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirStorageEncryptionFormat(virBufferPtr buf,\n                           virStorageEncryptionPtr enc)\n{\n    const char *format;\n    size_t i;\n\n    if (!(format = virStorageEncryptionFormatTypeToString(enc->format))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"unexpected encryption format\"));\n        return -1;\n    }\n    virBufferAsprintf(buf, \"<encryption format='%s'>\\n\", format);\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < enc->nsecrets; i++) {\n        if (virStorageEncryptionSecretFormat(buf, enc->secrets[i]) < 0)\n            return -1;\n    }\n\n    if (enc->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS &&\n        enc->encinfo.cipher_name)\n        virStorageEncryptionInfoDefFormat(buf, &enc->encinfo);\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</encryption>\\n\");\n\n    return 0;\n}"
  },
  {
    "function_name": "virStorageEncryptionInfoDefFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
    "lines": "340-358",
    "snippet": "static void\nvirStorageEncryptionInfoDefFormat(virBufferPtr buf,\n                                  const virStorageEncryptionInfoDef *enc)\n{\n    virBufferEscapeString(buf, \"<cipher name='%s'\", enc->cipher_name);\n    virBufferAsprintf(buf, \" size='%u'\", enc->cipher_size);\n    if (enc->cipher_mode)\n        virBufferEscapeString(buf, \" mode='%s'\", enc->cipher_mode);\n    if (enc->cipher_hash)\n        virBufferEscapeString(buf, \" hash='%s'\", enc->cipher_hash);\n    virBufferAddLit(buf, \"/>\\n\");\n\n    if (enc->ivgen_name) {\n        virBufferEscapeString(buf, \"<ivgen name='%s'\", enc->ivgen_name);\n        if (enc->ivgen_hash)\n            virBufferEscapeString(buf, \" hash='%s'\", enc->ivgen_hash);\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virerror.h\"",
      "#include \"virxml.h\"",
      "#include \"virstorageencryption.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"internal.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"/>\\n\""
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\" hash='%s'\"",
            "enc->ivgen_hash"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"/>\\n\""
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\" size='%u'\"",
            "enc->cipher_size"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void\nvirStorageEncryptionInfoDefFormat(virBufferPtr buf,\n                                  const virStorageEncryptionInfoDef *enc)\n{\n    virBufferEscapeString(buf, \"<cipher name='%s'\", enc->cipher_name);\n    virBufferAsprintf(buf, \" size='%u'\", enc->cipher_size);\n    if (enc->cipher_mode)\n        virBufferEscapeString(buf, \" mode='%s'\", enc->cipher_mode);\n    if (enc->cipher_hash)\n        virBufferEscapeString(buf, \" hash='%s'\", enc->cipher_hash);\n    virBufferAddLit(buf, \"/>\\n\");\n\n    if (enc->ivgen_name) {\n        virBufferEscapeString(buf, \"<ivgen name='%s'\", enc->ivgen_name);\n        if (enc->ivgen_hash)\n            virBufferEscapeString(buf, \" hash='%s'\", enc->ivgen_hash);\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n}"
  },
  {
    "function_name": "virStorageEncryptionSecretFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
    "lines": "322-337",
    "snippet": "static int\nvirStorageEncryptionSecretFormat(virBufferPtr buf,\n                                 virStorageEncryptionSecretPtr secret)\n{\n    const char *type;\n\n    if (!(type = virStorageEncryptionSecretTypeToString(secret->type))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"unexpected volume encryption secret type\"));\n        return -1;\n    }\n\n    virSecretLookupFormatSecret(buf, type, &secret->seclookupdef);\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virerror.h\"",
      "#include \"virxml.h\"",
      "#include \"virstorageencryption.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"internal.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecretLookupFormatSecret",
          "args": [
            "buf",
            "type",
            "&secret->seclookupdef"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretLookupFormatSecret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsecret.c",
          "lines": "107-127",
          "snippet": "void\nvirSecretLookupFormatSecret(virBufferPtr buf,\n                            const char *secrettype,\n                            virSecretLookupTypeDefPtr def)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (secrettype)\n        virBufferAsprintf(buf, \"<secret type='%s'\", secrettype);\n    else\n        virBufferAddLit(buf, \"<secret\");\n\n    if (def->type == VIR_SECRET_LOOKUP_TYPE_UUID) {\n        virUUIDFormat(def->u.uuid, uuidstr);\n        virBufferAsprintf(buf, \" uuid='%s'/>\\n\", uuidstr);\n    } else if (def->type == VIR_SECRET_LOOKUP_TYPE_USAGE) {\n        virBufferEscapeString(buf, \" usage='%s'/>\\n\", def->u.usage);\n    } else {\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvoid\nvirSecretLookupFormatSecret(virBufferPtr buf,\n                            const char *secrettype,\n                            virSecretLookupTypeDefPtr def)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (secrettype)\n        virBufferAsprintf(buf, \"<secret type='%s'\", secrettype);\n    else\n        virBufferAddLit(buf, \"<secret\");\n\n    if (def->type == VIR_SECRET_LOOKUP_TYPE_UUID) {\n        virUUIDFormat(def->u.uuid, uuidstr);\n        virBufferAsprintf(buf, \" uuid='%s'/>\\n\", uuidstr);\n    } else if (def->type == VIR_SECRET_LOOKUP_TYPE_USAGE) {\n        virBufferEscapeString(buf, \" usage='%s'/>\\n\", def->u.usage);\n    } else {\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"unexpected volume encryption secret type\")"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unexpected volume encryption secret type\""
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageEncryptionSecretTypeToString",
          "args": [
            "secret->type"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirStorageEncryptionSecretFormat(virBufferPtr buf,\n                                 virStorageEncryptionSecretPtr secret)\n{\n    const char *type;\n\n    if (!(type = virStorageEncryptionSecretTypeToString(secret->type))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"unexpected volume encryption secret type\"));\n        return -1;\n    }\n\n    virSecretLookupFormatSecret(buf, type, &secret->seclookupdef);\n\n    return 0;\n}"
  },
  {
    "function_name": "virStorageEncryptionParseNode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
    "lines": "243-319",
    "snippet": "virStorageEncryptionPtr\nvirStorageEncryptionParseNode(xmlNodePtr node,\n                              xmlXPathContextPtr ctxt)\n{\n    xmlNodePtr saveNode = ctxt->node;\n    xmlNodePtr *nodes = NULL;\n    virStorageEncryptionPtr encdef = NULL;\n    virStorageEncryptionPtr ret = NULL;\n    char *format_str = NULL;\n    int n;\n    size_t i;\n\n    ctxt->node = node;\n\n    if (VIR_ALLOC(encdef) < 0)\n        goto cleanup;\n\n    if (!(format_str = virXPathString(\"string(./@format)\", ctxt))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"unknown volume encryption format\"));\n        goto cleanup;\n    }\n\n    if ((encdef->format =\n         virStorageEncryptionFormatTypeFromString(format_str)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown volume encryption format type %s\"),\n                       format_str);\n        goto cleanup;\n    }\n\n    if ((n = virXPathNodeSet(\"./secret\", ctxt, &nodes)) < 0)\n        goto cleanup;\n\n    if (n > 0) {\n        if (VIR_ALLOC_N(encdef->secrets, n) < 0)\n            goto cleanup;\n        encdef->nsecrets = n;\n\n        for (i = 0; i < n; i++) {\n            if (!(encdef->secrets[i] =\n                  virStorageEncryptionSecretParse(ctxt, nodes[i])))\n                goto cleanup;\n        }\n    }\n\n    if (encdef->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS) {\n        xmlNodePtr tmpnode;\n\n        if ((tmpnode = virXPathNode(\"./cipher[1]\", ctxt))) {\n            if (virStorageEncryptionInfoParseCipher(tmpnode, &encdef->encinfo) < 0)\n                goto cleanup;\n        }\n\n        if ((tmpnode = virXPathNode(\"./ivgen[1]\", ctxt))) {\n            /* If no cipher node, then fail */\n            if (!encdef->encinfo.cipher_name) {\n                virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                               _(\"ivgen element found, but cipher is missing\"));\n                goto cleanup;\n            }\n\n            if (virStorageEncryptionInfoParseIvgen(tmpnode, &encdef->encinfo) < 0)\n                goto cleanup;\n        }\n    }\n\n    ret = g_steal_pointer(&encdef);\n\n cleanup:\n    VIR_FREE(format_str);\n    VIR_FREE(nodes);\n    virStorageEncryptionFree(encdef);\n    ctxt->node = saveNode;\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virerror.h\"",
      "#include \"virxml.h\"",
      "#include \"virstorageencryption.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"internal.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStorageEncryptionFree",
          "args": [
            "encdef"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageEncryptionFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
          "lines": "70-83",
          "snippet": "void\nvirStorageEncryptionFree(virStorageEncryptionPtr enc)\n{\n    size_t i;\n\n    if (!enc)\n        return;\n\n    for (i = 0; i < enc->nsecrets; i++)\n        virStorageEncryptionSecretFree(enc->secrets[i]);\n    virStorageEncryptionInfoDefFree(&enc->encinfo);\n    VIR_FREE(enc->secrets);\n    VIR_FREE(enc);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virerror.h\"",
            "#include \"virxml.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirStorageEncryptionFree(virStorageEncryptionPtr enc)\n{\n    size_t i;\n\n    if (!enc)\n        return;\n\n    for (i = 0; i < enc->nsecrets; i++)\n        virStorageEncryptionSecretFree(enc->secrets[i]);\n    virStorageEncryptionInfoDefFree(&enc->encinfo);\n    VIR_FREE(enc->secrets);\n    VIR_FREE(enc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "nodes"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "format_str"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&encdef"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageEncryptionInfoParseIvgen",
          "args": [
            "tmpnode",
            "&encdef->encinfo"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageEncryptionInfoParseIvgen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
          "lines": "227-240",
          "snippet": "static int\nvirStorageEncryptionInfoParseIvgen(xmlNodePtr info_node,\n                                   virStorageEncryptionInfoDefPtr info)\n{\n    if (!(info->ivgen_name = virXMLPropString(info_node, \"name\"))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing ivgen info name string\"));\n        return -1;\n    }\n\n    info->ivgen_hash = virXMLPropString(info_node, \"hash\");\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virerror.h\"",
            "#include \"virxml.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirStorageEncryptionInfoParseIvgen(xmlNodePtr info_node,\n                                   virStorageEncryptionInfoDefPtr info)\n{\n    if (!(info->ivgen_name = virXMLPropString(info_node, \"name\"))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing ivgen info name string\"));\n        return -1;\n    }\n\n    info->ivgen_hash = virXMLPropString(info_node, \"hash\");\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"ivgen element found, but cipher is missing\")"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"ivgen element found, but cipher is missing\""
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathNode",
          "args": [
            "\"./ivgen[1]\"",
            "ctxt"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "608-634",
          "snippet": "xmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageEncryptionInfoParseCipher",
          "args": [
            "tmpnode",
            "&encdef->encinfo"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageEncryptionInfoParseCipher",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
          "lines": "189-224",
          "snippet": "static int\nvirStorageEncryptionInfoParseCipher(xmlNodePtr info_node,\n                                    virStorageEncryptionInfoDefPtr info)\n{\n    int ret = -1;\n    char *size_str = NULL;\n\n    if (!(info->cipher_name = virXMLPropString(info_node, \"name\"))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"cipher info missing 'name' attribute\"));\n        goto cleanup;\n    }\n\n    if ((size_str = virXMLPropString(info_node, \"size\")) &&\n        virStrToLong_uip(size_str, NULL, 10, &info->cipher_size) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"cannot parse cipher size: '%s'\"),\n                       size_str);\n        goto cleanup;\n    }\n\n    if (!size_str) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"cipher info missing 'size' attribute\"));\n        goto cleanup;\n    }\n\n    info->cipher_mode = virXMLPropString(info_node, \"mode\");\n    info->cipher_hash = virXMLPropString(info_node, \"hash\");\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(size_str);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virerror.h\"",
            "#include \"virxml.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirStorageEncryptionInfoParseCipher(xmlNodePtr info_node,\n                                    virStorageEncryptionInfoDefPtr info)\n{\n    int ret = -1;\n    char *size_str = NULL;\n\n    if (!(info->cipher_name = virXMLPropString(info_node, \"name\"))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"cipher info missing 'name' attribute\"));\n        goto cleanup;\n    }\n\n    if ((size_str = virXMLPropString(info_node, \"size\")) &&\n        virStrToLong_uip(size_str, NULL, 10, &info->cipher_size) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"cannot parse cipher size: '%s'\"),\n                       size_str);\n        goto cleanup;\n    }\n\n    if (!size_str) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"cipher info missing 'size' attribute\"));\n        goto cleanup;\n    }\n\n    info->cipher_mode = virXMLPropString(info_node, \"mode\");\n    info->cipher_hash = virXMLPropString(info_node, \"hash\");\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(size_str);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageEncryptionSecretParse",
          "args": [
            "ctxt",
            "nodes[i]"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageEncryptionSecretParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
          "lines": "142-186",
          "snippet": "static virStorageEncryptionSecretPtr\nvirStorageEncryptionSecretParse(xmlXPathContextPtr ctxt,\n                                xmlNodePtr node)\n{\n    xmlNodePtr old_node;\n    virStorageEncryptionSecretPtr ret;\n    char *type_str = NULL;\n    char *uuidstr = NULL;\n    char *usagestr = NULL;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    old_node = ctxt->node;\n    ctxt->node = node;\n\n    if (!(type_str = virXPathString(\"string(./@type)\", ctxt))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"unknown volume encryption secret type\"));\n        goto cleanup;\n    }\n\n    if ((ret->type = virStorageEncryptionSecretTypeFromString(type_str)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown volume encryption secret type %s\"),\n                       type_str);\n        goto cleanup;\n    }\n\n    if (virSecretLookupParseSecret(node, &ret->seclookupdef) < 0)\n        goto cleanup;\n\n    VIR_FREE(type_str);\n\n    ctxt->node = old_node;\n    return ret;\n\n cleanup:\n    VIR_FREE(type_str);\n    virStorageEncryptionSecretFree(ret);\n    VIR_FREE(uuidstr);\n    VIR_FREE(usagestr);\n    ctxt->node = old_node;\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virerror.h\"",
            "#include \"virxml.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virStorageEncryptionSecretPtr\nvirStorageEncryptionSecretParse(xmlXPathContextPtr ctxt,\n                                xmlNodePtr node)\n{\n    xmlNodePtr old_node;\n    virStorageEncryptionSecretPtr ret;\n    char *type_str = NULL;\n    char *uuidstr = NULL;\n    char *usagestr = NULL;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    old_node = ctxt->node;\n    ctxt->node = node;\n\n    if (!(type_str = virXPathString(\"string(./@type)\", ctxt))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"unknown volume encryption secret type\"));\n        goto cleanup;\n    }\n\n    if ((ret->type = virStorageEncryptionSecretTypeFromString(type_str)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown volume encryption secret type %s\"),\n                       type_str);\n        goto cleanup;\n    }\n\n    if (virSecretLookupParseSecret(node, &ret->seclookupdef) < 0)\n        goto cleanup;\n\n    VIR_FREE(type_str);\n\n    ctxt->node = old_node;\n    return ret;\n\n cleanup:\n    VIR_FREE(type_str);\n    virStorageEncryptionSecretFree(ret);\n    VIR_FREE(uuidstr);\n    VIR_FREE(usagestr);\n    ctxt->node = old_node;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "encdef->secrets",
            "n"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXPathNodeSet",
          "args": [
            "\"./secret\"",
            "ctxt",
            "&nodes"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNodeSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "647-694",
          "snippet": "int\nvirXPathNodeSet(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                xmlNodePtr **list)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNodeSet()\"));\n        return -1;\n    }\n\n    if (list != NULL)\n        *list = NULL;\n\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if (obj == NULL)\n        return 0;\n\n    if (obj->type != XPATH_NODESET) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Incorrect xpath '%s'\"), xpath);\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    if ((obj->nodesetval == NULL)  || (obj->nodesetval->nodeNr < 0)) {\n        xmlXPathFreeObject(obj);\n        return 0;\n    }\n\n    ret = obj->nodesetval->nodeNr;\n    if (list != NULL && ret) {\n        if (VIR_ALLOC_N(*list, ret) < 0) {\n            ret = -1;\n        } else {\n            memcpy(*list, obj->nodesetval->nodeTab,\n                   ret * sizeof(xmlNodePtr));\n        }\n    }\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathNodeSet(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                xmlNodePtr **list)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNodeSet()\"));\n        return -1;\n    }\n\n    if (list != NULL)\n        *list = NULL;\n\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if (obj == NULL)\n        return 0;\n\n    if (obj->type != XPATH_NODESET) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Incorrect xpath '%s'\"), xpath);\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    if ((obj->nodesetval == NULL)  || (obj->nodesetval->nodeNr < 0)) {\n        xmlXPathFreeObject(obj);\n        return 0;\n    }\n\n    ret = obj->nodesetval->nodeNr;\n    if (list != NULL && ret) {\n        if (VIR_ALLOC_N(*list, ret) < 0) {\n            ret = -1;\n        } else {\n            memcpy(*list, obj->nodesetval->nodeTab,\n                   ret * sizeof(xmlNodePtr));\n        }\n    }\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"unknown volume encryption format type %s\")",
            "format_str"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageEncryptionFormatTypeFromString",
          "args": [
            "format_str"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"unknown volume encryption format\")"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXPathString",
          "args": [
            "\"string(./@format)\"",
            "ctxt"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "72-96",
          "snippet": "char *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "encdef"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirStorageEncryptionPtr\nvirStorageEncryptionParseNode(xmlNodePtr node,\n                              xmlXPathContextPtr ctxt)\n{\n    xmlNodePtr saveNode = ctxt->node;\n    xmlNodePtr *nodes = NULL;\n    virStorageEncryptionPtr encdef = NULL;\n    virStorageEncryptionPtr ret = NULL;\n    char *format_str = NULL;\n    int n;\n    size_t i;\n\n    ctxt->node = node;\n\n    if (VIR_ALLOC(encdef) < 0)\n        goto cleanup;\n\n    if (!(format_str = virXPathString(\"string(./@format)\", ctxt))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"unknown volume encryption format\"));\n        goto cleanup;\n    }\n\n    if ((encdef->format =\n         virStorageEncryptionFormatTypeFromString(format_str)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown volume encryption format type %s\"),\n                       format_str);\n        goto cleanup;\n    }\n\n    if ((n = virXPathNodeSet(\"./secret\", ctxt, &nodes)) < 0)\n        goto cleanup;\n\n    if (n > 0) {\n        if (VIR_ALLOC_N(encdef->secrets, n) < 0)\n            goto cleanup;\n        encdef->nsecrets = n;\n\n        for (i = 0; i < n; i++) {\n            if (!(encdef->secrets[i] =\n                  virStorageEncryptionSecretParse(ctxt, nodes[i])))\n                goto cleanup;\n        }\n    }\n\n    if (encdef->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS) {\n        xmlNodePtr tmpnode;\n\n        if ((tmpnode = virXPathNode(\"./cipher[1]\", ctxt))) {\n            if (virStorageEncryptionInfoParseCipher(tmpnode, &encdef->encinfo) < 0)\n                goto cleanup;\n        }\n\n        if ((tmpnode = virXPathNode(\"./ivgen[1]\", ctxt))) {\n            /* If no cipher node, then fail */\n            if (!encdef->encinfo.cipher_name) {\n                virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                               _(\"ivgen element found, but cipher is missing\"));\n                goto cleanup;\n            }\n\n            if (virStorageEncryptionInfoParseIvgen(tmpnode, &encdef->encinfo) < 0)\n                goto cleanup;\n        }\n    }\n\n    ret = g_steal_pointer(&encdef);\n\n cleanup:\n    VIR_FREE(format_str);\n    VIR_FREE(nodes);\n    virStorageEncryptionFree(encdef);\n    ctxt->node = saveNode;\n\n    return ret;\n}"
  },
  {
    "function_name": "virStorageEncryptionInfoParseIvgen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
    "lines": "227-240",
    "snippet": "static int\nvirStorageEncryptionInfoParseIvgen(xmlNodePtr info_node,\n                                   virStorageEncryptionInfoDefPtr info)\n{\n    if (!(info->ivgen_name = virXMLPropString(info_node, \"name\"))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing ivgen info name string\"));\n        return -1;\n    }\n\n    info->ivgen_hash = virXMLPropString(info_node, \"hash\");\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virerror.h\"",
      "#include \"virxml.h\"",
      "#include \"virstorageencryption.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"internal.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "info_node",
            "\"hash\""
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"missing ivgen info name string\")"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"missing ivgen info name string\""
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirStorageEncryptionInfoParseIvgen(xmlNodePtr info_node,\n                                   virStorageEncryptionInfoDefPtr info)\n{\n    if (!(info->ivgen_name = virXMLPropString(info_node, \"name\"))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing ivgen info name string\"));\n        return -1;\n    }\n\n    info->ivgen_hash = virXMLPropString(info_node, \"hash\");\n\n    return 0;\n}"
  },
  {
    "function_name": "virStorageEncryptionInfoParseCipher",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
    "lines": "189-224",
    "snippet": "static int\nvirStorageEncryptionInfoParseCipher(xmlNodePtr info_node,\n                                    virStorageEncryptionInfoDefPtr info)\n{\n    int ret = -1;\n    char *size_str = NULL;\n\n    if (!(info->cipher_name = virXMLPropString(info_node, \"name\"))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"cipher info missing 'name' attribute\"));\n        goto cleanup;\n    }\n\n    if ((size_str = virXMLPropString(info_node, \"size\")) &&\n        virStrToLong_uip(size_str, NULL, 10, &info->cipher_size) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"cannot parse cipher size: '%s'\"),\n                       size_str);\n        goto cleanup;\n    }\n\n    if (!size_str) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"cipher info missing 'size' attribute\"));\n        goto cleanup;\n    }\n\n    info->cipher_mode = virXMLPropString(info_node, \"mode\");\n    info->cipher_hash = virXMLPropString(info_node, \"hash\");\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(size_str);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virerror.h\"",
      "#include \"virxml.h\"",
      "#include \"virstorageencryption.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"internal.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "size_str"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "info_node",
            "\"hash\""
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"cipher info missing 'size' attribute\")"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cipher info missing 'size' attribute\""
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"cannot parse cipher size: '%s'\")",
            "size_str"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_uip",
          "args": [
            "size_str",
            "NULL",
            "10",
            "&info->cipher_size"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"cipher info missing 'name' attribute\")"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirStorageEncryptionInfoParseCipher(xmlNodePtr info_node,\n                                    virStorageEncryptionInfoDefPtr info)\n{\n    int ret = -1;\n    char *size_str = NULL;\n\n    if (!(info->cipher_name = virXMLPropString(info_node, \"name\"))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"cipher info missing 'name' attribute\"));\n        goto cleanup;\n    }\n\n    if ((size_str = virXMLPropString(info_node, \"size\")) &&\n        virStrToLong_uip(size_str, NULL, 10, &info->cipher_size) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"cannot parse cipher size: '%s'\"),\n                       size_str);\n        goto cleanup;\n    }\n\n    if (!size_str) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"cipher info missing 'size' attribute\"));\n        goto cleanup;\n    }\n\n    info->cipher_mode = virXMLPropString(info_node, \"mode\");\n    info->cipher_hash = virXMLPropString(info_node, \"hash\");\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(size_str);\n    return ret;\n}"
  },
  {
    "function_name": "virStorageEncryptionSecretParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
    "lines": "142-186",
    "snippet": "static virStorageEncryptionSecretPtr\nvirStorageEncryptionSecretParse(xmlXPathContextPtr ctxt,\n                                xmlNodePtr node)\n{\n    xmlNodePtr old_node;\n    virStorageEncryptionSecretPtr ret;\n    char *type_str = NULL;\n    char *uuidstr = NULL;\n    char *usagestr = NULL;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    old_node = ctxt->node;\n    ctxt->node = node;\n\n    if (!(type_str = virXPathString(\"string(./@type)\", ctxt))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"unknown volume encryption secret type\"));\n        goto cleanup;\n    }\n\n    if ((ret->type = virStorageEncryptionSecretTypeFromString(type_str)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown volume encryption secret type %s\"),\n                       type_str);\n        goto cleanup;\n    }\n\n    if (virSecretLookupParseSecret(node, &ret->seclookupdef) < 0)\n        goto cleanup;\n\n    VIR_FREE(type_str);\n\n    ctxt->node = old_node;\n    return ret;\n\n cleanup:\n    VIR_FREE(type_str);\n    virStorageEncryptionSecretFree(ret);\n    VIR_FREE(uuidstr);\n    VIR_FREE(usagestr);\n    ctxt->node = old_node;\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virerror.h\"",
      "#include \"virxml.h\"",
      "#include \"virstorageencryption.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"internal.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "usagestr"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "uuidstr"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageEncryptionSecretFree",
          "args": [
            "ret"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageEncryptionSecretFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
          "lines": "61-68",
          "snippet": "static void\nvirStorageEncryptionSecretFree(virStorageEncryptionSecretPtr secret)\n{\n    if (!secret)\n        return;\n    virSecretLookupDefClear(&secret->seclookupdef);\n    VIR_FREE(secret);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virerror.h\"",
            "#include \"virxml.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void\nvirStorageEncryptionSecretFree(virStorageEncryptionSecretPtr secret)\n{\n    if (!secret)\n        return;\n    virSecretLookupDefClear(&secret->seclookupdef);\n    VIR_FREE(secret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "type_str"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "type_str"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecretLookupParseSecret",
          "args": [
            "node",
            "&ret->seclookupdef"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretLookupParseSecret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsecret.c",
          "lines": "64-104",
          "snippet": "int\nvirSecretLookupParseSecret(xmlNodePtr secretnode,\n                           virSecretLookupTypeDefPtr def)\n{\n    char *uuid;\n    char *usage;\n    int ret = -1;\n\n    uuid = virXMLPropString(secretnode, \"uuid\");\n    usage = virXMLPropString(secretnode, \"usage\");\n    if (uuid == NULL && usage == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing secret uuid or usage attribute\"));\n        goto cleanup;\n    }\n\n    if (uuid && usage) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"either secret uuid or usage expected\"));\n        goto cleanup;\n    }\n\n    if (uuid) {\n        if (virUUIDParse(uuid, def->u.uuid) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"invalid secret uuid '%s'\"), uuid);\n            goto cleanup;\n        }\n        def->type = VIR_SECRET_LOOKUP_TYPE_UUID;\n    } else {\n        def->u.usage = usage;\n        usage = NULL;\n        def->type = VIR_SECRET_LOOKUP_TYPE_USAGE;\n    }\n    ret = 0;\n\n cleanup:\n    VIR_FREE(uuid);\n    VIR_FREE(usage);\n    return ret;\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirSecretLookupParseSecret(xmlNodePtr secretnode,\n                           virSecretLookupTypeDefPtr def)\n{\n    char *uuid;\n    char *usage;\n    int ret = -1;\n\n    uuid = virXMLPropString(secretnode, \"uuid\");\n    usage = virXMLPropString(secretnode, \"usage\");\n    if (uuid == NULL && usage == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing secret uuid or usage attribute\"));\n        goto cleanup;\n    }\n\n    if (uuid && usage) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"either secret uuid or usage expected\"));\n        goto cleanup;\n    }\n\n    if (uuid) {\n        if (virUUIDParse(uuid, def->u.uuid) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"invalid secret uuid '%s'\"), uuid);\n            goto cleanup;\n        }\n        def->type = VIR_SECRET_LOOKUP_TYPE_UUID;\n    } else {\n        def->u.usage = usage;\n        usage = NULL;\n        def->type = VIR_SECRET_LOOKUP_TYPE_USAGE;\n    }\n    ret = 0;\n\n cleanup:\n    VIR_FREE(uuid);\n    VIR_FREE(usage);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"unknown volume encryption secret type %s\")",
            "type_str"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown volume encryption secret type %s\""
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageEncryptionSecretTypeFromString",
          "args": [
            "type_str"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"unknown volume encryption secret type\")"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXPathString",
          "args": [
            "\"string(./@type)\"",
            "ctxt"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "72-96",
          "snippet": "char *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ret"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virStorageEncryptionSecretPtr\nvirStorageEncryptionSecretParse(xmlXPathContextPtr ctxt,\n                                xmlNodePtr node)\n{\n    xmlNodePtr old_node;\n    virStorageEncryptionSecretPtr ret;\n    char *type_str = NULL;\n    char *uuidstr = NULL;\n    char *usagestr = NULL;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    old_node = ctxt->node;\n    ctxt->node = node;\n\n    if (!(type_str = virXPathString(\"string(./@type)\", ctxt))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"unknown volume encryption secret type\"));\n        goto cleanup;\n    }\n\n    if ((ret->type = virStorageEncryptionSecretTypeFromString(type_str)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown volume encryption secret type %s\"),\n                       type_str);\n        goto cleanup;\n    }\n\n    if (virSecretLookupParseSecret(node, &ret->seclookupdef) < 0)\n        goto cleanup;\n\n    VIR_FREE(type_str);\n\n    ctxt->node = old_node;\n    return ret;\n\n cleanup:\n    VIR_FREE(type_str);\n    virStorageEncryptionSecretFree(ret);\n    VIR_FREE(uuidstr);\n    VIR_FREE(usagestr);\n    ctxt->node = old_node;\n    return NULL;\n}"
  },
  {
    "function_name": "virStorageEncryptionCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
    "lines": "112-140",
    "snippet": "virStorageEncryptionPtr\nvirStorageEncryptionCopy(const virStorageEncryption *src)\n{\n    virStorageEncryptionPtr ret;\n    size_t i;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N(ret->secrets, src->nsecrets) < 0)\n        goto error;\n\n    ret->nsecrets = src->nsecrets;\n    ret->format = src->format;\n\n    for (i = 0; i < src->nsecrets; i++) {\n        if (!(ret->secrets[i] = virStorageEncryptionSecretCopy(src->secrets[i])))\n            goto error;\n    }\n\n    if (virStorageEncryptionInfoDefCopy(&src->encinfo, &ret->encinfo) < 0)\n        goto error;\n\n    return ret;\n\n error:\n    virStorageEncryptionFree(ret);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virerror.h\"",
      "#include \"virxml.h\"",
      "#include \"virstorageencryption.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"internal.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStorageEncryptionFree",
          "args": [
            "ret"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageEncryptionFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
          "lines": "70-83",
          "snippet": "void\nvirStorageEncryptionFree(virStorageEncryptionPtr enc)\n{\n    size_t i;\n\n    if (!enc)\n        return;\n\n    for (i = 0; i < enc->nsecrets; i++)\n        virStorageEncryptionSecretFree(enc->secrets[i]);\n    virStorageEncryptionInfoDefFree(&enc->encinfo);\n    VIR_FREE(enc->secrets);\n    VIR_FREE(enc);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virerror.h\"",
            "#include \"virxml.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirStorageEncryptionFree(virStorageEncryptionPtr enc)\n{\n    size_t i;\n\n    if (!enc)\n        return;\n\n    for (i = 0; i < enc->nsecrets; i++)\n        virStorageEncryptionSecretFree(enc->secrets[i]);\n    virStorageEncryptionInfoDefFree(&enc->encinfo);\n    VIR_FREE(enc->secrets);\n    VIR_FREE(enc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageEncryptionInfoDefCopy",
          "args": [
            "&src->encinfo",
            "&ret->encinfo"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageEncryptionInfoDefCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
          "lines": "97-109",
          "snippet": "static int\nvirStorageEncryptionInfoDefCopy(const virStorageEncryptionInfoDef *src,\n                                virStorageEncryptionInfoDefPtr dst)\n{\n    dst->cipher_size = src->cipher_size;\n    dst->cipher_name = g_strdup(src->cipher_name);\n    dst->cipher_mode = g_strdup(src->cipher_mode);\n    dst->cipher_hash = g_strdup(src->cipher_hash);\n    dst->ivgen_name = g_strdup(src->ivgen_name);\n    dst->ivgen_hash = g_strdup(src->ivgen_hash);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virerror.h\"",
            "#include \"virxml.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirStorageEncryptionInfoDefCopy(const virStorageEncryptionInfoDef *src,\n                                virStorageEncryptionInfoDefPtr dst)\n{\n    dst->cipher_size = src->cipher_size;\n    dst->cipher_name = g_strdup(src->cipher_name);\n    dst->cipher_mode = g_strdup(src->cipher_mode);\n    dst->cipher_hash = g_strdup(src->cipher_hash);\n    dst->ivgen_name = g_strdup(src->ivgen_name);\n    dst->ivgen_hash = g_strdup(src->ivgen_hash);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageEncryptionSecretCopy",
          "args": [
            "src->secrets[i]"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageEncryptionSecretCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
          "lines": "85-94",
          "snippet": "static virStorageEncryptionSecretPtr\nvirStorageEncryptionSecretCopy(const virStorageEncryptionSecret *src)\n{\n    virStorageEncryptionSecretPtr ret = g_new0(virStorageEncryptionSecret, 1);\n\n    ret->type = src->type;\n    virSecretLookupDefCopy(&ret->seclookupdef, &src->seclookupdef);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virerror.h\"",
            "#include \"virxml.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virStorageEncryptionSecretPtr\nvirStorageEncryptionSecretCopy(const virStorageEncryptionSecret *src)\n{\n    virStorageEncryptionSecretPtr ret = g_new0(virStorageEncryptionSecret, 1);\n\n    ret->type = src->type;\n    virSecretLookupDefCopy(&ret->seclookupdef, &src->seclookupdef);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "ret->secrets",
            "src->nsecrets"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ret"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirStorageEncryptionPtr\nvirStorageEncryptionCopy(const virStorageEncryption *src)\n{\n    virStorageEncryptionPtr ret;\n    size_t i;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N(ret->secrets, src->nsecrets) < 0)\n        goto error;\n\n    ret->nsecrets = src->nsecrets;\n    ret->format = src->format;\n\n    for (i = 0; i < src->nsecrets; i++) {\n        if (!(ret->secrets[i] = virStorageEncryptionSecretCopy(src->secrets[i])))\n            goto error;\n    }\n\n    if (virStorageEncryptionInfoDefCopy(&src->encinfo, &ret->encinfo) < 0)\n        goto error;\n\n    return ret;\n\n error:\n    virStorageEncryptionFree(ret);\n    return NULL;\n}"
  },
  {
    "function_name": "virStorageEncryptionInfoDefCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
    "lines": "97-109",
    "snippet": "static int\nvirStorageEncryptionInfoDefCopy(const virStorageEncryptionInfoDef *src,\n                                virStorageEncryptionInfoDefPtr dst)\n{\n    dst->cipher_size = src->cipher_size;\n    dst->cipher_name = g_strdup(src->cipher_name);\n    dst->cipher_mode = g_strdup(src->cipher_mode);\n    dst->cipher_hash = g_strdup(src->cipher_hash);\n    dst->ivgen_name = g_strdup(src->ivgen_name);\n    dst->ivgen_hash = g_strdup(src->ivgen_hash);\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virerror.h\"",
      "#include \"virxml.h\"",
      "#include \"virstorageencryption.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"internal.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "src->ivgen_hash"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirStorageEncryptionInfoDefCopy(const virStorageEncryptionInfoDef *src,\n                                virStorageEncryptionInfoDefPtr dst)\n{\n    dst->cipher_size = src->cipher_size;\n    dst->cipher_name = g_strdup(src->cipher_name);\n    dst->cipher_mode = g_strdup(src->cipher_mode);\n    dst->cipher_hash = g_strdup(src->cipher_hash);\n    dst->ivgen_name = g_strdup(src->ivgen_name);\n    dst->ivgen_hash = g_strdup(src->ivgen_hash);\n\n    return 0;\n}"
  },
  {
    "function_name": "virStorageEncryptionSecretCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
    "lines": "85-94",
    "snippet": "static virStorageEncryptionSecretPtr\nvirStorageEncryptionSecretCopy(const virStorageEncryptionSecret *src)\n{\n    virStorageEncryptionSecretPtr ret = g_new0(virStorageEncryptionSecret, 1);\n\n    ret->type = src->type;\n    virSecretLookupDefCopy(&ret->seclookupdef, &src->seclookupdef);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virerror.h\"",
      "#include \"virxml.h\"",
      "#include \"virstorageencryption.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"internal.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecretLookupDefCopy",
          "args": [
            "&ret->seclookupdef",
            "&src->seclookupdef"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretLookupDefCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsecret.c",
          "lines": "51-61",
          "snippet": "void\nvirSecretLookupDefCopy(virSecretLookupTypeDefPtr dst,\n                       const virSecretLookupTypeDef *src)\n{\n    dst->type = src->type;\n    if (dst->type == VIR_SECRET_LOOKUP_TYPE_UUID) {\n        memcpy(dst->u.uuid, src->u.uuid, VIR_UUID_BUFLEN);\n    } else if (dst->type == VIR_SECRET_LOOKUP_TYPE_USAGE) {\n        dst->u.usage = g_strdup(src->u.usage);\n    }\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvoid\nvirSecretLookupDefCopy(virSecretLookupTypeDefPtr dst,\n                       const virSecretLookupTypeDef *src)\n{\n    dst->type = src->type;\n    if (dst->type == VIR_SECRET_LOOKUP_TYPE_UUID) {\n        memcpy(dst->u.uuid, src->u.uuid, VIR_UUID_BUFLEN);\n    } else if (dst->type == VIR_SECRET_LOOKUP_TYPE_USAGE) {\n        dst->u.usage = g_strdup(src->u.usage);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "virStorageEncryptionSecret",
            "1"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virStorageEncryptionSecretPtr\nvirStorageEncryptionSecretCopy(const virStorageEncryptionSecret *src)\n{\n    virStorageEncryptionSecretPtr ret = g_new0(virStorageEncryptionSecret, 1);\n\n    ret->type = src->type;\n    virSecretLookupDefCopy(&ret->seclookupdef, &src->seclookupdef);\n\n    return ret;\n}"
  },
  {
    "function_name": "virStorageEncryptionFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
    "lines": "70-83",
    "snippet": "void\nvirStorageEncryptionFree(virStorageEncryptionPtr enc)\n{\n    size_t i;\n\n    if (!enc)\n        return;\n\n    for (i = 0; i < enc->nsecrets; i++)\n        virStorageEncryptionSecretFree(enc->secrets[i]);\n    virStorageEncryptionInfoDefFree(&enc->encinfo);\n    VIR_FREE(enc->secrets);\n    VIR_FREE(enc);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virerror.h\"",
      "#include \"virxml.h\"",
      "#include \"virstorageencryption.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"internal.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "enc"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "enc->secrets"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageEncryptionInfoDefFree",
          "args": [
            "&enc->encinfo"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageEncryptionInfoDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
          "lines": "50-58",
          "snippet": "static void\nvirStorageEncryptionInfoDefFree(virStorageEncryptionInfoDefPtr def)\n{\n    VIR_FREE(def->cipher_name);\n    VIR_FREE(def->cipher_mode);\n    VIR_FREE(def->cipher_hash);\n    VIR_FREE(def->ivgen_name);\n    VIR_FREE(def->ivgen_hash);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virerror.h\"",
            "#include \"virxml.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void\nvirStorageEncryptionInfoDefFree(virStorageEncryptionInfoDefPtr def)\n{\n    VIR_FREE(def->cipher_name);\n    VIR_FREE(def->cipher_mode);\n    VIR_FREE(def->cipher_hash);\n    VIR_FREE(def->ivgen_name);\n    VIR_FREE(def->ivgen_hash);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageEncryptionSecretFree",
          "args": [
            "enc->secrets[i]"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageEncryptionSecretFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
          "lines": "61-68",
          "snippet": "static void\nvirStorageEncryptionSecretFree(virStorageEncryptionSecretPtr secret)\n{\n    if (!secret)\n        return;\n    virSecretLookupDefClear(&secret->seclookupdef);\n    VIR_FREE(secret);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virerror.h\"",
            "#include \"virxml.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void\nvirStorageEncryptionSecretFree(virStorageEncryptionSecretPtr secret)\n{\n    if (!secret)\n        return;\n    virSecretLookupDefClear(&secret->seclookupdef);\n    VIR_FREE(secret);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirStorageEncryptionFree(virStorageEncryptionPtr enc)\n{\n    size_t i;\n\n    if (!enc)\n        return;\n\n    for (i = 0; i < enc->nsecrets; i++)\n        virStorageEncryptionSecretFree(enc->secrets[i]);\n    virStorageEncryptionInfoDefFree(&enc->encinfo);\n    VIR_FREE(enc->secrets);\n    VIR_FREE(enc);\n}"
  },
  {
    "function_name": "virStorageEncryptionSecretFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
    "lines": "61-68",
    "snippet": "static void\nvirStorageEncryptionSecretFree(virStorageEncryptionSecretPtr secret)\n{\n    if (!secret)\n        return;\n    virSecretLookupDefClear(&secret->seclookupdef);\n    VIR_FREE(secret);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virerror.h\"",
      "#include \"virxml.h\"",
      "#include \"virstorageencryption.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"internal.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "secret"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecretLookupDefClear",
          "args": [
            "&secret->seclookupdef"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretLookupDefClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsecret.c",
          "lines": "41-48",
          "snippet": "void\nvirSecretLookupDefClear(virSecretLookupTypeDefPtr def)\n{\n    if (def->type == VIR_SECRET_LOOKUP_TYPE_USAGE)\n        VIR_FREE(def->u.usage);\n    else if (def->type == VIR_SECRET_LOOKUP_TYPE_UUID)\n        memset(&def->u.uuid, 0, VIR_UUID_BUFLEN);\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvoid\nvirSecretLookupDefClear(virSecretLookupTypeDefPtr def)\n{\n    if (def->type == VIR_SECRET_LOOKUP_TYPE_USAGE)\n        VIR_FREE(def->u.usage);\n    else if (def->type == VIR_SECRET_LOOKUP_TYPE_UUID)\n        memset(&def->u.uuid, 0, VIR_UUID_BUFLEN);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void\nvirStorageEncryptionSecretFree(virStorageEncryptionSecretPtr secret)\n{\n    if (!secret)\n        return;\n    virSecretLookupDefClear(&secret->seclookupdef);\n    VIR_FREE(secret);\n}"
  },
  {
    "function_name": "virStorageEncryptionInfoDefFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
    "lines": "50-58",
    "snippet": "static void\nvirStorageEncryptionInfoDefFree(virStorageEncryptionInfoDefPtr def)\n{\n    VIR_FREE(def->cipher_name);\n    VIR_FREE(def->cipher_mode);\n    VIR_FREE(def->cipher_hash);\n    VIR_FREE(def->ivgen_name);\n    VIR_FREE(def->ivgen_hash);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsecret.h\"",
      "#include \"virfile.h\"",
      "#include \"viruuid.h\"",
      "#include \"virerror.h\"",
      "#include \"virxml.h\"",
      "#include \"virstorageencryption.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"internal.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->ivgen_hash"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->ivgen_name"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->cipher_hash"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->cipher_mode"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->cipher_name"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void\nvirStorageEncryptionInfoDefFree(virStorageEncryptionInfoDefPtr def)\n{\n    VIR_FREE(def->cipher_name);\n    VIR_FREE(def->cipher_mode);\n    VIR_FREE(def->cipher_hash);\n    VIR_FREE(def->ivgen_name);\n    VIR_FREE(def->ivgen_hash);\n}"
  }
]