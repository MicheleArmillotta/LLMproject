[
  {
    "function_name": "virModuleLoad",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmodule.c",
    "lines": "145-162",
    "snippet": "int\nvirModuleLoad(const char *path,\n              const char *regfunc G_GNUC_UNUSED,\n              bool required)\n{\n    VIR_DEBUG(\"dlopen not available on this platform\");\n    if (required) {\n        virReportSystemError(ENOSYS,\n                             _(\"Failed to find module '%s'\"), path);\n        return -1;\n    } else {\n        /* Since we have no dlopen(), but definition we have no\n         * loadable modules on disk, so we can reasonably\n         * return '1' instead of an error.\n         */\n        return 1;\n    }\n}",
    "includes": [
      "# include <dlfcn.h>",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virmodule.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Failed to find module '%s'\")",
            "path"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to find module '%s'\""
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dlopen not available on this platform\""
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <dlfcn.h>\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virmodule.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirModuleLoad(const char *path,\n              const char *regfunc G_GNUC_UNUSED,\n              bool required)\n{\n    VIR_DEBUG(\"dlopen not available on this platform\");\n    if (required) {\n        virReportSystemError(ENOSYS,\n                             _(\"Failed to find module '%s'\"), path);\n        return -1;\n    } else {\n        /* Since we have no dlopen(), but definition we have no\n         * loadable modules on disk, so we can reasonably\n         * return '1' instead of an error.\n         */\n        return 1;\n    }\n}"
  },
  {
    "function_name": "virModuleLoad",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmodule.c",
    "lines": "98-142",
    "snippet": "int\nvirModuleLoad(const char *path,\n              const char *regfunc,\n              bool required)\n{\n    void *rethandle = NULL;\n    int (*regsym)(void);\n    int ret = -1;\n\n    if (!virFileExists(path)) {\n        if (required) {\n            virReportSystemError(errno,\n                                 _(\"Failed to find module '%s'\"), path);\n            return -1;\n        } else {\n            VIR_INFO(\"Module '%s' does not exist\", path);\n            return 1;\n        }\n    }\n\n    if (!(rethandle = virModuleLoadFile(path)))\n        goto cleanup;\n\n    if (!(regsym = virModuleLoadFunc(rethandle, path, regfunc)))\n        goto cleanup;\n\n    if ((*regsym)() < 0) {\n        /* regsym() should report an error itself, but lets\n         * just make sure */\n        if (virGetLastErrorCode() == VIR_ERR_OK) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Failed to execute symbol '%s' in module '%s'\"),\n                           regfunc, path);\n        }\n        goto cleanup;\n    }\n\n    rethandle = NULL;\n    ret = 0;\n\n cleanup:\n    if (rethandle)\n        dlclose(rethandle);\n    return ret;\n}",
    "includes": [
      "# include <dlfcn.h>",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virmodule.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dlclose",
          "args": [
            "rethandle"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to execute symbol '%s' in module '%s'\")",
            "regfunc",
            "path"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to execute symbol '%s' in module '%s'\""
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetLastErrorCode",
          "args": [],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorCode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "280-287",
          "snippet": "int\nvirGetLastErrorCode(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (!err)\n        return VIR_ERR_OK;\n    return err->code;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirGetLastErrorCode(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (!err)\n        return VIR_ERR_OK;\n    return err->code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virModuleLoadFunc",
          "args": [
            "rethandle",
            "path",
            "regfunc"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "virModuleLoadFunc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmodule.c",
          "lines": "62-79",
          "snippet": "static void *\nvirModuleLoadFunc(void *handle,\n                  const char *file,\n                  const char *funcname)\n{\n    void *regsym;\n\n    VIR_DEBUG(\"Lookup function '%s'\", funcname);\n\n    if (!(regsym = dlsym(handle, funcname))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to find symbol '%s' in module '%s': %s\"),\n                       funcname, file, dlerror());\n        return NULL;\n    }\n\n    return regsym;\n}",
          "includes": [
            "# include <dlfcn.h>",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virmodule.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <dlfcn.h>\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virmodule.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void *\nvirModuleLoadFunc(void *handle,\n                  const char *file,\n                  const char *funcname)\n{\n    void *regsym;\n\n    VIR_DEBUG(\"Lookup function '%s'\", funcname);\n\n    if (!(regsym = dlsym(handle, funcname))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to find symbol '%s' in module '%s': %s\"),\n                       funcname, file, dlerror());\n        return NULL;\n    }\n\n    return regsym;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virModuleLoadFile",
          "args": [
            "path"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "virModuleLoadFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmodule.c",
          "lines": "38-59",
          "snippet": "static void *\nvirModuleLoadFile(const char *file)\n{\n    void *handle = NULL;\n    int flags = RTLD_NOW | RTLD_GLOBAL;\n\n# ifdef RTLD_NODELETE\n    flags |= RTLD_NODELETE;\n# endif\n\n    VIR_DEBUG(\"Load module file '%s'\", file);\n\n    virUpdateSelfLastChanged(file);\n\n    if (!(handle = dlopen(file, flags))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to load module '%s': %s\"), file, dlerror());\n        return NULL;\n    }\n\n    return handle;\n}",
          "includes": [
            "# include <dlfcn.h>",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virmodule.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <dlfcn.h>\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virmodule.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void *\nvirModuleLoadFile(const char *file)\n{\n    void *handle = NULL;\n    int flags = RTLD_NOW | RTLD_GLOBAL;\n\n# ifdef RTLD_NODELETE\n    flags |= RTLD_NODELETE;\n# endif\n\n    VIR_DEBUG(\"Load module file '%s'\", file);\n\n    virUpdateSelfLastChanged(file);\n\n    if (!(handle = dlopen(file, flags))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to load module '%s': %s\"), file, dlerror());\n        return NULL;\n    }\n\n    return handle;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Module '%s' does not exist\"",
            "path"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to find module '%s'\")",
            "path"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <dlfcn.h>\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virmodule.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirModuleLoad(const char *path,\n              const char *regfunc,\n              bool required)\n{\n    void *rethandle = NULL;\n    int (*regsym)(void);\n    int ret = -1;\n\n    if (!virFileExists(path)) {\n        if (required) {\n            virReportSystemError(errno,\n                                 _(\"Failed to find module '%s'\"), path);\n            return -1;\n        } else {\n            VIR_INFO(\"Module '%s' does not exist\", path);\n            return 1;\n        }\n    }\n\n    if (!(rethandle = virModuleLoadFile(path)))\n        goto cleanup;\n\n    if (!(regsym = virModuleLoadFunc(rethandle, path, regfunc)))\n        goto cleanup;\n\n    if ((*regsym)() < 0) {\n        /* regsym() should report an error itself, but lets\n         * just make sure */\n        if (virGetLastErrorCode() == VIR_ERR_OK) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Failed to execute symbol '%s' in module '%s'\"),\n                           regfunc, path);\n        }\n        goto cleanup;\n    }\n\n    rethandle = NULL;\n    ret = 0;\n\n cleanup:\n    if (rethandle)\n        dlclose(rethandle);\n    return ret;\n}"
  },
  {
    "function_name": "virModuleLoadFunc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmodule.c",
    "lines": "62-79",
    "snippet": "static void *\nvirModuleLoadFunc(void *handle,\n                  const char *file,\n                  const char *funcname)\n{\n    void *regsym;\n\n    VIR_DEBUG(\"Lookup function '%s'\", funcname);\n\n    if (!(regsym = dlsym(handle, funcname))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to find symbol '%s' in module '%s': %s\"),\n                       funcname, file, dlerror());\n        return NULL;\n    }\n\n    return regsym;\n}",
    "includes": [
      "# include <dlfcn.h>",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virmodule.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to find symbol '%s' in module '%s': %s\")",
            "funcname",
            "file",
            "dlerror()"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlerror",
          "args": [],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to find symbol '%s' in module '%s': %s\""
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlsym",
          "args": [
            "handle",
            "funcname"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Lookup function '%s'\"",
            "funcname"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <dlfcn.h>\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virmodule.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void *\nvirModuleLoadFunc(void *handle,\n                  const char *file,\n                  const char *funcname)\n{\n    void *regsym;\n\n    VIR_DEBUG(\"Lookup function '%s'\", funcname);\n\n    if (!(regsym = dlsym(handle, funcname))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to find symbol '%s' in module '%s': %s\"),\n                       funcname, file, dlerror());\n        return NULL;\n    }\n\n    return regsym;\n}"
  },
  {
    "function_name": "virModuleLoadFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmodule.c",
    "lines": "38-59",
    "snippet": "static void *\nvirModuleLoadFile(const char *file)\n{\n    void *handle = NULL;\n    int flags = RTLD_NOW | RTLD_GLOBAL;\n\n# ifdef RTLD_NODELETE\n    flags |= RTLD_NODELETE;\n# endif\n\n    VIR_DEBUG(\"Load module file '%s'\", file);\n\n    virUpdateSelfLastChanged(file);\n\n    if (!(handle = dlopen(file, flags))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to load module '%s': %s\"), file, dlerror());\n        return NULL;\n    }\n\n    return handle;\n}",
    "includes": [
      "# include <dlfcn.h>",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virmodule.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to load module '%s': %s\")",
            "file",
            "dlerror()"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlerror",
          "args": [],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to load module '%s': %s\""
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlopen",
          "args": [
            "file",
            "flags"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUpdateSelfLastChanged",
          "args": [
            "file"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "virUpdateSelfLastChanged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1574-1586",
          "snippet": "void virUpdateSelfLastChanged(const char *path)\n{\n    struct stat sb;\n\n    if (stat(path, &sb) < 0)\n        return;\n\n    if (sb.st_ctime > selfLastChanged) {\n        VIR_DEBUG(\"Setting self last changed to %lld for '%s'\",\n                  (long long)sb.st_ctime, path);\n        selfLastChanged = sb.st_ctime;\n    }\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static time_t selfLastChanged;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic time_t selfLastChanged;\n\nvoid virUpdateSelfLastChanged(const char *path)\n{\n    struct stat sb;\n\n    if (stat(path, &sb) < 0)\n        return;\n\n    if (sb.st_ctime > selfLastChanged) {\n        VIR_DEBUG(\"Setting self last changed to %lld for '%s'\",\n                  (long long)sb.st_ctime, path);\n        selfLastChanged = sb.st_ctime;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Load module file '%s'\"",
            "file"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <dlfcn.h>\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virmodule.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void *\nvirModuleLoadFile(const char *file)\n{\n    void *handle = NULL;\n    int flags = RTLD_NOW | RTLD_GLOBAL;\n\n# ifdef RTLD_NODELETE\n    flags |= RTLD_NODELETE;\n# endif\n\n    VIR_DEBUG(\"Load module file '%s'\", file);\n\n    virUpdateSelfLastChanged(file);\n\n    if (!(handle = dlopen(file, flags))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to load module '%s': %s\"), file, dlerror());\n        return NULL;\n    }\n\n    return handle;\n}"
  }
]