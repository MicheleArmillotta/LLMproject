[
  {
    "function_name": "virLockManagerFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_manager.c",
    "lines": "381-395",
    "snippet": "int virLockManagerFree(virLockManagerPtr lock)\n{\n    VIR_DEBUG(\"lock=%p\", lock);\n\n    if (!lock)\n        return 0;\n\n    CHECK_MANAGER(drvFree, -1);\n\n    lock->driver->drvFree(lock);\n\n    VIR_FREE(lock);\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include <unistd.h>",
      "# include <dlfcn.h>",
      "#include \"virstring.h\"",
      "#include \"viruuid.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"lock_driver_nop.h\"",
      "#include \"lock_manager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "lock"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lock->driver->drvFree",
          "args": [
            "lock"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_MANAGER",
          "args": [
            "drvFree",
            "-1"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"lock=%p\"",
            "lock"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include <unistd.h>\n# include <dlfcn.h>\n#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"lock_driver_nop.h\"\n#include \"lock_manager.h\"\n#include <config.h>\n\nint virLockManagerFree(virLockManagerPtr lock)\n{\n    VIR_DEBUG(\"lock=%p\", lock);\n\n    if (!lock)\n        return 0;\n\n    CHECK_MANAGER(drvFree, -1);\n\n    lock->driver->drvFree(lock);\n\n    VIR_FREE(lock);\n\n    return 0;\n}"
  },
  {
    "function_name": "virLockManagerInquire",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_manager.c",
    "lines": "369-378",
    "snippet": "int virLockManagerInquire(virLockManagerPtr lock,\n                          char **state,\n                          unsigned int flags)\n{\n    VIR_DEBUG(\"lock=%p state=%p flags=0x%x\", lock, state, flags);\n\n    CHECK_MANAGER(drvInquire, -1);\n\n    return lock->driver->drvInquire(lock, state, flags);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include <unistd.h>",
      "# include <dlfcn.h>",
      "#include \"virstring.h\"",
      "#include \"viruuid.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"lock_driver_nop.h\"",
      "#include \"lock_manager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lock->driver->drvInquire",
          "args": [
            "lock",
            "state",
            "flags"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_MANAGER",
          "args": [
            "drvInquire",
            "-1"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"lock=%p state=%p flags=0x%x\"",
            "lock",
            "state",
            "flags"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include <unistd.h>\n# include <dlfcn.h>\n#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"lock_driver_nop.h\"\n#include \"lock_manager.h\"\n#include <config.h>\n\nint virLockManagerInquire(virLockManagerPtr lock,\n                          char **state,\n                          unsigned int flags)\n{\n    VIR_DEBUG(\"lock=%p state=%p flags=0x%x\", lock, state, flags);\n\n    CHECK_MANAGER(drvInquire, -1);\n\n    return lock->driver->drvInquire(lock, state, flags);\n}"
  },
  {
    "function_name": "virLockManagerRelease",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_manager.c",
    "lines": "357-366",
    "snippet": "int virLockManagerRelease(virLockManagerPtr lock,\n                          char **state,\n                          unsigned int flags)\n{\n    VIR_DEBUG(\"lock=%p state=%p flags=0x%x\", lock, state, flags);\n\n    CHECK_MANAGER(drvRelease, -1);\n\n    return lock->driver->drvRelease(lock, state, flags);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include <unistd.h>",
      "# include <dlfcn.h>",
      "#include \"virstring.h\"",
      "#include \"viruuid.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"lock_driver_nop.h\"",
      "#include \"lock_manager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lock->driver->drvRelease",
          "args": [
            "lock",
            "state",
            "flags"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_MANAGER",
          "args": [
            "drvRelease",
            "-1"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"lock=%p state=%p flags=0x%x\"",
            "lock",
            "state",
            "flags"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include <unistd.h>\n# include <dlfcn.h>\n#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"lock_driver_nop.h\"\n#include \"lock_manager.h\"\n#include <config.h>\n\nint virLockManagerRelease(virLockManagerPtr lock,\n                          char **state,\n                          unsigned int flags)\n{\n    VIR_DEBUG(\"lock=%p state=%p flags=0x%x\", lock, state, flags);\n\n    CHECK_MANAGER(drvRelease, -1);\n\n    return lock->driver->drvRelease(lock, state, flags);\n}"
  },
  {
    "function_name": "virLockManagerAcquire",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_manager.c",
    "lines": "339-354",
    "snippet": "int virLockManagerAcquire(virLockManagerPtr lock,\n                          const char *state,\n                          unsigned int flags,\n                          virDomainLockFailureAction action,\n                          int *fd)\n{\n    VIR_DEBUG(\"lock=%p state='%s' flags=0x%x action=%d fd=%p\",\n              lock, NULLSTR(state), flags, action, fd);\n\n    CHECK_MANAGER(drvAcquire, -1);\n\n    if (fd)\n        *fd = -1;\n\n    return lock->driver->drvAcquire(lock, state, flags, action, fd);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include <unistd.h>",
      "# include <dlfcn.h>",
      "#include \"virstring.h\"",
      "#include \"viruuid.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"lock_driver_nop.h\"",
      "#include \"lock_manager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lock->driver->drvAcquire",
          "args": [
            "lock",
            "state",
            "flags",
            "action",
            "fd"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_MANAGER",
          "args": [
            "drvAcquire",
            "-1"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"lock=%p state='%s' flags=0x%x action=%d fd=%p\"",
            "lock",
            "NULLSTR(state)",
            "flags",
            "action",
            "fd"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "state"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include <unistd.h>\n# include <dlfcn.h>\n#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"lock_driver_nop.h\"\n#include \"lock_manager.h\"\n#include <config.h>\n\nint virLockManagerAcquire(virLockManagerPtr lock,\n                          const char *state,\n                          unsigned int flags,\n                          virDomainLockFailureAction action,\n                          int *fd)\n{\n    VIR_DEBUG(\"lock=%p state='%s' flags=0x%x action=%d fd=%p\",\n              lock, NULLSTR(state), flags, action, fd);\n\n    CHECK_MANAGER(drvAcquire, -1);\n\n    if (fd)\n        *fd = -1;\n\n    return lock->driver->drvAcquire(lock, state, flags, action, fd);\n}"
  },
  {
    "function_name": "virLockManagerAddResource",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_manager.c",
    "lines": "320-337",
    "snippet": "int virLockManagerAddResource(virLockManagerPtr lock,\n                              unsigned int type,\n                              const char *name,\n                              size_t nparams,\n                              virLockManagerParamPtr params,\n                              unsigned int flags)\n{\n    VIR_DEBUG(\"lock=%p type=%u name=%s nparams=%zu params=%p flags=0x%x\",\n              lock, type, name, nparams, params, flags);\n    virLockManagerLogParams(nparams, params);\n\n    CHECK_MANAGER(drvAddResource, -1);\n\n    return lock->driver->drvAddResource(lock,\n                                        type, name,\n                                        nparams, params,\n                                        flags);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include <unistd.h>",
      "# include <dlfcn.h>",
      "#include \"virstring.h\"",
      "#include \"viruuid.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"lock_driver_nop.h\"",
      "#include \"lock_manager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lock->driver->drvAddResource",
          "args": [
            "lock",
            "type",
            "name",
            "nparams",
            "params",
            "flags"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_MANAGER",
          "args": [
            "drvAddResource",
            "-1"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLockManagerLogParams",
          "args": [
            "nparams",
            "params"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "virLockManagerLogParams",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_manager.c",
          "lines": "67-101",
          "snippet": "static void virLockManagerLogParams(size_t nparams,\n                                    virLockManagerParamPtr params)\n{\n    size_t i;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    for (i = 0; i < nparams; i++) {\n        switch (params[i].type) {\n        case VIR_LOCK_MANAGER_PARAM_TYPE_INT:\n            VIR_DEBUG(\"  key=%s type=int value=%d\", params[i].key, params[i].value.iv);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_UINT:\n            VIR_DEBUG(\"  key=%s type=uint value=%u\", params[i].key, params[i].value.ui);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_LONG:\n            VIR_DEBUG(\"  key=%s type=long value=%lld\", params[i].key, params[i].value.l);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_ULONG:\n            VIR_DEBUG(\"  key=%s type=ulong value=%llu\", params[i].key, params[i].value.ul);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_DOUBLE:\n            VIR_DEBUG(\"  key=%s type=double value=%lf\", params[i].key, params[i].value.d);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_STRING:\n            VIR_DEBUG(\"  key=%s type=string value=%s\", params[i].key, params[i].value.str);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_CSTRING:\n            VIR_DEBUG(\"  key=%s type=cstring value=%s\", params[i].key, params[i].value.cstr);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_UUID:\n            virUUIDFormat(params[i].value.uuid, uuidstr);\n            VIR_DEBUG(\"  key=%s type=uuid value=%s\", params[i].key, uuidstr);\n            break;\n        }\n    }\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "# include <dlfcn.h>",
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"lock_driver_nop.h\"",
            "#include \"lock_manager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include <unistd.h>\n# include <dlfcn.h>\n#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"lock_driver_nop.h\"\n#include \"lock_manager.h\"\n#include <config.h>\n\nstatic void virLockManagerLogParams(size_t nparams,\n                                    virLockManagerParamPtr params)\n{\n    size_t i;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    for (i = 0; i < nparams; i++) {\n        switch (params[i].type) {\n        case VIR_LOCK_MANAGER_PARAM_TYPE_INT:\n            VIR_DEBUG(\"  key=%s type=int value=%d\", params[i].key, params[i].value.iv);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_UINT:\n            VIR_DEBUG(\"  key=%s type=uint value=%u\", params[i].key, params[i].value.ui);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_LONG:\n            VIR_DEBUG(\"  key=%s type=long value=%lld\", params[i].key, params[i].value.l);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_ULONG:\n            VIR_DEBUG(\"  key=%s type=ulong value=%llu\", params[i].key, params[i].value.ul);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_DOUBLE:\n            VIR_DEBUG(\"  key=%s type=double value=%lf\", params[i].key, params[i].value.d);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_STRING:\n            VIR_DEBUG(\"  key=%s type=string value=%s\", params[i].key, params[i].value.str);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_CSTRING:\n            VIR_DEBUG(\"  key=%s type=cstring value=%s\", params[i].key, params[i].value.cstr);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_UUID:\n            virUUIDFormat(params[i].value.uuid, uuidstr);\n            VIR_DEBUG(\"  key=%s type=uuid value=%s\", params[i].key, uuidstr);\n            break;\n        }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"lock=%p type=%u name=%s nparams=%zu params=%p flags=0x%x\"",
            "lock",
            "type",
            "name",
            "nparams",
            "params",
            "flags"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include <unistd.h>\n# include <dlfcn.h>\n#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"lock_driver_nop.h\"\n#include \"lock_manager.h\"\n#include <config.h>\n\nint virLockManagerAddResource(virLockManagerPtr lock,\n                              unsigned int type,\n                              const char *name,\n                              size_t nparams,\n                              virLockManagerParamPtr params,\n                              unsigned int flags)\n{\n    VIR_DEBUG(\"lock=%p type=%u name=%s nparams=%zu params=%p flags=0x%x\",\n              lock, type, name, nparams, params, flags);\n    virLockManagerLogParams(nparams, params);\n\n    CHECK_MANAGER(drvAddResource, -1);\n\n    return lock->driver->drvAddResource(lock,\n                                        type, name,\n                                        nparams, params,\n                                        flags);\n}"
  },
  {
    "function_name": "virLockManagerNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_manager.c",
    "lines": "293-317",
    "snippet": "virLockManagerPtr virLockManagerNew(virLockDriverPtr driver,\n                                    unsigned int type,\n                                    size_t nparams,\n                                    virLockManagerParamPtr params,\n                                    unsigned int flags)\n{\n    virLockManagerPtr lock;\n    VIR_DEBUG(\"driver=%p type=%u nparams=%zu params=%p flags=0x%x\",\n              driver, type, nparams, params, flags);\n    virLockManagerLogParams(nparams, params);\n\n    CHECK_DRIVER(drvNew, NULL);\n\n    if (VIR_ALLOC(lock) < 0)\n        return NULL;\n\n    lock->driver = driver;\n\n    if (driver->drvNew(lock, type, nparams, params, flags) < 0) {\n        VIR_FREE(lock);\n        return NULL;\n    }\n\n    return lock;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include <unistd.h>",
      "# include <dlfcn.h>",
      "#include \"virstring.h\"",
      "#include \"viruuid.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"lock_driver_nop.h\"",
      "#include \"lock_manager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "lock"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "driver->drvNew",
          "args": [
            "lock",
            "type",
            "nparams",
            "params",
            "flags"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "lock"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_DRIVER",
          "args": [
            "drvNew",
            "NULL"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLockManagerLogParams",
          "args": [
            "nparams",
            "params"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "virLockManagerLogParams",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_manager.c",
          "lines": "67-101",
          "snippet": "static void virLockManagerLogParams(size_t nparams,\n                                    virLockManagerParamPtr params)\n{\n    size_t i;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    for (i = 0; i < nparams; i++) {\n        switch (params[i].type) {\n        case VIR_LOCK_MANAGER_PARAM_TYPE_INT:\n            VIR_DEBUG(\"  key=%s type=int value=%d\", params[i].key, params[i].value.iv);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_UINT:\n            VIR_DEBUG(\"  key=%s type=uint value=%u\", params[i].key, params[i].value.ui);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_LONG:\n            VIR_DEBUG(\"  key=%s type=long value=%lld\", params[i].key, params[i].value.l);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_ULONG:\n            VIR_DEBUG(\"  key=%s type=ulong value=%llu\", params[i].key, params[i].value.ul);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_DOUBLE:\n            VIR_DEBUG(\"  key=%s type=double value=%lf\", params[i].key, params[i].value.d);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_STRING:\n            VIR_DEBUG(\"  key=%s type=string value=%s\", params[i].key, params[i].value.str);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_CSTRING:\n            VIR_DEBUG(\"  key=%s type=cstring value=%s\", params[i].key, params[i].value.cstr);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_UUID:\n            virUUIDFormat(params[i].value.uuid, uuidstr);\n            VIR_DEBUG(\"  key=%s type=uuid value=%s\", params[i].key, uuidstr);\n            break;\n        }\n    }\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "# include <dlfcn.h>",
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"lock_driver_nop.h\"",
            "#include \"lock_manager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include <unistd.h>\n# include <dlfcn.h>\n#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"lock_driver_nop.h\"\n#include \"lock_manager.h\"\n#include <config.h>\n\nstatic void virLockManagerLogParams(size_t nparams,\n                                    virLockManagerParamPtr params)\n{\n    size_t i;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    for (i = 0; i < nparams; i++) {\n        switch (params[i].type) {\n        case VIR_LOCK_MANAGER_PARAM_TYPE_INT:\n            VIR_DEBUG(\"  key=%s type=int value=%d\", params[i].key, params[i].value.iv);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_UINT:\n            VIR_DEBUG(\"  key=%s type=uint value=%u\", params[i].key, params[i].value.ui);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_LONG:\n            VIR_DEBUG(\"  key=%s type=long value=%lld\", params[i].key, params[i].value.l);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_ULONG:\n            VIR_DEBUG(\"  key=%s type=ulong value=%llu\", params[i].key, params[i].value.ul);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_DOUBLE:\n            VIR_DEBUG(\"  key=%s type=double value=%lf\", params[i].key, params[i].value.d);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_STRING:\n            VIR_DEBUG(\"  key=%s type=string value=%s\", params[i].key, params[i].value.str);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_CSTRING:\n            VIR_DEBUG(\"  key=%s type=cstring value=%s\", params[i].key, params[i].value.cstr);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_UUID:\n            virUUIDFormat(params[i].value.uuid, uuidstr);\n            VIR_DEBUG(\"  key=%s type=uuid value=%s\", params[i].key, uuidstr);\n            break;\n        }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"driver=%p type=%u nparams=%zu params=%p flags=0x%x\"",
            "driver",
            "type",
            "nparams",
            "params",
            "flags"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include <unistd.h>\n# include <dlfcn.h>\n#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"lock_driver_nop.h\"\n#include \"lock_manager.h\"\n#include <config.h>\n\nvirLockManagerPtr virLockManagerNew(virLockDriverPtr driver,\n                                    unsigned int type,\n                                    size_t nparams,\n                                    virLockManagerParamPtr params,\n                                    unsigned int flags)\n{\n    virLockManagerPtr lock;\n    VIR_DEBUG(\"driver=%p type=%u nparams=%zu params=%p flags=0x%x\",\n              driver, type, nparams, params, flags);\n    virLockManagerLogParams(nparams, params);\n\n    CHECK_DRIVER(drvNew, NULL);\n\n    if (VIR_ALLOC(lock) < 0)\n        return NULL;\n\n    lock->driver = driver;\n\n    if (driver->drvNew(lock, type, nparams, params, flags) < 0) {\n        VIR_FREE(lock);\n        return NULL;\n    }\n\n    return lock;\n}"
  },
  {
    "function_name": "virLockManagerPluginGetDriver",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_manager.c",
    "lines": "275-280",
    "snippet": "virLockDriverPtr virLockManagerPluginGetDriver(virLockManagerPluginPtr plugin)\n{\n    VIR_DEBUG(\"plugin=%p\", plugin);\n\n    return plugin->driver;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include <unistd.h>",
      "# include <dlfcn.h>",
      "#include \"virstring.h\"",
      "#include \"viruuid.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"lock_driver_nop.h\"",
      "#include \"lock_manager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"plugin=%p\"",
            "plugin"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include <unistd.h>\n# include <dlfcn.h>\n#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"lock_driver_nop.h\"\n#include \"lock_manager.h\"\n#include <config.h>\n\nvirLockDriverPtr virLockManagerPluginGetDriver(virLockManagerPluginPtr plugin)\n{\n    VIR_DEBUG(\"plugin=%p\", plugin);\n\n    return plugin->driver;\n}"
  },
  {
    "function_name": "virLockManagerPluginUsesState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_manager.c",
    "lines": "267-272",
    "snippet": "bool virLockManagerPluginUsesState(virLockManagerPluginPtr plugin)\n{\n    VIR_DEBUG(\"plugin=%p\", plugin);\n\n    return plugin->driver->flags & VIR_LOCK_MANAGER_USES_STATE;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include <unistd.h>",
      "# include <dlfcn.h>",
      "#include \"virstring.h\"",
      "#include \"viruuid.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"lock_driver_nop.h\"",
      "#include \"lock_manager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"plugin=%p\"",
            "plugin"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include <unistd.h>\n# include <dlfcn.h>\n#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"lock_driver_nop.h\"\n#include \"lock_manager.h\"\n#include <config.h>\n\nbool virLockManagerPluginUsesState(virLockManagerPluginPtr plugin)\n{\n    VIR_DEBUG(\"plugin=%p\", plugin);\n\n    return plugin->driver->flags & VIR_LOCK_MANAGER_USES_STATE;\n}"
  },
  {
    "function_name": "virLockManagerPluginGetName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_manager.c",
    "lines": "259-264",
    "snippet": "const char *virLockManagerPluginGetName(virLockManagerPluginPtr plugin)\n{\n    VIR_DEBUG(\"plugin=%p\", plugin);\n\n    return plugin->name;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include <unistd.h>",
      "# include <dlfcn.h>",
      "#include \"virstring.h\"",
      "#include \"viruuid.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"lock_driver_nop.h\"",
      "#include \"lock_manager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"plugin=%p\"",
            "plugin"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include <unistd.h>\n# include <dlfcn.h>\n#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"lock_driver_nop.h\"\n#include \"lock_manager.h\"\n#include <config.h>\n\nconst char *virLockManagerPluginGetName(virLockManagerPluginPtr plugin)\n{\n    VIR_DEBUG(\"plugin=%p\", plugin);\n\n    return plugin->name;\n}"
  },
  {
    "function_name": "virLockManagerPluginUnref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_manager.c",
    "lines": "253-255",
    "snippet": "void virLockManagerPluginUnref(virLockManagerPluginPtr plugin G_GNUC_UNUSED)\n{\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include <unistd.h>",
      "# include <dlfcn.h>",
      "#include \"virstring.h\"",
      "#include \"viruuid.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"lock_driver_nop.h\"",
      "#include \"lock_manager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"configmake.h\"\n#include <unistd.h>\n# include <dlfcn.h>\n#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"lock_driver_nop.h\"\n#include \"lock_manager.h\"\n#include <config.h>\n\nvoid virLockManagerPluginUnref(virLockManagerPluginPtr plugin G_GNUC_UNUSED)\n{\n}"
  },
  {
    "function_name": "virLockManagerPluginUnref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_manager.c",
    "lines": "231-251",
    "snippet": "void virLockManagerPluginUnref(virLockManagerPluginPtr plugin)\n{\n    if (!plugin)\n        return;\n\n    plugin->refs--;\n\n    if (plugin->refs > 0)\n        return;\n\n    if (plugin->driver->drvDeinit() >= 0) {\n        if (plugin->handle)\n            dlclose(plugin->handle);\n    } else {\n        VIR_WARN(\"Unable to unload lock maanger plugin from memory\");\n        return;\n    }\n\n    VIR_FREE(plugin->name);\n    VIR_FREE(plugin);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include <unistd.h>",
      "# include <dlfcn.h>",
      "#include \"virstring.h\"",
      "#include \"viruuid.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"lock_driver_nop.h\"",
      "#include \"lock_manager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "plugin"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "plugin->name"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unable to unload lock maanger plugin from memory\""
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlclose",
          "args": [
            "plugin->handle"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plugin->driver->drvDeinit",
          "args": [],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include <unistd.h>\n# include <dlfcn.h>\n#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"lock_driver_nop.h\"\n#include \"lock_manager.h\"\n#include <config.h>\n\nvoid virLockManagerPluginUnref(virLockManagerPluginPtr plugin)\n{\n    if (!plugin)\n        return;\n\n    plugin->refs--;\n\n    if (plugin->refs > 0)\n        return;\n\n    if (plugin->driver->drvDeinit() >= 0) {\n        if (plugin->handle)\n            dlclose(plugin->handle);\n    } else {\n        VIR_WARN(\"Unable to unload lock maanger plugin from memory\");\n        return;\n    }\n\n    VIR_FREE(plugin->name);\n    VIR_FREE(plugin);\n}"
  },
  {
    "function_name": "virLockManagerPluginRef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_manager.c",
    "lines": "214-217",
    "snippet": "void virLockManagerPluginRef(virLockManagerPluginPtr plugin)\n{\n    plugin->refs++;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include <unistd.h>",
      "# include <dlfcn.h>",
      "#include \"virstring.h\"",
      "#include \"viruuid.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"lock_driver_nop.h\"",
      "#include \"lock_manager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"configmake.h\"\n#include <unistd.h>\n# include <dlfcn.h>\n#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"lock_driver_nop.h\"\n#include \"lock_manager.h\"\n#include <config.h>\n\nvoid virLockManagerPluginRef(virLockManagerPluginPtr plugin)\n{\n    plugin->refs++;\n}"
  },
  {
    "function_name": "virLockManagerPluginNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_manager.c",
    "lines": "195-204",
    "snippet": "virLockManagerPluginPtr\nvirLockManagerPluginNew(const char *name G_GNUC_UNUSED,\n                        const char *driverName G_GNUC_UNUSED,\n                        const char *configDir G_GNUC_UNUSED,\n                        unsigned int flags_unused G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"this platform is missing dlopen\"));\n    return NULL;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include <unistd.h>",
      "# include <dlfcn.h>",
      "#include \"virstring.h\"",
      "#include \"viruuid.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"lock_driver_nop.h\"",
      "#include \"lock_manager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"this platform is missing dlopen\")"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"this platform is missing dlopen\""
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_driver_sanlock.c",
          "lines": "97-111",
          "snippet": "static bool\nATTRIBUTE_NONNULL(2)\nvirLockManagerSanlockError(int err,\n                           char **message)\n{\n    if (err <= -200) {\n#if HAVE_SANLOCK_STRERROR\n        *message = g_strdup(sanlock_strerror(err));\n#else\n        *message = g_strdup_printf(_(\"sanlock error %d\"), err);\n#endif\n        return true;\n    } else {\n        return false;\n    }",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virconf.h\"",
            "#include \"virfile.h\"",
            "#include \"vircrypto.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"lock_driver.h\"",
            "#include <sanlock_admin.h>",
            "#include <sanlock_resource.h>",
            "#include <sanlock.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <stdint.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virconf.h\"\n#include \"virfile.h\"\n#include \"vircrypto.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"lock_driver.h\"\n#include <sanlock_admin.h>\n#include <sanlock_resource.h>\n#include <sanlock.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <stdint.h>\n#include <config.h>\n\nstatic bool\nATTRIBUTE_NONNULL(2)\nvirLockManagerSanlockError(int err,\n                           char **message)\n{\n    if (err <= -200) {\n#if HAVE_SANLOCK_STRERROR\n        *message = g_strdup(sanlock_strerror(err));\n#else\n        *message = g_strdup_printf(_(\"sanlock error %d\"), err);\n#endif\n        return true;\n    } else {\n        return false;\n    }"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include <unistd.h>\n# include <dlfcn.h>\n#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"lock_driver_nop.h\"\n#include \"lock_manager.h\"\n#include <config.h>\n\nvirLockManagerPluginPtr\nvirLockManagerPluginNew(const char *name G_GNUC_UNUSED,\n                        const char *driverName G_GNUC_UNUSED,\n                        const char *configDir G_GNUC_UNUSED,\n                        unsigned int flags_unused G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"this platform is missing dlopen\"));\n    return NULL;\n}"
  },
  {
    "function_name": "virLockManagerPluginNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_manager.c",
    "lines": "120-193",
    "snippet": "virLockManagerPluginPtr virLockManagerPluginNew(const char *name,\n                                                const char *driverName,\n                                                const char *configDir,\n                                                unsigned int flags)\n{\n    void *handle = NULL;\n    virLockDriverPtr driver;\n    virLockManagerPluginPtr plugin = NULL;\n    char *modfile = NULL;\n    char *configFile = NULL;\n\n    VIR_DEBUG(\"name=%s driverName=%s configDir=%s flags=0x%x\",\n              name, driverName, configDir, flags);\n\n    configFile = g_strdup_printf(\"%s/%s-%s.conf\", configDir, driverName, name);\n\n    if (STREQ(name, \"nop\")) {\n        driver = &virLockDriverNop;\n    } else {\n        if (!(modfile = virFileFindResourceFull(name,\n                                                NULL,\n                                                \".so\",\n                                                abs_top_builddir \"/src/.libs\",\n                                                LIBDIR \"/libvirt/lock-driver\",\n                                                \"LIBVIRT_LOCK_MANAGER_PLUGIN_DIR\")))\n            goto cleanup;\n\n        VIR_DEBUG(\"Module load %s from %s\", name, modfile);\n\n        if (access(modfile, R_OK) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Plugin %s not accessible\"),\n                                 modfile);\n            goto cleanup;\n        }\n\n        handle = dlopen(modfile, RTLD_NOW | RTLD_LOCAL);\n        if (!handle) {\n            virReportError(VIR_ERR_SYSTEM_ERROR,\n                           _(\"Failed to load plugin %s: %s\"),\n                           modfile, dlerror());\n            goto cleanup;\n        }\n\n        if (!(driver = dlsym(handle, \"virLockDriverImpl\"))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Missing plugin initialization symbol 'virLockDriverImpl'\"));\n            goto cleanup;\n        }\n    }\n\n    if (driver->drvInit(VIR_LOCK_MANAGER_VERSION, configFile, flags) < 0)\n        goto cleanup;\n\n    if (VIR_ALLOC(plugin) < 0)\n        goto cleanup;\n\n    plugin->driver = driver;\n    plugin->handle = handle;\n    plugin->refs = 1;\n    plugin->name = g_strdup(name);\n\n    VIR_FREE(configFile);\n    VIR_FREE(modfile);\n    return plugin;\n\n cleanup:\n    VIR_FREE(configFile);\n    VIR_FREE(plugin);\n    VIR_FREE(modfile);\n    if (handle)\n        dlclose(handle);\n    return NULL;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include <unistd.h>",
      "# include <dlfcn.h>",
      "#include \"virstring.h\"",
      "#include \"viruuid.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"lock_driver_nop.h\"",
      "#include \"lock_manager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dlclose",
          "args": [
            "handle"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "modfile"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "plugin"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "configFile"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "modfile"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "configFile"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "name"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "plugin"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "driver->drvInit",
          "args": [
            "VIR_LOCK_MANAGER_VERSION",
            "configFile",
            "flags"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Missing plugin initialization symbol 'virLockDriverImpl'\")"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Missing plugin initialization symbol 'virLockDriverImpl'\""
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_driver_sanlock.c",
          "lines": "97-111",
          "snippet": "static bool\nATTRIBUTE_NONNULL(2)\nvirLockManagerSanlockError(int err,\n                           char **message)\n{\n    if (err <= -200) {\n#if HAVE_SANLOCK_STRERROR\n        *message = g_strdup(sanlock_strerror(err));\n#else\n        *message = g_strdup_printf(_(\"sanlock error %d\"), err);\n#endif\n        return true;\n    } else {\n        return false;\n    }",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virconf.h\"",
            "#include \"virfile.h\"",
            "#include \"vircrypto.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"lock_driver.h\"",
            "#include <sanlock_admin.h>",
            "#include <sanlock_resource.h>",
            "#include <sanlock.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <stdint.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virconf.h\"\n#include \"virfile.h\"\n#include \"vircrypto.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"lock_driver.h\"\n#include <sanlock_admin.h>\n#include <sanlock_resource.h>\n#include <sanlock.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <stdint.h>\n#include <config.h>\n\nstatic bool\nATTRIBUTE_NONNULL(2)\nvirLockManagerSanlockError(int err,\n                           char **message)\n{\n    if (err <= -200) {\n#if HAVE_SANLOCK_STRERROR\n        *message = g_strdup(sanlock_strerror(err));\n#else\n        *message = g_strdup_printf(_(\"sanlock error %d\"), err);\n#endif\n        return true;\n    } else {\n        return false;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "dlsym",
          "args": [
            "handle",
            "\"virLockDriverImpl\""
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_SYSTEM_ERROR",
            "_(\"Failed to load plugin %s: %s\")",
            "modfile",
            "dlerror()"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlerror",
          "args": [],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlopen",
          "args": [
            "modfile",
            "RTLD_NOW | RTLD_LOCAL"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Plugin %s not accessible\")",
            "modfile"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "modfile",
            "R_OK"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Module load %s from %s\"",
            "name",
            "modfile"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileFindResourceFull",
          "args": [
            "name",
            "NULL",
            "\".so\"",
            "abs_top_builddir \"/src/.libs\"",
            "LIBDIR \"/libvirt/lock-driver\"",
            "\"LIBVIRT_LOCK_MANAGER_PLUGIN_DIR\""
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFindResourceFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1741-1769",
          "snippet": "char *\nvirFileFindResourceFull(const char *filename,\n                        const char *prefix,\n                        const char *suffix,\n                        const char *builddir,\n                        const char *installdir,\n                        const char *envname)\n{\n    char *ret = NULL;\n    const char *envval = envname ? getenv(envname) : NULL;\n    const char *path;\n\n    if (!prefix)\n        prefix = \"\";\n    if (!suffix)\n        suffix = \"\";\n\n    if (envval)\n        path = envval;\n    else if (useDirOverride)\n        path = builddir;\n    else\n        path = installdir;\n\n    ret = g_strdup_printf(\"%s/%s%s%s\", path, prefix, filename, suffix);\n\n    VIR_DEBUG(\"Resolved '%s' to '%s'\", filename, ret);\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool useDirOverride;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool useDirOverride;\n\nchar *\nvirFileFindResourceFull(const char *filename,\n                        const char *prefix,\n                        const char *suffix,\n                        const char *builddir,\n                        const char *installdir,\n                        const char *envname)\n{\n    char *ret = NULL;\n    const char *envval = envname ? getenv(envname) : NULL;\n    const char *path;\n\n    if (!prefix)\n        prefix = \"\";\n    if (!suffix)\n        suffix = \"\";\n\n    if (envval)\n        path = envval;\n    else if (useDirOverride)\n        path = builddir;\n    else\n        path = installdir;\n\n    ret = g_strdup_printf(\"%s/%s%s%s\", path, prefix, filename, suffix);\n\n    VIR_DEBUG(\"Resolved '%s' to '%s'\", filename, ret);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "name",
            "\"nop\""
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"name=%s driverName=%s configDir=%s flags=0x%x\"",
            "name",
            "driverName",
            "configDir",
            "flags"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include <unistd.h>\n# include <dlfcn.h>\n#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"lock_driver_nop.h\"\n#include \"lock_manager.h\"\n#include <config.h>\n\nvirLockManagerPluginPtr virLockManagerPluginNew(const char *name,\n                                                const char *driverName,\n                                                const char *configDir,\n                                                unsigned int flags)\n{\n    void *handle = NULL;\n    virLockDriverPtr driver;\n    virLockManagerPluginPtr plugin = NULL;\n    char *modfile = NULL;\n    char *configFile = NULL;\n\n    VIR_DEBUG(\"name=%s driverName=%s configDir=%s flags=0x%x\",\n              name, driverName, configDir, flags);\n\n    configFile = g_strdup_printf(\"%s/%s-%s.conf\", configDir, driverName, name);\n\n    if (STREQ(name, \"nop\")) {\n        driver = &virLockDriverNop;\n    } else {\n        if (!(modfile = virFileFindResourceFull(name,\n                                                NULL,\n                                                \".so\",\n                                                abs_top_builddir \"/src/.libs\",\n                                                LIBDIR \"/libvirt/lock-driver\",\n                                                \"LIBVIRT_LOCK_MANAGER_PLUGIN_DIR\")))\n            goto cleanup;\n\n        VIR_DEBUG(\"Module load %s from %s\", name, modfile);\n\n        if (access(modfile, R_OK) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Plugin %s not accessible\"),\n                                 modfile);\n            goto cleanup;\n        }\n\n        handle = dlopen(modfile, RTLD_NOW | RTLD_LOCAL);\n        if (!handle) {\n            virReportError(VIR_ERR_SYSTEM_ERROR,\n                           _(\"Failed to load plugin %s: %s\"),\n                           modfile, dlerror());\n            goto cleanup;\n        }\n\n        if (!(driver = dlsym(handle, \"virLockDriverImpl\"))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Missing plugin initialization symbol 'virLockDriverImpl'\"));\n            goto cleanup;\n        }\n    }\n\n    if (driver->drvInit(VIR_LOCK_MANAGER_VERSION, configFile, flags) < 0)\n        goto cleanup;\n\n    if (VIR_ALLOC(plugin) < 0)\n        goto cleanup;\n\n    plugin->driver = driver;\n    plugin->handle = handle;\n    plugin->refs = 1;\n    plugin->name = g_strdup(name);\n\n    VIR_FREE(configFile);\n    VIR_FREE(modfile);\n    return plugin;\n\n cleanup:\n    VIR_FREE(configFile);\n    VIR_FREE(plugin);\n    VIR_FREE(modfile);\n    if (handle)\n        dlclose(handle);\n    return NULL;\n}"
  },
  {
    "function_name": "virLockManagerLogParams",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/locking/lock_manager.c",
    "lines": "67-101",
    "snippet": "static void virLockManagerLogParams(size_t nparams,\n                                    virLockManagerParamPtr params)\n{\n    size_t i;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    for (i = 0; i < nparams; i++) {\n        switch (params[i].type) {\n        case VIR_LOCK_MANAGER_PARAM_TYPE_INT:\n            VIR_DEBUG(\"  key=%s type=int value=%d\", params[i].key, params[i].value.iv);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_UINT:\n            VIR_DEBUG(\"  key=%s type=uint value=%u\", params[i].key, params[i].value.ui);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_LONG:\n            VIR_DEBUG(\"  key=%s type=long value=%lld\", params[i].key, params[i].value.l);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_ULONG:\n            VIR_DEBUG(\"  key=%s type=ulong value=%llu\", params[i].key, params[i].value.ul);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_DOUBLE:\n            VIR_DEBUG(\"  key=%s type=double value=%lf\", params[i].key, params[i].value.d);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_STRING:\n            VIR_DEBUG(\"  key=%s type=string value=%s\", params[i].key, params[i].value.str);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_CSTRING:\n            VIR_DEBUG(\"  key=%s type=cstring value=%s\", params[i].key, params[i].value.cstr);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_UUID:\n            virUUIDFormat(params[i].value.uuid, uuidstr);\n            VIR_DEBUG(\"  key=%s type=uuid value=%s\", params[i].key, uuidstr);\n            break;\n        }\n    }\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include <unistd.h>",
      "# include <dlfcn.h>",
      "#include \"virstring.h\"",
      "#include \"viruuid.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"lock_driver_nop.h\"",
      "#include \"lock_manager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"  key=%s type=uuid value=%s\"",
            "params[i].key",
            "uuidstr"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "params[i].value.uuid",
            "uuidstr"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"  key=%s type=cstring value=%s\"",
            "params[i].key",
            "params[i].value.cstr"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"  key=%s type=string value=%s\"",
            "params[i].key",
            "params[i].value.str"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"  key=%s type=double value=%lf\"",
            "params[i].key",
            "params[i].value.d"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"  key=%s type=ulong value=%llu\"",
            "params[i].key",
            "params[i].value.ul"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"  key=%s type=long value=%lld\"",
            "params[i].key",
            "params[i].value.l"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"  key=%s type=uint value=%u\"",
            "params[i].key",
            "params[i].value.ui"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"  key=%s type=int value=%d\"",
            "params[i].key",
            "params[i].value.iv"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include <unistd.h>\n# include <dlfcn.h>\n#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"lock_driver_nop.h\"\n#include \"lock_manager.h\"\n#include <config.h>\n\nstatic void virLockManagerLogParams(size_t nparams,\n                                    virLockManagerParamPtr params)\n{\n    size_t i;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    for (i = 0; i < nparams; i++) {\n        switch (params[i].type) {\n        case VIR_LOCK_MANAGER_PARAM_TYPE_INT:\n            VIR_DEBUG(\"  key=%s type=int value=%d\", params[i].key, params[i].value.iv);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_UINT:\n            VIR_DEBUG(\"  key=%s type=uint value=%u\", params[i].key, params[i].value.ui);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_LONG:\n            VIR_DEBUG(\"  key=%s type=long value=%lld\", params[i].key, params[i].value.l);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_ULONG:\n            VIR_DEBUG(\"  key=%s type=ulong value=%llu\", params[i].key, params[i].value.ul);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_DOUBLE:\n            VIR_DEBUG(\"  key=%s type=double value=%lf\", params[i].key, params[i].value.d);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_STRING:\n            VIR_DEBUG(\"  key=%s type=string value=%s\", params[i].key, params[i].value.str);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_CSTRING:\n            VIR_DEBUG(\"  key=%s type=cstring value=%s\", params[i].key, params[i].value.cstr);\n            break;\n        case VIR_LOCK_MANAGER_PARAM_TYPE_UUID:\n            virUUIDFormat(params[i].value.uuid, uuidstr);\n            VIR_DEBUG(\"  key=%s type=uuid value=%s\", params[i].key, uuidstr);\n            break;\n        }\n    }\n}"
  }
]