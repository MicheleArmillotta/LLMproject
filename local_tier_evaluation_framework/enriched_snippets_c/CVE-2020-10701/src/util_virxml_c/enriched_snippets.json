[
  {
    "function_name": "virXMLNamespaceRegister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1420-1434",
    "snippet": "int\nvirXMLNamespaceRegister(xmlXPathContextPtr ctxt,\n                        virXMLNamespace const *ns)\n{\n    if (xmlXPathRegisterNs(ctxt,\n                           BAD_CAST ns->prefix,\n                           BAD_CAST ns->uri) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to register xml namespace '%s'\"),\n                       ns->uri);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to register xml namespace '%s'\")",
            "ns->uri"
          ],
          "line": 1427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to register xml namespace '%s'\""
          ],
          "line": 1428
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlXPathRegisterNs",
          "args": [
            "ctxt",
            "BAD_CAST ns->prefix",
            "BAD_CAST ns->uri"
          ],
          "line": 1424
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXMLNamespaceRegister(xmlXPathContextPtr ctxt,\n                        virXMLNamespace const *ns)\n{\n    if (xmlXPathRegisterNs(ctxt,\n                           BAD_CAST ns->prefix,\n                           BAD_CAST ns->uri) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to register xml namespace '%s'\"),\n                       ns->uri);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virXMLNamespaceFormatNS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1412-1417",
    "snippet": "void\nvirXMLNamespaceFormatNS(virBufferPtr buf,\n                        virXMLNamespace const *ns)\n{\n    virBufferAsprintf(buf, \" xmlns:%s='%s'\", ns->prefix, ns->uri);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\" xmlns:%s='%s'\"",
            "ns->prefix",
            "ns->uri"
          ],
          "line": 1416
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirXMLNamespaceFormatNS(virBufferPtr buf,\n                        virXMLNamespace const *ns)\n{\n    virBufferAsprintf(buf, \" xmlns:%s='%s'\", ns->prefix, ns->uri);\n}"
  },
  {
    "function_name": "virXPathContextNodeRestore",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1402-1409",
    "snippet": "void\nvirXPathContextNodeRestore(virXPathContextNodeSavePtr save)\n{\n    if (!save->ctxt)\n        return;\n\n    save->ctxt->node = save->node;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirXPathContextNodeRestore(virXPathContextNodeSavePtr save)\n{\n    if (!save->ctxt)\n        return;\n\n    save->ctxt->node = save->node;\n}"
  },
  {
    "function_name": "virXMLFormatElement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1374-1399",
    "snippet": "void\nvirXMLFormatElement(virBufferPtr buf,\n                    const char *name,\n                    virBufferPtr attrBuf,\n                    virBufferPtr childBuf)\n{\n    if ((!attrBuf || virBufferUse(attrBuf) == 0) &&\n        (!childBuf || virBufferUse(childBuf) == 0))\n        return;\n\n    virBufferAsprintf(buf, \"<%s\", name);\n\n    if (attrBuf && virBufferUse(attrBuf) > 0)\n        virBufferAddBuffer(buf, attrBuf);\n\n    if (childBuf && virBufferUse(childBuf) > 0) {\n        virBufferAddLit(buf, \">\\n\");\n        virBufferAddBuffer(buf, childBuf);\n        virBufferAsprintf(buf, \"</%s>\\n\", name);\n    } else {\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    virBufferFreeAndReset(attrBuf);\n    virBufferFreeAndReset(childBuf);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "childBuf"
          ],
          "line": 1398
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"/>\\n\""
          ],
          "line": 1394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"</%s>\\n\"",
            "name"
          ],
          "line": 1392
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddBuffer",
          "args": [
            "buf",
            "childBuf"
          ],
          "line": 1391
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAddBuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "182-196",
          "snippet": "void\nvirBufferAddBuffer(virBufferPtr buf, virBufferPtr toadd)\n{\n    if (!toadd || !toadd->str)\n        return;\n\n    if (!buf)\n        goto cleanup;\n\n    virBufferInitialize(buf);\n    g_string_append_len(buf->str, toadd->str->str, toadd->str->len);\n\n cleanup:\n    virBufferFreeAndReset(toadd);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAddBuffer(virBufferPtr buf, virBufferPtr toadd)\n{\n    if (!toadd || !toadd->str)\n        return;\n\n    if (!buf)\n        goto cleanup;\n\n    virBufferInitialize(buf);\n    g_string_append_len(buf->str, toadd->str->str, toadd->str->len);\n\n cleanup:\n    virBufferFreeAndReset(toadd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\">\\n\""
          ],
          "line": 1390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferUse",
          "args": [
            "childBuf"
          ],
          "line": 1389
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferUse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "285-292",
          "snippet": "size_t\nvirBufferUse(const virBuffer *buf)\n{\n    if (!buf || !buf->str)\n        return 0;\n\n    return buf->str->len;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nsize_t\nvirBufferUse(const virBuffer *buf)\n{\n    if (!buf || !buf->str)\n        return 0;\n\n    return buf->str->len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirXMLFormatElement(virBufferPtr buf,\n                    const char *name,\n                    virBufferPtr attrBuf,\n                    virBufferPtr childBuf)\n{\n    if ((!attrBuf || virBufferUse(attrBuf) == 0) &&\n        (!childBuf || virBufferUse(childBuf) == 0))\n        return;\n\n    virBufferAsprintf(buf, \"<%s\", name);\n\n    if (attrBuf && virBufferUse(attrBuf) > 0)\n        virBufferAddBuffer(buf, attrBuf);\n\n    if (childBuf && virBufferUse(childBuf) > 0) {\n        virBufferAddLit(buf, \">\\n\");\n        virBufferAddBuffer(buf, childBuf);\n        virBufferAsprintf(buf, \"</%s>\\n\", name);\n    } else {\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    virBufferFreeAndReset(attrBuf);\n    virBufferFreeAndReset(childBuf);\n}"
  },
  {
    "function_name": "virXMLValidatorFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1345-1357",
    "snippet": "void\nvirXMLValidatorFree(virXMLValidatorPtr validator)\n{\n    if (!validator)\n        return;\n\n    VIR_FREE(validator->schemafile);\n    virBufferFreeAndReset(&validator->buf);\n    xmlRelaxNGFreeParserCtxt(validator->rngParser);\n    xmlRelaxNGFreeValidCtxt(validator->rngValid);\n    xmlRelaxNGFree(validator->rng);\n    VIR_FREE(validator);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "validator"
          ],
          "line": 1356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlRelaxNGFree",
          "args": [
            "validator->rng"
          ],
          "line": 1355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlRelaxNGFreeValidCtxt",
          "args": [
            "validator->rngValid"
          ],
          "line": 1354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlRelaxNGFreeParserCtxt",
          "args": [
            "validator->rngParser"
          ],
          "line": 1353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "&validator->buf"
          ],
          "line": 1352
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "validator->schemafile"
          ],
          "line": 1351
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirXMLValidatorFree(virXMLValidatorPtr validator)\n{\n    if (!validator)\n        return;\n\n    VIR_FREE(validator->schemafile);\n    virBufferFreeAndReset(&validator->buf);\n    xmlRelaxNGFreeParserCtxt(validator->rngParser);\n    xmlRelaxNGFreeValidCtxt(validator->rngValid);\n    xmlRelaxNGFree(validator->rng);\n    VIR_FREE(validator);\n}"
  },
  {
    "function_name": "virXMLValidateAgainstSchema",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1325-1342",
    "snippet": "int\nvirXMLValidateAgainstSchema(const char *schemafile,\n                            xmlDocPtr doc)\n{\n    virXMLValidatorPtr validator = NULL;\n    int ret = -1;\n\n    if (!(validator = virXMLValidatorInit(schemafile)))\n        return -1;\n\n    if (virXMLValidatorValidate(validator, doc) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virXMLValidatorFree(validator);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXMLValidatorFree",
          "args": [
            "validator"
          ],
          "line": 1340
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLValidatorFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1345-1357",
          "snippet": "void\nvirXMLValidatorFree(virXMLValidatorPtr validator)\n{\n    if (!validator)\n        return;\n\n    VIR_FREE(validator->schemafile);\n    virBufferFreeAndReset(&validator->buf);\n    xmlRelaxNGFreeParserCtxt(validator->rngParser);\n    xmlRelaxNGFreeValidCtxt(validator->rngValid);\n    xmlRelaxNGFree(validator->rng);\n    VIR_FREE(validator);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirXMLValidatorFree(virXMLValidatorPtr validator)\n{\n    if (!validator)\n        return;\n\n    VIR_FREE(validator->schemafile);\n    virBufferFreeAndReset(&validator->buf);\n    xmlRelaxNGFreeParserCtxt(validator->rngParser);\n    xmlRelaxNGFreeValidCtxt(validator->rngValid);\n    xmlRelaxNGFree(validator->rng);\n    VIR_FREE(validator);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLValidatorValidate",
          "args": [
            "validator",
            "doc"
          ],
          "line": 1335
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLValidatorValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1304-1322",
          "snippet": "int\nvirXMLValidatorValidate(virXMLValidatorPtr validator,\n                        xmlDocPtr doc)\n{\n    int ret = -1;\n\n    if (xmlRelaxNGValidateDoc(validator->rngValid, doc) != 0) {\n        virReportError(VIR_ERR_XML_INVALID_SCHEMA,\n                       _(\"Unable to validate doc against %s\\n%s\"),\n                       validator->schemafile,\n                       virBufferCurrentContent(&validator->buf));\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virBufferFreeAndReset(&validator->buf);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXMLValidatorValidate(virXMLValidatorPtr validator,\n                        xmlDocPtr doc)\n{\n    int ret = -1;\n\n    if (xmlRelaxNGValidateDoc(validator->rngValid, doc) != 0) {\n        virReportError(VIR_ERR_XML_INVALID_SCHEMA,\n                       _(\"Unable to validate doc against %s\\n%s\"),\n                       validator->schemafile,\n                       virBufferCurrentContent(&validator->buf));\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virBufferFreeAndReset(&validator->buf);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLValidatorInit",
          "args": [
            "schemafile"
          ],
          "line": 1332
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLValidatorInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1254-1301",
          "snippet": "virXMLValidatorPtr\nvirXMLValidatorInit(const char *schemafile)\n{\n    virXMLValidatorPtr validator = NULL;\n\n    if (VIR_ALLOC(validator) < 0)\n        return NULL;\n\n    validator->schemafile = g_strdup(schemafile);\n\n    if (!(validator->rngParser =\n          xmlRelaxNGNewParserCtxt(validator->schemafile))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to create RNG parser for %s\"),\n                       validator->schemafile);\n        goto error;\n    }\n\n    xmlRelaxNGSetParserErrors(validator->rngParser,\n                              catchRNGError,\n                              ignoreRNGError,\n                              &validator->buf);\n\n    if (!(validator->rng = xmlRelaxNGParse(validator->rngParser))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse RNG %s: %s\"),\n                       validator->schemafile,\n                       virBufferCurrentContent(&validator->buf));\n        goto error;\n    }\n\n    if (!(validator->rngValid = xmlRelaxNGNewValidCtxt(validator->rng))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to create RNG validation context %s\"),\n                       validator->schemafile);\n        goto error;\n    }\n\n    xmlRelaxNGSetValidErrors(validator->rngValid,\n                             catchRNGError,\n                             ignoreRNGError,\n                             &validator->buf);\n    return validator;\n\n error:\n    virXMLValidatorFree(validator);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nvirXMLValidatorPtr\nvirXMLValidatorInit(const char *schemafile)\n{\n    virXMLValidatorPtr validator = NULL;\n\n    if (VIR_ALLOC(validator) < 0)\n        return NULL;\n\n    validator->schemafile = g_strdup(schemafile);\n\n    if (!(validator->rngParser =\n          xmlRelaxNGNewParserCtxt(validator->schemafile))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to create RNG parser for %s\"),\n                       validator->schemafile);\n        goto error;\n    }\n\n    xmlRelaxNGSetParserErrors(validator->rngParser,\n                              catchRNGError,\n                              ignoreRNGError,\n                              &validator->buf);\n\n    if (!(validator->rng = xmlRelaxNGParse(validator->rngParser))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse RNG %s: %s\"),\n                       validator->schemafile,\n                       virBufferCurrentContent(&validator->buf));\n        goto error;\n    }\n\n    if (!(validator->rngValid = xmlRelaxNGNewValidCtxt(validator->rng))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to create RNG validation context %s\"),\n                       validator->schemafile);\n        goto error;\n    }\n\n    xmlRelaxNGSetValidErrors(validator->rngValid,\n                             catchRNGError,\n                             ignoreRNGError,\n                             &validator->buf);\n    return validator;\n\n error:\n    virXMLValidatorFree(validator);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXMLValidateAgainstSchema(const char *schemafile,\n                            xmlDocPtr doc)\n{\n    virXMLValidatorPtr validator = NULL;\n    int ret = -1;\n\n    if (!(validator = virXMLValidatorInit(schemafile)))\n        return -1;\n\n    if (virXMLValidatorValidate(validator, doc) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virXMLValidatorFree(validator);\n    return ret;\n}"
  },
  {
    "function_name": "virXMLValidatorValidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1304-1322",
    "snippet": "int\nvirXMLValidatorValidate(virXMLValidatorPtr validator,\n                        xmlDocPtr doc)\n{\n    int ret = -1;\n\n    if (xmlRelaxNGValidateDoc(validator->rngValid, doc) != 0) {\n        virReportError(VIR_ERR_XML_INVALID_SCHEMA,\n                       _(\"Unable to validate doc against %s\\n%s\"),\n                       validator->schemafile,\n                       virBufferCurrentContent(&validator->buf));\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virBufferFreeAndReset(&validator->buf);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "&validator->buf"
          ],
          "line": 1320
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_INVALID_SCHEMA",
            "_(\"Unable to validate doc against %s\\n%s\")",
            "validator->schemafile",
            "virBufferCurrentContent(&validator->buf)"
          ],
          "line": 1311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferCurrentContent",
          "args": [
            "&validator->buf"
          ],
          "line": 1314
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferCurrentContent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "222-233",
          "snippet": "const char *\nvirBufferCurrentContent(virBufferPtr buf)\n{\n    if (!buf)\n        return NULL;\n\n    if (!buf->str ||\n        buf->str->len == 0)\n        return \"\";\n\n    return buf->str->str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirBufferCurrentContent(virBufferPtr buf)\n{\n    if (!buf)\n        return NULL;\n\n    if (!buf->str ||\n        buf->str->len == 0)\n        return \"\";\n\n    return buf->str->str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to validate doc against %s\\n%s\""
          ],
          "line": 1312
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlRelaxNGValidateDoc",
          "args": [
            "validator->rngValid",
            "doc"
          ],
          "line": 1310
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXMLValidatorValidate(virXMLValidatorPtr validator,\n                        xmlDocPtr doc)\n{\n    int ret = -1;\n\n    if (xmlRelaxNGValidateDoc(validator->rngValid, doc) != 0) {\n        virReportError(VIR_ERR_XML_INVALID_SCHEMA,\n                       _(\"Unable to validate doc against %s\\n%s\"),\n                       validator->schemafile,\n                       virBufferCurrentContent(&validator->buf));\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virBufferFreeAndReset(&validator->buf);\n    return ret;\n}"
  },
  {
    "function_name": "virXMLValidatorInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1254-1301",
    "snippet": "virXMLValidatorPtr\nvirXMLValidatorInit(const char *schemafile)\n{\n    virXMLValidatorPtr validator = NULL;\n\n    if (VIR_ALLOC(validator) < 0)\n        return NULL;\n\n    validator->schemafile = g_strdup(schemafile);\n\n    if (!(validator->rngParser =\n          xmlRelaxNGNewParserCtxt(validator->schemafile))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to create RNG parser for %s\"),\n                       validator->schemafile);\n        goto error;\n    }\n\n    xmlRelaxNGSetParserErrors(validator->rngParser,\n                              catchRNGError,\n                              ignoreRNGError,\n                              &validator->buf);\n\n    if (!(validator->rng = xmlRelaxNGParse(validator->rngParser))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse RNG %s: %s\"),\n                       validator->schemafile,\n                       virBufferCurrentContent(&validator->buf));\n        goto error;\n    }\n\n    if (!(validator->rngValid = xmlRelaxNGNewValidCtxt(validator->rng))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to create RNG validation context %s\"),\n                       validator->schemafile);\n        goto error;\n    }\n\n    xmlRelaxNGSetValidErrors(validator->rngValid,\n                             catchRNGError,\n                             ignoreRNGError,\n                             &validator->buf);\n    return validator;\n\n error:\n    virXMLValidatorFree(validator);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXMLValidatorFree",
          "args": [
            "validator"
          ],
          "line": 1299
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLValidatorFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1345-1357",
          "snippet": "void\nvirXMLValidatorFree(virXMLValidatorPtr validator)\n{\n    if (!validator)\n        return;\n\n    VIR_FREE(validator->schemafile);\n    virBufferFreeAndReset(&validator->buf);\n    xmlRelaxNGFreeParserCtxt(validator->rngParser);\n    xmlRelaxNGFreeValidCtxt(validator->rngValid);\n    xmlRelaxNGFree(validator->rng);\n    VIR_FREE(validator);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirXMLValidatorFree(virXMLValidatorPtr validator)\n{\n    if (!validator)\n        return;\n\n    VIR_FREE(validator->schemafile);\n    virBufferFreeAndReset(&validator->buf);\n    xmlRelaxNGFreeParserCtxt(validator->rngParser);\n    xmlRelaxNGFreeValidCtxt(validator->rngValid);\n    xmlRelaxNGFree(validator->rng);\n    VIR_FREE(validator);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlRelaxNGSetValidErrors",
          "args": [
            "validator->rngValid",
            "catchRNGError",
            "ignoreRNGError",
            "&validator->buf"
          ],
          "line": 1292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to create RNG validation context %s\")",
            "validator->schemafile"
          ],
          "line": 1286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to create RNG validation context %s\""
          ],
          "line": 1287
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlRelaxNGNewValidCtxt",
          "args": [
            "validator->rng"
          ],
          "line": 1285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse RNG %s: %s\")",
            "validator->schemafile",
            "virBufferCurrentContent(&validator->buf)"
          ],
          "line": 1278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferCurrentContent",
          "args": [
            "&validator->buf"
          ],
          "line": 1281
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferCurrentContent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "222-233",
          "snippet": "const char *\nvirBufferCurrentContent(virBufferPtr buf)\n{\n    if (!buf)\n        return NULL;\n\n    if (!buf->str ||\n        buf->str->len == 0)\n        return \"\";\n\n    return buf->str->str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirBufferCurrentContent(virBufferPtr buf)\n{\n    if (!buf)\n        return NULL;\n\n    if (!buf->str ||\n        buf->str->len == 0)\n        return \"\";\n\n    return buf->str->str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlRelaxNGParse",
          "args": [
            "validator->rngParser"
          ],
          "line": 1277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlRelaxNGSetParserErrors",
          "args": [
            "validator->rngParser",
            "catchRNGError",
            "ignoreRNGError",
            "&validator->buf"
          ],
          "line": 1272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to create RNG parser for %s\")",
            "validator->schemafile"
          ],
          "line": 1266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlRelaxNGNewParserCtxt",
          "args": [
            "validator->schemafile"
          ],
          "line": 1265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "validator"
          ],
          "line": 1259
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nvirXMLValidatorPtr\nvirXMLValidatorInit(const char *schemafile)\n{\n    virXMLValidatorPtr validator = NULL;\n\n    if (VIR_ALLOC(validator) < 0)\n        return NULL;\n\n    validator->schemafile = g_strdup(schemafile);\n\n    if (!(validator->rngParser =\n          xmlRelaxNGNewParserCtxt(validator->schemafile))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to create RNG parser for %s\"),\n                       validator->schemafile);\n        goto error;\n    }\n\n    xmlRelaxNGSetParserErrors(validator->rngParser,\n                              catchRNGError,\n                              ignoreRNGError,\n                              &validator->buf);\n\n    if (!(validator->rng = xmlRelaxNGParse(validator->rngParser))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse RNG %s: %s\"),\n                       validator->schemafile,\n                       virBufferCurrentContent(&validator->buf));\n        goto error;\n    }\n\n    if (!(validator->rngValid = xmlRelaxNGNewValidCtxt(validator->rng))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to create RNG validation context %s\"),\n                       validator->schemafile);\n        goto error;\n    }\n\n    xmlRelaxNGSetValidErrors(validator->rngValid,\n                             catchRNGError,\n                             ignoreRNGError,\n                             &validator->buf);\n    return validator;\n\n error:\n    virXMLValidatorFree(validator);\n    return NULL;\n}"
  },
  {
    "function_name": "ignoreRNGError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1248-1251",
    "snippet": "static void ignoreRNGError(void *ctx G_GNUC_UNUSED,\n                           const char *msg G_GNUC_UNUSED,\n                           ...)\n{}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic void ignoreRNGError(void *ctx G_GNUC_UNUSED,\n                           const char *msg G_GNUC_UNUSED,\n                           ...)\n{}"
  },
  {
    "function_name": "catchRNGError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1233-1245",
    "snippet": "static void catchRNGError(void *ctx,\n                          const char *msg,\n                          ...)\n{\n    virBufferPtr buf = ctx;\n    va_list args;\n\n    va_start(args, msg);\n    VIR_WARNINGS_NO_PRINTF;\n    virBufferVasprintf(buf, msg, args);\n    VIR_WARNINGS_RESET;\n    va_end(args);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 1244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferVasprintf",
          "args": [
            "buf",
            "msg",
            "args"
          ],
          "line": 1242
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferVasprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "319-329",
          "snippet": "void\nvirBufferVasprintf(virBufferPtr buf, const char *format, va_list argptr)\n{\n    if ((format == NULL) || (buf == NULL))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    g_string_append_vprintf(buf->str, format, argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferVasprintf(virBufferPtr buf, const char *format, va_list argptr)\n{\n    if ((format == NULL) || (buf == NULL))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    g_string_append_vprintf(buf->str, format, argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "msg"
          ],
          "line": 1240
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic void catchRNGError(void *ctx,\n                          const char *msg,\n                          ...)\n{\n    virBufferPtr buf = ctx;\n    va_list args;\n\n    va_start(args, msg);\n    VIR_WARNINGS_NO_PRINTF;\n    virBufferVasprintf(buf, msg, args);\n    VIR_WARNINGS_RESET;\n    va_end(args);\n}"
  },
  {
    "function_name": "virXMLNodeSanitizeNamespaces",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1189-1230",
    "snippet": "void\nvirXMLNodeSanitizeNamespaces(xmlNodePtr node)\n{\n    xmlNodePtr child;\n    xmlNodePtr next;\n    xmlNodePtr dupl;\n\n    if (!node)\n        return;\n\n    child = node->children;\n    while (child) {\n        /* remove subelements that don't have any namespace at all */\n        if (!child->ns || !child->ns->href) {\n            dupl = child;\n            child = child->next;\n\n            xmlUnlinkNode(dupl);\n            xmlFreeNode(dupl);\n            continue;\n        }\n\n        /* check that every other child of @root doesn't share the namespace of\n         * the current one and delete them possibly */\n        next = child->next;\n        while (next) {\n            dupl = NULL;\n\n            if (child->ns && next->ns &&\n                STREQ_NULLABLE((const char *) child->ns->href,\n                               (const char *) next->ns->href))\n                dupl = next;\n\n            next = next->next;\n            if (dupl) {\n                xmlUnlinkNode(dupl);\n                xmlFreeNode(dupl);\n            }\n        }\n        child = child->next;\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlFreeNode",
          "args": [
            "dupl"
          ],
          "line": 1225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlUnlinkNode",
          "args": [
            "dupl"
          ],
          "line": 1224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "(const char *) child->ns->href",
            "(const char *) next->ns->href"
          ],
          "line": 1218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlFreeNode",
          "args": [
            "dupl"
          ],
          "line": 1207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlUnlinkNode",
          "args": [
            "dupl"
          ],
          "line": 1206
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirXMLNodeSanitizeNamespaces(xmlNodePtr node)\n{\n    xmlNodePtr child;\n    xmlNodePtr next;\n    xmlNodePtr dupl;\n\n    if (!node)\n        return;\n\n    child = node->children;\n    while (child) {\n        /* remove subelements that don't have any namespace at all */\n        if (!child->ns || !child->ns->href) {\n            dupl = child;\n            child = child->next;\n\n            xmlUnlinkNode(dupl);\n            xmlFreeNode(dupl);\n            continue;\n        }\n\n        /* check that every other child of @root doesn't share the namespace of\n         * the current one and delete them possibly */\n        next = child->next;\n        while (next) {\n            dupl = NULL;\n\n            if (child->ns && next->ns &&\n                STREQ_NULLABLE((const char *) child->ns->href,\n                               (const char *) next->ns->href))\n                dupl = next;\n\n            next = next->next;\n            if (dupl) {\n                xmlUnlinkNode(dupl);\n                xmlFreeNode(dupl);\n            }\n        }\n        child = child->next;\n    }\n}"
  },
  {
    "function_name": "virXMLInjectNamespace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1157-1179",
    "snippet": "int\nvirXMLInjectNamespace(xmlNodePtr node,\n                      const char *uri,\n                      const char *key)\n{\n    xmlNsPtr ns;\n\n    if (xmlValidateNCName((const unsigned char *)key, 1) != 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to validate prefix for a new XML namespace\"));\n        return -1;\n    }\n\n    if (!(ns = xmlNewNs(node, (const unsigned char *)uri, (const unsigned char *)key))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to create a new XML namespace\"));\n        return -1;\n    }\n\n    virXMLForeachNode(node, virXMLAddElementNamespace, ns);\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXMLForeachNode",
          "args": [
            "node",
            "virXMLAddElementNamespace",
            "ns"
          ],
          "line": 1176
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLForeachNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1024-1044",
          "snippet": "static int\nvirXMLForeachNode(xmlNodePtr root,\n                  virXMLForeachCallback cb,\n                  void *opaque)\n{\n    xmlNodePtr next;\n    int ret;\n\n    for (next = root; next; next = next->next) {\n        if ((ret = cb(next, opaque)) != 0)\n            return ret;\n\n        /* recurse into children */\n        if (next->children) {\n            if ((ret = virXMLForeachNode(next->children, cb, opaque)) != 0)\n                return ret;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirXMLForeachNode(xmlNodePtr root,\n                  virXMLForeachCallback cb,\n                  void *opaque)\n{\n    xmlNodePtr next;\n    int ret;\n\n    for (next = root; next; next = next->next) {\n        if ((ret = cb(next, opaque)) != 0)\n            return ret;\n\n        /* recurse into children */\n        if (next->children) {\n            if ((ret = virXMLForeachNode(next->children, cb, opaque)) != 0)\n                return ret;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"failed to create a new XML namespace\")"
          ],
          "line": 1171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to create a new XML namespace\""
          ],
          "line": 1172
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlNewNs",
          "args": [
            "node",
            "(const unsigned char *)uri",
            "(const unsigned char *)key"
          ],
          "line": 1170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"failed to validate prefix for a new XML namespace\")"
          ],
          "line": 1165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlValidateNCName",
          "args": [
            "(const unsigned char *)key",
            "1"
          ],
          "line": 1164
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXMLInjectNamespace(xmlNodePtr node,\n                      const char *uri,\n                      const char *key)\n{\n    xmlNsPtr ns;\n\n    if (xmlValidateNCName((const unsigned char *)key, 1) != 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to validate prefix for a new XML namespace\"));\n        return -1;\n    }\n\n    if (!(ns = xmlNewNs(node, (const unsigned char *)uri, (const unsigned char *)key))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to create a new XML namespace\"));\n        return -1;\n    }\n\n    virXMLForeachNode(node, virXMLAddElementNamespace, ns);\n\n    return 0;\n}"
  },
  {
    "function_name": "virXMLAddElementNamespace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1144-1154",
    "snippet": "static int\nvirXMLAddElementNamespace(xmlNodePtr node,\n                          void *opaque)\n{\n    xmlNsPtr ns = opaque;\n\n    if (!node->ns)\n        xmlSetNs(node, ns);\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlSetNs",
          "args": [
            "node",
            "ns"
          ],
          "line": 1151
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirXMLAddElementNamespace(xmlNodePtr node,\n                          void *opaque)\n{\n    xmlNsPtr ns = opaque;\n\n    if (!node->ns)\n        xmlSetNs(node, ns);\n\n    return 0;\n}"
  },
  {
    "function_name": "virXMLExtractNamespaceXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1082-1141",
    "snippet": "int\nvirXMLExtractNamespaceXML(xmlNodePtr root,\n                          const char *uri,\n                          char **doc)\n{\n    xmlNodePtr node;\n    xmlNodePtr nodeCopy = NULL;\n    xmlNsPtr actualNs;\n    xmlNsPtr prevNs = NULL;\n    char *xmlstr = NULL;\n    int ret = -1;\n\n    if (!(node = virXMLFindChildNodeByNs(root, uri))) {\n        /* node not found */\n        ret = 1;\n        goto cleanup;\n    }\n\n    /* copy the node so that we can modify the namespace */\n    if (!(nodeCopy = xmlCopyNode(node, 1))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to copy XML node\"));\n        goto cleanup;\n    }\n\n    virXMLForeachNode(nodeCopy, virXMLRemoveElementNamespace,\n                      (void *)uri);\n\n    /* remove the namespace declaration\n     *  - it's only a single linked list ... doh */\n    for (actualNs = nodeCopy->nsDef; actualNs; actualNs = actualNs->next) {\n        if (STREQ_NULLABLE((const char *)actualNs->href, uri)) {\n\n            /* unlink */\n            if (prevNs)\n                prevNs->next = actualNs->next;\n            else\n                nodeCopy->nsDef = actualNs->next;\n\n            /* discard */\n            xmlFreeNs(actualNs);\n            break;\n        }\n\n        prevNs = actualNs;\n    }\n\n    if (!(xmlstr = virXMLNodeToString(nodeCopy->doc, nodeCopy)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (doc)\n        *doc = xmlstr;\n    else\n        VIR_FREE(xmlstr);\n    xmlFreeNode(nodeCopy);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlFreeNode",
          "args": [
            "nodeCopy"
          ],
          "line": 1139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "xmlstr"
          ],
          "line": 1138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLNodeToString",
          "args": [
            "nodeCopy->doc",
            "nodeCopy"
          ],
          "line": 1129
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLNodeToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "979-1003",
          "snippet": "char *\nvirXMLNodeToString(xmlDocPtr doc,\n                   xmlNodePtr node)\n{\n    xmlBufferPtr xmlbuf = NULL;\n    char *ret = NULL;\n\n    if (!(xmlbuf = xmlBufferCreate())) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    if (xmlNodeDump(xmlbuf, doc, node, 0, 1) == 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to convert the XML node tree\"));\n        goto cleanup;\n    }\n\n    ret = g_strdup((const char *)xmlBufferContent(xmlbuf));\n\n cleanup:\n    xmlBufferFree(xmlbuf);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLNodeToString(xmlDocPtr doc,\n                   xmlNodePtr node)\n{\n    xmlBufferPtr xmlbuf = NULL;\n    char *ret = NULL;\n\n    if (!(xmlbuf = xmlBufferCreate())) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    if (xmlNodeDump(xmlbuf, doc, node, 0, 1) == 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to convert the XML node tree\"));\n        goto cleanup;\n    }\n\n    ret = g_strdup((const char *)xmlBufferContent(xmlbuf));\n\n cleanup:\n    xmlBufferFree(xmlbuf);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlFreeNs",
          "args": [
            "actualNs"
          ],
          "line": 1122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "(const char *)actualNs->href",
            "uri"
          ],
          "line": 1113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLForeachNode",
          "args": [
            "nodeCopy",
            "virXMLRemoveElementNamespace",
            "(void *)uri"
          ],
          "line": 1107
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLForeachNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1024-1044",
          "snippet": "static int\nvirXMLForeachNode(xmlNodePtr root,\n                  virXMLForeachCallback cb,\n                  void *opaque)\n{\n    xmlNodePtr next;\n    int ret;\n\n    for (next = root; next; next = next->next) {\n        if ((ret = cb(next, opaque)) != 0)\n            return ret;\n\n        /* recurse into children */\n        if (next->children) {\n            if ((ret = virXMLForeachNode(next->children, cb, opaque)) != 0)\n                return ret;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirXMLForeachNode(xmlNodePtr root,\n                  virXMLForeachCallback cb,\n                  void *opaque)\n{\n    xmlNodePtr next;\n    int ret;\n\n    for (next = root; next; next = next->next) {\n        if ((ret = cb(next, opaque)) != 0)\n            return ret;\n\n        /* recurse into children */\n        if (next->children) {\n            if ((ret = virXMLForeachNode(next->children, cb, opaque)) != 0)\n                return ret;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Failed to copy XML node\")"
          ],
          "line": 1102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to copy XML node\""
          ],
          "line": 1103
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlCopyNode",
          "args": [
            "node",
            "1"
          ],
          "line": 1101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLFindChildNodeByNs",
          "args": [
            "root",
            "uri"
          ],
          "line": 1094
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLFindChildNodeByNs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1060-1076",
          "snippet": "xmlNodePtr\nvirXMLFindChildNodeByNs(xmlNodePtr root,\n                        const char *uri)\n{\n    xmlNodePtr next;\n\n    if (!root)\n        return NULL;\n\n    for (next = root->children; next; next = next->next) {\n        if (next->ns &&\n            STREQ_NULLABLE((const char *) next->ns->href, uri))\n            return next;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlNodePtr\nvirXMLFindChildNodeByNs(xmlNodePtr root,\n                        const char *uri)\n{\n    xmlNodePtr next;\n\n    if (!root)\n        return NULL;\n\n    for (next = root->children; next; next = next->next) {\n        if (next->ns &&\n            STREQ_NULLABLE((const char *) next->ns->href, uri))\n            return next;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXMLExtractNamespaceXML(xmlNodePtr root,\n                          const char *uri,\n                          char **doc)\n{\n    xmlNodePtr node;\n    xmlNodePtr nodeCopy = NULL;\n    xmlNsPtr actualNs;\n    xmlNsPtr prevNs = NULL;\n    char *xmlstr = NULL;\n    int ret = -1;\n\n    if (!(node = virXMLFindChildNodeByNs(root, uri))) {\n        /* node not found */\n        ret = 1;\n        goto cleanup;\n    }\n\n    /* copy the node so that we can modify the namespace */\n    if (!(nodeCopy = xmlCopyNode(node, 1))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to copy XML node\"));\n        goto cleanup;\n    }\n\n    virXMLForeachNode(nodeCopy, virXMLRemoveElementNamespace,\n                      (void *)uri);\n\n    /* remove the namespace declaration\n     *  - it's only a single linked list ... doh */\n    for (actualNs = nodeCopy->nsDef; actualNs; actualNs = actualNs->next) {\n        if (STREQ_NULLABLE((const char *)actualNs->href, uri)) {\n\n            /* unlink */\n            if (prevNs)\n                prevNs->next = actualNs->next;\n            else\n                nodeCopy->nsDef = actualNs->next;\n\n            /* discard */\n            xmlFreeNs(actualNs);\n            break;\n        }\n\n        prevNs = actualNs;\n    }\n\n    if (!(xmlstr = virXMLNodeToString(nodeCopy->doc, nodeCopy)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (doc)\n        *doc = xmlstr;\n    else\n        VIR_FREE(xmlstr);\n    xmlFreeNode(nodeCopy);\n    return ret;\n}"
  },
  {
    "function_name": "virXMLFindChildNodeByNs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1060-1076",
    "snippet": "xmlNodePtr\nvirXMLFindChildNodeByNs(xmlNodePtr root,\n                        const char *uri)\n{\n    xmlNodePtr next;\n\n    if (!root)\n        return NULL;\n\n    for (next = root->children; next; next = next->next) {\n        if (next->ns &&\n            STREQ_NULLABLE((const char *) next->ns->href, uri))\n            return next;\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "(const char *) next->ns->href",
            "uri"
          ],
          "line": 1071
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlNodePtr\nvirXMLFindChildNodeByNs(xmlNodePtr root,\n                        const char *uri)\n{\n    xmlNodePtr next;\n\n    if (!root)\n        return NULL;\n\n    for (next = root->children; next; next = next->next) {\n        if (next->ns &&\n            STREQ_NULLABLE((const char *) next->ns->href, uri))\n            return next;\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "virXMLRemoveElementNamespace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1047-1057",
    "snippet": "static int\nvirXMLRemoveElementNamespace(xmlNodePtr node,\n                             void *opaque)\n{\n    const char *uri = opaque;\n\n    if (node->ns &&\n        STREQ_NULLABLE((const char *)node->ns->href, uri))\n        xmlSetNs(node, NULL);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlSetNs",
          "args": [
            "node",
            "NULL"
          ],
          "line": 1055
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "(const char *)node->ns->href",
            "uri"
          ],
          "line": 1054
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirXMLRemoveElementNamespace(xmlNodePtr node,\n                             void *opaque)\n{\n    const char *uri = opaque;\n\n    if (node->ns &&\n        STREQ_NULLABLE((const char *)node->ns->href, uri))\n        xmlSetNs(node, NULL);\n    return 0;\n}"
  },
  {
    "function_name": "virXMLForeachNode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1024-1044",
    "snippet": "static int\nvirXMLForeachNode(xmlNodePtr root,\n                  virXMLForeachCallback cb,\n                  void *opaque)\n{\n    xmlNodePtr next;\n    int ret;\n\n    for (next = root; next; next = next->next) {\n        if ((ret = cb(next, opaque)) != 0)\n            return ret;\n\n        /* recurse into children */\n        if (next->children) {\n            if ((ret = virXMLForeachNode(next->children, cb, opaque)) != 0)\n                return ret;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXMLForeachNode",
          "args": [
            "next->children",
            "cb",
            "opaque"
          ],
          "line": 1038
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLForeachNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1024-1044",
          "snippet": "static int\nvirXMLForeachNode(xmlNodePtr root,\n                  virXMLForeachCallback cb,\n                  void *opaque)\n{\n    xmlNodePtr next;\n    int ret;\n\n    for (next = root; next; next = next->next) {\n        if ((ret = cb(next, opaque)) != 0)\n            return ret;\n\n        /* recurse into children */\n        if (next->children) {\n            if ((ret = virXMLForeachNode(next->children, cb, opaque)) != 0)\n                return ret;\n        }\n    }\n\n    return 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "cb",
          "args": [
            "next",
            "opaque"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirXMLForeachNode(xmlNodePtr root,\n                  virXMLForeachCallback cb,\n                  void *opaque)\n{\n    xmlNodePtr next;\n    int ret;\n\n    for (next = root; next; next = next->next) {\n        if ((ret = cb(next, opaque)) != 0)\n            return ret;\n\n        /* recurse into children */\n        if (next->children) {\n            if ((ret = virXMLForeachNode(next->children, cb, opaque)) != 0)\n                return ret;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virXMLNodeNameEqual",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "1013-1018",
    "snippet": "bool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlStrEqual",
          "args": [
            "node->name",
            "BAD_CASTname"
          ],
          "line": 1017
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nbool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}"
  },
  {
    "function_name": "virXMLNodeToString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "979-1003",
    "snippet": "char *\nvirXMLNodeToString(xmlDocPtr doc,\n                   xmlNodePtr node)\n{\n    xmlBufferPtr xmlbuf = NULL;\n    char *ret = NULL;\n\n    if (!(xmlbuf = xmlBufferCreate())) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    if (xmlNodeDump(xmlbuf, doc, node, 0, 1) == 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to convert the XML node tree\"));\n        goto cleanup;\n    }\n\n    ret = g_strdup((const char *)xmlBufferContent(xmlbuf));\n\n cleanup:\n    xmlBufferFree(xmlbuf);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlBufferFree",
          "args": [
            "xmlbuf"
          ],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "(const char *)xmlBufferContent(xmlbuf)"
          ],
          "line": 997
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlBufferContent",
          "args": [
            "xmlbuf"
          ],
          "line": 997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"failed to convert the XML node tree\")"
          ],
          "line": 992
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlNodeDump",
          "args": [
            "xmlbuf",
            "doc",
            "node",
            "0",
            "1"
          ],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportOOMError",
          "args": [],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlBufferCreate",
          "args": [],
          "line": 986
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLNodeToString(xmlDocPtr doc,\n                   xmlNodePtr node)\n{\n    xmlBufferPtr xmlbuf = NULL;\n    char *ret = NULL;\n\n    if (!(xmlbuf = xmlBufferCreate())) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    if (xmlNodeDump(xmlbuf, doc, node, 0, 1) == 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to convert the XML node tree\"));\n        goto cleanup;\n    }\n\n    ret = g_strdup((const char *)xmlBufferContent(xmlbuf));\n\n cleanup:\n    xmlBufferFree(xmlbuf);\n\n    return ret;\n}"
  },
  {
    "function_name": "virXMLChildElementCount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "953-970",
    "snippet": "long\nvirXMLChildElementCount(xmlNodePtr node)\n{\n    long ret = 0;\n    xmlNodePtr cur = NULL;\n\n    /* xmlChildElementCount returns 0 on error, which isn't helpful;\n     * besides, it is not available in libxml2 2.6.  */\n    if (!node || node->type != XML_ELEMENT_NODE)\n        return -1;\n    cur = node->children;\n    while (cur) {\n        if (cur->type == XML_ELEMENT_NODE)\n            ret++;\n        cur = cur->next;\n    }\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nlong\nvirXMLChildElementCount(xmlNodePtr node)\n{\n    long ret = 0;\n    xmlNodePtr cur = NULL;\n\n    /* xmlChildElementCount returns 0 on error, which isn't helpful;\n     * besides, it is not available in libxml2 2.6.  */\n    if (!node || node->type != XML_ELEMENT_NODE)\n        return -1;\n    cur = node->children;\n    while (cur) {\n        if (cur->type == XML_ELEMENT_NODE)\n            ret++;\n        cur = cur->next;\n    }\n    return ret;\n}"
  },
  {
    "function_name": "virXMLSaveFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "941-950",
    "snippet": "int\nvirXMLSaveFile(const char *path,\n               const char *warnName,\n               const char *warnCommand,\n               const char *xml)\n{\n    struct virXMLRewriteFileData data = { warnName, warnCommand, xml };\n\n    return virFileRewrite(path, S_IRUSR | S_IWUSR, virXMLRewriteFile, &data);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileRewrite",
          "args": [
            "path",
            "S_IRUSR | S_IWUSR",
            "virXMLRewriteFile",
            "&data"
          ],
          "line": 949
        },
        "resolved": true,
        "details": {
          "function_name": "virFileRewrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "518-566",
          "snippet": "int\nvirFileRewrite(const char *path,\n               mode_t mode,\n               virFileRewriteFunc rewrite,\n               const void *opaque)\n{\n    g_autofree char *newfile = NULL;\n    int fd = -1;\n    int ret = -1;\n\n    newfile = g_strdup_printf(\"%s.new\", path);\n\n    if ((fd = open(newfile, O_WRONLY | O_CREAT | O_TRUNC, mode)) < 0) {\n        virReportSystemError(errno, _(\"cannot create file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (rewrite(fd, opaque) < 0) {\n        virReportSystemError(errno, _(\"cannot write data to file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (g_fsync(fd) < 0) {\n        virReportSystemError(errno, _(\"cannot sync file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (VIR_CLOSE(fd) < 0) {\n        virReportSystemError(errno, _(\"cannot save file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (rename(newfile, path) < 0) {\n        virReportSystemError(errno, _(\"cannot rename file '%s' as '%s'\"),\n                             newfile, path);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FORCE_CLOSE(fd);\n    unlink(newfile);\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileRewrite(const char *path,\n               mode_t mode,\n               virFileRewriteFunc rewrite,\n               const void *opaque)\n{\n    g_autofree char *newfile = NULL;\n    int fd = -1;\n    int ret = -1;\n\n    newfile = g_strdup_printf(\"%s.new\", path);\n\n    if ((fd = open(newfile, O_WRONLY | O_CREAT | O_TRUNC, mode)) < 0) {\n        virReportSystemError(errno, _(\"cannot create file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (rewrite(fd, opaque) < 0) {\n        virReportSystemError(errno, _(\"cannot write data to file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (g_fsync(fd) < 0) {\n        virReportSystemError(errno, _(\"cannot sync file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (VIR_CLOSE(fd) < 0) {\n        virReportSystemError(errno, _(\"cannot save file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (rename(newfile, path) < 0) {\n        virReportSystemError(errno, _(\"cannot rename file '%s' as '%s'\"),\n                             newfile, path);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FORCE_CLOSE(fd);\n    unlink(newfile);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXMLSaveFile(const char *path,\n               const char *warnName,\n               const char *warnCommand,\n               const char *xml)\n{\n    struct virXMLRewriteFileData data = { warnName, warnCommand, xml };\n\n    return virFileRewrite(path, S_IRUSR | S_IWUSR, virXMLRewriteFile, &data);\n}"
  },
  {
    "function_name": "virXMLRewriteFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "925-939",
    "snippet": "static int\nvirXMLRewriteFile(int fd, const void *opaque)\n{\n    const struct virXMLRewriteFileData *data = opaque;\n\n    if (data->warnCommand) {\n        if (virXMLEmitWarning(fd, data->warnName, data->warnCommand) < 0)\n            return -1;\n    }\n\n    if (safewrite(fd, data->xml, strlen(data->xml)) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "safewrite",
          "args": [
            "fd",
            "data->xml",
            "strlen(data->xml)"
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "safewrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1093-1111",
          "snippet": "ssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "data->xml"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLEmitWarning",
          "args": [
            "fd",
            "data->warnName",
            "data->warnCommand"
          ],
          "line": 931
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLEmitWarning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "874-916",
          "snippet": "static int virXMLEmitWarning(int fd,\n                             const char *name,\n                             const char *cmd)\n{\n    size_t len;\n    const char *prologue =\n        \"<!--\\n\"\n        \"WARNING: THIS IS AN AUTO-GENERATED FILE. CHANGES TO IT ARE LIKELY TO BE\\n\"\n        \"OVERWRITTEN AND LOST. Changes to this xml configuration should be made using:\\n\"\n        \"  virsh \";\n    const char *epilogue =\n        \"\\n\"\n        \"or other application using the libvirt API.\\n\"\n        \"-->\\n\\n\";\n\n    if (fd < 0 || !cmd) {\n        errno = EINVAL;\n        return -1;\n    }\n\n    len = strlen(prologue);\n    if (safewrite(fd, prologue, len) != len)\n        return -1;\n\n    len = strlen(cmd);\n    if (safewrite(fd, cmd, len) != len)\n        return -1;\n\n    if (name) {\n        if (safewrite(fd, \" \", 1) != 1)\n            return -1;\n\n        len = strlen(name);\n        if (safewrite(fd, name, len) != len)\n            return -1;\n    }\n\n    len = strlen(epilogue);\n    if (safewrite(fd, epilogue, len) != len)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic int virXMLEmitWarning(int fd,\n                             const char *name,\n                             const char *cmd)\n{\n    size_t len;\n    const char *prologue =\n        \"<!--\\n\"\n        \"WARNING: THIS IS AN AUTO-GENERATED FILE. CHANGES TO IT ARE LIKELY TO BE\\n\"\n        \"OVERWRITTEN AND LOST. Changes to this xml configuration should be made using:\\n\"\n        \"  virsh \";\n    const char *epilogue =\n        \"\\n\"\n        \"or other application using the libvirt API.\\n\"\n        \"-->\\n\\n\";\n\n    if (fd < 0 || !cmd) {\n        errno = EINVAL;\n        return -1;\n    }\n\n    len = strlen(prologue);\n    if (safewrite(fd, prologue, len) != len)\n        return -1;\n\n    len = strlen(cmd);\n    if (safewrite(fd, cmd, len) != len)\n        return -1;\n\n    if (name) {\n        if (safewrite(fd, \" \", 1) != 1)\n            return -1;\n\n        len = strlen(name);\n        if (safewrite(fd, name, len) != len)\n            return -1;\n    }\n\n    len = strlen(epilogue);\n    if (safewrite(fd, epilogue, len) != len)\n        return -1;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirXMLRewriteFile(int fd, const void *opaque)\n{\n    const struct virXMLRewriteFileData *data = opaque;\n\n    if (data->warnCommand) {\n        if (virXMLEmitWarning(fd, data->warnName, data->warnCommand) < 0)\n            return -1;\n    }\n\n    if (safewrite(fd, data->xml, strlen(data->xml)) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virXMLEmitWarning",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "874-916",
    "snippet": "static int virXMLEmitWarning(int fd,\n                             const char *name,\n                             const char *cmd)\n{\n    size_t len;\n    const char *prologue =\n        \"<!--\\n\"\n        \"WARNING: THIS IS AN AUTO-GENERATED FILE. CHANGES TO IT ARE LIKELY TO BE\\n\"\n        \"OVERWRITTEN AND LOST. Changes to this xml configuration should be made using:\\n\"\n        \"  virsh \";\n    const char *epilogue =\n        \"\\n\"\n        \"or other application using the libvirt API.\\n\"\n        \"-->\\n\\n\";\n\n    if (fd < 0 || !cmd) {\n        errno = EINVAL;\n        return -1;\n    }\n\n    len = strlen(prologue);\n    if (safewrite(fd, prologue, len) != len)\n        return -1;\n\n    len = strlen(cmd);\n    if (safewrite(fd, cmd, len) != len)\n        return -1;\n\n    if (name) {\n        if (safewrite(fd, \" \", 1) != 1)\n            return -1;\n\n        len = strlen(name);\n        if (safewrite(fd, name, len) != len)\n            return -1;\n    }\n\n    len = strlen(epilogue);\n    if (safewrite(fd, epilogue, len) != len)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "safewrite",
          "args": [
            "fd",
            "epilogue",
            "len"
          ],
          "line": 912
        },
        "resolved": true,
        "details": {
          "function_name": "safewrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1093-1111",
          "snippet": "ssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "epilogue"
          ],
          "line": 911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "cmd"
          ],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "prologue"
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic int virXMLEmitWarning(int fd,\n                             const char *name,\n                             const char *cmd)\n{\n    size_t len;\n    const char *prologue =\n        \"<!--\\n\"\n        \"WARNING: THIS IS AN AUTO-GENERATED FILE. CHANGES TO IT ARE LIKELY TO BE\\n\"\n        \"OVERWRITTEN AND LOST. Changes to this xml configuration should be made using:\\n\"\n        \"  virsh \";\n    const char *epilogue =\n        \"\\n\"\n        \"or other application using the libvirt API.\\n\"\n        \"-->\\n\\n\";\n\n    if (fd < 0 || !cmd) {\n        errno = EINVAL;\n        return -1;\n    }\n\n    len = strlen(prologue);\n    if (safewrite(fd, prologue, len) != len)\n        return -1;\n\n    len = strlen(cmd);\n    if (safewrite(fd, cmd, len) != len)\n        return -1;\n\n    if (name) {\n        if (safewrite(fd, \" \", 1) != 1)\n            return -1;\n\n        len = strlen(name);\n        if (safewrite(fd, name, len) != len)\n            return -1;\n    }\n\n    len = strlen(epilogue);\n    if (safewrite(fd, epilogue, len) != len)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virXMLPickShellSafeComment",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "863-872",
    "snippet": "const char *virXMLPickShellSafeComment(const char *str1, const char *str2)\n{\n    if (str1 && !strpbrk(str1, \"\\r\\t\\n !\\\"#$&'()*;<>?[\\\\]^`{|}~\") &&\n        !strstr(str1, \"--\"))\n        return str1;\n    if (str2 && !strpbrk(str2, \"\\r\\t\\n !\\\"#$&'()*;<>?[\\\\]^`{|}~\") &&\n        !strstr(str2, \"--\"))\n        return str2;\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "str2",
            "\"--\""
          ],
          "line": 869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strpbrk",
          "args": [
            "str2",
            "\"\\r\\t\\n !\\\"#$&'()*;<>?[\\\\]^`{|}~\""
          ],
          "line": 868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "str1",
            "\"--\""
          ],
          "line": 866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strpbrk",
          "args": [
            "str1",
            "\"\\r\\t\\n !\\\"#$&'()*;<>?[\\\\]^`{|}~\""
          ],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nconst char *virXMLPickShellSafeComment(const char *str1, const char *str2)\n{\n    if (str1 && !strpbrk(str1, \"\\r\\t\\n !\\\"#$&'()*;<>?[\\\\]^`{|}~\") &&\n        !strstr(str1, \"--\"))\n        return str1;\n    if (str2 && !strpbrk(str2, \"\\r\\t\\n !\\\"#$&'()*;<>?[\\\\]^`{|}~\") &&\n        !strstr(str2, \"--\"))\n        return str2;\n    return NULL;\n}"
  },
  {
    "function_name": "virXMLParseHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "799-861",
    "snippet": "xmlDocPtr\nvirXMLParseHelper(int domcode,\n                  const char *filename,\n                  const char *xmlStr,\n                  const char *url,\n                  xmlXPathContextPtr *ctxt)\n{\n    struct virParserData private;\n    xmlParserCtxtPtr pctxt;\n    xmlDocPtr xml = NULL;\n\n    /* Set up a parser context so we can catch the details of XML errors. */\n    pctxt = xmlNewParserCtxt();\n    if (!pctxt || !pctxt->sax) {\n        virReportOOMError();\n        goto error;\n    }\n\n    private.domcode = domcode;\n    pctxt->_private = &private;\n    pctxt->sax->error = catchXMLError;\n\n    if (filename) {\n        xml = xmlCtxtReadFile(pctxt, filename, NULL,\n                              XML_PARSE_NONET |\n                              XML_PARSE_NOWARNING);\n    } else {\n        xml = xmlCtxtReadDoc(pctxt, BAD_CAST xmlStr, url, NULL,\n                             XML_PARSE_NONET |\n                             XML_PARSE_NOWARNING);\n    }\n    if (!xml)\n        goto error;\n\n    if (xmlDocGetRootElement(xml) == NULL) {\n        virGenericReportError(domcode, VIR_ERR_INTERNAL_ERROR,\n                              \"%s\", _(\"missing root element\"));\n        goto error;\n    }\n\n    if (ctxt) {\n        if (!(*ctxt = virXMLXPathContextNew(xml)))\n            goto error;\n\n        (*ctxt)->node = xmlDocGetRootElement(xml);\n    }\n\n cleanup:\n    xmlFreeParserCtxt(pctxt);\n\n    return xml;\n\n error:\n    xmlFreeDoc(xml);\n    xml = NULL;\n\n    if (virGetLastErrorCode() == VIR_ERR_OK) {\n        virGenericReportError(domcode, VIR_ERR_XML_ERROR,\n                              _(\"failed to parse xml document '%s'\"),\n                              filename ? filename : \"[inline data]\");\n    }\n    goto cleanup;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGenericReportError",
          "args": [
            "domcode",
            "VIR_ERR_XML_ERROR",
            "_(\"failed to parse xml document '%s'\")",
            "filename ? filename : \"[inline data]\""
          ],
          "line": 856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to parse xml document '%s'\""
          ],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetLastErrorCode",
          "args": [],
          "line": 855
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorCode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "280-287",
          "snippet": "int\nvirGetLastErrorCode(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (!err)\n        return VIR_ERR_OK;\n    return err->code;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirGetLastErrorCode(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (!err)\n        return VIR_ERR_OK;\n    return err->code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlFreeDoc",
          "args": [
            "xml"
          ],
          "line": 852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlFreeParserCtxt",
          "args": [
            "pctxt"
          ],
          "line": 847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlDocGetRootElement",
          "args": [
            "xml"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLXPathContextNew",
          "args": [
            "xml"
          ],
          "line": 840
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLXPathContextNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "48-59",
          "snippet": "xmlXPathContextPtr\nvirXMLXPathContextNew(xmlDocPtr xml)\n{\n    xmlXPathContextPtr ctxt;\n\n    if (!(ctxt = xmlXPathNewContext(xml))) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    return ctxt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlXPathContextPtr\nvirXMLXPathContextNew(xmlDocPtr xml)\n{\n    xmlXPathContextPtr ctxt;\n\n    if (!(ctxt = xmlXPathNewContext(xml))) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    return ctxt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGenericReportError",
          "args": [
            "domcode",
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"missing root element\")"
          ],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlDocGetRootElement",
          "args": [
            "xml"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlCtxtReadDoc",
          "args": [
            "pctxt",
            "BAD_CASTxmlStr",
            "url",
            "NULL",
            "XML_PARSE_NONET |\n                             XML_PARSE_NOWARNING"
          ],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlCtxtReadFile",
          "args": [
            "pctxt",
            "filename",
            "NULL",
            "XML_PARSE_NONET |\n                              XML_PARSE_NOWARNING"
          ],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportOOMError",
          "args": [],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlNewParserCtxt",
          "args": [],
          "line": 811
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlDocPtr\nvirXMLParseHelper(int domcode,\n                  const char *filename,\n                  const char *xmlStr,\n                  const char *url,\n                  xmlXPathContextPtr *ctxt)\n{\n    struct virParserData private;\n    xmlParserCtxtPtr pctxt;\n    xmlDocPtr xml = NULL;\n\n    /* Set up a parser context so we can catch the details of XML errors. */\n    pctxt = xmlNewParserCtxt();\n    if (!pctxt || !pctxt->sax) {\n        virReportOOMError();\n        goto error;\n    }\n\n    private.domcode = domcode;\n    pctxt->_private = &private;\n    pctxt->sax->error = catchXMLError;\n\n    if (filename) {\n        xml = xmlCtxtReadFile(pctxt, filename, NULL,\n                              XML_PARSE_NONET |\n                              XML_PARSE_NOWARNING);\n    } else {\n        xml = xmlCtxtReadDoc(pctxt, BAD_CAST xmlStr, url, NULL,\n                             XML_PARSE_NONET |\n                             XML_PARSE_NOWARNING);\n    }\n    if (!xml)\n        goto error;\n\n    if (xmlDocGetRootElement(xml) == NULL) {\n        virGenericReportError(domcode, VIR_ERR_INTERNAL_ERROR,\n                              \"%s\", _(\"missing root element\"));\n        goto error;\n    }\n\n    if (ctxt) {\n        if (!(*ctxt = virXMLXPathContextNew(xml)))\n            goto error;\n\n        (*ctxt)->node = xmlDocGetRootElement(xml);\n    }\n\n cleanup:\n    xmlFreeParserCtxt(pctxt);\n\n    return xml;\n\n error:\n    xmlFreeDoc(xml);\n    xml = NULL;\n\n    if (virGetLastErrorCode() == VIR_ERR_OK) {\n        virGenericReportError(domcode, VIR_ERR_XML_ERROR,\n                              _(\"failed to parse xml document '%s'\"),\n                              filename ? filename : \"[inline data]\");\n    }\n    goto cleanup;\n}"
  },
  {
    "function_name": "catchXMLError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "704-784",
    "snippet": "static void\ncatchXMLError(void *ctx, const char *msg G_GNUC_UNUSED, ...)\n{\n    xmlParserCtxtPtr ctxt = (xmlParserCtxtPtr) ctx;\n\n    const xmlChar *cur, *base;\n    unsigned int n, col;        /* GCC warns if signed, because compared with sizeof() */\n    int domcode = VIR_FROM_XML;\n\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char *contextstr = NULL;\n    char *pointerstr = NULL;\n\n\n    /* conditions for error printing */\n    if (!ctxt ||\n        (virGetLastErrorCode()) ||\n        ctxt->input == NULL ||\n        ctxt->lastError.level != XML_ERR_FATAL ||\n        ctxt->lastError.message == NULL)\n        return;\n\n    if (ctxt->_private)\n        domcode = ((struct virParserData *) ctxt->_private)->domcode;\n\n\n    cur = ctxt->input->cur;\n    base = ctxt->input->base;\n\n    /* skip backwards over any end-of-lines */\n    while ((cur > base) && ((*(cur) == '\\n') || (*(cur) == '\\r')))\n        cur--;\n\n    /* search backwards for beginning-of-line (to max buff size) */\n    while ((cur > base) && (*(cur) != '\\n') && (*(cur) != '\\r'))\n        cur--;\n    if ((*(cur) == '\\n') || (*(cur) == '\\r')) cur++;\n\n    /* calculate the error position in terms of the current position */\n    col = ctxt->input->cur - cur;\n\n    /* search forward for end-of-line (to max buff size) */\n    /* copy selected text to our buffer */\n    while ((*cur != 0) && (*(cur) != '\\n') && (*(cur) != '\\r'))\n        virBufferAddChar(&buf, *cur++);\n\n    /* create blank line with problem pointer */\n    contextstr = virBufferContentAndReset(&buf);\n\n    /* (leave buffer space for pointer + line terminator) */\n    for  (n = 0; (n<col) && (contextstr[n] != 0); n++) {\n        if (contextstr[n] == '\\t')\n            virBufferAddChar(&buf, '\\t');\n        else\n            virBufferAddChar(&buf, '-');\n    }\n\n    virBufferAddChar(&buf, '^');\n\n    pointerstr = virBufferContentAndReset(&buf);\n\n    if (ctxt->lastError.file) {\n        virGenericReportError(domcode, VIR_ERR_XML_DETAIL,\n                              _(\"%s:%d: %s%s\\n%s\"),\n                              ctxt->lastError.file,\n                              ctxt->lastError.line,\n                              ctxt->lastError.message,\n                              contextstr,\n                              pointerstr);\n    } else {\n        virGenericReportError(domcode, VIR_ERR_XML_DETAIL,\n                              _(\"at line %d: %s%s\\n%s\"),\n                              ctxt->lastError.line,\n                              ctxt->lastError.message,\n                              contextstr,\n                              pointerstr);\n    }\n\n    VIR_FREE(contextstr);\n    VIR_FREE(pointerstr);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "pointerstr"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "contextstr"
          ],
          "line": 782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGenericReportError",
          "args": [
            "domcode",
            "VIR_ERR_XML_DETAIL",
            "_(\"at line %d: %s%s\\n%s\")",
            "ctxt->lastError.line",
            "ctxt->lastError.message",
            "contextstr",
            "pointerstr"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"at line %d: %s%s\\n%s\""
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGenericReportError",
          "args": [
            "domcode",
            "VIR_ERR_XML_DETAIL",
            "_(\"%s:%d: %s%s\\n%s\")",
            "ctxt->lastError.file",
            "ctxt->lastError.line",
            "ctxt->lastError.message",
            "contextstr",
            "pointerstr"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 763
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddChar",
          "args": [
            "&buf",
            "'^'"
          ],
          "line": 761
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAddChar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "206-210",
          "snippet": "void\nvirBufferAddChar(virBufferPtr buf, char c)\n{\n    virBufferAdd(buf, &c, 1);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAddChar(virBufferPtr buf, char c)\n{\n    virBufferAdd(buf, &c, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetLastErrorCode",
          "args": [],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorCode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "280-287",
          "snippet": "int\nvirGetLastErrorCode(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (!err)\n        return VIR_ERR_OK;\n    return err->code;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirGetLastErrorCode(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (!err)\n        return VIR_ERR_OK;\n    return err->code;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\ncatchXMLError(void *ctx, const char *msg G_GNUC_UNUSED, ...)\n{\n    xmlParserCtxtPtr ctxt = (xmlParserCtxtPtr) ctx;\n\n    const xmlChar *cur, *base;\n    unsigned int n, col;        /* GCC warns if signed, because compared with sizeof() */\n    int domcode = VIR_FROM_XML;\n\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char *contextstr = NULL;\n    char *pointerstr = NULL;\n\n\n    /* conditions for error printing */\n    if (!ctxt ||\n        (virGetLastErrorCode()) ||\n        ctxt->input == NULL ||\n        ctxt->lastError.level != XML_ERR_FATAL ||\n        ctxt->lastError.message == NULL)\n        return;\n\n    if (ctxt->_private)\n        domcode = ((struct virParserData *) ctxt->_private)->domcode;\n\n\n    cur = ctxt->input->cur;\n    base = ctxt->input->base;\n\n    /* skip backwards over any end-of-lines */\n    while ((cur > base) && ((*(cur) == '\\n') || (*(cur) == '\\r')))\n        cur--;\n\n    /* search backwards for beginning-of-line (to max buff size) */\n    while ((cur > base) && (*(cur) != '\\n') && (*(cur) != '\\r'))\n        cur--;\n    if ((*(cur) == '\\n') || (*(cur) == '\\r')) cur++;\n\n    /* calculate the error position in terms of the current position */\n    col = ctxt->input->cur - cur;\n\n    /* search forward for end-of-line (to max buff size) */\n    /* copy selected text to our buffer */\n    while ((*cur != 0) && (*(cur) != '\\n') && (*(cur) != '\\r'))\n        virBufferAddChar(&buf, *cur++);\n\n    /* create blank line with problem pointer */\n    contextstr = virBufferContentAndReset(&buf);\n\n    /* (leave buffer space for pointer + line terminator) */\n    for  (n = 0; (n<col) && (contextstr[n] != 0); n++) {\n        if (contextstr[n] == '\\t')\n            virBufferAddChar(&buf, '\\t');\n        else\n            virBufferAddChar(&buf, '-');\n    }\n\n    virBufferAddChar(&buf, '^');\n\n    pointerstr = virBufferContentAndReset(&buf);\n\n    if (ctxt->lastError.file) {\n        virGenericReportError(domcode, VIR_ERR_XML_DETAIL,\n                              _(\"%s:%d: %s%s\\n%s\"),\n                              ctxt->lastError.file,\n                              ctxt->lastError.line,\n                              ctxt->lastError.message,\n                              contextstr,\n                              pointerstr);\n    } else {\n        virGenericReportError(domcode, VIR_ERR_XML_DETAIL,\n                              _(\"at line %d: %s%s\\n%s\"),\n                              ctxt->lastError.line,\n                              ctxt->lastError.message,\n                              contextstr,\n                              pointerstr);\n    }\n\n    VIR_FREE(contextstr);\n    VIR_FREE(pointerstr);\n}"
  },
  {
    "function_name": "virXPathNodeSet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "647-694",
    "snippet": "int\nvirXPathNodeSet(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                xmlNodePtr **list)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNodeSet()\"));\n        return -1;\n    }\n\n    if (list != NULL)\n        *list = NULL;\n\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if (obj == NULL)\n        return 0;\n\n    if (obj->type != XPATH_NODESET) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Incorrect xpath '%s'\"), xpath);\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    if ((obj->nodesetval == NULL)  || (obj->nodesetval->nodeNr < 0)) {\n        xmlXPathFreeObject(obj);\n        return 0;\n    }\n\n    ret = obj->nodesetval->nodeNr;\n    if (list != NULL && ret) {\n        if (VIR_ALLOC_N(*list, ret) < 0) {\n            ret = -1;\n        } else {\n            memcpy(*list, obj->nodesetval->nodeTab,\n                   ret * sizeof(xmlNodePtr));\n        }\n    }\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlXPathFreeObject",
          "args": [
            "obj"
          ],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "*list",
            "obj->nodesetval->nodeTab",
            "ret * sizeof(xmlNodePtr)"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "*list",
            "ret"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlXPathFreeObject",
          "args": [
            "obj"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlXPathFreeObject",
          "args": [
            "obj"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Incorrect xpath '%s'\")",
            "xpath"
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Incorrect xpath '%s'\""
          ],
          "line": 673
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlXPathEval",
          "args": [
            "BAD_CASTxpath",
            "ctxt"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid parameter to virXPathNodeSet()\")"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathNodeSet(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                xmlNodePtr **list)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNodeSet()\"));\n        return -1;\n    }\n\n    if (list != NULL)\n        *list = NULL;\n\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if (obj == NULL)\n        return 0;\n\n    if (obj->type != XPATH_NODESET) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Incorrect xpath '%s'\"), xpath);\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    if ((obj->nodesetval == NULL)  || (obj->nodesetval->nodeNr < 0)) {\n        xmlXPathFreeObject(obj);\n        return 0;\n    }\n\n    ret = obj->nodesetval->nodeNr;\n    if (list != NULL && ret) {\n        if (VIR_ALLOC_N(*list, ret) < 0) {\n            ret = -1;\n        } else {\n            memcpy(*list, obj->nodesetval->nodeTab,\n                   ret * sizeof(xmlNodePtr));\n        }\n    }\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
  },
  {
    "function_name": "virXPathNode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "608-634",
    "snippet": "xmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlXPathFreeObject",
          "args": [
            "obj"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlXPathFreeObject",
          "args": [
            "obj"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlXPathEval",
          "args": [
            "BAD_CASTxpath",
            "ctxt"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid parameter to virXPathNode()\")"
          ],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid parameter to virXPathNode()\""
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
  },
  {
    "function_name": "virXPathBoolean",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "571-596",
    "snippet": "int\nvirXPathBoolean(const char *xpath,\n                xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathBoolean()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_BOOLEAN) ||\n        (obj->boolval < 0) || (obj->boolval > 1)) {\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n    ret = obj->boolval;\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlXPathFreeObject",
          "args": [
            "obj"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlXPathFreeObject",
          "args": [
            "obj"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlXPathEval",
          "args": [
            "BAD_CASTxpath",
            "ctxt"
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid parameter to virXPathBoolean()\")"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid parameter to virXPathBoolean()\""
          ],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathBoolean(const char *xpath,\n                xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathBoolean()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_BOOLEAN) ||\n        (obj->boolval < 0) || (obj->boolval > 1)) {\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n    ret = obj->boolval;\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
  },
  {
    "function_name": "virXMLNodeContentString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "555-559",
    "snippet": "char *\nvirXMLNodeContentString(xmlNodePtr node)\n{\n    return (char *)xmlNodeGetContent(node);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlNodeGetContent",
          "args": [
            "node"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLNodeContentString(xmlNodePtr node)\n{\n    return (char *)xmlNodeGetContent(node);\n}"
  },
  {
    "function_name": "virXMLPropStringLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "535-543",
    "snippet": "char *\nvirXMLPropStringLimit(xmlNodePtr node,\n                      const char *name,\n                      size_t maxlen)\n{\n    char *tmp = (char *)xmlGetProp(node, BAD_CAST name);\n\n    return virXMLStringLimitInternal(tmp, maxlen, name);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXMLStringLimitInternal",
          "args": [
            "tmp",
            "maxlen",
            "name"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLStringLimitInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "99-113",
          "snippet": "static char *\nvirXMLStringLimitInternal(char *value,\n                          size_t maxlen,\n                          const char *name)\n{\n    if (value != NULL && strlen(value) >= maxlen) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"'%s' value longer than '%zu' bytes\"),\n                       name, maxlen);\n        VIR_FREE(value);\n        return NULL;\n    }\n\n    return value;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *\nvirXMLStringLimitInternal(char *value,\n                          size_t maxlen,\n                          const char *name)\n{\n    if (value != NULL && strlen(value) >= maxlen) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"'%s' value longer than '%zu' bytes\"),\n                       name, maxlen);\n        VIR_FREE(value);\n        return NULL;\n    }\n\n    return value;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlGetProp",
          "args": [
            "node",
            "BAD_CASTname"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropStringLimit(xmlNodePtr node,\n                      const char *name,\n                      size_t maxlen)\n{\n    char *tmp = (char *)xmlGetProp(node, BAD_CAST name);\n\n    return virXMLStringLimitInternal(tmp, maxlen, name);\n}"
  },
  {
    "function_name": "virXMLPropString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "515-520",
    "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlGetProp",
          "args": [
            "node",
            "BAD_CASTname"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
  },
  {
    "function_name": "virXMLCheckIllegalChars",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "490-502",
    "snippet": "int\nvirXMLCheckIllegalChars(const char *nodeName,\n                        const char *str,\n                        const char *illegal)\n{\n    char *c;\n    if ((c = strpbrk(str, illegal))) {\n        virReportError(VIR_ERR_XML_DETAIL,\n                       _(\"invalid char in %s: %c\"), nodeName, *c);\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_DETAIL",
            "_(\"invalid char in %s: %c\")",
            "nodeName",
            "*c"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"invalid char in %s: %c\""
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strpbrk",
          "args": [
            "str",
            "illegal"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXMLCheckIllegalChars(const char *nodeName,\n                        const char *str,\n                        const char *illegal)\n{\n    char *c;\n    if ((c = strpbrk(str, illegal))) {\n        virReportError(VIR_ERR_XML_DETAIL,\n                       _(\"invalid char in %s: %c\"), nodeName, *c);\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virXPathLongLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "444-476",
    "snippet": "int\nvirXPathLongLong(const char *xpath,\n                 xmlXPathContextPtr ctxt,\n                 long long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathLongLong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ll((char *) obj->stringval, NULL, 10, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (long long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlXPathFreeObject",
          "args": [
            "obj"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isnan",
          "args": [
            "obj->floatval"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ll",
          "args": [
            "(char *) obj->stringval",
            "NULL",
            "10",
            "value"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "526-542",
          "snippet": "int\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlXPathEval",
          "args": [
            "BAD_CASTxpath",
            "ctxt"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid parameter to virXPathLongLong()\")"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid parameter to virXPathLongLong()\""
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathLongLong(const char *xpath,\n                 xmlXPathContextPtr ctxt,\n                 long long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathLongLong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ll((char *) obj->stringval, NULL, 10, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (long long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
  },
  {
    "function_name": "virXPathULongLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "398-430",
    "snippet": "int\nvirXPathULongLong(const char *xpath,\n                  xmlXPathContextPtr ctxt,\n                  unsigned long long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathULong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ull((char *) obj->stringval, NULL, 10, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (unsigned long long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlXPathFreeObject",
          "args": [
            "obj"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isnan",
          "args": [
            "obj->floatval"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "(char *) obj->stringval",
            "NULL",
            "10",
            "value"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlXPathEval",
          "args": [
            "BAD_CASTxpath",
            "ctxt"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid parameter to virXPathULong()\")"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid parameter to virXPathULong()\""
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathULongLong(const char *xpath,\n                  xmlXPathContextPtr ctxt,\n                  unsigned long long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathULong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ull((char *) obj->stringval, NULL, 10, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (unsigned long long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
  },
  {
    "function_name": "virXPathULongHex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "378-384",
    "snippet": "int\nvirXPathULongHex(const char *xpath,\n                 xmlXPathContextPtr ctxt,\n                 unsigned long *value)\n{\n    return virXPathULongBase(xpath, ctxt, 16, value);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXPathULongBase",
          "args": [
            "xpath",
            "ctxt",
            "16",
            "value"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathULongBase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "281-314",
          "snippet": "static int\nvirXPathULongBase(const char *xpath,\n                  xmlXPathContextPtr ctxt,\n                  int base,\n                  unsigned long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathULong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ul((char *) obj->stringval, NULL, base, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (unsigned long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirXPathULongBase(const char *xpath,\n                  xmlXPathContextPtr ctxt,\n                  int base,\n                  unsigned long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathULong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ul((char *) obj->stringval, NULL, base, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (unsigned long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathULongHex(const char *xpath,\n                 xmlXPathContextPtr ctxt,\n                 unsigned long *value)\n{\n    return virXPathULongBase(xpath, ctxt, 16, value);\n}"
  },
  {
    "function_name": "virXPathULong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "357-363",
    "snippet": "int\nvirXPathULong(const char *xpath,\n              xmlXPathContextPtr ctxt,\n              unsigned long *value)\n{\n    return virXPathULongBase(xpath, ctxt, 10, value);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXPathULongBase",
          "args": [
            "xpath",
            "ctxt",
            "10",
            "value"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathULongBase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "281-314",
          "snippet": "static int\nvirXPathULongBase(const char *xpath,\n                  xmlXPathContextPtr ctxt,\n                  int base,\n                  unsigned long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathULong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ul((char *) obj->stringval, NULL, base, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (unsigned long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirXPathULongBase(const char *xpath,\n                  xmlXPathContextPtr ctxt,\n                  int base,\n                  unsigned long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathULong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ul((char *) obj->stringval, NULL, base, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (unsigned long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathULong(const char *xpath,\n              xmlXPathContextPtr ctxt,\n              unsigned long *value)\n{\n    return virXPathULongBase(xpath, ctxt, 10, value);\n}"
  },
  {
    "function_name": "virXPathUInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "328-343",
    "snippet": "int\nvirXPathUInt(const char *xpath,\n             xmlXPathContextPtr ctxt,\n             unsigned int *value)\n{\n    unsigned long tmp;\n    int ret;\n\n    ret = virXPathULongBase(xpath, ctxt, 10, &tmp);\n    if (ret < 0)\n        return ret;\n    if ((unsigned int) tmp != tmp)\n        return -2;\n    *value = tmp;\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXPathULongBase",
          "args": [
            "xpath",
            "ctxt",
            "10",
            "&tmp"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathULongBase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "281-314",
          "snippet": "static int\nvirXPathULongBase(const char *xpath,\n                  xmlXPathContextPtr ctxt,\n                  int base,\n                  unsigned long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathULong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ul((char *) obj->stringval, NULL, base, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (unsigned long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirXPathULongBase(const char *xpath,\n                  xmlXPathContextPtr ctxt,\n                  int base,\n                  unsigned long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathULong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ul((char *) obj->stringval, NULL, base, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (unsigned long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathUInt(const char *xpath,\n             xmlXPathContextPtr ctxt,\n             unsigned int *value)\n{\n    unsigned long tmp;\n    int ret;\n\n    ret = virXPathULongBase(xpath, ctxt, 10, &tmp);\n    if (ret < 0)\n        return ret;\n    if ((unsigned int) tmp != tmp)\n        return -2;\n    *value = tmp;\n    return 0;\n}"
  },
  {
    "function_name": "virXPathULongBase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "281-314",
    "snippet": "static int\nvirXPathULongBase(const char *xpath,\n                  xmlXPathContextPtr ctxt,\n                  int base,\n                  unsigned long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathULong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ul((char *) obj->stringval, NULL, base, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (unsigned long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlXPathFreeObject",
          "args": [
            "obj"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isnan",
          "args": [
            "obj->floatval"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ul",
          "args": [
            "(char *) obj->stringval",
            "NULL",
            "base",
            "value"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlXPathEval",
          "args": [
            "BAD_CASTxpath",
            "ctxt"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid parameter to virXPathULong()\")"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid parameter to virXPathULong()\""
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirXPathULongBase(const char *xpath,\n                  xmlXPathContextPtr ctxt,\n                  int base,\n                  unsigned long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathULong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ul((char *) obj->stringval, NULL, base, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (unsigned long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
  },
  {
    "function_name": "virXPathLongHex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "273-279",
    "snippet": "int\nvirXPathLongHex(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                long *value)\n{\n    return virXPathLongBase(xpath, ctxt, 16, value);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXPathLongBase",
          "args": [
            "xpath",
            "ctxt",
            "16",
            "value"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathLongBase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "176-209",
          "snippet": "static int\nvirXPathLongBase(const char *xpath,\n                 xmlXPathContextPtr ctxt,\n                 int base,\n                 long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathLong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_l((char *) obj->stringval, NULL, base, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirXPathLongBase(const char *xpath,\n                 xmlXPathContextPtr ctxt,\n                 int base,\n                 long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathLong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_l((char *) obj->stringval, NULL, base, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathLongHex(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                long *value)\n{\n    return virXPathLongBase(xpath, ctxt, 16, value);\n}"
  },
  {
    "function_name": "virXPathLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "252-258",
    "snippet": "int\nvirXPathLong(const char *xpath,\n             xmlXPathContextPtr ctxt,\n             long *value)\n{\n    return virXPathLongBase(xpath, ctxt, 10, value);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXPathLongBase",
          "args": [
            "xpath",
            "ctxt",
            "10",
            "value"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathLongBase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "176-209",
          "snippet": "static int\nvirXPathLongBase(const char *xpath,\n                 xmlXPathContextPtr ctxt,\n                 int base,\n                 long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathLong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_l((char *) obj->stringval, NULL, base, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirXPathLongBase(const char *xpath,\n                 xmlXPathContextPtr ctxt,\n                 int base,\n                 long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathLong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_l((char *) obj->stringval, NULL, base, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathLong(const char *xpath,\n             xmlXPathContextPtr ctxt,\n             long *value)\n{\n    return virXPathLongBase(xpath, ctxt, 10, value);\n}"
  },
  {
    "function_name": "virXPathInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "223-238",
    "snippet": "int\nvirXPathInt(const char *xpath,\n            xmlXPathContextPtr ctxt,\n            int *value)\n{\n    long tmp;\n    int ret;\n\n    ret = virXPathLongBase(xpath, ctxt, 10, &tmp);\n    if (ret < 0)\n        return ret;\n    if ((int) tmp != tmp)\n        return -2;\n    *value = tmp;\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXPathLongBase",
          "args": [
            "xpath",
            "ctxt",
            "10",
            "&tmp"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathLongBase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "176-209",
          "snippet": "static int\nvirXPathLongBase(const char *xpath,\n                 xmlXPathContextPtr ctxt,\n                 int base,\n                 long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathLong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_l((char *) obj->stringval, NULL, base, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirXPathLongBase(const char *xpath,\n                 xmlXPathContextPtr ctxt,\n                 int base,\n                 long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathLong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_l((char *) obj->stringval, NULL, base, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathInt(const char *xpath,\n            xmlXPathContextPtr ctxt,\n            int *value)\n{\n    long tmp;\n    int ret;\n\n    ret = virXPathLongBase(xpath, ctxt, 10, &tmp);\n    if (ret < 0)\n        return ret;\n    if ((int) tmp != tmp)\n        return -2;\n    *value = tmp;\n    return 0;\n}"
  },
  {
    "function_name": "virXPathLongBase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "176-209",
    "snippet": "static int\nvirXPathLongBase(const char *xpath,\n                 xmlXPathContextPtr ctxt,\n                 int base,\n                 long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathLong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_l((char *) obj->stringval, NULL, base, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlXPathFreeObject",
          "args": [
            "obj"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isnan",
          "args": [
            "obj->floatval"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_l",
          "args": [
            "(char *) obj->stringval",
            "NULL",
            "base",
            "value"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "526-542",
          "snippet": "int\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlXPathEval",
          "args": [
            "BAD_CASTxpath",
            "ctxt"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid parameter to virXPathLong()\")"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid parameter to virXPathLong()\""
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirXPathLongBase(const char *xpath,\n                 xmlXPathContextPtr ctxt,\n                 int base,\n                 long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathLong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_l((char *) obj->stringval, NULL, base, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
  },
  {
    "function_name": "virXPathNumber",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "149-174",
    "snippet": "int\nvirXPathNumber(const char *xpath,\n               xmlXPathContextPtr ctxt,\n               double *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNumber()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NUMBER) ||\n        (isnan(obj->floatval))) {\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    *value = obj->floatval;\n    xmlXPathFreeObject(obj);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlXPathFreeObject",
          "args": [
            "obj"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlXPathFreeObject",
          "args": [
            "obj"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isnan",
          "args": [
            "obj->floatval"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlXPathEval",
          "args": [
            "BAD_CASTxpath",
            "ctxt"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid parameter to virXPathNumber()\")"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid parameter to virXPathNumber()\""
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathNumber(const char *xpath,\n               xmlXPathContextPtr ctxt,\n               double *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNumber()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NUMBER) ||\n        (isnan(obj->floatval))) {\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    *value = obj->floatval;\n    xmlXPathFreeObject(obj);\n    return 0;\n}"
  },
  {
    "function_name": "virXPathStringLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "128-136",
    "snippet": "char *\nvirXPathStringLimit(const char *xpath,\n                    size_t maxlen,\n                    xmlXPathContextPtr ctxt)\n{\n    char *tmp = virXPathString(xpath, ctxt);\n\n    return virXMLStringLimitInternal(tmp, maxlen, xpath);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXMLStringLimitInternal",
          "args": [
            "tmp",
            "maxlen",
            "xpath"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLStringLimitInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "99-113",
          "snippet": "static char *\nvirXMLStringLimitInternal(char *value,\n                          size_t maxlen,\n                          const char *name)\n{\n    if (value != NULL && strlen(value) >= maxlen) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"'%s' value longer than '%zu' bytes\"),\n                       name, maxlen);\n        VIR_FREE(value);\n        return NULL;\n    }\n\n    return value;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *\nvirXMLStringLimitInternal(char *value,\n                          size_t maxlen,\n                          const char *name)\n{\n    if (value != NULL && strlen(value) >= maxlen) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"'%s' value longer than '%zu' bytes\"),\n                       name, maxlen);\n        VIR_FREE(value);\n        return NULL;\n    }\n\n    return value;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathString",
          "args": [
            "xpath",
            "ctxt"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "72-96",
          "snippet": "char *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXPathStringLimit(const char *xpath,\n                    size_t maxlen,\n                    xmlXPathContextPtr ctxt)\n{\n    char *tmp = virXPathString(xpath, ctxt);\n\n    return virXMLStringLimitInternal(tmp, maxlen, xpath);\n}"
  },
  {
    "function_name": "virXMLStringLimitInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "99-113",
    "snippet": "static char *\nvirXMLStringLimitInternal(char *value,\n                          size_t maxlen,\n                          const char *name)\n{\n    if (value != NULL && strlen(value) >= maxlen) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"'%s' value longer than '%zu' bytes\"),\n                       name, maxlen);\n        VIR_FREE(value);\n        return NULL;\n    }\n\n    return value;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"'%s' value longer than '%zu' bytes\")",
            "name",
            "maxlen"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"'%s' value longer than '%zu' bytes\""
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *\nvirXMLStringLimitInternal(char *value,\n                          size_t maxlen,\n                          const char *name)\n{\n    if (value != NULL && strlen(value) >= maxlen) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"'%s' value longer than '%zu' bytes\"),\n                       name, maxlen);\n        VIR_FREE(value);\n        return NULL;\n    }\n\n    return value;\n}"
  },
  {
    "function_name": "virXPathString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "72-96",
    "snippet": "char *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlXPathFreeObject",
          "args": [
            "obj"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "(char *)obj->stringval"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlXPathFreeObject",
          "args": [
            "obj"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlXPathEval",
          "args": [
            "BAD_CASTxpath",
            "ctxt"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid parameter to virXPathString()\")"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
  },
  {
    "function_name": "virXMLXPathContextNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
    "lines": "48-59",
    "snippet": "xmlXPathContextPtr\nvirXMLXPathContextNew(xmlDocPtr xml)\n{\n    xmlXPathContextPtr ctxt;\n\n    if (!(ctxt = xmlXPathNewContext(xml))) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    return ctxt;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virxml.h\"",
      "#include \"virerror.h\"",
      "#include <libxml/xpathInternals.h>",
      "#include <sys/stat.h>",
      "#include <math.h>               /* for isnan() */",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportOOMError",
          "args": [],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlXPathNewContext",
          "args": [
            "xml"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlXPathContextPtr\nvirXMLXPathContextNew(xmlDocPtr xml)\n{\n    xmlXPathContextPtr ctxt;\n\n    if (!(ctxt = xmlXPathNewContext(xml))) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    return ctxt;\n}"
  }
]