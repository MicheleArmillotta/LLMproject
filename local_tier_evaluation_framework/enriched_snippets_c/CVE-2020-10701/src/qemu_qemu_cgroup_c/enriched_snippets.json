[
  {
    "function_name": "qemuCgroupEmulatorAllNodesRestore",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "1316-1329",
    "snippet": "void\nqemuCgroupEmulatorAllNodesRestore(qemuCgroupEmulatorAllNodesDataPtr data)\n{\n    virErrorPtr err;\n\n    if (!data)\n        return;\n\n    virErrorPreserveLast(&err);\n    virCgroupSetCpusetMems(data->emulatorCgroup, data->emulatorMemMask);\n    virErrorRestore(&err);\n\n    qemuCgroupEmulatorAllNodesDataFree(data);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuCgroupEmulatorAllNodesDataFree",
          "args": [
            "data"
          ],
          "line": 1328
        },
        "resolved": true,
        "details": {
          "function_name": "qemuCgroupEmulatorAllNodesDataFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "1243-1252",
          "snippet": "static void\nqemuCgroupEmulatorAllNodesDataFree(qemuCgroupEmulatorAllNodesDataPtr data)\n{\n    if (!data)\n        return;\n\n    virCgroupFree(&data->emulatorCgroup);\n    VIR_FREE(data->emulatorMemMask);\n    VIR_FREE(data);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic void\nqemuCgroupEmulatorAllNodesDataFree(qemuCgroupEmulatorAllNodesDataPtr data)\n{\n    if (!data)\n        return;\n\n    virCgroupFree(&data->emulatorCgroup);\n    VIR_FREE(data->emulatorMemMask);\n    VIR_FREE(data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virErrorRestore",
          "args": [
            "&err"
          ],
          "line": 1326
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorRestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "445-457",
          "snippet": "void\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetCpusetMems",
          "args": [
            "data->emulatorCgroup",
            "data->emulatorMemMask"
          ],
          "line": 1325
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetCpusetMems",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3201-3208",
          "snippet": "int\nvirCgroupSetCpusetMems(virCgroupPtr group G_GNUC_UNUSED,\n                       const char *mems G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpusetMems(virCgroupPtr group G_GNUC_UNUSED,\n                       const char *mems G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virErrorPreserveLast",
          "args": [
            "&err"
          ],
          "line": 1324
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorPreserveLast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "424-436",
          "snippet": "void\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nvoid\nqemuCgroupEmulatorAllNodesRestore(qemuCgroupEmulatorAllNodesDataPtr data)\n{\n    virErrorPtr err;\n\n    if (!data)\n        return;\n\n    virErrorPreserveLast(&err);\n    virCgroupSetCpusetMems(data->emulatorCgroup, data->emulatorMemMask);\n    virErrorRestore(&err);\n\n    qemuCgroupEmulatorAllNodesDataFree(data);\n}"
  },
  {
    "function_name": "qemuCgroupEmulatorAllNodesAllow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "1267-1306",
    "snippet": "int\nqemuCgroupEmulatorAllNodesAllow(virCgroupPtr cgroup,\n                                qemuCgroupEmulatorAllNodesDataPtr *retData)\n{\n    qemuCgroupEmulatorAllNodesDataPtr data = NULL;\n    char *all_nodes_str = NULL;\n    virBitmapPtr all_nodes = NULL;\n    int ret = -1;\n\n    if (!virNumaIsAvailable() ||\n        !virCgroupHasController(cgroup, VIR_CGROUP_CONTROLLER_CPUSET))\n        return 0;\n\n    if (!(all_nodes = virNumaGetHostMemoryNodeset()))\n        goto cleanup;\n\n    if (!(all_nodes_str = virBitmapFormat(all_nodes)))\n        goto cleanup;\n\n    if (VIR_ALLOC(data) < 0)\n        goto cleanup;\n\n    if (virCgroupNewThread(cgroup, VIR_CGROUP_THREAD_EMULATOR, 0,\n                           false, &data->emulatorCgroup) < 0)\n        goto cleanup;\n\n    if (virCgroupGetCpusetMems(data->emulatorCgroup, &data->emulatorMemMask) < 0 ||\n        virCgroupSetCpusetMems(data->emulatorCgroup, all_nodes_str) < 0)\n        goto cleanup;\n\n    *retData = g_steal_pointer(&data);\n    ret = 0;\n\n cleanup:\n    VIR_FREE(all_nodes_str);\n    virBitmapFree(all_nodes);\n    qemuCgroupEmulatorAllNodesDataFree(data);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuCgroupEmulatorAllNodesDataFree",
          "args": [
            "data"
          ],
          "line": 1303
        },
        "resolved": true,
        "details": {
          "function_name": "qemuCgroupEmulatorAllNodesDataFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "1243-1252",
          "snippet": "static void\nqemuCgroupEmulatorAllNodesDataFree(qemuCgroupEmulatorAllNodesDataPtr data)\n{\n    if (!data)\n        return;\n\n    virCgroupFree(&data->emulatorCgroup);\n    VIR_FREE(data->emulatorMemMask);\n    VIR_FREE(data);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic void\nqemuCgroupEmulatorAllNodesDataFree(qemuCgroupEmulatorAllNodesDataPtr data)\n{\n    if (!data)\n        return;\n\n    virCgroupFree(&data->emulatorCgroup);\n    VIR_FREE(data->emulatorMemMask);\n    VIR_FREE(data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapFree",
          "args": [
            "all_nodes"
          ],
          "line": 1302
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "128-135",
          "snippet": "void\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "all_nodes_str"
          ],
          "line": 1301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&data"
          ],
          "line": 1297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupSetCpusetMems",
          "args": [
            "data->emulatorCgroup",
            "all_nodes_str"
          ],
          "line": 1294
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetCpusetMems",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3201-3208",
          "snippet": "int\nvirCgroupSetCpusetMems(virCgroupPtr group G_GNUC_UNUSED,\n                       const char *mems G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpusetMems(virCgroupPtr group G_GNUC_UNUSED,\n                       const char *mems G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetCpusetMems",
          "args": [
            "data->emulatorCgroup",
            "&data->emulatorMemMask"
          ],
          "line": 1293
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetCpusetMems",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3211-3218",
          "snippet": "int\nvirCgroupGetCpusetMems(virCgroupPtr group G_GNUC_UNUSED,\n                       char **mems G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpusetMems(virCgroupPtr group G_GNUC_UNUSED,\n                       char **mems G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNewThread",
          "args": [
            "cgroup",
            "VIR_CGROUP_THREAD_EMULATOR",
            "0",
            "false",
            "&data->emulatorCgroup"
          ],
          "line": 1289
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2825-2835",
          "snippet": "int\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "data"
          ],
          "line": 1286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapFormat",
          "args": [
            "all_nodes"
          ],
          "line": 1283
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "404-442",
          "snippet": "char *\nvirBitmapFormat(virBitmapPtr bitmap)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bool first = true;\n    int start, cur, prev;\n\n    if (!bitmap || (cur = virBitmapNextSetBit(bitmap, -1)) < 0) {\n        char *ret;\n        ret = g_strdup(\"\");\n        return ret;\n    }\n\n    start = prev = cur;\n    while (prev >= 0) {\n        cur = virBitmapNextSetBit(bitmap, prev);\n\n        if (cur == prev + 1) {\n            prev = cur;\n            continue;\n        }\n\n        /* cur < 0 or cur > prev + 1 */\n\n        if (!first)\n            virBufferAddLit(&buf, \",\");\n        else\n            first = false;\n\n        if (prev == start)\n            virBufferAsprintf(&buf, \"%d\", start);\n        else\n            virBufferAsprintf(&buf, \"%d-%d\", start, prev);\n\n        start = prev = cur;\n    }\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nvirBitmapFormat(virBitmapPtr bitmap)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bool first = true;\n    int start, cur, prev;\n\n    if (!bitmap || (cur = virBitmapNextSetBit(bitmap, -1)) < 0) {\n        char *ret;\n        ret = g_strdup(\"\");\n        return ret;\n    }\n\n    start = prev = cur;\n    while (prev >= 0) {\n        cur = virBitmapNextSetBit(bitmap, prev);\n\n        if (cur == prev + 1) {\n            prev = cur;\n            continue;\n        }\n\n        /* cur < 0 or cur > prev + 1 */\n\n        if (!first)\n            virBufferAddLit(&buf, \",\");\n        else\n            first = false;\n\n        if (prev == start)\n            virBufferAsprintf(&buf, \"%d\", start);\n        else\n            virBufferAsprintf(&buf, \"%d-%d\", start, prev);\n\n        start = prev = cur;\n    }\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNumaGetHostMemoryNodeset",
          "args": [],
          "line": 1280
        },
        "resolved": true,
        "details": {
          "function_name": "virNumaGetHostMemoryNodeset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnuma.c",
          "lines": "1018-1042",
          "snippet": "virBitmapPtr\nvirNumaGetHostMemoryNodeset(void)\n{\n    int maxnode = virNumaGetMaxNode();\n    unsigned long long nodesize;\n    size_t i = 0;\n    virBitmapPtr nodeset = NULL;\n\n    if (maxnode < 0)\n        return NULL;\n\n    if (!(nodeset = virBitmapNew(maxnode + 1)))\n        return NULL;\n\n    for (i = 0; i <= maxnode; i++) {\n        if (!virNumaNodeIsAvailable(i))\n            continue;\n\n        /* if we can't detect NUMA node size assume that it's present */\n        if (virNumaGetNodeMemory(i, &nodesize, NULL) < 0 || nodesize > 0)\n            ignore_value(virBitmapSetBit(nodeset, i));\n    }\n\n    return nodeset;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virnuma.h\"",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "# include <numa.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostmem.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virnuma.h\"\n#include <dirent.h>\n#include <sys/types.h>\n# include <numa.h>\n#include <config.h>\n\nvirBitmapPtr\nvirNumaGetHostMemoryNodeset(void)\n{\n    int maxnode = virNumaGetMaxNode();\n    unsigned long long nodesize;\n    size_t i = 0;\n    virBitmapPtr nodeset = NULL;\n\n    if (maxnode < 0)\n        return NULL;\n\n    if (!(nodeset = virBitmapNew(maxnode + 1)))\n        return NULL;\n\n    for (i = 0; i <= maxnode; i++) {\n        if (!virNumaNodeIsAvailable(i))\n            continue;\n\n        /* if we can't detect NUMA node size assume that it's present */\n        if (virNumaGetNodeMemory(i, &nodesize, NULL) < 0 || nodesize > 0)\n            ignore_value(virBitmapSetBit(nodeset, i));\n    }\n\n    return nodeset;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "cgroup",
            "VIR_CGROUP_CONTROLLER_CPUSET"
          ],
          "line": 1277
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNumaIsAvailable",
          "args": [],
          "line": 1276
        },
        "resolved": true,
        "details": {
          "function_name": "virNumaIsAvailable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnuma.c",
          "lines": "355-359",
          "snippet": "bool\nvirNumaIsAvailable(void)\n{\n    return false;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virnuma.h\"",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "# include <numa.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostmem.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virnuma.h\"\n#include <dirent.h>\n#include <sys/types.h>\n# include <numa.h>\n#include <config.h>\n\nbool\nvirNumaIsAvailable(void)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuCgroupEmulatorAllNodesAllow(virCgroupPtr cgroup,\n                                qemuCgroupEmulatorAllNodesDataPtr *retData)\n{\n    qemuCgroupEmulatorAllNodesDataPtr data = NULL;\n    char *all_nodes_str = NULL;\n    virBitmapPtr all_nodes = NULL;\n    int ret = -1;\n\n    if (!virNumaIsAvailable() ||\n        !virCgroupHasController(cgroup, VIR_CGROUP_CONTROLLER_CPUSET))\n        return 0;\n\n    if (!(all_nodes = virNumaGetHostMemoryNodeset()))\n        goto cleanup;\n\n    if (!(all_nodes_str = virBitmapFormat(all_nodes)))\n        goto cleanup;\n\n    if (VIR_ALLOC(data) < 0)\n        goto cleanup;\n\n    if (virCgroupNewThread(cgroup, VIR_CGROUP_THREAD_EMULATOR, 0,\n                           false, &data->emulatorCgroup) < 0)\n        goto cleanup;\n\n    if (virCgroupGetCpusetMems(data->emulatorCgroup, &data->emulatorMemMask) < 0 ||\n        virCgroupSetCpusetMems(data->emulatorCgroup, all_nodes_str) < 0)\n        goto cleanup;\n\n    *retData = g_steal_pointer(&data);\n    ret = 0;\n\n cleanup:\n    VIR_FREE(all_nodes_str);\n    virBitmapFree(all_nodes);\n    qemuCgroupEmulatorAllNodesDataFree(data);\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuCgroupEmulatorAllNodesDataFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "1243-1252",
    "snippet": "static void\nqemuCgroupEmulatorAllNodesDataFree(qemuCgroupEmulatorAllNodesDataPtr data)\n{\n    if (!data)\n        return;\n\n    virCgroupFree(&data->emulatorCgroup);\n    VIR_FREE(data->emulatorMemMask);\n    VIR_FREE(data);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data"
          ],
          "line": 1251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->emulatorMemMask"
          ],
          "line": 1250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "&data->emulatorCgroup"
          ],
          "line": 1249
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic void\nqemuCgroupEmulatorAllNodesDataFree(qemuCgroupEmulatorAllNodesDataPtr data)\n{\n    if (!data)\n        return;\n\n    virCgroupFree(&data->emulatorCgroup);\n    VIR_FREE(data->emulatorMemMask);\n    VIR_FREE(data);\n}"
  },
  {
    "function_name": "qemuRemoveCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "1226-1240",
    "snippet": "int\nqemuRemoveCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (priv->cgroup == NULL)\n        return 0; /* Not supported, so claim success */\n\n    if (virCgroupTerminateMachine(priv->machineName) < 0) {\n        if (!virCgroupNewIgnoreError())\n            VIR_DEBUG(\"Failed to terminate cgroup for %s\", vm->def->name);\n    }\n\n    return virCgroupRemove(priv->cgroup);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupRemove",
          "args": [
            "priv->cgroup"
          ],
          "line": 1239
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3378-3384",
          "snippet": "int\nvirCgroupRemove(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupRemove(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Failed to terminate cgroup for %s\"",
            "vm->def->name"
          ],
          "line": 1236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupNewIgnoreError",
          "args": [],
          "line": 1235
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewIgnoreError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2891-2896",
          "snippet": "bool\nvirCgroupNewIgnoreError(void)\n{\n    VIR_DEBUG(\"No cgroups present/configured/accessible, ignoring error\");\n    return true;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupNewIgnoreError(void)\n{\n    VIR_DEBUG(\"No cgroups present/configured/accessible, ignoring error\");\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupTerminateMachine",
          "args": [
            "priv->machineName"
          ],
          "line": 1234
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupTerminateMachine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2863-2868",
          "snippet": "int virCgroupTerminateMachine(const char *name G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint virCgroupTerminateMachine(const char *name G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuRemoveCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (priv->cgroup == NULL)\n        return 0; /* Not supported, so claim success */\n\n    if (virCgroupTerminateMachine(priv->machineName) < 0) {\n        if (!virCgroupNewIgnoreError())\n            VIR_DEBUG(\"Failed to terminate cgroup for %s\", vm->def->name);\n    }\n\n    return virCgroupRemove(priv->cgroup);\n}"
  },
  {
    "function_name": "qemuSetupGlobalCpuCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "1177-1223",
    "snippet": "int\nqemuSetupGlobalCpuCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    unsigned long long period = vm->def->cputune.global_period;\n    long long quota = vm->def->cputune.global_quota;\n    char *mem_mask = NULL;\n    virDomainNumatuneMemMode mem_mode;\n\n    if ((period || quota) &&\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"cgroup cpu is required for scheduler tuning\"));\n        return -1;\n    }\n\n    /*\n     * If CPU cgroup controller is not initialized here, then we need\n     * neither period nor quota settings.  And if CPUSET controller is\n     * not initialized either, then there's nothing to do anyway.\n     */\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU) &&\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPUSET))\n        return 0;\n\n\n    if (virDomainNumatuneGetMode(vm->def->numa, -1, &mem_mode) == 0 &&\n        mem_mode == VIR_DOMAIN_NUMATUNE_MEM_STRICT &&\n        virDomainNumatuneMaybeFormatNodeset(vm->def->numa,\n                                            priv->autoNodeset,\n                                            &mem_mask, -1) < 0)\n        goto cleanup;\n\n    if (period || quota) {\n        if (qemuSetupCgroupVcpuBW(priv->cgroup, period, quota) < 0)\n            goto cleanup;\n    }\n\n    VIR_FREE(mem_mask);\n\n    return 0;\n\n cleanup:\n    VIR_FREE(mem_mask);\n\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "mem_mask"
          ],
          "line": 1220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "mem_mask"
          ],
          "line": 1215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuSetupCgroupVcpuBW",
          "args": [
            "priv->cgroup",
            "period",
            "quota"
          ],
          "line": 1211
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupCgroupVcpuBW",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "1126-1132",
          "snippet": "int\nqemuSetupCgroupVcpuBW(virCgroupPtr cgroup,\n                      unsigned long long period,\n                      long long quota)\n{\n    return virCgroupSetupCpuPeriodQuota(cgroup, period, quota);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupCgroupVcpuBW(virCgroupPtr cgroup,\n                      unsigned long long period,\n                      long long quota)\n{\n    return virCgroupSetupCpuPeriodQuota(cgroup, period, quota);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNumatuneMaybeFormatNodeset",
          "args": [
            "vm->def->numa",
            "priv->autoNodeset",
            "&mem_mask",
            "-1"
          ],
          "line": 1205
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNumatuneMaybeFormatNodeset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/numa_conf.c",
          "lines": "473-490",
          "snippet": "int\nvirDomainNumatuneMaybeFormatNodeset(virDomainNumaPtr numatune,\n                                    virBitmapPtr auto_nodeset,\n                                    char **mask,\n                                    int cellid)\n{\n    virBitmapPtr nodeset;\n\n    if (virDomainNumatuneMaybeGetNodeset(numatune, auto_nodeset, &nodeset,\n                                         cellid) < 0)\n        return -1;\n\n    if (nodeset &&\n        !(*mask = virBitmapFormat(nodeset)))\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"numa_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"numa_conf.h\"\n#include <config.h>\n\nint\nvirDomainNumatuneMaybeFormatNodeset(virDomainNumaPtr numatune,\n                                    virBitmapPtr auto_nodeset,\n                                    char **mask,\n                                    int cellid)\n{\n    virBitmapPtr nodeset;\n\n    if (virDomainNumatuneMaybeGetNodeset(numatune, auto_nodeset, &nodeset,\n                                         cellid) < 0)\n        return -1;\n\n    if (nodeset &&\n        !(*mask = virBitmapFormat(nodeset)))\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNumatuneGetMode",
          "args": [
            "vm->def->numa",
            "-1",
            "&mem_mode"
          ],
          "line": 1203
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNumatuneGetMode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/numa_conf.c",
          "lines": "389-409",
          "snippet": "int virDomainNumatuneGetMode(virDomainNumaPtr numatune,\n                             int cellid,\n                             virDomainNumatuneMemMode *mode)\n{\n    virDomainNumatuneMemMode tmp_mode;\n\n    if (!numatune)\n        return -1;\n\n    if (virDomainNumatuneNodeSpecified(numatune, cellid))\n        tmp_mode = numatune->mem_nodes[cellid].mode;\n    else if (numatune->memory.specified)\n        tmp_mode = numatune->memory.mode;\n    else\n        return -1;\n\n    if (mode)\n        *mode = tmp_mode;\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"numa_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"numa_conf.h\"\n#include <config.h>\n\nint virDomainNumatuneGetMode(virDomainNumaPtr numatune,\n                             int cellid,\n                             virDomainNumatuneMemMode *mode)\n{\n    virDomainNumatuneMemMode tmp_mode;\n\n    if (!numatune)\n        return -1;\n\n    if (virDomainNumatuneNodeSpecified(numatune, cellid))\n        tmp_mode = numatune->mem_nodes[cellid].mode;\n    else if (numatune->memory.specified)\n        tmp_mode = numatune->memory.mode;\n    else\n        return -1;\n\n    if (mode)\n        *mode = tmp_mode;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_CPUSET"
          ],
          "line": 1199
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"cgroup cpu is required for scheduler tuning\")"
          ],
          "line": 1188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cgroup cpu is required for scheduler tuning\""
          ],
          "line": 1189
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupGlobalCpuCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    unsigned long long period = vm->def->cputune.global_period;\n    long long quota = vm->def->cputune.global_quota;\n    char *mem_mask = NULL;\n    virDomainNumatuneMemMode mem_mode;\n\n    if ((period || quota) &&\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"cgroup cpu is required for scheduler tuning\"));\n        return -1;\n    }\n\n    /*\n     * If CPU cgroup controller is not initialized here, then we need\n     * neither period nor quota settings.  And if CPUSET controller is\n     * not initialized either, then there's nothing to do anyway.\n     */\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU) &&\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPUSET))\n        return 0;\n\n\n    if (virDomainNumatuneGetMode(vm->def->numa, -1, &mem_mode) == 0 &&\n        mem_mode == VIR_DOMAIN_NUMATUNE_MEM_STRICT &&\n        virDomainNumatuneMaybeFormatNodeset(vm->def->numa,\n                                            priv->autoNodeset,\n                                            &mem_mask, -1) < 0)\n        goto cleanup;\n\n    if (period || quota) {\n        if (qemuSetupCgroupVcpuBW(priv->cgroup, period, quota) < 0)\n            goto cleanup;\n    }\n\n    VIR_FREE(mem_mask);\n\n    return 0;\n\n cleanup:\n    VIR_FREE(mem_mask);\n\n    return -1;\n}"
  },
  {
    "function_name": "qemuSetupCgroupForExtDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "1143-1174",
    "snippet": "int\nqemuSetupCgroupForExtDevices(virDomainObjPtr vm,\n                             virQEMUDriverPtr driver)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virCgroupPtr cgroup_temp = NULL;\n    int ret = -1;\n\n    if (!qemuExtDevicesHasDevice(vm->def) ||\n        priv->cgroup == NULL)\n        return 0; /* Not supported, so claim success */\n\n    /*\n     * If CPU cgroup controller is not initialized here, then we need\n     * neither period nor quota settings.  And if CPUSET controller is\n     * not initialized either, then there's nothing to do anyway.\n     */\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU) &&\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPUSET))\n        return 0;\n\n    if (virCgroupNewThread(priv->cgroup, VIR_CGROUP_THREAD_EMULATOR, 0,\n                           false, &cgroup_temp) < 0)\n        goto cleanup;\n\n    ret = qemuExtDevicesSetupCgroup(driver, vm, cgroup_temp);\n\n cleanup:\n    virCgroupFree(&cgroup_temp);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "&cgroup_temp"
          ],
          "line": 1171
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuExtDevicesSetupCgroup",
          "args": [
            "driver",
            "vm",
            "cgroup_temp"
          ],
          "line": 1168
        },
        "resolved": true,
        "details": {
          "function_name": "qemuExtDevicesSetupCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_extdevice.c",
          "lines": "271-300",
          "snippet": "int\nqemuExtDevicesSetupCgroup(virQEMUDriverPtr driver,\n                          virDomainObjPtr vm,\n                          virCgroupPtr cgroup)\n{\n    virDomainDefPtr def = vm->def;\n    size_t i;\n\n    for (i = 0; i < def->nvideos; i++) {\n        virDomainVideoDefPtr video = def->videos[i];\n\n        if (video->backend == VIR_DOMAIN_VIDEO_BACKEND_TYPE_VHOSTUSER &&\n            qemuExtVhostUserGPUSetupCgroup(driver, def, video, cgroup) < 0)\n            return -1;\n    }\n\n    if (def->tpm &&\n        qemuExtTPMSetupCgroup(driver, def, cgroup) < 0)\n        return -1;\n\n    for (i = 0; i < def->nfss; i++) {\n        virDomainFSDefPtr fs = def->fss[i];\n\n        if (fs->fsdriver == VIR_DOMAIN_FS_DRIVER_TYPE_VIRTIOFS &&\n            qemuVirtioFSSetupCgroup(vm, fs, cgroup) < 0)\n            return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virpidfile.h\"",
            "#include \"virtpm.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_virtiofs.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_tpm.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_vhost_user_gpu.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_command.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virpidfile.h\"\n#include \"virtpm.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_virtiofs.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_tpm.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_vhost_user_gpu.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_command.h\"\n#include <config.h>\n\nint\nqemuExtDevicesSetupCgroup(virQEMUDriverPtr driver,\n                          virDomainObjPtr vm,\n                          virCgroupPtr cgroup)\n{\n    virDomainDefPtr def = vm->def;\n    size_t i;\n\n    for (i = 0; i < def->nvideos; i++) {\n        virDomainVideoDefPtr video = def->videos[i];\n\n        if (video->backend == VIR_DOMAIN_VIDEO_BACKEND_TYPE_VHOSTUSER &&\n            qemuExtVhostUserGPUSetupCgroup(driver, def, video, cgroup) < 0)\n            return -1;\n    }\n\n    if (def->tpm &&\n        qemuExtTPMSetupCgroup(driver, def, cgroup) < 0)\n        return -1;\n\n    for (i = 0; i < def->nfss; i++) {\n        virDomainFSDefPtr fs = def->fss[i];\n\n        if (fs->fsdriver == VIR_DOMAIN_FS_DRIVER_TYPE_VIRTIOFS &&\n            qemuVirtioFSSetupCgroup(vm, fs, cgroup) < 0)\n            return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNewThread",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_THREAD_EMULATOR",
            "0",
            "false",
            "&cgroup_temp"
          ],
          "line": 1164
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2825-2835",
          "snippet": "int\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_CPUSET"
          ],
          "line": 1161
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuExtDevicesHasDevice",
          "args": [
            "vm->def"
          ],
          "line": 1151
        },
        "resolved": true,
        "details": {
          "function_name": "qemuExtDevicesHasDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_extdevice.c",
          "lines": "247-268",
          "snippet": "bool\nqemuExtDevicesHasDevice(virDomainDefPtr def)\n{\n    size_t i;\n\n    for (i = 0; i < def->nvideos; i++) {\n        if (def->videos[i]->backend == VIR_DOMAIN_VIDEO_BACKEND_TYPE_VHOSTUSER)\n            return true;\n    }\n\n    if (def->tpm && def->tpm->type == VIR_DOMAIN_TPM_TYPE_EMULATOR)\n        return true;\n\n    for (i = 0; i < def->nfss; i++) {\n        virDomainFSDefPtr fs = def->fss[i];\n\n        if (fs->fsdriver == VIR_DOMAIN_FS_DRIVER_TYPE_VIRTIOFS)\n            return true;\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"virpidfile.h\"",
            "#include \"virtpm.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_virtiofs.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_tpm.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_vhost_user_gpu.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_command.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virpidfile.h\"\n#include \"virtpm.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_virtiofs.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_tpm.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_vhost_user_gpu.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_command.h\"\n#include <config.h>\n\nbool\nqemuExtDevicesHasDevice(virDomainDefPtr def)\n{\n    size_t i;\n\n    for (i = 0; i < def->nvideos; i++) {\n        if (def->videos[i]->backend == VIR_DOMAIN_VIDEO_BACKEND_TYPE_VHOSTUSER)\n            return true;\n    }\n\n    if (def->tpm && def->tpm->type == VIR_DOMAIN_TPM_TYPE_EMULATOR)\n        return true;\n\n    for (i = 0; i < def->nfss; i++) {\n        virDomainFSDefPtr fs = def->fss[i];\n\n        if (fs->fsdriver == VIR_DOMAIN_FS_DRIVER_TYPE_VIRTIOFS)\n            return true;\n    }\n\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupCgroupForExtDevices(virDomainObjPtr vm,\n                             virQEMUDriverPtr driver)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virCgroupPtr cgroup_temp = NULL;\n    int ret = -1;\n\n    if (!qemuExtDevicesHasDevice(vm->def) ||\n        priv->cgroup == NULL)\n        return 0; /* Not supported, so claim success */\n\n    /*\n     * If CPU cgroup controller is not initialized here, then we need\n     * neither period nor quota settings.  And if CPUSET controller is\n     * not initialized either, then there's nothing to do anyway.\n     */\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU) &&\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPUSET))\n        return 0;\n\n    if (virCgroupNewThread(priv->cgroup, VIR_CGROUP_THREAD_EMULATOR, 0,\n                           false, &cgroup_temp) < 0)\n        goto cleanup;\n\n    ret = qemuExtDevicesSetupCgroup(driver, vm, cgroup_temp);\n\n cleanup:\n    virCgroupFree(&cgroup_temp);\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuSetupCgroupCpusetCpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "1135-1140",
    "snippet": "int\nqemuSetupCgroupCpusetCpus(virCgroupPtr cgroup,\n                          virBitmapPtr cpumask)\n{\n    return virCgroupSetupCpusetCpus(cgroup, cpumask);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetupCpusetCpus",
          "args": [
            "cgroup",
            "cpumask"
          ],
          "line": 1139
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupCpusetCpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3671-3683",
          "snippet": "int\nvirCgroupSetupCpusetCpus(virCgroupPtr cgroup, virBitmapPtr cpumask)\n{\n    g_autofree char *new_cpus = NULL;\n\n    if (!(new_cpus = virBitmapFormat(cpumask)))\n        return -1;\n\n    if (virCgroupSetCpusetCpus(cgroup, new_cpus) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupCpusetCpus(virCgroupPtr cgroup, virBitmapPtr cpumask)\n{\n    g_autofree char *new_cpus = NULL;\n\n    if (!(new_cpus = virBitmapFormat(cpumask)))\n        return -1;\n\n    if (virCgroupSetCpusetCpus(cgroup, new_cpus) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupCgroupCpusetCpus(virCgroupPtr cgroup,\n                          virBitmapPtr cpumask)\n{\n    return virCgroupSetupCpusetCpus(cgroup, cpumask);\n}"
  },
  {
    "function_name": "qemuSetupCgroupVcpuBW",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "1126-1132",
    "snippet": "int\nqemuSetupCgroupVcpuBW(virCgroupPtr cgroup,\n                      unsigned long long period,\n                      long long quota)\n{\n    return virCgroupSetupCpuPeriodQuota(cgroup, period, quota);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetupCpuPeriodQuota",
          "args": [
            "cgroup",
            "period",
            "quota"
          ],
          "line": 1131
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupCpuPeriodQuota",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3706-3741",
          "snippet": "int\nvirCgroupSetupCpuPeriodQuota(virCgroupPtr cgroup,\n                             unsigned long long period,\n                             long long quota)\n{\n    unsigned long long old_period;\n\n    if (period == 0 && quota == 0)\n        return 0;\n\n    if (period) {\n        /* get old period, and we can rollback if set quota failed */\n        if (virCgroupGetCpuCfsPeriod(cgroup, &old_period) < 0)\n            return -1;\n\n        if (virCgroupSetCpuCfsPeriod(cgroup, period) < 0)\n            return -1;\n    }\n\n    if (quota &&\n        virCgroupSetCpuCfsQuota(cgroup, quota) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    if (period) {\n        virErrorPtr saved;\n\n        virErrorPreserveLast(&saved);\n        ignore_value(virCgroupSetCpuCfsPeriod(cgroup, old_period));\n        virErrorRestore(&saved);\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupCpuPeriodQuota(virCgroupPtr cgroup,\n                             unsigned long long period,\n                             long long quota)\n{\n    unsigned long long old_period;\n\n    if (period == 0 && quota == 0)\n        return 0;\n\n    if (period) {\n        /* get old period, and we can rollback if set quota failed */\n        if (virCgroupGetCpuCfsPeriod(cgroup, &old_period) < 0)\n            return -1;\n\n        if (virCgroupSetCpuCfsPeriod(cgroup, period) < 0)\n            return -1;\n    }\n\n    if (quota &&\n        virCgroupSetCpuCfsQuota(cgroup, quota) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    if (period) {\n        virErrorPtr saved;\n\n        virErrorPreserveLast(&saved);\n        ignore_value(virCgroupSetCpuCfsPeriod(cgroup, old_period));\n        virErrorRestore(&saved);\n    }\n\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupCgroupVcpuBW(virCgroupPtr cgroup,\n                      unsigned long long period,\n                      long long quota)\n{\n    return virCgroupSetupCpuPeriodQuota(cgroup, period, quota);\n}"
  },
  {
    "function_name": "qemuSetupCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "1089-1124",
    "snippet": "int\nqemuSetupCgroup(virDomainObjPtr vm,\n                size_t nnicindexes,\n                int *nicindexes)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!vm->pid) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot setup cgroups until process is started\"));\n        return -1;\n    }\n\n    if (qemuInitCgroup(vm, nnicindexes, nicindexes) < 0)\n        return -1;\n\n    if (!priv->cgroup)\n        return 0;\n\n    if (qemuSetupDevicesCgroup(vm) < 0)\n        return -1;\n\n    if (qemuSetupBlkioCgroup(vm) < 0)\n        return -1;\n\n    if (qemuSetupMemoryCgroup(vm) < 0)\n        return -1;\n\n    if (qemuSetupCpuCgroup(vm) < 0)\n        return -1;\n\n    if (qemuSetupCpusetCgroup(vm) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuSetupCpusetCgroup",
          "args": [
            "vm"
          ],
          "line": 1120
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupCpusetCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "862-874",
          "snippet": "static int\nqemuSetupCpusetCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPUSET))\n        return 0;\n\n    if (virCgroupSetCpusetMemoryMigrate(priv->cgroup, true) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupCpusetCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPUSET))\n        return 0;\n\n    if (virCgroupSetCpusetMemoryMigrate(priv->cgroup, true) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSetupCpuCgroup",
          "args": [
            "vm"
          ],
          "line": 1117
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupCpuCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "877-917",
          "snippet": "static int\nqemuSetupCpuCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virObjectEventPtr event = NULL;\n    virTypedParameterPtr eventParams = NULL;\n    int eventNparams = 0;\n    int eventMaxparams = 0;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU)) {\n       if (vm->def->cputune.sharesSpecified) {\n           virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                          _(\"CPU tuning is not available on this host\"));\n           return -1;\n       } else {\n           return 0;\n       }\n    }\n\n    if (vm->def->cputune.sharesSpecified) {\n        unsigned long long val;\n        if (virCgroupSetupCpuShares(priv->cgroup, vm->def->cputune.shares,\n                                    &val) < 0)\n            return -1;\n\n        if (vm->def->cputune.shares != val) {\n            vm->def->cputune.shares = val;\n            if (virTypedParamsAddULLong(&eventParams, &eventNparams,\n                                        &eventMaxparams,\n                                        VIR_DOMAIN_TUNABLE_CPU_CPU_SHARES,\n                                        val) < 0)\n                return -1;\n\n            event = virDomainEventTunableNewFromObj(vm, eventParams, eventNparams);\n        }\n\n        virObjectEventStateQueue(priv->driver->domainEventState, event);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupCpuCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virObjectEventPtr event = NULL;\n    virTypedParameterPtr eventParams = NULL;\n    int eventNparams = 0;\n    int eventMaxparams = 0;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU)) {\n       if (vm->def->cputune.sharesSpecified) {\n           virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                          _(\"CPU tuning is not available on this host\"));\n           return -1;\n       } else {\n           return 0;\n       }\n    }\n\n    if (vm->def->cputune.sharesSpecified) {\n        unsigned long long val;\n        if (virCgroupSetupCpuShares(priv->cgroup, vm->def->cputune.shares,\n                                    &val) < 0)\n            return -1;\n\n        if (vm->def->cputune.shares != val) {\n            vm->def->cputune.shares = val;\n            if (virTypedParamsAddULLong(&eventParams, &eventNparams,\n                                        &eventMaxparams,\n                                        VIR_DOMAIN_TUNABLE_CPU_CPU_SHARES,\n                                        val) < 0)\n                return -1;\n\n            event = virDomainEventTunableNewFromObj(vm, eventParams, eventNparams);\n        }\n\n        virObjectEventStateQueue(priv->driver->domainEventState, event);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSetupMemoryCgroup",
          "args": [
            "vm"
          ],
          "line": 1114
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupMemoryCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "612-630",
          "snippet": "static int\nqemuSetupMemoryCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_MEMORY)) {\n        if (virMemoryLimitIsSet(vm->def->mem.hard_limit) ||\n            virMemoryLimitIsSet(vm->def->mem.soft_limit) ||\n            virMemoryLimitIsSet(vm->def->mem.swap_hard_limit)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Memory cgroup is not available on this host\"));\n            return -1;\n        } else {\n            return 0;\n        }\n    }\n\n    return virDomainCgroupSetupMemtune(priv->cgroup, vm->def->mem);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupMemoryCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_MEMORY)) {\n        if (virMemoryLimitIsSet(vm->def->mem.hard_limit) ||\n            virMemoryLimitIsSet(vm->def->mem.soft_limit) ||\n            virMemoryLimitIsSet(vm->def->mem.swap_hard_limit)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Memory cgroup is not available on this host\"));\n            return -1;\n        } else {\n            return 0;\n        }\n    }\n\n    return virDomainCgroupSetupMemtune(priv->cgroup, vm->def->mem);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSetupBlkioCgroup",
          "args": [
            "vm"
          ],
          "line": 1111
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupBlkioCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "592-609",
          "snippet": "static int\nqemuSetupBlkioCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!virCgroupHasController(priv->cgroup,\n                                VIR_CGROUP_CONTROLLER_BLKIO)) {\n        if (vm->def->blkio.weight || vm->def->blkio.ndevices) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Block I/O tuning is not available on this host\"));\n            return -1;\n        } else {\n            return 0;\n        }\n    }\n\n    return virDomainCgroupSetupBlkio(priv->cgroup, vm->def->blkio);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupBlkioCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!virCgroupHasController(priv->cgroup,\n                                VIR_CGROUP_CONTROLLER_BLKIO)) {\n        if (vm->def->blkio.weight || vm->def->blkio.ndevices) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Block I/O tuning is not available on this host\"));\n            return -1;\n        } else {\n            return 0;\n        }\n    }\n\n    return virDomainCgroupSetupBlkio(priv->cgroup, vm->def->blkio);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSetupDevicesCgroup",
          "args": [
            "vm"
          ],
          "line": 1108
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupDevicesCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "738-859",
          "snippet": "static int\nqemuSetupDevicesCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverConfigPtr cfg = NULL;\n    const char *const *deviceACL = NULL;\n    int rv = -1;\n    int ret = -1;\n    size_t i;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    rv = virCgroupDenyAllDevices(priv->cgroup);\n    virDomainAuditCgroup(vm, priv->cgroup, \"deny\", \"all\", rv == 0);\n    if (rv < 0) {\n        if (virLastErrorIsSystemErrno(EPERM)) {\n            virResetLastError();\n            VIR_WARN(\"Group devices ACL is not accessible, disabling whitelisting\");\n            return 0;\n        }\n\n        goto cleanup;\n    }\n\n    if (qemuSetupFirmwareCgroup(vm) < 0)\n        goto cleanup;\n\n    for (i = 0; i < vm->def->ndisks; i++) {\n        if (qemuSetupImageChainCgroup(vm, vm->def->disks[i]->src) < 0)\n            goto cleanup;\n    }\n\n    rv = virCgroupAllowDevice(priv->cgroup, 'c', DEVICE_PTY_MAJOR, -1,\n                              VIR_CGROUP_DEVICE_RW);\n    virDomainAuditCgroupMajor(vm, priv->cgroup, \"allow\", DEVICE_PTY_MAJOR,\n                              \"pty\", \"rw\", rv == 0);\n    if (rv < 0)\n        goto cleanup;\n\n    cfg = virQEMUDriverGetConfig(priv->driver);\n    deviceACL = cfg->cgroupDeviceACL ?\n                (const char *const *)cfg->cgroupDeviceACL :\n                defaultDeviceACL;\n\n    if (vm->def->nsounds &&\n        ((!vm->def->ngraphics && cfg->nogfxAllowHostAudio) ||\n         (vm->def->graphics &&\n          ((vm->def->graphics[0]->type == VIR_DOMAIN_GRAPHICS_TYPE_VNC &&\n           cfg->vncAllowHostAudio) ||\n           (vm->def->graphics[0]->type == VIR_DOMAIN_GRAPHICS_TYPE_SDL))))) {\n        rv = virCgroupAllowDevice(priv->cgroup, 'c', DEVICE_SND_MAJOR, -1,\n                                  VIR_CGROUP_DEVICE_RW);\n        virDomainAuditCgroupMajor(vm, priv->cgroup, \"allow\", DEVICE_SND_MAJOR,\n                                  \"sound\", \"rw\", rv == 0);\n        if (rv < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; deviceACL[i] != NULL; i++) {\n        if (!virFileExists(deviceACL[i])) {\n            VIR_DEBUG(\"Ignoring non-existent device %s\", deviceACL[i]);\n            continue;\n        }\n\n        rv = virCgroupAllowDevicePath(priv->cgroup, deviceACL[i],\n                                      VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", deviceACL[i], \"rw\", rv);\n        if (rv < 0 &&\n            !virLastErrorIsSystemErrno(ENOENT))\n            goto cleanup;\n    }\n\n    if (virDomainChrDefForeach(vm->def,\n                               true,\n                               qemuSetupChardevCgroupCB,\n                               vm) < 0)\n        goto cleanup;\n\n    if (vm->def->tpm && qemuSetupTPMCgroup(vm) < 0)\n        goto cleanup;\n\n    for (i = 0; i < vm->def->nhostdevs; i++) {\n        /* This may allow /dev/vfio/vfio multiple times, but that\n         * is not a problem. Kernel will have only one record. */\n        if (qemuSetupHostdevCgroup(vm, vm->def->hostdevs[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->nmems; i++) {\n        if (qemuSetupMemoryDevicesCgroup(vm, vm->def->mems[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->ngraphics; i++) {\n        if (qemuSetupGraphicsCgroup(vm, vm->def->graphics[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->nvideos; i++) {\n        if (qemuSetupVideoCgroup(vm, vm->def->videos[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->ninputs; i++) {\n        if (qemuSetupInputCgroup(vm, vm->def->inputs[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->nrngs; i++) {\n        if (qemuSetupRNGCgroup(vm, vm->def->rngs[i]) < 0)\n            goto cleanup;\n    }\n\n    if (vm->def->sev && qemuSetupSEVCgroup(vm) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virObjectUnref(cfg);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define DEVICE_SND_MAJOR 116",
            "#define DEVICE_PTY_MAJOR 136"
          ],
          "globals_used": [
            "const char *const defaultDeviceACL[] = {\n    \"/dev/null\", \"/dev/full\", \"/dev/zero\",\n    \"/dev/random\", \"/dev/urandom\",\n    \"/dev/ptmx\", \"/dev/kvm\",\n    \"/dev/rtc\", \"/dev/hpet\",\n    NULL,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\n#define DEVICE_SND_MAJOR 116\n#define DEVICE_PTY_MAJOR 136\n\nconst char *const defaultDeviceACL[] = {\n    \"/dev/null\", \"/dev/full\", \"/dev/zero\",\n    \"/dev/random\", \"/dev/urandom\",\n    \"/dev/ptmx\", \"/dev/kvm\",\n    \"/dev/rtc\", \"/dev/hpet\",\n    NULL,\n};\n\nstatic int\nqemuSetupDevicesCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverConfigPtr cfg = NULL;\n    const char *const *deviceACL = NULL;\n    int rv = -1;\n    int ret = -1;\n    size_t i;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    rv = virCgroupDenyAllDevices(priv->cgroup);\n    virDomainAuditCgroup(vm, priv->cgroup, \"deny\", \"all\", rv == 0);\n    if (rv < 0) {\n        if (virLastErrorIsSystemErrno(EPERM)) {\n            virResetLastError();\n            VIR_WARN(\"Group devices ACL is not accessible, disabling whitelisting\");\n            return 0;\n        }\n\n        goto cleanup;\n    }\n\n    if (qemuSetupFirmwareCgroup(vm) < 0)\n        goto cleanup;\n\n    for (i = 0; i < vm->def->ndisks; i++) {\n        if (qemuSetupImageChainCgroup(vm, vm->def->disks[i]->src) < 0)\n            goto cleanup;\n    }\n\n    rv = virCgroupAllowDevice(priv->cgroup, 'c', DEVICE_PTY_MAJOR, -1,\n                              VIR_CGROUP_DEVICE_RW);\n    virDomainAuditCgroupMajor(vm, priv->cgroup, \"allow\", DEVICE_PTY_MAJOR,\n                              \"pty\", \"rw\", rv == 0);\n    if (rv < 0)\n        goto cleanup;\n\n    cfg = virQEMUDriverGetConfig(priv->driver);\n    deviceACL = cfg->cgroupDeviceACL ?\n                (const char *const *)cfg->cgroupDeviceACL :\n                defaultDeviceACL;\n\n    if (vm->def->nsounds &&\n        ((!vm->def->ngraphics && cfg->nogfxAllowHostAudio) ||\n         (vm->def->graphics &&\n          ((vm->def->graphics[0]->type == VIR_DOMAIN_GRAPHICS_TYPE_VNC &&\n           cfg->vncAllowHostAudio) ||\n           (vm->def->graphics[0]->type == VIR_DOMAIN_GRAPHICS_TYPE_SDL))))) {\n        rv = virCgroupAllowDevice(priv->cgroup, 'c', DEVICE_SND_MAJOR, -1,\n                                  VIR_CGROUP_DEVICE_RW);\n        virDomainAuditCgroupMajor(vm, priv->cgroup, \"allow\", DEVICE_SND_MAJOR,\n                                  \"sound\", \"rw\", rv == 0);\n        if (rv < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; deviceACL[i] != NULL; i++) {\n        if (!virFileExists(deviceACL[i])) {\n            VIR_DEBUG(\"Ignoring non-existent device %s\", deviceACL[i]);\n            continue;\n        }\n\n        rv = virCgroupAllowDevicePath(priv->cgroup, deviceACL[i],\n                                      VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", deviceACL[i], \"rw\", rv);\n        if (rv < 0 &&\n            !virLastErrorIsSystemErrno(ENOENT))\n            goto cleanup;\n    }\n\n    if (virDomainChrDefForeach(vm->def,\n                               true,\n                               qemuSetupChardevCgroupCB,\n                               vm) < 0)\n        goto cleanup;\n\n    if (vm->def->tpm && qemuSetupTPMCgroup(vm) < 0)\n        goto cleanup;\n\n    for (i = 0; i < vm->def->nhostdevs; i++) {\n        /* This may allow /dev/vfio/vfio multiple times, but that\n         * is not a problem. Kernel will have only one record. */\n        if (qemuSetupHostdevCgroup(vm, vm->def->hostdevs[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->nmems; i++) {\n        if (qemuSetupMemoryDevicesCgroup(vm, vm->def->mems[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->ngraphics; i++) {\n        if (qemuSetupGraphicsCgroup(vm, vm->def->graphics[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->nvideos; i++) {\n        if (qemuSetupVideoCgroup(vm, vm->def->videos[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->ninputs; i++) {\n        if (qemuSetupInputCgroup(vm, vm->def->inputs[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->nrngs; i++) {\n        if (qemuSetupRNGCgroup(vm, vm->def->rngs[i]) < 0)\n            goto cleanup;\n    }\n\n    if (vm->def->sev && qemuSetupSEVCgroup(vm) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virObjectUnref(cfg);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuInitCgroup",
          "args": [
            "vm",
            "nnicindexes",
            "nicindexes"
          ],
          "line": 1102
        },
        "resolved": true,
        "details": {
          "function_name": "qemuInitCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "920-977",
          "snippet": "static int\nqemuInitCgroup(virDomainObjPtr vm,\n               size_t nnicindexes,\n               int *nicindexes)\n{\n    int ret = -1;\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverConfigPtr cfg = virQEMUDriverGetConfig(priv->driver);\n\n    if (!virQEMUDriverIsPrivileged(priv->driver))\n        goto done;\n\n    if (!virCgroupAvailable())\n        goto done;\n\n    virCgroupFree(&priv->cgroup);\n\n    if (!vm->def->resource) {\n        virDomainResourceDefPtr res;\n\n        if (VIR_ALLOC(res) < 0)\n            goto cleanup;\n\n        res->partition = g_strdup(\"/machine\");\n\n        vm->def->resource = res;\n    }\n\n    if (vm->def->resource->partition[0] != '/') {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Resource partition '%s' must start with '/'\"),\n                       vm->def->resource->partition);\n        goto cleanup;\n    }\n\n    if (virCgroupNewMachine(priv->machineName,\n                            \"qemu\",\n                            vm->def->uuid,\n                            NULL,\n                            vm->pid,\n                            false,\n                            nnicindexes, nicindexes,\n                            vm->def->resource->partition,\n                            cfg->cgroupControllers,\n                            cfg->maxThreadsPerProc,\n                            &priv->cgroup) < 0) {\n        if (virCgroupNewIgnoreError())\n            goto done;\n\n        goto cleanup;\n    }\n\n done:\n    ret = 0;\n cleanup:\n    virObjectUnref(cfg);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuInitCgroup(virDomainObjPtr vm,\n               size_t nnicindexes,\n               int *nicindexes)\n{\n    int ret = -1;\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverConfigPtr cfg = virQEMUDriverGetConfig(priv->driver);\n\n    if (!virQEMUDriverIsPrivileged(priv->driver))\n        goto done;\n\n    if (!virCgroupAvailable())\n        goto done;\n\n    virCgroupFree(&priv->cgroup);\n\n    if (!vm->def->resource) {\n        virDomainResourceDefPtr res;\n\n        if (VIR_ALLOC(res) < 0)\n            goto cleanup;\n\n        res->partition = g_strdup(\"/machine\");\n\n        vm->def->resource = res;\n    }\n\n    if (vm->def->resource->partition[0] != '/') {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Resource partition '%s' must start with '/'\"),\n                       vm->def->resource->partition);\n        goto cleanup;\n    }\n\n    if (virCgroupNewMachine(priv->machineName,\n                            \"qemu\",\n                            vm->def->uuid,\n                            NULL,\n                            vm->pid,\n                            false,\n                            nnicindexes, nicindexes,\n                            vm->def->resource->partition,\n                            cfg->cgroupControllers,\n                            cfg->maxThreadsPerProc,\n                            &priv->cgroup) < 0) {\n        if (virCgroupNewIgnoreError())\n            goto done;\n\n        goto cleanup;\n    }\n\n done:\n    ret = 0;\n cleanup:\n    virObjectUnref(cfg);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot setup cgroups until process is started\")"
          ],
          "line": 1097
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot setup cgroups until process is started\""
          ],
          "line": 1098
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupCgroup(virDomainObjPtr vm,\n                size_t nnicindexes,\n                int *nicindexes)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!vm->pid) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot setup cgroups until process is started\"));\n        return -1;\n    }\n\n    if (qemuInitCgroup(vm, nnicindexes, nicindexes) < 0)\n        return -1;\n\n    if (!priv->cgroup)\n        return 0;\n\n    if (qemuSetupDevicesCgroup(vm) < 0)\n        return -1;\n\n    if (qemuSetupBlkioCgroup(vm) < 0)\n        return -1;\n\n    if (qemuSetupMemoryCgroup(vm) < 0)\n        return -1;\n\n    if (qemuSetupCpuCgroup(vm) < 0)\n        return -1;\n\n    if (qemuSetupCpusetCgroup(vm) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuConnectCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "1057-1087",
    "snippet": "int\nqemuConnectCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverConfigPtr cfg = virQEMUDriverGetConfig(priv->driver);\n    int ret = -1;\n\n    if (!virQEMUDriverIsPrivileged(priv->driver))\n        goto done;\n\n    if (!virCgroupAvailable())\n        goto done;\n\n    virCgroupFree(&priv->cgroup);\n\n    if (virCgroupNewDetectMachine(vm->def->name,\n                                  \"qemu\",\n                                  vm->pid,\n                                  cfg->cgroupControllers,\n                                  priv->machineName,\n                                  &priv->cgroup) < 0)\n        goto cleanup;\n\n    qemuRestoreCgroupState(vm);\n\n done:\n    ret = 0;\n cleanup:\n    virObjectUnref(cfg);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 1085
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuRestoreCgroupState",
          "args": [
            "vm"
          ],
          "line": 1080
        },
        "resolved": true,
        "details": {
          "function_name": "qemuRestoreCgroupState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "979-1055",
          "snippet": "static void\nqemuRestoreCgroupState(virDomainObjPtr vm)\n{\n    char *mem_mask = NULL;\n    char *nodeset = NULL;\n    int empty = -1;\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    size_t i = 0;\n    virBitmapPtr all_nodes;\n    virCgroupPtr cgroup_temp = NULL;\n\n    if (!virNumaIsAvailable() ||\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPUSET))\n        return;\n\n    if (!(all_nodes = virNumaGetHostMemoryNodeset()))\n        goto error;\n\n    if (!(mem_mask = virBitmapFormat(all_nodes)))\n        goto error;\n\n    if ((empty = virCgroupHasEmptyTasks(priv->cgroup,\n                                        VIR_CGROUP_CONTROLLER_CPUSET)) <= 0)\n        goto error;\n\n    if (virCgroupSetCpusetMems(priv->cgroup, mem_mask) < 0)\n        goto error;\n\n    for (i = 0; i < virDomainDefGetVcpusMax(vm->def); i++) {\n        virDomainVcpuDefPtr vcpu = virDomainDefGetVcpu(vm->def, i);\n\n        if (!vcpu->online)\n            continue;\n\n        if (virCgroupNewThread(priv->cgroup, VIR_CGROUP_THREAD_VCPU, i,\n                               false, &cgroup_temp) < 0 ||\n            virCgroupSetCpusetMemoryMigrate(cgroup_temp, true) < 0 ||\n            virCgroupGetCpusetMems(cgroup_temp, &nodeset) < 0 ||\n            virCgroupSetCpusetMems(cgroup_temp, nodeset) < 0)\n            goto cleanup;\n\n        VIR_FREE(nodeset);\n        virCgroupFree(&cgroup_temp);\n    }\n\n    for (i = 0; i < vm->def->niothreadids; i++) {\n        if (virCgroupNewThread(priv->cgroup, VIR_CGROUP_THREAD_IOTHREAD,\n                               vm->def->iothreadids[i]->iothread_id,\n                               false, &cgroup_temp) < 0 ||\n            virCgroupSetCpusetMemoryMigrate(cgroup_temp, true) < 0 ||\n            virCgroupGetCpusetMems(cgroup_temp, &nodeset) < 0 ||\n            virCgroupSetCpusetMems(cgroup_temp, nodeset) < 0)\n            goto cleanup;\n\n        VIR_FREE(nodeset);\n        virCgroupFree(&cgroup_temp);\n    }\n\n    if (virCgroupNewThread(priv->cgroup, VIR_CGROUP_THREAD_EMULATOR, 0,\n                           false, &cgroup_temp) < 0 ||\n        virCgroupSetCpusetMemoryMigrate(cgroup_temp, true) < 0 ||\n        virCgroupGetCpusetMems(cgroup_temp, &nodeset) < 0 ||\n        virCgroupSetCpusetMems(cgroup_temp, nodeset) < 0)\n        goto cleanup;\n\n cleanup:\n    VIR_FREE(mem_mask);\n    VIR_FREE(nodeset);\n    virBitmapFree(all_nodes);\n    virCgroupFree(&cgroup_temp);\n    return;\n\n error:\n    virResetLastError();\n    VIR_DEBUG(\"Couldn't restore cgroups to meaningful state\");\n    goto cleanup;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic void\nqemuRestoreCgroupState(virDomainObjPtr vm)\n{\n    char *mem_mask = NULL;\n    char *nodeset = NULL;\n    int empty = -1;\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    size_t i = 0;\n    virBitmapPtr all_nodes;\n    virCgroupPtr cgroup_temp = NULL;\n\n    if (!virNumaIsAvailable() ||\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPUSET))\n        return;\n\n    if (!(all_nodes = virNumaGetHostMemoryNodeset()))\n        goto error;\n\n    if (!(mem_mask = virBitmapFormat(all_nodes)))\n        goto error;\n\n    if ((empty = virCgroupHasEmptyTasks(priv->cgroup,\n                                        VIR_CGROUP_CONTROLLER_CPUSET)) <= 0)\n        goto error;\n\n    if (virCgroupSetCpusetMems(priv->cgroup, mem_mask) < 0)\n        goto error;\n\n    for (i = 0; i < virDomainDefGetVcpusMax(vm->def); i++) {\n        virDomainVcpuDefPtr vcpu = virDomainDefGetVcpu(vm->def, i);\n\n        if (!vcpu->online)\n            continue;\n\n        if (virCgroupNewThread(priv->cgroup, VIR_CGROUP_THREAD_VCPU, i,\n                               false, &cgroup_temp) < 0 ||\n            virCgroupSetCpusetMemoryMigrate(cgroup_temp, true) < 0 ||\n            virCgroupGetCpusetMems(cgroup_temp, &nodeset) < 0 ||\n            virCgroupSetCpusetMems(cgroup_temp, nodeset) < 0)\n            goto cleanup;\n\n        VIR_FREE(nodeset);\n        virCgroupFree(&cgroup_temp);\n    }\n\n    for (i = 0; i < vm->def->niothreadids; i++) {\n        if (virCgroupNewThread(priv->cgroup, VIR_CGROUP_THREAD_IOTHREAD,\n                               vm->def->iothreadids[i]->iothread_id,\n                               false, &cgroup_temp) < 0 ||\n            virCgroupSetCpusetMemoryMigrate(cgroup_temp, true) < 0 ||\n            virCgroupGetCpusetMems(cgroup_temp, &nodeset) < 0 ||\n            virCgroupSetCpusetMems(cgroup_temp, nodeset) < 0)\n            goto cleanup;\n\n        VIR_FREE(nodeset);\n        virCgroupFree(&cgroup_temp);\n    }\n\n    if (virCgroupNewThread(priv->cgroup, VIR_CGROUP_THREAD_EMULATOR, 0,\n                           false, &cgroup_temp) < 0 ||\n        virCgroupSetCpusetMemoryMigrate(cgroup_temp, true) < 0 ||\n        virCgroupGetCpusetMems(cgroup_temp, &nodeset) < 0 ||\n        virCgroupSetCpusetMems(cgroup_temp, nodeset) < 0)\n        goto cleanup;\n\n cleanup:\n    VIR_FREE(mem_mask);\n    VIR_FREE(nodeset);\n    virBitmapFree(all_nodes);\n    virCgroupFree(&cgroup_temp);\n    return;\n\n error:\n    virResetLastError();\n    VIR_DEBUG(\"Couldn't restore cgroups to meaningful state\");\n    goto cleanup;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNewDetectMachine",
          "args": [
            "vm->def->name",
            "\"qemu\"",
            "vm->pid",
            "cfg->cgroupControllers",
            "priv->machineName",
            "&priv->cgroup"
          ],
          "line": 1072
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewDetectMachine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2849-2860",
          "snippet": "int\nvirCgroupNewDetectMachine(const char *name G_GNUC_UNUSED,\n                          const char *drivername G_GNUC_UNUSED,\n                          pid_t pid G_GNUC_UNUSED,\n                          int controllers G_GNUC_UNUSED,\n                          char *machinename G_GNUC_UNUSED,\n                          virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewDetectMachine(const char *name G_GNUC_UNUSED,\n                          const char *drivername G_GNUC_UNUSED,\n                          pid_t pid G_GNUC_UNUSED,\n                          int controllers G_GNUC_UNUSED,\n                          char *machinename G_GNUC_UNUSED,\n                          virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "&priv->cgroup"
          ],
          "line": 1070
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupAvailable",
          "args": [],
          "line": 1067
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAvailable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2784-2788",
          "snippet": "bool\nvirCgroupAvailable(void)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupAvailable(void)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverIsPrivileged",
          "args": [
            "priv->driver"
          ],
          "line": 1064
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverIsPrivileged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1220-1224",
          "snippet": "bool\nvirQEMUDriverIsPrivileged(virQEMUDriverPtr driver)\n{\n    return driver->privileged;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirQEMUDriverIsPrivileged(virQEMUDriverPtr driver)\n{\n    return driver->privileged;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverGetConfig",
          "args": [
            "priv->driver"
          ],
          "line": 1061
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1211-1218",
          "snippet": "virQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuConnectCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverConfigPtr cfg = virQEMUDriverGetConfig(priv->driver);\n    int ret = -1;\n\n    if (!virQEMUDriverIsPrivileged(priv->driver))\n        goto done;\n\n    if (!virCgroupAvailable())\n        goto done;\n\n    virCgroupFree(&priv->cgroup);\n\n    if (virCgroupNewDetectMachine(vm->def->name,\n                                  \"qemu\",\n                                  vm->pid,\n                                  cfg->cgroupControllers,\n                                  priv->machineName,\n                                  &priv->cgroup) < 0)\n        goto cleanup;\n\n    qemuRestoreCgroupState(vm);\n\n done:\n    ret = 0;\n cleanup:\n    virObjectUnref(cfg);\n    return ret;\n}"
  },
  {
    "function_name": "qemuRestoreCgroupState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "979-1055",
    "snippet": "static void\nqemuRestoreCgroupState(virDomainObjPtr vm)\n{\n    char *mem_mask = NULL;\n    char *nodeset = NULL;\n    int empty = -1;\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    size_t i = 0;\n    virBitmapPtr all_nodes;\n    virCgroupPtr cgroup_temp = NULL;\n\n    if (!virNumaIsAvailable() ||\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPUSET))\n        return;\n\n    if (!(all_nodes = virNumaGetHostMemoryNodeset()))\n        goto error;\n\n    if (!(mem_mask = virBitmapFormat(all_nodes)))\n        goto error;\n\n    if ((empty = virCgroupHasEmptyTasks(priv->cgroup,\n                                        VIR_CGROUP_CONTROLLER_CPUSET)) <= 0)\n        goto error;\n\n    if (virCgroupSetCpusetMems(priv->cgroup, mem_mask) < 0)\n        goto error;\n\n    for (i = 0; i < virDomainDefGetVcpusMax(vm->def); i++) {\n        virDomainVcpuDefPtr vcpu = virDomainDefGetVcpu(vm->def, i);\n\n        if (!vcpu->online)\n            continue;\n\n        if (virCgroupNewThread(priv->cgroup, VIR_CGROUP_THREAD_VCPU, i,\n                               false, &cgroup_temp) < 0 ||\n            virCgroupSetCpusetMemoryMigrate(cgroup_temp, true) < 0 ||\n            virCgroupGetCpusetMems(cgroup_temp, &nodeset) < 0 ||\n            virCgroupSetCpusetMems(cgroup_temp, nodeset) < 0)\n            goto cleanup;\n\n        VIR_FREE(nodeset);\n        virCgroupFree(&cgroup_temp);\n    }\n\n    for (i = 0; i < vm->def->niothreadids; i++) {\n        if (virCgroupNewThread(priv->cgroup, VIR_CGROUP_THREAD_IOTHREAD,\n                               vm->def->iothreadids[i]->iothread_id,\n                               false, &cgroup_temp) < 0 ||\n            virCgroupSetCpusetMemoryMigrate(cgroup_temp, true) < 0 ||\n            virCgroupGetCpusetMems(cgroup_temp, &nodeset) < 0 ||\n            virCgroupSetCpusetMems(cgroup_temp, nodeset) < 0)\n            goto cleanup;\n\n        VIR_FREE(nodeset);\n        virCgroupFree(&cgroup_temp);\n    }\n\n    if (virCgroupNewThread(priv->cgroup, VIR_CGROUP_THREAD_EMULATOR, 0,\n                           false, &cgroup_temp) < 0 ||\n        virCgroupSetCpusetMemoryMigrate(cgroup_temp, true) < 0 ||\n        virCgroupGetCpusetMems(cgroup_temp, &nodeset) < 0 ||\n        virCgroupSetCpusetMems(cgroup_temp, nodeset) < 0)\n        goto cleanup;\n\n cleanup:\n    VIR_FREE(mem_mask);\n    VIR_FREE(nodeset);\n    virBitmapFree(all_nodes);\n    virCgroupFree(&cgroup_temp);\n    return;\n\n error:\n    virResetLastError();\n    VIR_DEBUG(\"Couldn't restore cgroups to meaningful state\");\n    goto cleanup;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Couldn't restore cgroups to meaningful state\""
          ],
          "line": 1053
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1052
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "&cgroup_temp"
          ],
          "line": 1048
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapFree",
          "args": [
            "all_nodes"
          ],
          "line": 1047
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "128-135",
          "snippet": "void\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "nodeset"
          ],
          "line": 1046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "mem_mask"
          ],
          "line": 1045
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupSetCpusetMems",
          "args": [
            "cgroup_temp",
            "nodeset"
          ],
          "line": 1041
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetCpusetMems",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3201-3208",
          "snippet": "int\nvirCgroupSetCpusetMems(virCgroupPtr group G_GNUC_UNUSED,\n                       const char *mems G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpusetMems(virCgroupPtr group G_GNUC_UNUSED,\n                       const char *mems G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetCpusetMems",
          "args": [
            "cgroup_temp",
            "&nodeset"
          ],
          "line": 1040
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetCpusetMems",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3211-3218",
          "snippet": "int\nvirCgroupGetCpusetMems(virCgroupPtr group G_GNUC_UNUSED,\n                       char **mems G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpusetMems(virCgroupPtr group G_GNUC_UNUSED,\n                       char **mems G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetCpusetMemoryMigrate",
          "args": [
            "cgroup_temp",
            "true"
          ],
          "line": 1039
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetCpusetMemoryMigrate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3221-3228",
          "snippet": "int\nvirCgroupSetCpusetMemoryMigrate(virCgroupPtr group G_GNUC_UNUSED,\n                                bool migrate G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpusetMemoryMigrate(virCgroupPtr group G_GNUC_UNUSED,\n                                bool migrate G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNewThread",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_THREAD_EMULATOR",
            "0",
            "false",
            "&cgroup_temp"
          ],
          "line": 1037
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2825-2835",
          "snippet": "int\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "nodeset"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "nodeset"
          ],
          "line": 1020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDefGetVcpu",
          "args": [
            "vm->def",
            "i"
          ],
          "line": 1008
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetVcpusTopology",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2066-2090",
          "snippet": "int\nvirDomainDefGetVcpusTopology(const virDomainDef *def,\n                             unsigned int *maxvcpus)\n{\n    unsigned long long tmp;\n\n    if (!def->cpu || def->cpu->sockets == 0)\n        return 1;\n\n    tmp = def->cpu->sockets;\n\n    /* multiplication of 32bit numbers fits into a 64bit variable */\n    if ((tmp *= def->cpu->dies) > UINT_MAX ||\n        (tmp *= def->cpu->cores) > UINT_MAX ||\n        (tmp *= def->cpu->threads) > UINT_MAX) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"cpu topology results in more than %u cpus\"), UINT_MAX);\n        return -1;\n    }\n\n    if (maxvcpus)\n        *maxvcpus = tmp;\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefGetVcpusTopology(const virDomainDef *def,\n                             unsigned int *maxvcpus)\n{\n    unsigned long long tmp;\n\n    if (!def->cpu || def->cpu->sockets == 0)\n        return 1;\n\n    tmp = def->cpu->sockets;\n\n    /* multiplication of 32bit numbers fits into a 64bit variable */\n    if ((tmp *= def->cpu->dies) > UINT_MAX ||\n        (tmp *= def->cpu->cores) > UINT_MAX ||\n        (tmp *= def->cpu->threads) > UINT_MAX) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"cpu topology results in more than %u cpus\"), UINT_MAX);\n        return -1;\n    }\n\n    if (maxvcpus)\n        *maxvcpus = tmp;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetVcpusMax",
          "args": [
            "vm->def"
          ],
          "line": 1007
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetVcpusMax",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1882-1886",
          "snippet": "unsigned int\nvirDomainDefGetVcpusMax(const virDomainDef *def)\n{\n    return def->maxvcpus;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned int\nvirDomainDefGetVcpusMax(const virDomainDef *def)\n{\n    return def->maxvcpus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasEmptyTasks",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_CPUSET"
          ],
          "line": 1000
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasEmptyTasks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3522-3529",
          "snippet": "int\nvirCgroupHasEmptyTasks(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupHasEmptyTasks(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapFormat",
          "args": [
            "all_nodes"
          ],
          "line": 997
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "404-442",
          "snippet": "char *\nvirBitmapFormat(virBitmapPtr bitmap)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bool first = true;\n    int start, cur, prev;\n\n    if (!bitmap || (cur = virBitmapNextSetBit(bitmap, -1)) < 0) {\n        char *ret;\n        ret = g_strdup(\"\");\n        return ret;\n    }\n\n    start = prev = cur;\n    while (prev >= 0) {\n        cur = virBitmapNextSetBit(bitmap, prev);\n\n        if (cur == prev + 1) {\n            prev = cur;\n            continue;\n        }\n\n        /* cur < 0 or cur > prev + 1 */\n\n        if (!first)\n            virBufferAddLit(&buf, \",\");\n        else\n            first = false;\n\n        if (prev == start)\n            virBufferAsprintf(&buf, \"%d\", start);\n        else\n            virBufferAsprintf(&buf, \"%d-%d\", start, prev);\n\n        start = prev = cur;\n    }\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nvirBitmapFormat(virBitmapPtr bitmap)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bool first = true;\n    int start, cur, prev;\n\n    if (!bitmap || (cur = virBitmapNextSetBit(bitmap, -1)) < 0) {\n        char *ret;\n        ret = g_strdup(\"\");\n        return ret;\n    }\n\n    start = prev = cur;\n    while (prev >= 0) {\n        cur = virBitmapNextSetBit(bitmap, prev);\n\n        if (cur == prev + 1) {\n            prev = cur;\n            continue;\n        }\n\n        /* cur < 0 or cur > prev + 1 */\n\n        if (!first)\n            virBufferAddLit(&buf, \",\");\n        else\n            first = false;\n\n        if (prev == start)\n            virBufferAsprintf(&buf, \"%d\", start);\n        else\n            virBufferAsprintf(&buf, \"%d-%d\", start, prev);\n\n        start = prev = cur;\n    }\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNumaGetHostMemoryNodeset",
          "args": [],
          "line": 994
        },
        "resolved": true,
        "details": {
          "function_name": "virNumaGetHostMemoryNodeset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnuma.c",
          "lines": "1018-1042",
          "snippet": "virBitmapPtr\nvirNumaGetHostMemoryNodeset(void)\n{\n    int maxnode = virNumaGetMaxNode();\n    unsigned long long nodesize;\n    size_t i = 0;\n    virBitmapPtr nodeset = NULL;\n\n    if (maxnode < 0)\n        return NULL;\n\n    if (!(nodeset = virBitmapNew(maxnode + 1)))\n        return NULL;\n\n    for (i = 0; i <= maxnode; i++) {\n        if (!virNumaNodeIsAvailable(i))\n            continue;\n\n        /* if we can't detect NUMA node size assume that it's present */\n        if (virNumaGetNodeMemory(i, &nodesize, NULL) < 0 || nodesize > 0)\n            ignore_value(virBitmapSetBit(nodeset, i));\n    }\n\n    return nodeset;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virnuma.h\"",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "# include <numa.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostmem.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virnuma.h\"\n#include <dirent.h>\n#include <sys/types.h>\n# include <numa.h>\n#include <config.h>\n\nvirBitmapPtr\nvirNumaGetHostMemoryNodeset(void)\n{\n    int maxnode = virNumaGetMaxNode();\n    unsigned long long nodesize;\n    size_t i = 0;\n    virBitmapPtr nodeset = NULL;\n\n    if (maxnode < 0)\n        return NULL;\n\n    if (!(nodeset = virBitmapNew(maxnode + 1)))\n        return NULL;\n\n    for (i = 0; i <= maxnode; i++) {\n        if (!virNumaNodeIsAvailable(i))\n            continue;\n\n        /* if we can't detect NUMA node size assume that it's present */\n        if (virNumaGetNodeMemory(i, &nodesize, NULL) < 0 || nodesize > 0)\n            ignore_value(virBitmapSetBit(nodeset, i));\n    }\n\n    return nodeset;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_CPUSET"
          ],
          "line": 991
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNumaIsAvailable",
          "args": [],
          "line": 990
        },
        "resolved": true,
        "details": {
          "function_name": "virNumaIsAvailable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnuma.c",
          "lines": "355-359",
          "snippet": "bool\nvirNumaIsAvailable(void)\n{\n    return false;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virnuma.h\"",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "# include <numa.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostmem.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virnuma.h\"\n#include <dirent.h>\n#include <sys/types.h>\n# include <numa.h>\n#include <config.h>\n\nbool\nvirNumaIsAvailable(void)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic void\nqemuRestoreCgroupState(virDomainObjPtr vm)\n{\n    char *mem_mask = NULL;\n    char *nodeset = NULL;\n    int empty = -1;\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    size_t i = 0;\n    virBitmapPtr all_nodes;\n    virCgroupPtr cgroup_temp = NULL;\n\n    if (!virNumaIsAvailable() ||\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPUSET))\n        return;\n\n    if (!(all_nodes = virNumaGetHostMemoryNodeset()))\n        goto error;\n\n    if (!(mem_mask = virBitmapFormat(all_nodes)))\n        goto error;\n\n    if ((empty = virCgroupHasEmptyTasks(priv->cgroup,\n                                        VIR_CGROUP_CONTROLLER_CPUSET)) <= 0)\n        goto error;\n\n    if (virCgroupSetCpusetMems(priv->cgroup, mem_mask) < 0)\n        goto error;\n\n    for (i = 0; i < virDomainDefGetVcpusMax(vm->def); i++) {\n        virDomainVcpuDefPtr vcpu = virDomainDefGetVcpu(vm->def, i);\n\n        if (!vcpu->online)\n            continue;\n\n        if (virCgroupNewThread(priv->cgroup, VIR_CGROUP_THREAD_VCPU, i,\n                               false, &cgroup_temp) < 0 ||\n            virCgroupSetCpusetMemoryMigrate(cgroup_temp, true) < 0 ||\n            virCgroupGetCpusetMems(cgroup_temp, &nodeset) < 0 ||\n            virCgroupSetCpusetMems(cgroup_temp, nodeset) < 0)\n            goto cleanup;\n\n        VIR_FREE(nodeset);\n        virCgroupFree(&cgroup_temp);\n    }\n\n    for (i = 0; i < vm->def->niothreadids; i++) {\n        if (virCgroupNewThread(priv->cgroup, VIR_CGROUP_THREAD_IOTHREAD,\n                               vm->def->iothreadids[i]->iothread_id,\n                               false, &cgroup_temp) < 0 ||\n            virCgroupSetCpusetMemoryMigrate(cgroup_temp, true) < 0 ||\n            virCgroupGetCpusetMems(cgroup_temp, &nodeset) < 0 ||\n            virCgroupSetCpusetMems(cgroup_temp, nodeset) < 0)\n            goto cleanup;\n\n        VIR_FREE(nodeset);\n        virCgroupFree(&cgroup_temp);\n    }\n\n    if (virCgroupNewThread(priv->cgroup, VIR_CGROUP_THREAD_EMULATOR, 0,\n                           false, &cgroup_temp) < 0 ||\n        virCgroupSetCpusetMemoryMigrate(cgroup_temp, true) < 0 ||\n        virCgroupGetCpusetMems(cgroup_temp, &nodeset) < 0 ||\n        virCgroupSetCpusetMems(cgroup_temp, nodeset) < 0)\n        goto cleanup;\n\n cleanup:\n    VIR_FREE(mem_mask);\n    VIR_FREE(nodeset);\n    virBitmapFree(all_nodes);\n    virCgroupFree(&cgroup_temp);\n    return;\n\n error:\n    virResetLastError();\n    VIR_DEBUG(\"Couldn't restore cgroups to meaningful state\");\n    goto cleanup;\n}"
  },
  {
    "function_name": "qemuInitCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "920-977",
    "snippet": "static int\nqemuInitCgroup(virDomainObjPtr vm,\n               size_t nnicindexes,\n               int *nicindexes)\n{\n    int ret = -1;\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverConfigPtr cfg = virQEMUDriverGetConfig(priv->driver);\n\n    if (!virQEMUDriverIsPrivileged(priv->driver))\n        goto done;\n\n    if (!virCgroupAvailable())\n        goto done;\n\n    virCgroupFree(&priv->cgroup);\n\n    if (!vm->def->resource) {\n        virDomainResourceDefPtr res;\n\n        if (VIR_ALLOC(res) < 0)\n            goto cleanup;\n\n        res->partition = g_strdup(\"/machine\");\n\n        vm->def->resource = res;\n    }\n\n    if (vm->def->resource->partition[0] != '/') {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Resource partition '%s' must start with '/'\"),\n                       vm->def->resource->partition);\n        goto cleanup;\n    }\n\n    if (virCgroupNewMachine(priv->machineName,\n                            \"qemu\",\n                            vm->def->uuid,\n                            NULL,\n                            vm->pid,\n                            false,\n                            nnicindexes, nicindexes,\n                            vm->def->resource->partition,\n                            cfg->cgroupControllers,\n                            cfg->maxThreadsPerProc,\n                            &priv->cgroup) < 0) {\n        if (virCgroupNewIgnoreError())\n            goto done;\n\n        goto cleanup;\n    }\n\n done:\n    ret = 0;\n cleanup:\n    virObjectUnref(cfg);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 975
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNewIgnoreError",
          "args": [],
          "line": 966
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewIgnoreError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2891-2896",
          "snippet": "bool\nvirCgroupNewIgnoreError(void)\n{\n    VIR_DEBUG(\"No cgroups present/configured/accessible, ignoring error\");\n    return true;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupNewIgnoreError(void)\n{\n    VIR_DEBUG(\"No cgroups present/configured/accessible, ignoring error\");\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNewMachine",
          "args": [
            "priv->machineName",
            "\"qemu\"",
            "vm->def->uuid",
            "NULL",
            "vm->pid",
            "false",
            "nnicindexes",
            "nicindexes",
            "vm->def->resource->partition",
            "cfg->cgroupControllers",
            "cfg->maxThreadsPerProc",
            "&priv->cgroup"
          ],
          "line": 955
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewMachine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2871-2888",
          "snippet": "int\nvirCgroupNewMachine(const char *name G_GNUC_UNUSED,\n                    const char *drivername G_GNUC_UNUSED,\n                    const unsigned char *uuid G_GNUC_UNUSED,\n                    const char *rootdir G_GNUC_UNUSED,\n                    pid_t pidleader G_GNUC_UNUSED,\n                    bool isContainer G_GNUC_UNUSED,\n                    size_t nnicindexes G_GNUC_UNUSED,\n                    int *nicindexes G_GNUC_UNUSED,\n                    const char *partition G_GNUC_UNUSED,\n                    int controllers G_GNUC_UNUSED,\n                    unsigned int maxthreads G_GNUC_UNUSED,\n                    virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewMachine(const char *name G_GNUC_UNUSED,\n                    const char *drivername G_GNUC_UNUSED,\n                    const unsigned char *uuid G_GNUC_UNUSED,\n                    const char *rootdir G_GNUC_UNUSED,\n                    pid_t pidleader G_GNUC_UNUSED,\n                    bool isContainer G_GNUC_UNUSED,\n                    size_t nnicindexes G_GNUC_UNUSED,\n                    int *nicindexes G_GNUC_UNUSED,\n                    const char *partition G_GNUC_UNUSED,\n                    int controllers G_GNUC_UNUSED,\n                    unsigned int maxthreads G_GNUC_UNUSED,\n                    virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Resource partition '%s' must start with '/'\")",
            "vm->def->resource->partition"
          ],
          "line": 949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Resource partition '%s' must start with '/'\""
          ],
          "line": 950
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"/machine\""
          ],
          "line": 943
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "res"
          ],
          "line": 940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "&priv->cgroup"
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupAvailable",
          "args": [],
          "line": 932
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAvailable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2784-2788",
          "snippet": "bool\nvirCgroupAvailable(void)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupAvailable(void)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverIsPrivileged",
          "args": [
            "priv->driver"
          ],
          "line": 929
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverIsPrivileged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1220-1224",
          "snippet": "bool\nvirQEMUDriverIsPrivileged(virQEMUDriverPtr driver)\n{\n    return driver->privileged;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirQEMUDriverIsPrivileged(virQEMUDriverPtr driver)\n{\n    return driver->privileged;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverGetConfig",
          "args": [
            "priv->driver"
          ],
          "line": 927
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1211-1218",
          "snippet": "virQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuInitCgroup(virDomainObjPtr vm,\n               size_t nnicindexes,\n               int *nicindexes)\n{\n    int ret = -1;\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverConfigPtr cfg = virQEMUDriverGetConfig(priv->driver);\n\n    if (!virQEMUDriverIsPrivileged(priv->driver))\n        goto done;\n\n    if (!virCgroupAvailable())\n        goto done;\n\n    virCgroupFree(&priv->cgroup);\n\n    if (!vm->def->resource) {\n        virDomainResourceDefPtr res;\n\n        if (VIR_ALLOC(res) < 0)\n            goto cleanup;\n\n        res->partition = g_strdup(\"/machine\");\n\n        vm->def->resource = res;\n    }\n\n    if (vm->def->resource->partition[0] != '/') {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Resource partition '%s' must start with '/'\"),\n                       vm->def->resource->partition);\n        goto cleanup;\n    }\n\n    if (virCgroupNewMachine(priv->machineName,\n                            \"qemu\",\n                            vm->def->uuid,\n                            NULL,\n                            vm->pid,\n                            false,\n                            nnicindexes, nicindexes,\n                            vm->def->resource->partition,\n                            cfg->cgroupControllers,\n                            cfg->maxThreadsPerProc,\n                            &priv->cgroup) < 0) {\n        if (virCgroupNewIgnoreError())\n            goto done;\n\n        goto cleanup;\n    }\n\n done:\n    ret = 0;\n cleanup:\n    virObjectUnref(cfg);\n    return ret;\n}"
  },
  {
    "function_name": "qemuSetupCpuCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "877-917",
    "snippet": "static int\nqemuSetupCpuCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virObjectEventPtr event = NULL;\n    virTypedParameterPtr eventParams = NULL;\n    int eventNparams = 0;\n    int eventMaxparams = 0;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU)) {\n       if (vm->def->cputune.sharesSpecified) {\n           virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                          _(\"CPU tuning is not available on this host\"));\n           return -1;\n       } else {\n           return 0;\n       }\n    }\n\n    if (vm->def->cputune.sharesSpecified) {\n        unsigned long long val;\n        if (virCgroupSetupCpuShares(priv->cgroup, vm->def->cputune.shares,\n                                    &val) < 0)\n            return -1;\n\n        if (vm->def->cputune.shares != val) {\n            vm->def->cputune.shares = val;\n            if (virTypedParamsAddULLong(&eventParams, &eventNparams,\n                                        &eventMaxparams,\n                                        VIR_DOMAIN_TUNABLE_CPU_CPU_SHARES,\n                                        val) < 0)\n                return -1;\n\n            event = virDomainEventTunableNewFromObj(vm, eventParams, eventNparams);\n        }\n\n        virObjectEventStateQueue(priv->driver->domainEventState, event);\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "priv->driver->domainEventState",
            "event"
          ],
          "line": 913
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainEventTunableNewFromObj",
          "args": [
            "vm",
            "eventParams",
            "eventNparams"
          ],
          "line": 910
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventTunableNewFromObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "1503-1513",
          "snippet": "virObjectEventPtr\nvirDomainEventTunableNewFromObj(virDomainObjPtr obj,\n                                virTypedParameterPtr params,\n                                int nparams)\n{\n    return virDomainEventTunableNew(obj->def->id,\n                                    obj->def->name,\n                                    obj->def->uuid,\n                                    params,\n                                    nparams);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainEventDispose(void *obj);",
            "static void virDomainEventLifecycleDispose(void *obj);",
            "static void virDomainEventRTCChangeDispose(void *obj);",
            "static void virDomainEventWatchdogDispose(void *obj);",
            "static void virDomainEventIOErrorDispose(void *obj);",
            "static void virDomainEventGraphicsDispose(void *obj);",
            "static void virDomainEventBlockJobDispose(void *obj);",
            "static void virDomainEventDiskChangeDispose(void *obj);",
            "static void virDomainEventTrayChangeDispose(void *obj);",
            "static void virDomainEventBalloonChangeDispose(void *obj);",
            "static void virDomainEventDeviceRemovedDispose(void *obj);",
            "static void virDomainEventPMDispose(void *obj);",
            "static void virDomainQemuMonitorEventDispose(void *obj);",
            "static void virDomainEventTunableDispose(void *obj);",
            "static void virDomainEventAgentLifecycleDispose(void *obj);",
            "static void virDomainEventDeviceAddedDispose(void *obj);",
            "static void virDomainEventMigrationIterationDispose(void *obj);",
            "static void virDomainEventJobCompletedDispose(void *obj);",
            "static void virDomainEventDeviceRemovalFailedDispose(void *obj);",
            "static void virDomainEventMetadataChangeDispose(void *obj);",
            "static void virDomainEventBlockThresholdDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virDomainEventDispose(void *obj);\nstatic void virDomainEventLifecycleDispose(void *obj);\nstatic void virDomainEventRTCChangeDispose(void *obj);\nstatic void virDomainEventWatchdogDispose(void *obj);\nstatic void virDomainEventIOErrorDispose(void *obj);\nstatic void virDomainEventGraphicsDispose(void *obj);\nstatic void virDomainEventBlockJobDispose(void *obj);\nstatic void virDomainEventDiskChangeDispose(void *obj);\nstatic void virDomainEventTrayChangeDispose(void *obj);\nstatic void virDomainEventBalloonChangeDispose(void *obj);\nstatic void virDomainEventDeviceRemovedDispose(void *obj);\nstatic void virDomainEventPMDispose(void *obj);\nstatic void virDomainQemuMonitorEventDispose(void *obj);\nstatic void virDomainEventTunableDispose(void *obj);\nstatic void virDomainEventAgentLifecycleDispose(void *obj);\nstatic void virDomainEventDeviceAddedDispose(void *obj);\nstatic void virDomainEventMigrationIterationDispose(void *obj);\nstatic void virDomainEventJobCompletedDispose(void *obj);\nstatic void virDomainEventDeviceRemovalFailedDispose(void *obj);\nstatic void virDomainEventMetadataChangeDispose(void *obj);\nstatic void virDomainEventBlockThresholdDispose(void *obj);\n\nvirObjectEventPtr\nvirDomainEventTunableNewFromObj(virDomainObjPtr obj,\n                                virTypedParameterPtr params,\n                                int nparams)\n{\n    return virDomainEventTunableNew(obj->def->id,\n                                    obj->def->name,\n                                    obj->def->uuid,\n                                    params,\n                                    nparams);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsAddULLong",
          "args": [
            "&eventParams",
            "&eventNparams",
            "&eventMaxparams",
            "VIR_DOMAIN_TUNABLE_CPU_CPU_SHARES",
            "val"
          ],
          "line": 904
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "578-604",
          "snippet": "int\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetupCpuShares",
          "args": [
            "priv->cgroup",
            "vm->def->cputune.shares",
            "&val"
          ],
          "line": 898
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupCpuShares",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3692-3703",
          "snippet": "int\nvirCgroupSetupCpuShares(virCgroupPtr cgroup, unsigned long long shares,\n                        unsigned long long *realValue)\n{\n    if (virCgroupSetCpuShares(cgroup, shares) < 0)\n        return -1;\n\n    if (virCgroupGetCpuShares(cgroup, realValue) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupCpuShares(virCgroupPtr cgroup, unsigned long long shares,\n                        unsigned long long *realValue)\n{\n    if (virCgroupSetCpuShares(cgroup, shares) < 0)\n        return -1;\n\n    if (virCgroupGetCpuShares(cgroup, realValue) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"CPU tuning is not available on this host\")"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"CPU tuning is not available on this host\""
          ],
          "line": 889
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_CPU"
          ],
          "line": 886
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupCpuCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virObjectEventPtr event = NULL;\n    virTypedParameterPtr eventParams = NULL;\n    int eventNparams = 0;\n    int eventMaxparams = 0;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU)) {\n       if (vm->def->cputune.sharesSpecified) {\n           virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                          _(\"CPU tuning is not available on this host\"));\n           return -1;\n       } else {\n           return 0;\n       }\n    }\n\n    if (vm->def->cputune.sharesSpecified) {\n        unsigned long long val;\n        if (virCgroupSetupCpuShares(priv->cgroup, vm->def->cputune.shares,\n                                    &val) < 0)\n            return -1;\n\n        if (vm->def->cputune.shares != val) {\n            vm->def->cputune.shares = val;\n            if (virTypedParamsAddULLong(&eventParams, &eventNparams,\n                                        &eventMaxparams,\n                                        VIR_DOMAIN_TUNABLE_CPU_CPU_SHARES,\n                                        val) < 0)\n                return -1;\n\n            event = virDomainEventTunableNewFromObj(vm, eventParams, eventNparams);\n        }\n\n        virObjectEventStateQueue(priv->driver->domainEventState, event);\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuSetupCpusetCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "862-874",
    "snippet": "static int\nqemuSetupCpusetCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPUSET))\n        return 0;\n\n    if (virCgroupSetCpusetMemoryMigrate(priv->cgroup, true) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetCpusetMemoryMigrate",
          "args": [
            "priv->cgroup",
            "true"
          ],
          "line": 870
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetCpusetMemoryMigrate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3221-3228",
          "snippet": "int\nvirCgroupSetCpusetMemoryMigrate(virCgroupPtr group G_GNUC_UNUSED,\n                                bool migrate G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpusetMemoryMigrate(virCgroupPtr group G_GNUC_UNUSED,\n                                bool migrate G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_CPUSET"
          ],
          "line": 867
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupCpusetCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPUSET))\n        return 0;\n\n    if (virCgroupSetCpusetMemoryMigrate(priv->cgroup, true) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuSetupDevicesCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "738-859",
    "snippet": "static int\nqemuSetupDevicesCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverConfigPtr cfg = NULL;\n    const char *const *deviceACL = NULL;\n    int rv = -1;\n    int ret = -1;\n    size_t i;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    rv = virCgroupDenyAllDevices(priv->cgroup);\n    virDomainAuditCgroup(vm, priv->cgroup, \"deny\", \"all\", rv == 0);\n    if (rv < 0) {\n        if (virLastErrorIsSystemErrno(EPERM)) {\n            virResetLastError();\n            VIR_WARN(\"Group devices ACL is not accessible, disabling whitelisting\");\n            return 0;\n        }\n\n        goto cleanup;\n    }\n\n    if (qemuSetupFirmwareCgroup(vm) < 0)\n        goto cleanup;\n\n    for (i = 0; i < vm->def->ndisks; i++) {\n        if (qemuSetupImageChainCgroup(vm, vm->def->disks[i]->src) < 0)\n            goto cleanup;\n    }\n\n    rv = virCgroupAllowDevice(priv->cgroup, 'c', DEVICE_PTY_MAJOR, -1,\n                              VIR_CGROUP_DEVICE_RW);\n    virDomainAuditCgroupMajor(vm, priv->cgroup, \"allow\", DEVICE_PTY_MAJOR,\n                              \"pty\", \"rw\", rv == 0);\n    if (rv < 0)\n        goto cleanup;\n\n    cfg = virQEMUDriverGetConfig(priv->driver);\n    deviceACL = cfg->cgroupDeviceACL ?\n                (const char *const *)cfg->cgroupDeviceACL :\n                defaultDeviceACL;\n\n    if (vm->def->nsounds &&\n        ((!vm->def->ngraphics && cfg->nogfxAllowHostAudio) ||\n         (vm->def->graphics &&\n          ((vm->def->graphics[0]->type == VIR_DOMAIN_GRAPHICS_TYPE_VNC &&\n           cfg->vncAllowHostAudio) ||\n           (vm->def->graphics[0]->type == VIR_DOMAIN_GRAPHICS_TYPE_SDL))))) {\n        rv = virCgroupAllowDevice(priv->cgroup, 'c', DEVICE_SND_MAJOR, -1,\n                                  VIR_CGROUP_DEVICE_RW);\n        virDomainAuditCgroupMajor(vm, priv->cgroup, \"allow\", DEVICE_SND_MAJOR,\n                                  \"sound\", \"rw\", rv == 0);\n        if (rv < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; deviceACL[i] != NULL; i++) {\n        if (!virFileExists(deviceACL[i])) {\n            VIR_DEBUG(\"Ignoring non-existent device %s\", deviceACL[i]);\n            continue;\n        }\n\n        rv = virCgroupAllowDevicePath(priv->cgroup, deviceACL[i],\n                                      VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", deviceACL[i], \"rw\", rv);\n        if (rv < 0 &&\n            !virLastErrorIsSystemErrno(ENOENT))\n            goto cleanup;\n    }\n\n    if (virDomainChrDefForeach(vm->def,\n                               true,\n                               qemuSetupChardevCgroupCB,\n                               vm) < 0)\n        goto cleanup;\n\n    if (vm->def->tpm && qemuSetupTPMCgroup(vm) < 0)\n        goto cleanup;\n\n    for (i = 0; i < vm->def->nhostdevs; i++) {\n        /* This may allow /dev/vfio/vfio multiple times, but that\n         * is not a problem. Kernel will have only one record. */\n        if (qemuSetupHostdevCgroup(vm, vm->def->hostdevs[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->nmems; i++) {\n        if (qemuSetupMemoryDevicesCgroup(vm, vm->def->mems[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->ngraphics; i++) {\n        if (qemuSetupGraphicsCgroup(vm, vm->def->graphics[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->nvideos; i++) {\n        if (qemuSetupVideoCgroup(vm, vm->def->videos[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->ninputs; i++) {\n        if (qemuSetupInputCgroup(vm, vm->def->inputs[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->nrngs; i++) {\n        if (qemuSetupRNGCgroup(vm, vm->def->rngs[i]) < 0)\n            goto cleanup;\n    }\n\n    if (vm->def->sev && qemuSetupSEVCgroup(vm) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virObjectUnref(cfg);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define DEVICE_SND_MAJOR 116",
      "#define DEVICE_PTY_MAJOR 136"
    ],
    "globals_used": [
      "const char *const defaultDeviceACL[] = {\n    \"/dev/null\", \"/dev/full\", \"/dev/zero\",\n    \"/dev/random\", \"/dev/urandom\",\n    \"/dev/ptmx\", \"/dev/kvm\",\n    \"/dev/rtc\", \"/dev/hpet\",\n    NULL,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSetupSEVCgroup",
          "args": [
            "vm"
          ],
          "line": 852
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupSEVCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "722-736",
          "snippet": "static int\nqemuSetupSEVCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, \"/dev/sev\",\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", \"/dev/sev\",\n                             \"rw\", ret);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupSEVCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, \"/dev/sev\",\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", \"/dev/sev\",\n                             \"rw\", ret);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSetupRNGCgroup",
          "args": [
            "vm",
            "vm->def->rngs[i]"
          ],
          "line": 848
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupRNGCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "652-676",
          "snippet": "int\nqemuSetupRNGCgroup(virDomainObjPtr vm,\n                   virDomainRNGDefPtr rng)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int rv;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (rng->backend == VIR_DOMAIN_RNG_BACKEND_RANDOM) {\n        VIR_DEBUG(\"Setting Cgroup ACL for RNG device\");\n        rv = virCgroupAllowDevicePath(priv->cgroup,\n                                      rng->source.file,\n                                      VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                                 rng->source.file,\n                                 \"rw\", rv);\n        if (rv < 0 &&\n            !virLastErrorIsSystemErrno(ENOENT))\n            return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupRNGCgroup(virDomainObjPtr vm,\n                   virDomainRNGDefPtr rng)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int rv;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (rng->backend == VIR_DOMAIN_RNG_BACKEND_RANDOM) {\n        VIR_DEBUG(\"Setting Cgroup ACL for RNG device\");\n        rv = virCgroupAllowDevicePath(priv->cgroup,\n                                      rng->source.file,\n                                      VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                                 rng->source.file,\n                                 \"rw\", rv);\n        if (rv < 0 &&\n            !virLastErrorIsSystemErrno(ENOENT))\n            return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSetupInputCgroup",
          "args": [
            "vm",
            "vm->def->inputs[i]"
          ],
          "line": 843
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupInputCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "360-380",
          "snippet": "int\nqemuSetupInputCgroup(virDomainObjPtr vm,\n                     virDomainInputDefPtr dev)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret = 0;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_INPUT_TYPE_PASSTHROUGH:\n        VIR_DEBUG(\"Process path '%s' for input device\", dev->source.evdev);\n        ret = virCgroupAllowDevicePath(priv->cgroup, dev->source.evdev,\n                                       VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", dev->source.evdev, \"rw\", ret);\n        break;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupInputCgroup(virDomainObjPtr vm,\n                     virDomainInputDefPtr dev)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret = 0;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_INPUT_TYPE_PASSTHROUGH:\n        VIR_DEBUG(\"Process path '%s' for input device\", dev->source.evdev);\n        ret = virCgroupAllowDevicePath(priv->cgroup, dev->source.evdev,\n                                       VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", dev->source.evdev, \"rw\", ret);\n        break;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSetupVideoCgroup",
          "args": [
            "vm",
            "vm->def->videos[i]"
          ],
          "line": 838
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupVideoCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "569-589",
          "snippet": "static int\nqemuSetupVideoCgroup(virDomainObjPtr vm,\n                     virDomainVideoDefPtr def)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virDomainVideoAccelDefPtr accel = def->accel;\n    int ret;\n\n    if (!accel)\n        return 0;\n\n    if (!accel->rendernode ||\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, accel->rendernode,\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", accel->rendernode,\n                             \"rw\", ret);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupVideoCgroup(virDomainObjPtr vm,\n                     virDomainVideoDefPtr def)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virDomainVideoAccelDefPtr accel = def->accel;\n    int ret;\n\n    if (!accel)\n        return 0;\n\n    if (!accel->rendernode ||\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, accel->rendernode,\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", accel->rendernode,\n                             \"rw\", ret);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSetupGraphicsCgroup",
          "args": [
            "vm",
            "vm->def->graphics[i]"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupGraphicsCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "549-566",
          "snippet": "static int\nqemuSetupGraphicsCgroup(virDomainObjPtr vm,\n                        virDomainGraphicsDefPtr gfx)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    const char *rendernode = virDomainGraphicsGetRenderNode(gfx);\n    int ret;\n\n    if (!rendernode ||\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, rendernode,\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", rendernode,\n                             \"rw\", ret);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupGraphicsCgroup(virDomainObjPtr vm,\n                        virDomainGraphicsDefPtr gfx)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    const char *rendernode = virDomainGraphicsGetRenderNode(gfx);\n    int ret;\n\n    if (!rendernode ||\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, rendernode,\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", rendernode,\n                             \"rw\", ret);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSetupMemoryDevicesCgroup",
          "args": [
            "vm",
            "vm->def->mems[i]"
          ],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupMemoryDevicesCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "505-525",
          "snippet": "int\nqemuSetupMemoryDevicesCgroup(virDomainObjPtr vm,\n                             virDomainMemoryDefPtr mem)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int rv;\n\n    if (mem->model != VIR_DOMAIN_MEMORY_MODEL_NVDIMM)\n        return 0;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    VIR_DEBUG(\"Setting devices Cgroup for NVDIMM device: %s\", mem->nvdimmPath);\n    rv = virCgroupAllowDevicePath(priv->cgroup, mem->nvdimmPath,\n                                  VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                             mem->nvdimmPath, \"rw\", rv);\n\n    return rv;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupMemoryDevicesCgroup(virDomainObjPtr vm,\n                             virDomainMemoryDefPtr mem)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int rv;\n\n    if (mem->model != VIR_DOMAIN_MEMORY_MODEL_NVDIMM)\n        return 0;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    VIR_DEBUG(\"Setting devices Cgroup for NVDIMM device: %s\", mem->nvdimmPath);\n    rv = virCgroupAllowDevicePath(priv->cgroup, mem->nvdimmPath,\n                                  VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                             mem->nvdimmPath, \"rw\", rv);\n\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSetupHostdevCgroup",
          "args": [
            "vm",
            "vm->def->hostdevs[i]"
          ],
          "line": 823
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupHostdevCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "416-452",
          "snippet": "int\nqemuSetupHostdevCgroup(virDomainObjPtr vm,\n                       virDomainHostdevDefPtr dev)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    g_autofree char *path = NULL;\n    int perms;\n    int rv;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (qemuDomainGetHostdevPath(dev, &path, &perms) < 0)\n        return -1;\n\n    if (path) {\n        VIR_DEBUG(\"Cgroup allow %s perms=%d\", path, perms);\n        rv = virCgroupAllowDevicePath(priv->cgroup, path, perms, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", path,\n                                 virCgroupGetDevicePermsString(perms),\n                                 rv);\n        if (rv < 0)\n            return -1;\n    }\n\n    if (qemuHostdevNeedsVFIO(dev)) {\n        VIR_DEBUG(\"Cgroup allow %s perms=%d\", QEMU_DEV_VFIO, VIR_CGROUP_DEVICE_RW);\n        rv = virCgroupAllowDevicePath(priv->cgroup, QEMU_DEV_VFIO,\n                                      VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                                 QEMU_DEV_VFIO, \"rw\", rv);\n        if (rv < 0)\n            return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupHostdevCgroup(virDomainObjPtr vm,\n                       virDomainHostdevDefPtr dev)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    g_autofree char *path = NULL;\n    int perms;\n    int rv;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (qemuDomainGetHostdevPath(dev, &path, &perms) < 0)\n        return -1;\n\n    if (path) {\n        VIR_DEBUG(\"Cgroup allow %s perms=%d\", path, perms);\n        rv = virCgroupAllowDevicePath(priv->cgroup, path, perms, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", path,\n                                 virCgroupGetDevicePermsString(perms),\n                                 rv);\n        if (rv < 0)\n            return -1;\n    }\n\n    if (qemuHostdevNeedsVFIO(dev)) {\n        VIR_DEBUG(\"Cgroup allow %s perms=%d\", QEMU_DEV_VFIO, VIR_CGROUP_DEVICE_RW);\n        rv = virCgroupAllowDevicePath(priv->cgroup, QEMU_DEV_VFIO,\n                                      VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                                 QEMU_DEV_VFIO, \"rw\", rv);\n        if (rv < 0)\n            return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSetupTPMCgroup",
          "args": [
            "vm"
          ],
          "line": 817
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupTPMCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "341-357",
          "snippet": "static int\nqemuSetupTPMCgroup(virDomainObjPtr vm)\n{\n    int ret = 0;\n    virDomainTPMDefPtr dev = vm->def->tpm;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_TPM_TYPE_PASSTHROUGH:\n        ret = qemuSetupChrSourceCgroup(vm, &dev->data.passthrough.source);\n        break;\n    case VIR_DOMAIN_TPM_TYPE_EMULATOR:\n    case VIR_DOMAIN_TPM_TYPE_LAST:\n        break;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupTPMCgroup(virDomainObjPtr vm)\n{\n    int ret = 0;\n    virDomainTPMDefPtr dev = vm->def->tpm;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_TPM_TYPE_PASSTHROUGH:\n        ret = qemuSetupChrSourceCgroup(vm, &dev->data.passthrough.source);\n        break;\n    case VIR_DOMAIN_TPM_TYPE_EMULATOR:\n    case VIR_DOMAIN_TPM_TYPE_LAST:\n        break;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainChrDefForeach",
          "args": [
            "vm->def",
            "true",
            "qemuSetupChardevCgroupCB",
            "vm"
          ],
          "line": 811
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainChrDefForeach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29835-29886",
          "snippet": "int\nvirDomainChrDefForeach(virDomainDefPtr def,\n                       bool abortOnError,\n                       virDomainChrDefIterator iter,\n                       void *opaque)\n{\n    size_t i;\n    int rc = 0;\n\n    for (i = 0; i < def->nserials; i++) {\n        if ((iter)(def,\n                   def->serials[i],\n                   opaque) < 0)\n            rc = -1;\n\n        if (abortOnError && rc != 0)\n            return rc;\n    }\n\n    for (i = 0; i < def->nparallels; i++) {\n        if ((iter)(def,\n                   def->parallels[i],\n                   opaque) < 0)\n            rc = -1;\n\n        if (abortOnError && rc != 0)\n            return rc;\n    }\n\n    for (i = 0; i < def->nchannels; i++) {\n        if ((iter)(def,\n                   def->channels[i],\n                   opaque) < 0)\n            rc = -1;\n\n        if (abortOnError && rc != 0)\n            return rc;\n    }\n    for (i = 0; i < def->nconsoles; i++) {\n        if (virDomainSkipBackcompatConsole(def, i, false))\n            continue;\n        if ((iter)(def,\n                   def->consoles[i],\n                   opaque) < 0)\n            rc = -1;\n\n        if (abortOnError && rc != 0)\n            return rc;\n    }\n\n    return rc;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainChrDefForeach(virDomainDefPtr def,\n                       bool abortOnError,\n                       virDomainChrDefIterator iter,\n                       void *opaque)\n{\n    size_t i;\n    int rc = 0;\n\n    for (i = 0; i < def->nserials; i++) {\n        if ((iter)(def,\n                   def->serials[i],\n                   opaque) < 0)\n            rc = -1;\n\n        if (abortOnError && rc != 0)\n            return rc;\n    }\n\n    for (i = 0; i < def->nparallels; i++) {\n        if ((iter)(def,\n                   def->parallels[i],\n                   opaque) < 0)\n            rc = -1;\n\n        if (abortOnError && rc != 0)\n            return rc;\n    }\n\n    for (i = 0; i < def->nchannels; i++) {\n        if ((iter)(def,\n                   def->channels[i],\n                   opaque) < 0)\n            rc = -1;\n\n        if (abortOnError && rc != 0)\n            return rc;\n    }\n    for (i = 0; i < def->nconsoles; i++) {\n        if (virDomainSkipBackcompatConsole(def, i, false))\n            continue;\n        if ((iter)(def,\n                   def->consoles[i],\n                   opaque) < 0)\n            rc = -1;\n\n        if (abortOnError && rc != 0)\n            return rc;\n    }\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLastErrorIsSystemErrno",
          "args": [
            "ENOENT"
          ],
          "line": 807
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorIsSystemErrno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1432-1442",
          "snippet": "bool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nbool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditCgroupPath",
          "args": [
            "vm",
            "priv->cgroup",
            "\"allow\"",
            "deviceACL[i]",
            "\"rw\"",
            "rv"
          ],
          "line": 805
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroupPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "658-687",
          "snippet": "void\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupAllowDevicePath",
          "args": [
            "priv->cgroup",
            "deviceACL[i]",
            "VIR_CGROUP_DEVICE_RW",
            "false"
          ],
          "line": 803
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3291-3300",
          "snippet": "int\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Ignoring non-existent device %s\"",
            "deviceACL[i]"
          ],
          "line": 799
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "deviceACL[i]"
          ],
          "line": 798
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditCgroupMajor",
          "args": [
            "vm",
            "priv->cgroup",
            "\"allow\"",
            "DEVICE_SND_MAJOR",
            "\"sound\"",
            "\"rw\"",
            "rv == 0"
          ],
          "line": 791
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroupMajor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "631-644",
          "snippet": "void\nvirDomainAuditCgroupMajor(virDomainObjPtr vm, virCgroupPtr cgroup,\n                          const char *reason, int maj, const char *name,\n                          const char *perms, bool success)\n{\n    char *extra;\n\n    extra = g_strdup_printf(\"major category=%s maj=%02X acl=%s\",\n                            name, maj, perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, success);\n\n    VIR_FREE(extra);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupMajor(virDomainObjPtr vm, virCgroupPtr cgroup,\n                          const char *reason, int maj, const char *name,\n                          const char *perms, bool success)\n{\n    char *extra;\n\n    extra = g_strdup_printf(\"major category=%s maj=%02X acl=%s\",\n                            name, maj, perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, success);\n\n    VIR_FREE(extra);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupAllowDevice",
          "args": [
            "priv->cgroup",
            "'c'",
            "DEVICE_SND_MAJOR",
            "-1",
            "VIR_CGROUP_DEVICE_RW"
          ],
          "line": 789
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3278-3288",
          "snippet": "int\nvirCgroupAllowDevice(virCgroupPtr group G_GNUC_UNUSED,\n                     char type G_GNUC_UNUSED,\n                     int major G_GNUC_UNUSED,\n                     int minor G_GNUC_UNUSED,\n                     int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevice(virCgroupPtr group G_GNUC_UNUSED,\n                     char type G_GNUC_UNUSED,\n                     int major G_GNUC_UNUSED,\n                     int minor G_GNUC_UNUSED,\n                     int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverGetConfig",
          "args": [
            "priv->driver"
          ],
          "line": 778
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1211-1218",
          "snippet": "virQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSetupImageChainCgroup",
          "args": [
            "vm",
            "vm->def->disks[i]->src"
          ],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupImageChainCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "248-264",
          "snippet": "int\nqemuSetupImageChainCgroup(virDomainObjPtr vm,\n                          virStorageSourcePtr src)\n{\n    virStorageSourcePtr next;\n    bool forceReadonly = false;\n\n    for (next = src; virStorageSourceIsBacking(next); next = next->backingStore) {\n        if (qemuSetupImageCgroupInternal(vm, next, forceReadonly) < 0)\n            return -1;\n\n        /* setup only the top level image for read-write */\n        forceReadonly = true;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupImageChainCgroup(virDomainObjPtr vm,\n                          virStorageSourcePtr src)\n{\n    virStorageSourcePtr next;\n    bool forceReadonly = false;\n\n    for (next = src; virStorageSourceIsBacking(next); next = next->backingStore) {\n        if (qemuSetupImageCgroupInternal(vm, next, forceReadonly) < 0)\n            return -1;\n\n        /* setup only the top level image for read-write */\n        forceReadonly = true;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSetupFirmwareCgroup",
          "args": [
            "vm"
          ],
          "line": 763
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupFirmwareCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "633-649",
          "snippet": "static int\nqemuSetupFirmwareCgroup(virDomainObjPtr vm)\n{\n    if (!vm->def->os.loader)\n        return 0;\n\n    if (vm->def->os.loader->path &&\n        qemuSetupImagePathCgroup(vm, vm->def->os.loader->path,\n                                 vm->def->os.loader->readonly == VIR_TRISTATE_BOOL_YES) < 0)\n        return -1;\n\n    if (vm->def->os.loader->nvram &&\n        qemuSetupImagePathCgroup(vm, vm->def->os.loader->nvram, false) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupFirmwareCgroup(virDomainObjPtr vm)\n{\n    if (!vm->def->os.loader)\n        return 0;\n\n    if (vm->def->os.loader->path &&\n        qemuSetupImagePathCgroup(vm, vm->def->os.loader->path,\n                                 vm->def->os.loader->readonly == VIR_TRISTATE_BOOL_YES) < 0)\n        return -1;\n\n    if (vm->def->os.loader->nvram &&\n        qemuSetupImagePathCgroup(vm, vm->def->os.loader->nvram, false) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Group devices ACL is not accessible, disabling whitelisting\""
          ],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 755
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditCgroup",
          "args": [
            "vm",
            "priv->cgroup",
            "\"deny\"",
            "\"all\"",
            "rv == 0"
          ],
          "line": 752
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "588-617",
          "snippet": "void\nvirDomainAuditCgroup(virDomainObjPtr vm, virCgroupPtr cgroup,\n                     const char *reason, const char *extra, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *controller = NULL;\n    char *detail;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    ignore_value(virCgroupPathOfController(cgroup,\n                                           VIR_CGROUP_CONTROLLER_DEVICES,\n                                           NULL, &controller));\n    detail = virAuditEncode(\"cgroup\", VIR_AUDIT_STR(controller));\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=cgroup reason=%s %s uuid=%s %s class=%s\",\n              virt, reason, vmname, uuidstr,\n              detail ? detail : \"cgroup=?\", extra);\n\n    VIR_FREE(vmname);\n    VIR_FREE(controller);\n    VIR_FREE(detail);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroup(virDomainObjPtr vm, virCgroupPtr cgroup,\n                     const char *reason, const char *extra, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *controller = NULL;\n    char *detail;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    ignore_value(virCgroupPathOfController(cgroup,\n                                           VIR_CGROUP_CONTROLLER_DEVICES,\n                                           NULL, &controller));\n    detail = virAuditEncode(\"cgroup\", VIR_AUDIT_STR(controller));\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=cgroup reason=%s %s uuid=%s %s class=%s\",\n              virt, reason, vmname, uuidstr,\n              detail ? detail : \"cgroup=?\", extra);\n\n    VIR_FREE(vmname);\n    VIR_FREE(controller);\n    VIR_FREE(detail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupDenyAllDevices",
          "args": [
            "priv->cgroup"
          ],
          "line": 751
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDenyAllDevices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3269-3275",
          "snippet": "int\nvirCgroupDenyAllDevices(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyAllDevices(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 748
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\n#define DEVICE_SND_MAJOR 116\n#define DEVICE_PTY_MAJOR 136\n\nconst char *const defaultDeviceACL[] = {\n    \"/dev/null\", \"/dev/full\", \"/dev/zero\",\n    \"/dev/random\", \"/dev/urandom\",\n    \"/dev/ptmx\", \"/dev/kvm\",\n    \"/dev/rtc\", \"/dev/hpet\",\n    NULL,\n};\n\nstatic int\nqemuSetupDevicesCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virQEMUDriverConfigPtr cfg = NULL;\n    const char *const *deviceACL = NULL;\n    int rv = -1;\n    int ret = -1;\n    size_t i;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    rv = virCgroupDenyAllDevices(priv->cgroup);\n    virDomainAuditCgroup(vm, priv->cgroup, \"deny\", \"all\", rv == 0);\n    if (rv < 0) {\n        if (virLastErrorIsSystemErrno(EPERM)) {\n            virResetLastError();\n            VIR_WARN(\"Group devices ACL is not accessible, disabling whitelisting\");\n            return 0;\n        }\n\n        goto cleanup;\n    }\n\n    if (qemuSetupFirmwareCgroup(vm) < 0)\n        goto cleanup;\n\n    for (i = 0; i < vm->def->ndisks; i++) {\n        if (qemuSetupImageChainCgroup(vm, vm->def->disks[i]->src) < 0)\n            goto cleanup;\n    }\n\n    rv = virCgroupAllowDevice(priv->cgroup, 'c', DEVICE_PTY_MAJOR, -1,\n                              VIR_CGROUP_DEVICE_RW);\n    virDomainAuditCgroupMajor(vm, priv->cgroup, \"allow\", DEVICE_PTY_MAJOR,\n                              \"pty\", \"rw\", rv == 0);\n    if (rv < 0)\n        goto cleanup;\n\n    cfg = virQEMUDriverGetConfig(priv->driver);\n    deviceACL = cfg->cgroupDeviceACL ?\n                (const char *const *)cfg->cgroupDeviceACL :\n                defaultDeviceACL;\n\n    if (vm->def->nsounds &&\n        ((!vm->def->ngraphics && cfg->nogfxAllowHostAudio) ||\n         (vm->def->graphics &&\n          ((vm->def->graphics[0]->type == VIR_DOMAIN_GRAPHICS_TYPE_VNC &&\n           cfg->vncAllowHostAudio) ||\n           (vm->def->graphics[0]->type == VIR_DOMAIN_GRAPHICS_TYPE_SDL))))) {\n        rv = virCgroupAllowDevice(priv->cgroup, 'c', DEVICE_SND_MAJOR, -1,\n                                  VIR_CGROUP_DEVICE_RW);\n        virDomainAuditCgroupMajor(vm, priv->cgroup, \"allow\", DEVICE_SND_MAJOR,\n                                  \"sound\", \"rw\", rv == 0);\n        if (rv < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; deviceACL[i] != NULL; i++) {\n        if (!virFileExists(deviceACL[i])) {\n            VIR_DEBUG(\"Ignoring non-existent device %s\", deviceACL[i]);\n            continue;\n        }\n\n        rv = virCgroupAllowDevicePath(priv->cgroup, deviceACL[i],\n                                      VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", deviceACL[i], \"rw\", rv);\n        if (rv < 0 &&\n            !virLastErrorIsSystemErrno(ENOENT))\n            goto cleanup;\n    }\n\n    if (virDomainChrDefForeach(vm->def,\n                               true,\n                               qemuSetupChardevCgroupCB,\n                               vm) < 0)\n        goto cleanup;\n\n    if (vm->def->tpm && qemuSetupTPMCgroup(vm) < 0)\n        goto cleanup;\n\n    for (i = 0; i < vm->def->nhostdevs; i++) {\n        /* This may allow /dev/vfio/vfio multiple times, but that\n         * is not a problem. Kernel will have only one record. */\n        if (qemuSetupHostdevCgroup(vm, vm->def->hostdevs[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->nmems; i++) {\n        if (qemuSetupMemoryDevicesCgroup(vm, vm->def->mems[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->ngraphics; i++) {\n        if (qemuSetupGraphicsCgroup(vm, vm->def->graphics[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->nvideos; i++) {\n        if (qemuSetupVideoCgroup(vm, vm->def->videos[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->ninputs; i++) {\n        if (qemuSetupInputCgroup(vm, vm->def->inputs[i]) < 0)\n            goto cleanup;\n    }\n\n    for (i = 0; i < vm->def->nrngs; i++) {\n        if (qemuSetupRNGCgroup(vm, vm->def->rngs[i]) < 0)\n            goto cleanup;\n    }\n\n    if (vm->def->sev && qemuSetupSEVCgroup(vm) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virObjectUnref(cfg);\n    return ret;\n}"
  },
  {
    "function_name": "qemuSetupSEVCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "722-736",
    "snippet": "static int\nqemuSetupSEVCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, \"/dev/sev\",\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", \"/dev/sev\",\n                             \"rw\", ret);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditCgroupPath",
          "args": [
            "vm",
            "priv->cgroup",
            "\"allow\"",
            "\"/dev/sev\"",
            "\"rw\"",
            "ret"
          ],
          "line": 733
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroupPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "658-687",
          "snippet": "void\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupAllowDevicePath",
          "args": [
            "priv->cgroup",
            "\"/dev/sev\"",
            "VIR_CGROUP_DEVICE_RW",
            "false"
          ],
          "line": 731
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3291-3300",
          "snippet": "int\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 728
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupSEVCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, \"/dev/sev\",\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", \"/dev/sev\",\n                             \"rw\", ret);\n    return ret;\n}"
  },
  {
    "function_name": "qemuTeardownChardevCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "714-719",
    "snippet": "int\nqemuTeardownChardevCgroup(virDomainObjPtr vm,\n                          virDomainChrDefPtr dev)\n{\n    return qemuTeardownChrSourceCgroup(vm, dev->source);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuTeardownChrSourceCgroup",
          "args": [
            "vm",
            "dev->source"
          ],
          "line": 718
        },
        "resolved": true,
        "details": {
          "function_name": "qemuTeardownChrSourceCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "306-327",
          "snippet": "static int\nqemuTeardownChrSourceCgroup(virDomainObjPtr vm,\n                            virDomainChrSourceDefPtr source)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (source->type != VIR_DOMAIN_CHR_TYPE_DEV)\n        return 0;\n\n    VIR_DEBUG(\"Process path '%s' for device\", source->data.file.path);\n\n    ret = virCgroupDenyDevicePath(priv->cgroup, source->data.file.path,\n                                  VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\",\n                             source->data.file.path, \"rw\", ret);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuTeardownChrSourceCgroup(virDomainObjPtr vm,\n                            virDomainChrSourceDefPtr source)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (source->type != VIR_DOMAIN_CHR_TYPE_DEV)\n        return 0;\n\n    VIR_DEBUG(\"Process path '%s' for device\", source->data.file.path);\n\n    ret = virCgroupDenyDevicePath(priv->cgroup, source->data.file.path,\n                                  VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\",\n                             source->data.file.path, \"rw\", ret);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuTeardownChardevCgroup(virDomainObjPtr vm,\n                          virDomainChrDefPtr dev)\n{\n    return qemuTeardownChrSourceCgroup(vm, dev->source);\n}"
  },
  {
    "function_name": "qemuSetupChardevCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "706-711",
    "snippet": "int\nqemuSetupChardevCgroup(virDomainObjPtr vm,\n                       virDomainChrDefPtr dev)\n{\n    return qemuSetupChrSourceCgroup(vm, dev->source);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuSetupChrSourceCgroup",
          "args": [
            "vm",
            "dev->source"
          ],
          "line": 710
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupChrSourceCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "282-303",
          "snippet": "static int\nqemuSetupChrSourceCgroup(virDomainObjPtr vm,\n                         virDomainChrSourceDefPtr source)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (source->type != VIR_DOMAIN_CHR_TYPE_DEV)\n        return 0;\n\n    VIR_DEBUG(\"Process path '%s' for device\", source->data.file.path);\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, source->data.file.path,\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                             source->data.file.path, \"rw\", ret);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupChrSourceCgroup(virDomainObjPtr vm,\n                         virDomainChrSourceDefPtr source)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (source->type != VIR_DOMAIN_CHR_TYPE_DEV)\n        return 0;\n\n    VIR_DEBUG(\"Process path '%s' for device\", source->data.file.path);\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, source->data.file.path,\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                             source->data.file.path, \"rw\", ret);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupChardevCgroup(virDomainObjPtr vm,\n                       virDomainChrDefPtr dev)\n{\n    return qemuSetupChrSourceCgroup(vm, dev->source);\n}"
  },
  {
    "function_name": "qemuTeardownRNGCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "679-703",
    "snippet": "int\nqemuTeardownRNGCgroup(virDomainObjPtr vm,\n                      virDomainRNGDefPtr rng)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int rv;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (rng->backend == VIR_DOMAIN_RNG_BACKEND_RANDOM) {\n        VIR_DEBUG(\"Tearing down Cgroup ACL for RNG device\");\n        rv = virCgroupDenyDevicePath(priv->cgroup,\n                                     rng->source.file,\n                                     VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\",\n                                 rng->source.file,\n                                 \"rw\", rv);\n        if (rv < 0 &&\n            !virLastErrorIsSystemErrno(ENOENT))\n            return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLastErrorIsSystemErrno",
          "args": [
            "ENOENT"
          ],
          "line": 698
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorIsSystemErrno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1432-1442",
          "snippet": "bool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nbool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditCgroupPath",
          "args": [
            "vm",
            "priv->cgroup",
            "\"deny\"",
            "rng->source.file",
            "\"rw\"",
            "rv"
          ],
          "line": 694
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroupPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "658-687",
          "snippet": "void\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupDenyDevicePath",
          "args": [
            "priv->cgroup",
            "rng->source.file",
            "VIR_CGROUP_DEVICE_RW",
            "false"
          ],
          "line": 691
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDenyDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3316-3325",
          "snippet": "int\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Tearing down Cgroup ACL for RNG device\""
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 686
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuTeardownRNGCgroup(virDomainObjPtr vm,\n                      virDomainRNGDefPtr rng)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int rv;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (rng->backend == VIR_DOMAIN_RNG_BACKEND_RANDOM) {\n        VIR_DEBUG(\"Tearing down Cgroup ACL for RNG device\");\n        rv = virCgroupDenyDevicePath(priv->cgroup,\n                                     rng->source.file,\n                                     VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\",\n                                 rng->source.file,\n                                 \"rw\", rv);\n        if (rv < 0 &&\n            !virLastErrorIsSystemErrno(ENOENT))\n            return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuSetupRNGCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "652-676",
    "snippet": "int\nqemuSetupRNGCgroup(virDomainObjPtr vm,\n                   virDomainRNGDefPtr rng)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int rv;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (rng->backend == VIR_DOMAIN_RNG_BACKEND_RANDOM) {\n        VIR_DEBUG(\"Setting Cgroup ACL for RNG device\");\n        rv = virCgroupAllowDevicePath(priv->cgroup,\n                                      rng->source.file,\n                                      VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                                 rng->source.file,\n                                 \"rw\", rv);\n        if (rv < 0 &&\n            !virLastErrorIsSystemErrno(ENOENT))\n            return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLastErrorIsSystemErrno",
          "args": [
            "ENOENT"
          ],
          "line": 671
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorIsSystemErrno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1432-1442",
          "snippet": "bool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nbool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditCgroupPath",
          "args": [
            "vm",
            "priv->cgroup",
            "\"allow\"",
            "rng->source.file",
            "\"rw\"",
            "rv"
          ],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroupPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "658-687",
          "snippet": "void\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupAllowDevicePath",
          "args": [
            "priv->cgroup",
            "rng->source.file",
            "VIR_CGROUP_DEVICE_RW",
            "false"
          ],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3291-3300",
          "snippet": "int\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Setting Cgroup ACL for RNG device\""
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupRNGCgroup(virDomainObjPtr vm,\n                   virDomainRNGDefPtr rng)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int rv;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (rng->backend == VIR_DOMAIN_RNG_BACKEND_RANDOM) {\n        VIR_DEBUG(\"Setting Cgroup ACL for RNG device\");\n        rv = virCgroupAllowDevicePath(priv->cgroup,\n                                      rng->source.file,\n                                      VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                                 rng->source.file,\n                                 \"rw\", rv);\n        if (rv < 0 &&\n            !virLastErrorIsSystemErrno(ENOENT))\n            return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuSetupFirmwareCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "633-649",
    "snippet": "static int\nqemuSetupFirmwareCgroup(virDomainObjPtr vm)\n{\n    if (!vm->def->os.loader)\n        return 0;\n\n    if (vm->def->os.loader->path &&\n        qemuSetupImagePathCgroup(vm, vm->def->os.loader->path,\n                                 vm->def->os.loader->readonly == VIR_TRISTATE_BOOL_YES) < 0)\n        return -1;\n\n    if (vm->def->os.loader->nvram &&\n        qemuSetupImagePathCgroup(vm, vm->def->os.loader->nvram, false) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuSetupImagePathCgroup",
          "args": [
            "vm",
            "vm->def->os.loader->nvram",
            "false"
          ],
          "line": 645
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupImagePathCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "58-115",
          "snippet": "static int\nqemuSetupImagePathCgroup(virDomainObjPtr vm,\n                         const char *path,\n                         bool readonly)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int perms = VIR_CGROUP_DEVICE_READ;\n    char **targetPaths = NULL;\n    size_t i;\n    int rv;\n    int ret = -1;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (!readonly)\n        perms |= VIR_CGROUP_DEVICE_WRITE;\n\n    VIR_DEBUG(\"Allow path %s, perms: %s\",\n              path, virCgroupGetDevicePermsString(perms));\n\n    rv = virCgroupAllowDevicePath(priv->cgroup, path, perms, true);\n\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", path,\n                             virCgroupGetDevicePermsString(perms),\n                             rv);\n    if (rv < 0)\n        goto cleanup;\n\n    if (rv > 0) {\n        /* @path is neither character device nor block device. */\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (virDevMapperGetTargets(path, &targetPaths) < 0 &&\n        errno != ENOSYS && errno != EBADF) {\n        virReportSystemError(errno,\n                             _(\"Unable to get devmapper targets for %s\"),\n                             path);\n        goto cleanup;\n    }\n\n    for (i = 0; targetPaths && targetPaths[i]; i++) {\n        rv = virCgroupAllowDevicePath(priv->cgroup, targetPaths[i], perms, false);\n\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", targetPaths[i],\n                                 virCgroupGetDevicePermsString(perms),\n                                 rv);\n        if (rv < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virStringListFree(targetPaths);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupImagePathCgroup(virDomainObjPtr vm,\n                         const char *path,\n                         bool readonly)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int perms = VIR_CGROUP_DEVICE_READ;\n    char **targetPaths = NULL;\n    size_t i;\n    int rv;\n    int ret = -1;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (!readonly)\n        perms |= VIR_CGROUP_DEVICE_WRITE;\n\n    VIR_DEBUG(\"Allow path %s, perms: %s\",\n              path, virCgroupGetDevicePermsString(perms));\n\n    rv = virCgroupAllowDevicePath(priv->cgroup, path, perms, true);\n\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", path,\n                             virCgroupGetDevicePermsString(perms),\n                             rv);\n    if (rv < 0)\n        goto cleanup;\n\n    if (rv > 0) {\n        /* @path is neither character device nor block device. */\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (virDevMapperGetTargets(path, &targetPaths) < 0 &&\n        errno != ENOSYS && errno != EBADF) {\n        virReportSystemError(errno,\n                             _(\"Unable to get devmapper targets for %s\"),\n                             path);\n        goto cleanup;\n    }\n\n    for (i = 0; targetPaths && targetPaths[i]; i++) {\n        rv = virCgroupAllowDevicePath(priv->cgroup, targetPaths[i], perms, false);\n\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", targetPaths[i],\n                                 virCgroupGetDevicePermsString(perms),\n                                 rv);\n        if (rv < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virStringListFree(targetPaths);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupFirmwareCgroup(virDomainObjPtr vm)\n{\n    if (!vm->def->os.loader)\n        return 0;\n\n    if (vm->def->os.loader->path &&\n        qemuSetupImagePathCgroup(vm, vm->def->os.loader->path,\n                                 vm->def->os.loader->readonly == VIR_TRISTATE_BOOL_YES) < 0)\n        return -1;\n\n    if (vm->def->os.loader->nvram &&\n        qemuSetupImagePathCgroup(vm, vm->def->os.loader->nvram, false) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuSetupMemoryCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "612-630",
    "snippet": "static int\nqemuSetupMemoryCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_MEMORY)) {\n        if (virMemoryLimitIsSet(vm->def->mem.hard_limit) ||\n            virMemoryLimitIsSet(vm->def->mem.soft_limit) ||\n            virMemoryLimitIsSet(vm->def->mem.swap_hard_limit)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Memory cgroup is not available on this host\"));\n            return -1;\n        } else {\n            return 0;\n        }\n    }\n\n    return virDomainCgroupSetupMemtune(priv->cgroup, vm->def->mem);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainCgroupSetupMemtune",
          "args": [
            "priv->cgroup",
            "vm->def->mem"
          ],
          "line": 629
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCgroupSetupMemtune",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_cgroup.c",
          "lines": "75-91",
          "snippet": "int\nvirDomainCgroupSetupMemtune(virCgroupPtr cgroup, virDomainMemtune mem)\n{\n    if (virMemoryLimitIsSet(mem.hard_limit))\n        if (virCgroupSetMemoryHardLimit(cgroup, mem.hard_limit) < 0)\n            return -1;\n\n    if (virMemoryLimitIsSet(mem.soft_limit))\n        if (virCgroupSetMemorySoftLimit(cgroup, mem.soft_limit) < 0)\n            return -1;\n\n    if (virMemoryLimitIsSet(mem.swap_hard_limit))\n        if (virCgroupSetMemSwapHardLimit(cgroup, mem.swap_hard_limit) < 0)\n            return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include <config.h>\n\nint\nvirDomainCgroupSetupMemtune(virCgroupPtr cgroup, virDomainMemtune mem)\n{\n    if (virMemoryLimitIsSet(mem.hard_limit))\n        if (virCgroupSetMemoryHardLimit(cgroup, mem.hard_limit) < 0)\n            return -1;\n\n    if (virMemoryLimitIsSet(mem.soft_limit))\n        if (virCgroupSetMemorySoftLimit(cgroup, mem.soft_limit) < 0)\n            return -1;\n\n    if (virMemoryLimitIsSet(mem.swap_hard_limit))\n        if (virCgroupSetMemSwapHardLimit(cgroup, mem.swap_hard_limit) < 0)\n            return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Memory cgroup is not available on this host\")"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Memory cgroup is not available on this host\""
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMemoryLimitIsSet",
          "args": [
            "vm->def->mem.swap_hard_limit"
          ],
          "line": 620
        },
        "resolved": true,
        "details": {
          "function_name": "virMemoryLimitIsSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1628-1632",
          "snippet": "bool\nvirMemoryLimitIsSet(unsigned long long value)\n{\n    return value < VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirMemoryLimitIsSet(unsigned long long value)\n{\n    return value < VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_MEMORY"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupMemoryCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_MEMORY)) {\n        if (virMemoryLimitIsSet(vm->def->mem.hard_limit) ||\n            virMemoryLimitIsSet(vm->def->mem.soft_limit) ||\n            virMemoryLimitIsSet(vm->def->mem.swap_hard_limit)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Memory cgroup is not available on this host\"));\n            return -1;\n        } else {\n            return 0;\n        }\n    }\n\n    return virDomainCgroupSetupMemtune(priv->cgroup, vm->def->mem);\n}"
  },
  {
    "function_name": "qemuSetupBlkioCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "592-609",
    "snippet": "static int\nqemuSetupBlkioCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!virCgroupHasController(priv->cgroup,\n                                VIR_CGROUP_CONTROLLER_BLKIO)) {\n        if (vm->def->blkio.weight || vm->def->blkio.ndevices) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Block I/O tuning is not available on this host\"));\n            return -1;\n        } else {\n            return 0;\n        }\n    }\n\n    return virDomainCgroupSetupBlkio(priv->cgroup, vm->def->blkio);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainCgroupSetupBlkio",
          "args": [
            "priv->cgroup",
            "vm->def->blkio"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCgroupSetupBlkio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_cgroup.c",
          "lines": "31-72",
          "snippet": "int\nvirDomainCgroupSetupBlkio(virCgroupPtr cgroup, virDomainBlkiotune blkio)\n{\n    size_t i;\n\n    if (blkio.weight != 0 &&\n        virCgroupSetBlkioWeight(cgroup, blkio.weight) < 0)\n        return -1;\n\n    if (blkio.ndevices) {\n        for (i = 0; i < blkio.ndevices; i++) {\n            virBlkioDevicePtr dev = &blkio.devices[i];\n\n            if (dev->weight &&\n                virCgroupSetupBlkioDeviceWeight(cgroup, dev->path,\n                                                &dev->weight) < 0)\n                return -1;\n\n            if (dev->riops &&\n                virCgroupSetupBlkioDeviceReadIops(cgroup, dev->path,\n                                                  &dev->riops) < 0)\n                return -1;\n\n            if (dev->wiops &&\n                virCgroupSetupBlkioDeviceWriteIops(cgroup, dev->path,\n                                                   &dev->wiops) < 0)\n                return -1;\n\n            if (dev->rbps &&\n                virCgroupSetupBlkioDeviceReadBps(cgroup, dev->path,\n                                                 &dev->rbps) < 0)\n                return -1;\n\n            if (dev->wbps &&\n                virCgroupSetupBlkioDeviceWriteBps(cgroup, dev->path,\n                                                  &dev->wbps) < 0)\n                return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include <config.h>\n\nint\nvirDomainCgroupSetupBlkio(virCgroupPtr cgroup, virDomainBlkiotune blkio)\n{\n    size_t i;\n\n    if (blkio.weight != 0 &&\n        virCgroupSetBlkioWeight(cgroup, blkio.weight) < 0)\n        return -1;\n\n    if (blkio.ndevices) {\n        for (i = 0; i < blkio.ndevices; i++) {\n            virBlkioDevicePtr dev = &blkio.devices[i];\n\n            if (dev->weight &&\n                virCgroupSetupBlkioDeviceWeight(cgroup, dev->path,\n                                                &dev->weight) < 0)\n                return -1;\n\n            if (dev->riops &&\n                virCgroupSetupBlkioDeviceReadIops(cgroup, dev->path,\n                                                  &dev->riops) < 0)\n                return -1;\n\n            if (dev->wiops &&\n                virCgroupSetupBlkioDeviceWriteIops(cgroup, dev->path,\n                                                   &dev->wiops) < 0)\n                return -1;\n\n            if (dev->rbps &&\n                virCgroupSetupBlkioDeviceReadBps(cgroup, dev->path,\n                                                 &dev->rbps) < 0)\n                return -1;\n\n            if (dev->wbps &&\n                virCgroupSetupBlkioDeviceWriteBps(cgroup, dev->path,\n                                                  &dev->wbps) < 0)\n                return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Block I/O tuning is not available on this host\")"
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Block I/O tuning is not available on this host\""
          ],
          "line": 601
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_BLKIO"
          ],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupBlkioCgroup(virDomainObjPtr vm)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!virCgroupHasController(priv->cgroup,\n                                VIR_CGROUP_CONTROLLER_BLKIO)) {\n        if (vm->def->blkio.weight || vm->def->blkio.ndevices) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Block I/O tuning is not available on this host\"));\n            return -1;\n        } else {\n            return 0;\n        }\n    }\n\n    return virDomainCgroupSetupBlkio(priv->cgroup, vm->def->blkio);\n}"
  },
  {
    "function_name": "qemuSetupVideoCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "569-589",
    "snippet": "static int\nqemuSetupVideoCgroup(virDomainObjPtr vm,\n                     virDomainVideoDefPtr def)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virDomainVideoAccelDefPtr accel = def->accel;\n    int ret;\n\n    if (!accel)\n        return 0;\n\n    if (!accel->rendernode ||\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, accel->rendernode,\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", accel->rendernode,\n                             \"rw\", ret);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditCgroupPath",
          "args": [
            "vm",
            "priv->cgroup",
            "\"allow\"",
            "accel->rendernode",
            "\"rw\"",
            "ret"
          ],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroupPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "658-687",
          "snippet": "void\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupAllowDevicePath",
          "args": [
            "priv->cgroup",
            "accel->rendernode",
            "VIR_CGROUP_DEVICE_RW",
            "false"
          ],
          "line": 584
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3291-3300",
          "snippet": "int\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupVideoCgroup(virDomainObjPtr vm,\n                     virDomainVideoDefPtr def)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virDomainVideoAccelDefPtr accel = def->accel;\n    int ret;\n\n    if (!accel)\n        return 0;\n\n    if (!accel->rendernode ||\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, accel->rendernode,\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", accel->rendernode,\n                             \"rw\", ret);\n    return ret;\n}"
  },
  {
    "function_name": "qemuSetupGraphicsCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "549-566",
    "snippet": "static int\nqemuSetupGraphicsCgroup(virDomainObjPtr vm,\n                        virDomainGraphicsDefPtr gfx)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    const char *rendernode = virDomainGraphicsGetRenderNode(gfx);\n    int ret;\n\n    if (!rendernode ||\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, rendernode,\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", rendernode,\n                             \"rw\", ret);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditCgroupPath",
          "args": [
            "vm",
            "priv->cgroup",
            "\"allow\"",
            "rendernode",
            "\"rw\"",
            "ret"
          ],
          "line": 563
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroupPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "658-687",
          "snippet": "void\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupAllowDevicePath",
          "args": [
            "priv->cgroup",
            "rendernode",
            "VIR_CGROUP_DEVICE_RW",
            "false"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3291-3300",
          "snippet": "int\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 558
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGraphicsGetRenderNode",
          "args": [
            "gfx"
          ],
          "line": 554
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainGraphicsGetRenderNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "32154-32175",
          "snippet": "const char *\nvirDomainGraphicsGetRenderNode(const virDomainGraphicsDef *graphics)\n{\n    const char *ret = NULL;\n\n    switch (graphics->type) {\n    case VIR_DOMAIN_GRAPHICS_TYPE_SPICE:\n        ret = graphics->data.spice.rendernode;\n        break;\n    case VIR_DOMAIN_GRAPHICS_TYPE_EGL_HEADLESS:\n        ret = graphics->data.egl_headless.rendernode;\n        break;\n    case VIR_DOMAIN_GRAPHICS_TYPE_SDL:\n    case VIR_DOMAIN_GRAPHICS_TYPE_VNC:\n    case VIR_DOMAIN_GRAPHICS_TYPE_RDP:\n    case VIR_DOMAIN_GRAPHICS_TYPE_DESKTOP:\n    case VIR_DOMAIN_GRAPHICS_TYPE_LAST:\n        break;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainGraphicsGetRenderNode(const virDomainGraphicsDef *graphics)\n{\n    const char *ret = NULL;\n\n    switch (graphics->type) {\n    case VIR_DOMAIN_GRAPHICS_TYPE_SPICE:\n        ret = graphics->data.spice.rendernode;\n        break;\n    case VIR_DOMAIN_GRAPHICS_TYPE_EGL_HEADLESS:\n        ret = graphics->data.egl_headless.rendernode;\n        break;\n    case VIR_DOMAIN_GRAPHICS_TYPE_SDL:\n    case VIR_DOMAIN_GRAPHICS_TYPE_VNC:\n    case VIR_DOMAIN_GRAPHICS_TYPE_RDP:\n    case VIR_DOMAIN_GRAPHICS_TYPE_DESKTOP:\n    case VIR_DOMAIN_GRAPHICS_TYPE_LAST:\n        break;\n    }\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupGraphicsCgroup(virDomainObjPtr vm,\n                        virDomainGraphicsDefPtr gfx)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    const char *rendernode = virDomainGraphicsGetRenderNode(gfx);\n    int ret;\n\n    if (!rendernode ||\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, rendernode,\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", rendernode,\n                             \"rw\", ret);\n    return ret;\n}"
  },
  {
    "function_name": "qemuTeardownMemoryDevicesCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "528-546",
    "snippet": "int\nqemuTeardownMemoryDevicesCgroup(virDomainObjPtr vm,\n                                virDomainMemoryDefPtr mem)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int rv;\n\n    if (mem->model != VIR_DOMAIN_MEMORY_MODEL_NVDIMM)\n        return 0;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    rv = virCgroupDenyDevicePath(priv->cgroup, mem->nvdimmPath,\n                                 VIR_CGROUP_DEVICE_RWM, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup,\n                             \"deny\", mem->nvdimmPath, \"rwm\", rv);\n    return rv;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditCgroupPath",
          "args": [
            "vm",
            "priv->cgroup",
            "\"deny\"",
            "mem->nvdimmPath",
            "\"rwm\"",
            "rv"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroupPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "658-687",
          "snippet": "void\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupDenyDevicePath",
          "args": [
            "priv->cgroup",
            "mem->nvdimmPath",
            "VIR_CGROUP_DEVICE_RWM",
            "false"
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDenyDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3316-3325",
          "snippet": "int\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuTeardownMemoryDevicesCgroup(virDomainObjPtr vm,\n                                virDomainMemoryDefPtr mem)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int rv;\n\n    if (mem->model != VIR_DOMAIN_MEMORY_MODEL_NVDIMM)\n        return 0;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    rv = virCgroupDenyDevicePath(priv->cgroup, mem->nvdimmPath,\n                                 VIR_CGROUP_DEVICE_RWM, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup,\n                             \"deny\", mem->nvdimmPath, \"rwm\", rv);\n    return rv;\n}"
  },
  {
    "function_name": "qemuSetupMemoryDevicesCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "505-525",
    "snippet": "int\nqemuSetupMemoryDevicesCgroup(virDomainObjPtr vm,\n                             virDomainMemoryDefPtr mem)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int rv;\n\n    if (mem->model != VIR_DOMAIN_MEMORY_MODEL_NVDIMM)\n        return 0;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    VIR_DEBUG(\"Setting devices Cgroup for NVDIMM device: %s\", mem->nvdimmPath);\n    rv = virCgroupAllowDevicePath(priv->cgroup, mem->nvdimmPath,\n                                  VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                             mem->nvdimmPath, \"rw\", rv);\n\n    return rv;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditCgroupPath",
          "args": [
            "vm",
            "priv->cgroup",
            "\"allow\"",
            "mem->nvdimmPath",
            "\"rw\"",
            "rv"
          ],
          "line": 521
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroupPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "658-687",
          "snippet": "void\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupAllowDevicePath",
          "args": [
            "priv->cgroup",
            "mem->nvdimmPath",
            "VIR_CGROUP_DEVICE_RW",
            "false"
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3291-3300",
          "snippet": "int\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Setting devices Cgroup for NVDIMM device: %s\"",
            "mem->nvdimmPath"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupMemoryDevicesCgroup(virDomainObjPtr vm,\n                             virDomainMemoryDefPtr mem)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int rv;\n\n    if (mem->model != VIR_DOMAIN_MEMORY_MODEL_NVDIMM)\n        return 0;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    VIR_DEBUG(\"Setting devices Cgroup for NVDIMM device: %s\", mem->nvdimmPath);\n    rv = virCgroupAllowDevicePath(priv->cgroup, mem->nvdimmPath,\n                                  VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                             mem->nvdimmPath, \"rw\", rv);\n\n    return rv;\n}"
  },
  {
    "function_name": "qemuTeardownHostdevCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "466-502",
    "snippet": "int\nqemuTeardownHostdevCgroup(virDomainObjPtr vm,\n                          virDomainHostdevDefPtr dev)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    g_autofree char *path = NULL;\n    int rv;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (qemuDomainGetHostdevPath(dev, &path, NULL) < 0)\n        return -1;\n\n    if (path) {\n        VIR_DEBUG(\"Cgroup deny %s\", path);\n        rv = virCgroupDenyDevicePath(priv->cgroup, path,\n                                     VIR_CGROUP_DEVICE_RWM, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup,\n                                 \"deny\", path, \"rwm\", rv);\n        if (rv < 0)\n            return -1;\n    }\n\n    if (qemuHostdevNeedsVFIO(dev) &&\n        !qemuDomainNeedsVFIO(vm->def)) {\n        VIR_DEBUG(\"Cgroup deny \" QEMU_DEV_VFIO);\n        rv = virCgroupDenyDevicePath(priv->cgroup, QEMU_DEV_VFIO,\n                                     VIR_CGROUP_DEVICE_RWM, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\",\n                                 QEMU_DEV_VFIO, \"rwm\", rv);\n        if (rv < 0)\n            return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditCgroupPath",
          "args": [
            "vm",
            "priv->cgroup",
            "\"deny\"",
            "QEMU_DEV_VFIO",
            "\"rwm\"",
            "rv"
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroupPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "658-687",
          "snippet": "void\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupDenyDevicePath",
          "args": [
            "priv->cgroup",
            "QEMU_DEV_VFIO",
            "VIR_CGROUP_DEVICE_RWM",
            "false"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDenyDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3316-3325",
          "snippet": "int\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Cgroup deny \" QEMU_DEV_VFIO"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuDomainNeedsVFIO",
          "args": [
            "vm->def"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainNeedsVFIO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "14232-14238",
          "snippet": "bool\nqemuDomainNeedsVFIO(const virDomainDef *def)\n{\n    return virDomainDefHasVFIOHostdev(def) ||\n        virDomainDefHasMdevHostdev(def) ||\n        virDomainDefHasNVMeDisk(def);\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nbool\nqemuDomainNeedsVFIO(const virDomainDef *def)\n{\n    return virDomainDefHasVFIOHostdev(def) ||\n        virDomainDefHasMdevHostdev(def) ||\n        virDomainDefHasNVMeDisk(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuHostdevNeedsVFIO",
          "args": [
            "dev"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "qemuHostdevNeedsVFIO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_hostdev.c",
          "lines": "138-143",
          "snippet": "bool\nqemuHostdevNeedsVFIO(const virDomainHostdevDef *hostdev)\n{\n    return virHostdevIsVFIODevice(hostdev) ||\n        virHostdevIsMdevDevice(hostdev);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostdev.h\"",
            "#include \"virfile.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostdev.h\"\n#include \"virfile.h\"\n#include \"virnetdev.h\"\n#include \"virscsi.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_hostdev.h\"\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nbool\nqemuHostdevNeedsVFIO(const virDomainHostdevDef *hostdev)\n{\n    return virHostdevIsVFIODevice(hostdev) ||\n        virHostdevIsMdevDevice(hostdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Cgroup deny %s\"",
            "path"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuDomainGetHostdevPath",
          "args": [
            "dev",
            "&path",
            "NULL"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainGetHostdevPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "14257-14354",
          "snippet": "int\nqemuDomainGetHostdevPath(virDomainHostdevDefPtr dev,\n                         char **path,\n                         int *perms)\n{\n    virDomainHostdevSubsysUSBPtr usbsrc = &dev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &dev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &dev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &dev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &dev->source.subsys.u.mdev;\n    g_autoptr(virUSBDevice) usb = NULL;\n    g_autoptr(virSCSIDevice) scsi = NULL;\n    g_autoptr(virSCSIVHostDevice) host = NULL;\n    g_autofree char *tmpPath = NULL;\n    int perm = 0;\n\n    switch ((virDomainHostdevMode) dev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType)dev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            if (pcisrc->backend == VIR_DOMAIN_HOSTDEV_PCI_BACKEND_VFIO) {\n                if (!(tmpPath = virPCIDeviceAddressGetIOMMUGroupDev(&pcisrc->addr)))\n                    return -1;\n\n                perm = VIR_CGROUP_DEVICE_RW;\n            }\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            if (dev->missing)\n                break;\n            usb = virUSBDeviceNew(usbsrc->bus,\n                                  usbsrc->device,\n                                  NULL);\n            if (!usb)\n                return -1;\n\n            tmpPath = g_strdup(virUSBDeviceGetPath(usb));\n            perm = VIR_CGROUP_DEVICE_RW;\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI:\n            if (scsisrc->protocol == VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                virDomainHostdevSubsysSCSIiSCSIPtr iscsisrc = &scsisrc->u.iscsi;\n                VIR_DEBUG(\"Not updating /dev for hostdev iSCSI path '%s'\", iscsisrc->src->path);\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc = &scsisrc->u.host;\n                scsi = virSCSIDeviceNew(NULL,\n                                        scsihostsrc->adapter,\n                                        scsihostsrc->bus,\n                                        scsihostsrc->target,\n                                        scsihostsrc->unit,\n                                        dev->readonly,\n                                        dev->shareable);\n\n                if (!scsi)\n                    return -1;\n\n                tmpPath = g_strdup(virSCSIDeviceGetPath(scsi));\n                perm = virSCSIDeviceGetReadonly(scsi) ?\n                    VIR_CGROUP_DEVICE_READ : VIR_CGROUP_DEVICE_RW;\n            }\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST: {\n            if (hostsrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SUBSYS_SCSI_HOST_PROTOCOL_TYPE_VHOST) {\n                if (!(host = virSCSIVHostDeviceNew(hostsrc->wwpn)))\n                    return -1;\n\n                tmpPath = g_strdup(virSCSIVHostDeviceGetPath(host));\n                perm = VIR_CGROUP_DEVICE_RW;\n            }\n            break;\n        }\n\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            if (!(tmpPath = virMediatedDeviceGetIOMMUGroupDev(mdevsrc->uuidstr)))\n                return -1;\n\n            perm = VIR_CGROUP_DEVICE_RW;\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n            break;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n        /* nada */\n        break;\n    }\n\n    *path = g_steal_pointer(&tmpPath);\n    if (perms)\n        *perms = perm;\n    return 0;\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nint\nqemuDomainGetHostdevPath(virDomainHostdevDefPtr dev,\n                         char **path,\n                         int *perms)\n{\n    virDomainHostdevSubsysUSBPtr usbsrc = &dev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &dev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &dev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &dev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &dev->source.subsys.u.mdev;\n    g_autoptr(virUSBDevice) usb = NULL;\n    g_autoptr(virSCSIDevice) scsi = NULL;\n    g_autoptr(virSCSIVHostDevice) host = NULL;\n    g_autofree char *tmpPath = NULL;\n    int perm = 0;\n\n    switch ((virDomainHostdevMode) dev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType)dev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            if (pcisrc->backend == VIR_DOMAIN_HOSTDEV_PCI_BACKEND_VFIO) {\n                if (!(tmpPath = virPCIDeviceAddressGetIOMMUGroupDev(&pcisrc->addr)))\n                    return -1;\n\n                perm = VIR_CGROUP_DEVICE_RW;\n            }\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            if (dev->missing)\n                break;\n            usb = virUSBDeviceNew(usbsrc->bus,\n                                  usbsrc->device,\n                                  NULL);\n            if (!usb)\n                return -1;\n\n            tmpPath = g_strdup(virUSBDeviceGetPath(usb));\n            perm = VIR_CGROUP_DEVICE_RW;\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI:\n            if (scsisrc->protocol == VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                virDomainHostdevSubsysSCSIiSCSIPtr iscsisrc = &scsisrc->u.iscsi;\n                VIR_DEBUG(\"Not updating /dev for hostdev iSCSI path '%s'\", iscsisrc->src->path);\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc = &scsisrc->u.host;\n                scsi = virSCSIDeviceNew(NULL,\n                                        scsihostsrc->adapter,\n                                        scsihostsrc->bus,\n                                        scsihostsrc->target,\n                                        scsihostsrc->unit,\n                                        dev->readonly,\n                                        dev->shareable);\n\n                if (!scsi)\n                    return -1;\n\n                tmpPath = g_strdup(virSCSIDeviceGetPath(scsi));\n                perm = virSCSIDeviceGetReadonly(scsi) ?\n                    VIR_CGROUP_DEVICE_READ : VIR_CGROUP_DEVICE_RW;\n            }\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST: {\n            if (hostsrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SUBSYS_SCSI_HOST_PROTOCOL_TYPE_VHOST) {\n                if (!(host = virSCSIVHostDeviceNew(hostsrc->wwpn)))\n                    return -1;\n\n                tmpPath = g_strdup(virSCSIVHostDeviceGetPath(host));\n                perm = VIR_CGROUP_DEVICE_RW;\n            }\n            break;\n        }\n\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            if (!(tmpPath = virMediatedDeviceGetIOMMUGroupDev(mdevsrc->uuidstr)))\n                return -1;\n\n            perm = VIR_CGROUP_DEVICE_RW;\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n            break;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n        /* nada */\n        break;\n    }\n\n    *path = g_steal_pointer(&tmpPath);\n    if (perms)\n        *perms = perm;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 474
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuTeardownHostdevCgroup(virDomainObjPtr vm,\n                          virDomainHostdevDefPtr dev)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    g_autofree char *path = NULL;\n    int rv;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (qemuDomainGetHostdevPath(dev, &path, NULL) < 0)\n        return -1;\n\n    if (path) {\n        VIR_DEBUG(\"Cgroup deny %s\", path);\n        rv = virCgroupDenyDevicePath(priv->cgroup, path,\n                                     VIR_CGROUP_DEVICE_RWM, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup,\n                                 \"deny\", path, \"rwm\", rv);\n        if (rv < 0)\n            return -1;\n    }\n\n    if (qemuHostdevNeedsVFIO(dev) &&\n        !qemuDomainNeedsVFIO(vm->def)) {\n        VIR_DEBUG(\"Cgroup deny \" QEMU_DEV_VFIO);\n        rv = virCgroupDenyDevicePath(priv->cgroup, QEMU_DEV_VFIO,\n                                     VIR_CGROUP_DEVICE_RWM, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\",\n                                 QEMU_DEV_VFIO, \"rwm\", rv);\n        if (rv < 0)\n            return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuSetupHostdevCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "416-452",
    "snippet": "int\nqemuSetupHostdevCgroup(virDomainObjPtr vm,\n                       virDomainHostdevDefPtr dev)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    g_autofree char *path = NULL;\n    int perms;\n    int rv;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (qemuDomainGetHostdevPath(dev, &path, &perms) < 0)\n        return -1;\n\n    if (path) {\n        VIR_DEBUG(\"Cgroup allow %s perms=%d\", path, perms);\n        rv = virCgroupAllowDevicePath(priv->cgroup, path, perms, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", path,\n                                 virCgroupGetDevicePermsString(perms),\n                                 rv);\n        if (rv < 0)\n            return -1;\n    }\n\n    if (qemuHostdevNeedsVFIO(dev)) {\n        VIR_DEBUG(\"Cgroup allow %s perms=%d\", QEMU_DEV_VFIO, VIR_CGROUP_DEVICE_RW);\n        rv = virCgroupAllowDevicePath(priv->cgroup, QEMU_DEV_VFIO,\n                                      VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                                 QEMU_DEV_VFIO, \"rw\", rv);\n        if (rv < 0)\n            return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditCgroupPath",
          "args": [
            "vm",
            "priv->cgroup",
            "\"allow\"",
            "QEMU_DEV_VFIO",
            "\"rw\"",
            "rv"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroupPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "658-687",
          "snippet": "void\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupAllowDevicePath",
          "args": [
            "priv->cgroup",
            "QEMU_DEV_VFIO",
            "VIR_CGROUP_DEVICE_RW",
            "false"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3291-3300",
          "snippet": "int\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Cgroup allow %s perms=%d\"",
            "QEMU_DEV_VFIO",
            "VIR_CGROUP_DEVICE_RW"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuHostdevNeedsVFIO",
          "args": [
            "dev"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "qemuHostdevNeedsVFIO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_hostdev.c",
          "lines": "138-143",
          "snippet": "bool\nqemuHostdevNeedsVFIO(const virDomainHostdevDef *hostdev)\n{\n    return virHostdevIsVFIODevice(hostdev) ||\n        virHostdevIsMdevDevice(hostdev);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostdev.h\"",
            "#include \"virfile.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostdev.h\"\n#include \"virfile.h\"\n#include \"virnetdev.h\"\n#include \"virscsi.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_hostdev.h\"\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nbool\nqemuHostdevNeedsVFIO(const virDomainHostdevDef *hostdev)\n{\n    return virHostdevIsVFIODevice(hostdev) ||\n        virHostdevIsMdevDevice(hostdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetDevicePermsString",
          "args": [
            "perms"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetDevicePermsString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "74-102",
          "snippet": "const char *\nvirCgroupGetDevicePermsString(int perms)\n{\n    if (perms & VIR_CGROUP_DEVICE_READ) {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rwm\";\n            else\n                return \"rw\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rm\";\n            else\n                return \"r\";\n        }\n    } else {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"wm\";\n            else\n                return \"w\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"m\";\n            else\n                return \"\";\n        }\n    }\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nconst char *\nvirCgroupGetDevicePermsString(int perms)\n{\n    if (perms & VIR_CGROUP_DEVICE_READ) {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rwm\";\n            else\n                return \"rw\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rm\";\n            else\n                return \"r\";\n        }\n    } else {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"wm\";\n            else\n                return \"w\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"m\";\n            else\n                return \"\";\n        }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Cgroup allow %s perms=%d\"",
            "path",
            "perms"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuDomainGetHostdevPath",
          "args": [
            "dev",
            "&path",
            "&perms"
          ],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainGetHostdevPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "14257-14354",
          "snippet": "int\nqemuDomainGetHostdevPath(virDomainHostdevDefPtr dev,\n                         char **path,\n                         int *perms)\n{\n    virDomainHostdevSubsysUSBPtr usbsrc = &dev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &dev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &dev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &dev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &dev->source.subsys.u.mdev;\n    g_autoptr(virUSBDevice) usb = NULL;\n    g_autoptr(virSCSIDevice) scsi = NULL;\n    g_autoptr(virSCSIVHostDevice) host = NULL;\n    g_autofree char *tmpPath = NULL;\n    int perm = 0;\n\n    switch ((virDomainHostdevMode) dev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType)dev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            if (pcisrc->backend == VIR_DOMAIN_HOSTDEV_PCI_BACKEND_VFIO) {\n                if (!(tmpPath = virPCIDeviceAddressGetIOMMUGroupDev(&pcisrc->addr)))\n                    return -1;\n\n                perm = VIR_CGROUP_DEVICE_RW;\n            }\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            if (dev->missing)\n                break;\n            usb = virUSBDeviceNew(usbsrc->bus,\n                                  usbsrc->device,\n                                  NULL);\n            if (!usb)\n                return -1;\n\n            tmpPath = g_strdup(virUSBDeviceGetPath(usb));\n            perm = VIR_CGROUP_DEVICE_RW;\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI:\n            if (scsisrc->protocol == VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                virDomainHostdevSubsysSCSIiSCSIPtr iscsisrc = &scsisrc->u.iscsi;\n                VIR_DEBUG(\"Not updating /dev for hostdev iSCSI path '%s'\", iscsisrc->src->path);\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc = &scsisrc->u.host;\n                scsi = virSCSIDeviceNew(NULL,\n                                        scsihostsrc->adapter,\n                                        scsihostsrc->bus,\n                                        scsihostsrc->target,\n                                        scsihostsrc->unit,\n                                        dev->readonly,\n                                        dev->shareable);\n\n                if (!scsi)\n                    return -1;\n\n                tmpPath = g_strdup(virSCSIDeviceGetPath(scsi));\n                perm = virSCSIDeviceGetReadonly(scsi) ?\n                    VIR_CGROUP_DEVICE_READ : VIR_CGROUP_DEVICE_RW;\n            }\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST: {\n            if (hostsrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SUBSYS_SCSI_HOST_PROTOCOL_TYPE_VHOST) {\n                if (!(host = virSCSIVHostDeviceNew(hostsrc->wwpn)))\n                    return -1;\n\n                tmpPath = g_strdup(virSCSIVHostDeviceGetPath(host));\n                perm = VIR_CGROUP_DEVICE_RW;\n            }\n            break;\n        }\n\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            if (!(tmpPath = virMediatedDeviceGetIOMMUGroupDev(mdevsrc->uuidstr)))\n                return -1;\n\n            perm = VIR_CGROUP_DEVICE_RW;\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n            break;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n        /* nada */\n        break;\n    }\n\n    *path = g_steal_pointer(&tmpPath);\n    if (perms)\n        *perms = perm;\n    return 0;\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nint\nqemuDomainGetHostdevPath(virDomainHostdevDefPtr dev,\n                         char **path,\n                         int *perms)\n{\n    virDomainHostdevSubsysUSBPtr usbsrc = &dev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &dev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &dev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &dev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &dev->source.subsys.u.mdev;\n    g_autoptr(virUSBDevice) usb = NULL;\n    g_autoptr(virSCSIDevice) scsi = NULL;\n    g_autoptr(virSCSIVHostDevice) host = NULL;\n    g_autofree char *tmpPath = NULL;\n    int perm = 0;\n\n    switch ((virDomainHostdevMode) dev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType)dev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            if (pcisrc->backend == VIR_DOMAIN_HOSTDEV_PCI_BACKEND_VFIO) {\n                if (!(tmpPath = virPCIDeviceAddressGetIOMMUGroupDev(&pcisrc->addr)))\n                    return -1;\n\n                perm = VIR_CGROUP_DEVICE_RW;\n            }\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            if (dev->missing)\n                break;\n            usb = virUSBDeviceNew(usbsrc->bus,\n                                  usbsrc->device,\n                                  NULL);\n            if (!usb)\n                return -1;\n\n            tmpPath = g_strdup(virUSBDeviceGetPath(usb));\n            perm = VIR_CGROUP_DEVICE_RW;\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI:\n            if (scsisrc->protocol == VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                virDomainHostdevSubsysSCSIiSCSIPtr iscsisrc = &scsisrc->u.iscsi;\n                VIR_DEBUG(\"Not updating /dev for hostdev iSCSI path '%s'\", iscsisrc->src->path);\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc = &scsisrc->u.host;\n                scsi = virSCSIDeviceNew(NULL,\n                                        scsihostsrc->adapter,\n                                        scsihostsrc->bus,\n                                        scsihostsrc->target,\n                                        scsihostsrc->unit,\n                                        dev->readonly,\n                                        dev->shareable);\n\n                if (!scsi)\n                    return -1;\n\n                tmpPath = g_strdup(virSCSIDeviceGetPath(scsi));\n                perm = virSCSIDeviceGetReadonly(scsi) ?\n                    VIR_CGROUP_DEVICE_READ : VIR_CGROUP_DEVICE_RW;\n            }\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST: {\n            if (hostsrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SUBSYS_SCSI_HOST_PROTOCOL_TYPE_VHOST) {\n                if (!(host = virSCSIVHostDeviceNew(hostsrc->wwpn)))\n                    return -1;\n\n                tmpPath = g_strdup(virSCSIVHostDeviceGetPath(host));\n                perm = VIR_CGROUP_DEVICE_RW;\n            }\n            break;\n        }\n\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            if (!(tmpPath = virMediatedDeviceGetIOMMUGroupDev(mdevsrc->uuidstr)))\n                return -1;\n\n            perm = VIR_CGROUP_DEVICE_RW;\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n            break;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n        /* nada */\n        break;\n    }\n\n    *path = g_steal_pointer(&tmpPath);\n    if (perms)\n        *perms = perm;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupHostdevCgroup(virDomainObjPtr vm,\n                       virDomainHostdevDefPtr dev)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    g_autofree char *path = NULL;\n    int perms;\n    int rv;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (qemuDomainGetHostdevPath(dev, &path, &perms) < 0)\n        return -1;\n\n    if (path) {\n        VIR_DEBUG(\"Cgroup allow %s perms=%d\", path, perms);\n        rv = virCgroupAllowDevicePath(priv->cgroup, path, perms, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", path,\n                                 virCgroupGetDevicePermsString(perms),\n                                 rv);\n        if (rv < 0)\n            return -1;\n    }\n\n    if (qemuHostdevNeedsVFIO(dev)) {\n        VIR_DEBUG(\"Cgroup allow %s perms=%d\", QEMU_DEV_VFIO, VIR_CGROUP_DEVICE_RW);\n        rv = virCgroupAllowDevicePath(priv->cgroup, QEMU_DEV_VFIO,\n                                      VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                                 QEMU_DEV_VFIO, \"rw\", rv);\n        if (rv < 0)\n            return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuTeardownInputCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "383-403",
    "snippet": "int\nqemuTeardownInputCgroup(virDomainObjPtr vm,\n                        virDomainInputDefPtr dev)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret = 0;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_INPUT_TYPE_PASSTHROUGH:\n        VIR_DEBUG(\"Process path '%s' for input device\", dev->source.evdev);\n        ret = virCgroupDenyDevicePath(priv->cgroup, dev->source.evdev,\n                                      VIR_CGROUP_DEVICE_RWM, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\", dev->source.evdev, \"rwm\", ret);\n        break;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditCgroupPath",
          "args": [
            "vm",
            "priv->cgroup",
            "\"deny\"",
            "dev->source.evdev",
            "\"rwm\"",
            "ret"
          ],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroupPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "658-687",
          "snippet": "void\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupDenyDevicePath",
          "args": [
            "priv->cgroup",
            "dev->source.evdev",
            "VIR_CGROUP_DEVICE_RWM",
            "false"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDenyDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3316-3325",
          "snippet": "int\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Process path '%s' for input device\"",
            "dev->source.evdev"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuTeardownInputCgroup(virDomainObjPtr vm,\n                        virDomainInputDefPtr dev)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret = 0;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_INPUT_TYPE_PASSTHROUGH:\n        VIR_DEBUG(\"Process path '%s' for input device\", dev->source.evdev);\n        ret = virCgroupDenyDevicePath(priv->cgroup, dev->source.evdev,\n                                      VIR_CGROUP_DEVICE_RWM, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\", dev->source.evdev, \"rwm\", ret);\n        break;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuSetupInputCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "360-380",
    "snippet": "int\nqemuSetupInputCgroup(virDomainObjPtr vm,\n                     virDomainInputDefPtr dev)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret = 0;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_INPUT_TYPE_PASSTHROUGH:\n        VIR_DEBUG(\"Process path '%s' for input device\", dev->source.evdev);\n        ret = virCgroupAllowDevicePath(priv->cgroup, dev->source.evdev,\n                                       VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", dev->source.evdev, \"rw\", ret);\n        break;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditCgroupPath",
          "args": [
            "vm",
            "priv->cgroup",
            "\"allow\"",
            "dev->source.evdev",
            "\"rw\"",
            "ret"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroupPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "658-687",
          "snippet": "void\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupAllowDevicePath",
          "args": [
            "priv->cgroup",
            "dev->source.evdev",
            "VIR_CGROUP_DEVICE_RW",
            "false"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3291-3300",
          "snippet": "int\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Process path '%s' for input device\"",
            "dev->source.evdev"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupInputCgroup(virDomainObjPtr vm,\n                     virDomainInputDefPtr dev)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret = 0;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_INPUT_TYPE_PASSTHROUGH:\n        VIR_DEBUG(\"Process path '%s' for input device\", dev->source.evdev);\n        ret = virCgroupAllowDevicePath(priv->cgroup, dev->source.evdev,\n                                       VIR_CGROUP_DEVICE_RW, false);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", dev->source.evdev, \"rw\", ret);\n        break;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuSetupTPMCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "341-357",
    "snippet": "static int\nqemuSetupTPMCgroup(virDomainObjPtr vm)\n{\n    int ret = 0;\n    virDomainTPMDefPtr dev = vm->def->tpm;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_TPM_TYPE_PASSTHROUGH:\n        ret = qemuSetupChrSourceCgroup(vm, &dev->data.passthrough.source);\n        break;\n    case VIR_DOMAIN_TPM_TYPE_EMULATOR:\n    case VIR_DOMAIN_TPM_TYPE_LAST:\n        break;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuSetupChrSourceCgroup",
          "args": [
            "vm",
            "&dev->data.passthrough.source"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupChrSourceCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "282-303",
          "snippet": "static int\nqemuSetupChrSourceCgroup(virDomainObjPtr vm,\n                         virDomainChrSourceDefPtr source)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (source->type != VIR_DOMAIN_CHR_TYPE_DEV)\n        return 0;\n\n    VIR_DEBUG(\"Process path '%s' for device\", source->data.file.path);\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, source->data.file.path,\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                             source->data.file.path, \"rw\", ret);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupChrSourceCgroup(virDomainObjPtr vm,\n                         virDomainChrSourceDefPtr source)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (source->type != VIR_DOMAIN_CHR_TYPE_DEV)\n        return 0;\n\n    VIR_DEBUG(\"Process path '%s' for device\", source->data.file.path);\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, source->data.file.path,\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                             source->data.file.path, \"rw\", ret);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupTPMCgroup(virDomainObjPtr vm)\n{\n    int ret = 0;\n    virDomainTPMDefPtr dev = vm->def->tpm;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_TPM_TYPE_PASSTHROUGH:\n        ret = qemuSetupChrSourceCgroup(vm, &dev->data.passthrough.source);\n        break;\n    case VIR_DOMAIN_TPM_TYPE_EMULATOR:\n    case VIR_DOMAIN_TPM_TYPE_LAST:\n        break;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuSetupChardevCgroupCB",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "330-338",
    "snippet": "static int\nqemuSetupChardevCgroupCB(virDomainDefPtr def G_GNUC_UNUSED,\n                         virDomainChrDefPtr dev,\n                         void *opaque)\n{\n    virDomainObjPtr vm = opaque;\n\n    return qemuSetupChrSourceCgroup(vm, dev->source);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuSetupChrSourceCgroup",
          "args": [
            "vm",
            "dev->source"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupChrSourceCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "282-303",
          "snippet": "static int\nqemuSetupChrSourceCgroup(virDomainObjPtr vm,\n                         virDomainChrSourceDefPtr source)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (source->type != VIR_DOMAIN_CHR_TYPE_DEV)\n        return 0;\n\n    VIR_DEBUG(\"Process path '%s' for device\", source->data.file.path);\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, source->data.file.path,\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                             source->data.file.path, \"rw\", ret);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupChrSourceCgroup(virDomainObjPtr vm,\n                         virDomainChrSourceDefPtr source)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (source->type != VIR_DOMAIN_CHR_TYPE_DEV)\n        return 0;\n\n    VIR_DEBUG(\"Process path '%s' for device\", source->data.file.path);\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, source->data.file.path,\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                             source->data.file.path, \"rw\", ret);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupChardevCgroupCB(virDomainDefPtr def G_GNUC_UNUSED,\n                         virDomainChrDefPtr dev,\n                         void *opaque)\n{\n    virDomainObjPtr vm = opaque;\n\n    return qemuSetupChrSourceCgroup(vm, dev->source);\n}"
  },
  {
    "function_name": "qemuTeardownChrSourceCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "306-327",
    "snippet": "static int\nqemuTeardownChrSourceCgroup(virDomainObjPtr vm,\n                            virDomainChrSourceDefPtr source)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (source->type != VIR_DOMAIN_CHR_TYPE_DEV)\n        return 0;\n\n    VIR_DEBUG(\"Process path '%s' for device\", source->data.file.path);\n\n    ret = virCgroupDenyDevicePath(priv->cgroup, source->data.file.path,\n                                  VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\",\n                             source->data.file.path, \"rw\", ret);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditCgroupPath",
          "args": [
            "vm",
            "priv->cgroup",
            "\"deny\"",
            "source->data.file.path",
            "\"rw\"",
            "ret"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroupPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "658-687",
          "snippet": "void\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupDenyDevicePath",
          "args": [
            "priv->cgroup",
            "source->data.file.path",
            "VIR_CGROUP_DEVICE_RW",
            "false"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDenyDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3316-3325",
          "snippet": "int\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Process path '%s' for device\"",
            "source->data.file.path"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuTeardownChrSourceCgroup(virDomainObjPtr vm,\n                            virDomainChrSourceDefPtr source)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (source->type != VIR_DOMAIN_CHR_TYPE_DEV)\n        return 0;\n\n    VIR_DEBUG(\"Process path '%s' for device\", source->data.file.path);\n\n    ret = virCgroupDenyDevicePath(priv->cgroup, source->data.file.path,\n                                  VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\",\n                             source->data.file.path, \"rw\", ret);\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuSetupChrSourceCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "282-303",
    "snippet": "static int\nqemuSetupChrSourceCgroup(virDomainObjPtr vm,\n                         virDomainChrSourceDefPtr source)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (source->type != VIR_DOMAIN_CHR_TYPE_DEV)\n        return 0;\n\n    VIR_DEBUG(\"Process path '%s' for device\", source->data.file.path);\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, source->data.file.path,\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                             source->data.file.path, \"rw\", ret);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditCgroupPath",
          "args": [
            "vm",
            "priv->cgroup",
            "\"allow\"",
            "source->data.file.path",
            "\"rw\"",
            "ret"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroupPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "658-687",
          "snippet": "void\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupAllowDevicePath",
          "args": [
            "priv->cgroup",
            "source->data.file.path",
            "VIR_CGROUP_DEVICE_RW",
            "false"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3291-3300",
          "snippet": "int\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Process path '%s' for device\"",
            "source->data.file.path"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupChrSourceCgroup(virDomainObjPtr vm,\n                         virDomainChrSourceDefPtr source)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (source->type != VIR_DOMAIN_CHR_TYPE_DEV)\n        return 0;\n\n    VIR_DEBUG(\"Process path '%s' for device\", source->data.file.path);\n\n    ret = virCgroupAllowDevicePath(priv->cgroup, source->data.file.path,\n                                   VIR_CGROUP_DEVICE_RW, false);\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\",\n                             source->data.file.path, \"rw\", ret);\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuTeardownImageChainCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "267-279",
    "snippet": "int\nqemuTeardownImageChainCgroup(virDomainObjPtr vm,\n                             virStorageSourcePtr src)\n{\n    virStorageSourcePtr next;\n\n    for (next = src; virStorageSourceIsBacking(next); next = next->backingStore) {\n        if (qemuTeardownImageCgroup(vm, next) < 0)\n            return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuTeardownImageCgroup",
          "args": [
            "vm",
            "next"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "qemuTeardownImageCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "165-245",
          "snippet": "int\nqemuTeardownImageCgroup(virDomainObjPtr vm,\n                        virStorageSourcePtr src)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    g_autofree char *path = NULL;\n    int perms = VIR_CGROUP_DEVICE_RWM;\n    bool hasPR = false;\n    bool hasNVMe = false;\n    size_t i;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup,\n                                VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    for (i = 0; i < vm->def->ndisks; i++) {\n        virStorageSourcePtr diskSrc = vm->def->disks[i]->src;\n\n        if (src == diskSrc)\n            continue;\n\n        if (virStoragePRDefIsManaged(diskSrc->pr))\n            hasPR = true;\n\n        if (virStorageSourceChainHasNVMe(diskSrc))\n            hasNVMe = true;\n    }\n\n    if (src->type == VIR_STORAGE_TYPE_NVME) {\n        if (!(path = virPCIDeviceAddressGetIOMMUGroupDev(&src->nvme->pciAddr)))\n            return -1;\n\n        if (!hasNVMe &&\n            !qemuDomainNeedsVFIO(vm->def)) {\n            ret = virCgroupDenyDevicePath(priv->cgroup, QEMU_DEV_VFIO, perms, true);\n            virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\",\n                                     QEMU_DEV_VFIO,\n                                     virCgroupGetDevicePermsString(perms), ret);\n            if (ret < 0)\n                return -1;\n        }\n    } else {\n        if (!src->path || !virStorageSourceIsLocalStorage(src)) {\n            VIR_DEBUG(\"Not updating cgroups for disk path '%s', type: %s\",\n                      NULLSTR(src->path), virStorageTypeToString(src->type));\n            return 0;\n        }\n\n        path = g_strdup(src->path);\n    }\n\n    if (!hasPR &&\n        virFileExists(QEMU_DEVICE_MAPPER_CONTROL_PATH)) {\n        VIR_DEBUG(\"Disabling device mapper control\");\n        ret = virCgroupDenyDevicePath(priv->cgroup,\n                                      QEMU_DEVICE_MAPPER_CONTROL_PATH,\n                                      perms, true);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\",\n                                 QEMU_DEVICE_MAPPER_CONTROL_PATH,\n                                 virCgroupGetDevicePermsString(perms), ret);\n        if (ret < 0)\n            return ret;\n    }\n\n    VIR_DEBUG(\"Deny path %s\", path);\n\n    ret = virCgroupDenyDevicePath(priv->cgroup, path, perms, true);\n\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\", path,\n                             virCgroupGetDevicePermsString(perms), ret);\n\n    /* If you're looking for a counter part to\n     * qemuSetupImagePathCgroup you're at the right place.\n     * However, we can't just blindly deny all the device mapper\n     * targets of src->path because they might still be used by\n     * another disk in domain. Just like we are not removing\n     * disks from namespace. */\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuTeardownImageCgroup(virDomainObjPtr vm,\n                        virStorageSourcePtr src)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    g_autofree char *path = NULL;\n    int perms = VIR_CGROUP_DEVICE_RWM;\n    bool hasPR = false;\n    bool hasNVMe = false;\n    size_t i;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup,\n                                VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    for (i = 0; i < vm->def->ndisks; i++) {\n        virStorageSourcePtr diskSrc = vm->def->disks[i]->src;\n\n        if (src == diskSrc)\n            continue;\n\n        if (virStoragePRDefIsManaged(diskSrc->pr))\n            hasPR = true;\n\n        if (virStorageSourceChainHasNVMe(diskSrc))\n            hasNVMe = true;\n    }\n\n    if (src->type == VIR_STORAGE_TYPE_NVME) {\n        if (!(path = virPCIDeviceAddressGetIOMMUGroupDev(&src->nvme->pciAddr)))\n            return -1;\n\n        if (!hasNVMe &&\n            !qemuDomainNeedsVFIO(vm->def)) {\n            ret = virCgroupDenyDevicePath(priv->cgroup, QEMU_DEV_VFIO, perms, true);\n            virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\",\n                                     QEMU_DEV_VFIO,\n                                     virCgroupGetDevicePermsString(perms), ret);\n            if (ret < 0)\n                return -1;\n        }\n    } else {\n        if (!src->path || !virStorageSourceIsLocalStorage(src)) {\n            VIR_DEBUG(\"Not updating cgroups for disk path '%s', type: %s\",\n                      NULLSTR(src->path), virStorageTypeToString(src->type));\n            return 0;\n        }\n\n        path = g_strdup(src->path);\n    }\n\n    if (!hasPR &&\n        virFileExists(QEMU_DEVICE_MAPPER_CONTROL_PATH)) {\n        VIR_DEBUG(\"Disabling device mapper control\");\n        ret = virCgroupDenyDevicePath(priv->cgroup,\n                                      QEMU_DEVICE_MAPPER_CONTROL_PATH,\n                                      perms, true);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\",\n                                 QEMU_DEVICE_MAPPER_CONTROL_PATH,\n                                 virCgroupGetDevicePermsString(perms), ret);\n        if (ret < 0)\n            return ret;\n    }\n\n    VIR_DEBUG(\"Deny path %s\", path);\n\n    ret = virCgroupDenyDevicePath(priv->cgroup, path, perms, true);\n\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\", path,\n                             virCgroupGetDevicePermsString(perms), ret);\n\n    /* If you're looking for a counter part to\n     * qemuSetupImagePathCgroup you're at the right place.\n     * However, we can't just blindly deny all the device mapper\n     * targets of src->path because they might still be used by\n     * another disk in domain. Just like we are not removing\n     * disks from namespace. */\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsBacking",
          "args": [
            "next"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsBacking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "1581-1585",
          "snippet": "bool\nvirStorageSourceIsBacking(const virStorageSource *src)\n{\n    return src && src->type != VIR_STORAGE_TYPE_NONE;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsBacking(const virStorageSource *src)\n{\n    return src && src->type != VIR_STORAGE_TYPE_NONE;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuTeardownImageChainCgroup(virDomainObjPtr vm,\n                             virStorageSourcePtr src)\n{\n    virStorageSourcePtr next;\n\n    for (next = src; virStorageSourceIsBacking(next); next = next->backingStore) {\n        if (qemuTeardownImageCgroup(vm, next) < 0)\n            return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuSetupImageChainCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "248-264",
    "snippet": "int\nqemuSetupImageChainCgroup(virDomainObjPtr vm,\n                          virStorageSourcePtr src)\n{\n    virStorageSourcePtr next;\n    bool forceReadonly = false;\n\n    for (next = src; virStorageSourceIsBacking(next); next = next->backingStore) {\n        if (qemuSetupImageCgroupInternal(vm, next, forceReadonly) < 0)\n            return -1;\n\n        /* setup only the top level image for read-write */\n        forceReadonly = true;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuSetupImageCgroupInternal",
          "args": [
            "vm",
            "next",
            "forceReadonly"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupImageCgroupInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "118-154",
          "snippet": "static int\nqemuSetupImageCgroupInternal(virDomainObjPtr vm,\n                             virStorageSourcePtr src,\n                             bool forceReadonly)\n{\n    g_autofree char *path = NULL;\n    bool readonly = src->readonly || forceReadonly;\n\n    if (src->type == VIR_STORAGE_TYPE_NVME) {\n        /* Even though disk is R/O we can't make it so in\n         * CGroups. QEMU will try to do some ioctl()-s over the\n         * device and such operations are considered R/W by the\n         * kernel */\n        readonly = false;\n\n        if (!(path = virPCIDeviceAddressGetIOMMUGroupDev(&src->nvme->pciAddr)))\n            return -1;\n\n        if (qemuSetupImagePathCgroup(vm, QEMU_DEV_VFIO, false) < 0)\n            return -1;\n    } else {\n        if (!src->path || !virStorageSourceIsLocalStorage(src)) {\n            VIR_DEBUG(\"Not updating cgroups for disk path '%s', type: %s\",\n                      NULLSTR(src->path), virStorageTypeToString(src->type));\n            return 0;\n        }\n\n        path = g_strdup(src->path);\n    }\n\n    if (virStoragePRDefIsManaged(src->pr) &&\n        virFileExists(QEMU_DEVICE_MAPPER_CONTROL_PATH) &&\n        qemuSetupImagePathCgroup(vm, QEMU_DEVICE_MAPPER_CONTROL_PATH, false) < 0)\n        return -1;\n\n    return qemuSetupImagePathCgroup(vm, path, readonly);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupImageCgroupInternal(virDomainObjPtr vm,\n                             virStorageSourcePtr src,\n                             bool forceReadonly)\n{\n    g_autofree char *path = NULL;\n    bool readonly = src->readonly || forceReadonly;\n\n    if (src->type == VIR_STORAGE_TYPE_NVME) {\n        /* Even though disk is R/O we can't make it so in\n         * CGroups. QEMU will try to do some ioctl()-s over the\n         * device and such operations are considered R/W by the\n         * kernel */\n        readonly = false;\n\n        if (!(path = virPCIDeviceAddressGetIOMMUGroupDev(&src->nvme->pciAddr)))\n            return -1;\n\n        if (qemuSetupImagePathCgroup(vm, QEMU_DEV_VFIO, false) < 0)\n            return -1;\n    } else {\n        if (!src->path || !virStorageSourceIsLocalStorage(src)) {\n            VIR_DEBUG(\"Not updating cgroups for disk path '%s', type: %s\",\n                      NULLSTR(src->path), virStorageTypeToString(src->type));\n            return 0;\n        }\n\n        path = g_strdup(src->path);\n    }\n\n    if (virStoragePRDefIsManaged(src->pr) &&\n        virFileExists(QEMU_DEVICE_MAPPER_CONTROL_PATH) &&\n        qemuSetupImagePathCgroup(vm, QEMU_DEVICE_MAPPER_CONTROL_PATH, false) < 0)\n        return -1;\n\n    return qemuSetupImagePathCgroup(vm, path, readonly);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsBacking",
          "args": [
            "next"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsBacking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "1581-1585",
          "snippet": "bool\nvirStorageSourceIsBacking(const virStorageSource *src)\n{\n    return src && src->type != VIR_STORAGE_TYPE_NONE;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsBacking(const virStorageSource *src)\n{\n    return src && src->type != VIR_STORAGE_TYPE_NONE;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupImageChainCgroup(virDomainObjPtr vm,\n                          virStorageSourcePtr src)\n{\n    virStorageSourcePtr next;\n    bool forceReadonly = false;\n\n    for (next = src; virStorageSourceIsBacking(next); next = next->backingStore) {\n        if (qemuSetupImageCgroupInternal(vm, next, forceReadonly) < 0)\n            return -1;\n\n        /* setup only the top level image for read-write */\n        forceReadonly = true;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuTeardownImageCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "165-245",
    "snippet": "int\nqemuTeardownImageCgroup(virDomainObjPtr vm,\n                        virStorageSourcePtr src)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    g_autofree char *path = NULL;\n    int perms = VIR_CGROUP_DEVICE_RWM;\n    bool hasPR = false;\n    bool hasNVMe = false;\n    size_t i;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup,\n                                VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    for (i = 0; i < vm->def->ndisks; i++) {\n        virStorageSourcePtr diskSrc = vm->def->disks[i]->src;\n\n        if (src == diskSrc)\n            continue;\n\n        if (virStoragePRDefIsManaged(diskSrc->pr))\n            hasPR = true;\n\n        if (virStorageSourceChainHasNVMe(diskSrc))\n            hasNVMe = true;\n    }\n\n    if (src->type == VIR_STORAGE_TYPE_NVME) {\n        if (!(path = virPCIDeviceAddressGetIOMMUGroupDev(&src->nvme->pciAddr)))\n            return -1;\n\n        if (!hasNVMe &&\n            !qemuDomainNeedsVFIO(vm->def)) {\n            ret = virCgroupDenyDevicePath(priv->cgroup, QEMU_DEV_VFIO, perms, true);\n            virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\",\n                                     QEMU_DEV_VFIO,\n                                     virCgroupGetDevicePermsString(perms), ret);\n            if (ret < 0)\n                return -1;\n        }\n    } else {\n        if (!src->path || !virStorageSourceIsLocalStorage(src)) {\n            VIR_DEBUG(\"Not updating cgroups for disk path '%s', type: %s\",\n                      NULLSTR(src->path), virStorageTypeToString(src->type));\n            return 0;\n        }\n\n        path = g_strdup(src->path);\n    }\n\n    if (!hasPR &&\n        virFileExists(QEMU_DEVICE_MAPPER_CONTROL_PATH)) {\n        VIR_DEBUG(\"Disabling device mapper control\");\n        ret = virCgroupDenyDevicePath(priv->cgroup,\n                                      QEMU_DEVICE_MAPPER_CONTROL_PATH,\n                                      perms, true);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\",\n                                 QEMU_DEVICE_MAPPER_CONTROL_PATH,\n                                 virCgroupGetDevicePermsString(perms), ret);\n        if (ret < 0)\n            return ret;\n    }\n\n    VIR_DEBUG(\"Deny path %s\", path);\n\n    ret = virCgroupDenyDevicePath(priv->cgroup, path, perms, true);\n\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\", path,\n                             virCgroupGetDevicePermsString(perms), ret);\n\n    /* If you're looking for a counter part to\n     * qemuSetupImagePathCgroup you're at the right place.\n     * However, we can't just blindly deny all the device mapper\n     * targets of src->path because they might still be used by\n     * another disk in domain. Just like we are not removing\n     * disks from namespace. */\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditCgroupPath",
          "args": [
            "vm",
            "priv->cgroup",
            "\"deny\"",
            "path",
            "virCgroupGetDevicePermsString(perms)",
            "ret"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroupPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "658-687",
          "snippet": "void\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetDevicePermsString",
          "args": [
            "perms"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetDevicePermsString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "74-102",
          "snippet": "const char *\nvirCgroupGetDevicePermsString(int perms)\n{\n    if (perms & VIR_CGROUP_DEVICE_READ) {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rwm\";\n            else\n                return \"rw\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rm\";\n            else\n                return \"r\";\n        }\n    } else {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"wm\";\n            else\n                return \"w\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"m\";\n            else\n                return \"\";\n        }\n    }\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nconst char *\nvirCgroupGetDevicePermsString(int perms)\n{\n    if (perms & VIR_CGROUP_DEVICE_READ) {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rwm\";\n            else\n                return \"rw\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rm\";\n            else\n                return \"r\";\n        }\n    } else {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"wm\";\n            else\n                return \"w\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"m\";\n            else\n                return \"\";\n        }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupDenyDevicePath",
          "args": [
            "priv->cgroup",
            "path",
            "perms",
            "true"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDenyDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3316-3325",
          "snippet": "int\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Deny path %s\"",
            "path"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Disabling device mapper control\""
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "QEMU_DEVICE_MAPPER_CONTROL_PATH"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "src->path"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Not updating cgroups for disk path '%s', type: %s\"",
            "NULLSTR(src->path)",
            "virStorageTypeToString(src->type)"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageTypeToString",
          "args": [
            "src->type"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "src->path"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsLocalStorage",
          "args": [
            "src"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsLocalStorage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2586-2608",
          "snippet": "bool\nvirStorageSourceIsLocalStorage(const virStorageSource *src)\n{\n    virStorageType type = virStorageSourceGetActualType(src);\n\n    switch (type) {\n    case VIR_STORAGE_TYPE_FILE:\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_DIR:\n        return true;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n    case VIR_STORAGE_TYPE_VOLUME:\n        /* While NVMe disks are local, they are not accessible via src->path.\n         * Therefore, we have to return false here. */\n    case VIR_STORAGE_TYPE_NVME:\n    case VIR_STORAGE_TYPE_LAST:\n    case VIR_STORAGE_TYPE_NONE:\n        return false;\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsLocalStorage(const virStorageSource *src)\n{\n    virStorageType type = virStorageSourceGetActualType(src);\n\n    switch (type) {\n    case VIR_STORAGE_TYPE_FILE:\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_DIR:\n        return true;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n    case VIR_STORAGE_TYPE_VOLUME:\n        /* While NVMe disks are local, they are not accessible via src->path.\n         * Therefore, we have to return false here. */\n    case VIR_STORAGE_TYPE_NVME:\n    case VIR_STORAGE_TYPE_LAST:\n    case VIR_STORAGE_TYPE_NONE:\n        return false;\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainNeedsVFIO",
          "args": [
            "vm->def"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainNeedsVFIO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "14232-14238",
          "snippet": "bool\nqemuDomainNeedsVFIO(const virDomainDef *def)\n{\n    return virDomainDefHasVFIOHostdev(def) ||\n        virDomainDefHasMdevHostdev(def) ||\n        virDomainDefHasNVMeDisk(def);\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nbool\nqemuDomainNeedsVFIO(const virDomainDef *def)\n{\n    return virDomainDefHasVFIOHostdev(def) ||\n        virDomainDefHasMdevHostdev(def) ||\n        virDomainDefHasNVMeDisk(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceAddressGetIOMMUGroupDev",
          "args": [
            "&src->nvme->pciAddr"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressGetIOMMUGroupDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1953-1965",
          "snippet": "char *\nvirPCIDeviceAddressGetIOMMUGroupDev(const virPCIDeviceAddress *devAddr)\n{\n    g_autoptr(virPCIDevice) pci = NULL;\n\n    if (!(pci = virPCIDeviceNew(devAddr->domain,\n                                devAddr->bus,\n                                devAddr->slot,\n                                devAddr->function)))\n        return NULL;\n\n    return virPCIDeviceGetIOMMUGroupDev(pci);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nchar *\nvirPCIDeviceAddressGetIOMMUGroupDev(const virPCIDeviceAddress *devAddr)\n{\n    g_autoptr(virPCIDevice) pci = NULL;\n\n    if (!(pci = virPCIDeviceNew(devAddr->domain,\n                                devAddr->bus,\n                                devAddr->slot,\n                                devAddr->function)))\n        return NULL;\n\n    return virPCIDeviceGetIOMMUGroupDev(pci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceChainHasNVMe",
          "args": [
            "diskSrc"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceChainHasNVMe",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2091-2102",
          "snippet": "bool\nvirStorageSourceChainHasNVMe(const virStorageSource *src)\n{\n    const virStorageSource *n;\n\n    for (n = src; virStorageSourceIsBacking(n); n = n->backingStore) {\n        if (n->type == VIR_STORAGE_TYPE_NVME)\n            return true;\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceChainHasNVMe(const virStorageSource *src)\n{\n    const virStorageSource *n;\n\n    for (n = src; virStorageSourceIsBacking(n); n = n->backingStore) {\n        if (n->type == VIR_STORAGE_TYPE_NVME)\n            return true;\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePRDefIsManaged",
          "args": [
            "diskSrc->pr"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePRDefIsManaged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2006-2010",
          "snippet": "bool\nvirStoragePRDefIsManaged(virStoragePRDefPtr prd)\n{\n    return prd && prd->managed == VIR_TRISTATE_BOOL_YES;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStoragePRDefIsManaged(virStoragePRDefPtr prd)\n{\n    return prd && prd->managed == VIR_TRISTATE_BOOL_YES;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuTeardownImageCgroup(virDomainObjPtr vm,\n                        virStorageSourcePtr src)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    g_autofree char *path = NULL;\n    int perms = VIR_CGROUP_DEVICE_RWM;\n    bool hasPR = false;\n    bool hasNVMe = false;\n    size_t i;\n    int ret;\n\n    if (!virCgroupHasController(priv->cgroup,\n                                VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    for (i = 0; i < vm->def->ndisks; i++) {\n        virStorageSourcePtr diskSrc = vm->def->disks[i]->src;\n\n        if (src == diskSrc)\n            continue;\n\n        if (virStoragePRDefIsManaged(diskSrc->pr))\n            hasPR = true;\n\n        if (virStorageSourceChainHasNVMe(diskSrc))\n            hasNVMe = true;\n    }\n\n    if (src->type == VIR_STORAGE_TYPE_NVME) {\n        if (!(path = virPCIDeviceAddressGetIOMMUGroupDev(&src->nvme->pciAddr)))\n            return -1;\n\n        if (!hasNVMe &&\n            !qemuDomainNeedsVFIO(vm->def)) {\n            ret = virCgroupDenyDevicePath(priv->cgroup, QEMU_DEV_VFIO, perms, true);\n            virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\",\n                                     QEMU_DEV_VFIO,\n                                     virCgroupGetDevicePermsString(perms), ret);\n            if (ret < 0)\n                return -1;\n        }\n    } else {\n        if (!src->path || !virStorageSourceIsLocalStorage(src)) {\n            VIR_DEBUG(\"Not updating cgroups for disk path '%s', type: %s\",\n                      NULLSTR(src->path), virStorageTypeToString(src->type));\n            return 0;\n        }\n\n        path = g_strdup(src->path);\n    }\n\n    if (!hasPR &&\n        virFileExists(QEMU_DEVICE_MAPPER_CONTROL_PATH)) {\n        VIR_DEBUG(\"Disabling device mapper control\");\n        ret = virCgroupDenyDevicePath(priv->cgroup,\n                                      QEMU_DEVICE_MAPPER_CONTROL_PATH,\n                                      perms, true);\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\",\n                                 QEMU_DEVICE_MAPPER_CONTROL_PATH,\n                                 virCgroupGetDevicePermsString(perms), ret);\n        if (ret < 0)\n            return ret;\n    }\n\n    VIR_DEBUG(\"Deny path %s\", path);\n\n    ret = virCgroupDenyDevicePath(priv->cgroup, path, perms, true);\n\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"deny\", path,\n                             virCgroupGetDevicePermsString(perms), ret);\n\n    /* If you're looking for a counter part to\n     * qemuSetupImagePathCgroup you're at the right place.\n     * However, we can't just blindly deny all the device mapper\n     * targets of src->path because they might still be used by\n     * another disk in domain. Just like we are not removing\n     * disks from namespace. */\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuSetupImageCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "157-162",
    "snippet": "int\nqemuSetupImageCgroup(virDomainObjPtr vm,\n                     virStorageSourcePtr src)\n{\n    return qemuSetupImageCgroupInternal(vm, src, false);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuSetupImageCgroupInternal",
          "args": [
            "vm",
            "src",
            "false"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupImageCgroupInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "118-154",
          "snippet": "static int\nqemuSetupImageCgroupInternal(virDomainObjPtr vm,\n                             virStorageSourcePtr src,\n                             bool forceReadonly)\n{\n    g_autofree char *path = NULL;\n    bool readonly = src->readonly || forceReadonly;\n\n    if (src->type == VIR_STORAGE_TYPE_NVME) {\n        /* Even though disk is R/O we can't make it so in\n         * CGroups. QEMU will try to do some ioctl()-s over the\n         * device and such operations are considered R/W by the\n         * kernel */\n        readonly = false;\n\n        if (!(path = virPCIDeviceAddressGetIOMMUGroupDev(&src->nvme->pciAddr)))\n            return -1;\n\n        if (qemuSetupImagePathCgroup(vm, QEMU_DEV_VFIO, false) < 0)\n            return -1;\n    } else {\n        if (!src->path || !virStorageSourceIsLocalStorage(src)) {\n            VIR_DEBUG(\"Not updating cgroups for disk path '%s', type: %s\",\n                      NULLSTR(src->path), virStorageTypeToString(src->type));\n            return 0;\n        }\n\n        path = g_strdup(src->path);\n    }\n\n    if (virStoragePRDefIsManaged(src->pr) &&\n        virFileExists(QEMU_DEVICE_MAPPER_CONTROL_PATH) &&\n        qemuSetupImagePathCgroup(vm, QEMU_DEVICE_MAPPER_CONTROL_PATH, false) < 0)\n        return -1;\n\n    return qemuSetupImagePathCgroup(vm, path, readonly);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupImageCgroupInternal(virDomainObjPtr vm,\n                             virStorageSourcePtr src,\n                             bool forceReadonly)\n{\n    g_autofree char *path = NULL;\n    bool readonly = src->readonly || forceReadonly;\n\n    if (src->type == VIR_STORAGE_TYPE_NVME) {\n        /* Even though disk is R/O we can't make it so in\n         * CGroups. QEMU will try to do some ioctl()-s over the\n         * device and such operations are considered R/W by the\n         * kernel */\n        readonly = false;\n\n        if (!(path = virPCIDeviceAddressGetIOMMUGroupDev(&src->nvme->pciAddr)))\n            return -1;\n\n        if (qemuSetupImagePathCgroup(vm, QEMU_DEV_VFIO, false) < 0)\n            return -1;\n    } else {\n        if (!src->path || !virStorageSourceIsLocalStorage(src)) {\n            VIR_DEBUG(\"Not updating cgroups for disk path '%s', type: %s\",\n                      NULLSTR(src->path), virStorageTypeToString(src->type));\n            return 0;\n        }\n\n        path = g_strdup(src->path);\n    }\n\n    if (virStoragePRDefIsManaged(src->pr) &&\n        virFileExists(QEMU_DEVICE_MAPPER_CONTROL_PATH) &&\n        qemuSetupImagePathCgroup(vm, QEMU_DEVICE_MAPPER_CONTROL_PATH, false) < 0)\n        return -1;\n\n    return qemuSetupImagePathCgroup(vm, path, readonly);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nint\nqemuSetupImageCgroup(virDomainObjPtr vm,\n                     virStorageSourcePtr src)\n{\n    return qemuSetupImageCgroupInternal(vm, src, false);\n}"
  },
  {
    "function_name": "qemuSetupImageCgroupInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "118-154",
    "snippet": "static int\nqemuSetupImageCgroupInternal(virDomainObjPtr vm,\n                             virStorageSourcePtr src,\n                             bool forceReadonly)\n{\n    g_autofree char *path = NULL;\n    bool readonly = src->readonly || forceReadonly;\n\n    if (src->type == VIR_STORAGE_TYPE_NVME) {\n        /* Even though disk is R/O we can't make it so in\n         * CGroups. QEMU will try to do some ioctl()-s over the\n         * device and such operations are considered R/W by the\n         * kernel */\n        readonly = false;\n\n        if (!(path = virPCIDeviceAddressGetIOMMUGroupDev(&src->nvme->pciAddr)))\n            return -1;\n\n        if (qemuSetupImagePathCgroup(vm, QEMU_DEV_VFIO, false) < 0)\n            return -1;\n    } else {\n        if (!src->path || !virStorageSourceIsLocalStorage(src)) {\n            VIR_DEBUG(\"Not updating cgroups for disk path '%s', type: %s\",\n                      NULLSTR(src->path), virStorageTypeToString(src->type));\n            return 0;\n        }\n\n        path = g_strdup(src->path);\n    }\n\n    if (virStoragePRDefIsManaged(src->pr) &&\n        virFileExists(QEMU_DEVICE_MAPPER_CONTROL_PATH) &&\n        qemuSetupImagePathCgroup(vm, QEMU_DEVICE_MAPPER_CONTROL_PATH, false) < 0)\n        return -1;\n\n    return qemuSetupImagePathCgroup(vm, path, readonly);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuSetupImagePathCgroup",
          "args": [
            "vm",
            "path",
            "readonly"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSetupImagePathCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
          "lines": "58-115",
          "snippet": "static int\nqemuSetupImagePathCgroup(virDomainObjPtr vm,\n                         const char *path,\n                         bool readonly)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int perms = VIR_CGROUP_DEVICE_READ;\n    char **targetPaths = NULL;\n    size_t i;\n    int rv;\n    int ret = -1;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (!readonly)\n        perms |= VIR_CGROUP_DEVICE_WRITE;\n\n    VIR_DEBUG(\"Allow path %s, perms: %s\",\n              path, virCgroupGetDevicePermsString(perms));\n\n    rv = virCgroupAllowDevicePath(priv->cgroup, path, perms, true);\n\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", path,\n                             virCgroupGetDevicePermsString(perms),\n                             rv);\n    if (rv < 0)\n        goto cleanup;\n\n    if (rv > 0) {\n        /* @path is neither character device nor block device. */\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (virDevMapperGetTargets(path, &targetPaths) < 0 &&\n        errno != ENOSYS && errno != EBADF) {\n        virReportSystemError(errno,\n                             _(\"Unable to get devmapper targets for %s\"),\n                             path);\n        goto cleanup;\n    }\n\n    for (i = 0; targetPaths && targetPaths[i]; i++) {\n        rv = virCgroupAllowDevicePath(priv->cgroup, targetPaths[i], perms, false);\n\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", targetPaths[i],\n                                 virCgroupGetDevicePermsString(perms),\n                                 rv);\n        if (rv < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virStringListFree(targetPaths);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virdevmapper.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnuma.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsi.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupImagePathCgroup(virDomainObjPtr vm,\n                         const char *path,\n                         bool readonly)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int perms = VIR_CGROUP_DEVICE_READ;\n    char **targetPaths = NULL;\n    size_t i;\n    int rv;\n    int ret = -1;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (!readonly)\n        perms |= VIR_CGROUP_DEVICE_WRITE;\n\n    VIR_DEBUG(\"Allow path %s, perms: %s\",\n              path, virCgroupGetDevicePermsString(perms));\n\n    rv = virCgroupAllowDevicePath(priv->cgroup, path, perms, true);\n\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", path,\n                             virCgroupGetDevicePermsString(perms),\n                             rv);\n    if (rv < 0)\n        goto cleanup;\n\n    if (rv > 0) {\n        /* @path is neither character device nor block device. */\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (virDevMapperGetTargets(path, &targetPaths) < 0 &&\n        errno != ENOSYS && errno != EBADF) {\n        virReportSystemError(errno,\n                             _(\"Unable to get devmapper targets for %s\"),\n                             path);\n        goto cleanup;\n    }\n\n    for (i = 0; targetPaths && targetPaths[i]; i++) {\n        rv = virCgroupAllowDevicePath(priv->cgroup, targetPaths[i], perms, false);\n\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", targetPaths[i],\n                                 virCgroupGetDevicePermsString(perms),\n                                 rv);\n        if (rv < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virStringListFree(targetPaths);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "QEMU_DEVICE_MAPPER_CONTROL_PATH"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePRDefIsManaged",
          "args": [
            "src->pr"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePRDefIsManaged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2006-2010",
          "snippet": "bool\nvirStoragePRDefIsManaged(virStoragePRDefPtr prd)\n{\n    return prd && prd->managed == VIR_TRISTATE_BOOL_YES;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStoragePRDefIsManaged(virStoragePRDefPtr prd)\n{\n    return prd && prd->managed == VIR_TRISTATE_BOOL_YES;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "src->path"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Not updating cgroups for disk path '%s', type: %s\"",
            "NULLSTR(src->path)",
            "virStorageTypeToString(src->type)"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageTypeToString",
          "args": [
            "src->type"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "src->path"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsLocalStorage",
          "args": [
            "src"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsLocalStorage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2586-2608",
          "snippet": "bool\nvirStorageSourceIsLocalStorage(const virStorageSource *src)\n{\n    virStorageType type = virStorageSourceGetActualType(src);\n\n    switch (type) {\n    case VIR_STORAGE_TYPE_FILE:\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_DIR:\n        return true;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n    case VIR_STORAGE_TYPE_VOLUME:\n        /* While NVMe disks are local, they are not accessible via src->path.\n         * Therefore, we have to return false here. */\n    case VIR_STORAGE_TYPE_NVME:\n    case VIR_STORAGE_TYPE_LAST:\n    case VIR_STORAGE_TYPE_NONE:\n        return false;\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsLocalStorage(const virStorageSource *src)\n{\n    virStorageType type = virStorageSourceGetActualType(src);\n\n    switch (type) {\n    case VIR_STORAGE_TYPE_FILE:\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_DIR:\n        return true;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n    case VIR_STORAGE_TYPE_VOLUME:\n        /* While NVMe disks are local, they are not accessible via src->path.\n         * Therefore, we have to return false here. */\n    case VIR_STORAGE_TYPE_NVME:\n    case VIR_STORAGE_TYPE_LAST:\n    case VIR_STORAGE_TYPE_NONE:\n        return false;\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceAddressGetIOMMUGroupDev",
          "args": [
            "&src->nvme->pciAddr"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressGetIOMMUGroupDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1953-1965",
          "snippet": "char *\nvirPCIDeviceAddressGetIOMMUGroupDev(const virPCIDeviceAddress *devAddr)\n{\n    g_autoptr(virPCIDevice) pci = NULL;\n\n    if (!(pci = virPCIDeviceNew(devAddr->domain,\n                                devAddr->bus,\n                                devAddr->slot,\n                                devAddr->function)))\n        return NULL;\n\n    return virPCIDeviceGetIOMMUGroupDev(pci);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nchar *\nvirPCIDeviceAddressGetIOMMUGroupDev(const virPCIDeviceAddress *devAddr)\n{\n    g_autoptr(virPCIDevice) pci = NULL;\n\n    if (!(pci = virPCIDeviceNew(devAddr->domain,\n                                devAddr->bus,\n                                devAddr->slot,\n                                devAddr->function)))\n        return NULL;\n\n    return virPCIDeviceGetIOMMUGroupDev(pci);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupImageCgroupInternal(virDomainObjPtr vm,\n                             virStorageSourcePtr src,\n                             bool forceReadonly)\n{\n    g_autofree char *path = NULL;\n    bool readonly = src->readonly || forceReadonly;\n\n    if (src->type == VIR_STORAGE_TYPE_NVME) {\n        /* Even though disk is R/O we can't make it so in\n         * CGroups. QEMU will try to do some ioctl()-s over the\n         * device and such operations are considered R/W by the\n         * kernel */\n        readonly = false;\n\n        if (!(path = virPCIDeviceAddressGetIOMMUGroupDev(&src->nvme->pciAddr)))\n            return -1;\n\n        if (qemuSetupImagePathCgroup(vm, QEMU_DEV_VFIO, false) < 0)\n            return -1;\n    } else {\n        if (!src->path || !virStorageSourceIsLocalStorage(src)) {\n            VIR_DEBUG(\"Not updating cgroups for disk path '%s', type: %s\",\n                      NULLSTR(src->path), virStorageTypeToString(src->type));\n            return 0;\n        }\n\n        path = g_strdup(src->path);\n    }\n\n    if (virStoragePRDefIsManaged(src->pr) &&\n        virFileExists(QEMU_DEVICE_MAPPER_CONTROL_PATH) &&\n        qemuSetupImagePathCgroup(vm, QEMU_DEVICE_MAPPER_CONTROL_PATH, false) < 0)\n        return -1;\n\n    return qemuSetupImagePathCgroup(vm, path, readonly);\n}"
  },
  {
    "function_name": "qemuSetupImagePathCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_cgroup.c",
    "lines": "58-115",
    "snippet": "static int\nqemuSetupImagePathCgroup(virDomainObjPtr vm,\n                         const char *path,\n                         bool readonly)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int perms = VIR_CGROUP_DEVICE_READ;\n    char **targetPaths = NULL;\n    size_t i;\n    int rv;\n    int ret = -1;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (!readonly)\n        perms |= VIR_CGROUP_DEVICE_WRITE;\n\n    VIR_DEBUG(\"Allow path %s, perms: %s\",\n              path, virCgroupGetDevicePermsString(perms));\n\n    rv = virCgroupAllowDevicePath(priv->cgroup, path, perms, true);\n\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", path,\n                             virCgroupGetDevicePermsString(perms),\n                             rv);\n    if (rv < 0)\n        goto cleanup;\n\n    if (rv > 0) {\n        /* @path is neither character device nor block device. */\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (virDevMapperGetTargets(path, &targetPaths) < 0 &&\n        errno != ENOSYS && errno != EBADF) {\n        virReportSystemError(errno,\n                             _(\"Unable to get devmapper targets for %s\"),\n                             path);\n        goto cleanup;\n    }\n\n    for (i = 0; targetPaths && targetPaths[i]; i++) {\n        rv = virCgroupAllowDevicePath(priv->cgroup, targetPaths[i], perms, false);\n\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", targetPaths[i],\n                                 virCgroupGetDevicePermsString(perms),\n                                 rv);\n        if (rv < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virStringListFree(targetPaths);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virdevmapper.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virnuma.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsi.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"qemu_hostdev.h\"",
      "#include \"qemu_extdevice.h\"",
      "#include \"qemu_process.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "targetPaths"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditCgroupPath",
          "args": [
            "vm",
            "priv->cgroup",
            "\"allow\"",
            "targetPaths[i]",
            "virCgroupGetDevicePermsString(perms)",
            "rv"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroupPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "658-687",
          "snippet": "void\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetDevicePermsString",
          "args": [
            "perms"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetDevicePermsString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "74-102",
          "snippet": "const char *\nvirCgroupGetDevicePermsString(int perms)\n{\n    if (perms & VIR_CGROUP_DEVICE_READ) {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rwm\";\n            else\n                return \"rw\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rm\";\n            else\n                return \"r\";\n        }\n    } else {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"wm\";\n            else\n                return \"w\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"m\";\n            else\n                return \"\";\n        }\n    }\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nconst char *\nvirCgroupGetDevicePermsString(int perms)\n{\n    if (perms & VIR_CGROUP_DEVICE_READ) {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rwm\";\n            else\n                return \"rw\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rm\";\n            else\n                return \"r\";\n        }\n    } else {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"wm\";\n            else\n                return \"w\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"m\";\n            else\n                return \"\";\n        }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupAllowDevicePath",
          "args": [
            "priv->cgroup",
            "targetPaths[i]",
            "perms",
            "false"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3291-3300",
          "snippet": "int\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to get devmapper targets for %s\")",
            "path"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get devmapper targets for %s\""
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDevMapperGetTargets",
          "args": [
            "path",
            "&targetPaths"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "virDevMapperGetTargets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdevmapper.c",
          "lines": "197-203",
          "snippet": "int\nvirDevMapperGetTargets(const char *path G_GNUC_UNUSED,\n                       char ***devPaths G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"internal.h\"",
            "#include \"virdevmapper.h\"",
            "# include <libdevmapper.h>",
            "# include <sys/sysmacros.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"internal.h\"\n#include \"virdevmapper.h\"\n# include <libdevmapper.h>\n# include <sys/sysmacros.h>\n#include <config.h>\n\nint\nvirDevMapperGetTargets(const char *path G_GNUC_UNUSED,\n                       char ***devPaths G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Allow path %s, perms: %s\"",
            "path",
            "virCgroupGetDevicePermsString(perms)"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virdevmapper.h\"\n#include \"virsystemd.h\"\n#include \"virnuma.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virscsi.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_cgroup.h\"\n#include <config.h>\n\nstatic int\nqemuSetupImagePathCgroup(virDomainObjPtr vm,\n                         const char *path,\n                         bool readonly)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    int perms = VIR_CGROUP_DEVICE_READ;\n    char **targetPaths = NULL;\n    size_t i;\n    int rv;\n    int ret = -1;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES))\n        return 0;\n\n    if (!readonly)\n        perms |= VIR_CGROUP_DEVICE_WRITE;\n\n    VIR_DEBUG(\"Allow path %s, perms: %s\",\n              path, virCgroupGetDevicePermsString(perms));\n\n    rv = virCgroupAllowDevicePath(priv->cgroup, path, perms, true);\n\n    virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", path,\n                             virCgroupGetDevicePermsString(perms),\n                             rv);\n    if (rv < 0)\n        goto cleanup;\n\n    if (rv > 0) {\n        /* @path is neither character device nor block device. */\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (virDevMapperGetTargets(path, &targetPaths) < 0 &&\n        errno != ENOSYS && errno != EBADF) {\n        virReportSystemError(errno,\n                             _(\"Unable to get devmapper targets for %s\"),\n                             path);\n        goto cleanup;\n    }\n\n    for (i = 0; targetPaths && targetPaths[i]; i++) {\n        rv = virCgroupAllowDevicePath(priv->cgroup, targetPaths[i], perms, false);\n\n        virDomainAuditCgroupPath(vm, priv->cgroup, \"allow\", targetPaths[i],\n                                 virCgroupGetDevicePermsString(perms),\n                                 rv);\n        if (rv < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virStringListFree(targetPaths);\n    return ret;\n}"
  }
]