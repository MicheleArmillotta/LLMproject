[
  {
    "function_name": "virCPUarmValidateFeatures",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
    "lines": "232-253",
    "snippet": "static int\nvirCPUarmValidateFeatures(virCPUDefPtr cpu)\n{\n    virCPUarmMapPtr map;\n    size_t i;\n\n    if (!(map = virCPUarmGetMap()))\n        return -1;\n\n    for (i = 0; i < cpu->nfeatures; i++) {\n        virCPUFeatureDefPtr feature = &cpu->features[i];\n\n        if (!virCPUarmMapFeatureFind(map, feature->name)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown CPU feature: %s\"),\n                           feature->name);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"cpu_map.h\"",
      "#include \"cpu.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"unknown CPU feature: %s\")",
            "feature->name"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown CPU feature: %s\""
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUarmMapFeatureFind",
          "args": [
            "map",
            "feature->name"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUarmMapFeatureFind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
          "lines": "97-111",
          "snippet": "static virCPUarmFeaturePtr\nvirCPUarmMapFeatureFind(virCPUarmMapPtr map,\n                        const char *name)\n{\n    size_t i;\n\n    for (i = 0; i < map->features->len; i++) {\n        virCPUarmFeaturePtr feature = g_ptr_array_index(map->features, i);\n\n        if (STREQ(feature->name, name))\n            return feature;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"cpu_map.h\"",
            "#include \"cpu.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virCPUarmFeaturePtr\nvirCPUarmMapFeatureFind(virCPUarmMapPtr map,\n                        const char *name)\n{\n    size_t i;\n\n    for (i = 0; i < map->features->len; i++) {\n        virCPUarmFeaturePtr feature = g_ptr_array_index(map->features, i);\n\n        if (STREQ(feature->name, name))\n            return feature;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUarmGetMap",
          "args": [],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUarmGetMap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
          "lines": "162-169",
          "snippet": "static virCPUarmMapPtr\nvirCPUarmGetMap(void)\n{\n    if (virCPUarmDriverInitialize() < 0)\n        return NULL;\n\n    return cpuMap;\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"cpu_map.h\"",
            "#include \"cpu.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virCPUarmMapPtr cpuMap;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virCPUarmMapPtr cpuMap;\n\nstatic virCPUarmMapPtr\nvirCPUarmGetMap(void)\n{\n    if (virCPUarmDriverInitialize() < 0)\n        return NULL;\n\n    return cpuMap;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic int\nvirCPUarmValidateFeatures(virCPUDefPtr cpu)\n{\n    virCPUarmMapPtr map;\n    size_t i;\n\n    if (!(map = virCPUarmGetMap()))\n        return -1;\n\n    for (i = 0; i < cpu->nfeatures; i++) {\n        virCPUFeatureDefPtr feature = &cpu->features[i];\n\n        if (!virCPUarmMapFeatureFind(map, feature->name)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown CPU feature: %s\"),\n                           feature->name);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCPUarmCompare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
    "lines": "224-230",
    "snippet": "static virCPUCompareResult\nvirCPUarmCompare(virCPUDefPtr host G_GNUC_UNUSED,\n                 virCPUDefPtr cpu G_GNUC_UNUSED,\n                 bool failMessages G_GNUC_UNUSED)\n{\n    return VIR_CPU_COMPARE_IDENTICAL;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"cpu_map.h\"",
      "#include \"cpu.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virCPUCompareResult\nvirCPUarmCompare(virCPUDefPtr host G_GNUC_UNUSED,\n                 virCPUDefPtr cpu G_GNUC_UNUSED,\n                 bool failMessages G_GNUC_UNUSED)\n{\n    return VIR_CPU_COMPARE_IDENTICAL;\n}"
  },
  {
    "function_name": "virCPUarmBaseline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
    "lines": "205-222",
    "snippet": "static virCPUDefPtr\nvirCPUarmBaseline(virCPUDefPtr *cpus,\n                  unsigned int ncpus G_GNUC_UNUSED,\n                  virDomainCapsCPUModelsPtr models G_GNUC_UNUSED,\n                  const char **features G_GNUC_UNUSED,\n                  bool migratable G_GNUC_UNUSED)\n{\n    virCPUDefPtr cpu = NULL;\n\n    cpu = virCPUDefNew();\n\n    cpu->model = g_strdup(cpus[0]->model);\n\n    cpu->type = VIR_CPU_TYPE_GUEST;\n    cpu->match = VIR_CPU_MATCH_EXACT;\n\n    return cpu;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"cpu_map.h\"",
      "#include \"cpu.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "cpus[0]->model"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUDefNew",
          "args": [],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUDefNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "85-90",
          "snippet": "virCPUDefPtr virCPUDefNew(void)\n{\n    virCPUDefPtr cpu = g_new0(virCPUDef, 1);\n    cpu->refs = 1;\n    return cpu;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirCPUDefPtr virCPUDefNew(void)\n{\n    virCPUDefPtr cpu = g_new0(virCPUDef, 1);\n    cpu->refs = 1;\n    return cpu;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virCPUDefPtr\nvirCPUarmBaseline(virCPUDefPtr *cpus,\n                  unsigned int ncpus G_GNUC_UNUSED,\n                  virDomainCapsCPUModelsPtr models G_GNUC_UNUSED,\n                  const char **features G_GNUC_UNUSED,\n                  bool migratable G_GNUC_UNUSED)\n{\n    virCPUDefPtr cpu = NULL;\n\n    cpu = virCPUDefNew();\n\n    cpu->model = g_strdup(cpus[0]->model);\n\n    cpu->type = VIR_CPU_TYPE_GUEST;\n    cpu->match = VIR_CPU_MATCH_EXACT;\n\n    return cpu;\n}"
  },
  {
    "function_name": "virCPUarmUpdate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
    "lines": "171-202",
    "snippet": "static int\nvirCPUarmUpdate(virCPUDefPtr guest,\n                const virCPUDef *host)\n{\n    int ret = -1;\n    virCPUDefPtr updated = NULL;\n\n    if (guest->mode != VIR_CPU_MODE_HOST_MODEL)\n        return 0;\n\n    if (!host) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"unknown host CPU model\"));\n        goto cleanup;\n    }\n\n    if (!(updated = virCPUDefCopyWithoutModel(guest)))\n        goto cleanup;\n\n    updated->mode = VIR_CPU_MODE_CUSTOM;\n    if (virCPUDefCopyModel(updated, host, true) < 0)\n        goto cleanup;\n\n    virCPUDefStealModel(guest, updated, false);\n    guest->mode = VIR_CPU_MODE_CUSTOM;\n    guest->match = VIR_CPU_MATCH_EXACT;\n    ret = 0;\n\n cleanup:\n    virCPUDefFree(updated);\n    return ret;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"cpu_map.h\"",
      "#include \"cpu.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCPUDefFree",
          "args": [
            "updated"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "120-132",
          "snippet": "void\nvirCPUDefFree(virCPUDefPtr def)\n{\n    if (!def)\n        return;\n\n    if (g_atomic_int_dec_and_test(&def->refs)) {\n        virCPUDefFreeModel(def);\n        VIR_FREE(def->cache);\n        VIR_FREE(def->tsc);\n        VIR_FREE(def);\n    }\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirCPUDefFree(virCPUDefPtr def)\n{\n    if (!def)\n        return;\n\n    if (g_atomic_int_dec_and_test(&def->refs)) {\n        virCPUDefFreeModel(def);\n        VIR_FREE(def->cache);\n        VIR_FREE(def->tsc);\n        VIR_FREE(def);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUDefStealModel",
          "args": [
            "guest",
            "updated",
            "false"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUDefStealModel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "194-224",
          "snippet": "void\nvirCPUDefStealModel(virCPUDefPtr dst,\n                    virCPUDefPtr src,\n                    bool keepVendor)\n{\n    char *vendor = NULL;\n    char *vendor_id = NULL;\n\n    if (keepVendor) {\n        vendor = g_steal_pointer(&dst->vendor);\n        vendor_id = g_steal_pointer(&dst->vendor_id);\n    }\n\n    virCPUDefFreeModel(dst);\n\n    dst->model = g_steal_pointer(&src->model);\n    dst->features = g_steal_pointer(&src->features);\n    dst->microcodeVersion = src->microcodeVersion;\n    dst->nfeatures_max = src->nfeatures_max;\n    src->nfeatures_max = 0;\n    dst->nfeatures = src->nfeatures;\n    src->nfeatures = 0;\n\n    if (keepVendor) {\n        dst->vendor = vendor;\n        dst->vendor_id = vendor_id;\n    } else {\n        dst->vendor = g_steal_pointer(&src->vendor);\n        dst->vendor_id = g_steal_pointer(&src->vendor_id);\n    }\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirCPUDefStealModel(virCPUDefPtr dst,\n                    virCPUDefPtr src,\n                    bool keepVendor)\n{\n    char *vendor = NULL;\n    char *vendor_id = NULL;\n\n    if (keepVendor) {\n        vendor = g_steal_pointer(&dst->vendor);\n        vendor_id = g_steal_pointer(&dst->vendor_id);\n    }\n\n    virCPUDefFreeModel(dst);\n\n    dst->model = g_steal_pointer(&src->model);\n    dst->features = g_steal_pointer(&src->features);\n    dst->microcodeVersion = src->microcodeVersion;\n    dst->nfeatures_max = src->nfeatures_max;\n    src->nfeatures_max = 0;\n    dst->nfeatures = src->nfeatures;\n    src->nfeatures = 0;\n\n    if (keepVendor) {\n        dst->vendor = vendor;\n        dst->vendor_id = vendor_id;\n    } else {\n        dst->vendor = g_steal_pointer(&src->vendor);\n        dst->vendor_id = g_steal_pointer(&src->vendor_id);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUDefCopyModel",
          "args": [
            "updated",
            "host",
            "true"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCPUDefCopyWithoutModel",
          "args": [
            "guest"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUDefCopyWithoutModel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "227-266",
          "snippet": "virCPUDefPtr\nvirCPUDefCopyWithoutModel(const virCPUDef *cpu)\n{\n    virCPUDefPtr copy;\n\n    if (!cpu)\n        return NULL;\n\n    copy = virCPUDefNew();\n    copy->type = cpu->type;\n    copy->mode = cpu->mode;\n    copy->match = cpu->match;\n    copy->check = cpu->check;\n    copy->fallback = cpu->fallback;\n    copy->sockets = cpu->sockets;\n    copy->dies = cpu->dies;\n    copy->cores = cpu->cores;\n    copy->threads = cpu->threads;\n    copy->arch = cpu->arch;\n\n    if (cpu->cache) {\n        if (VIR_ALLOC(copy->cache) < 0)\n            goto error;\n\n        *copy->cache = *cpu->cache;\n    }\n\n    if (cpu->tsc) {\n        if (VIR_ALLOC(copy->tsc) < 0)\n            goto error;\n\n        *copy->tsc = *cpu->tsc;\n    }\n\n    return copy;\n\n error:\n    virCPUDefFree(copy);\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirCPUDefPtr\nvirCPUDefCopyWithoutModel(const virCPUDef *cpu)\n{\n    virCPUDefPtr copy;\n\n    if (!cpu)\n        return NULL;\n\n    copy = virCPUDefNew();\n    copy->type = cpu->type;\n    copy->mode = cpu->mode;\n    copy->match = cpu->match;\n    copy->check = cpu->check;\n    copy->fallback = cpu->fallback;\n    copy->sockets = cpu->sockets;\n    copy->dies = cpu->dies;\n    copy->cores = cpu->cores;\n    copy->threads = cpu->threads;\n    copy->arch = cpu->arch;\n\n    if (cpu->cache) {\n        if (VIR_ALLOC(copy->cache) < 0)\n            goto error;\n\n        *copy->cache = *cpu->cache;\n    }\n\n    if (cpu->tsc) {\n        if (VIR_ALLOC(copy->tsc) < 0)\n            goto error;\n\n        *copy->tsc = *cpu->tsc;\n    }\n\n    return copy;\n\n error:\n    virCPUDefFree(copy);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"unknown host CPU model\")"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown host CPU model\""
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic int\nvirCPUarmUpdate(virCPUDefPtr guest,\n                const virCPUDef *host)\n{\n    int ret = -1;\n    virCPUDefPtr updated = NULL;\n\n    if (guest->mode != VIR_CPU_MODE_HOST_MODEL)\n        return 0;\n\n    if (!host) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"unknown host CPU model\"));\n        goto cleanup;\n    }\n\n    if (!(updated = virCPUDefCopyWithoutModel(guest)))\n        goto cleanup;\n\n    updated->mode = VIR_CPU_MODE_CUSTOM;\n    if (virCPUDefCopyModel(updated, host, true) < 0)\n        goto cleanup;\n\n    virCPUDefStealModel(guest, updated, false);\n    guest->mode = VIR_CPU_MODE_CUSTOM;\n    guest->match = VIR_CPU_MATCH_EXACT;\n    ret = 0;\n\n cleanup:\n    virCPUDefFree(updated);\n    return ret;\n}"
  },
  {
    "function_name": "virCPUarmGetMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
    "lines": "162-169",
    "snippet": "static virCPUarmMapPtr\nvirCPUarmGetMap(void)\n{\n    if (virCPUarmDriverInitialize() < 0)\n        return NULL;\n\n    return cpuMap;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"cpu_map.h\"",
      "#include \"cpu.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virCPUarmMapPtr cpuMap;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCPUarmDriverInitialize",
          "args": [],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virCPUarmMapPtr cpuMap;\n\nstatic virCPUarmMapPtr\nvirCPUarmGetMap(void)\n{\n    if (virCPUarmDriverInitialize() < 0)\n        return NULL;\n\n    return cpuMap;\n}"
  },
  {
    "function_name": "virCPUarmDriverOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
    "lines": "153-160",
    "snippet": "int\nvirCPUarmDriverOnceInit(void)\n{\n    if (!(cpuMap = virCPUarmLoadMap()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"cpu_map.h\"",
      "#include \"cpu.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virCPUarmMapPtr cpuMap;",
      "int virCPUarmDriverOnceInit(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCPUarmLoadMap",
          "args": [],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUarmLoadMap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
          "lines": "135-146",
          "snippet": "static virCPUarmMapPtr\nvirCPUarmLoadMap(void)\n{\n    g_autoptr(virCPUarmMap) map = NULL;\n\n    map = virCPUarmMapNew();\n\n    if (cpuMapLoad(\"arm\", NULL, virCPUarmMapFeatureParse, NULL, map) < 0)\n        return NULL;\n\n    return g_steal_pointer(&map);\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"cpu_map.h\"",
            "#include \"cpu.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virCPUarmMapPtr\nvirCPUarmLoadMap(void)\n{\n    g_autoptr(virCPUarmMap) map = NULL;\n\n    map = virCPUarmMapNew();\n\n    if (cpuMapLoad(\"arm\", NULL, virCPUarmMapFeatureParse, NULL, map) < 0)\n        return NULL;\n\n    return g_steal_pointer(&map);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virCPUarmMapPtr cpuMap;\nint virCPUarmDriverOnceInit(void);\n\nint\nvirCPUarmDriverOnceInit(void)\n{\n    if (!(cpuMap = virCPUarmLoadMap()))\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCPUarmLoadMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
    "lines": "135-146",
    "snippet": "static virCPUarmMapPtr\nvirCPUarmLoadMap(void)\n{\n    g_autoptr(virCPUarmMap) map = NULL;\n\n    map = virCPUarmMapNew();\n\n    if (cpuMapLoad(\"arm\", NULL, virCPUarmMapFeatureParse, NULL, map) < 0)\n        return NULL;\n\n    return g_steal_pointer(&map);\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"cpu_map.h\"",
      "#include \"cpu.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&map"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpuMapLoad",
          "args": [
            "\"arm\"",
            "NULL",
            "virCPUarmMapFeatureParse",
            "NULL",
            "map"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "cpuMapLoad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_map.c",
          "lines": "174-236",
          "snippet": "int cpuMapLoad(const char *arch,\n               cpuMapLoadCallback vendorCB,\n               cpuMapLoadCallback featureCB,\n               cpuMapLoadCallback modelCB,\n               void *data)\n{\n    xmlDocPtr xml = NULL;\n    xmlXPathContextPtr ctxt = NULL;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char *xpath = NULL;\n    int ret = -1;\n    char *mapfile;\n\n    if (!(mapfile = virFileFindResource(\"index.xml\",\n                                        abs_top_srcdir \"/src/cpu_map\",\n                                        PKGDATADIR \"/cpu_map\")))\n        return -1;\n\n    VIR_DEBUG(\"Loading '%s' CPU map from %s\", NULLSTR(arch), mapfile);\n\n    if (arch == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"undefined hardware architecture\"));\n        goto cleanup;\n    }\n\n    if (!(xml = virXMLParseFileCtxt(mapfile, &ctxt)))\n        goto cleanup;\n\n    virBufferAsprintf(&buf, \"./arch[@name='%s']\", arch);\n\n    xpath = virBufferContentAndReset(&buf);\n\n    ctxt->node = xmlDocGetRootElement(xml);\n\n    if ((ctxt->node = virXPathNode(xpath, ctxt)) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot find CPU map for %s architecture\"), arch);\n        goto cleanup;\n    }\n\n    if (loadData(mapfile, ctxt, \"vendor\", vendorCB, data) < 0)\n        goto cleanup;\n\n    if (loadData(mapfile, ctxt, \"feature\", featureCB, data) < 0)\n        goto cleanup;\n\n    if (loadData(mapfile, ctxt, \"model\", modelCB, data) < 0)\n        goto cleanup;\n\n    if (loadIncludes(ctxt, vendorCB, featureCB, modelCB, data) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    xmlXPathFreeContext(ctxt);\n    xmlFreeDoc(xml);\n    VIR_FREE(xpath);\n    VIR_FREE(mapfile);\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"configmake.h\"",
            "#include \"cpu_map.h\"",
            "#include \"cpu.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"configmake.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint cpuMapLoad(const char *arch,\n               cpuMapLoadCallback vendorCB,\n               cpuMapLoadCallback featureCB,\n               cpuMapLoadCallback modelCB,\n               void *data)\n{\n    xmlDocPtr xml = NULL;\n    xmlXPathContextPtr ctxt = NULL;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char *xpath = NULL;\n    int ret = -1;\n    char *mapfile;\n\n    if (!(mapfile = virFileFindResource(\"index.xml\",\n                                        abs_top_srcdir \"/src/cpu_map\",\n                                        PKGDATADIR \"/cpu_map\")))\n        return -1;\n\n    VIR_DEBUG(\"Loading '%s' CPU map from %s\", NULLSTR(arch), mapfile);\n\n    if (arch == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"undefined hardware architecture\"));\n        goto cleanup;\n    }\n\n    if (!(xml = virXMLParseFileCtxt(mapfile, &ctxt)))\n        goto cleanup;\n\n    virBufferAsprintf(&buf, \"./arch[@name='%s']\", arch);\n\n    xpath = virBufferContentAndReset(&buf);\n\n    ctxt->node = xmlDocGetRootElement(xml);\n\n    if ((ctxt->node = virXPathNode(xpath, ctxt)) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot find CPU map for %s architecture\"), arch);\n        goto cleanup;\n    }\n\n    if (loadData(mapfile, ctxt, \"vendor\", vendorCB, data) < 0)\n        goto cleanup;\n\n    if (loadData(mapfile, ctxt, \"feature\", featureCB, data) < 0)\n        goto cleanup;\n\n    if (loadData(mapfile, ctxt, \"model\", modelCB, data) < 0)\n        goto cleanup;\n\n    if (loadIncludes(ctxt, vendorCB, featureCB, modelCB, data) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    xmlXPathFreeContext(ctxt);\n    xmlFreeDoc(xml);\n    VIR_FREE(xpath);\n    VIR_FREE(mapfile);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUarmMapNew",
          "args": [],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUarmMapNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
          "lines": "70-82",
          "snippet": "static virCPUarmMapPtr\nvirCPUarmMapNew(void)\n{\n    virCPUarmMapPtr map;\n\n    map = g_new0(virCPUarmMap, 1);\n\n    map->features = g_ptr_array_new();\n    g_ptr_array_set_free_func(map->features,\n                              (GDestroyNotify) virCPUarmFeatureFree);\n\n    return map;\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"cpu_map.h\"",
            "#include \"cpu.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virCPUarmMapPtr\nvirCPUarmMapNew(void)\n{\n    virCPUarmMapPtr map;\n\n    map = g_new0(virCPUarmMap, 1);\n\n    map->features = g_ptr_array_new();\n    g_ptr_array_set_free_func(map->features,\n                              (GDestroyNotify) virCPUarmFeatureFree);\n\n    return map;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virCPUarmMapPtr\nvirCPUarmLoadMap(void)\n{\n    g_autoptr(virCPUarmMap) map = NULL;\n\n    map = virCPUarmMapNew();\n\n    if (cpuMapLoad(\"arm\", NULL, virCPUarmMapFeatureParse, NULL, map) < 0)\n        return NULL;\n\n    return g_steal_pointer(&map);\n}"
  },
  {
    "function_name": "virCPUarmMapFeatureParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
    "lines": "113-133",
    "snippet": "static int\nvirCPUarmMapFeatureParse(xmlXPathContextPtr ctxt G_GNUC_UNUSED,\n                         const char *name,\n                         void *data)\n{\n    g_autoptr(virCPUarmFeature) feature = NULL;\n    virCPUarmMapPtr map = data;\n\n    if (virCPUarmMapFeatureFind(map, name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"CPU feature %s already defined\"), name);\n        return -1;\n    }\n\n    feature = virCPUarmFeatureNew();\n    feature->name = g_strdup(name);\n\n    g_ptr_array_add(map->features, g_steal_pointer(&feature));\n\n    return 0;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"cpu_map.h\"",
      "#include \"cpu.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_ptr_array_add",
          "args": [
            "map->features",
            "g_steal_pointer(&feature)"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&feature"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "name"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUarmFeatureNew",
          "args": [],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUarmFeatureNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
          "lines": "45-49",
          "snippet": "static virCPUarmFeaturePtr\nvirCPUarmFeatureNew(void)\n{\n    return g_new0(virCPUarmFeature, 1);\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"cpu_map.h\"",
            "#include \"cpu.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virCPUarmFeaturePtr\nvirCPUarmFeatureNew(void)\n{\n    return g_new0(virCPUarmFeature, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"CPU feature %s already defined\")",
            "name"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCPUarmMapFeatureFind",
          "args": [
            "map",
            "name"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUarmMapFeatureFind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
          "lines": "97-111",
          "snippet": "static virCPUarmFeaturePtr\nvirCPUarmMapFeatureFind(virCPUarmMapPtr map,\n                        const char *name)\n{\n    size_t i;\n\n    for (i = 0; i < map->features->len; i++) {\n        virCPUarmFeaturePtr feature = g_ptr_array_index(map->features, i);\n\n        if (STREQ(feature->name, name))\n            return feature;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"cpu_map.h\"",
            "#include \"cpu.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virCPUarmFeaturePtr\nvirCPUarmMapFeatureFind(virCPUarmMapPtr map,\n                        const char *name)\n{\n    size_t i;\n\n    for (i = 0; i < map->features->len; i++) {\n        virCPUarmFeaturePtr feature = g_ptr_array_index(map->features, i);\n\n        if (STREQ(feature->name, name))\n            return feature;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic int\nvirCPUarmMapFeatureParse(xmlXPathContextPtr ctxt G_GNUC_UNUSED,\n                         const char *name,\n                         void *data)\n{\n    g_autoptr(virCPUarmFeature) feature = NULL;\n    virCPUarmMapPtr map = data;\n\n    if (virCPUarmMapFeatureFind(map, name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"CPU feature %s already defined\"), name);\n        return -1;\n    }\n\n    feature = virCPUarmFeatureNew();\n    feature->name = g_strdup(name);\n\n    g_ptr_array_add(map->features, g_steal_pointer(&feature));\n\n    return 0;\n}"
  },
  {
    "function_name": "virCPUarmMapFeatureFind",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
    "lines": "97-111",
    "snippet": "static virCPUarmFeaturePtr\nvirCPUarmMapFeatureFind(virCPUarmMapPtr map,\n                        const char *name)\n{\n    size_t i;\n\n    for (i = 0; i < map->features->len; i++) {\n        virCPUarmFeaturePtr feature = g_ptr_array_index(map->features, i);\n\n        if (STREQ(feature->name, name))\n            return feature;\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"cpu_map.h\"",
      "#include \"cpu.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "feature->name",
            "name"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ptr_array_index",
          "args": [
            "map->features",
            "i"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virCPUarmFeaturePtr\nvirCPUarmMapFeatureFind(virCPUarmMapPtr map,\n                        const char *name)\n{\n    size_t i;\n\n    for (i = 0; i < map->features->len; i++) {\n        virCPUarmFeaturePtr feature = g_ptr_array_index(map->features, i);\n\n        if (STREQ(feature->name, name))\n            return feature;\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "virCPUarmMapFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
    "lines": "84-93",
    "snippet": "static void\nvirCPUarmMapFree(virCPUarmMapPtr map)\n{\n    if (!map)\n        return;\n\n    g_ptr_array_free(map->features, TRUE);\n\n    g_free(map);\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"cpu_map.h\"",
      "#include \"cpu.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "map"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ptr_array_free",
          "args": [
            "map->features",
            "TRUE"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic void\nvirCPUarmMapFree(virCPUarmMapPtr map)\n{\n    if (!map)\n        return;\n\n    g_ptr_array_free(map->features, TRUE);\n\n    g_free(map);\n}"
  },
  {
    "function_name": "virCPUarmMapNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
    "lines": "70-82",
    "snippet": "static virCPUarmMapPtr\nvirCPUarmMapNew(void)\n{\n    virCPUarmMapPtr map;\n\n    map = g_new0(virCPUarmMap, 1);\n\n    map->features = g_ptr_array_new();\n    g_ptr_array_set_free_func(map->features,\n                              (GDestroyNotify) virCPUarmFeatureFree);\n\n    return map;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"cpu_map.h\"",
      "#include \"cpu.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_ptr_array_set_free_func",
          "args": [
            "map->features",
            "(GDestroyNotify) virCPUarmFeatureFree"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ptr_array_new",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "virCPUarmMap",
            "1"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virCPUarmMapPtr\nvirCPUarmMapNew(void)\n{\n    virCPUarmMapPtr map;\n\n    map = g_new0(virCPUarmMap, 1);\n\n    map->features = g_ptr_array_new();\n    g_ptr_array_set_free_func(map->features,\n                              (GDestroyNotify) virCPUarmFeatureFree);\n\n    return map;\n}"
  },
  {
    "function_name": "virCPUarmFeatureFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
    "lines": "51-60",
    "snippet": "static void\nvirCPUarmFeatureFree(virCPUarmFeaturePtr feature)\n{\n    if (!feature)\n        return;\n\n    g_free(feature->name);\n\n    g_free(feature);\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"cpu_map.h\"",
      "#include \"cpu.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "feature"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "feature->name"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic void\nvirCPUarmFeatureFree(virCPUarmFeaturePtr feature)\n{\n    if (!feature)\n        return;\n\n    g_free(feature->name);\n\n    g_free(feature);\n}"
  },
  {
    "function_name": "virCPUarmFeatureNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu_arm.c",
    "lines": "45-49",
    "snippet": "static virCPUarmFeaturePtr\nvirCPUarmFeatureNew(void)\n{\n    return g_new0(virCPUarmFeature, 1);\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"cpu_map.h\"",
      "#include \"cpu.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "virCPUarmFeature",
            "1"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virCPUarmFeaturePtr\nvirCPUarmFeatureNew(void)\n{\n    return g_new0(virCPUarmFeature, 1);\n}"
  }
]