[
  {
    "function_name": "iptablesRemoveOutputFixUdpChecksum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "1144-1150",
    "snippet": "void\niptablesRemoveOutputFixUdpChecksum(virFirewallPtr fw,\n                                   const char *iface,\n                                   int port)\n{\n    iptablesOutputFixUdpChecksum(fw, deletePrivate, iface, port, REMOVE);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool deletePrivate = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesOutputFixUdpChecksum",
          "args": [
            "fw",
            "deletePrivate",
            "iface",
            "port",
            "REMOVE"
          ],
          "line": 1149
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesOutputFixUdpChecksum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "1093-1114",
          "snippet": "static void\niptablesOutputFixUdpChecksum(virFirewallPtr fw,\n                             bool pvt,\n                             const char *iface,\n                             int port,\n                             int action)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                       \"--table\", \"mangle\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                       \"--out-interface\", iface,\n                       \"--protocol\", \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"CHECKSUM\", \"--checksum-fill\",\n                       NULL);\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesOutputFixUdpChecksum(virFirewallPtr fw,\n                             bool pvt,\n                             const char *iface,\n                             int port,\n                             int action)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                       \"--table\", \"mangle\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                       \"--out-interface\", iface,\n                       \"--protocol\", \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"CHECKSUM\", \"--checksum-fill\",\n                       NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic bool deletePrivate = true;\n\nvoid\niptablesRemoveOutputFixUdpChecksum(virFirewallPtr fw,\n                                   const char *iface,\n                                   int port)\n{\n    iptablesOutputFixUdpChecksum(fw, deletePrivate, iface, port, REMOVE);\n}"
  },
  {
    "function_name": "iptablesAddOutputFixUdpChecksum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "1127-1133",
    "snippet": "void\niptablesAddOutputFixUdpChecksum(virFirewallPtr fw,\n                                const char *iface,\n                                int port)\n{\n    iptablesOutputFixUdpChecksum(fw, true, iface, port, ADD);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesOutputFixUdpChecksum",
          "args": [
            "fw",
            "true",
            "iface",
            "port",
            "ADD"
          ],
          "line": 1132
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesOutputFixUdpChecksum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "1093-1114",
          "snippet": "static void\niptablesOutputFixUdpChecksum(virFirewallPtr fw,\n                             bool pvt,\n                             const char *iface,\n                             int port,\n                             int action)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                       \"--table\", \"mangle\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                       \"--out-interface\", iface,\n                       \"--protocol\", \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"CHECKSUM\", \"--checksum-fill\",\n                       NULL);\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesOutputFixUdpChecksum(virFirewallPtr fw,\n                             bool pvt,\n                             const char *iface,\n                             int port,\n                             int action)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                       \"--table\", \"mangle\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                       \"--out-interface\", iface,\n                       \"--protocol\", \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"CHECKSUM\", \"--checksum-fill\",\n                       NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\niptablesAddOutputFixUdpChecksum(virFirewallPtr fw,\n                                const char *iface,\n                                int port)\n{\n    iptablesOutputFixUdpChecksum(fw, true, iface, port, ADD);\n}"
  },
  {
    "function_name": "iptablesOutputFixUdpChecksum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "1093-1114",
    "snippet": "static void\niptablesOutputFixUdpChecksum(virFirewallPtr fw,\n                             bool pvt,\n                             const char *iface,\n                             int port,\n                             int action)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                       \"--table\", \"mangle\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                       \"--out-interface\", iface,\n                       \"--protocol\", \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"CHECKSUM\", \"--checksum-fill\",\n                       NULL);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFirewallAddRule",
          "args": [
            "fw",
            "VIR_FIREWALL_LAYER_IPV4",
            "\"--table\"",
            "\"mangle\"",
            "action == ADD ? \"--insert\" : \"--delete\"",
            "pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\"",
            "\"--out-interface\"",
            "iface",
            "\"--protocol\"",
            "\"udp\"",
            "\"--destination-port\"",
            "portstr",
            "\"--jump\"",
            "\"CHECKSUM\"",
            "\"--checksum-fill\"",
            "NULL"
          ],
          "line": 1105
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallAddRuleFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "421-434",
          "snippet": "virFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_snprintf",
          "args": [
            "portstr",
            "sizeof(portstr)",
            "\"%d\"",
            "port"
          ],
          "line": 1102
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesOutputFixUdpChecksum(virFirewallPtr fw,\n                             bool pvt,\n                             const char *iface,\n                             int port,\n                             int action)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                       \"--table\", \"mangle\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                       \"--out-interface\", iface,\n                       \"--protocol\", \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"CHECKSUM\", \"--checksum-fill\",\n                       NULL);\n}"
  },
  {
    "function_name": "iptablesRemoveDontMasquerade",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "1081-1090",
    "snippet": "int\niptablesRemoveDontMasquerade(virFirewallPtr fw,\n                             virSocketAddr *netaddr,\n                             unsigned int prefix,\n                             const char *physdev,\n                             const char *destaddr)\n{\n    return iptablesForwardDontMasquerade(fw, deletePrivate, netaddr, prefix,\n                                         physdev, destaddr, REMOVE);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool deletePrivate = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesForwardDontMasquerade",
          "args": [
            "fw",
            "deletePrivate",
            "netaddr",
            "prefix",
            "physdev",
            "destaddr",
            "REMOVE"
          ],
          "line": 1088
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesForwardDontMasquerade",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "997-1040",
          "snippet": "static int\niptablesForwardDontMasquerade(virFirewallPtr fw,\n                              bool pvt,\n                              virSocketAddr *netaddr,\n                              unsigned int prefix,\n                              const char *physdev,\n                              const char *destaddr,\n                              int action)\n{\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (!VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET)) {\n        /* Higher level code *should* guaranteee it's impossible to get here. */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Attempted to NAT '%s'. NAT is only supported for IPv4.\"),\n                       networkstr);\n        return -1;\n    }\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                           \"--table\", \"nat\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                           \"--out-interface\", physdev,\n                           \"--source\", networkstr,\n                           \"--destination\", destaddr,\n                           \"--jump\", \"RETURN\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                           \"--table\", \"nat\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                           \"--source\", networkstr,\n                           \"--destination\", destaddr,\n                           \"--jump\", \"RETURN\",\n                           NULL);\n\n    return 0;\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\niptablesForwardDontMasquerade(virFirewallPtr fw,\n                              bool pvt,\n                              virSocketAddr *netaddr,\n                              unsigned int prefix,\n                              const char *physdev,\n                              const char *destaddr,\n                              int action)\n{\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (!VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET)) {\n        /* Higher level code *should* guaranteee it's impossible to get here. */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Attempted to NAT '%s'. NAT is only supported for IPv4.\"),\n                       networkstr);\n        return -1;\n    }\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                           \"--table\", \"nat\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                           \"--out-interface\", physdev,\n                           \"--source\", networkstr,\n                           \"--destination\", destaddr,\n                           \"--jump\", \"RETURN\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                           \"--table\", \"nat\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                           \"--source\", networkstr,\n                           \"--destination\", destaddr,\n                           \"--jump\", \"RETURN\",\n                           NULL);\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic bool deletePrivate = true;\n\nint\niptablesRemoveDontMasquerade(virFirewallPtr fw,\n                             virSocketAddr *netaddr,\n                             unsigned int prefix,\n                             const char *physdev,\n                             const char *destaddr)\n{\n    return iptablesForwardDontMasquerade(fw, deletePrivate, netaddr, prefix,\n                                         physdev, destaddr, REMOVE);\n}"
  },
  {
    "function_name": "iptablesAddDontMasquerade",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "1056-1065",
    "snippet": "int\niptablesAddDontMasquerade(virFirewallPtr fw,\n                          virSocketAddr *netaddr,\n                          unsigned int prefix,\n                          const char *physdev,\n                          const char *destaddr)\n{\n    return iptablesForwardDontMasquerade(fw, true, netaddr, prefix,\n                                         physdev, destaddr, ADD);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesForwardDontMasquerade",
          "args": [
            "fw",
            "true",
            "netaddr",
            "prefix",
            "physdev",
            "destaddr",
            "ADD"
          ],
          "line": 1063
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesForwardDontMasquerade",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "997-1040",
          "snippet": "static int\niptablesForwardDontMasquerade(virFirewallPtr fw,\n                              bool pvt,\n                              virSocketAddr *netaddr,\n                              unsigned int prefix,\n                              const char *physdev,\n                              const char *destaddr,\n                              int action)\n{\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (!VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET)) {\n        /* Higher level code *should* guaranteee it's impossible to get here. */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Attempted to NAT '%s'. NAT is only supported for IPv4.\"),\n                       networkstr);\n        return -1;\n    }\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                           \"--table\", \"nat\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                           \"--out-interface\", physdev,\n                           \"--source\", networkstr,\n                           \"--destination\", destaddr,\n                           \"--jump\", \"RETURN\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                           \"--table\", \"nat\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                           \"--source\", networkstr,\n                           \"--destination\", destaddr,\n                           \"--jump\", \"RETURN\",\n                           NULL);\n\n    return 0;\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\niptablesForwardDontMasquerade(virFirewallPtr fw,\n                              bool pvt,\n                              virSocketAddr *netaddr,\n                              unsigned int prefix,\n                              const char *physdev,\n                              const char *destaddr,\n                              int action)\n{\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (!VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET)) {\n        /* Higher level code *should* guaranteee it's impossible to get here. */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Attempted to NAT '%s'. NAT is only supported for IPv4.\"),\n                       networkstr);\n        return -1;\n    }\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                           \"--table\", \"nat\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                           \"--out-interface\", physdev,\n                           \"--source\", networkstr,\n                           \"--destination\", destaddr,\n                           \"--jump\", \"RETURN\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                           \"--table\", \"nat\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                           \"--source\", networkstr,\n                           \"--destination\", destaddr,\n                           \"--jump\", \"RETURN\",\n                           NULL);\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\niptablesAddDontMasquerade(virFirewallPtr fw,\n                          virSocketAddr *netaddr,\n                          unsigned int prefix,\n                          const char *physdev,\n                          const char *destaddr)\n{\n    return iptablesForwardDontMasquerade(fw, true, netaddr, prefix,\n                                         physdev, destaddr, ADD);\n}"
  },
  {
    "function_name": "iptablesForwardDontMasquerade",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "997-1040",
    "snippet": "static int\niptablesForwardDontMasquerade(virFirewallPtr fw,\n                              bool pvt,\n                              virSocketAddr *netaddr,\n                              unsigned int prefix,\n                              const char *physdev,\n                              const char *destaddr,\n                              int action)\n{\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (!VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET)) {\n        /* Higher level code *should* guaranteee it's impossible to get here. */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Attempted to NAT '%s'. NAT is only supported for IPv4.\"),\n                       networkstr);\n        return -1;\n    }\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                           \"--table\", \"nat\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                           \"--out-interface\", physdev,\n                           \"--source\", networkstr,\n                           \"--destination\", destaddr,\n                           \"--jump\", \"RETURN\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                           \"--table\", \"nat\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                           \"--source\", networkstr,\n                           \"--destination\", destaddr,\n                           \"--jump\", \"RETURN\",\n                           NULL);\n\n    return 0;\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFirewallAddRule",
          "args": [
            "fw",
            "VIR_FIREWALL_LAYER_IPV4",
            "\"--table\"",
            "\"nat\"",
            "action == ADD ? \"--insert\" : \"--delete\"",
            "pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\"",
            "\"--source\"",
            "networkstr",
            "\"--destination\"",
            "destaddr",
            "\"--jump\"",
            "\"RETURN\"",
            "NULL"
          ],
          "line": 1030
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallAddRuleFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "421-434",
          "snippet": "virFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Attempted to NAT '%s'. NAT is only supported for IPv4.\")",
            "networkstr"
          ],
          "line": 1013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Attempted to NAT '%s'. NAT is only supported for IPv4.\""
          ],
          "line": 1014
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_IS_FAMILY",
          "args": [
            "netaddr",
            "AF_INET"
          ],
          "line": 1011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iptablesFormatNetwork",
          "args": [
            "netaddr",
            "prefix"
          ],
          "line": 1008
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesFormatNetwork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "378-406",
          "snippet": "static char *iptablesFormatNetwork(virSocketAddr *netaddr,\n                                   unsigned int prefix)\n{\n    virSocketAddr network;\n    g_autofree char *netstr = NULL;\n    char *ret;\n\n    if (!(VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET) ||\n          VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET6))) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only IPv4 or IPv6 addresses can be used with iptables\"));\n        return NULL;\n    }\n\n    if (virSocketAddrMaskByPrefix(netaddr, prefix, &network) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failure to mask address\"));\n        return NULL;\n    }\n\n    netstr = virSocketAddrFormat(&network);\n\n    if (!netstr)\n        return NULL;\n\n    ret = g_strdup_printf(\"%s/%d\", netstr, prefix);\n\n    return ret;\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *iptablesFormatNetwork(virSocketAddr *netaddr,\n                                   unsigned int prefix)\n{\n    virSocketAddr network;\n    g_autofree char *netstr = NULL;\n    char *ret;\n\n    if (!(VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET) ||\n          VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET6))) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only IPv4 or IPv6 addresses can be used with iptables\"));\n        return NULL;\n    }\n\n    if (virSocketAddrMaskByPrefix(netaddr, prefix, &network) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failure to mask address\"));\n        return NULL;\n    }\n\n    netstr = virSocketAddrFormat(&network);\n\n    if (!netstr)\n        return NULL;\n\n    ret = g_strdup_printf(\"%s/%d\", netstr, prefix);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\niptablesForwardDontMasquerade(virFirewallPtr fw,\n                              bool pvt,\n                              virSocketAddr *netaddr,\n                              unsigned int prefix,\n                              const char *physdev,\n                              const char *destaddr,\n                              int action)\n{\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (!VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET)) {\n        /* Higher level code *should* guaranteee it's impossible to get here. */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Attempted to NAT '%s'. NAT is only supported for IPv4.\"),\n                       networkstr);\n        return -1;\n    }\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                           \"--table\", \"nat\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                           \"--out-interface\", physdev,\n                           \"--source\", networkstr,\n                           \"--destination\", destaddr,\n                           \"--jump\", \"RETURN\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                           \"--table\", \"nat\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                           \"--source\", networkstr,\n                           \"--destination\", destaddr,\n                           \"--jump\", \"RETURN\",\n                           NULL);\n\n    return 0;\n}"
  },
  {
    "function_name": "iptablesRemoveForwardMasquerade",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "980-991",
    "snippet": "int\niptablesRemoveForwardMasquerade(virFirewallPtr fw,\n                                virSocketAddr *netaddr,\n                                unsigned int prefix,\n                                const char *physdev,\n                                virSocketAddrRangePtr addr,\n                                virPortRangePtr port,\n                                const char *protocol)\n{\n    return iptablesForwardMasquerade(fw, deletePrivate, netaddr, prefix,\n                                     physdev, addr, port, protocol, REMOVE);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool deletePrivate = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesForwardMasquerade",
          "args": [
            "fw",
            "deletePrivate",
            "netaddr",
            "prefix",
            "physdev",
            "addr",
            "port",
            "protocol",
            "REMOVE"
          ],
          "line": 989
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesForwardMasquerade",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "840-939",
          "snippet": "static int\niptablesForwardMasquerade(virFirewallPtr fw,\n                          bool pvt,\n                          virSocketAddr *netaddr,\n                          unsigned int prefix,\n                          const char *physdev,\n                          virSocketAddrRangePtr addr,\n                          virPortRangePtr port,\n                          const char *protocol,\n                          int action)\n{\n    g_autofree char *networkstr = NULL;\n    g_autofree char *addrStartStr = NULL;\n    g_autofree char *addrEndStr = NULL;\n    g_autofree char *portRangeStr = NULL;\n    g_autofree char *natRangeStr = NULL;\n    virFirewallRulePtr rule;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (!VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET)) {\n        /* Higher level code *should* guaranteee it's impossible to get here. */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Attempted to NAT '%s'. NAT is only supported for IPv4.\"),\n                       networkstr);\n        return -1;\n    }\n\n    if (VIR_SOCKET_ADDR_IS_FAMILY(&addr->start, AF_INET)) {\n        if (!(addrStartStr = virSocketAddrFormat(&addr->start)))\n            return -1;\n        if (VIR_SOCKET_ADDR_IS_FAMILY(&addr->end, AF_INET)) {\n            if (!(addrEndStr = virSocketAddrFormat(&addr->end)))\n                return -1;\n        }\n    }\n\n    if (protocol && protocol[0]) {\n        rule = virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                                  \"--table\", \"nat\",\n                                  action == ADD ? \"--insert\" : \"--delete\",\n                                  pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                                  \"--source\", networkstr,\n                                  \"-p\", protocol,\n                                  \"!\", \"--destination\", networkstr,\n                                  NULL);\n    } else {\n        rule = virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                                  \"--table\", \"nat\",\n                                  action == ADD ? \"--insert\" : \"--delete\",\n                                  pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                                  \"--source\", networkstr,\n                                  \"!\", \"--destination\", networkstr,\n                                  NULL);\n    }\n\n    if (physdev && physdev[0])\n        virFirewallRuleAddArgList(fw, rule, \"--out-interface\", physdev, NULL);\n\n    if (protocol && protocol[0]) {\n        if (port->start == 0 && port->end == 0) {\n            port->start = 1024;\n            port->end = 65535;\n        }\n\n        if (port->start < port->end && port->end < 65536) {\n            portRangeStr = g_strdup_printf(\":%u-%u\", port->start, port->end);\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Invalid port range '%u-%u'.\"),\n                           port->start, port->end);\n            return -1;\n        }\n    }\n\n    /* Use --jump SNAT if public addr is specified */\n    if (addrStartStr && addrStartStr[0]) {\n        if (addrEndStr && addrEndStr[0]) {\n            natRangeStr = g_strdup_printf(\"%s-%s%s\", addrStartStr, addrEndStr,\n                                          portRangeStr ? portRangeStr : \"\");\n        } else {\n            natRangeStr = g_strdup_printf(\"%s%s\", addrStartStr,\n                                          portRangeStr ? portRangeStr : \"\");\n        }\n\n        virFirewallRuleAddArgList(fw, rule,\n                                  \"--jump\", \"SNAT\",\n                                  \"--to-source\", natRangeStr, NULL);\n    } else {\n        virFirewallRuleAddArgList(fw, rule,\n                                  \"--jump\", \"MASQUERADE\", NULL);\n\n        if (portRangeStr && portRangeStr[0])\n            virFirewallRuleAddArgList(fw, rule,\n                                      \"--to-ports\", &portRangeStr[1], NULL);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\niptablesForwardMasquerade(virFirewallPtr fw,\n                          bool pvt,\n                          virSocketAddr *netaddr,\n                          unsigned int prefix,\n                          const char *physdev,\n                          virSocketAddrRangePtr addr,\n                          virPortRangePtr port,\n                          const char *protocol,\n                          int action)\n{\n    g_autofree char *networkstr = NULL;\n    g_autofree char *addrStartStr = NULL;\n    g_autofree char *addrEndStr = NULL;\n    g_autofree char *portRangeStr = NULL;\n    g_autofree char *natRangeStr = NULL;\n    virFirewallRulePtr rule;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (!VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET)) {\n        /* Higher level code *should* guaranteee it's impossible to get here. */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Attempted to NAT '%s'. NAT is only supported for IPv4.\"),\n                       networkstr);\n        return -1;\n    }\n\n    if (VIR_SOCKET_ADDR_IS_FAMILY(&addr->start, AF_INET)) {\n        if (!(addrStartStr = virSocketAddrFormat(&addr->start)))\n            return -1;\n        if (VIR_SOCKET_ADDR_IS_FAMILY(&addr->end, AF_INET)) {\n            if (!(addrEndStr = virSocketAddrFormat(&addr->end)))\n                return -1;\n        }\n    }\n\n    if (protocol && protocol[0]) {\n        rule = virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                                  \"--table\", \"nat\",\n                                  action == ADD ? \"--insert\" : \"--delete\",\n                                  pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                                  \"--source\", networkstr,\n                                  \"-p\", protocol,\n                                  \"!\", \"--destination\", networkstr,\n                                  NULL);\n    } else {\n        rule = virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                                  \"--table\", \"nat\",\n                                  action == ADD ? \"--insert\" : \"--delete\",\n                                  pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                                  \"--source\", networkstr,\n                                  \"!\", \"--destination\", networkstr,\n                                  NULL);\n    }\n\n    if (physdev && physdev[0])\n        virFirewallRuleAddArgList(fw, rule, \"--out-interface\", physdev, NULL);\n\n    if (protocol && protocol[0]) {\n        if (port->start == 0 && port->end == 0) {\n            port->start = 1024;\n            port->end = 65535;\n        }\n\n        if (port->start < port->end && port->end < 65536) {\n            portRangeStr = g_strdup_printf(\":%u-%u\", port->start, port->end);\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Invalid port range '%u-%u'.\"),\n                           port->start, port->end);\n            return -1;\n        }\n    }\n\n    /* Use --jump SNAT if public addr is specified */\n    if (addrStartStr && addrStartStr[0]) {\n        if (addrEndStr && addrEndStr[0]) {\n            natRangeStr = g_strdup_printf(\"%s-%s%s\", addrStartStr, addrEndStr,\n                                          portRangeStr ? portRangeStr : \"\");\n        } else {\n            natRangeStr = g_strdup_printf(\"%s%s\", addrStartStr,\n                                          portRangeStr ? portRangeStr : \"\");\n        }\n\n        virFirewallRuleAddArgList(fw, rule,\n                                  \"--jump\", \"SNAT\",\n                                  \"--to-source\", natRangeStr, NULL);\n    } else {\n        virFirewallRuleAddArgList(fw, rule,\n                                  \"--jump\", \"MASQUERADE\", NULL);\n\n        if (portRangeStr && portRangeStr[0])\n            virFirewallRuleAddArgList(fw, rule,\n                                      \"--to-ports\", &portRangeStr[1], NULL);\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic bool deletePrivate = true;\n\nint\niptablesRemoveForwardMasquerade(virFirewallPtr fw,\n                                virSocketAddr *netaddr,\n                                unsigned int prefix,\n                                const char *physdev,\n                                virSocketAddrRangePtr addr,\n                                virPortRangePtr port,\n                                const char *protocol)\n{\n    return iptablesForwardMasquerade(fw, deletePrivate, netaddr, prefix,\n                                     physdev, addr, port, protocol, REMOVE);\n}"
  },
  {
    "function_name": "iptablesAddForwardMasquerade",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "954-965",
    "snippet": "int\niptablesAddForwardMasquerade(virFirewallPtr fw,\n                             virSocketAddr *netaddr,\n                             unsigned int prefix,\n                             const char *physdev,\n                             virSocketAddrRangePtr addr,\n                             virPortRangePtr port,\n                             const char *protocol)\n{\n    return iptablesForwardMasquerade(fw, true, netaddr, prefix,\n                                     physdev, addr, port, protocol, ADD);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesForwardMasquerade",
          "args": [
            "fw",
            "true",
            "netaddr",
            "prefix",
            "physdev",
            "addr",
            "port",
            "protocol",
            "ADD"
          ],
          "line": 963
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesForwardMasquerade",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "840-939",
          "snippet": "static int\niptablesForwardMasquerade(virFirewallPtr fw,\n                          bool pvt,\n                          virSocketAddr *netaddr,\n                          unsigned int prefix,\n                          const char *physdev,\n                          virSocketAddrRangePtr addr,\n                          virPortRangePtr port,\n                          const char *protocol,\n                          int action)\n{\n    g_autofree char *networkstr = NULL;\n    g_autofree char *addrStartStr = NULL;\n    g_autofree char *addrEndStr = NULL;\n    g_autofree char *portRangeStr = NULL;\n    g_autofree char *natRangeStr = NULL;\n    virFirewallRulePtr rule;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (!VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET)) {\n        /* Higher level code *should* guaranteee it's impossible to get here. */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Attempted to NAT '%s'. NAT is only supported for IPv4.\"),\n                       networkstr);\n        return -1;\n    }\n\n    if (VIR_SOCKET_ADDR_IS_FAMILY(&addr->start, AF_INET)) {\n        if (!(addrStartStr = virSocketAddrFormat(&addr->start)))\n            return -1;\n        if (VIR_SOCKET_ADDR_IS_FAMILY(&addr->end, AF_INET)) {\n            if (!(addrEndStr = virSocketAddrFormat(&addr->end)))\n                return -1;\n        }\n    }\n\n    if (protocol && protocol[0]) {\n        rule = virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                                  \"--table\", \"nat\",\n                                  action == ADD ? \"--insert\" : \"--delete\",\n                                  pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                                  \"--source\", networkstr,\n                                  \"-p\", protocol,\n                                  \"!\", \"--destination\", networkstr,\n                                  NULL);\n    } else {\n        rule = virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                                  \"--table\", \"nat\",\n                                  action == ADD ? \"--insert\" : \"--delete\",\n                                  pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                                  \"--source\", networkstr,\n                                  \"!\", \"--destination\", networkstr,\n                                  NULL);\n    }\n\n    if (physdev && physdev[0])\n        virFirewallRuleAddArgList(fw, rule, \"--out-interface\", physdev, NULL);\n\n    if (protocol && protocol[0]) {\n        if (port->start == 0 && port->end == 0) {\n            port->start = 1024;\n            port->end = 65535;\n        }\n\n        if (port->start < port->end && port->end < 65536) {\n            portRangeStr = g_strdup_printf(\":%u-%u\", port->start, port->end);\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Invalid port range '%u-%u'.\"),\n                           port->start, port->end);\n            return -1;\n        }\n    }\n\n    /* Use --jump SNAT if public addr is specified */\n    if (addrStartStr && addrStartStr[0]) {\n        if (addrEndStr && addrEndStr[0]) {\n            natRangeStr = g_strdup_printf(\"%s-%s%s\", addrStartStr, addrEndStr,\n                                          portRangeStr ? portRangeStr : \"\");\n        } else {\n            natRangeStr = g_strdup_printf(\"%s%s\", addrStartStr,\n                                          portRangeStr ? portRangeStr : \"\");\n        }\n\n        virFirewallRuleAddArgList(fw, rule,\n                                  \"--jump\", \"SNAT\",\n                                  \"--to-source\", natRangeStr, NULL);\n    } else {\n        virFirewallRuleAddArgList(fw, rule,\n                                  \"--jump\", \"MASQUERADE\", NULL);\n\n        if (portRangeStr && portRangeStr[0])\n            virFirewallRuleAddArgList(fw, rule,\n                                      \"--to-ports\", &portRangeStr[1], NULL);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\niptablesForwardMasquerade(virFirewallPtr fw,\n                          bool pvt,\n                          virSocketAddr *netaddr,\n                          unsigned int prefix,\n                          const char *physdev,\n                          virSocketAddrRangePtr addr,\n                          virPortRangePtr port,\n                          const char *protocol,\n                          int action)\n{\n    g_autofree char *networkstr = NULL;\n    g_autofree char *addrStartStr = NULL;\n    g_autofree char *addrEndStr = NULL;\n    g_autofree char *portRangeStr = NULL;\n    g_autofree char *natRangeStr = NULL;\n    virFirewallRulePtr rule;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (!VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET)) {\n        /* Higher level code *should* guaranteee it's impossible to get here. */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Attempted to NAT '%s'. NAT is only supported for IPv4.\"),\n                       networkstr);\n        return -1;\n    }\n\n    if (VIR_SOCKET_ADDR_IS_FAMILY(&addr->start, AF_INET)) {\n        if (!(addrStartStr = virSocketAddrFormat(&addr->start)))\n            return -1;\n        if (VIR_SOCKET_ADDR_IS_FAMILY(&addr->end, AF_INET)) {\n            if (!(addrEndStr = virSocketAddrFormat(&addr->end)))\n                return -1;\n        }\n    }\n\n    if (protocol && protocol[0]) {\n        rule = virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                                  \"--table\", \"nat\",\n                                  action == ADD ? \"--insert\" : \"--delete\",\n                                  pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                                  \"--source\", networkstr,\n                                  \"-p\", protocol,\n                                  \"!\", \"--destination\", networkstr,\n                                  NULL);\n    } else {\n        rule = virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                                  \"--table\", \"nat\",\n                                  action == ADD ? \"--insert\" : \"--delete\",\n                                  pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                                  \"--source\", networkstr,\n                                  \"!\", \"--destination\", networkstr,\n                                  NULL);\n    }\n\n    if (physdev && physdev[0])\n        virFirewallRuleAddArgList(fw, rule, \"--out-interface\", physdev, NULL);\n\n    if (protocol && protocol[0]) {\n        if (port->start == 0 && port->end == 0) {\n            port->start = 1024;\n            port->end = 65535;\n        }\n\n        if (port->start < port->end && port->end < 65536) {\n            portRangeStr = g_strdup_printf(\":%u-%u\", port->start, port->end);\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Invalid port range '%u-%u'.\"),\n                           port->start, port->end);\n            return -1;\n        }\n    }\n\n    /* Use --jump SNAT if public addr is specified */\n    if (addrStartStr && addrStartStr[0]) {\n        if (addrEndStr && addrEndStr[0]) {\n            natRangeStr = g_strdup_printf(\"%s-%s%s\", addrStartStr, addrEndStr,\n                                          portRangeStr ? portRangeStr : \"\");\n        } else {\n            natRangeStr = g_strdup_printf(\"%s%s\", addrStartStr,\n                                          portRangeStr ? portRangeStr : \"\");\n        }\n\n        virFirewallRuleAddArgList(fw, rule,\n                                  \"--jump\", \"SNAT\",\n                                  \"--to-source\", natRangeStr, NULL);\n    } else {\n        virFirewallRuleAddArgList(fw, rule,\n                                  \"--jump\", \"MASQUERADE\", NULL);\n\n        if (portRangeStr && portRangeStr[0])\n            virFirewallRuleAddArgList(fw, rule,\n                                      \"--to-ports\", &portRangeStr[1], NULL);\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\niptablesAddForwardMasquerade(virFirewallPtr fw,\n                             virSocketAddr *netaddr,\n                             unsigned int prefix,\n                             const char *physdev,\n                             virSocketAddrRangePtr addr,\n                             virPortRangePtr port,\n                             const char *protocol)\n{\n    return iptablesForwardMasquerade(fw, true, netaddr, prefix,\n                                     physdev, addr, port, protocol, ADD);\n}"
  },
  {
    "function_name": "iptablesForwardMasquerade",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "840-939",
    "snippet": "static int\niptablesForwardMasquerade(virFirewallPtr fw,\n                          bool pvt,\n                          virSocketAddr *netaddr,\n                          unsigned int prefix,\n                          const char *physdev,\n                          virSocketAddrRangePtr addr,\n                          virPortRangePtr port,\n                          const char *protocol,\n                          int action)\n{\n    g_autofree char *networkstr = NULL;\n    g_autofree char *addrStartStr = NULL;\n    g_autofree char *addrEndStr = NULL;\n    g_autofree char *portRangeStr = NULL;\n    g_autofree char *natRangeStr = NULL;\n    virFirewallRulePtr rule;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (!VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET)) {\n        /* Higher level code *should* guaranteee it's impossible to get here. */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Attempted to NAT '%s'. NAT is only supported for IPv4.\"),\n                       networkstr);\n        return -1;\n    }\n\n    if (VIR_SOCKET_ADDR_IS_FAMILY(&addr->start, AF_INET)) {\n        if (!(addrStartStr = virSocketAddrFormat(&addr->start)))\n            return -1;\n        if (VIR_SOCKET_ADDR_IS_FAMILY(&addr->end, AF_INET)) {\n            if (!(addrEndStr = virSocketAddrFormat(&addr->end)))\n                return -1;\n        }\n    }\n\n    if (protocol && protocol[0]) {\n        rule = virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                                  \"--table\", \"nat\",\n                                  action == ADD ? \"--insert\" : \"--delete\",\n                                  pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                                  \"--source\", networkstr,\n                                  \"-p\", protocol,\n                                  \"!\", \"--destination\", networkstr,\n                                  NULL);\n    } else {\n        rule = virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                                  \"--table\", \"nat\",\n                                  action == ADD ? \"--insert\" : \"--delete\",\n                                  pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                                  \"--source\", networkstr,\n                                  \"!\", \"--destination\", networkstr,\n                                  NULL);\n    }\n\n    if (physdev && physdev[0])\n        virFirewallRuleAddArgList(fw, rule, \"--out-interface\", physdev, NULL);\n\n    if (protocol && protocol[0]) {\n        if (port->start == 0 && port->end == 0) {\n            port->start = 1024;\n            port->end = 65535;\n        }\n\n        if (port->start < port->end && port->end < 65536) {\n            portRangeStr = g_strdup_printf(\":%u-%u\", port->start, port->end);\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Invalid port range '%u-%u'.\"),\n                           port->start, port->end);\n            return -1;\n        }\n    }\n\n    /* Use --jump SNAT if public addr is specified */\n    if (addrStartStr && addrStartStr[0]) {\n        if (addrEndStr && addrEndStr[0]) {\n            natRangeStr = g_strdup_printf(\"%s-%s%s\", addrStartStr, addrEndStr,\n                                          portRangeStr ? portRangeStr : \"\");\n        } else {\n            natRangeStr = g_strdup_printf(\"%s%s\", addrStartStr,\n                                          portRangeStr ? portRangeStr : \"\");\n        }\n\n        virFirewallRuleAddArgList(fw, rule,\n                                  \"--jump\", \"SNAT\",\n                                  \"--to-source\", natRangeStr, NULL);\n    } else {\n        virFirewallRuleAddArgList(fw, rule,\n                                  \"--jump\", \"MASQUERADE\", NULL);\n\n        if (portRangeStr && portRangeStr[0])\n            virFirewallRuleAddArgList(fw, rule,\n                                      \"--to-ports\", &portRangeStr[1], NULL);\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFirewallRuleAddArgList",
          "args": [
            "fw",
            "rule",
            "\"--to-ports\"",
            "&portRangeStr[1]",
            "NULL"
          ],
          "line": 934
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallRuleAddArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "541-562",
          "snippet": "void virFirewallRuleAddArgList(virFirewallPtr firewall,\n                               virFirewallRulePtr rule,\n                               ...)\n{\n    va_list list;\n    const char *str;\n\n    VIR_FIREWALL_RULE_RETURN_IF_ERROR(firewall, rule);\n\n    va_start(list, rule);\n\n    while ((str = va_arg(list, char *)) != NULL)\n        ADD_ARG(rule, str);\n\n    va_end(list);\n\n    return;\n\n no_memory:\n    firewall->err = ENOMEM;\n    va_end(list);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virFirewallRuleAddArgList(virFirewallPtr firewall,\n                               virFirewallRulePtr rule,\n                               ...)\n{\n    va_list list;\n    const char *str;\n\n    VIR_FIREWALL_RULE_RETURN_IF_ERROR(firewall, rule);\n\n    va_start(list, rule);\n\n    while ((str = va_arg(list, char *)) != NULL)\n        ADD_ARG(rule, str);\n\n    va_end(list);\n\n    return;\n\n no_memory:\n    firewall->err = ENOMEM;\n    va_end(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s%s\"",
            "addrStartStr",
            "portRangeStr ? portRangeStr : \"\""
          ],
          "line": 922
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Invalid port range '%u-%u'.\")",
            "port->start",
            "port->end"
          ],
          "line": 909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFirewallAddRule",
          "args": [
            "fw",
            "VIR_FIREWALL_LAYER_IPV4",
            "\"--table\"",
            "\"nat\"",
            "action == ADD ? \"--insert\" : \"--delete\"",
            "pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\"",
            "\"--source\"",
            "networkstr",
            "\"!\"",
            "\"--destination\"",
            "networkstr",
            "NULL"
          ],
          "line": 888
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallAddRuleFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "421-434",
          "snippet": "virFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSocketAddrFormat",
          "args": [
            "&addr->end"
          ],
          "line": 873
        },
        "resolved": true,
        "details": {
          "function_name": "virSocketAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocketaddr.c",
          "lines": "441-445",
          "snippet": "char *\nvirSocketAddrFormat(const virSocketAddr *addr)\n{\n    return virSocketAddrFormatFull(addr, false, NULL);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virsocketaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virsocketaddr.h\"\n#include <config.h>\n\nchar *\nvirSocketAddrFormat(const virSocketAddr *addr)\n{\n    return virSocketAddrFormatFull(addr, false, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_IS_FAMILY",
          "args": [
            "&addr->end",
            "AF_INET"
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_IS_FAMILY",
          "args": [
            "&addr->start",
            "AF_INET"
          ],
          "line": 869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Attempted to NAT '%s'. NAT is only supported for IPv4.\")",
            "networkstr"
          ],
          "line": 863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_IS_FAMILY",
          "args": [
            "netaddr",
            "AF_INET"
          ],
          "line": 861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iptablesFormatNetwork",
          "args": [
            "netaddr",
            "prefix"
          ],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesFormatNetwork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "378-406",
          "snippet": "static char *iptablesFormatNetwork(virSocketAddr *netaddr,\n                                   unsigned int prefix)\n{\n    virSocketAddr network;\n    g_autofree char *netstr = NULL;\n    char *ret;\n\n    if (!(VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET) ||\n          VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET6))) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only IPv4 or IPv6 addresses can be used with iptables\"));\n        return NULL;\n    }\n\n    if (virSocketAddrMaskByPrefix(netaddr, prefix, &network) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failure to mask address\"));\n        return NULL;\n    }\n\n    netstr = virSocketAddrFormat(&network);\n\n    if (!netstr)\n        return NULL;\n\n    ret = g_strdup_printf(\"%s/%d\", netstr, prefix);\n\n    return ret;\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *iptablesFormatNetwork(virSocketAddr *netaddr,\n                                   unsigned int prefix)\n{\n    virSocketAddr network;\n    g_autofree char *netstr = NULL;\n    char *ret;\n\n    if (!(VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET) ||\n          VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET6))) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only IPv4 or IPv6 addresses can be used with iptables\"));\n        return NULL;\n    }\n\n    if (virSocketAddrMaskByPrefix(netaddr, prefix, &network) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failure to mask address\"));\n        return NULL;\n    }\n\n    netstr = virSocketAddrFormat(&network);\n\n    if (!netstr)\n        return NULL;\n\n    ret = g_strdup_printf(\"%s/%d\", netstr, prefix);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\niptablesForwardMasquerade(virFirewallPtr fw,\n                          bool pvt,\n                          virSocketAddr *netaddr,\n                          unsigned int prefix,\n                          const char *physdev,\n                          virSocketAddrRangePtr addr,\n                          virPortRangePtr port,\n                          const char *protocol,\n                          int action)\n{\n    g_autofree char *networkstr = NULL;\n    g_autofree char *addrStartStr = NULL;\n    g_autofree char *addrEndStr = NULL;\n    g_autofree char *portRangeStr = NULL;\n    g_autofree char *natRangeStr = NULL;\n    virFirewallRulePtr rule;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (!VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET)) {\n        /* Higher level code *should* guaranteee it's impossible to get here. */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Attempted to NAT '%s'. NAT is only supported for IPv4.\"),\n                       networkstr);\n        return -1;\n    }\n\n    if (VIR_SOCKET_ADDR_IS_FAMILY(&addr->start, AF_INET)) {\n        if (!(addrStartStr = virSocketAddrFormat(&addr->start)))\n            return -1;\n        if (VIR_SOCKET_ADDR_IS_FAMILY(&addr->end, AF_INET)) {\n            if (!(addrEndStr = virSocketAddrFormat(&addr->end)))\n                return -1;\n        }\n    }\n\n    if (protocol && protocol[0]) {\n        rule = virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                                  \"--table\", \"nat\",\n                                  action == ADD ? \"--insert\" : \"--delete\",\n                                  pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                                  \"--source\", networkstr,\n                                  \"-p\", protocol,\n                                  \"!\", \"--destination\", networkstr,\n                                  NULL);\n    } else {\n        rule = virFirewallAddRule(fw, VIR_FIREWALL_LAYER_IPV4,\n                                  \"--table\", \"nat\",\n                                  action == ADD ? \"--insert\" : \"--delete\",\n                                  pvt ? \"LIBVIRT_PRT\" : \"POSTROUTING\",\n                                  \"--source\", networkstr,\n                                  \"!\", \"--destination\", networkstr,\n                                  NULL);\n    }\n\n    if (physdev && physdev[0])\n        virFirewallRuleAddArgList(fw, rule, \"--out-interface\", physdev, NULL);\n\n    if (protocol && protocol[0]) {\n        if (port->start == 0 && port->end == 0) {\n            port->start = 1024;\n            port->end = 65535;\n        }\n\n        if (port->start < port->end && port->end < 65536) {\n            portRangeStr = g_strdup_printf(\":%u-%u\", port->start, port->end);\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Invalid port range '%u-%u'.\"),\n                           port->start, port->end);\n            return -1;\n        }\n    }\n\n    /* Use --jump SNAT if public addr is specified */\n    if (addrStartStr && addrStartStr[0]) {\n        if (addrEndStr && addrEndStr[0]) {\n            natRangeStr = g_strdup_printf(\"%s-%s%s\", addrStartStr, addrEndStr,\n                                          portRangeStr ? portRangeStr : \"\");\n        } else {\n            natRangeStr = g_strdup_printf(\"%s%s\", addrStartStr,\n                                          portRangeStr ? portRangeStr : \"\");\n        }\n\n        virFirewallRuleAddArgList(fw, rule,\n                                  \"--jump\", \"SNAT\",\n                                  \"--to-source\", natRangeStr, NULL);\n    } else {\n        virFirewallRuleAddArgList(fw, rule,\n                                  \"--jump\", \"MASQUERADE\", NULL);\n\n        if (portRangeStr && portRangeStr[0])\n            virFirewallRuleAddArgList(fw, rule,\n                                      \"--to-ports\", &portRangeStr[1], NULL);\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "iptablesRemoveForwardRejectIn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "828-834",
    "snippet": "void\niptablesRemoveForwardRejectIn(virFirewallPtr fw,\n                              virFirewallLayer layer,\n                              const char *iface)\n{\n    iptablesForwardRejectIn(fw, layer, deletePrivate, iface, REMOVE);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool deletePrivate = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesForwardRejectIn",
          "args": [
            "fw",
            "layer",
            "deletePrivate",
            "iface",
            "REMOVE"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesForwardRejectIn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "784-798",
          "snippet": "static void\niptablesForwardRejectIn(virFirewallPtr fw,\n                        virFirewallLayer layer,\n                        bool pvt,\n                        const char *iface,\n                        int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                       \"--out-interface\", iface,\n                       \"--jump\", \"REJECT\",\n                       NULL);\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesForwardRejectIn(virFirewallPtr fw,\n                        virFirewallLayer layer,\n                        bool pvt,\n                        const char *iface,\n                        int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                       \"--out-interface\", iface,\n                       \"--jump\", \"REJECT\",\n                       NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic bool deletePrivate = true;\n\nvoid\niptablesRemoveForwardRejectIn(virFirewallPtr fw,\n                              virFirewallLayer layer,\n                              const char *iface)\n{\n    iptablesForwardRejectIn(fw, layer, deletePrivate, iface, REMOVE);\n}"
  },
  {
    "function_name": "iptablesAddForwardRejectIn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "810-816",
    "snippet": "void\niptablesAddForwardRejectIn(virFirewallPtr fw,\n                           virFirewallLayer layer,\n                           const char *iface)\n{\n    iptablesForwardRejectIn(fw, layer, true, iface, ADD);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesForwardRejectIn",
          "args": [
            "fw",
            "layer",
            "true",
            "iface",
            "ADD"
          ],
          "line": 815
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesForwardRejectIn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "784-798",
          "snippet": "static void\niptablesForwardRejectIn(virFirewallPtr fw,\n                        virFirewallLayer layer,\n                        bool pvt,\n                        const char *iface,\n                        int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                       \"--out-interface\", iface,\n                       \"--jump\", \"REJECT\",\n                       NULL);\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesForwardRejectIn(virFirewallPtr fw,\n                        virFirewallLayer layer,\n                        bool pvt,\n                        const char *iface,\n                        int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                       \"--out-interface\", iface,\n                       \"--jump\", \"REJECT\",\n                       NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\niptablesAddForwardRejectIn(virFirewallPtr fw,\n                           virFirewallLayer layer,\n                           const char *iface)\n{\n    iptablesForwardRejectIn(fw, layer, true, iface, ADD);\n}"
  },
  {
    "function_name": "iptablesForwardRejectIn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "784-798",
    "snippet": "static void\niptablesForwardRejectIn(virFirewallPtr fw,\n                        virFirewallLayer layer,\n                        bool pvt,\n                        const char *iface,\n                        int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                       \"--out-interface\", iface,\n                       \"--jump\", \"REJECT\",\n                       NULL);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFirewallAddRule",
          "args": [
            "fw",
            "layer",
            "\"--table\"",
            "\"filter\"",
            "action == ADD ? \"--insert\" : \"--delete\"",
            "pvt ? \"LIBVIRT_FWI\" : \"FORWARD\"",
            "\"--out-interface\"",
            "iface",
            "\"--jump\"",
            "\"REJECT\"",
            "NULL"
          ],
          "line": 791
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallAddRuleFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "421-434",
          "snippet": "virFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesForwardRejectIn(virFirewallPtr fw,\n                        virFirewallLayer layer,\n                        bool pvt,\n                        const char *iface,\n                        int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                       \"--out-interface\", iface,\n                       \"--jump\", \"REJECT\",\n                       NULL);\n}"
  },
  {
    "function_name": "iptablesRemoveForwardRejectOut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "775-781",
    "snippet": "void\niptablesRemoveForwardRejectOut(virFirewallPtr fw,\n                               virFirewallLayer layer,\n                               const char *iface)\n{\n    iptablesForwardRejectOut(fw, layer, deletePrivate, iface, REMOVE);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool deletePrivate = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesForwardRejectOut",
          "args": [
            "fw",
            "layer",
            "deletePrivate",
            "iface",
            "REMOVE"
          ],
          "line": 780
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesForwardRejectOut",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "731-745",
          "snippet": "static void\niptablesForwardRejectOut(virFirewallPtr fw,\n                         virFirewallLayer layer,\n                         bool pvt,\n                         const char *iface,\n                         int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                       \"--in-interface\", iface,\n                       \"--jump\", \"REJECT\",\n                       NULL);\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesForwardRejectOut(virFirewallPtr fw,\n                         virFirewallLayer layer,\n                         bool pvt,\n                         const char *iface,\n                         int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                       \"--in-interface\", iface,\n                       \"--jump\", \"REJECT\",\n                       NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic bool deletePrivate = true;\n\nvoid\niptablesRemoveForwardRejectOut(virFirewallPtr fw,\n                               virFirewallLayer layer,\n                               const char *iface)\n{\n    iptablesForwardRejectOut(fw, layer, deletePrivate, iface, REMOVE);\n}"
  },
  {
    "function_name": "iptablesAddForwardRejectOut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "757-763",
    "snippet": "void\niptablesAddForwardRejectOut(virFirewallPtr fw,\n                            virFirewallLayer layer,\n                            const char *iface)\n{\n    iptablesForwardRejectOut(fw, layer, true, iface, ADD);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesForwardRejectOut",
          "args": [
            "fw",
            "layer",
            "true",
            "iface",
            "ADD"
          ],
          "line": 762
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesForwardRejectOut",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "731-745",
          "snippet": "static void\niptablesForwardRejectOut(virFirewallPtr fw,\n                         virFirewallLayer layer,\n                         bool pvt,\n                         const char *iface,\n                         int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                       \"--in-interface\", iface,\n                       \"--jump\", \"REJECT\",\n                       NULL);\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesForwardRejectOut(virFirewallPtr fw,\n                         virFirewallLayer layer,\n                         bool pvt,\n                         const char *iface,\n                         int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                       \"--in-interface\", iface,\n                       \"--jump\", \"REJECT\",\n                       NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\niptablesAddForwardRejectOut(virFirewallPtr fw,\n                            virFirewallLayer layer,\n                            const char *iface)\n{\n    iptablesForwardRejectOut(fw, layer, true, iface, ADD);\n}"
  },
  {
    "function_name": "iptablesForwardRejectOut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "731-745",
    "snippet": "static void\niptablesForwardRejectOut(virFirewallPtr fw,\n                         virFirewallLayer layer,\n                         bool pvt,\n                         const char *iface,\n                         int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                       \"--in-interface\", iface,\n                       \"--jump\", \"REJECT\",\n                       NULL);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFirewallAddRule",
          "args": [
            "fw",
            "layer",
            "\"--table\"",
            "\"filter\"",
            "action == ADD ? \"--insert\" : \"--delete\"",
            "pvt ? \"LIBVIRT_FWO\" : \"FORWARD\"",
            "\"--in-interface\"",
            "iface",
            "\"--jump\"",
            "\"REJECT\"",
            "NULL"
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallAddRuleFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "421-434",
          "snippet": "virFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesForwardRejectOut(virFirewallPtr fw,\n                         virFirewallLayer layer,\n                         bool pvt,\n                         const char *iface,\n                         int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                       \"--in-interface\", iface,\n                       \"--jump\", \"REJECT\",\n                       NULL);\n}"
  },
  {
    "function_name": "iptablesRemoveForwardAllowCross",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "723-729",
    "snippet": "void\niptablesRemoveForwardAllowCross(virFirewallPtr fw,\n                                virFirewallLayer layer,\n                                const char *iface)\n{\n    iptablesForwardAllowCross(fw, layer, deletePrivate, iface, REMOVE);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool deletePrivate = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesForwardAllowCross",
          "args": [
            "fw",
            "layer",
            "deletePrivate",
            "iface",
            "REMOVE"
          ],
          "line": 728
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesForwardAllowCross",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "676-691",
          "snippet": "static void\niptablesForwardAllowCross(virFirewallPtr fw,\n                          virFirewallLayer layer,\n                          bool pvt,\n                          const char *iface,\n                          int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWX\" : \"FORWARD\",\n                       \"--in-interface\", iface,\n                       \"--out-interface\", iface,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesForwardAllowCross(virFirewallPtr fw,\n                          virFirewallLayer layer,\n                          bool pvt,\n                          const char *iface,\n                          int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWX\" : \"FORWARD\",\n                       \"--in-interface\", iface,\n                       \"--out-interface\", iface,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic bool deletePrivate = true;\n\nvoid\niptablesRemoveForwardAllowCross(virFirewallPtr fw,\n                                virFirewallLayer layer,\n                                const char *iface)\n{\n    iptablesForwardAllowCross(fw, layer, deletePrivate, iface, REMOVE);\n}"
  },
  {
    "function_name": "iptablesAddForwardAllowCross",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "704-710",
    "snippet": "void\niptablesAddForwardAllowCross(virFirewallPtr fw,\n                             virFirewallLayer layer,\n                             const char *iface)\n{\n    iptablesForwardAllowCross(fw, layer, true, iface, ADD);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesForwardAllowCross",
          "args": [
            "fw",
            "layer",
            "true",
            "iface",
            "ADD"
          ],
          "line": 709
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesForwardAllowCross",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "676-691",
          "snippet": "static void\niptablesForwardAllowCross(virFirewallPtr fw,\n                          virFirewallLayer layer,\n                          bool pvt,\n                          const char *iface,\n                          int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWX\" : \"FORWARD\",\n                       \"--in-interface\", iface,\n                       \"--out-interface\", iface,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesForwardAllowCross(virFirewallPtr fw,\n                          virFirewallLayer layer,\n                          bool pvt,\n                          const char *iface,\n                          int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWX\" : \"FORWARD\",\n                       \"--in-interface\", iface,\n                       \"--out-interface\", iface,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\niptablesAddForwardAllowCross(virFirewallPtr fw,\n                             virFirewallLayer layer,\n                             const char *iface)\n{\n    iptablesForwardAllowCross(fw, layer, true, iface, ADD);\n}"
  },
  {
    "function_name": "iptablesForwardAllowCross",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "676-691",
    "snippet": "static void\niptablesForwardAllowCross(virFirewallPtr fw,\n                          virFirewallLayer layer,\n                          bool pvt,\n                          const char *iface,\n                          int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWX\" : \"FORWARD\",\n                       \"--in-interface\", iface,\n                       \"--out-interface\", iface,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFirewallAddRule",
          "args": [
            "fw",
            "layer",
            "\"--table\"",
            "\"filter\"",
            "action == ADD ? \"--insert\" : \"--delete\"",
            "pvt ? \"LIBVIRT_FWX\" : \"FORWARD\"",
            "\"--in-interface\"",
            "iface",
            "\"--out-interface\"",
            "iface",
            "\"--jump\"",
            "\"ACCEPT\"",
            "NULL"
          ],
          "line": 683
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallAddRuleFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "421-434",
          "snippet": "virFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesForwardAllowCross(virFirewallPtr fw,\n                          virFirewallLayer layer,\n                          bool pvt,\n                          const char *iface,\n                          int action)\n{\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_FWX\" : \"FORWARD\",\n                       \"--in-interface\", iface,\n                       \"--out-interface\", iface,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}"
  },
  {
    "function_name": "iptablesRemoveForwardAllowIn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "666-674",
    "snippet": "int\niptablesRemoveForwardAllowIn(virFirewallPtr fw,\n                             virSocketAddr *netaddr,\n                             unsigned int prefix,\n                             const char *iface,\n                             const char *physdev)\n{\n    return iptablesForwardAllowIn(fw, deletePrivate, netaddr, prefix, iface, physdev, REMOVE);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool deletePrivate = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesForwardAllowIn",
          "args": [
            "fw",
            "deletePrivate",
            "netaddr",
            "prefix",
            "iface",
            "physdev",
            "REMOVE"
          ],
          "line": 673
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesForwardAllowIn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "592-628",
          "snippet": "static int\niptablesForwardAllowIn(virFirewallPtr fw,\n                       bool pvt,\n                       virSocketAddr *netaddr,\n                       unsigned int prefix,\n                       const char *iface,\n                       const char *physdev,\n                       int action)\n{\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--in-interface\", physdev,\n                           \"--out-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--out-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    return 0;\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\niptablesForwardAllowIn(virFirewallPtr fw,\n                       bool pvt,\n                       virSocketAddr *netaddr,\n                       unsigned int prefix,\n                       const char *iface,\n                       const char *physdev,\n                       int action)\n{\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--in-interface\", physdev,\n                           \"--out-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--out-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic bool deletePrivate = true;\n\nint\niptablesRemoveForwardAllowIn(virFirewallPtr fw,\n                             virSocketAddr *netaddr,\n                             unsigned int prefix,\n                             const char *iface,\n                             const char *physdev)\n{\n    return iptablesForwardAllowIn(fw, deletePrivate, netaddr, prefix, iface, physdev, REMOVE);\n}"
  },
  {
    "function_name": "iptablesAddForwardAllowIn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "643-651",
    "snippet": "int\niptablesAddForwardAllowIn(virFirewallPtr fw,\n                          virSocketAddr *netaddr,\n                          unsigned int prefix,\n                          const char *iface,\n                          const char *physdev)\n{\n    return iptablesForwardAllowIn(fw, true, netaddr, prefix, iface, physdev, ADD);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesForwardAllowIn",
          "args": [
            "fw",
            "true",
            "netaddr",
            "prefix",
            "iface",
            "physdev",
            "ADD"
          ],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesForwardAllowIn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "592-628",
          "snippet": "static int\niptablesForwardAllowIn(virFirewallPtr fw,\n                       bool pvt,\n                       virSocketAddr *netaddr,\n                       unsigned int prefix,\n                       const char *iface,\n                       const char *physdev,\n                       int action)\n{\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--in-interface\", physdev,\n                           \"--out-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--out-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    return 0;\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\niptablesForwardAllowIn(virFirewallPtr fw,\n                       bool pvt,\n                       virSocketAddr *netaddr,\n                       unsigned int prefix,\n                       const char *iface,\n                       const char *physdev,\n                       int action)\n{\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--in-interface\", physdev,\n                           \"--out-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--out-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\niptablesAddForwardAllowIn(virFirewallPtr fw,\n                          virSocketAddr *netaddr,\n                          unsigned int prefix,\n                          const char *iface,\n                          const char *physdev)\n{\n    return iptablesForwardAllowIn(fw, true, netaddr, prefix, iface, physdev, ADD);\n}"
  },
  {
    "function_name": "iptablesForwardAllowIn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "592-628",
    "snippet": "static int\niptablesForwardAllowIn(virFirewallPtr fw,\n                       bool pvt,\n                       virSocketAddr *netaddr,\n                       unsigned int prefix,\n                       const char *iface,\n                       const char *physdev,\n                       int action)\n{\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--in-interface\", physdev,\n                           \"--out-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--out-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    return 0;\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFirewallAddRule",
          "args": [
            "fw",
            "layer",
            "\"--table\"",
            "\"filter\"",
            "action == ADD ? \"--insert\" : \"--delete\"",
            "pvt ? \"LIBVIRT_FWI\" : \"FORWARD\"",
            "\"--destination\"",
            "networkstr",
            "\"--out-interface\"",
            "iface",
            "\"--jump\"",
            "\"ACCEPT\"",
            "NULL"
          ],
          "line": 619
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallAddRuleFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "421-434",
          "snippet": "virFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}"
        }
      },
      {
        "call_info": {
          "callee": "iptablesFormatNetwork",
          "args": [
            "netaddr",
            "prefix"
          ],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesFormatNetwork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "378-406",
          "snippet": "static char *iptablesFormatNetwork(virSocketAddr *netaddr,\n                                   unsigned int prefix)\n{\n    virSocketAddr network;\n    g_autofree char *netstr = NULL;\n    char *ret;\n\n    if (!(VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET) ||\n          VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET6))) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only IPv4 or IPv6 addresses can be used with iptables\"));\n        return NULL;\n    }\n\n    if (virSocketAddrMaskByPrefix(netaddr, prefix, &network) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failure to mask address\"));\n        return NULL;\n    }\n\n    netstr = virSocketAddrFormat(&network);\n\n    if (!netstr)\n        return NULL;\n\n    ret = g_strdup_printf(\"%s/%d\", netstr, prefix);\n\n    return ret;\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *iptablesFormatNetwork(virSocketAddr *netaddr,\n                                   unsigned int prefix)\n{\n    virSocketAddr network;\n    g_autofree char *netstr = NULL;\n    char *ret;\n\n    if (!(VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET) ||\n          VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET6))) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only IPv4 or IPv6 addresses can be used with iptables\"));\n        return NULL;\n    }\n\n    if (virSocketAddrMaskByPrefix(netaddr, prefix, &network) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failure to mask address\"));\n        return NULL;\n    }\n\n    netstr = virSocketAddrFormat(&network);\n\n    if (!netstr)\n        return NULL;\n\n    ret = g_strdup_printf(\"%s/%d\", netstr, prefix);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_FAMILY",
          "args": [
            "netaddr"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\niptablesForwardAllowIn(virFirewallPtr fw,\n                       bool pvt,\n                       virSocketAddr *netaddr,\n                       unsigned int prefix,\n                       const char *iface,\n                       const char *physdev,\n                       int action)\n{\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--in-interface\", physdev,\n                           \"--out-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--out-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    return 0;\n}"
  },
  {
    "function_name": "iptablesRemoveForwardAllowRelatedIn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "580-588",
    "snippet": "int\niptablesRemoveForwardAllowRelatedIn(virFirewallPtr fw,\n                                    virSocketAddr *netaddr,\n                                    unsigned int prefix,\n                                    const char *iface,\n                                    const char *physdev)\n{\n    return iptablesForwardAllowRelatedIn(fw, deletePrivate, netaddr, prefix, iface, physdev, REMOVE);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool deletePrivate = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesForwardAllowRelatedIn",
          "args": [
            "fw",
            "deletePrivate",
            "netaddr",
            "prefix",
            "iface",
            "physdev",
            "REMOVE"
          ],
          "line": 587
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesForwardAllowRelatedIn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "501-542",
          "snippet": "static int\niptablesForwardAllowRelatedIn(virFirewallPtr fw,\n                              bool pvt,\n                              virSocketAddr *netaddr,\n                              unsigned int prefix,\n                              const char *iface,\n                              const char *physdev,\n                              int action)\n{\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--in-interface\", physdev,\n                           \"--out-interface\", iface,\n                           \"--match\", \"conntrack\",\n                           \"--ctstate\", \"ESTABLISHED,RELATED\",\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--out-interface\", iface,\n                           \"--match\", \"conntrack\",\n                           \"--ctstate\", \"ESTABLISHED,RELATED\",\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n\n    return 0;\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\niptablesForwardAllowRelatedIn(virFirewallPtr fw,\n                              bool pvt,\n                              virSocketAddr *netaddr,\n                              unsigned int prefix,\n                              const char *iface,\n                              const char *physdev,\n                              int action)\n{\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--in-interface\", physdev,\n                           \"--out-interface\", iface,\n                           \"--match\", \"conntrack\",\n                           \"--ctstate\", \"ESTABLISHED,RELATED\",\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--out-interface\", iface,\n                           \"--match\", \"conntrack\",\n                           \"--ctstate\", \"ESTABLISHED,RELATED\",\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic bool deletePrivate = true;\n\nint\niptablesRemoveForwardAllowRelatedIn(virFirewallPtr fw,\n                                    virSocketAddr *netaddr,\n                                    unsigned int prefix,\n                                    const char *iface,\n                                    const char *physdev)\n{\n    return iptablesForwardAllowRelatedIn(fw, deletePrivate, netaddr, prefix, iface, physdev, REMOVE);\n}"
  },
  {
    "function_name": "iptablesAddForwardAllowRelatedIn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "557-565",
    "snippet": "int\niptablesAddForwardAllowRelatedIn(virFirewallPtr fw,\n                                 virSocketAddr *netaddr,\n                                 unsigned int prefix,\n                                 const char *iface,\n                                 const char *physdev)\n{\n    return iptablesForwardAllowRelatedIn(fw, true, netaddr, prefix, iface, physdev, ADD);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesForwardAllowRelatedIn",
          "args": [
            "fw",
            "true",
            "netaddr",
            "prefix",
            "iface",
            "physdev",
            "ADD"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesForwardAllowRelatedIn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "501-542",
          "snippet": "static int\niptablesForwardAllowRelatedIn(virFirewallPtr fw,\n                              bool pvt,\n                              virSocketAddr *netaddr,\n                              unsigned int prefix,\n                              const char *iface,\n                              const char *physdev,\n                              int action)\n{\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--in-interface\", physdev,\n                           \"--out-interface\", iface,\n                           \"--match\", \"conntrack\",\n                           \"--ctstate\", \"ESTABLISHED,RELATED\",\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--out-interface\", iface,\n                           \"--match\", \"conntrack\",\n                           \"--ctstate\", \"ESTABLISHED,RELATED\",\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n\n    return 0;\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\niptablesForwardAllowRelatedIn(virFirewallPtr fw,\n                              bool pvt,\n                              virSocketAddr *netaddr,\n                              unsigned int prefix,\n                              const char *iface,\n                              const char *physdev,\n                              int action)\n{\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--in-interface\", physdev,\n                           \"--out-interface\", iface,\n                           \"--match\", \"conntrack\",\n                           \"--ctstate\", \"ESTABLISHED,RELATED\",\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--out-interface\", iface,\n                           \"--match\", \"conntrack\",\n                           \"--ctstate\", \"ESTABLISHED,RELATED\",\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\niptablesAddForwardAllowRelatedIn(virFirewallPtr fw,\n                                 virSocketAddr *netaddr,\n                                 unsigned int prefix,\n                                 const char *iface,\n                                 const char *physdev)\n{\n    return iptablesForwardAllowRelatedIn(fw, true, netaddr, prefix, iface, physdev, ADD);\n}"
  },
  {
    "function_name": "iptablesForwardAllowRelatedIn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "501-542",
    "snippet": "static int\niptablesForwardAllowRelatedIn(virFirewallPtr fw,\n                              bool pvt,\n                              virSocketAddr *netaddr,\n                              unsigned int prefix,\n                              const char *iface,\n                              const char *physdev,\n                              int action)\n{\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--in-interface\", physdev,\n                           \"--out-interface\", iface,\n                           \"--match\", \"conntrack\",\n                           \"--ctstate\", \"ESTABLISHED,RELATED\",\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--out-interface\", iface,\n                           \"--match\", \"conntrack\",\n                           \"--ctstate\", \"ESTABLISHED,RELATED\",\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n\n    return 0;\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFirewallAddRule",
          "args": [
            "fw",
            "layer",
            "\"--table\"",
            "\"filter\"",
            "action == ADD ? \"--insert\" : \"--delete\"",
            "pvt ? \"LIBVIRT_FWI\" : \"FORWARD\"",
            "\"--destination\"",
            "networkstr",
            "\"--out-interface\"",
            "iface",
            "\"--match\"",
            "\"conntrack\"",
            "\"--ctstate\"",
            "\"ESTABLISHED,RELATED\"",
            "\"--jump\"",
            "\"ACCEPT\"",
            "NULL"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallAddRuleFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "421-434",
          "snippet": "virFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}"
        }
      },
      {
        "call_info": {
          "callee": "iptablesFormatNetwork",
          "args": [
            "netaddr",
            "prefix"
          ],
          "line": 514
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesFormatNetwork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "378-406",
          "snippet": "static char *iptablesFormatNetwork(virSocketAddr *netaddr,\n                                   unsigned int prefix)\n{\n    virSocketAddr network;\n    g_autofree char *netstr = NULL;\n    char *ret;\n\n    if (!(VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET) ||\n          VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET6))) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only IPv4 or IPv6 addresses can be used with iptables\"));\n        return NULL;\n    }\n\n    if (virSocketAddrMaskByPrefix(netaddr, prefix, &network) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failure to mask address\"));\n        return NULL;\n    }\n\n    netstr = virSocketAddrFormat(&network);\n\n    if (!netstr)\n        return NULL;\n\n    ret = g_strdup_printf(\"%s/%d\", netstr, prefix);\n\n    return ret;\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *iptablesFormatNetwork(virSocketAddr *netaddr,\n                                   unsigned int prefix)\n{\n    virSocketAddr network;\n    g_autofree char *netstr = NULL;\n    char *ret;\n\n    if (!(VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET) ||\n          VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET6))) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only IPv4 or IPv6 addresses can be used with iptables\"));\n        return NULL;\n    }\n\n    if (virSocketAddrMaskByPrefix(netaddr, prefix, &network) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failure to mask address\"));\n        return NULL;\n    }\n\n    netstr = virSocketAddrFormat(&network);\n\n    if (!netstr)\n        return NULL;\n\n    ret = g_strdup_printf(\"%s/%d\", netstr, prefix);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_FAMILY",
          "args": [
            "netaddr"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\niptablesForwardAllowRelatedIn(virFirewallPtr fw,\n                              bool pvt,\n                              virSocketAddr *netaddr,\n                              unsigned int prefix,\n                              const char *iface,\n                              const char *physdev,\n                              int action)\n{\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n    g_autofree char *networkstr = NULL;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--in-interface\", physdev,\n                           \"--out-interface\", iface,\n                           \"--match\", \"conntrack\",\n                           \"--ctstate\", \"ESTABLISHED,RELATED\",\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWI\" : \"FORWARD\",\n                           \"--destination\", networkstr,\n                           \"--out-interface\", iface,\n                           \"--match\", \"conntrack\",\n                           \"--ctstate\", \"ESTABLISHED,RELATED\",\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n\n    return 0;\n}"
  },
  {
    "function_name": "iptablesRemoveForwardAllowOut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "487-495",
    "snippet": "int\niptablesRemoveForwardAllowOut(virFirewallPtr fw,\n                              virSocketAddr *netaddr,\n                              unsigned int prefix,\n                              const char *iface,\n                              const char *physdev)\n{\n    return iptablesForwardAllowOut(fw, deletePrivate, netaddr, prefix, iface, physdev, REMOVE);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool deletePrivate = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesForwardAllowOut",
          "args": [
            "fw",
            "deletePrivate",
            "netaddr",
            "prefix",
            "iface",
            "physdev",
            "REMOVE"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesForwardAllowOut",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "412-449",
          "snippet": "static int\niptablesForwardAllowOut(virFirewallPtr fw,\n                        bool pvt,\n                        virSocketAddr *netaddr,\n                        unsigned int prefix,\n                        const char *iface,\n                        const char *physdev,\n                        int action)\n{\n    g_autofree char *networkstr = NULL;\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                           \"--source\", networkstr,\n                           \"--in-interface\", iface,\n                           \"--out-interface\", physdev,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                           \"--source\", networkstr,\n                           \"--in-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n\n    return 0;\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\niptablesForwardAllowOut(virFirewallPtr fw,\n                        bool pvt,\n                        virSocketAddr *netaddr,\n                        unsigned int prefix,\n                        const char *iface,\n                        const char *physdev,\n                        int action)\n{\n    g_autofree char *networkstr = NULL;\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                           \"--source\", networkstr,\n                           \"--in-interface\", iface,\n                           \"--out-interface\", physdev,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                           \"--source\", networkstr,\n                           \"--in-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic bool deletePrivate = true;\n\nint\niptablesRemoveForwardAllowOut(virFirewallPtr fw,\n                              virSocketAddr *netaddr,\n                              unsigned int prefix,\n                              const char *iface,\n                              const char *physdev)\n{\n    return iptablesForwardAllowOut(fw, deletePrivate, netaddr, prefix, iface, physdev, REMOVE);\n}"
  },
  {
    "function_name": "iptablesAddForwardAllowOut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "464-472",
    "snippet": "int\niptablesAddForwardAllowOut(virFirewallPtr fw,\n                           virSocketAddr *netaddr,\n                           unsigned int prefix,\n                           const char *iface,\n                           const char *physdev)\n{\n    return iptablesForwardAllowOut(fw, true, netaddr, prefix, iface, physdev, ADD);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesForwardAllowOut",
          "args": [
            "fw",
            "true",
            "netaddr",
            "prefix",
            "iface",
            "physdev",
            "ADD"
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesForwardAllowOut",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "412-449",
          "snippet": "static int\niptablesForwardAllowOut(virFirewallPtr fw,\n                        bool pvt,\n                        virSocketAddr *netaddr,\n                        unsigned int prefix,\n                        const char *iface,\n                        const char *physdev,\n                        int action)\n{\n    g_autofree char *networkstr = NULL;\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                           \"--source\", networkstr,\n                           \"--in-interface\", iface,\n                           \"--out-interface\", physdev,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                           \"--source\", networkstr,\n                           \"--in-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n\n    return 0;\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\niptablesForwardAllowOut(virFirewallPtr fw,\n                        bool pvt,\n                        virSocketAddr *netaddr,\n                        unsigned int prefix,\n                        const char *iface,\n                        const char *physdev,\n                        int action)\n{\n    g_autofree char *networkstr = NULL;\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                           \"--source\", networkstr,\n                           \"--in-interface\", iface,\n                           \"--out-interface\", physdev,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                           \"--source\", networkstr,\n                           \"--in-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\niptablesAddForwardAllowOut(virFirewallPtr fw,\n                           virSocketAddr *netaddr,\n                           unsigned int prefix,\n                           const char *iface,\n                           const char *physdev)\n{\n    return iptablesForwardAllowOut(fw, true, netaddr, prefix, iface, physdev, ADD);\n}"
  },
  {
    "function_name": "iptablesForwardAllowOut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "412-449",
    "snippet": "static int\niptablesForwardAllowOut(virFirewallPtr fw,\n                        bool pvt,\n                        virSocketAddr *netaddr,\n                        unsigned int prefix,\n                        const char *iface,\n                        const char *physdev,\n                        int action)\n{\n    g_autofree char *networkstr = NULL;\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                           \"--source\", networkstr,\n                           \"--in-interface\", iface,\n                           \"--out-interface\", physdev,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                           \"--source\", networkstr,\n                           \"--in-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n\n    return 0;\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFirewallAddRule",
          "args": [
            "fw",
            "layer",
            "\"--table\"",
            "\"filter\"",
            "action == ADD ? \"--insert\" : \"--delete\"",
            "pvt ? \"LIBVIRT_FWO\" : \"FORWARD\"",
            "\"--source\"",
            "networkstr",
            "\"--in-interface\"",
            "iface",
            "\"--jump\"",
            "\"ACCEPT\"",
            "NULL"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallAddRuleFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "421-434",
          "snippet": "virFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}"
        }
      },
      {
        "call_info": {
          "callee": "iptablesFormatNetwork",
          "args": [
            "netaddr",
            "prefix"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesFormatNetwork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "378-406",
          "snippet": "static char *iptablesFormatNetwork(virSocketAddr *netaddr,\n                                   unsigned int prefix)\n{\n    virSocketAddr network;\n    g_autofree char *netstr = NULL;\n    char *ret;\n\n    if (!(VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET) ||\n          VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET6))) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only IPv4 or IPv6 addresses can be used with iptables\"));\n        return NULL;\n    }\n\n    if (virSocketAddrMaskByPrefix(netaddr, prefix, &network) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failure to mask address\"));\n        return NULL;\n    }\n\n    netstr = virSocketAddrFormat(&network);\n\n    if (!netstr)\n        return NULL;\n\n    ret = g_strdup_printf(\"%s/%d\", netstr, prefix);\n\n    return ret;\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *iptablesFormatNetwork(virSocketAddr *netaddr,\n                                   unsigned int prefix)\n{\n    virSocketAddr network;\n    g_autofree char *netstr = NULL;\n    char *ret;\n\n    if (!(VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET) ||\n          VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET6))) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only IPv4 or IPv6 addresses can be used with iptables\"));\n        return NULL;\n    }\n\n    if (virSocketAddrMaskByPrefix(netaddr, prefix, &network) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failure to mask address\"));\n        return NULL;\n    }\n\n    netstr = virSocketAddrFormat(&network);\n\n    if (!netstr)\n        return NULL;\n\n    ret = g_strdup_printf(\"%s/%d\", netstr, prefix);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_FAMILY",
          "args": [
            "netaddr"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\niptablesForwardAllowOut(virFirewallPtr fw,\n                        bool pvt,\n                        virSocketAddr *netaddr,\n                        unsigned int prefix,\n                        const char *iface,\n                        const char *physdev,\n                        int action)\n{\n    g_autofree char *networkstr = NULL;\n    virFirewallLayer layer = VIR_SOCKET_ADDR_FAMILY(netaddr) == AF_INET ?\n        VIR_FIREWALL_LAYER_IPV4 : VIR_FIREWALL_LAYER_IPV6;\n\n    if (!(networkstr = iptablesFormatNetwork(netaddr, prefix)))\n        return -1;\n\n    if (physdev && physdev[0])\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                           \"--source\", networkstr,\n                           \"--in-interface\", iface,\n                           \"--out-interface\", physdev,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n    else\n        virFirewallAddRule(fw, layer,\n                           \"--table\", \"filter\",\n                           action == ADD ? \"--insert\" : \"--delete\",\n                           pvt ? \"LIBVIRT_FWO\" : \"FORWARD\",\n                           \"--source\", networkstr,\n                           \"--in-interface\", iface,\n                           \"--jump\", \"ACCEPT\",\n                           NULL);\n\n    return 0;\n}"
  },
  {
    "function_name": "iptablesFormatNetwork",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "378-406",
    "snippet": "static char *iptablesFormatNetwork(virSocketAddr *netaddr,\n                                   unsigned int prefix)\n{\n    virSocketAddr network;\n    g_autofree char *netstr = NULL;\n    char *ret;\n\n    if (!(VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET) ||\n          VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET6))) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only IPv4 or IPv6 addresses can be used with iptables\"));\n        return NULL;\n    }\n\n    if (virSocketAddrMaskByPrefix(netaddr, prefix, &network) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failure to mask address\"));\n        return NULL;\n    }\n\n    netstr = virSocketAddrFormat(&network);\n\n    if (!netstr)\n        return NULL;\n\n    ret = g_strdup_printf(\"%s/%d\", netstr, prefix);\n\n    return ret;\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%d\"",
            "netstr",
            "prefix"
          ],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSocketAddrFormat",
          "args": [
            "&network"
          ],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "virSocketAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocketaddr.c",
          "lines": "441-445",
          "snippet": "char *\nvirSocketAddrFormat(const virSocketAddr *addr)\n{\n    return virSocketAddrFormatFull(addr, false, NULL);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virsocketaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virsocketaddr.h\"\n#include <config.h>\n\nchar *\nvirSocketAddrFormat(const virSocketAddr *addr)\n{\n    return virSocketAddrFormatFull(addr, false, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Failure to mask address\")"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSocketAddrMaskByPrefix",
          "args": [
            "netaddr",
            "prefix",
            "&network"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "virSocketAddrMaskByPrefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocketaddr.c",
          "lines": "679-693",
          "snippet": "int\nvirSocketAddrMaskByPrefix(const virSocketAddr *addr,\n                          unsigned int prefix,\n                          virSocketAddrPtr network)\n{\n    virSocketAddr netmask;\n\n    if (virSocketAddrPrefixToNetmask(prefix, &netmask,\n                                     addr->data.stor.ss_family) < 0) {\n        network->data.stor.ss_family = AF_UNSPEC;\n        return -1;\n    }\n\n    return virSocketAddrMask(addr, &netmask, network);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virsocketaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virsocketaddr.h\"\n#include <config.h>\n\nint\nvirSocketAddrMaskByPrefix(const virSocketAddr *addr,\n                          unsigned int prefix,\n                          virSocketAddrPtr network)\n{\n    virSocketAddr netmask;\n\n    if (virSocketAddrPrefixToNetmask(prefix, &netmask,\n                                     addr->data.stor.ss_family) < 0) {\n        network->data.stor.ss_family = AF_UNSPEC;\n        return -1;\n    }\n\n    return virSocketAddrMask(addr, &netmask, network);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Only IPv4 or IPv6 addresses can be used with iptables\")"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_IS_FAMILY",
          "args": [
            "netaddr",
            "AF_INET6"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_IS_FAMILY",
          "args": [
            "netaddr",
            "AF_INET"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *iptablesFormatNetwork(virSocketAddr *netaddr,\n                                   unsigned int prefix)\n{\n    virSocketAddr network;\n    g_autofree char *netstr = NULL;\n    char *ret;\n\n    if (!(VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET) ||\n          VIR_SOCKET_ADDR_IS_FAMILY(netaddr, AF_INET6))) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only IPv4 or IPv6 addresses can be used with iptables\"));\n        return NULL;\n    }\n\n    if (virSocketAddrMaskByPrefix(netaddr, prefix, &network) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failure to mask address\"));\n        return NULL;\n    }\n\n    netstr = virSocketAddrFormat(&network);\n\n    if (!netstr)\n        return NULL;\n\n    ret = g_strdup_printf(\"%s/%d\", netstr, prefix);\n\n    return ret;\n}"
  },
  {
    "function_name": "iptablesRemoveUdpOutput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "368-375",
    "snippet": "void\niptablesRemoveUdpOutput(virFirewallPtr fw,\n                        virFirewallLayer layer,\n                        const char *iface,\n                        int port)\n{\n    iptablesOutput(fw, layer, deletePrivate, iface, port, REMOVE, 0);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool deletePrivate = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesOutput",
          "args": [
            "fw",
            "layer",
            "deletePrivate",
            "iface",
            "port",
            "REMOVE",
            "0"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesOutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "208-231",
          "snippet": "static void\niptablesOutput(virFirewallPtr fw,\n               virFirewallLayer layer,\n               bool pvt,\n               const char *iface,\n               int port,\n               int action,\n               int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_OUT\" : \"OUTPUT\",\n                       \"--out-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesOutput(virFirewallPtr fw,\n               virFirewallLayer layer,\n               bool pvt,\n               const char *iface,\n               int port,\n               int action,\n               int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_OUT\" : \"OUTPUT\",\n                       \"--out-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic bool deletePrivate = true;\n\nvoid\niptablesRemoveUdpOutput(virFirewallPtr fw,\n                        virFirewallLayer layer,\n                        const char *iface,\n                        int port)\n{\n    iptablesOutput(fw, layer, deletePrivate, iface, port, REMOVE, 0);\n}"
  },
  {
    "function_name": "iptablesAddUdpOutput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "350-357",
    "snippet": "void\niptablesAddUdpOutput(virFirewallPtr fw,\n                     virFirewallLayer layer,\n                     const char *iface,\n                     int port)\n{\n    iptablesOutput(fw, layer, true, iface, port, ADD, 0);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesOutput",
          "args": [
            "fw",
            "layer",
            "true",
            "iface",
            "port",
            "ADD",
            "0"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesOutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "208-231",
          "snippet": "static void\niptablesOutput(virFirewallPtr fw,\n               virFirewallLayer layer,\n               bool pvt,\n               const char *iface,\n               int port,\n               int action,\n               int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_OUT\" : \"OUTPUT\",\n                       \"--out-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesOutput(virFirewallPtr fw,\n               virFirewallLayer layer,\n               bool pvt,\n               const char *iface,\n               int port,\n               int action,\n               int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_OUT\" : \"OUTPUT\",\n                       \"--out-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\niptablesAddUdpOutput(virFirewallPtr fw,\n                     virFirewallLayer layer,\n                     const char *iface,\n                     int port)\n{\n    iptablesOutput(fw, layer, true, iface, port, ADD, 0);\n}"
  },
  {
    "function_name": "iptablesRemoveTcpOutput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "332-339",
    "snippet": "void\niptablesRemoveTcpOutput(virFirewallPtr fw,\n                        virFirewallLayer layer,\n                        const char *iface,\n                        int port)\n{\n    iptablesOutput(fw, layer, deletePrivate, iface, port, REMOVE, 1);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool deletePrivate = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesOutput",
          "args": [
            "fw",
            "layer",
            "deletePrivate",
            "iface",
            "port",
            "REMOVE",
            "1"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesOutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "208-231",
          "snippet": "static void\niptablesOutput(virFirewallPtr fw,\n               virFirewallLayer layer,\n               bool pvt,\n               const char *iface,\n               int port,\n               int action,\n               int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_OUT\" : \"OUTPUT\",\n                       \"--out-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesOutput(virFirewallPtr fw,\n               virFirewallLayer layer,\n               bool pvt,\n               const char *iface,\n               int port,\n               int action,\n               int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_OUT\" : \"OUTPUT\",\n                       \"--out-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic bool deletePrivate = true;\n\nvoid\niptablesRemoveTcpOutput(virFirewallPtr fw,\n                        virFirewallLayer layer,\n                        const char *iface,\n                        int port)\n{\n    iptablesOutput(fw, layer, deletePrivate, iface, port, REMOVE, 1);\n}"
  },
  {
    "function_name": "iptablesAddTcpOutput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "314-321",
    "snippet": "void\niptablesAddTcpOutput(virFirewallPtr fw,\n                     virFirewallLayer layer,\n                     const char *iface,\n                     int port)\n{\n    iptablesOutput(fw, layer, true, iface, port, ADD, 1);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesOutput",
          "args": [
            "fw",
            "layer",
            "true",
            "iface",
            "port",
            "ADD",
            "1"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesOutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "208-231",
          "snippet": "static void\niptablesOutput(virFirewallPtr fw,\n               virFirewallLayer layer,\n               bool pvt,\n               const char *iface,\n               int port,\n               int action,\n               int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_OUT\" : \"OUTPUT\",\n                       \"--out-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesOutput(virFirewallPtr fw,\n               virFirewallLayer layer,\n               bool pvt,\n               const char *iface,\n               int port,\n               int action,\n               int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_OUT\" : \"OUTPUT\",\n                       \"--out-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\niptablesAddTcpOutput(virFirewallPtr fw,\n                     virFirewallLayer layer,\n                     const char *iface,\n                     int port)\n{\n    iptablesOutput(fw, layer, true, iface, port, ADD, 1);\n}"
  },
  {
    "function_name": "iptablesRemoveUdpInput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "296-303",
    "snippet": "void\niptablesRemoveUdpInput(virFirewallPtr fw,\n                       virFirewallLayer layer,\n                       const char *iface,\n                       int port)\n{\n    iptablesInput(fw, layer, deletePrivate, iface, port, REMOVE, 0);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool deletePrivate = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesInput",
          "args": [
            "fw",
            "layer",
            "deletePrivate",
            "iface",
            "port",
            "REMOVE",
            "0"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesInput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "183-206",
          "snippet": "static void\niptablesInput(virFirewallPtr fw,\n              virFirewallLayer layer,\n              bool pvt,\n              const char *iface,\n              int port,\n              int action,\n              int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_INP\" : \"INPUT\",\n                       \"--in-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesInput(virFirewallPtr fw,\n              virFirewallLayer layer,\n              bool pvt,\n              const char *iface,\n              int port,\n              int action,\n              int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_INP\" : \"INPUT\",\n                       \"--in-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic bool deletePrivate = true;\n\nvoid\niptablesRemoveUdpInput(virFirewallPtr fw,\n                       virFirewallLayer layer,\n                       const char *iface,\n                       int port)\n{\n    iptablesInput(fw, layer, deletePrivate, iface, port, REMOVE, 0);\n}"
  },
  {
    "function_name": "iptablesAddUdpInput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "278-285",
    "snippet": "void\niptablesAddUdpInput(virFirewallPtr fw,\n                    virFirewallLayer layer,\n                    const char *iface,\n                    int port)\n{\n    iptablesInput(fw, layer, true, iface, port, ADD, 0);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesInput",
          "args": [
            "fw",
            "layer",
            "true",
            "iface",
            "port",
            "ADD",
            "0"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesInput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "183-206",
          "snippet": "static void\niptablesInput(virFirewallPtr fw,\n              virFirewallLayer layer,\n              bool pvt,\n              const char *iface,\n              int port,\n              int action,\n              int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_INP\" : \"INPUT\",\n                       \"--in-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesInput(virFirewallPtr fw,\n              virFirewallLayer layer,\n              bool pvt,\n              const char *iface,\n              int port,\n              int action,\n              int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_INP\" : \"INPUT\",\n                       \"--in-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\niptablesAddUdpInput(virFirewallPtr fw,\n                    virFirewallLayer layer,\n                    const char *iface,\n                    int port)\n{\n    iptablesInput(fw, layer, true, iface, port, ADD, 0);\n}"
  },
  {
    "function_name": "iptablesRemoveTcpInput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "260-267",
    "snippet": "void\niptablesRemoveTcpInput(virFirewallPtr fw,\n                       virFirewallLayer layer,\n                       const char *iface,\n                       int port)\n{\n    iptablesInput(fw, layer, deletePrivate, iface, port, REMOVE, 1);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool deletePrivate = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesInput",
          "args": [
            "fw",
            "layer",
            "deletePrivate",
            "iface",
            "port",
            "REMOVE",
            "1"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesInput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "183-206",
          "snippet": "static void\niptablesInput(virFirewallPtr fw,\n              virFirewallLayer layer,\n              bool pvt,\n              const char *iface,\n              int port,\n              int action,\n              int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_INP\" : \"INPUT\",\n                       \"--in-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesInput(virFirewallPtr fw,\n              virFirewallLayer layer,\n              bool pvt,\n              const char *iface,\n              int port,\n              int action,\n              int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_INP\" : \"INPUT\",\n                       \"--in-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic bool deletePrivate = true;\n\nvoid\niptablesRemoveTcpInput(virFirewallPtr fw,\n                       virFirewallLayer layer,\n                       const char *iface,\n                       int port)\n{\n    iptablesInput(fw, layer, deletePrivate, iface, port, REMOVE, 1);\n}"
  },
  {
    "function_name": "iptablesAddTcpInput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "242-249",
    "snippet": "void\niptablesAddTcpInput(virFirewallPtr fw,\n                    virFirewallLayer layer,\n                    const char *iface,\n                    int port)\n{\n    iptablesInput(fw, layer, true, iface, port, ADD, 1);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iptablesInput",
          "args": [
            "fw",
            "layer",
            "true",
            "iface",
            "port",
            "ADD",
            "1"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "iptablesInput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
          "lines": "183-206",
          "snippet": "static void\niptablesInput(virFirewallPtr fw,\n              virFirewallLayer layer,\n              bool pvt,\n              const char *iface,\n              int port,\n              int action,\n              int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_INP\" : \"INPUT\",\n                       \"--in-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}",
          "includes": [
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"viriptables.h\"",
            "#include \"internal.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesInput(virFirewallPtr fw,\n              virFirewallLayer layer,\n              bool pvt,\n              const char *iface,\n              int port,\n              int action,\n              int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_INP\" : \"INPUT\",\n                       \"--in-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\niptablesAddTcpInput(virFirewallPtr fw,\n                    virFirewallLayer layer,\n                    const char *iface,\n                    int port)\n{\n    iptablesInput(fw, layer, true, iface, port, ADD, 1);\n}"
  },
  {
    "function_name": "iptablesOutput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "208-231",
    "snippet": "static void\niptablesOutput(virFirewallPtr fw,\n               virFirewallLayer layer,\n               bool pvt,\n               const char *iface,\n               int port,\n               int action,\n               int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_OUT\" : \"OUTPUT\",\n                       \"--out-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFirewallAddRule",
          "args": [
            "fw",
            "layer",
            "\"--table\"",
            "\"filter\"",
            "action == ADD ? \"--insert\" : \"--delete\"",
            "pvt ? \"LIBVIRT_OUT\" : \"OUTPUT\"",
            "\"--out-interface\"",
            "iface",
            "\"--protocol\"",
            "tcp ? \"tcp\" : \"udp\"",
            "\"--destination-port\"",
            "portstr",
            "\"--jump\"",
            "\"ACCEPT\"",
            "NULL"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallAddRuleFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "421-434",
          "snippet": "virFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_snprintf",
          "args": [
            "portstr",
            "sizeof(portstr)",
            "\"%d\"",
            "port"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesOutput(virFirewallPtr fw,\n               virFirewallLayer layer,\n               bool pvt,\n               const char *iface,\n               int port,\n               int action,\n               int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_OUT\" : \"OUTPUT\",\n                       \"--out-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}"
  },
  {
    "function_name": "iptablesInput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "183-206",
    "snippet": "static void\niptablesInput(virFirewallPtr fw,\n              virFirewallLayer layer,\n              bool pvt,\n              const char *iface,\n              int port,\n              int action,\n              int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_INP\" : \"INPUT\",\n                       \"--in-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFirewallAddRule",
          "args": [
            "fw",
            "layer",
            "\"--table\"",
            "\"filter\"",
            "action == ADD ? \"--insert\" : \"--delete\"",
            "pvt ? \"LIBVIRT_INP\" : \"INPUT\"",
            "\"--in-interface\"",
            "iface",
            "\"--protocol\"",
            "tcp ? \"tcp\" : \"udp\"",
            "\"--destination-port\"",
            "portstr",
            "\"--jump\"",
            "\"ACCEPT\"",
            "NULL"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallAddRuleFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "421-434",
          "snippet": "virFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_snprintf",
          "args": [
            "portstr",
            "sizeof(portstr)",
            "\"%d\"",
            "port"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\niptablesInput(virFirewallPtr fw,\n              virFirewallLayer layer,\n              bool pvt,\n              const char *iface,\n              int port,\n              int action,\n              int tcp)\n{\n    char portstr[32];\n\n    g_snprintf(portstr, sizeof(portstr), \"%d\", port);\n    portstr[sizeof(portstr) - 1] = '\\0';\n\n    virFirewallAddRule(fw, layer,\n                       \"--table\", \"filter\",\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       pvt ? \"LIBVIRT_INP\" : \"INPUT\",\n                       \"--in-interface\", iface,\n                       \"--protocol\", tcp ? \"tcp\" : \"udp\",\n                       \"--destination-port\", portstr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n}"
  },
  {
    "function_name": "iptablesSetDeletePrivate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "176-180",
    "snippet": "void\niptablesSetDeletePrivate(bool pvt)\n{\n    deletePrivate = pvt;\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool deletePrivate = true;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic bool deletePrivate = true;\n\nvoid\niptablesSetDeletePrivate(bool pvt)\n{\n    deletePrivate = pvt;\n}"
  },
  {
    "function_name": "iptablesSetupPrivateChains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "128-173",
    "snippet": "int\niptablesSetupPrivateChains(virFirewallLayer layer)\n{\n    virFirewallPtr fw = NULL;\n    int ret = -1;\n    iptablesGlobalChain filter_chains[] = {\n        {\"INPUT\", \"LIBVIRT_INP\"},\n        {\"OUTPUT\", \"LIBVIRT_OUT\"},\n        {\"FORWARD\", \"LIBVIRT_FWO\"},\n        {\"FORWARD\", \"LIBVIRT_FWI\"},\n        {\"FORWARD\", \"LIBVIRT_FWX\"},\n    };\n    iptablesGlobalChain natmangle_chains[] = {\n        {\"POSTROUTING\",  \"LIBVIRT_PRT\"},\n    };\n    bool changed = false;\n    iptablesGlobalChainData data[] = {\n        { layer, \"filter\",\n          filter_chains, G_N_ELEMENTS(filter_chains), &changed },\n        { layer, \"nat\",\n          natmangle_chains, G_N_ELEMENTS(natmangle_chains), &changed },\n        { layer, \"mangle\",\n          natmangle_chains, G_N_ELEMENTS(natmangle_chains), &changed },\n    };\n    size_t i;\n\n    fw = virFirewallNew();\n\n    virFirewallStartTransaction(fw, 0);\n\n    for (i = 0; i < G_N_ELEMENTS(data); i++)\n        virFirewallAddRuleFull(fw, data[i].layer,\n                               false, iptablesPrivateChainCreate,\n                               &(data[i]), \"--table\", data[i].table,\n                               \"--list-rules\", NULL);\n\n    if (virFirewallApply(fw) < 0)\n        goto cleanup;\n\n    ret = changed ? 1 : 0;\n\n cleanup:\n\n    virFirewallFree(fw);\n    return ret;\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFirewallFree",
          "args": [
            "fw"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "286-298",
          "snippet": "void virFirewallFree(virFirewallPtr firewall)\n{\n    size_t i;\n\n    if (!firewall)\n        return;\n\n    for (i = 0; i < firewall->ngroups; i++)\n        virFirewallGroupFree(firewall->groups[i]);\n    VIR_FREE(firewall->groups);\n\n    VIR_FREE(firewall);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virFirewallFree(virFirewallPtr firewall)\n{\n    size_t i;\n\n    if (!firewall)\n        return;\n\n    for (i = 0; i < firewall->ngroups; i++)\n        virFirewallGroupFree(firewall->groups[i]);\n    VIR_FREE(firewall->groups);\n\n    VIR_FREE(firewall);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFirewallApply",
          "args": [
            "fw"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallApply",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "804-868",
          "snippet": "int\nvirFirewallApply(virFirewallPtr firewall)\n{\n    size_t i, j;\n    int ret = -1;\n\n    virMutexLock(&ruleLock);\n\n    if (currentBackend == VIR_FIREWALL_BACKEND_AUTOMATIC) {\n        /* a specific backend should have been set when the firewall\n         * object was created. If not, it means none was found.\n         */\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to initialize a valid firewall backend\"));\n        goto cleanup;\n    }\n    if (!firewall || firewall->err == ENOMEM) {\n        virReportOOMError();\n        goto cleanup;\n    }\n    if (firewall->err) {\n        virReportSystemError(firewall->err, \"%s\",\n                             _(\"Unable to create rule\"));\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"Applying groups for %p\", firewall);\n    for (i = 0; i < firewall->ngroups; i++) {\n        if (virFirewallApplyGroup(firewall, i) < 0) {\n            VIR_DEBUG(\"Rolling back groups up to %zu for %p\", i, firewall);\n            size_t first = i;\n            virErrorPtr saved_error;\n\n            virErrorPreserveLast(&saved_error);\n\n            /*\n             * Look at any inheritance markers to figure out\n             * what the first rollback group we need to apply is\n             */\n            for (j = 0; j < i; j++) {\n                VIR_DEBUG(\"Checking inheritance of group %zu\", i - j);\n                if (firewall->groups[i - j]->rollbackFlags &\n                    VIR_FIREWALL_ROLLBACK_INHERIT_PREVIOUS)\n                    first = (i - j) - 1;\n            }\n            /*\n             * Now apply all rollback groups in order\n             */\n            for (j = first; j <= i; j++) {\n                VIR_DEBUG(\"Rolling back group %zu\", j);\n                virFirewallRollbackGroup(firewall, j);\n            }\n\n            virErrorRestore(&saved_error);\n            VIR_DEBUG(\"Done rolling back groups for %p\", firewall);\n            goto cleanup;\n        }\n    }\n    VIR_DEBUG(\"Done applying groups for %p\", firewall);\n\n    ret = 0;\n cleanup:\n    virMutexUnlock(&ruleLock);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virFirewallBackend currentBackend = VIR_FIREWALL_BACKEND_AUTOMATIC;",
            "static virMutex ruleLock = VIR_MUTEX_INITIALIZER;",
            "static int\nvirFirewallValidateBackend(virFirewallBackend backend);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic virFirewallBackend currentBackend = VIR_FIREWALL_BACKEND_AUTOMATIC;\nstatic virMutex ruleLock = VIR_MUTEX_INITIALIZER;\nstatic int\nvirFirewallValidateBackend(virFirewallBackend backend);\n\nint\nvirFirewallApply(virFirewallPtr firewall)\n{\n    size_t i, j;\n    int ret = -1;\n\n    virMutexLock(&ruleLock);\n\n    if (currentBackend == VIR_FIREWALL_BACKEND_AUTOMATIC) {\n        /* a specific backend should have been set when the firewall\n         * object was created. If not, it means none was found.\n         */\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to initialize a valid firewall backend\"));\n        goto cleanup;\n    }\n    if (!firewall || firewall->err == ENOMEM) {\n        virReportOOMError();\n        goto cleanup;\n    }\n    if (firewall->err) {\n        virReportSystemError(firewall->err, \"%s\",\n                             _(\"Unable to create rule\"));\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"Applying groups for %p\", firewall);\n    for (i = 0; i < firewall->ngroups; i++) {\n        if (virFirewallApplyGroup(firewall, i) < 0) {\n            VIR_DEBUG(\"Rolling back groups up to %zu for %p\", i, firewall);\n            size_t first = i;\n            virErrorPtr saved_error;\n\n            virErrorPreserveLast(&saved_error);\n\n            /*\n             * Look at any inheritance markers to figure out\n             * what the first rollback group we need to apply is\n             */\n            for (j = 0; j < i; j++) {\n                VIR_DEBUG(\"Checking inheritance of group %zu\", i - j);\n                if (firewall->groups[i - j]->rollbackFlags &\n                    VIR_FIREWALL_ROLLBACK_INHERIT_PREVIOUS)\n                    first = (i - j) - 1;\n            }\n            /*\n             * Now apply all rollback groups in order\n             */\n            for (j = first; j <= i; j++) {\n                VIR_DEBUG(\"Rolling back group %zu\", j);\n                virFirewallRollbackGroup(firewall, j);\n            }\n\n            virErrorRestore(&saved_error);\n            VIR_DEBUG(\"Done rolling back groups for %p\", firewall);\n            goto cleanup;\n        }\n    }\n    VIR_DEBUG(\"Done applying groups for %p\", firewall);\n\n    ret = 0;\n cleanup:\n    virMutexUnlock(&ruleLock);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFirewallAddRuleFull",
          "args": [
            "fw",
            "data[i].layer",
            "false",
            "iptablesPrivateChainCreate",
            "&(data[i])",
            "\"--table\"",
            "data[i].table",
            "\"--list-rules\"",
            "NULL"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallAddRuleFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "421-434",
          "snippet": "virFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}"
        }
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "data"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFirewallStartTransaction",
          "args": [
            "fw",
            "0"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallStartTransaction",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "586-607",
          "snippet": "void virFirewallStartTransaction(virFirewallPtr firewall,\n                                 unsigned int flags)\n{\n    virFirewallGroupPtr group;\n\n    VIR_FIREWALL_RETURN_IF_ERROR(firewall);\n\n    if (!(group = virFirewallGroupNew())) {\n        firewall->err = ENOMEM;\n        return;\n    }\n    group->actionFlags = flags;\n\n    if (VIR_EXPAND_N(firewall->groups,\n                     firewall->ngroups, 1) < 0) {\n        firewall->err = ENOMEM;\n        virFirewallGroupFree(group);\n        return;\n    }\n    firewall->groups[firewall->ngroups - 1] = group;\n    firewall->currentGroup = firewall->ngroups - 1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virFirewallStartTransaction(virFirewallPtr firewall,\n                                 unsigned int flags)\n{\n    virFirewallGroupPtr group;\n\n    VIR_FIREWALL_RETURN_IF_ERROR(firewall);\n\n    if (!(group = virFirewallGroupNew())) {\n        firewall->err = ENOMEM;\n        return;\n    }\n    group->actionFlags = flags;\n\n    if (VIR_EXPAND_N(firewall->groups,\n                     firewall->ngroups, 1) < 0) {\n        firewall->err = ENOMEM;\n        virFirewallGroupFree(group);\n        return;\n    }\n    firewall->groups[firewall->ngroups - 1] = group;\n    firewall->currentGroup = firewall->ngroups - 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFirewallNew",
          "args": [],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "231-242",
          "snippet": "virFirewallPtr virFirewallNew(void)\n{\n    virFirewallPtr firewall;\n\n    if (virFirewallInitialize() < 0)\n        return NULL;\n\n    if (VIR_ALLOC(firewall) < 0)\n        return NULL;\n\n    return firewall;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallPtr virFirewallNew(void)\n{\n    virFirewallPtr firewall;\n\n    if (virFirewallInitialize() < 0)\n        return NULL;\n\n    if (VIR_ALLOC(firewall) < 0)\n        return NULL;\n\n    return firewall;\n}"
        }
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "natmangle_chains"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "natmangle_chains"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "filter_chains"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\niptablesSetupPrivateChains(virFirewallLayer layer)\n{\n    virFirewallPtr fw = NULL;\n    int ret = -1;\n    iptablesGlobalChain filter_chains[] = {\n        {\"INPUT\", \"LIBVIRT_INP\"},\n        {\"OUTPUT\", \"LIBVIRT_OUT\"},\n        {\"FORWARD\", \"LIBVIRT_FWO\"},\n        {\"FORWARD\", \"LIBVIRT_FWI\"},\n        {\"FORWARD\", \"LIBVIRT_FWX\"},\n    };\n    iptablesGlobalChain natmangle_chains[] = {\n        {\"POSTROUTING\",  \"LIBVIRT_PRT\"},\n    };\n    bool changed = false;\n    iptablesGlobalChainData data[] = {\n        { layer, \"filter\",\n          filter_chains, G_N_ELEMENTS(filter_chains), &changed },\n        { layer, \"nat\",\n          natmangle_chains, G_N_ELEMENTS(natmangle_chains), &changed },\n        { layer, \"mangle\",\n          natmangle_chains, G_N_ELEMENTS(natmangle_chains), &changed },\n    };\n    size_t i;\n\n    fw = virFirewallNew();\n\n    virFirewallStartTransaction(fw, 0);\n\n    for (i = 0; i < G_N_ELEMENTS(data); i++)\n        virFirewallAddRuleFull(fw, data[i].layer,\n                               false, iptablesPrivateChainCreate,\n                               &(data[i]), \"--table\", data[i].table,\n                               \"--list-rules\", NULL);\n\n    if (virFirewallApply(fw) < 0)\n        goto cleanup;\n\n    ret = changed ? 1 : 0;\n\n cleanup:\n\n    virFirewallFree(fw);\n    return ret;\n}"
  },
  {
    "function_name": "iptablesPrivateChainCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viriptables.c",
    "lines": "66-125",
    "snippet": "static int\niptablesPrivateChainCreate(virFirewallPtr fw,\n                           virFirewallLayer layer,\n                           const char *const *lines,\n                           void *opaque)\n{\n    iptablesGlobalChainData *data = opaque;\n    virHashTablePtr chains = NULL;\n    virHashTablePtr links = NULL;\n    const char *const *tmp;\n    int ret = -1;\n    size_t i;\n\n    if (!(chains = virHashCreate(50, NULL)))\n        goto cleanup;\n    if (!(links = virHashCreate(50, NULL)))\n        goto cleanup;\n\n    tmp = lines;\n    while (tmp && *tmp) {\n        if (STRPREFIX(*tmp, \"-N \")) { /* eg \"-N LIBVIRT_INP\" */\n            if (virHashUpdateEntry(chains, *tmp + 3, (void *)0x1) < 0)\n                goto cleanup;\n        } else if (STRPREFIX(*tmp, \"-A \")) { /* eg \"-A INPUT -j LIBVIRT_INP\" */\n            char *sep = strchr(*tmp + 3, ' ');\n            if (sep) {\n                *sep = '\\0';\n                if (STRPREFIX(sep + 1, \"-j \")) {\n                    if (virHashUpdateEntry(links, sep + 4,\n                                           (char *)*tmp + 3) < 0)\n                        goto cleanup;\n                }\n            }\n        }\n        tmp++;\n    }\n\n    for (i = 0; i < data->nchains; i++) {\n        const char *from;\n        if (!virHashLookup(chains, data->chains[i].child)) {\n            virFirewallAddRule(fw, layer,\n                               \"--table\", data->table,\n                               \"--new-chain\", data->chains[i].child, NULL);\n            *data->changed = true;\n        }\n\n        from = virHashLookup(links, data->chains[i].child);\n        if (!from || STRNEQ(from, data->chains[i].parent))\n            virFirewallAddRule(fw, layer,\n                               \"--table\", data->table,\n                               \"--insert\", data->chains[i].parent,\n                               \"--jump\", data->chains[i].child, NULL);\n    }\n\n    ret = 0;\n cleanup:\n    virHashFree(chains);\n    virHashFree(links);\n    return ret;\n}",
    "includes": [
      "#include \"virhash.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"viriptables.h\"",
      "#include \"internal.h\"",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "links"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFirewallAddRule",
          "args": [
            "fw",
            "layer",
            "\"--table\"",
            "data->table",
            "\"--insert\"",
            "data->chains[i].parent",
            "\"--jump\"",
            "data->chains[i].child",
            "NULL"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallAddRuleFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "421-434",
          "snippet": "virFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "from",
            "data->chains[i].parent"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "links",
            "data->chains[i].child"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashUpdateEntry",
          "args": [
            "links",
            "sep + 4",
            "(char *)*tmp + 3"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "virHashUpdateEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "422-427",
          "snippet": "int\nvirHashUpdateEntry(virHashTablePtr table, const void *name,\n                   void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, true);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashUpdateEntry(virHashTablePtr table, const void *name,\n                   void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "sep + 1",
            "\"-j \""
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "*tmp + 3",
            "' '"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "*tmp",
            "\"-A \""
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "*tmp",
            "\"-N \""
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "50",
            "NULL"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"viriptables.h\"\n#include \"internal.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\niptablesPrivateChainCreate(virFirewallPtr fw,\n                           virFirewallLayer layer,\n                           const char *const *lines,\n                           void *opaque)\n{\n    iptablesGlobalChainData *data = opaque;\n    virHashTablePtr chains = NULL;\n    virHashTablePtr links = NULL;\n    const char *const *tmp;\n    int ret = -1;\n    size_t i;\n\n    if (!(chains = virHashCreate(50, NULL)))\n        goto cleanup;\n    if (!(links = virHashCreate(50, NULL)))\n        goto cleanup;\n\n    tmp = lines;\n    while (tmp && *tmp) {\n        if (STRPREFIX(*tmp, \"-N \")) { /* eg \"-N LIBVIRT_INP\" */\n            if (virHashUpdateEntry(chains, *tmp + 3, (void *)0x1) < 0)\n                goto cleanup;\n        } else if (STRPREFIX(*tmp, \"-A \")) { /* eg \"-A INPUT -j LIBVIRT_INP\" */\n            char *sep = strchr(*tmp + 3, ' ');\n            if (sep) {\n                *sep = '\\0';\n                if (STRPREFIX(sep + 1, \"-j \")) {\n                    if (virHashUpdateEntry(links, sep + 4,\n                                           (char *)*tmp + 3) < 0)\n                        goto cleanup;\n                }\n            }\n        }\n        tmp++;\n    }\n\n    for (i = 0; i < data->nchains; i++) {\n        const char *from;\n        if (!virHashLookup(chains, data->chains[i].child)) {\n            virFirewallAddRule(fw, layer,\n                               \"--table\", data->table,\n                               \"--new-chain\", data->chains[i].child, NULL);\n            *data->changed = true;\n        }\n\n        from = virHashLookup(links, data->chains[i].child);\n        if (!from || STRNEQ(from, data->chains[i].parent))\n            virFirewallAddRule(fw, layer,\n                               \"--table\", data->table,\n                               \"--insert\", data->chains[i].parent,\n                               \"--jump\", data->chains[i].child, NULL);\n    }\n\n    ret = 0;\n cleanup:\n    virHashFree(chains);\n    virHashFree(links);\n    return ret;\n}"
  }
]