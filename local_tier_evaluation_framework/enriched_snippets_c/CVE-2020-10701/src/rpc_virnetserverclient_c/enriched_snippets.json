[
  {
    "function_name": "virNetServerClientSetQuietEOF",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1692-1696",
    "snippet": "void\nvirNetServerClientSetQuietEOF(virNetServerClientPtr client)\n{\n    virNetSocketSetQuietEOF(client->sock);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetSocketSetQuietEOF",
          "args": [
            "client->sock"
          ],
          "line": 1695
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketSetQuietEOF",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "2287-2291",
          "snippet": "void\nvirNetSocketSetQuietEOF(virNetSocketPtr sock)\n{\n    sock->quietEOF = true;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirNetSocketSetQuietEOF(virNetSocketPtr sock)\n{\n    sock->quietEOF = true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvoid\nvirNetServerClientSetQuietEOF(virNetServerClientPtr client)\n{\n    virNetSocketSetQuietEOF(client->sock);\n}"
  },
  {
    "function_name": "virNetServerClientGetInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1652-1683",
    "snippet": "int\nvirNetServerClientGetInfo(virNetServerClientPtr client,\n                          bool *readonly, char **sock_addr,\n                          virIdentityPtr *identity)\n{\n    int ret = -1;\n    const char *addr;\n\n    virObjectLock(client);\n    *readonly = client->readonly;\n\n    if (!(addr = virNetServerClientRemoteAddrStringURI(client))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No network socket associated with client\"));\n        goto cleanup;\n    }\n\n    *sock_addr = g_strdup(addr);\n\n    if (!client->identity) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No identity information available for client\"));\n        goto cleanup;\n    }\n\n    *identity = g_object_ref(client->identity);\n\n    ret = 0;\n cleanup:\n    virObjectUnlock(client);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 1681
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_object_ref",
          "args": [
            "client->identity"
          ],
          "line": 1677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"No identity information available for client\")"
          ],
          "line": 1672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"No identity information available for client\""
          ],
          "line": 1673
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"No network socket associated with client\")"
          ],
          "line": 1664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetServerClientRemoteAddrStringURI",
          "args": [
            "client"
          ],
          "line": 1663
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientRemoteAddrStringURI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "962-967",
          "snippet": "const char *virNetServerClientRemoteAddrStringURI(virNetServerClientPtr client)\n{\n    if (!client->sock)\n        return NULL;\n    return virNetSocketRemoteAddrStringURI(client->sock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nconst char *virNetServerClientRemoteAddrStringURI(virNetServerClientPtr client)\n{\n    if (!client->sock)\n        return NULL;\n    return virNetSocketRemoteAddrStringURI(client->sock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 1660
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nint\nvirNetServerClientGetInfo(virNetServerClientPtr client,\n                          bool *readonly, char **sock_addr,\n                          virIdentityPtr *identity)\n{\n    int ret = -1;\n    const char *addr;\n\n    virObjectLock(client);\n    *readonly = client->readonly;\n\n    if (!(addr = virNetServerClientRemoteAddrStringURI(client))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No network socket associated with client\"));\n        goto cleanup;\n    }\n\n    *sock_addr = g_strdup(addr);\n\n    if (!client->identity) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No identity information available for client\"));\n        goto cleanup;\n    }\n\n    *identity = g_object_ref(client->identity);\n\n    ret = 0;\n cleanup:\n    virObjectUnlock(client);\n    return ret;\n}"
  },
  {
    "function_name": "virNetServerClientGetTransport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1632-1650",
    "snippet": "int\nvirNetServerClientGetTransport(virNetServerClientPtr client)\n{\n    int ret = -1;\n\n    virObjectLock(client);\n\n    if (client->sock && virNetSocketIsLocal(client->sock))\n        ret = VIR_CLIENT_TRANS_UNIX;\n    else\n        ret = VIR_CLIENT_TRANS_TCP;\n\n    if (client->tls)\n        ret = VIR_CLIENT_TRANS_TLS;\n\n    virObjectUnlock(client);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 1647
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketIsLocal",
          "args": [
            "client->sock"
          ],
          "line": 1639
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketIsLocal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1415-1423",
          "snippet": "bool virNetSocketIsLocal(virNetSocketPtr sock)\n{\n    bool isLocal = false;\n    virObjectLock(sock);\n    if (sock->localAddr.data.sa.sa_family == AF_UNIX)\n        isLocal = true;\n    virObjectUnlock(sock);\n    return isLocal;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nbool virNetSocketIsLocal(virNetSocketPtr sock)\n{\n    bool isLocal = false;\n    virObjectLock(sock);\n    if (sock->localAddr.data.sa.sa_family == AF_UNIX)\n        isLocal = true;\n    virObjectUnlock(sock);\n    return isLocal;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 1637
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nint\nvirNetServerClientGetTransport(virNetServerClientPtr client)\n{\n    int ret = -1;\n\n    virObjectLock(client);\n\n    if (client->sock && virNetSocketIsLocal(client->sock))\n        ret = VIR_CLIENT_TRANS_UNIX;\n    else\n        ret = VIR_CLIENT_TRANS_TCP;\n\n    if (client->tls)\n        ret = VIR_CLIENT_TRANS_TLS;\n\n    virObjectUnlock(client);\n\n    return ret;\n}"
  },
  {
    "function_name": "virNetServerClientStartKeepAlive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1609-1630",
    "snippet": "int\nvirNetServerClientStartKeepAlive(virNetServerClientPtr client)\n{\n    int ret = -1;\n\n    virObjectLock(client);\n\n    /* The connection might have been closed before we got here and thus the\n     * keepalive object could have been removed too.\n     */\n    if (!client->keepalive) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"connection not open\"));\n        goto cleanup;\n    }\n\n    ret = virKeepAliveStart(client->keepalive, 0, 0);\n\n cleanup:\n    virObjectUnlock(client);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 1628
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virKeepAliveStart",
          "args": [
            "client->keepalive",
            "0",
            "0"
          ],
          "line": 1625
        },
        "resolved": true,
        "details": {
          "function_name": "virKeepAliveStart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virkeepalive.c",
          "lines": "228-292",
          "snippet": "int\nvirKeepAliveStart(virKeepAlivePtr ka,\n                  int interval,\n                  unsigned int count)\n{\n    int ret = -1;\n    time_t delay;\n    int timeout;\n    time_t now;\n\n    virObjectLock(ka);\n\n    if (ka->timer >= 0) {\n        VIR_DEBUG(\"Keepalive messages already enabled\");\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (interval > 0) {\n        if (ka->interval > 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"keepalive interval already set\"));\n            goto cleanup;\n        }\n        /* Guard against overflow */\n        if (interval > INT_MAX / 1000) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"keepalive interval %d too large\"), interval);\n            goto cleanup;\n        }\n        ka->interval = interval;\n        ka->count = count;\n        ka->countToDeath = count;\n    }\n\n    if (ka->interval <= 0) {\n        VIR_DEBUG(\"Keepalive messages disabled by configuration\");\n        ret = 0;\n        goto cleanup;\n    }\n\n    PROBE(RPC_KEEPALIVE_START,\n          \"ka=%p client=%p interval=%d count=%u\",\n          ka, ka->client, interval, count);\n\n    now = time(NULL);\n    delay = now - ka->lastPacketReceived;\n    if (delay > ka->interval)\n        timeout = 0;\n    else\n        timeout = ka->interval - delay;\n    ka->intervalStart = now - (ka->interval - timeout);\n    ka->timer = virEventAddTimeout(timeout * 1000, virKeepAliveTimer,\n                                   ka, virObjectFreeCallback);\n    if (ka->timer < 0)\n        goto cleanup;\n\n    /* the timer now has another reference to this object */\n    virObjectRef(ka);\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(ka);\n    return ret;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virkeepaliveprotocol.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virkeepaliveprotocol.h\"\n#include \"virnetsocket.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint\nvirKeepAliveStart(virKeepAlivePtr ka,\n                  int interval,\n                  unsigned int count)\n{\n    int ret = -1;\n    time_t delay;\n    int timeout;\n    time_t now;\n\n    virObjectLock(ka);\n\n    if (ka->timer >= 0) {\n        VIR_DEBUG(\"Keepalive messages already enabled\");\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (interval > 0) {\n        if (ka->interval > 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"keepalive interval already set\"));\n            goto cleanup;\n        }\n        /* Guard against overflow */\n        if (interval > INT_MAX / 1000) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"keepalive interval %d too large\"), interval);\n            goto cleanup;\n        }\n        ka->interval = interval;\n        ka->count = count;\n        ka->countToDeath = count;\n    }\n\n    if (ka->interval <= 0) {\n        VIR_DEBUG(\"Keepalive messages disabled by configuration\");\n        ret = 0;\n        goto cleanup;\n    }\n\n    PROBE(RPC_KEEPALIVE_START,\n          \"ka=%p client=%p interval=%d count=%u\",\n          ka, ka->client, interval, count);\n\n    now = time(NULL);\n    delay = now - ka->lastPacketReceived;\n    if (delay > ka->interval)\n        timeout = 0;\n    else\n        timeout = ka->interval - delay;\n    ka->intervalStart = now - (ka->interval - timeout);\n    ka->timer = virEventAddTimeout(timeout * 1000, virKeepAliveTimer,\n                                   ka, virObjectFreeCallback);\n    if (ka->timer < 0)\n        goto cleanup;\n\n    /* the timer now has another reference to this object */\n    virObjectRef(ka);\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(ka);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"connection not open\")"
          ],
          "line": 1620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"connection not open\""
          ],
          "line": 1621
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 1614
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nint\nvirNetServerClientStartKeepAlive(virNetServerClientPtr client)\n{\n    int ret = -1;\n\n    virObjectLock(client);\n\n    /* The connection might have been closed before we got here and thus the\n     * keepalive object could have been removed too.\n     */\n    if (!client->keepalive) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"connection not open\"));\n        goto cleanup;\n    }\n\n    ret = virKeepAliveStart(client->keepalive, 0, 0);\n\n cleanup:\n    virObjectUnlock(client);\n    return ret;\n}"
  },
  {
    "function_name": "virNetServerClientInitKeepAlive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1583-1607",
    "snippet": "int\nvirNetServerClientInitKeepAlive(virNetServerClientPtr client,\n                                int interval,\n                                unsigned int count)\n{\n    virKeepAlivePtr ka;\n    int ret = -1;\n\n    virObjectLock(client);\n\n    if (!(ka = virKeepAliveNew(interval, count, client,\n                               virNetServerClientKeepAliveSendCB,\n                               virNetServerClientKeepAliveDeadCB,\n                               virObjectFreeCallback)))\n        goto cleanup;\n    /* keepalive object has a reference to client */\n    virObjectRef(client);\n\n    client->keepalive = ka;\n\n cleanup:\n    virObjectUnlock(client);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 1604
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "client"
          ],
          "line": 1599
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virKeepAliveNew",
          "args": [
            "interval",
            "count",
            "client",
            "virNetServerClientKeepAliveSendCB",
            "virNetServerClientKeepAliveDeadCB",
            "virObjectFreeCallback"
          ],
          "line": 1593
        },
        "resolved": true,
        "details": {
          "function_name": "virKeepAliveNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virkeepalive.c",
          "lines": "181-213",
          "snippet": "virKeepAlivePtr\nvirKeepAliveNew(int interval,\n                unsigned int count,\n                void *client,\n                virKeepAliveSendFunc sendCB,\n                virKeepAliveDeadFunc deadCB,\n                virKeepAliveFreeFunc freeCB)\n{\n    virKeepAlivePtr ka;\n\n    VIR_DEBUG(\"client=%p, interval=%d, count=%u\", client, interval, count);\n\n    if (virKeepAliveInitialize() < 0)\n        return NULL;\n\n    if (!(ka = virObjectLockableNew(virKeepAliveClass)))\n        return NULL;\n\n    ka->interval = interval;\n    ka->count = count;\n    ka->countToDeath = count;\n    ka->timer = -1;\n    ka->client = client;\n    ka->sendCB = sendCB;\n    ka->deadCB = deadCB;\n    ka->freeCB = freeCB;\n\n    PROBE(RPC_KEEPALIVE_NEW,\n          \"ka=%p client=%p\",\n          ka, ka->client);\n\n    return ka;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virkeepaliveprotocol.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virKeepAliveClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virkeepaliveprotocol.h\"\n#include \"virnetsocket.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virClassPtr virKeepAliveClass;\n\nvirKeepAlivePtr\nvirKeepAliveNew(int interval,\n                unsigned int count,\n                void *client,\n                virKeepAliveSendFunc sendCB,\n                virKeepAliveDeadFunc deadCB,\n                virKeepAliveFreeFunc freeCB)\n{\n    virKeepAlivePtr ka;\n\n    VIR_DEBUG(\"client=%p, interval=%d, count=%u\", client, interval, count);\n\n    if (virKeepAliveInitialize() < 0)\n        return NULL;\n\n    if (!(ka = virObjectLockableNew(virKeepAliveClass)))\n        return NULL;\n\n    ka->interval = interval;\n    ka->count = count;\n    ka->countToDeath = count;\n    ka->timer = -1;\n    ka->client = client;\n    ka->sendCB = sendCB;\n    ka->deadCB = deadCB;\n    ka->freeCB = freeCB;\n\n    PROBE(RPC_KEEPALIVE_NEW,\n          \"ka=%p client=%p\",\n          ka, ka->client);\n\n    return ka;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 1591
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nint\nvirNetServerClientInitKeepAlive(virNetServerClientPtr client,\n                                int interval,\n                                unsigned int count)\n{\n    virKeepAlivePtr ka;\n    int ret = -1;\n\n    virObjectLock(client);\n\n    if (!(ka = virKeepAliveNew(interval, count, client,\n                               virNetServerClientKeepAliveSendCB,\n                               virNetServerClientKeepAliveDeadCB,\n                               virObjectFreeCallback)))\n        goto cleanup;\n    /* keepalive object has a reference to client */\n    virObjectRef(client);\n\n    client->keepalive = ka;\n\n cleanup:\n    virObjectUnlock(client);\n\n    return ret;\n}"
  },
  {
    "function_name": "virNetServerClientKeepAliveSendCB",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1575-1580",
    "snippet": "static int\nvirNetServerClientKeepAliveSendCB(void *opaque,\n                                  virNetMessagePtr msg)\n{\n    return virNetServerClientSendMessage(opaque, msg);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);",
      "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetServerClientSendMessage",
          "args": [
            "opaque",
            "msg"
          ],
          "line": 1579
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientSendMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "1528-1538",
          "snippet": "int virNetServerClientSendMessage(virNetServerClientPtr client,\n                                  virNetMessagePtr msg)\n{\n    int ret;\n\n    virObjectLock(client);\n    ret = virNetServerClientSendMessageLocked(client, msg);\n    virObjectUnlock(client);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);",
            "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nint virNetServerClientSendMessage(virNetServerClientPtr client,\n                                  virNetMessagePtr msg)\n{\n    int ret;\n\n    virObjectLock(client);\n    ret = virNetServerClientSendMessageLocked(client, msg);\n    virObjectUnlock(client);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nstatic int\nvirNetServerClientKeepAliveSendCB(void *opaque,\n                                  virNetMessagePtr msg)\n{\n    return virNetServerClientSendMessage(opaque, msg);\n}"
  },
  {
    "function_name": "virNetServerClientKeepAliveDeadCB",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1569-1573",
    "snippet": "static void\nvirNetServerClientKeepAliveDeadCB(void *opaque)\n{\n    virNetServerClientImmediateClose(opaque);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetServerClientImmediateClose",
          "args": [
            "opaque"
          ],
          "line": 1572
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientImmediateClose",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "1083-1088",
          "snippet": "void virNetServerClientImmediateClose(virNetServerClientPtr client)\n{\n    virObjectLock(client);\n    client->wantClose = true;\n    virObjectUnlock(client);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvoid virNetServerClientImmediateClose(virNetServerClientPtr client)\n{\n    virObjectLock(client);\n    client->wantClose = true;\n    virObjectUnlock(client);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);\n\nstatic void\nvirNetServerClientKeepAliveDeadCB(void *opaque)\n{\n    virNetServerClientImmediateClose(opaque);\n}"
  },
  {
    "function_name": "virNetServerClientIsAuthPendingLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1562-1566",
    "snippet": "bool\nvirNetServerClientIsAuthPendingLocked(virNetServerClientPtr client)\n{\n    return client->auth_pending;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nbool\nvirNetServerClientIsAuthPendingLocked(virNetServerClientPtr client)\n{\n    return client->auth_pending;\n}"
  },
  {
    "function_name": "virNetServerClientSetAuthPendingLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1553-1558",
    "snippet": "void\nvirNetServerClientSetAuthPendingLocked(virNetServerClientPtr client,\n                                       bool auth_pending)\n{\n    client->auth_pending = auth_pending;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvoid\nvirNetServerClientSetAuthPendingLocked(virNetServerClientPtr client,\n                                       bool auth_pending)\n{\n    client->auth_pending = auth_pending;\n}"
  },
  {
    "function_name": "virNetServerClientIsAuthenticated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1541-1549",
    "snippet": "bool\nvirNetServerClientIsAuthenticated(virNetServerClientPtr client)\n{\n    bool authenticated;\n    virObjectLock(client);\n    authenticated = virNetServerClientAuthMethodImpliesAuthenticated(client->auth);\n    virObjectUnlock(client);\n    return authenticated;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 1547
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientAuthMethodImpliesAuthenticated",
          "args": [
            "client->auth"
          ],
          "line": 1546
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientAuthMethodImpliesAuthenticated",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "374-378",
          "snippet": "static bool\nvirNetServerClientAuthMethodImpliesAuthenticated(int auth)\n{\n    return auth == VIR_NET_SERVER_SERVICE_AUTH_NONE;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool\nvirNetServerClientAuthMethodImpliesAuthenticated(int auth)\n{\n    return auth == VIR_NET_SERVER_SERVICE_AUTH_NONE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 1545
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nbool\nvirNetServerClientIsAuthenticated(virNetServerClientPtr client)\n{\n    bool authenticated;\n    virObjectLock(client);\n    authenticated = virNetServerClientAuthMethodImpliesAuthenticated(client->auth);\n    virObjectUnlock(client);\n    return authenticated;\n}"
  },
  {
    "function_name": "virNetServerClientSendMessage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1528-1538",
    "snippet": "int virNetServerClientSendMessage(virNetServerClientPtr client,\n                                  virNetMessagePtr msg)\n{\n    int ret;\n\n    virObjectLock(client);\n    ret = virNetServerClientSendMessageLocked(client, msg);\n    virObjectUnlock(client);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);",
      "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 1535
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientSendMessageLocked",
          "args": [
            "client",
            "msg"
          ],
          "line": 1534
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientSendMessageLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "1503-1526",
          "snippet": "static int\nvirNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                    virNetMessagePtr msg)\n{\n    int ret = -1;\n    VIR_DEBUG(\"msg=%p proc=%d len=%zu offset=%zu\",\n              msg, msg->header.proc,\n              msg->bufferLength, msg->bufferOffset);\n\n    msg->donefds = 0;\n    if (client->sock && !client->wantClose) {\n        PROBE(RPC_SERVER_CLIENT_MSG_TX_QUEUE,\n              \"client=%p len=%zu prog=%u vers=%u proc=%u type=%u status=%u serial=%u\",\n              client, msg->bufferLength,\n              msg->header.prog, msg->header.vers, msg->header.proc,\n              msg->header.type, msg->header.status, msg->header.serial);\n        virNetMessageQueuePush(&client->tx, msg);\n\n        virNetServerClientUpdateEvent(client);\n        ret = 0;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);",
            "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nstatic int\nvirNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                    virNetMessagePtr msg)\n{\n    int ret = -1;\n    VIR_DEBUG(\"msg=%p proc=%d len=%zu offset=%zu\",\n              msg, msg->header.proc,\n              msg->bufferLength, msg->bufferOffset);\n\n    msg->donefds = 0;\n    if (client->sock && !client->wantClose) {\n        PROBE(RPC_SERVER_CLIENT_MSG_TX_QUEUE,\n              \"client=%p len=%zu prog=%u vers=%u proc=%u type=%u status=%u serial=%u\",\n              client, msg->bufferLength,\n              msg->header.prog, msg->header.vers, msg->header.proc,\n              msg->header.type, msg->header.status, msg->header.serial);\n        virNetMessageQueuePush(&client->tx, msg);\n\n        virNetServerClientUpdateEvent(client);\n        ret = 0;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 1533
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nint virNetServerClientSendMessage(virNetServerClientPtr client,\n                                  virNetMessagePtr msg)\n{\n    int ret;\n\n    virObjectLock(client);\n    ret = virNetServerClientSendMessageLocked(client, msg);\n    virObjectUnlock(client);\n\n    return ret;\n}"
  },
  {
    "function_name": "virNetServerClientSendMessageLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1503-1526",
    "snippet": "static int\nvirNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                    virNetMessagePtr msg)\n{\n    int ret = -1;\n    VIR_DEBUG(\"msg=%p proc=%d len=%zu offset=%zu\",\n              msg, msg->header.proc,\n              msg->bufferLength, msg->bufferOffset);\n\n    msg->donefds = 0;\n    if (client->sock && !client->wantClose) {\n        PROBE(RPC_SERVER_CLIENT_MSG_TX_QUEUE,\n              \"client=%p len=%zu prog=%u vers=%u proc=%u type=%u status=%u serial=%u\",\n              client, msg->bufferLength,\n              msg->header.prog, msg->header.vers, msg->header.proc,\n              msg->header.type, msg->header.status, msg->header.serial);\n        virNetMessageQueuePush(&client->tx, msg);\n\n        virNetServerClientUpdateEvent(client);\n        ret = 0;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);",
      "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetServerClientUpdateEvent",
          "args": [
            "client"
          ],
          "line": 1521
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientUpdateEvent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "219-232",
          "snippet": "static void virNetServerClientUpdateEvent(virNetServerClientPtr client)\n{\n    int mode;\n\n    if (!client->sock)\n        return;\n\n    mode = virNetServerClientCalculateHandleMode(client);\n\n    virNetSocketUpdateIOCallback(client->sock, mode);\n\n    if (client->rx && virNetSocketHasCachedData(client->sock))\n        virEventUpdateTimeout(client->sockTimer, 0);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client)\n{\n    int mode;\n\n    if (!client->sock)\n        return;\n\n    mode = virNetServerClientCalculateHandleMode(client);\n\n    virNetSocketUpdateIOCallback(client->sock, mode);\n\n    if (client->rx && virNetSocketHasCachedData(client->sock))\n        virEventUpdateTimeout(client->sockTimer, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetMessageQueuePush",
          "args": [
            "&client->tx",
            "msg"
          ],
          "line": 1519
        },
        "resolved": true,
        "details": {
          "function_name": "virNetMessageQueuePush",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetmessage.c",
          "lines": "95-106",
          "snippet": "void virNetMessageQueuePush(virNetMessagePtr *queue, virNetMessagePtr msg)\n{\n    virNetMessagePtr tmp = *queue;\n\n    if (tmp) {\n        while (tmp->next)\n            tmp = tmp->next;\n        tmp->next = msg;\n    } else {\n        *queue = msg;\n    }\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetmessage.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetmessage.h\"\n#include <unistd.h>\n#include <config.h>\n\nvoid virNetMessageQueuePush(virNetMessagePtr *queue, virNetMessagePtr msg)\n{\n    virNetMessagePtr tmp = *queue;\n\n    if (tmp) {\n        while (tmp->next)\n            tmp = tmp->next;\n        tmp->next = msg;\n    } else {\n        *queue = msg;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "PROBE",
          "args": [
            "RPC_SERVER_CLIENT_MSG_TX_QUEUE",
            "\"client=%p len=%zu prog=%u vers=%u proc=%u type=%u status=%u serial=%u\"",
            "client",
            "msg->bufferLength",
            "msg->header.prog",
            "msg->header.vers",
            "msg->header.proc",
            "msg->header.type",
            "msg->header.status",
            "msg->header.serial"
          ],
          "line": 1514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"msg=%p proc=%d len=%zu offset=%zu\"",
            "msg",
            "msg->header.proc",
            "msg->bufferLength",
            "msg->bufferOffset"
          ],
          "line": 1508
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nstatic int\nvirNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                    virNetMessagePtr msg)\n{\n    int ret = -1;\n    VIR_DEBUG(\"msg=%p proc=%d len=%zu offset=%zu\",\n              msg, msg->header.proc,\n              msg->bufferLength, msg->bufferOffset);\n\n    msg->donefds = 0;\n    if (client->sock && !client->wantClose) {\n        PROBE(RPC_SERVER_CLIENT_MSG_TX_QUEUE,\n              \"client=%p len=%zu prog=%u vers=%u proc=%u type=%u status=%u serial=%u\",\n              client, msg->bufferLength,\n              msg->header.prog, msg->header.vers, msg->header.proc,\n              msg->header.type, msg->header.status, msg->header.serial);\n        virNetMessageQueuePush(&client->tx, msg);\n\n        virNetServerClientUpdateEvent(client);\n        ret = 0;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virNetServerClientDispatchEvent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1461-1500",
    "snippet": "static void\nvirNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque)\n{\n    virNetServerClientPtr client = opaque;\n    virNetMessagePtr msg = NULL;\n\n    virObjectLock(client);\n\n    if (client->sock != sock) {\n        virNetSocketRemoveIOCallback(sock);\n        virObjectUnlock(client);\n        return;\n    }\n\n    if (events & (VIR_EVENT_HANDLE_WRITABLE |\n                  VIR_EVENT_HANDLE_READABLE)) {\n        if (client->tls &&\n            virNetTLSSessionGetHandshakeStatus(client->tls) !=\n            VIR_NET_TLS_HANDSHAKE_COMPLETE) {\n            virNetServerClientDispatchHandshake(client);\n        } else {\n            if (events & VIR_EVENT_HANDLE_WRITABLE)\n                virNetServerClientDispatchWrite(client);\n            if (events & VIR_EVENT_HANDLE_READABLE &&\n                client->rx)\n                msg = virNetServerClientDispatchRead(client);\n        }\n    }\n\n    /* NB, will get HANGUP + READABLE at same time upon\n     * disconnect */\n    if (events & (VIR_EVENT_HANDLE_ERROR |\n                  VIR_EVENT_HANDLE_HANGUP))\n        client->wantClose = true;\n\n    virObjectUnlock(client);\n\n    if (msg)\n        virNetServerClientDispatchMessage(client, msg);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);",
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);",
      "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetServerClientDispatchMessage",
          "args": [
            "client",
            "msg"
          ],
          "line": 1499
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientDispatchMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "327-343",
          "snippet": "static void virNetServerClientDispatchMessage(virNetServerClientPtr client,\n                                              virNetMessagePtr msg)\n{\n    virObjectLock(client);\n    if (!client->dispatchFunc) {\n        virNetMessageFree(msg);\n        client->wantClose = true;\n        virObjectUnlock(client);\n    } else {\n        virObjectUnlock(client);\n        /* Accessing 'client' is safe, because virNetServerClientSetDispatcher\n         * only permits setting 'dispatchFunc' once, so if non-NULL, it will\n         * never change again\n         */\n        client->dispatchFunc(client, msg, client->dispatchOpaque);\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);",
            "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nstatic void virNetServerClientDispatchMessage(virNetServerClientPtr client,\n                                              virNetMessagePtr msg)\n{\n    virObjectLock(client);\n    if (!client->dispatchFunc) {\n        virNetMessageFree(msg);\n        client->wantClose = true;\n        virObjectUnlock(client);\n    } else {\n        virObjectUnlock(client);\n        /* Accessing 'client' is safe, because virNetServerClientSetDispatcher\n         * only permits setting 'dispatchFunc' once, so if non-NULL, it will\n         * never change again\n         */\n        client->dispatchFunc(client, msg, client->dispatchOpaque);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 1496
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientDispatchRead",
          "args": [
            "client"
          ],
          "line": 1486
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientDispatchRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "1189-1321",
          "snippet": "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client)\n{\n readmore:\n    if (client->rx->nfds == 0) {\n        if (virNetServerClientRead(client) < 0) {\n            client->wantClose = true;\n            return NULL; /* Error */\n        }\n    }\n\n    if (client->rx->bufferOffset < client->rx->bufferLength)\n        return NULL; /* Still not read enough */\n\n    /* Either done with length word header */\n    if (client->rx->bufferLength == VIR_NET_MESSAGE_LEN_MAX) {\n        if (virNetMessageDecodeLength(client->rx) < 0) {\n            client->wantClose = true;\n            return NULL;\n        }\n\n        virNetServerClientUpdateEvent(client);\n\n        /* Try and read payload immediately instead of going back\n           into poll() because chances are the data is already\n           waiting for us */\n        goto readmore;\n    } else {\n        /* Grab the completed message */\n        virNetMessagePtr msg = client->rx;\n        virNetMessagePtr response = NULL;\n        virNetServerClientFilterPtr filter;\n        size_t i;\n\n        /* Decode the header so we can use it for routing decisions */\n        if (virNetMessageDecodeHeader(msg) < 0) {\n            virNetMessageQueueServe(&client->rx);\n            virNetMessageFree(msg);\n            client->wantClose = true;\n            return NULL;\n        }\n\n        /* Now figure out if we need to read more data to get some\n         * file descriptors */\n        if (msg->header.type == VIR_NET_CALL_WITH_FDS) {\n            if (virNetMessageDecodeNumFDs(msg) < 0) {\n                virNetMessageQueueServe(&client->rx);\n                virNetMessageFree(msg);\n                client->wantClose = true;\n                return NULL; /* Error */\n            }\n\n            /* Try getting the file descriptors (may fail if blocking) */\n            for (i = msg->donefds; i < msg->nfds; i++) {\n                int rv;\n                if ((rv = virNetSocketRecvFD(client->sock, &(msg->fds[i]))) < 0) {\n                    virNetMessageQueueServe(&client->rx);\n                    virNetMessageFree(msg);\n                    client->wantClose = true;\n                    return NULL;\n                }\n                if (rv == 0) /* Blocking */\n                    break;\n                msg->donefds++;\n            }\n\n            /* Need to poll() until FDs arrive */\n            if (msg->donefds < msg->nfds) {\n                /* Because DecodeHeader/NumFDs reset bufferOffset, we\n                 * put it back to what it was, so everything works\n                 * again next time we run this method\n                 */\n                client->rx->bufferOffset = client->rx->bufferLength;\n                return NULL;\n            }\n        }\n\n        /* Definitely finished reading, so remove from queue */\n        virNetMessageQueueServe(&client->rx);\n        PROBE(RPC_SERVER_CLIENT_MSG_RX,\n              \"client=%p len=%zu prog=%u vers=%u proc=%u type=%u status=%u serial=%u\",\n              client, msg->bufferLength,\n              msg->header.prog, msg->header.vers, msg->header.proc,\n              msg->header.type, msg->header.status, msg->header.serial);\n\n        if (virKeepAliveCheckMessage(client->keepalive, msg, &response)) {\n            virNetMessageFree(msg);\n            client->nrequests--;\n            msg = NULL;\n\n            if (response &&\n                virNetServerClientSendMessageLocked(client, response) < 0)\n                virNetMessageFree(response);\n        }\n\n        /* Maybe send off for queue against a filter */\n        if (msg) {\n            filter = client->filters;\n            while (filter) {\n                int ret = filter->func(client, msg, filter->opaque);\n                if (ret < 0) {\n                    virNetMessageFree(msg);\n                    msg = NULL;\n                    client->wantClose = true;\n                    break;\n                }\n                if (ret > 0) {\n                    msg = NULL;\n                    break;\n                }\n\n                filter = filter->next;\n            }\n        }\n\n        /* Possibly need to create another receive buffer */\n        if (client->nrequests < client->nrequests_max) {\n            if (!(client->rx = virNetMessageNew(true))) {\n                client->wantClose = true;\n            } else {\n                client->rx->bufferLength = VIR_NET_MESSAGE_LEN_MAX;\n                if (VIR_ALLOC_N(client->rx->buffer,\n                                client->rx->bufferLength) < 0) {\n                    client->wantClose = true;\n                } else {\n                    client->nrequests++;\n                }\n            }\n        }\n        virNetServerClientUpdateEvent(client);\n\n        return msg;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);",
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);",
            "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client)\n{\n readmore:\n    if (client->rx->nfds == 0) {\n        if (virNetServerClientRead(client) < 0) {\n            client->wantClose = true;\n            return NULL; /* Error */\n        }\n    }\n\n    if (client->rx->bufferOffset < client->rx->bufferLength)\n        return NULL; /* Still not read enough */\n\n    /* Either done with length word header */\n    if (client->rx->bufferLength == VIR_NET_MESSAGE_LEN_MAX) {\n        if (virNetMessageDecodeLength(client->rx) < 0) {\n            client->wantClose = true;\n            return NULL;\n        }\n\n        virNetServerClientUpdateEvent(client);\n\n        /* Try and read payload immediately instead of going back\n           into poll() because chances are the data is already\n           waiting for us */\n        goto readmore;\n    } else {\n        /* Grab the completed message */\n        virNetMessagePtr msg = client->rx;\n        virNetMessagePtr response = NULL;\n        virNetServerClientFilterPtr filter;\n        size_t i;\n\n        /* Decode the header so we can use it for routing decisions */\n        if (virNetMessageDecodeHeader(msg) < 0) {\n            virNetMessageQueueServe(&client->rx);\n            virNetMessageFree(msg);\n            client->wantClose = true;\n            return NULL;\n        }\n\n        /* Now figure out if we need to read more data to get some\n         * file descriptors */\n        if (msg->header.type == VIR_NET_CALL_WITH_FDS) {\n            if (virNetMessageDecodeNumFDs(msg) < 0) {\n                virNetMessageQueueServe(&client->rx);\n                virNetMessageFree(msg);\n                client->wantClose = true;\n                return NULL; /* Error */\n            }\n\n            /* Try getting the file descriptors (may fail if blocking) */\n            for (i = msg->donefds; i < msg->nfds; i++) {\n                int rv;\n                if ((rv = virNetSocketRecvFD(client->sock, &(msg->fds[i]))) < 0) {\n                    virNetMessageQueueServe(&client->rx);\n                    virNetMessageFree(msg);\n                    client->wantClose = true;\n                    return NULL;\n                }\n                if (rv == 0) /* Blocking */\n                    break;\n                msg->donefds++;\n            }\n\n            /* Need to poll() until FDs arrive */\n            if (msg->donefds < msg->nfds) {\n                /* Because DecodeHeader/NumFDs reset bufferOffset, we\n                 * put it back to what it was, so everything works\n                 * again next time we run this method\n                 */\n                client->rx->bufferOffset = client->rx->bufferLength;\n                return NULL;\n            }\n        }\n\n        /* Definitely finished reading, so remove from queue */\n        virNetMessageQueueServe(&client->rx);\n        PROBE(RPC_SERVER_CLIENT_MSG_RX,\n              \"client=%p len=%zu prog=%u vers=%u proc=%u type=%u status=%u serial=%u\",\n              client, msg->bufferLength,\n              msg->header.prog, msg->header.vers, msg->header.proc,\n              msg->header.type, msg->header.status, msg->header.serial);\n\n        if (virKeepAliveCheckMessage(client->keepalive, msg, &response)) {\n            virNetMessageFree(msg);\n            client->nrequests--;\n            msg = NULL;\n\n            if (response &&\n                virNetServerClientSendMessageLocked(client, response) < 0)\n                virNetMessageFree(response);\n        }\n\n        /* Maybe send off for queue against a filter */\n        if (msg) {\n            filter = client->filters;\n            while (filter) {\n                int ret = filter->func(client, msg, filter->opaque);\n                if (ret < 0) {\n                    virNetMessageFree(msg);\n                    msg = NULL;\n                    client->wantClose = true;\n                    break;\n                }\n                if (ret > 0) {\n                    msg = NULL;\n                    break;\n                }\n\n                filter = filter->next;\n            }\n        }\n\n        /* Possibly need to create another receive buffer */\n        if (client->nrequests < client->nrequests_max) {\n            if (!(client->rx = virNetMessageNew(true))) {\n                client->wantClose = true;\n            } else {\n                client->rx->bufferLength = VIR_NET_MESSAGE_LEN_MAX;\n                if (VIR_ALLOC_N(client->rx->buffer,\n                                client->rx->bufferLength) < 0) {\n                    client->wantClose = true;\n                } else {\n                    client->nrequests++;\n                }\n            }\n        }\n        virNetServerClientUpdateEvent(client);\n\n        return msg;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientDispatchWrite",
          "args": [
            "client"
          ],
          "line": 1483
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientDispatchWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "1362-1432",
          "snippet": "static void\nvirNetServerClientDispatchWrite(virNetServerClientPtr client)\n{\n    while (client->tx) {\n        if (client->tx->bufferOffset < client->tx->bufferLength) {\n            ssize_t ret;\n            ret = virNetServerClientWrite(client);\n            if (ret < 0) {\n                client->wantClose = true;\n                return;\n            }\n            if (ret == 0)\n                return; /* Would block on write EAGAIN */\n        }\n\n        if (client->tx->bufferOffset == client->tx->bufferLength) {\n            virNetMessagePtr msg;\n            size_t i;\n\n            for (i = client->tx->donefds; i < client->tx->nfds; i++) {\n                int rv;\n                if ((rv = virNetSocketSendFD(client->sock, client->tx->fds[i])) < 0) {\n                    client->wantClose = true;\n                    return;\n                }\n                if (rv == 0) /* Blocking */\n                    return;\n                client->tx->donefds++;\n            }\n\n#if WITH_SASL\n            /* Completed this 'tx' operation, so now read for all\n             * future rx/tx to be under a SASL SSF layer\n             */\n            if (client->sasl) {\n                virNetSocketSetSASLSession(client->sock, client->sasl);\n                virObjectUnref(client->sasl);\n                client->sasl = NULL;\n            }\n#endif\n\n            /* Get finished msg from head of tx queue */\n            msg = virNetMessageQueueServe(&client->tx);\n\n            if (msg->tracked) {\n                client->nrequests--;\n                /* See if the recv queue is currently throttled */\n                if (!client->rx &&\n                    client->nrequests < client->nrequests_max) {\n                    /* Ready to recv more messages */\n                    virNetMessageClear(msg);\n                    msg->bufferLength = VIR_NET_MESSAGE_LEN_MAX;\n                    if (VIR_ALLOC_N(msg->buffer, msg->bufferLength) < 0) {\n                        virNetMessageFree(msg);\n                        return;\n                    }\n                    client->rx = msg;\n                    msg = NULL;\n                    client->nrequests++;\n                }\n            }\n\n            virNetMessageFree(msg);\n\n            virNetServerClientUpdateEvent(client);\n\n            if (client->delayedClose)\n                client->wantClose = true;\n         }\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);",
            "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nstatic void\nvirNetServerClientDispatchWrite(virNetServerClientPtr client)\n{\n    while (client->tx) {\n        if (client->tx->bufferOffset < client->tx->bufferLength) {\n            ssize_t ret;\n            ret = virNetServerClientWrite(client);\n            if (ret < 0) {\n                client->wantClose = true;\n                return;\n            }\n            if (ret == 0)\n                return; /* Would block on write EAGAIN */\n        }\n\n        if (client->tx->bufferOffset == client->tx->bufferLength) {\n            virNetMessagePtr msg;\n            size_t i;\n\n            for (i = client->tx->donefds; i < client->tx->nfds; i++) {\n                int rv;\n                if ((rv = virNetSocketSendFD(client->sock, client->tx->fds[i])) < 0) {\n                    client->wantClose = true;\n                    return;\n                }\n                if (rv == 0) /* Blocking */\n                    return;\n                client->tx->donefds++;\n            }\n\n#if WITH_SASL\n            /* Completed this 'tx' operation, so now read for all\n             * future rx/tx to be under a SASL SSF layer\n             */\n            if (client->sasl) {\n                virNetSocketSetSASLSession(client->sock, client->sasl);\n                virObjectUnref(client->sasl);\n                client->sasl = NULL;\n            }\n#endif\n\n            /* Get finished msg from head of tx queue */\n            msg = virNetMessageQueueServe(&client->tx);\n\n            if (msg->tracked) {\n                client->nrequests--;\n                /* See if the recv queue is currently throttled */\n                if (!client->rx &&\n                    client->nrequests < client->nrequests_max) {\n                    /* Ready to recv more messages */\n                    virNetMessageClear(msg);\n                    msg->bufferLength = VIR_NET_MESSAGE_LEN_MAX;\n                    if (VIR_ALLOC_N(msg->buffer, msg->bufferLength) < 0) {\n                        virNetMessageFree(msg);\n                        return;\n                    }\n                    client->rx = msg;\n                    msg = NULL;\n                    client->nrequests++;\n                }\n            }\n\n            virNetMessageFree(msg);\n\n            virNetServerClientUpdateEvent(client);\n\n            if (client->delayedClose)\n                client->wantClose = true;\n         }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientDispatchHandshake",
          "args": [
            "client"
          ],
          "line": 1480
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientDispatchHandshake",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "1435-1458",
          "snippet": "static void\nvirNetServerClientDispatchHandshake(virNetServerClientPtr client)\n{\n    int ret;\n    /* Continue the handshake. */\n    virObjectLock(client->tlsCtxt);\n    ret = virNetTLSSessionHandshake(client->tls);\n    virObjectUnlock(client->tlsCtxt);\n    if (ret == 0) {\n        /* Finished.  Next step is to check the certificate. */\n        if (virNetServerClientCheckAccess(client) < 0)\n            client->wantClose = true;\n        else\n            virNetServerClientUpdateEvent(client);\n    } else if (ret > 0) {\n        /* Carry on waiting for more handshake. Update\n           the events just in case handshake data flow\n           direction has changed */\n        virNetServerClientUpdateEvent(client);\n    } else {\n        /* Fatal error in handshake */\n        client->wantClose = true;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic void\nvirNetServerClientDispatchHandshake(virNetServerClientPtr client)\n{\n    int ret;\n    /* Continue the handshake. */\n    virObjectLock(client->tlsCtxt);\n    ret = virNetTLSSessionHandshake(client->tls);\n    virObjectUnlock(client->tlsCtxt);\n    if (ret == 0) {\n        /* Finished.  Next step is to check the certificate. */\n        if (virNetServerClientCheckAccess(client) < 0)\n            client->wantClose = true;\n        else\n            virNetServerClientUpdateEvent(client);\n    } else if (ret > 0) {\n        /* Carry on waiting for more handshake. Update\n           the events just in case handshake data flow\n           direction has changed */\n        virNetServerClientUpdateEvent(client);\n    } else {\n        /* Fatal error in handshake */\n        client->wantClose = true;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetTLSSessionGetHandshakeStatus",
          "args": [
            "client->tls"
          ],
          "line": 1478
        },
        "resolved": true,
        "details": {
          "function_name": "virNetTLSSessionGetHandshakeStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnettlscontext.c",
          "lines": "1370-1383",
          "snippet": "virNetTLSSessionHandshakeStatus\nvirNetTLSSessionGetHandshakeStatus(virNetTLSSessionPtr sess)\n{\n    virNetTLSSessionHandshakeStatus ret;\n    virObjectLock(sess);\n    if (sess->handshakeComplete)\n        ret = VIR_NET_TLS_HANDSHAKE_COMPLETE;\n    else if (gnutls_record_get_direction(sess->session) == 0)\n        ret = VIR_NET_TLS_HANDSHAKE_RECVING;\n    else\n        ret = VIR_NET_TLS_HANDSHAKE_SENDING;\n    virObjectUnlock(sess);\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virthread.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virnettlscontext.h\"",
            "#include <gnutls/x509.h>",
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virthread.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virnettlscontext.h\"\n#include <gnutls/x509.h>\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <unistd.h>\n#include <config.h>\n\nvirNetTLSSessionHandshakeStatus\nvirNetTLSSessionGetHandshakeStatus(virNetTLSSessionPtr sess)\n{\n    virNetTLSSessionHandshakeStatus ret;\n    virObjectLock(sess);\n    if (sess->handshakeComplete)\n        ret = VIR_NET_TLS_HANDSHAKE_COMPLETE;\n    else if (gnutls_record_get_direction(sess->session) == 0)\n        ret = VIR_NET_TLS_HANDSHAKE_RECVING;\n    else\n        ret = VIR_NET_TLS_HANDSHAKE_SENDING;\n    virObjectUnlock(sess);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketRemoveIOCallback",
          "args": [
            "sock"
          ],
          "line": 1470
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketRemoveIOCallback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "2237-2252",
          "snippet": "void virNetSocketRemoveIOCallback(virNetSocketPtr sock)\n{\n    virObjectLock(sock);\n\n    if (sock->watch < 0) {\n        VIR_DEBUG(\"Watch not registered on socket %p\", sock);\n        virObjectUnlock(sock);\n        return;\n    }\n\n    virEventRemoveHandle(sock->watch);\n    /* Don't unref @sock, it's done via eventloop callback. */\n    sock->watch = -1;\n\n    virObjectUnlock(sock);\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid virNetSocketRemoveIOCallback(virNetSocketPtr sock)\n{\n    virObjectLock(sock);\n\n    if (sock->watch < 0) {\n        VIR_DEBUG(\"Watch not registered on socket %p\", sock);\n        virObjectUnlock(sock);\n        return;\n    }\n\n    virEventRemoveHandle(sock->watch);\n    /* Don't unref @sock, it's done via eventloop callback. */\n    sock->watch = -1;\n\n    virObjectUnlock(sock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 1467
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nstatic void\nvirNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque)\n{\n    virNetServerClientPtr client = opaque;\n    virNetMessagePtr msg = NULL;\n\n    virObjectLock(client);\n\n    if (client->sock != sock) {\n        virNetSocketRemoveIOCallback(sock);\n        virObjectUnlock(client);\n        return;\n    }\n\n    if (events & (VIR_EVENT_HANDLE_WRITABLE |\n                  VIR_EVENT_HANDLE_READABLE)) {\n        if (client->tls &&\n            virNetTLSSessionGetHandshakeStatus(client->tls) !=\n            VIR_NET_TLS_HANDSHAKE_COMPLETE) {\n            virNetServerClientDispatchHandshake(client);\n        } else {\n            if (events & VIR_EVENT_HANDLE_WRITABLE)\n                virNetServerClientDispatchWrite(client);\n            if (events & VIR_EVENT_HANDLE_READABLE &&\n                client->rx)\n                msg = virNetServerClientDispatchRead(client);\n        }\n    }\n\n    /* NB, will get HANGUP + READABLE at same time upon\n     * disconnect */\n    if (events & (VIR_EVENT_HANDLE_ERROR |\n                  VIR_EVENT_HANDLE_HANGUP))\n        client->wantClose = true;\n\n    virObjectUnlock(client);\n\n    if (msg)\n        virNetServerClientDispatchMessage(client, msg);\n}"
  },
  {
    "function_name": "virNetServerClientDispatchHandshake",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1435-1458",
    "snippet": "static void\nvirNetServerClientDispatchHandshake(virNetServerClientPtr client)\n{\n    int ret;\n    /* Continue the handshake. */\n    virObjectLock(client->tlsCtxt);\n    ret = virNetTLSSessionHandshake(client->tls);\n    virObjectUnlock(client->tlsCtxt);\n    if (ret == 0) {\n        /* Finished.  Next step is to check the certificate. */\n        if (virNetServerClientCheckAccess(client) < 0)\n            client->wantClose = true;\n        else\n            virNetServerClientUpdateEvent(client);\n    } else if (ret > 0) {\n        /* Carry on waiting for more handshake. Update\n           the events just in case handshake data flow\n           direction has changed */\n        virNetServerClientUpdateEvent(client);\n    } else {\n        /* Fatal error in handshake */\n        client->wantClose = true;\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetServerClientUpdateEvent",
          "args": [
            "client"
          ],
          "line": 1453
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientUpdateEvent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "219-232",
          "snippet": "static void virNetServerClientUpdateEvent(virNetServerClientPtr client)\n{\n    int mode;\n\n    if (!client->sock)\n        return;\n\n    mode = virNetServerClientCalculateHandleMode(client);\n\n    virNetSocketUpdateIOCallback(client->sock, mode);\n\n    if (client->rx && virNetSocketHasCachedData(client->sock))\n        virEventUpdateTimeout(client->sockTimer, 0);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client)\n{\n    int mode;\n\n    if (!client->sock)\n        return;\n\n    mode = virNetServerClientCalculateHandleMode(client);\n\n    virNetSocketUpdateIOCallback(client->sock, mode);\n\n    if (client->rx && virNetSocketHasCachedData(client->sock))\n        virEventUpdateTimeout(client->sockTimer, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientCheckAccess",
          "args": [
            "client"
          ],
          "line": 1445
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientCheckAccess",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "292-324",
          "snippet": "static int\nvirNetServerClientCheckAccess(virNetServerClientPtr client)\n{\n    virNetMessagePtr confirm;\n\n    /* Verify client certificate. */\n    if (virNetTLSContextCheckCertificate(client->tlsCtxt, client->tls) < 0)\n        return -1;\n\n    if (client->tx) {\n        VIR_DEBUG(\"client had unexpected data pending tx after access check\");\n        return -1;\n    }\n\n    if (!(confirm = virNetMessageNew(false)))\n        return -1;\n\n    /* Checks have succeeded.  Write a '\\1' byte back to the client to\n     * indicate this (otherwise the socket is abruptly closed).\n     * (NB. The '\\1' byte is sent in an encrypted record).\n     */\n    confirm->bufferLength = 1;\n    if (VIR_ALLOC_N(confirm->buffer, confirm->bufferLength) < 0) {\n        virNetMessageFree(confirm);\n        return -1;\n    }\n    confirm->bufferOffset = 0;\n    confirm->buffer[0] = '\\1';\n\n    client->tx = confirm;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic int\nvirNetServerClientCheckAccess(virNetServerClientPtr client)\n{\n    virNetMessagePtr confirm;\n\n    /* Verify client certificate. */\n    if (virNetTLSContextCheckCertificate(client->tlsCtxt, client->tls) < 0)\n        return -1;\n\n    if (client->tx) {\n        VIR_DEBUG(\"client had unexpected data pending tx after access check\");\n        return -1;\n    }\n\n    if (!(confirm = virNetMessageNew(false)))\n        return -1;\n\n    /* Checks have succeeded.  Write a '\\1' byte back to the client to\n     * indicate this (otherwise the socket is abruptly closed).\n     * (NB. The '\\1' byte is sent in an encrypted record).\n     */\n    confirm->bufferLength = 1;\n    if (VIR_ALLOC_N(confirm->buffer, confirm->bufferLength) < 0) {\n        virNetMessageFree(confirm);\n        return -1;\n    }\n    confirm->bufferOffset = 0;\n    confirm->buffer[0] = '\\1';\n\n    client->tx = confirm;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client->tlsCtxt"
          ],
          "line": 1442
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetTLSSessionHandshake",
          "args": [
            "client->tls"
          ],
          "line": 1441
        },
        "resolved": true,
        "details": {
          "function_name": "virNetTLSSessionHandshake",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnettlscontext.c",
          "lines": "1338-1368",
          "snippet": "int virNetTLSSessionHandshake(virNetTLSSessionPtr sess)\n{\n    int ret;\n    VIR_DEBUG(\"sess=%p\", sess);\n    virObjectLock(sess);\n    ret = gnutls_handshake(sess->session);\n    VIR_DEBUG(\"Ret=%d\", ret);\n    if (ret == 0) {\n        sess->handshakeComplete = true;\n        VIR_DEBUG(\"Handshake is complete\");\n        goto cleanup;\n    }\n    if (ret == GNUTLS_E_INTERRUPTED || ret == GNUTLS_E_AGAIN) {\n        ret = 1;\n        goto cleanup;\n    }\n\n#if 0\n    PROBE(CLIENT_TLS_FAIL, \"fd=%d\",\n          virNetServerClientGetFD(client));\n#endif\n\n    virReportError(VIR_ERR_AUTH_FAILED,\n                   _(\"TLS handshake failed %s\"),\n                   gnutls_strerror(ret));\n    ret = -1;\n\n cleanup:\n    virObjectUnlock(sess);\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virthread.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virnettlscontext.h\"",
            "#include <gnutls/x509.h>",
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virthread.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virnettlscontext.h\"\n#include <gnutls/x509.h>\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <unistd.h>\n#include <config.h>\n\nint virNetTLSSessionHandshake(virNetTLSSessionPtr sess)\n{\n    int ret;\n    VIR_DEBUG(\"sess=%p\", sess);\n    virObjectLock(sess);\n    ret = gnutls_handshake(sess->session);\n    VIR_DEBUG(\"Ret=%d\", ret);\n    if (ret == 0) {\n        sess->handshakeComplete = true;\n        VIR_DEBUG(\"Handshake is complete\");\n        goto cleanup;\n    }\n    if (ret == GNUTLS_E_INTERRUPTED || ret == GNUTLS_E_AGAIN) {\n        ret = 1;\n        goto cleanup;\n    }\n\n#if 0\n    PROBE(CLIENT_TLS_FAIL, \"fd=%d\",\n          virNetServerClientGetFD(client));\n#endif\n\n    virReportError(VIR_ERR_AUTH_FAILED,\n                   _(\"TLS handshake failed %s\"),\n                   gnutls_strerror(ret));\n    ret = -1;\n\n cleanup:\n    virObjectUnlock(sess);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client->tlsCtxt"
          ],
          "line": 1440
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic void\nvirNetServerClientDispatchHandshake(virNetServerClientPtr client)\n{\n    int ret;\n    /* Continue the handshake. */\n    virObjectLock(client->tlsCtxt);\n    ret = virNetTLSSessionHandshake(client->tls);\n    virObjectUnlock(client->tlsCtxt);\n    if (ret == 0) {\n        /* Finished.  Next step is to check the certificate. */\n        if (virNetServerClientCheckAccess(client) < 0)\n            client->wantClose = true;\n        else\n            virNetServerClientUpdateEvent(client);\n    } else if (ret > 0) {\n        /* Carry on waiting for more handshake. Update\n           the events just in case handshake data flow\n           direction has changed */\n        virNetServerClientUpdateEvent(client);\n    } else {\n        /* Fatal error in handshake */\n        client->wantClose = true;\n    }\n}"
  },
  {
    "function_name": "virNetServerClientDispatchWrite",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1362-1432",
    "snippet": "static void\nvirNetServerClientDispatchWrite(virNetServerClientPtr client)\n{\n    while (client->tx) {\n        if (client->tx->bufferOffset < client->tx->bufferLength) {\n            ssize_t ret;\n            ret = virNetServerClientWrite(client);\n            if (ret < 0) {\n                client->wantClose = true;\n                return;\n            }\n            if (ret == 0)\n                return; /* Would block on write EAGAIN */\n        }\n\n        if (client->tx->bufferOffset == client->tx->bufferLength) {\n            virNetMessagePtr msg;\n            size_t i;\n\n            for (i = client->tx->donefds; i < client->tx->nfds; i++) {\n                int rv;\n                if ((rv = virNetSocketSendFD(client->sock, client->tx->fds[i])) < 0) {\n                    client->wantClose = true;\n                    return;\n                }\n                if (rv == 0) /* Blocking */\n                    return;\n                client->tx->donefds++;\n            }\n\n#if WITH_SASL\n            /* Completed this 'tx' operation, so now read for all\n             * future rx/tx to be under a SASL SSF layer\n             */\n            if (client->sasl) {\n                virNetSocketSetSASLSession(client->sock, client->sasl);\n                virObjectUnref(client->sasl);\n                client->sasl = NULL;\n            }\n#endif\n\n            /* Get finished msg from head of tx queue */\n            msg = virNetMessageQueueServe(&client->tx);\n\n            if (msg->tracked) {\n                client->nrequests--;\n                /* See if the recv queue is currently throttled */\n                if (!client->rx &&\n                    client->nrequests < client->nrequests_max) {\n                    /* Ready to recv more messages */\n                    virNetMessageClear(msg);\n                    msg->bufferLength = VIR_NET_MESSAGE_LEN_MAX;\n                    if (VIR_ALLOC_N(msg->buffer, msg->bufferLength) < 0) {\n                        virNetMessageFree(msg);\n                        return;\n                    }\n                    client->rx = msg;\n                    msg = NULL;\n                    client->nrequests++;\n                }\n            }\n\n            virNetMessageFree(msg);\n\n            virNetServerClientUpdateEvent(client);\n\n            if (client->delayedClose)\n                client->wantClose = true;\n         }\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);",
      "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetServerClientUpdateEvent",
          "args": [
            "client"
          ],
          "line": 1426
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientUpdateEvent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "219-232",
          "snippet": "static void virNetServerClientUpdateEvent(virNetServerClientPtr client)\n{\n    int mode;\n\n    if (!client->sock)\n        return;\n\n    mode = virNetServerClientCalculateHandleMode(client);\n\n    virNetSocketUpdateIOCallback(client->sock, mode);\n\n    if (client->rx && virNetSocketHasCachedData(client->sock))\n        virEventUpdateTimeout(client->sockTimer, 0);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client)\n{\n    int mode;\n\n    if (!client->sock)\n        return;\n\n    mode = virNetServerClientCalculateHandleMode(client);\n\n    virNetSocketUpdateIOCallback(client->sock, mode);\n\n    if (client->rx && virNetSocketHasCachedData(client->sock))\n        virEventUpdateTimeout(client->sockTimer, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetMessageFree",
          "args": [
            "msg"
          ],
          "line": 1424
        },
        "resolved": true,
        "details": {
          "function_name": "virNetMessageFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetmessage.c",
          "lines": "81-93",
          "snippet": "void virNetMessageFree(virNetMessagePtr msg)\n{\n    if (!msg)\n        return;\n\n    VIR_DEBUG(\"msg=%p nfds=%zu cb=%p\", msg, msg->nfds, msg->cb);\n\n    if (msg->cb)\n        msg->cb(msg, msg->opaque);\n\n    virNetMessageClearPayload(msg);\n    VIR_FREE(msg);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetmessage.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetmessage.h\"\n#include <unistd.h>\n#include <config.h>\n\nvoid virNetMessageFree(virNetMessagePtr msg)\n{\n    if (!msg)\n        return;\n\n    VIR_DEBUG(\"msg=%p nfds=%zu cb=%p\", msg, msg->nfds, msg->cb);\n\n    if (msg->cb)\n        msg->cb(msg, msg->opaque);\n\n    virNetMessageClearPayload(msg);\n    VIR_FREE(msg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "msg->buffer",
            "msg->bufferLength"
          ],
          "line": 1414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetMessageClear",
          "args": [
            "msg"
          ],
          "line": 1412
        },
        "resolved": true,
        "details": {
          "function_name": "virNetMessageClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetmessage.c",
          "lines": "69-78",
          "snippet": "void virNetMessageClear(virNetMessagePtr msg)\n{\n    bool tracked = msg->tracked;\n\n    VIR_DEBUG(\"msg=%p nfds=%zu\", msg, msg->nfds);\n\n    virNetMessageClearPayload(msg);\n    memset(msg, 0, sizeof(*msg));\n    msg->tracked = tracked;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetmessage.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetmessage.h\"\n#include <unistd.h>\n#include <config.h>\n\nvoid virNetMessageClear(virNetMessagePtr msg)\n{\n    bool tracked = msg->tracked;\n\n    VIR_DEBUG(\"msg=%p nfds=%zu\", msg, msg->nfds);\n\n    virNetMessageClearPayload(msg);\n    memset(msg, 0, sizeof(*msg));\n    msg->tracked = tracked;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetMessageQueueServe",
          "args": [
            "&client->tx"
          ],
          "line": 1404
        },
        "resolved": true,
        "details": {
          "function_name": "virNetMessageQueueServe",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetmessage.c",
          "lines": "109-119",
          "snippet": "virNetMessagePtr virNetMessageQueueServe(virNetMessagePtr *queue)\n{\n    virNetMessagePtr tmp = *queue;\n\n    if (tmp) {\n        *queue = tmp->next;\n        tmp->next = NULL;\n    }\n\n    return tmp;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetmessage.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetmessage.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirNetMessagePtr virNetMessageQueueServe(virNetMessagePtr *queue)\n{\n    virNetMessagePtr tmp = *queue;\n\n    if (tmp) {\n        *queue = tmp->next;\n        tmp->next = NULL;\n    }\n\n    return tmp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "client->sasl"
          ],
          "line": 1398
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketSetSASLSession",
          "args": [
            "client->sock",
            "client->sasl"
          ],
          "line": 1397
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketSetSASLSession",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1690-1697",
          "snippet": "void virNetSocketSetSASLSession(virNetSocketPtr sock,\n                                virNetSASLSessionPtr sess)\n{\n    virObjectLock(sock);\n    virObjectUnref(sock->saslSession);\n    sock->saslSession = virObjectRef(sess);\n    virObjectUnlock(sock);\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid virNetSocketSetSASLSession(virNetSocketPtr sock,\n                                virNetSASLSessionPtr sess)\n{\n    virObjectLock(sock);\n    virObjectUnref(sock->saslSession);\n    sock->saslSession = virObjectRef(sess);\n    virObjectUnlock(sock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketSendFD",
          "args": [
            "client->sock",
            "client->tx->fds[i]"
          ],
          "line": 1383
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketSendFD",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "2022-2047",
          "snippet": "int virNetSocketSendFD(virNetSocketPtr sock, int fd)\n{\n    int ret = -1;\n    if (!virNetSocketHasPassFD(sock)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Sending file descriptors is not supported on this socket\"));\n        return -1;\n    }\n    virObjectLock(sock);\n    PROBE(RPC_SOCKET_SEND_FD,\n          \"sock=%p fd=%d\", sock, fd);\n    if (virSocketSendFD(sock->fd, fd) < 0) {\n        if (errno == EAGAIN)\n            ret = 0;\n        else\n            virReportSystemError(errno,\n                                 _(\"Failed to send file descriptor %d\"),\n                                 fd);\n        goto cleanup;\n    }\n    ret = 1;\n\n cleanup:\n    virObjectUnlock(sock);\n    return ret;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nint virNetSocketSendFD(virNetSocketPtr sock, int fd)\n{\n    int ret = -1;\n    if (!virNetSocketHasPassFD(sock)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Sending file descriptors is not supported on this socket\"));\n        return -1;\n    }\n    virObjectLock(sock);\n    PROBE(RPC_SOCKET_SEND_FD,\n          \"sock=%p fd=%d\", sock, fd);\n    if (virSocketSendFD(sock->fd, fd) < 0) {\n        if (errno == EAGAIN)\n            ret = 0;\n        else\n            virReportSystemError(errno,\n                                 _(\"Failed to send file descriptor %d\"),\n                                 fd);\n        goto cleanup;\n    }\n    ret = 1;\n\n cleanup:\n    virObjectUnlock(sock);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientWrite",
          "args": [
            "client"
          ],
          "line": 1368
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "1332-1355",
          "snippet": "static ssize_t virNetServerClientWrite(virNetServerClientPtr client)\n{\n    ssize_t ret;\n\n    if (client->tx->bufferLength < client->tx->bufferOffset) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"unexpected zero/negative length request %lld\"),\n                       (long long int)(client->tx->bufferLength - client->tx->bufferOffset));\n        client->wantClose = true;\n        return -1;\n    }\n\n    if (client->tx->bufferLength == client->tx->bufferOffset)\n        return 1;\n\n    ret = virNetSocketWrite(client->sock,\n                            client->tx->buffer + client->tx->bufferOffset,\n                            client->tx->bufferLength - client->tx->bufferOffset);\n    if (ret <= 0)\n        return ret; /* -1 error, 0 = egain */\n\n    client->tx->bufferOffset += ret;\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic ssize_t virNetServerClientWrite(virNetServerClientPtr client)\n{\n    ssize_t ret;\n\n    if (client->tx->bufferLength < client->tx->bufferOffset) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"unexpected zero/negative length request %lld\"),\n                       (long long int)(client->tx->bufferLength - client->tx->bufferOffset));\n        client->wantClose = true;\n        return -1;\n    }\n\n    if (client->tx->bufferLength == client->tx->bufferOffset)\n        return 1;\n\n    ret = virNetSocketWrite(client->sock,\n                            client->tx->buffer + client->tx->bufferOffset,\n                            client->tx->bufferLength - client->tx->bufferOffset);\n    if (ret <= 0)\n        return ret; /* -1 error, 0 = egain */\n\n    client->tx->bufferOffset += ret;\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nstatic void\nvirNetServerClientDispatchWrite(virNetServerClientPtr client)\n{\n    while (client->tx) {\n        if (client->tx->bufferOffset < client->tx->bufferLength) {\n            ssize_t ret;\n            ret = virNetServerClientWrite(client);\n            if (ret < 0) {\n                client->wantClose = true;\n                return;\n            }\n            if (ret == 0)\n                return; /* Would block on write EAGAIN */\n        }\n\n        if (client->tx->bufferOffset == client->tx->bufferLength) {\n            virNetMessagePtr msg;\n            size_t i;\n\n            for (i = client->tx->donefds; i < client->tx->nfds; i++) {\n                int rv;\n                if ((rv = virNetSocketSendFD(client->sock, client->tx->fds[i])) < 0) {\n                    client->wantClose = true;\n                    return;\n                }\n                if (rv == 0) /* Blocking */\n                    return;\n                client->tx->donefds++;\n            }\n\n#if WITH_SASL\n            /* Completed this 'tx' operation, so now read for all\n             * future rx/tx to be under a SASL SSF layer\n             */\n            if (client->sasl) {\n                virNetSocketSetSASLSession(client->sock, client->sasl);\n                virObjectUnref(client->sasl);\n                client->sasl = NULL;\n            }\n#endif\n\n            /* Get finished msg from head of tx queue */\n            msg = virNetMessageQueueServe(&client->tx);\n\n            if (msg->tracked) {\n                client->nrequests--;\n                /* See if the recv queue is currently throttled */\n                if (!client->rx &&\n                    client->nrequests < client->nrequests_max) {\n                    /* Ready to recv more messages */\n                    virNetMessageClear(msg);\n                    msg->bufferLength = VIR_NET_MESSAGE_LEN_MAX;\n                    if (VIR_ALLOC_N(msg->buffer, msg->bufferLength) < 0) {\n                        virNetMessageFree(msg);\n                        return;\n                    }\n                    client->rx = msg;\n                    msg = NULL;\n                    client->nrequests++;\n                }\n            }\n\n            virNetMessageFree(msg);\n\n            virNetServerClientUpdateEvent(client);\n\n            if (client->delayedClose)\n                client->wantClose = true;\n         }\n    }\n}"
  },
  {
    "function_name": "virNetServerClientWrite",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1332-1355",
    "snippet": "static ssize_t virNetServerClientWrite(virNetServerClientPtr client)\n{\n    ssize_t ret;\n\n    if (client->tx->bufferLength < client->tx->bufferOffset) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"unexpected zero/negative length request %lld\"),\n                       (long long int)(client->tx->bufferLength - client->tx->bufferOffset));\n        client->wantClose = true;\n        return -1;\n    }\n\n    if (client->tx->bufferLength == client->tx->bufferOffset)\n        return 1;\n\n    ret = virNetSocketWrite(client->sock,\n                            client->tx->buffer + client->tx->bufferOffset,\n                            client->tx->bufferLength - client->tx->bufferOffset);\n    if (ret <= 0)\n        return ret; /* -1 error, 0 = egain */\n\n    client->tx->bufferOffset += ret;\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetSocketWrite",
          "args": [
            "client->sock",
            "client->tx->buffer + client->tx->bufferOffset",
            "client->tx->bufferLength - client->tx->bufferOffset"
          ],
          "line": 1347
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "2003-2016",
          "snippet": "ssize_t virNetSocketWrite(virNetSocketPtr sock, const char *buf, size_t len)\n{\n    ssize_t ret;\n\n    virObjectLock(sock);\n#if WITH_SASL\n    if (sock->saslSession)\n        ret = virNetSocketWriteSASL(sock, buf, len);\n    else\n#endif\n        ret = virNetSocketWriteWire(sock, buf, len);\n    virObjectUnlock(sock);\n    return ret;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nssize_t virNetSocketWrite(virNetSocketPtr sock, const char *buf, size_t len)\n{\n    ssize_t ret;\n\n    virObjectLock(sock);\n#if WITH_SASL\n    if (sock->saslSession)\n        ret = virNetSocketWriteSASL(sock, buf, len);\n    else\n#endif\n        ret = virNetSocketWriteWire(sock, buf, len);\n    virObjectUnlock(sock);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_RPC",
            "_(\"unexpected zero/negative length request %lld\")",
            "(long long int)(client->tx->bufferLength - client->tx->bufferOffset)"
          ],
          "line": 1337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unexpected zero/negative length request %lld\""
          ],
          "line": 1338
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic ssize_t virNetServerClientWrite(virNetServerClientPtr client)\n{\n    ssize_t ret;\n\n    if (client->tx->bufferLength < client->tx->bufferOffset) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"unexpected zero/negative length request %lld\"),\n                       (long long int)(client->tx->bufferLength - client->tx->bufferOffset));\n        client->wantClose = true;\n        return -1;\n    }\n\n    if (client->tx->bufferLength == client->tx->bufferOffset)\n        return 1;\n\n    ret = virNetSocketWrite(client->sock,\n                            client->tx->buffer + client->tx->bufferOffset,\n                            client->tx->bufferLength - client->tx->bufferOffset);\n    if (ret <= 0)\n        return ret; /* -1 error, 0 = egain */\n\n    client->tx->bufferOffset += ret;\n    return ret;\n}"
  },
  {
    "function_name": "virNetServerClientDispatchRead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1189-1321",
    "snippet": "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client)\n{\n readmore:\n    if (client->rx->nfds == 0) {\n        if (virNetServerClientRead(client) < 0) {\n            client->wantClose = true;\n            return NULL; /* Error */\n        }\n    }\n\n    if (client->rx->bufferOffset < client->rx->bufferLength)\n        return NULL; /* Still not read enough */\n\n    /* Either done with length word header */\n    if (client->rx->bufferLength == VIR_NET_MESSAGE_LEN_MAX) {\n        if (virNetMessageDecodeLength(client->rx) < 0) {\n            client->wantClose = true;\n            return NULL;\n        }\n\n        virNetServerClientUpdateEvent(client);\n\n        /* Try and read payload immediately instead of going back\n           into poll() because chances are the data is already\n           waiting for us */\n        goto readmore;\n    } else {\n        /* Grab the completed message */\n        virNetMessagePtr msg = client->rx;\n        virNetMessagePtr response = NULL;\n        virNetServerClientFilterPtr filter;\n        size_t i;\n\n        /* Decode the header so we can use it for routing decisions */\n        if (virNetMessageDecodeHeader(msg) < 0) {\n            virNetMessageQueueServe(&client->rx);\n            virNetMessageFree(msg);\n            client->wantClose = true;\n            return NULL;\n        }\n\n        /* Now figure out if we need to read more data to get some\n         * file descriptors */\n        if (msg->header.type == VIR_NET_CALL_WITH_FDS) {\n            if (virNetMessageDecodeNumFDs(msg) < 0) {\n                virNetMessageQueueServe(&client->rx);\n                virNetMessageFree(msg);\n                client->wantClose = true;\n                return NULL; /* Error */\n            }\n\n            /* Try getting the file descriptors (may fail if blocking) */\n            for (i = msg->donefds; i < msg->nfds; i++) {\n                int rv;\n                if ((rv = virNetSocketRecvFD(client->sock, &(msg->fds[i]))) < 0) {\n                    virNetMessageQueueServe(&client->rx);\n                    virNetMessageFree(msg);\n                    client->wantClose = true;\n                    return NULL;\n                }\n                if (rv == 0) /* Blocking */\n                    break;\n                msg->donefds++;\n            }\n\n            /* Need to poll() until FDs arrive */\n            if (msg->donefds < msg->nfds) {\n                /* Because DecodeHeader/NumFDs reset bufferOffset, we\n                 * put it back to what it was, so everything works\n                 * again next time we run this method\n                 */\n                client->rx->bufferOffset = client->rx->bufferLength;\n                return NULL;\n            }\n        }\n\n        /* Definitely finished reading, so remove from queue */\n        virNetMessageQueueServe(&client->rx);\n        PROBE(RPC_SERVER_CLIENT_MSG_RX,\n              \"client=%p len=%zu prog=%u vers=%u proc=%u type=%u status=%u serial=%u\",\n              client, msg->bufferLength,\n              msg->header.prog, msg->header.vers, msg->header.proc,\n              msg->header.type, msg->header.status, msg->header.serial);\n\n        if (virKeepAliveCheckMessage(client->keepalive, msg, &response)) {\n            virNetMessageFree(msg);\n            client->nrequests--;\n            msg = NULL;\n\n            if (response &&\n                virNetServerClientSendMessageLocked(client, response) < 0)\n                virNetMessageFree(response);\n        }\n\n        /* Maybe send off for queue against a filter */\n        if (msg) {\n            filter = client->filters;\n            while (filter) {\n                int ret = filter->func(client, msg, filter->opaque);\n                if (ret < 0) {\n                    virNetMessageFree(msg);\n                    msg = NULL;\n                    client->wantClose = true;\n                    break;\n                }\n                if (ret > 0) {\n                    msg = NULL;\n                    break;\n                }\n\n                filter = filter->next;\n            }\n        }\n\n        /* Possibly need to create another receive buffer */\n        if (client->nrequests < client->nrequests_max) {\n            if (!(client->rx = virNetMessageNew(true))) {\n                client->wantClose = true;\n            } else {\n                client->rx->bufferLength = VIR_NET_MESSAGE_LEN_MAX;\n                if (VIR_ALLOC_N(client->rx->buffer,\n                                client->rx->bufferLength) < 0) {\n                    client->wantClose = true;\n                } else {\n                    client->nrequests++;\n                }\n            }\n        }\n        virNetServerClientUpdateEvent(client);\n\n        return msg;\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);",
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);",
      "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetServerClientUpdateEvent",
          "args": [
            "client"
          ],
          "line": 1317
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientUpdateEvent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "219-232",
          "snippet": "static void virNetServerClientUpdateEvent(virNetServerClientPtr client)\n{\n    int mode;\n\n    if (!client->sock)\n        return;\n\n    mode = virNetServerClientCalculateHandleMode(client);\n\n    virNetSocketUpdateIOCallback(client->sock, mode);\n\n    if (client->rx && virNetSocketHasCachedData(client->sock))\n        virEventUpdateTimeout(client->sockTimer, 0);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client)\n{\n    int mode;\n\n    if (!client->sock)\n        return;\n\n    mode = virNetServerClientCalculateHandleMode(client);\n\n    virNetSocketUpdateIOCallback(client->sock, mode);\n\n    if (client->rx && virNetSocketHasCachedData(client->sock))\n        virEventUpdateTimeout(client->sockTimer, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "client->rx->buffer",
            "client->rx->bufferLength"
          ],
          "line": 1309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetMessageNew",
          "args": [
            "true"
          ],
          "line": 1305
        },
        "resolved": true,
        "details": {
          "function_name": "virNetMessageNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetmessage.c",
          "lines": "37-48",
          "snippet": "virNetMessagePtr virNetMessageNew(bool tracked)\n{\n    virNetMessagePtr msg;\n\n    if (VIR_ALLOC(msg) < 0)\n        return NULL;\n\n    msg->tracked = tracked;\n    VIR_DEBUG(\"msg=%p tracked=%d\", msg, tracked);\n\n    return msg;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetmessage.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetmessage.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirNetMessagePtr virNetMessageNew(bool tracked)\n{\n    virNetMessagePtr msg;\n\n    if (VIR_ALLOC(msg) < 0)\n        return NULL;\n\n    msg->tracked = tracked;\n    VIR_DEBUG(\"msg=%p tracked=%d\", msg, tracked);\n\n    return msg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetMessageFree",
          "args": [
            "msg"
          ],
          "line": 1289
        },
        "resolved": true,
        "details": {
          "function_name": "virNetMessageFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetmessage.c",
          "lines": "81-93",
          "snippet": "void virNetMessageFree(virNetMessagePtr msg)\n{\n    if (!msg)\n        return;\n\n    VIR_DEBUG(\"msg=%p nfds=%zu cb=%p\", msg, msg->nfds, msg->cb);\n\n    if (msg->cb)\n        msg->cb(msg, msg->opaque);\n\n    virNetMessageClearPayload(msg);\n    VIR_FREE(msg);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetmessage.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetmessage.h\"\n#include <unistd.h>\n#include <config.h>\n\nvoid virNetMessageFree(virNetMessagePtr msg)\n{\n    if (!msg)\n        return;\n\n    VIR_DEBUG(\"msg=%p nfds=%zu cb=%p\", msg, msg->nfds, msg->cb);\n\n    if (msg->cb)\n        msg->cb(msg, msg->opaque);\n\n    virNetMessageClearPayload(msg);\n    VIR_FREE(msg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter->func",
          "args": [
            "client",
            "msg",
            "filter->opaque"
          ],
          "line": 1287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetServerClientSendMessageLocked",
          "args": [
            "client",
            "response"
          ],
          "line": 1279
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientSendMessageLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "1503-1526",
          "snippet": "static int\nvirNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                    virNetMessagePtr msg)\n{\n    int ret = -1;\n    VIR_DEBUG(\"msg=%p proc=%d len=%zu offset=%zu\",\n              msg, msg->header.proc,\n              msg->bufferLength, msg->bufferOffset);\n\n    msg->donefds = 0;\n    if (client->sock && !client->wantClose) {\n        PROBE(RPC_SERVER_CLIENT_MSG_TX_QUEUE,\n              \"client=%p len=%zu prog=%u vers=%u proc=%u type=%u status=%u serial=%u\",\n              client, msg->bufferLength,\n              msg->header.prog, msg->header.vers, msg->header.proc,\n              msg->header.type, msg->header.status, msg->header.serial);\n        virNetMessageQueuePush(&client->tx, msg);\n\n        virNetServerClientUpdateEvent(client);\n        ret = 0;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);",
            "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nstatic int\nvirNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                    virNetMessagePtr msg)\n{\n    int ret = -1;\n    VIR_DEBUG(\"msg=%p proc=%d len=%zu offset=%zu\",\n              msg, msg->header.proc,\n              msg->bufferLength, msg->bufferOffset);\n\n    msg->donefds = 0;\n    if (client->sock && !client->wantClose) {\n        PROBE(RPC_SERVER_CLIENT_MSG_TX_QUEUE,\n              \"client=%p len=%zu prog=%u vers=%u proc=%u type=%u status=%u serial=%u\",\n              client, msg->bufferLength,\n              msg->header.prog, msg->header.vers, msg->header.proc,\n              msg->header.type, msg->header.status, msg->header.serial);\n        virNetMessageQueuePush(&client->tx, msg);\n\n        virNetServerClientUpdateEvent(client);\n        ret = 0;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virKeepAliveCheckMessage",
          "args": [
            "client->keepalive",
            "msg",
            "&response"
          ],
          "line": 1273
        },
        "resolved": true,
        "details": {
          "function_name": "virKeepAliveCheckMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virkeepalive.c",
          "lines": "361-410",
          "snippet": "bool\nvirKeepAliveCheckMessage(virKeepAlivePtr ka,\n                         virNetMessagePtr msg,\n                         virNetMessagePtr *response)\n{\n    bool ret = false;\n\n    VIR_DEBUG(\"ka=%p, client=%p, msg=%p\",\n              ka, ka ? ka->client : \"(null)\", msg);\n\n    *response = NULL;\n    if (!ka)\n        return false;\n\n    virObjectLock(ka);\n\n    ka->countToDeath = ka->count;\n    ka->lastPacketReceived = ka->intervalStart = time(NULL);\n\n    if (msg->header.prog == KEEPALIVE_PROGRAM &&\n        msg->header.vers == KEEPALIVE_PROTOCOL_VERSION &&\n        msg->header.type == VIR_NET_MESSAGE) {\n        PROBE(RPC_KEEPALIVE_RECEIVED,\n              \"ka=%p client=%p prog=%d vers=%d proc=%d\",\n              ka, ka->client, msg->header.prog,\n              msg->header.vers, msg->header.proc);\n        ret = true;\n        switch (msg->header.proc) {\n        case KEEPALIVE_PROC_PING:\n            VIR_DEBUG(\"Got keepalive request from client %p\", ka->client);\n            *response = virKeepAliveMessage(ka, KEEPALIVE_PROC_PONG);\n            break;\n\n        case KEEPALIVE_PROC_PONG:\n            VIR_DEBUG(\"Got keepalive response from client %p\", ka->client);\n            break;\n\n        default:\n            VIR_DEBUG(\"Ignoring unknown keepalive message %d from client %p\",\n                      msg->header.proc, ka->client);\n        }\n    }\n\n    if (ka->timer >= 0)\n        virEventUpdateTimeout(ka->timer, ka->interval * 1000);\n\n    virObjectUnlock(ka);\n\n    return ret;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virkeepaliveprotocol.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virkeepaliveprotocol.h\"\n#include \"virnetsocket.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nbool\nvirKeepAliveCheckMessage(virKeepAlivePtr ka,\n                         virNetMessagePtr msg,\n                         virNetMessagePtr *response)\n{\n    bool ret = false;\n\n    VIR_DEBUG(\"ka=%p, client=%p, msg=%p\",\n              ka, ka ? ka->client : \"(null)\", msg);\n\n    *response = NULL;\n    if (!ka)\n        return false;\n\n    virObjectLock(ka);\n\n    ka->countToDeath = ka->count;\n    ka->lastPacketReceived = ka->intervalStart = time(NULL);\n\n    if (msg->header.prog == KEEPALIVE_PROGRAM &&\n        msg->header.vers == KEEPALIVE_PROTOCOL_VERSION &&\n        msg->header.type == VIR_NET_MESSAGE) {\n        PROBE(RPC_KEEPALIVE_RECEIVED,\n              \"ka=%p client=%p prog=%d vers=%d proc=%d\",\n              ka, ka->client, msg->header.prog,\n              msg->header.vers, msg->header.proc);\n        ret = true;\n        switch (msg->header.proc) {\n        case KEEPALIVE_PROC_PING:\n            VIR_DEBUG(\"Got keepalive request from client %p\", ka->client);\n            *response = virKeepAliveMessage(ka, KEEPALIVE_PROC_PONG);\n            break;\n\n        case KEEPALIVE_PROC_PONG:\n            VIR_DEBUG(\"Got keepalive response from client %p\", ka->client);\n            break;\n\n        default:\n            VIR_DEBUG(\"Ignoring unknown keepalive message %d from client %p\",\n                      msg->header.proc, ka->client);\n        }\n    }\n\n    if (ka->timer >= 0)\n        virEventUpdateTimeout(ka->timer, ka->interval * 1000);\n\n    virObjectUnlock(ka);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PROBE",
          "args": [
            "RPC_SERVER_CLIENT_MSG_RX",
            "\"client=%p len=%zu prog=%u vers=%u proc=%u type=%u status=%u serial=%u\"",
            "client",
            "msg->bufferLength",
            "msg->header.prog",
            "msg->header.vers",
            "msg->header.proc",
            "msg->header.type",
            "msg->header.status",
            "msg->header.serial"
          ],
          "line": 1267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetMessageQueueServe",
          "args": [
            "&client->rx"
          ],
          "line": 1266
        },
        "resolved": true,
        "details": {
          "function_name": "virNetMessageQueueServe",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetmessage.c",
          "lines": "109-119",
          "snippet": "virNetMessagePtr virNetMessageQueueServe(virNetMessagePtr *queue)\n{\n    virNetMessagePtr tmp = *queue;\n\n    if (tmp) {\n        *queue = tmp->next;\n        tmp->next = NULL;\n    }\n\n    return tmp;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetmessage.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetmessage.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirNetMessagePtr virNetMessageQueueServe(virNetMessagePtr *queue)\n{\n    virNetMessagePtr tmp = *queue;\n\n    if (tmp) {\n        *queue = tmp->next;\n        tmp->next = NULL;\n    }\n\n    return tmp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketRecvFD",
          "args": [
            "client->sock",
            "&(msg->fds[i])"
          ],
          "line": 1243
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketRecvFD",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "2053-2081",
          "snippet": "int virNetSocketRecvFD(virNetSocketPtr sock, int *fd)\n{\n    int ret = -1;\n\n    *fd = -1;\n\n    if (!virNetSocketHasPassFD(sock)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Receiving file descriptors is not supported on this socket\"));\n        return -1;\n    }\n    virObjectLock(sock);\n\n    if ((*fd = virSocketRecvFD(sock->fd, O_CLOEXEC)) < 0) {\n        if (errno == EAGAIN)\n            ret = 0;\n        else\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Failed to recv file descriptor\"));\n        goto cleanup;\n    }\n    PROBE(RPC_SOCKET_RECV_FD,\n          \"sock=%p fd=%d\", sock, *fd);\n    ret = 1;\n\n cleanup:\n    virObjectUnlock(sock);\n    return ret;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nint virNetSocketRecvFD(virNetSocketPtr sock, int *fd)\n{\n    int ret = -1;\n\n    *fd = -1;\n\n    if (!virNetSocketHasPassFD(sock)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Receiving file descriptors is not supported on this socket\"));\n        return -1;\n    }\n    virObjectLock(sock);\n\n    if ((*fd = virSocketRecvFD(sock->fd, O_CLOEXEC)) < 0) {\n        if (errno == EAGAIN)\n            ret = 0;\n        else\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Failed to recv file descriptor\"));\n        goto cleanup;\n    }\n    PROBE(RPC_SOCKET_RECV_FD,\n          \"sock=%p fd=%d\", sock, *fd);\n    ret = 1;\n\n cleanup:\n    virObjectUnlock(sock);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetMessageDecodeNumFDs",
          "args": [
            "msg"
          ],
          "line": 1233
        },
        "resolved": true,
        "details": {
          "function_name": "virNetMessageDecodeNumFDs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetmessage.c",
          "lines": "307-344",
          "snippet": "int virNetMessageDecodeNumFDs(virNetMessagePtr msg)\n{\n    XDR xdr;\n    unsigned int numFDs;\n    int ret = -1;\n    size_t i;\n\n    xdrmem_create(&xdr, msg->buffer + msg->bufferOffset,\n                  msg->bufferLength - msg->bufferOffset, XDR_DECODE);\n    if (!xdr_u_int(&xdr, &numFDs)) {\n        virReportError(VIR_ERR_RPC, \"%s\", _(\"Unable to decode number of FDs\"));\n        goto cleanup;\n    }\n    msg->bufferOffset += xdr_getpos(&xdr);\n\n    if (numFDs > VIR_NET_MESSAGE_NUM_FDS_MAX) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"Received too many FDs %d, expected %d maximum\"),\n                       numFDs, VIR_NET_MESSAGE_NUM_FDS_MAX);\n        goto cleanup;\n    }\n\n    if (msg->nfds == 0) {\n        msg->nfds = numFDs;\n        if (VIR_ALLOC_N(msg->fds, msg->nfds) < 0)\n            goto cleanup;\n        for (i = 0; i < msg->nfds; i++)\n            msg->fds[i] = -1;\n    }\n\n    VIR_DEBUG(\"Got %zu FDs from peer\", msg->nfds);\n\n    ret = 0;\n\n cleanup:\n    xdr_destroy(&xdr);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetmessage.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetmessage.h\"\n#include <unistd.h>\n#include <config.h>\n\nint virNetMessageDecodeNumFDs(virNetMessagePtr msg)\n{\n    XDR xdr;\n    unsigned int numFDs;\n    int ret = -1;\n    size_t i;\n\n    xdrmem_create(&xdr, msg->buffer + msg->bufferOffset,\n                  msg->bufferLength - msg->bufferOffset, XDR_DECODE);\n    if (!xdr_u_int(&xdr, &numFDs)) {\n        virReportError(VIR_ERR_RPC, \"%s\", _(\"Unable to decode number of FDs\"));\n        goto cleanup;\n    }\n    msg->bufferOffset += xdr_getpos(&xdr);\n\n    if (numFDs > VIR_NET_MESSAGE_NUM_FDS_MAX) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"Received too many FDs %d, expected %d maximum\"),\n                       numFDs, VIR_NET_MESSAGE_NUM_FDS_MAX);\n        goto cleanup;\n    }\n\n    if (msg->nfds == 0) {\n        msg->nfds = numFDs;\n        if (VIR_ALLOC_N(msg->fds, msg->nfds) < 0)\n            goto cleanup;\n        for (i = 0; i < msg->nfds; i++)\n            msg->fds[i] = -1;\n    }\n\n    VIR_DEBUG(\"Got %zu FDs from peer\", msg->nfds);\n\n    ret = 0;\n\n cleanup:\n    xdr_destroy(&xdr);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetMessageDecodeHeader",
          "args": [
            "msg"
          ],
          "line": 1223
        },
        "resolved": true,
        "details": {
          "function_name": "virNetMessageDecodeHeader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetmessage.c",
          "lines": "181-212",
          "snippet": "int virNetMessageDecodeHeader(virNetMessagePtr msg)\n{\n    XDR xdr;\n    int ret = -1;\n\n    if (msg->bufferLength < VIR_NET_MESSAGE_LEN_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to decode header until len is received\"));\n        return -1;\n    }\n\n    msg->bufferOffset = VIR_NET_MESSAGE_LEN_MAX;\n\n    /* Parse the header. */\n    xdrmem_create(&xdr,\n                  msg->buffer + msg->bufferOffset,\n                  msg->bufferLength - msg->bufferOffset,\n                  XDR_DECODE);\n\n    if (!xdr_virNetMessageHeader(&xdr, &msg->header)) {\n        virReportError(VIR_ERR_RPC, \"%s\", _(\"Unable to decode message header\"));\n        goto cleanup;\n    }\n\n    msg->bufferOffset += xdr_getpos(&xdr);\n\n    ret = 0;\n\n cleanup:\n    xdr_destroy(&xdr);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetmessage.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetmessage.h\"\n#include <unistd.h>\n#include <config.h>\n\nint virNetMessageDecodeHeader(virNetMessagePtr msg)\n{\n    XDR xdr;\n    int ret = -1;\n\n    if (msg->bufferLength < VIR_NET_MESSAGE_LEN_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to decode header until len is received\"));\n        return -1;\n    }\n\n    msg->bufferOffset = VIR_NET_MESSAGE_LEN_MAX;\n\n    /* Parse the header. */\n    xdrmem_create(&xdr,\n                  msg->buffer + msg->bufferOffset,\n                  msg->bufferLength - msg->bufferOffset,\n                  XDR_DECODE);\n\n    if (!xdr_virNetMessageHeader(&xdr, &msg->header)) {\n        virReportError(VIR_ERR_RPC, \"%s\", _(\"Unable to decode message header\"));\n        goto cleanup;\n    }\n\n    msg->bufferOffset += xdr_getpos(&xdr);\n\n    ret = 0;\n\n cleanup:\n    xdr_destroy(&xdr);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetMessageDecodeLength",
          "args": [
            "client->rx"
          ],
          "line": 1204
        },
        "resolved": true,
        "details": {
          "function_name": "virNetMessageDecodeLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetmessage.c",
          "lines": "122-167",
          "snippet": "int virNetMessageDecodeLength(virNetMessagePtr msg)\n{\n    XDR xdr;\n    unsigned int len;\n    int ret = -1;\n\n    xdrmem_create(&xdr, msg->buffer,\n                  msg->bufferLength, XDR_DECODE);\n    if (!xdr_u_int(&xdr, &len)) {\n        virReportError(VIR_ERR_RPC, \"%s\", _(\"Unable to decode message length\"));\n        goto cleanup;\n    }\n    msg->bufferOffset = xdr_getpos(&xdr);\n\n    if (len < VIR_NET_MESSAGE_LEN_MAX) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"packet %d bytes received from server too small, want %d\"),\n                       len, VIR_NET_MESSAGE_LEN_MAX);\n        goto cleanup;\n    }\n\n    /* Length includes length word - adjust to real length to read. */\n    len -= VIR_NET_MESSAGE_LEN_MAX;\n\n    if (len > VIR_NET_MESSAGE_MAX) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"packet %d bytes received from server too large, want %d\"),\n                       len, VIR_NET_MESSAGE_MAX);\n        goto cleanup;\n    }\n\n    /* Extend our declared buffer length and carry\n       on reading the header + payload */\n    msg->bufferLength += len;\n    if (VIR_REALLOC_N(msg->buffer, msg->bufferLength) < 0)\n        goto cleanup;\n\n    VIR_DEBUG(\"Got length, now need %zu total (%u more)\",\n              msg->bufferLength, len);\n\n    ret = 0;\n\n cleanup:\n    xdr_destroy(&xdr);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetmessage.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetmessage.h\"\n#include <unistd.h>\n#include <config.h>\n\nint virNetMessageDecodeLength(virNetMessagePtr msg)\n{\n    XDR xdr;\n    unsigned int len;\n    int ret = -1;\n\n    xdrmem_create(&xdr, msg->buffer,\n                  msg->bufferLength, XDR_DECODE);\n    if (!xdr_u_int(&xdr, &len)) {\n        virReportError(VIR_ERR_RPC, \"%s\", _(\"Unable to decode message length\"));\n        goto cleanup;\n    }\n    msg->bufferOffset = xdr_getpos(&xdr);\n\n    if (len < VIR_NET_MESSAGE_LEN_MAX) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"packet %d bytes received from server too small, want %d\"),\n                       len, VIR_NET_MESSAGE_LEN_MAX);\n        goto cleanup;\n    }\n\n    /* Length includes length word - adjust to real length to read. */\n    len -= VIR_NET_MESSAGE_LEN_MAX;\n\n    if (len > VIR_NET_MESSAGE_MAX) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"packet %d bytes received from server too large, want %d\"),\n                       len, VIR_NET_MESSAGE_MAX);\n        goto cleanup;\n    }\n\n    /* Extend our declared buffer length and carry\n       on reading the header + payload */\n    msg->bufferLength += len;\n    if (VIR_REALLOC_N(msg->buffer, msg->bufferLength) < 0)\n        goto cleanup;\n\n    VIR_DEBUG(\"Got length, now need %zu total (%u more)\",\n              msg->bufferLength, len);\n\n    ret = 0;\n\n cleanup:\n    xdr_destroy(&xdr);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientRead",
          "args": [
            "client"
          ],
          "line": 1193
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "1156-1177",
          "snippet": "static ssize_t virNetServerClientRead(virNetServerClientPtr client)\n{\n    ssize_t ret;\n\n    if (client->rx->bufferLength <= client->rx->bufferOffset) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"unexpected zero/negative length request %lld\"),\n                       (long long int)(client->rx->bufferLength - client->rx->bufferOffset));\n        client->wantClose = true;\n        return -1;\n    }\n\n    ret = virNetSocketRead(client->sock,\n                           client->rx->buffer + client->rx->bufferOffset,\n                           client->rx->bufferLength - client->rx->bufferOffset);\n\n    if (ret <= 0)\n        return ret;\n\n    client->rx->bufferOffset += ret;\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic ssize_t virNetServerClientRead(virNetServerClientPtr client)\n{\n    ssize_t ret;\n\n    if (client->rx->bufferLength <= client->rx->bufferOffset) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"unexpected zero/negative length request %lld\"),\n                       (long long int)(client->rx->bufferLength - client->rx->bufferOffset));\n        client->wantClose = true;\n        return -1;\n    }\n\n    ret = virNetSocketRead(client->sock,\n                           client->rx->buffer + client->rx->bufferOffset,\n                           client->rx->bufferLength - client->rx->bufferOffset);\n\n    if (ret <= 0)\n        return ret;\n\n    client->rx->bufferOffset += ret;\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client)\n{\n readmore:\n    if (client->rx->nfds == 0) {\n        if (virNetServerClientRead(client) < 0) {\n            client->wantClose = true;\n            return NULL; /* Error */\n        }\n    }\n\n    if (client->rx->bufferOffset < client->rx->bufferLength)\n        return NULL; /* Still not read enough */\n\n    /* Either done with length word header */\n    if (client->rx->bufferLength == VIR_NET_MESSAGE_LEN_MAX) {\n        if (virNetMessageDecodeLength(client->rx) < 0) {\n            client->wantClose = true;\n            return NULL;\n        }\n\n        virNetServerClientUpdateEvent(client);\n\n        /* Try and read payload immediately instead of going back\n           into poll() because chances are the data is already\n           waiting for us */\n        goto readmore;\n    } else {\n        /* Grab the completed message */\n        virNetMessagePtr msg = client->rx;\n        virNetMessagePtr response = NULL;\n        virNetServerClientFilterPtr filter;\n        size_t i;\n\n        /* Decode the header so we can use it for routing decisions */\n        if (virNetMessageDecodeHeader(msg) < 0) {\n            virNetMessageQueueServe(&client->rx);\n            virNetMessageFree(msg);\n            client->wantClose = true;\n            return NULL;\n        }\n\n        /* Now figure out if we need to read more data to get some\n         * file descriptors */\n        if (msg->header.type == VIR_NET_CALL_WITH_FDS) {\n            if (virNetMessageDecodeNumFDs(msg) < 0) {\n                virNetMessageQueueServe(&client->rx);\n                virNetMessageFree(msg);\n                client->wantClose = true;\n                return NULL; /* Error */\n            }\n\n            /* Try getting the file descriptors (may fail if blocking) */\n            for (i = msg->donefds; i < msg->nfds; i++) {\n                int rv;\n                if ((rv = virNetSocketRecvFD(client->sock, &(msg->fds[i]))) < 0) {\n                    virNetMessageQueueServe(&client->rx);\n                    virNetMessageFree(msg);\n                    client->wantClose = true;\n                    return NULL;\n                }\n                if (rv == 0) /* Blocking */\n                    break;\n                msg->donefds++;\n            }\n\n            /* Need to poll() until FDs arrive */\n            if (msg->donefds < msg->nfds) {\n                /* Because DecodeHeader/NumFDs reset bufferOffset, we\n                 * put it back to what it was, so everything works\n                 * again next time we run this method\n                 */\n                client->rx->bufferOffset = client->rx->bufferLength;\n                return NULL;\n            }\n        }\n\n        /* Definitely finished reading, so remove from queue */\n        virNetMessageQueueServe(&client->rx);\n        PROBE(RPC_SERVER_CLIENT_MSG_RX,\n              \"client=%p len=%zu prog=%u vers=%u proc=%u type=%u status=%u serial=%u\",\n              client, msg->bufferLength,\n              msg->header.prog, msg->header.vers, msg->header.proc,\n              msg->header.type, msg->header.status, msg->header.serial);\n\n        if (virKeepAliveCheckMessage(client->keepalive, msg, &response)) {\n            virNetMessageFree(msg);\n            client->nrequests--;\n            msg = NULL;\n\n            if (response &&\n                virNetServerClientSendMessageLocked(client, response) < 0)\n                virNetMessageFree(response);\n        }\n\n        /* Maybe send off for queue against a filter */\n        if (msg) {\n            filter = client->filters;\n            while (filter) {\n                int ret = filter->func(client, msg, filter->opaque);\n                if (ret < 0) {\n                    virNetMessageFree(msg);\n                    msg = NULL;\n                    client->wantClose = true;\n                    break;\n                }\n                if (ret > 0) {\n                    msg = NULL;\n                    break;\n                }\n\n                filter = filter->next;\n            }\n        }\n\n        /* Possibly need to create another receive buffer */\n        if (client->nrequests < client->nrequests_max) {\n            if (!(client->rx = virNetMessageNew(true))) {\n                client->wantClose = true;\n            } else {\n                client->rx->bufferLength = VIR_NET_MESSAGE_LEN_MAX;\n                if (VIR_ALLOC_N(client->rx->buffer,\n                                client->rx->bufferLength) < 0) {\n                    client->wantClose = true;\n                } else {\n                    client->nrequests++;\n                }\n            }\n        }\n        virNetServerClientUpdateEvent(client);\n\n        return msg;\n    }\n}"
  },
  {
    "function_name": "virNetServerClientRead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1156-1177",
    "snippet": "static ssize_t virNetServerClientRead(virNetServerClientPtr client)\n{\n    ssize_t ret;\n\n    if (client->rx->bufferLength <= client->rx->bufferOffset) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"unexpected zero/negative length request %lld\"),\n                       (long long int)(client->rx->bufferLength - client->rx->bufferOffset));\n        client->wantClose = true;\n        return -1;\n    }\n\n    ret = virNetSocketRead(client->sock,\n                           client->rx->buffer + client->rx->bufferOffset,\n                           client->rx->bufferLength - client->rx->bufferOffset);\n\n    if (ret <= 0)\n        return ret;\n\n    client->rx->bufferOffset += ret;\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetSocketRead",
          "args": [
            "client->sock",
            "client->rx->buffer + client->rx->bufferOffset",
            "client->rx->bufferLength - client->rx->bufferOffset"
          ],
          "line": 1168
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1989-2001",
          "snippet": "ssize_t virNetSocketRead(virNetSocketPtr sock, char *buf, size_t len)\n{\n    ssize_t ret;\n    virObjectLock(sock);\n#if WITH_SASL\n    if (sock->saslSession)\n        ret = virNetSocketReadSASL(sock, buf, len);\n    else\n#endif\n        ret = virNetSocketReadWire(sock, buf, len);\n    virObjectUnlock(sock);\n    return ret;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nssize_t virNetSocketRead(virNetSocketPtr sock, char *buf, size_t len)\n{\n    ssize_t ret;\n    virObjectLock(sock);\n#if WITH_SASL\n    if (sock->saslSession)\n        ret = virNetSocketReadSASL(sock, buf, len);\n    else\n#endif\n        ret = virNetSocketReadWire(sock, buf, len);\n    virObjectUnlock(sock);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_RPC",
            "_(\"unexpected zero/negative length request %lld\")",
            "(long long int)(client->rx->bufferLength - client->rx->bufferOffset)"
          ],
          "line": 1161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unexpected zero/negative length request %lld\""
          ],
          "line": 1162
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic ssize_t virNetServerClientRead(virNetServerClientPtr client)\n{\n    ssize_t ret;\n\n    if (client->rx->bufferLength <= client->rx->bufferOffset) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"unexpected zero/negative length request %lld\"),\n                       (long long int)(client->rx->bufferLength - client->rx->bufferOffset));\n        client->wantClose = true;\n        return -1;\n    }\n\n    ret = virNetSocketRead(client->sock,\n                           client->rx->buffer + client->rx->bufferOffset,\n                           client->rx->bufferLength - client->rx->bufferOffset);\n\n    if (ret <= 0)\n        return ret;\n\n    client->rx->bufferOffset += ret;\n    return ret;\n}"
  },
  {
    "function_name": "virNetServerClientInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1098-1144",
    "snippet": "int virNetServerClientInit(virNetServerClientPtr client)\n{\n    virObjectLock(client);\n\n    if (!client->tlsCtxt) {\n        /* Plain socket, so prepare to read first message */\n        if (virNetServerClientRegisterEvent(client) < 0)\n            goto error;\n    } else {\n        int ret;\n\n        if (!(client->tls = virNetTLSSessionNew(client->tlsCtxt,\n                                                NULL)))\n            goto error;\n\n        virNetSocketSetTLSSession(client->sock,\n                                  client->tls);\n\n        /* Begin the TLS handshake. */\n        virObjectLock(client->tlsCtxt);\n        ret = virNetTLSSessionHandshake(client->tls);\n        virObjectUnlock(client->tlsCtxt);\n        if (ret == 0) {\n            /* Unlikely, but ...  Next step is to check the certificate. */\n            if (virNetServerClientCheckAccess(client) < 0)\n                goto error;\n\n            /* Handshake & cert check OK,  so prepare to read first message */\n            if (virNetServerClientRegisterEvent(client) < 0)\n                goto error;\n        } else if (ret > 0) {\n            /* Most likely, need to do more handshake data */\n            if (virNetServerClientRegisterEvent(client) < 0)\n                goto error;\n        } else {\n            goto error;\n        }\n    }\n\n    virObjectUnlock(client);\n    return 0;\n\n error:\n    client->wantClose = true;\n    virObjectUnlock(client);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 1142
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientRegisterEvent",
          "args": [
            "client"
          ],
          "line": 1130
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientRegisterEvent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "195-214",
          "snippet": "static int virNetServerClientRegisterEvent(virNetServerClientPtr client)\n{\n    int mode = virNetServerClientCalculateHandleMode(client);\n\n    if (!client->sock)\n        return -1;\n\n    virObjectRef(client);\n    VIR_DEBUG(\"Registering client event callback %d\", mode);\n    if (virNetSocketAddIOCallback(client->sock,\n                                  mode,\n                                  virNetServerClientDispatchEvent,\n                                  client,\n                                  virObjectFreeCallback) < 0) {\n        virObjectUnref(client);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic int virNetServerClientRegisterEvent(virNetServerClientPtr client)\n{\n    int mode = virNetServerClientCalculateHandleMode(client);\n\n    if (!client->sock)\n        return -1;\n\n    virObjectRef(client);\n    VIR_DEBUG(\"Registering client event callback %d\", mode);\n    if (virNetSocketAddIOCallback(client->sock,\n                                  mode,\n                                  virNetServerClientDispatchEvent,\n                                  client,\n                                  virObjectFreeCallback) < 0) {\n        virObjectUnref(client);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientCheckAccess",
          "args": [
            "client"
          ],
          "line": 1122
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientCheckAccess",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "292-324",
          "snippet": "static int\nvirNetServerClientCheckAccess(virNetServerClientPtr client)\n{\n    virNetMessagePtr confirm;\n\n    /* Verify client certificate. */\n    if (virNetTLSContextCheckCertificate(client->tlsCtxt, client->tls) < 0)\n        return -1;\n\n    if (client->tx) {\n        VIR_DEBUG(\"client had unexpected data pending tx after access check\");\n        return -1;\n    }\n\n    if (!(confirm = virNetMessageNew(false)))\n        return -1;\n\n    /* Checks have succeeded.  Write a '\\1' byte back to the client to\n     * indicate this (otherwise the socket is abruptly closed).\n     * (NB. The '\\1' byte is sent in an encrypted record).\n     */\n    confirm->bufferLength = 1;\n    if (VIR_ALLOC_N(confirm->buffer, confirm->bufferLength) < 0) {\n        virNetMessageFree(confirm);\n        return -1;\n    }\n    confirm->bufferOffset = 0;\n    confirm->buffer[0] = '\\1';\n\n    client->tx = confirm;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic int\nvirNetServerClientCheckAccess(virNetServerClientPtr client)\n{\n    virNetMessagePtr confirm;\n\n    /* Verify client certificate. */\n    if (virNetTLSContextCheckCertificate(client->tlsCtxt, client->tls) < 0)\n        return -1;\n\n    if (client->tx) {\n        VIR_DEBUG(\"client had unexpected data pending tx after access check\");\n        return -1;\n    }\n\n    if (!(confirm = virNetMessageNew(false)))\n        return -1;\n\n    /* Checks have succeeded.  Write a '\\1' byte back to the client to\n     * indicate this (otherwise the socket is abruptly closed).\n     * (NB. The '\\1' byte is sent in an encrypted record).\n     */\n    confirm->bufferLength = 1;\n    if (VIR_ALLOC_N(confirm->buffer, confirm->bufferLength) < 0) {\n        virNetMessageFree(confirm);\n        return -1;\n    }\n    confirm->bufferOffset = 0;\n    confirm->buffer[0] = '\\1';\n\n    client->tx = confirm;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetTLSSessionHandshake",
          "args": [
            "client->tls"
          ],
          "line": 1118
        },
        "resolved": true,
        "details": {
          "function_name": "virNetTLSSessionHandshake",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnettlscontext.c",
          "lines": "1338-1368",
          "snippet": "int virNetTLSSessionHandshake(virNetTLSSessionPtr sess)\n{\n    int ret;\n    VIR_DEBUG(\"sess=%p\", sess);\n    virObjectLock(sess);\n    ret = gnutls_handshake(sess->session);\n    VIR_DEBUG(\"Ret=%d\", ret);\n    if (ret == 0) {\n        sess->handshakeComplete = true;\n        VIR_DEBUG(\"Handshake is complete\");\n        goto cleanup;\n    }\n    if (ret == GNUTLS_E_INTERRUPTED || ret == GNUTLS_E_AGAIN) {\n        ret = 1;\n        goto cleanup;\n    }\n\n#if 0\n    PROBE(CLIENT_TLS_FAIL, \"fd=%d\",\n          virNetServerClientGetFD(client));\n#endif\n\n    virReportError(VIR_ERR_AUTH_FAILED,\n                   _(\"TLS handshake failed %s\"),\n                   gnutls_strerror(ret));\n    ret = -1;\n\n cleanup:\n    virObjectUnlock(sess);\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virthread.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virnettlscontext.h\"",
            "#include <gnutls/x509.h>",
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virthread.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virnettlscontext.h\"\n#include <gnutls/x509.h>\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <unistd.h>\n#include <config.h>\n\nint virNetTLSSessionHandshake(virNetTLSSessionPtr sess)\n{\n    int ret;\n    VIR_DEBUG(\"sess=%p\", sess);\n    virObjectLock(sess);\n    ret = gnutls_handshake(sess->session);\n    VIR_DEBUG(\"Ret=%d\", ret);\n    if (ret == 0) {\n        sess->handshakeComplete = true;\n        VIR_DEBUG(\"Handshake is complete\");\n        goto cleanup;\n    }\n    if (ret == GNUTLS_E_INTERRUPTED || ret == GNUTLS_E_AGAIN) {\n        ret = 1;\n        goto cleanup;\n    }\n\n#if 0\n    PROBE(CLIENT_TLS_FAIL, \"fd=%d\",\n          virNetServerClientGetFD(client));\n#endif\n\n    virReportError(VIR_ERR_AUTH_FAILED,\n                   _(\"TLS handshake failed %s\"),\n                   gnutls_strerror(ret));\n    ret = -1;\n\n cleanup:\n    virObjectUnlock(sess);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client->tlsCtxt"
          ],
          "line": 1117
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketSetTLSSession",
          "args": [
            "client->sock",
            "client->tls"
          ],
          "line": 1113
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketSetTLSSession",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1676-1687",
          "snippet": "void virNetSocketSetTLSSession(virNetSocketPtr sock,\n                               virNetTLSSessionPtr sess)\n{\n    virObjectLock(sock);\n    virObjectUnref(sock->tlsSession);\n    sock->tlsSession = virObjectRef(sess);\n    virNetTLSSessionSetIOCallbacks(sess,\n                                   virNetSocketTLSSessionWrite,\n                                   virNetSocketTLSSessionRead,\n                                   sock);\n    virObjectUnlock(sock);\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid virNetSocketSetTLSSession(virNetSocketPtr sock,\n                               virNetTLSSessionPtr sess)\n{\n    virObjectLock(sock);\n    virObjectUnref(sock->tlsSession);\n    sock->tlsSession = virObjectRef(sess);\n    virNetTLSSessionSetIOCallbacks(sess,\n                                   virNetSocketTLSSessionWrite,\n                                   virNetSocketTLSSessionRead,\n                                   sock);\n    virObjectUnlock(sock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetTLSSessionNew",
          "args": [
            "client->tlsCtxt",
            "NULL"
          ],
          "line": 1109
        },
        "resolved": true,
        "details": {
          "function_name": "virNetTLSSessionNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnettlscontext.c",
          "lines": "1188-1259",
          "snippet": "virNetTLSSessionPtr virNetTLSSessionNew(virNetTLSContextPtr ctxt,\n                                        const char *hostname)\n{\n    virNetTLSSessionPtr sess;\n    int err;\n    const char *priority;\n\n    VIR_DEBUG(\"ctxt=%p hostname=%s isServer=%d\",\n              ctxt, NULLSTR(hostname), ctxt->isServer);\n\n    if (!(sess = virObjectLockableNew(virNetTLSSessionClass)))\n        return NULL;\n\n    sess->hostname = g_strdup(hostname);\n\n    if ((err = gnutls_init(&sess->session,\n                           ctxt->isServer ? GNUTLS_SERVER : GNUTLS_CLIENT)) != 0) {\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Failed to initialize TLS session: %s\"),\n                       gnutls_strerror(err));\n        goto error;\n    }\n\n    /* avoid calling all the priority functions, since the defaults\n     * are adequate.\n     */\n    priority = ctxt->priority ? ctxt->priority : TLS_PRIORITY;\n    VIR_DEBUG(\"Setting priority string '%s'\", priority);\n    if ((err = gnutls_priority_set_direct(sess->session,\n                                          priority,\n                                          NULL)) != 0) {\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Failed to set TLS session priority to %s: %s\"),\n                       priority, gnutls_strerror(err));\n        goto error;\n    }\n\n    if ((err = gnutls_credentials_set(sess->session,\n                                      GNUTLS_CRD_CERTIFICATE,\n                                      ctxt->x509cred)) != 0) {\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Failed set TLS x509 credentials: %s\"),\n                       gnutls_strerror(err));\n        goto error;\n    }\n\n    /* request client certificate if any.\n     */\n    if (ctxt->isServer) {\n        gnutls_certificate_server_set_request(sess->session, GNUTLS_CERT_REQUEST);\n\n        gnutls_dh_set_prime_bits(sess->session, DH_BITS);\n    }\n\n    gnutls_transport_set_ptr(sess->session, sess);\n    gnutls_transport_set_push_function(sess->session,\n                                       virNetTLSSessionPush);\n    gnutls_transport_set_pull_function(sess->session,\n                                       virNetTLSSessionPull);\n\n    sess->isServer = ctxt->isServer;\n\n    PROBE(RPC_TLS_SESSION_NEW,\n          \"sess=%p ctxt=%p hostname=%s isServer=%d\",\n          sess, ctxt, hostname, sess->isServer);\n\n    return sess;\n\n error:\n    virObjectUnref(sess);\n    return NULL;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virthread.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virnettlscontext.h\"",
            "#include <gnutls/x509.h>",
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define DH_BITS 2048"
          ],
          "globals_used": [
            "static virClassPtr virNetTLSSessionClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virthread.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virnettlscontext.h\"\n#include <gnutls/x509.h>\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <unistd.h>\n#include <config.h>\n\n#define DH_BITS 2048\n\nstatic virClassPtr virNetTLSSessionClass;\n\nvirNetTLSSessionPtr virNetTLSSessionNew(virNetTLSContextPtr ctxt,\n                                        const char *hostname)\n{\n    virNetTLSSessionPtr sess;\n    int err;\n    const char *priority;\n\n    VIR_DEBUG(\"ctxt=%p hostname=%s isServer=%d\",\n              ctxt, NULLSTR(hostname), ctxt->isServer);\n\n    if (!(sess = virObjectLockableNew(virNetTLSSessionClass)))\n        return NULL;\n\n    sess->hostname = g_strdup(hostname);\n\n    if ((err = gnutls_init(&sess->session,\n                           ctxt->isServer ? GNUTLS_SERVER : GNUTLS_CLIENT)) != 0) {\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Failed to initialize TLS session: %s\"),\n                       gnutls_strerror(err));\n        goto error;\n    }\n\n    /* avoid calling all the priority functions, since the defaults\n     * are adequate.\n     */\n    priority = ctxt->priority ? ctxt->priority : TLS_PRIORITY;\n    VIR_DEBUG(\"Setting priority string '%s'\", priority);\n    if ((err = gnutls_priority_set_direct(sess->session,\n                                          priority,\n                                          NULL)) != 0) {\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Failed to set TLS session priority to %s: %s\"),\n                       priority, gnutls_strerror(err));\n        goto error;\n    }\n\n    if ((err = gnutls_credentials_set(sess->session,\n                                      GNUTLS_CRD_CERTIFICATE,\n                                      ctxt->x509cred)) != 0) {\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Failed set TLS x509 credentials: %s\"),\n                       gnutls_strerror(err));\n        goto error;\n    }\n\n    /* request client certificate if any.\n     */\n    if (ctxt->isServer) {\n        gnutls_certificate_server_set_request(sess->session, GNUTLS_CERT_REQUEST);\n\n        gnutls_dh_set_prime_bits(sess->session, DH_BITS);\n    }\n\n    gnutls_transport_set_ptr(sess->session, sess);\n    gnutls_transport_set_push_function(sess->session,\n                                       virNetTLSSessionPush);\n    gnutls_transport_set_pull_function(sess->session,\n                                       virNetTLSSessionPull);\n\n    sess->isServer = ctxt->isServer;\n\n    PROBE(RPC_TLS_SESSION_NEW,\n          \"sess=%p ctxt=%p hostname=%s isServer=%d\",\n          sess, ctxt, hostname, sess->isServer);\n\n    return sess;\n\n error:\n    virObjectUnref(sess);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nint virNetServerClientInit(virNetServerClientPtr client)\n{\n    virObjectLock(client);\n\n    if (!client->tlsCtxt) {\n        /* Plain socket, so prepare to read first message */\n        if (virNetServerClientRegisterEvent(client) < 0)\n            goto error;\n    } else {\n        int ret;\n\n        if (!(client->tls = virNetTLSSessionNew(client->tlsCtxt,\n                                                NULL)))\n            goto error;\n\n        virNetSocketSetTLSSession(client->sock,\n                                  client->tls);\n\n        /* Begin the TLS handshake. */\n        virObjectLock(client->tlsCtxt);\n        ret = virNetTLSSessionHandshake(client->tls);\n        virObjectUnlock(client->tlsCtxt);\n        if (ret == 0) {\n            /* Unlikely, but ...  Next step is to check the certificate. */\n            if (virNetServerClientCheckAccess(client) < 0)\n                goto error;\n\n            /* Handshake & cert check OK,  so prepare to read first message */\n            if (virNetServerClientRegisterEvent(client) < 0)\n                goto error;\n        } else if (ret > 0) {\n            /* Most likely, need to do more handshake data */\n            if (virNetServerClientRegisterEvent(client) < 0)\n                goto error;\n        } else {\n            goto error;\n        }\n    }\n\n    virObjectUnlock(client);\n    return 0;\n\n error:\n    client->wantClose = true;\n    virObjectUnlock(client);\n    return -1;\n}"
  },
  {
    "function_name": "virNetServerClientWantCloseLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1091-1095",
    "snippet": "bool\nvirNetServerClientWantCloseLocked(virNetServerClientPtr client)\n{\n    return client->wantClose;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nbool\nvirNetServerClientWantCloseLocked(virNetServerClientPtr client)\n{\n    return client->wantClose;\n}"
  },
  {
    "function_name": "virNetServerClientImmediateClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1083-1088",
    "snippet": "void virNetServerClientImmediateClose(virNetServerClientPtr client)\n{\n    virObjectLock(client);\n    client->wantClose = true;\n    virObjectUnlock(client);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 1087
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 1085
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvoid virNetServerClientImmediateClose(virNetServerClientPtr client)\n{\n    virObjectLock(client);\n    client->wantClose = true;\n    virObjectUnlock(client);\n}"
  },
  {
    "function_name": "virNetServerClientDelayedClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1076-1081",
    "snippet": "void virNetServerClientDelayedClose(virNetServerClientPtr client)\n{\n    virObjectLock(client);\n    client->delayedClose = true;\n    virObjectUnlock(client);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 1080
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 1078
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvoid virNetServerClientDelayedClose(virNetServerClientPtr client)\n{\n    virObjectLock(client);\n    client->delayedClose = true;\n    virObjectUnlock(client);\n}"
  },
  {
    "function_name": "virNetServerClientIsClosedLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1069-1073",
    "snippet": "bool\nvirNetServerClientIsClosedLocked(virNetServerClientPtr client)\n{\n    return client->sock == NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nbool\nvirNetServerClientIsClosedLocked(virNetServerClientPtr client)\n{\n    return client->sock == NULL;\n}"
  },
  {
    "function_name": "virNetServerClientClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1060-1066",
    "snippet": "void\nvirNetServerClientClose(virNetServerClientPtr client)\n{\n    virObjectLock(client);\n    virNetServerClientCloseLocked(client);\n    virObjectUnlock(client);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 1065
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientCloseLocked",
          "args": [
            "client"
          ],
          "line": 1064
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientCloseLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "1000-1057",
          "snippet": "void\nvirNetServerClientCloseLocked(virNetServerClientPtr client)\n{\n    virNetServerClientCloseFunc cf;\n    virKeepAlivePtr ka;\n\n    VIR_DEBUG(\"client=%p\", client);\n    if (!client->sock)\n        return;\n\n    if (client->keepalive) {\n        virKeepAliveStop(client->keepalive);\n        ka = client->keepalive;\n        client->keepalive = NULL;\n        virObjectRef(client);\n        virObjectUnlock(client);\n        virObjectUnref(ka);\n        virObjectLock(client);\n        virObjectUnref(client);\n    }\n\n    if (client->privateDataCloseFunc) {\n        cf = client->privateDataCloseFunc;\n        virObjectRef(client);\n        virObjectUnlock(client);\n        (cf)(client);\n        virObjectLock(client);\n        virObjectUnref(client);\n    }\n\n    /* Do now, even though we don't close the socket\n     * until end, to ensure we don't get invoked\n     * again due to tls shutdown */\n    if (client->sock)\n        virNetSocketRemoveIOCallback(client->sock);\n\n    if (client->tls) {\n        virObjectUnref(client->tls);\n        client->tls = NULL;\n    }\n    client->wantClose = true;\n\n    while (client->rx) {\n        virNetMessagePtr msg\n            = virNetMessageQueueServe(&client->rx);\n        virNetMessageFree(msg);\n    }\n    while (client->tx) {\n        virNetMessagePtr msg\n            = virNetMessageQueueServe(&client->tx);\n        virNetMessageFree(msg);\n    }\n\n    if (client->sock) {\n        virObjectUnref(client->sock);\n        client->sock = NULL;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);",
            "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nvoid\nvirNetServerClientCloseLocked(virNetServerClientPtr client)\n{\n    virNetServerClientCloseFunc cf;\n    virKeepAlivePtr ka;\n\n    VIR_DEBUG(\"client=%p\", client);\n    if (!client->sock)\n        return;\n\n    if (client->keepalive) {\n        virKeepAliveStop(client->keepalive);\n        ka = client->keepalive;\n        client->keepalive = NULL;\n        virObjectRef(client);\n        virObjectUnlock(client);\n        virObjectUnref(ka);\n        virObjectLock(client);\n        virObjectUnref(client);\n    }\n\n    if (client->privateDataCloseFunc) {\n        cf = client->privateDataCloseFunc;\n        virObjectRef(client);\n        virObjectUnlock(client);\n        (cf)(client);\n        virObjectLock(client);\n        virObjectUnref(client);\n    }\n\n    /* Do now, even though we don't close the socket\n     * until end, to ensure we don't get invoked\n     * again due to tls shutdown */\n    if (client->sock)\n        virNetSocketRemoveIOCallback(client->sock);\n\n    if (client->tls) {\n        virObjectUnref(client->tls);\n        client->tls = NULL;\n    }\n    client->wantClose = true;\n\n    while (client->rx) {\n        virNetMessagePtr msg\n            = virNetMessageQueueServe(&client->rx);\n        virNetMessageFree(msg);\n    }\n    while (client->tx) {\n        virNetMessagePtr msg\n            = virNetMessageQueueServe(&client->tx);\n        virNetMessageFree(msg);\n    }\n\n    if (client->sock) {\n        virObjectUnref(client->sock);\n        client->sock = NULL;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 1063
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvoid\nvirNetServerClientClose(virNetServerClientPtr client)\n{\n    virObjectLock(client);\n    virNetServerClientCloseLocked(client);\n    virObjectUnlock(client);\n}"
  },
  {
    "function_name": "virNetServerClientCloseLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "1000-1057",
    "snippet": "void\nvirNetServerClientCloseLocked(virNetServerClientPtr client)\n{\n    virNetServerClientCloseFunc cf;\n    virKeepAlivePtr ka;\n\n    VIR_DEBUG(\"client=%p\", client);\n    if (!client->sock)\n        return;\n\n    if (client->keepalive) {\n        virKeepAliveStop(client->keepalive);\n        ka = client->keepalive;\n        client->keepalive = NULL;\n        virObjectRef(client);\n        virObjectUnlock(client);\n        virObjectUnref(ka);\n        virObjectLock(client);\n        virObjectUnref(client);\n    }\n\n    if (client->privateDataCloseFunc) {\n        cf = client->privateDataCloseFunc;\n        virObjectRef(client);\n        virObjectUnlock(client);\n        (cf)(client);\n        virObjectLock(client);\n        virObjectUnref(client);\n    }\n\n    /* Do now, even though we don't close the socket\n     * until end, to ensure we don't get invoked\n     * again due to tls shutdown */\n    if (client->sock)\n        virNetSocketRemoveIOCallback(client->sock);\n\n    if (client->tls) {\n        virObjectUnref(client->tls);\n        client->tls = NULL;\n    }\n    client->wantClose = true;\n\n    while (client->rx) {\n        virNetMessagePtr msg\n            = virNetMessageQueueServe(&client->rx);\n        virNetMessageFree(msg);\n    }\n    while (client->tx) {\n        virNetMessagePtr msg\n            = virNetMessageQueueServe(&client->tx);\n        virNetMessageFree(msg);\n    }\n\n    if (client->sock) {\n        virObjectUnref(client->sock);\n        client->sock = NULL;\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);",
      "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "client->sock"
          ],
          "line": 1054
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetMessageFree",
          "args": [
            "msg"
          ],
          "line": 1050
        },
        "resolved": true,
        "details": {
          "function_name": "virNetMessageFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetmessage.c",
          "lines": "81-93",
          "snippet": "void virNetMessageFree(virNetMessagePtr msg)\n{\n    if (!msg)\n        return;\n\n    VIR_DEBUG(\"msg=%p nfds=%zu cb=%p\", msg, msg->nfds, msg->cb);\n\n    if (msg->cb)\n        msg->cb(msg, msg->opaque);\n\n    virNetMessageClearPayload(msg);\n    VIR_FREE(msg);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetmessage.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetmessage.h\"\n#include <unistd.h>\n#include <config.h>\n\nvoid virNetMessageFree(virNetMessagePtr msg)\n{\n    if (!msg)\n        return;\n\n    VIR_DEBUG(\"msg=%p nfds=%zu cb=%p\", msg, msg->nfds, msg->cb);\n\n    if (msg->cb)\n        msg->cb(msg, msg->opaque);\n\n    virNetMessageClearPayload(msg);\n    VIR_FREE(msg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetMessageQueueServe",
          "args": [
            "&client->tx"
          ],
          "line": 1049
        },
        "resolved": true,
        "details": {
          "function_name": "virNetMessageQueueServe",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetmessage.c",
          "lines": "109-119",
          "snippet": "virNetMessagePtr virNetMessageQueueServe(virNetMessagePtr *queue)\n{\n    virNetMessagePtr tmp = *queue;\n\n    if (tmp) {\n        *queue = tmp->next;\n        tmp->next = NULL;\n    }\n\n    return tmp;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetmessage.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetmessage.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirNetMessagePtr virNetMessageQueueServe(virNetMessagePtr *queue)\n{\n    virNetMessagePtr tmp = *queue;\n\n    if (tmp) {\n        *queue = tmp->next;\n        tmp->next = NULL;\n    }\n\n    return tmp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketRemoveIOCallback",
          "args": [
            "client->sock"
          ],
          "line": 1034
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketRemoveIOCallback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "2237-2252",
          "snippet": "void virNetSocketRemoveIOCallback(virNetSocketPtr sock)\n{\n    virObjectLock(sock);\n\n    if (sock->watch < 0) {\n        VIR_DEBUG(\"Watch not registered on socket %p\", sock);\n        virObjectUnlock(sock);\n        return;\n    }\n\n    virEventRemoveHandle(sock->watch);\n    /* Don't unref @sock, it's done via eventloop callback. */\n    sock->watch = -1;\n\n    virObjectUnlock(sock);\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid virNetSocketRemoveIOCallback(virNetSocketPtr sock)\n{\n    virObjectLock(sock);\n\n    if (sock->watch < 0) {\n        VIR_DEBUG(\"Watch not registered on socket %p\", sock);\n        virObjectUnlock(sock);\n        return;\n    }\n\n    virEventRemoveHandle(sock->watch);\n    /* Don't unref @sock, it's done via eventloop callback. */\n    sock->watch = -1;\n\n    virObjectUnlock(sock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 1026
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "client"
          ],
          "line": 1025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 1024
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "client"
          ],
          "line": 1023
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virKeepAliveStop",
          "args": [
            "client->keepalive"
          ],
          "line": 1011
        },
        "resolved": true,
        "details": {
          "function_name": "virKeepAliveStop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virkeepalive.c",
          "lines": "295-310",
          "snippet": "void\nvirKeepAliveStop(virKeepAlivePtr ka)\n{\n    virObjectLock(ka);\n\n    PROBE(RPC_KEEPALIVE_STOP,\n          \"ka=%p client=%p\",\n          ka, ka->client);\n\n    if (ka->timer > 0) {\n        virEventRemoveTimeout(ka->timer);\n        ka->timer = -1;\n    }\n\n    virObjectUnlock(ka);\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virkeepaliveprotocol.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virkeepaliveprotocol.h\"\n#include \"virnetsocket.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirKeepAliveStop(virKeepAlivePtr ka)\n{\n    virObjectLock(ka);\n\n    PROBE(RPC_KEEPALIVE_STOP,\n          \"ka=%p client=%p\",\n          ka, ka->client);\n\n    if (ka->timer > 0) {\n        virEventRemoveTimeout(ka->timer);\n        ka->timer = -1;\n    }\n\n    virObjectUnlock(ka);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"client=%p\"",
            "client"
          ],
          "line": 1006
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nvoid\nvirNetServerClientCloseLocked(virNetServerClientPtr client)\n{\n    virNetServerClientCloseFunc cf;\n    virKeepAlivePtr ka;\n\n    VIR_DEBUG(\"client=%p\", client);\n    if (!client->sock)\n        return;\n\n    if (client->keepalive) {\n        virKeepAliveStop(client->keepalive);\n        ka = client->keepalive;\n        client->keepalive = NULL;\n        virObjectRef(client);\n        virObjectUnlock(client);\n        virObjectUnref(ka);\n        virObjectLock(client);\n        virObjectUnref(client);\n    }\n\n    if (client->privateDataCloseFunc) {\n        cf = client->privateDataCloseFunc;\n        virObjectRef(client);\n        virObjectUnlock(client);\n        (cf)(client);\n        virObjectLock(client);\n        virObjectUnref(client);\n    }\n\n    /* Do now, even though we don't close the socket\n     * until end, to ensure we don't get invoked\n     * again due to tls shutdown */\n    if (client->sock)\n        virNetSocketRemoveIOCallback(client->sock);\n\n    if (client->tls) {\n        virObjectUnref(client->tls);\n        client->tls = NULL;\n    }\n    client->wantClose = true;\n\n    while (client->rx) {\n        virNetMessagePtr msg\n            = virNetMessageQueueServe(&client->rx);\n        virNetMessageFree(msg);\n    }\n    while (client->tx) {\n        virNetMessagePtr msg\n            = virNetMessageQueueServe(&client->tx);\n        virNetMessageFree(msg);\n    }\n\n    if (client->sock) {\n        virObjectUnref(client->sock);\n        client->sock = NULL;\n    }\n}"
  },
  {
    "function_name": "virNetServerClientDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "969-989",
    "snippet": "void virNetServerClientDispose(void *obj)\n{\n    virNetServerClientPtr client = obj;\n\n    PROBE(RPC_SERVER_CLIENT_DISPOSE,\n          \"client=%p\", client);\n\n    if (client->privateData)\n        client->privateDataFreeFunc(client->privateData);\n\n    g_clear_object(&client->identity);\n\n#if WITH_SASL\n    virObjectUnref(client->sasl);\n#endif\n    if (client->sockTimer > 0)\n        virEventRemoveTimeout(client->sockTimer);\n    virObjectUnref(client->tls);\n    virObjectUnref(client->tlsCtxt);\n    virObjectUnref(client->sock);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientDispose(void *obj);",
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "client->sock"
          ],
          "line": 988
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virEventRemoveTimeout",
          "args": [
            "client->sockTimer"
          ],
          "line": 985
        },
        "resolved": true,
        "details": {
          "function_name": "virEventRemoveTimeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virevent.c",
          "lines": "188-195",
          "snippet": "int\nvirEventRemoveTimeout(int timer)\n{\n    if (!removeTimeoutImpl)\n        return -1;\n\n    return removeTimeoutImpl(timer);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vireventglib.h\"",
            "#include \"virevent.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virEventRemoveTimeoutFunc removeTimeoutImpl;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vireventglib.h\"\n#include \"virevent.h\"\n#include <config.h>\n\nstatic virEventRemoveTimeoutFunc removeTimeoutImpl;\n\nint\nvirEventRemoveTimeout(int timer)\n{\n    if (!removeTimeoutImpl)\n        return -1;\n\n    return removeTimeoutImpl(timer);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_clear_object",
          "args": [
            "&client->identity"
          ],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "client->privateDataFreeFunc",
          "args": [
            "client->privateData"
          ],
          "line": 977
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PROBE",
          "args": [
            "RPC_SERVER_CLIENT_DISPOSE",
            "\"client=%p\"",
            "client"
          ],
          "line": 973
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientDispose(void *obj);\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvoid virNetServerClientDispose(void *obj)\n{\n    virNetServerClientPtr client = obj;\n\n    PROBE(RPC_SERVER_CLIENT_DISPOSE,\n          \"client=%p\", client);\n\n    if (client->privateData)\n        client->privateDataFreeFunc(client->privateData);\n\n    g_clear_object(&client->identity);\n\n#if WITH_SASL\n    virObjectUnref(client->sasl);\n#endif\n    if (client->sockTimer > 0)\n        virEventRemoveTimeout(client->sockTimer);\n    virObjectUnref(client->tls);\n    virObjectUnref(client->tlsCtxt);\n    virObjectUnref(client->sock);\n}"
  },
  {
    "function_name": "virNetServerClientRemoteAddrStringURI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "962-967",
    "snippet": "const char *virNetServerClientRemoteAddrStringURI(virNetServerClientPtr client)\n{\n    if (!client->sock)\n        return NULL;\n    return virNetSocketRemoteAddrStringURI(client->sock);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetSocketRemoteAddrStringURI",
          "args": [
            "client->sock"
          ],
          "line": 966
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketRemoteAddrStringURI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1653-1656",
          "snippet": "const char *virNetSocketRemoteAddrStringURI(virNetSocketPtr sock)\n{\n    return sock->remoteAddrStrURI;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nconst char *virNetSocketRemoteAddrStringURI(virNetSocketPtr sock)\n{\n    return sock->remoteAddrStrURI;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nconst char *virNetServerClientRemoteAddrStringURI(virNetServerClientPtr client)\n{\n    if (!client->sock)\n        return NULL;\n    return virNetSocketRemoteAddrStringURI(client->sock);\n}"
  },
  {
    "function_name": "virNetServerClientRemoteAddrStringSASL",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "955-960",
    "snippet": "const char *virNetServerClientRemoteAddrStringSASL(virNetServerClientPtr client)\n{\n    if (!client->sock)\n        return NULL;\n    return virNetSocketRemoteAddrStringSASL(client->sock);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetSocketRemoteAddrStringSASL",
          "args": [
            "client->sock"
          ],
          "line": 959
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketRemoteAddrStringSASL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1648-1651",
          "snippet": "const char *virNetSocketRemoteAddrStringSASL(virNetSocketPtr sock)\n{\n    return sock->remoteAddrStrSASL;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nconst char *virNetSocketRemoteAddrStringSASL(virNetSocketPtr sock)\n{\n    return sock->remoteAddrStrSASL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nconst char *virNetServerClientRemoteAddrStringSASL(virNetServerClientPtr client)\n{\n    if (!client->sock)\n        return NULL;\n    return virNetSocketRemoteAddrStringSASL(client->sock);\n}"
  },
  {
    "function_name": "virNetServerClientLocalAddrStringSASL",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "947-952",
    "snippet": "const char *virNetServerClientLocalAddrStringSASL(virNetServerClientPtr client)\n{\n    if (!client->sock)\n        return NULL;\n    return virNetSocketLocalAddrStringSASL(client->sock);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetSocketLocalAddrStringSASL",
          "args": [
            "client->sock"
          ],
          "line": 951
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketLocalAddrStringSASL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1643-1646",
          "snippet": "const char *virNetSocketLocalAddrStringSASL(virNetSocketPtr sock)\n{\n    return sock->localAddrStrSASL;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nconst char *virNetSocketLocalAddrStringSASL(virNetSocketPtr sock)\n{\n    return sock->localAddrStrSASL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nconst char *virNetServerClientLocalAddrStringSASL(virNetServerClientPtr client)\n{\n    if (!client->sock)\n        return NULL;\n    return virNetSocketLocalAddrStringSASL(client->sock);\n}"
  },
  {
    "function_name": "virNetServerClientSetDispatcher",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "931-944",
    "snippet": "void virNetServerClientSetDispatcher(virNetServerClientPtr client,\n                                     virNetServerClientDispatchFunc func,\n                                     void *opaque)\n{\n    virObjectLock(client);\n    /* Only set dispatcher if not already set, to avoid race\n     * with dispatch code that runs without locks held\n     */\n    if (!client->dispatchFunc) {\n        client->dispatchFunc = func;\n        client->dispatchOpaque = opaque;\n    }\n    virObjectUnlock(client);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);",
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 943
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvoid virNetServerClientSetDispatcher(virNetServerClientPtr client,\n                                     virNetServerClientDispatchFunc func,\n                                     void *opaque)\n{\n    virObjectLock(client);\n    /* Only set dispatcher if not already set, to avoid race\n     * with dispatch code that runs without locks held\n     */\n    if (!client->dispatchFunc) {\n        client->dispatchFunc = func;\n        client->dispatchOpaque = opaque;\n    }\n    virObjectUnlock(client);\n}"
  },
  {
    "function_name": "virNetServerClientSetCloseHook",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "922-928",
    "snippet": "void virNetServerClientSetCloseHook(virNetServerClientPtr client,\n                                    virNetServerClientCloseFunc cf)\n{\n    virObjectLock(client);\n    client->privateDataCloseFunc = cf;\n    virObjectUnlock(client);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 927
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 925
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvoid virNetServerClientSetCloseHook(virNetServerClientPtr client,\n                                    virNetServerClientCloseFunc cf)\n{\n    virObjectLock(client);\n    client->privateDataCloseFunc = cf;\n    virObjectUnlock(client);\n}"
  },
  {
    "function_name": "virNetServerClientGetPrivateData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "912-919",
    "snippet": "void *virNetServerClientGetPrivateData(virNetServerClientPtr client)\n{\n    void *data;\n    virObjectLock(client);\n    data = client->privateData;\n    virObjectUnlock(client);\n    return data;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 917
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 915
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvoid *virNetServerClientGetPrivateData(virNetServerClientPtr client)\n{\n    void *data;\n    virObjectLock(client);\n    data = client->privateData;\n    virObjectUnlock(client);\n    return data;\n}"
  },
  {
    "function_name": "virNetServerClientHasSASLSession",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "901-908",
    "snippet": "bool virNetServerClientHasSASLSession(virNetServerClientPtr client)\n{\n    bool has = false;\n    virObjectLock(client);\n    has = !!client->sasl;\n    virObjectUnlock(client);\n    return has;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 906
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 904
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nbool virNetServerClientHasSASLSession(virNetServerClientPtr client)\n{\n    bool has = false;\n    virObjectLock(client);\n    has = !!client->sasl;\n    virObjectUnlock(client);\n    return has;\n}"
  },
  {
    "function_name": "virNetServerClientGetSASLSession",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "892-899",
    "snippet": "virNetSASLSessionPtr virNetServerClientGetSASLSession(virNetServerClientPtr client)\n{\n    virNetSASLSessionPtr sasl;\n    virObjectLock(client);\n    sasl = client->sasl;\n    virObjectUnlock(client);\n    return sasl;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 897
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 895
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvirNetSASLSessionPtr virNetServerClientGetSASLSession(virNetServerClientPtr client)\n{\n    virNetSASLSessionPtr sasl;\n    virObjectLock(client);\n    sasl = client->sasl;\n    virObjectUnlock(client);\n    return sasl;\n}"
  },
  {
    "function_name": "virNetServerClientSetSASLSession",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "878-889",
    "snippet": "void virNetServerClientSetSASLSession(virNetServerClientPtr client,\n                                      virNetSASLSessionPtr sasl)\n{\n    /* We don't set the sasl session on the socket here\n     * because we need to send out the auth confirmation\n     * in the clear. Only once we complete the next 'tx'\n     * operation do we switch to SASL mode\n     */\n    virObjectLock(client);\n    client->sasl = virObjectRef(sasl);\n    virObjectUnlock(client);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 888
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "sasl"
          ],
          "line": 887
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 886
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvoid virNetServerClientSetSASLSession(virNetServerClientPtr client,\n                                      virNetSASLSessionPtr sasl)\n{\n    /* We don't set the sasl session on the socket here\n     * because we need to send out the auth confirmation\n     * in the clear. Only once we complete the next 'tx'\n     * operation do we switch to SASL mode\n     */\n    virObjectLock(client);\n    client->sasl = virObjectRef(sasl);\n    virObjectUnlock(client);\n}"
  },
  {
    "function_name": "virNetServerClientIsSecure",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "860-874",
    "snippet": "bool virNetServerClientIsSecure(virNetServerClientPtr client)\n{\n    bool secure = false;\n    virObjectLock(client);\n    if (client->tls)\n        secure = true;\n#if WITH_SASL\n    if (client->sasl)\n        secure = true;\n#endif\n    if (client->sock && virNetSocketIsLocal(client->sock))\n        secure = true;\n    virObjectUnlock(client);\n    return secure;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 872
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketIsLocal",
          "args": [
            "client->sock"
          ],
          "line": 870
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketIsLocal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1415-1423",
          "snippet": "bool virNetSocketIsLocal(virNetSocketPtr sock)\n{\n    bool isLocal = false;\n    virObjectLock(sock);\n    if (sock->localAddr.data.sa.sa_family == AF_UNIX)\n        isLocal = true;\n    virObjectUnlock(sock);\n    return isLocal;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nbool virNetSocketIsLocal(virNetSocketPtr sock)\n{\n    bool isLocal = false;\n    virObjectLock(sock);\n    if (sock->localAddr.data.sa.sa_family == AF_UNIX)\n        isLocal = true;\n    virObjectUnlock(sock);\n    return isLocal;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 863
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nbool virNetServerClientIsSecure(virNetServerClientPtr client)\n{\n    bool secure = false;\n    virObjectLock(client);\n    if (client->tls)\n        secure = true;\n#if WITH_SASL\n    if (client->sasl)\n        secure = true;\n#endif\n    if (client->sock && virNetSocketIsLocal(client->sock))\n        secure = true;\n    virObjectUnlock(client);\n    return secure;\n}"
  },
  {
    "function_name": "virNetServerClientGetSELinuxContext",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "847-857",
    "snippet": "int virNetServerClientGetSELinuxContext(virNetServerClientPtr client,\n                                        char **context)\n{\n    int ret = 0;\n    *context = NULL;\n    virObjectLock(client);\n    if (client->sock)\n        ret = virNetSocketGetSELinuxContext(client->sock, context);\n    virObjectUnlock(client);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 855
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketGetSELinuxContext",
          "args": [
            "client->sock",
            "context"
          ],
          "line": 854
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketGetSELinuxContext",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1623-1628",
          "snippet": "int virNetSocketGetSELinuxContext(virNetSocketPtr sock G_GNUC_UNUSED,\n                                  char **context)\n{\n    *context = NULL;\n    return 0;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nint virNetSocketGetSELinuxContext(virNetSocketPtr sock G_GNUC_UNUSED,\n                                  char **context)\n{\n    *context = NULL;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 852
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nint virNetServerClientGetSELinuxContext(virNetServerClientPtr client,\n                                        char **context)\n{\n    int ret = 0;\n    *context = NULL;\n    virObjectLock(client);\n    if (client->sock)\n        ret = virNetSocketGetSELinuxContext(client->sock, context);\n    virObjectUnlock(client);\n    return ret;\n}"
  },
  {
    "function_name": "virNetServerClientSetIdentity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "835-844",
    "snippet": "void virNetServerClientSetIdentity(virNetServerClientPtr client,\n                                   virIdentityPtr identity)\n{\n    virObjectLock(client);\n    g_clear_object(&client->identity);\n    client->identity = identity;\n    if (client->identity)\n        g_object_ref(client->identity);\n    virObjectUnlock(client);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 843
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_object_ref",
          "args": [
            "client->identity"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_clear_object",
          "args": [
            "&client->identity"
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 838
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvoid virNetServerClientSetIdentity(virNetServerClientPtr client,\n                                   virIdentityPtr identity)\n{\n    virObjectLock(client);\n    g_clear_object(&client->identity);\n    client->identity = identity;\n    if (client->identity)\n        g_object_ref(client->identity);\n    virObjectUnlock(client);\n}"
  },
  {
    "function_name": "virNetServerClientGetIdentity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "822-832",
    "snippet": "virIdentityPtr virNetServerClientGetIdentity(virNetServerClientPtr client)\n{\n    virIdentityPtr ret = NULL;\n    virObjectLock(client);\n    if (!client->identity)\n        client->identity = virNetServerClientCreateIdentity(client);\n    if (client->identity)\n        ret = g_object_ref(client->identity);\n    virObjectUnlock(client);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 830
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_object_ref",
          "args": [
            "client->identity"
          ],
          "line": 829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetServerClientCreateIdentity",
          "args": [
            "client"
          ],
          "line": 827
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientCreateIdentity",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "756-819",
          "snippet": "static virIdentityPtr\nvirNetServerClientCreateIdentity(virNetServerClientPtr client)\n{\n    g_autofree char *username = NULL;\n    g_autofree char *groupname = NULL;\n    g_autofree char *seccontext = NULL;\n    g_autoptr(virIdentity) ret = NULL;\n\n    if (!(ret = virIdentityNew()))\n        return NULL;\n\n    if (client->sock && virNetSocketIsLocal(client->sock)) {\n        gid_t gid;\n        uid_t uid;\n        pid_t pid;\n        unsigned long long timestamp;\n        if (virNetSocketGetUNIXIdentity(client->sock,\n                                        &uid, &gid, &pid,\n                                        &timestamp) < 0)\n            return NULL;\n\n        if (!(username = virGetUserName(uid)))\n            return NULL;\n        if (virIdentitySetUserName(ret, username) < 0)\n            return NULL;\n        if (virIdentitySetUNIXUserID(ret, uid) < 0)\n            return NULL;\n\n        if (!(groupname = virGetGroupName(gid)))\n            return NULL;\n        if (virIdentitySetGroupName(ret, groupname) < 0)\n            return NULL;\n        if (virIdentitySetUNIXGroupID(ret, gid) < 0)\n            return NULL;\n\n        if (virIdentitySetProcessID(ret, pid) < 0)\n            return NULL;\n        if (virIdentitySetProcessTime(ret, timestamp) < 0)\n            return NULL;\n    }\n\n#if WITH_SASL\n    if (client->sasl) {\n        const char *identity = virNetSASLSessionGetIdentity(client->sasl);\n        if (virIdentitySetSASLUserName(ret, identity) < 0)\n            return NULL;\n    }\n#endif\n\n    if (client->tls) {\n        const char *identity = virNetTLSSessionGetX509DName(client->tls);\n        if (virIdentitySetX509DName(ret, identity) < 0)\n            return NULL;\n    }\n\n    if (client->sock &&\n        virNetSocketGetSELinuxContext(client->sock, &seccontext) < 0)\n        return NULL;\n    if (seccontext &&\n        virIdentitySetSELinuxContext(ret, seccontext) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic virIdentityPtr\nvirNetServerClientCreateIdentity(virNetServerClientPtr client)\n{\n    g_autofree char *username = NULL;\n    g_autofree char *groupname = NULL;\n    g_autofree char *seccontext = NULL;\n    g_autoptr(virIdentity) ret = NULL;\n\n    if (!(ret = virIdentityNew()))\n        return NULL;\n\n    if (client->sock && virNetSocketIsLocal(client->sock)) {\n        gid_t gid;\n        uid_t uid;\n        pid_t pid;\n        unsigned long long timestamp;\n        if (virNetSocketGetUNIXIdentity(client->sock,\n                                        &uid, &gid, &pid,\n                                        &timestamp) < 0)\n            return NULL;\n\n        if (!(username = virGetUserName(uid)))\n            return NULL;\n        if (virIdentitySetUserName(ret, username) < 0)\n            return NULL;\n        if (virIdentitySetUNIXUserID(ret, uid) < 0)\n            return NULL;\n\n        if (!(groupname = virGetGroupName(gid)))\n            return NULL;\n        if (virIdentitySetGroupName(ret, groupname) < 0)\n            return NULL;\n        if (virIdentitySetUNIXGroupID(ret, gid) < 0)\n            return NULL;\n\n        if (virIdentitySetProcessID(ret, pid) < 0)\n            return NULL;\n        if (virIdentitySetProcessTime(ret, timestamp) < 0)\n            return NULL;\n    }\n\n#if WITH_SASL\n    if (client->sasl) {\n        const char *identity = virNetSASLSessionGetIdentity(client->sasl);\n        if (virIdentitySetSASLUserName(ret, identity) < 0)\n            return NULL;\n    }\n#endif\n\n    if (client->tls) {\n        const char *identity = virNetTLSSessionGetX509DName(client->tls);\n        if (virIdentitySetX509DName(ret, identity) < 0)\n            return NULL;\n    }\n\n    if (client->sock &&\n        virNetSocketGetSELinuxContext(client->sock, &seccontext) < 0)\n        return NULL;\n    if (seccontext &&\n        virIdentitySetSELinuxContext(ret, seccontext) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 825
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvirIdentityPtr virNetServerClientGetIdentity(virNetServerClientPtr client)\n{\n    virIdentityPtr ret = NULL;\n    virObjectLock(client);\n    if (!client->identity)\n        client->identity = virNetServerClientCreateIdentity(client);\n    if (client->identity)\n        ret = g_object_ref(client->identity);\n    virObjectUnlock(client);\n    return ret;\n}"
  },
  {
    "function_name": "virNetServerClientCreateIdentity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "756-819",
    "snippet": "static virIdentityPtr\nvirNetServerClientCreateIdentity(virNetServerClientPtr client)\n{\n    g_autofree char *username = NULL;\n    g_autofree char *groupname = NULL;\n    g_autofree char *seccontext = NULL;\n    g_autoptr(virIdentity) ret = NULL;\n\n    if (!(ret = virIdentityNew()))\n        return NULL;\n\n    if (client->sock && virNetSocketIsLocal(client->sock)) {\n        gid_t gid;\n        uid_t uid;\n        pid_t pid;\n        unsigned long long timestamp;\n        if (virNetSocketGetUNIXIdentity(client->sock,\n                                        &uid, &gid, &pid,\n                                        &timestamp) < 0)\n            return NULL;\n\n        if (!(username = virGetUserName(uid)))\n            return NULL;\n        if (virIdentitySetUserName(ret, username) < 0)\n            return NULL;\n        if (virIdentitySetUNIXUserID(ret, uid) < 0)\n            return NULL;\n\n        if (!(groupname = virGetGroupName(gid)))\n            return NULL;\n        if (virIdentitySetGroupName(ret, groupname) < 0)\n            return NULL;\n        if (virIdentitySetUNIXGroupID(ret, gid) < 0)\n            return NULL;\n\n        if (virIdentitySetProcessID(ret, pid) < 0)\n            return NULL;\n        if (virIdentitySetProcessTime(ret, timestamp) < 0)\n            return NULL;\n    }\n\n#if WITH_SASL\n    if (client->sasl) {\n        const char *identity = virNetSASLSessionGetIdentity(client->sasl);\n        if (virIdentitySetSASLUserName(ret, identity) < 0)\n            return NULL;\n    }\n#endif\n\n    if (client->tls) {\n        const char *identity = virNetTLSSessionGetX509DName(client->tls);\n        if (virIdentitySetX509DName(ret, identity) < 0)\n            return NULL;\n    }\n\n    if (client->sock &&\n        virNetSocketGetSELinuxContext(client->sock, &seccontext) < 0)\n        return NULL;\n    if (seccontext &&\n        virIdentitySetSELinuxContext(ret, seccontext) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&ret"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virIdentitySetSELinuxContext",
          "args": [
            "ret",
            "seccontext"
          ],
          "line": 815
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentitySetSELinuxContext",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "538-554",
          "snippet": "int virIdentitySetSELinuxContext(virIdentityPtr ident,\n                                 const char *context)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_SELINUX_CONTEXT)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_SELINUX_CONTEXT,\n                                   context);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetSELinuxContext(virIdentityPtr ident,\n                                 const char *context)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_SELINUX_CONTEXT)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_SELINUX_CONTEXT,\n                                   context);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketGetSELinuxContext",
          "args": [
            "client->sock",
            "&seccontext"
          ],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketGetSELinuxContext",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1623-1628",
          "snippet": "int virNetSocketGetSELinuxContext(virNetSocketPtr sock G_GNUC_UNUSED,\n                                  char **context)\n{\n    *context = NULL;\n    return 0;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nint virNetSocketGetSELinuxContext(virNetSocketPtr sock G_GNUC_UNUSED,\n                                  char **context)\n{\n    *context = NULL;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virIdentitySetX509DName",
          "args": [
            "ret",
            "identity"
          ],
          "line": 807
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentitySetX509DName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "519-535",
          "snippet": "int virIdentitySetX509DName(virIdentityPtr ident,\n                            const char *dname)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME,\n                                   dname);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetX509DName(virIdentityPtr ident,\n                            const char *dname)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME,\n                                   dname);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetTLSSessionGetX509DName",
          "args": [
            "client->tls"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "virNetTLSSessionGetX509DName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnettlscontext.c",
          "lines": "1403-1414",
          "snippet": "const char *virNetTLSSessionGetX509DName(virNetTLSSessionPtr sess)\n{\n    const char *ret = NULL;\n\n    virObjectLock(sess);\n\n    ret = sess->x509dname;\n\n    virObjectUnlock(sess);\n\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virthread.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virnettlscontext.h\"",
            "#include <gnutls/x509.h>",
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virthread.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virnettlscontext.h\"\n#include <gnutls/x509.h>\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <unistd.h>\n#include <config.h>\n\nconst char *virNetTLSSessionGetX509DName(virNetTLSSessionPtr sess)\n{\n    const char *ret = NULL;\n\n    virObjectLock(sess);\n\n    ret = sess->x509dname;\n\n    virObjectUnlock(sess);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virIdentitySetSASLUserName",
          "args": [
            "ret",
            "identity"
          ],
          "line": 800
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentitySetSASLUserName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "500-516",
          "snippet": "int virIdentitySetSASLUserName(virIdentityPtr ident,\n                               const char *username)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_SASL_USER_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_SASL_USER_NAME,\n                                   username);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetSASLUserName(virIdentityPtr ident,\n                               const char *username)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_SASL_USER_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_SASL_USER_NAME,\n                                   username);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSASLSessionGetIdentity",
          "args": [
            "client->sasl"
          ],
          "line": 799
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSASLSessionGetIdentity",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
          "lines": "274-298",
          "snippet": "const char *virNetSASLSessionGetIdentity(virNetSASLSessionPtr sasl)\n{\n    const void *val = NULL;\n    int err;\n    virObjectLock(sasl);\n\n    err = sasl_getprop(sasl->conn, SASL_USERNAME, &val);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"cannot query SASL username on connection %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        val = NULL;\n        goto cleanup;\n    }\n    if (val == NULL) {\n        virReportError(VIR_ERR_AUTH_FAILED, \"%s\",\n                       _(\"no client username was found\"));\n        goto cleanup;\n    }\n    VIR_DEBUG(\"SASL client username %s\", (const char *)val);\n\n cleanup:\n    virObjectUnlock(sasl);\n    return (const char*)val;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetmessage.h\"",
            "#include \"virnetsaslcontext.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nconst char *virNetSASLSessionGetIdentity(virNetSASLSessionPtr sasl)\n{\n    const void *val = NULL;\n    int err;\n    virObjectLock(sasl);\n\n    err = sasl_getprop(sasl->conn, SASL_USERNAME, &val);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"cannot query SASL username on connection %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        val = NULL;\n        goto cleanup;\n    }\n    if (val == NULL) {\n        virReportError(VIR_ERR_AUTH_FAILED, \"%s\",\n                       _(\"no client username was found\"));\n        goto cleanup;\n    }\n    VIR_DEBUG(\"SASL client username %s\", (const char *)val);\n\n cleanup:\n    virObjectUnlock(sasl);\n    return (const char*)val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virIdentitySetProcessTime",
          "args": [
            "ret",
            "timestamp"
          ],
          "line": 793
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentitySetProcessTime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "480-496",
          "snippet": "int virIdentitySetProcessTime(virIdentityPtr ident,\n                              unsigned long long timestamp)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_PROCESS_TIME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_PROCESS_TIME,\n                                   timestamp);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetProcessTime(virIdentityPtr ident,\n                              unsigned long long timestamp)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_PROCESS_TIME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_PROCESS_TIME,\n                                   timestamp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virIdentitySetProcessID",
          "args": [
            "ret",
            "pid"
          ],
          "line": 791
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentitySetProcessID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "461-477",
          "snippet": "int virIdentitySetProcessID(virIdentityPtr ident,\n                            pid_t pid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_PROCESS_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddLLong(&ident->params,\n                                  &ident->nparams,\n                                  &ident->maxparams,\n                                  VIR_CONNECT_IDENTITY_PROCESS_ID,\n                                  pid);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetProcessID(virIdentityPtr ident,\n                            pid_t pid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_PROCESS_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddLLong(&ident->params,\n                                  &ident->nparams,\n                                  &ident->maxparams,\n                                  VIR_CONNECT_IDENTITY_PROCESS_ID,\n                                  pid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virIdentitySetUNIXGroupID",
          "args": [
            "ret",
            "gid"
          ],
          "line": 788
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentitySetUNIXGroupID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "442-458",
          "snippet": "int virIdentitySetUNIXGroupID(virIdentityPtr ident,\n                              gid_t gid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_UNIX_GROUP_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_UNIX_GROUP_ID,\n                                   gid);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetUNIXGroupID(virIdentityPtr ident,\n                              gid_t gid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_UNIX_GROUP_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_UNIX_GROUP_ID,\n                                   gid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virIdentitySetGroupName",
          "args": [
            "ret",
            "groupname"
          ],
          "line": 786
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentitySetGroupName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "423-439",
          "snippet": "int virIdentitySetGroupName(virIdentityPtr ident,\n                            const char *groupname)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_GROUP_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_GROUP_NAME,\n                                   groupname);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetGroupName(virIdentityPtr ident,\n                            const char *groupname)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_GROUP_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_GROUP_NAME,\n                                   groupname);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetGroupName",
          "args": [
            "gid"
          ],
          "line": 784
        },
        "resolved": true,
        "details": {
          "function_name": "virGetGroupName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1158-1165",
          "snippet": "char *\nvirGetGroupName(gid_t gid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetGroupName is not available\"));\n\n    return NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetGroupName(gid_t gid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetGroupName is not available\"));\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virIdentitySetUNIXUserID",
          "args": [
            "ret",
            "uid"
          ],
          "line": 781
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentitySetUNIXUserID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "404-420",
          "snippet": "int virIdentitySetUNIXUserID(virIdentityPtr ident,\n                             uid_t uid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_UNIX_USER_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_UNIX_USER_ID,\n                                   uid);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetUNIXUserID(virIdentityPtr ident,\n                             uid_t uid)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_UNIX_USER_ID)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddULLong(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_UNIX_USER_ID,\n                                   uid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virIdentitySetUserName",
          "args": [
            "ret",
            "username"
          ],
          "line": 779
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentitySetUserName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "385-401",
          "snippet": "int virIdentitySetUserName(virIdentityPtr ident,\n                           const char *username)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_USER_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_USER_NAME,\n                                   username);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentitySetUserName(virIdentityPtr ident,\n                           const char *username)\n{\n    if (virTypedParamsGet(ident->params,\n                          ident->nparams,\n                          VIR_CONNECT_IDENTITY_USER_NAME)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"Identity attribute is already set\"));\n        return -1;\n    }\n\n    return virTypedParamsAddString(&ident->params,\n                                   &ident->nparams,\n                                   &ident->maxparams,\n                                   VIR_CONNECT_IDENTITY_USER_NAME,\n                                   username);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUserName",
          "args": [
            "uid"
          ],
          "line": 777
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1119-1126",
          "snippet": "char *\nvirGetUserName(uid_t uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserName is not available\"));\n\n    return NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetUserName(uid_t uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserName is not available\"));\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketGetUNIXIdentity",
          "args": [
            "client->sock",
            "&uid",
            "&gid",
            "&pid",
            "&timestamp"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketGetUNIXIdentity",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1581-1591",
          "snippet": "int virNetSocketGetUNIXIdentity(virNetSocketPtr sock G_GNUC_UNUSED,\n                                uid_t *uid G_GNUC_UNUSED,\n                                gid_t *gid G_GNUC_UNUSED,\n                                pid_t *pid G_GNUC_UNUSED,\n                                unsigned long long *timestamp G_GNUC_UNUSED)\n{\n    /* XXX Many more OS support UNIX socket credentials we could port to. See dbus ....*/\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Client socket identity not available\"));\n    return -1;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nint virNetSocketGetUNIXIdentity(virNetSocketPtr sock G_GNUC_UNUSED,\n                                uid_t *uid G_GNUC_UNUSED,\n                                gid_t *gid G_GNUC_UNUSED,\n                                pid_t *pid G_GNUC_UNUSED,\n                                unsigned long long *timestamp G_GNUC_UNUSED)\n{\n    /* XXX Many more OS support UNIX socket credentials we could port to. See dbus ....*/\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Client socket identity not available\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketIsLocal",
          "args": [
            "client->sock"
          ],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketIsLocal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1415-1423",
          "snippet": "bool virNetSocketIsLocal(virNetSocketPtr sock)\n{\n    bool isLocal = false;\n    virObjectLock(sock);\n    if (sock->localAddr.data.sa.sa_family == AF_UNIX)\n        isLocal = true;\n    virObjectUnlock(sock);\n    return isLocal;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nbool virNetSocketIsLocal(virNetSocketPtr sock)\n{\n    bool isLocal = false;\n    virObjectLock(sock);\n    if (sock->localAddr.data.sa.sa_family == AF_UNIX)\n        isLocal = true;\n    virObjectUnlock(sock);\n    return isLocal;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virIdentityNew",
          "args": [],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentityNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "216-219",
          "snippet": "virIdentityPtr virIdentityNew(void)\n{\n    return VIR_IDENTITY(g_object_new(VIR_TYPE_IDENTITY, NULL));\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nvirIdentityPtr virIdentityNew(void)\n{\n    return VIR_IDENTITY(g_object_new(VIR_TYPE_IDENTITY, NULL));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic virIdentityPtr\nvirNetServerClientCreateIdentity(virNetServerClientPtr client)\n{\n    g_autofree char *username = NULL;\n    g_autofree char *groupname = NULL;\n    g_autofree char *seccontext = NULL;\n    g_autoptr(virIdentity) ret = NULL;\n\n    if (!(ret = virIdentityNew()))\n        return NULL;\n\n    if (client->sock && virNetSocketIsLocal(client->sock)) {\n        gid_t gid;\n        uid_t uid;\n        pid_t pid;\n        unsigned long long timestamp;\n        if (virNetSocketGetUNIXIdentity(client->sock,\n                                        &uid, &gid, &pid,\n                                        &timestamp) < 0)\n            return NULL;\n\n        if (!(username = virGetUserName(uid)))\n            return NULL;\n        if (virIdentitySetUserName(ret, username) < 0)\n            return NULL;\n        if (virIdentitySetUNIXUserID(ret, uid) < 0)\n            return NULL;\n\n        if (!(groupname = virGetGroupName(gid)))\n            return NULL;\n        if (virIdentitySetGroupName(ret, groupname) < 0)\n            return NULL;\n        if (virIdentitySetUNIXGroupID(ret, gid) < 0)\n            return NULL;\n\n        if (virIdentitySetProcessID(ret, pid) < 0)\n            return NULL;\n        if (virIdentitySetProcessTime(ret, timestamp) < 0)\n            return NULL;\n    }\n\n#if WITH_SASL\n    if (client->sasl) {\n        const char *identity = virNetSASLSessionGetIdentity(client->sasl);\n        if (virIdentitySetSASLUserName(ret, identity) < 0)\n            return NULL;\n    }\n#endif\n\n    if (client->tls) {\n        const char *identity = virNetTLSSessionGetX509DName(client->tls);\n        if (virIdentitySetX509DName(ret, identity) < 0)\n            return NULL;\n    }\n\n    if (client->sock &&\n        virNetSocketGetSELinuxContext(client->sock, &seccontext) < 0)\n        return NULL;\n    if (seccontext &&\n        virIdentitySetSELinuxContext(ret, seccontext) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}"
  },
  {
    "function_name": "virNetServerClientGetUNIXIdentity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "741-753",
    "snippet": "int virNetServerClientGetUNIXIdentity(virNetServerClientPtr client,\n                                      uid_t *uid, gid_t *gid, pid_t *pid,\n                                      unsigned long long *timestamp)\n{\n    int ret = -1;\n    virObjectLock(client);\n    if (client->sock)\n        ret = virNetSocketGetUNIXIdentity(client->sock,\n                                          uid, gid, pid,\n                                          timestamp);\n    virObjectUnlock(client);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 751
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketGetUNIXIdentity",
          "args": [
            "client->sock",
            "uid",
            "gid",
            "pid",
            "timestamp"
          ],
          "line": 748
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketGetUNIXIdentity",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1581-1591",
          "snippet": "int virNetSocketGetUNIXIdentity(virNetSocketPtr sock G_GNUC_UNUSED,\n                                uid_t *uid G_GNUC_UNUSED,\n                                gid_t *gid G_GNUC_UNUSED,\n                                pid_t *pid G_GNUC_UNUSED,\n                                unsigned long long *timestamp G_GNUC_UNUSED)\n{\n    /* XXX Many more OS support UNIX socket credentials we could port to. See dbus ....*/\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Client socket identity not available\"));\n    return -1;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nint virNetSocketGetUNIXIdentity(virNetSocketPtr sock G_GNUC_UNUSED,\n                                uid_t *uid G_GNUC_UNUSED,\n                                gid_t *gid G_GNUC_UNUSED,\n                                pid_t *pid G_GNUC_UNUSED,\n                                unsigned long long *timestamp G_GNUC_UNUSED)\n{\n    /* XXX Many more OS support UNIX socket credentials we could port to. See dbus ....*/\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Client socket identity not available\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 746
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nint virNetServerClientGetUNIXIdentity(virNetServerClientPtr client,\n                                      uid_t *uid, gid_t *gid, pid_t *pid,\n                                      unsigned long long *timestamp)\n{\n    int ret = -1;\n    virObjectLock(client);\n    if (client->sock)\n        ret = virNetSocketGetUNIXIdentity(client->sock,\n                                          uid, gid, pid,\n                                          timestamp);\n    virObjectUnlock(client);\n    return ret;\n}"
  },
  {
    "function_name": "virNetServerClientIsLocal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "730-738",
    "snippet": "bool virNetServerClientIsLocal(virNetServerClientPtr client)\n{\n    bool local = false;\n    virObjectLock(client);\n    if (client->sock)\n        local = virNetSocketIsLocal(client->sock);\n    virObjectUnlock(client);\n    return local;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 736
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketIsLocal",
          "args": [
            "client->sock"
          ],
          "line": 735
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketIsLocal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1415-1423",
          "snippet": "bool virNetSocketIsLocal(virNetSocketPtr sock)\n{\n    bool isLocal = false;\n    virObjectLock(sock);\n    if (sock->localAddr.data.sa.sa_family == AF_UNIX)\n        isLocal = true;\n    virObjectUnlock(sock);\n    return isLocal;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nbool virNetSocketIsLocal(virNetSocketPtr sock)\n{\n    bool isLocal = false;\n    virObjectLock(sock);\n    if (sock->localAddr.data.sa.sa_family == AF_UNIX)\n        isLocal = true;\n    virObjectUnlock(sock);\n    return isLocal;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 733
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nbool virNetServerClientIsLocal(virNetServerClientPtr client)\n{\n    bool local = false;\n    virObjectLock(client);\n    if (client->sock)\n        local = virNetSocketIsLocal(client->sock);\n    virObjectUnlock(client);\n    return local;\n}"
  },
  {
    "function_name": "virNetServerClientGetFD",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "719-727",
    "snippet": "int virNetServerClientGetFD(virNetServerClientPtr client)\n{\n    int fd = -1;\n    virObjectLock(client);\n    if (client->sock)\n        fd = virNetSocketGetFD(client->sock);\n    virObjectUnlock(client);\n    return fd;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 725
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketGetFD",
          "args": [
            "client->sock"
          ],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketGetFD",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1377-1384",
          "snippet": "int virNetSocketGetFD(virNetSocketPtr sock)\n{\n    int fd;\n    virObjectLock(sock);\n    fd = sock->fd;\n    virObjectUnlock(sock);\n    return fd;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nint virNetSocketGetFD(virNetSocketPtr sock)\n{\n    int fd;\n    virObjectLock(sock);\n    fd = sock->fd;\n    virObjectUnlock(sock);\n    return fd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 722
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nint virNetServerClientGetFD(virNetServerClientPtr client)\n{\n    int fd = -1;\n    virObjectLock(client);\n    if (client->sock)\n        fd = virNetSocketGetFD(client->sock);\n    virObjectUnlock(client);\n    return fd;\n}"
  },
  {
    "function_name": "virNetServerClientGetTLSKeySize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "709-717",
    "snippet": "int virNetServerClientGetTLSKeySize(virNetServerClientPtr client)\n{\n    int size = 0;\n    virObjectLock(client);\n    if (client->tls)\n        size = virNetTLSSessionGetKeySize(client->tls);\n    virObjectUnlock(client);\n    return size;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 715
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetTLSSessionGetKeySize",
          "args": [
            "client->tls"
          ],
          "line": 714
        },
        "resolved": true,
        "details": {
          "function_name": "virNetTLSSessionGetKeySize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnettlscontext.c",
          "lines": "1385-1401",
          "snippet": "int virNetTLSSessionGetKeySize(virNetTLSSessionPtr sess)\n{\n    gnutls_cipher_algorithm_t cipher;\n    int ssf;\n    virObjectLock(sess);\n    cipher = gnutls_cipher_get(sess->session);\n    if (!(ssf = gnutls_cipher_get_key_size(cipher))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"invalid cipher size for TLS session\"));\n        ssf = -1;\n        goto cleanup;\n    }\n\n cleanup:\n    virObjectUnlock(sess);\n    return ssf;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virthread.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virnettlscontext.h\"",
            "#include <gnutls/x509.h>",
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virthread.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virnettlscontext.h\"\n#include <gnutls/x509.h>\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <unistd.h>\n#include <config.h>\n\nint virNetTLSSessionGetKeySize(virNetTLSSessionPtr sess)\n{\n    gnutls_cipher_algorithm_t cipher;\n    int ssf;\n    virObjectLock(sess);\n    cipher = gnutls_cipher_get(sess->session);\n    if (!(ssf = gnutls_cipher_get_key_size(cipher))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"invalid cipher size for TLS session\"));\n        ssf = -1;\n        goto cleanup;\n    }\n\n cleanup:\n    virObjectUnlock(sess);\n    return ssf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 712
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nint virNetServerClientGetTLSKeySize(virNetServerClientPtr client)\n{\n    int size = 0;\n    virObjectLock(client);\n    if (client->tls)\n        size = virNetTLSSessionGetKeySize(client->tls);\n    virObjectUnlock(client);\n    return size;\n}"
  },
  {
    "function_name": "virNetServerClientGetTLSSession",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "700-707",
    "snippet": "virNetTLSSessionPtr virNetServerClientGetTLSSession(virNetServerClientPtr client)\n{\n    virNetTLSSessionPtr tls;\n    virObjectLock(client);\n    tls = client->tls;\n    virObjectUnlock(client);\n    return tls;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvirNetTLSSessionPtr virNetServerClientGetTLSSession(virNetServerClientPtr client)\n{\n    virNetTLSSessionPtr tls;\n    virObjectLock(client);\n    tls = client->tls;\n    virObjectUnlock(client);\n    return tls;\n}"
  },
  {
    "function_name": "virNetServerClientHasTLSSession",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "690-697",
    "snippet": "bool virNetServerClientHasTLSSession(virNetServerClientPtr client)\n{\n    bool has;\n    virObjectLock(client);\n    has = client->tls ? true : false;\n    virObjectUnlock(client);\n    return has;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 695
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 693
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nbool virNetServerClientHasTLSSession(virNetServerClientPtr client)\n{\n    bool has;\n    virObjectLock(client);\n    has = client->tls ? true : false;\n    virObjectUnlock(client);\n    return has;\n}"
  },
  {
    "function_name": "virNetServerClientGetTimestamp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "685-688",
    "snippet": "long long virNetServerClientGetTimestamp(virNetServerClientPtr client)\n{\n    return client->conn_time;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nlong long virNetServerClientGetTimestamp(virNetServerClientPtr client)\n{\n    return client->conn_time;\n}"
  },
  {
    "function_name": "virNetServerClientGetID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "680-683",
    "snippet": "unsigned long long virNetServerClientGetID(virNetServerClientPtr client)\n{\n    return client->id;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nunsigned long long virNetServerClientGetID(virNetServerClientPtr client)\n{\n    return client->id;\n}"
  },
  {
    "function_name": "virNetServerClientSetReadonly",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "670-677",
    "snippet": "void\nvirNetServerClientSetReadonly(virNetServerClientPtr client,\n                              bool readonly)\n{\n    virObjectLock(client);\n    client->readonly = readonly;\n    virObjectUnlock(client);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 676
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 674
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvoid\nvirNetServerClientSetReadonly(virNetServerClientPtr client,\n                              bool readonly)\n{\n    virObjectLock(client);\n    client->readonly = readonly;\n    virObjectUnlock(client);\n}"
  },
  {
    "function_name": "virNetServerClientGetReadonly",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "660-667",
    "snippet": "bool virNetServerClientGetReadonly(virNetServerClientPtr client)\n{\n    bool readonly;\n    virObjectLock(client);\n    readonly = client->readonly;\n    virObjectUnlock(client);\n    return readonly;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 663
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nbool virNetServerClientGetReadonly(virNetServerClientPtr client)\n{\n    bool readonly;\n    virObjectLock(client);\n    readonly = client->readonly;\n    virObjectUnlock(client);\n    return readonly;\n}"
  },
  {
    "function_name": "virNetServerClientSetAuthLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "652-657",
    "snippet": "void\nvirNetServerClientSetAuthLocked(virNetServerClientPtr client,\n                                int auth)\n{\n    client->auth = auth;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvoid\nvirNetServerClientSetAuthLocked(virNetServerClientPtr client,\n                                int auth)\n{\n    client->auth = auth;\n}"
  },
  {
    "function_name": "virNetServerClientGetAuth",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "642-649",
    "snippet": "int virNetServerClientGetAuth(virNetServerClientPtr client)\n{\n    int auth;\n    virObjectLock(client);\n    auth = client->auth;\n    virObjectUnlock(client);\n    return auth;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 647
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 645
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nint virNetServerClientGetAuth(virNetServerClientPtr client)\n{\n    int auth;\n    virObjectLock(client);\n    auth = client->auth;\n    virObjectUnlock(client);\n    return auth;\n}"
  },
  {
    "function_name": "virNetServerClientPreExecRestart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "591-639",
    "snippet": "virJSONValuePtr virNetServerClientPreExecRestart(virNetServerClientPtr client)\n{\n    virJSONValuePtr object = virJSONValueNewObject();\n    virJSONValuePtr child;\n\n    virObjectLock(client);\n\n    if (virJSONValueObjectAppendNumberUlong(object, \"id\",\n                                            client->id) < 0)\n        goto error;\n\n    if (virJSONValueObjectAppendNumberInt(object, \"auth\", client->auth) < 0)\n        goto error;\n    if (virJSONValueObjectAppendBoolean(object, \"auth_pending\", client->auth_pending) < 0)\n        goto error;\n    if (virJSONValueObjectAppendBoolean(object, \"readonly\", client->readonly) < 0)\n        goto error;\n    if (virJSONValueObjectAppendNumberUint(object, \"nrequests_max\", client->nrequests_max) < 0)\n        goto error;\n\n    if (client->conn_time &&\n        virJSONValueObjectAppendNumberLong(object, \"conn_time\",\n                                           client->conn_time) < 0)\n        goto error;\n\n    if (!(child = virNetSocketPreExecRestart(client->sock)))\n        goto error;\n\n    if (virJSONValueObjectAppend(object, \"sock\", child) < 0) {\n        virJSONValueFree(child);\n        goto error;\n    }\n\n    if (!(child = client->privateDataPreExecRestart(client, client->privateData)))\n        goto error;\n\n    if (virJSONValueObjectAppend(object, \"privateData\", child) < 0) {\n        virJSONValueFree(child);\n        goto error;\n    }\n\n    virObjectUnlock(client);\n    return object;\n\n error:\n    virObjectUnlock(client);\n    virJSONValueFree(object);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "object"
          ],
          "line": 637
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 636
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppend",
          "args": [
            "object",
            "\"privateData\"",
            "child"
          ],
          "line": 627
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "741-754",
          "snippet": "int\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "client->privateDataPreExecRestart",
          "args": [
            "client",
            "client->privateData"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetSocketPreExecRestart",
          "args": [
            "client->sock"
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketPreExecRestart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1267-1324",
          "snippet": "virJSONValuePtr virNetSocketPreExecRestart(virNetSocketPtr sock)\n{\n    virJSONValuePtr object = NULL;\n\n    virObjectLock(sock);\n\n#if WITH_SASL\n    if (sock->saslSession) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Unable to save socket state when SASL session is active\"));\n        goto error;\n    }\n#endif\n    if (sock->tlsSession) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Unable to save socket state when TLS session is active\"));\n        goto error;\n    }\n\n    object = virJSONValueNewObject();\n\n    if (virJSONValueObjectAppendNumberInt(object, \"fd\", sock->fd) < 0)\n        goto error;\n\n    if (virJSONValueObjectAppendNumberInt(object, \"errfd\", sock->errfd) < 0)\n        goto error;\n\n    if (virJSONValueObjectAppendNumberInt(object, \"pid\", sock->pid) < 0)\n        goto error;\n\n    if (virJSONValueObjectAppendBoolean(object, \"isClient\", sock->isClient) < 0)\n        goto error;\n\n    if (virJSONValueObjectAppendBoolean(object, \"unlinkUNIX\", sock->unlinkUNIX) < 0)\n        goto error;\n\n    if (virSetInherit(sock->fd, true) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot disable close-on-exec flag on socket %d\"),\n                             sock->fd);\n        goto error;\n    }\n    if (sock->errfd != -1 &&\n        virSetInherit(sock->errfd, true) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot disable close-on-exec flag on pipe %d\"),\n                             sock->errfd);\n        goto error;\n    }\n\n    virObjectUnlock(sock);\n    return object;\n\n error:\n    virObjectUnlock(sock);\n    virJSONValueFree(object);\n    return NULL;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvirJSONValuePtr virNetSocketPreExecRestart(virNetSocketPtr sock)\n{\n    virJSONValuePtr object = NULL;\n\n    virObjectLock(sock);\n\n#if WITH_SASL\n    if (sock->saslSession) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Unable to save socket state when SASL session is active\"));\n        goto error;\n    }\n#endif\n    if (sock->tlsSession) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Unable to save socket state when TLS session is active\"));\n        goto error;\n    }\n\n    object = virJSONValueNewObject();\n\n    if (virJSONValueObjectAppendNumberInt(object, \"fd\", sock->fd) < 0)\n        goto error;\n\n    if (virJSONValueObjectAppendNumberInt(object, \"errfd\", sock->errfd) < 0)\n        goto error;\n\n    if (virJSONValueObjectAppendNumberInt(object, \"pid\", sock->pid) < 0)\n        goto error;\n\n    if (virJSONValueObjectAppendBoolean(object, \"isClient\", sock->isClient) < 0)\n        goto error;\n\n    if (virJSONValueObjectAppendBoolean(object, \"unlinkUNIX\", sock->unlinkUNIX) < 0)\n        goto error;\n\n    if (virSetInherit(sock->fd, true) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot disable close-on-exec flag on socket %d\"),\n                             sock->fd);\n        goto error;\n    }\n    if (sock->errfd != -1 &&\n        virSetInherit(sock->errfd, true) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot disable close-on-exec flag on pipe %d\"),\n                             sock->errfd);\n        goto error;\n    }\n\n    virObjectUnlock(sock);\n    return object;\n\n error:\n    virObjectUnlock(sock);\n    virJSONValueFree(object);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendNumberLong",
          "args": [
            "object",
            "\"conn_time\"",
            "client->conn_time"
          ],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendNumberLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "693-706",
          "snippet": "int\nvirJSONValueObjectAppendNumberLong(virJSONValuePtr object,\n                                   const char *key,\n                                   long long number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberLong(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNumberLong(virJSONValuePtr object,\n                                   const char *key,\n                                   long long number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberLong(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendNumberUint",
          "args": [
            "object",
            "\"nrequests_max\"",
            "client->nrequests_max"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendNumberUint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "677-690",
          "snippet": "int\nvirJSONValueObjectAppendNumberUint(virJSONValuePtr object,\n                                   const char *key,\n                                   unsigned int number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberUint(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNumberUint(virJSONValuePtr object,\n                                   const char *key,\n                                   unsigned int number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberUint(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendNumberInt",
          "args": [
            "object",
            "\"auth\"",
            "client->auth"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendNumberInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "661-674",
          "snippet": "int\nvirJSONValueObjectAppendNumberInt(virJSONValuePtr object,\n                                  const char *key,\n                                  int number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberInt(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNumberInt(virJSONValuePtr object,\n                                  const char *key,\n                                  int number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberInt(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendNumberUlong",
          "args": [
            "object",
            "\"id\"",
            "client->id"
          ],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendNumberUlong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "709-722",
          "snippet": "int\nvirJSONValueObjectAppendNumberUlong(virJSONValuePtr object,\n                                    const char *key,\n                                    unsigned long long number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberUlong(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNumberUlong(virJSONValuePtr object,\n                                    const char *key,\n                                    unsigned long long number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberUlong(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 596
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewObject",
          "args": [],
          "line": 593
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "571-579",
          "snippet": "virJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvirJSONValuePtr virNetServerClientPreExecRestart(virNetServerClientPtr client)\n{\n    virJSONValuePtr object = virJSONValueNewObject();\n    virJSONValuePtr child;\n\n    virObjectLock(client);\n\n    if (virJSONValueObjectAppendNumberUlong(object, \"id\",\n                                            client->id) < 0)\n        goto error;\n\n    if (virJSONValueObjectAppendNumberInt(object, \"auth\", client->auth) < 0)\n        goto error;\n    if (virJSONValueObjectAppendBoolean(object, \"auth_pending\", client->auth_pending) < 0)\n        goto error;\n    if (virJSONValueObjectAppendBoolean(object, \"readonly\", client->readonly) < 0)\n        goto error;\n    if (virJSONValueObjectAppendNumberUint(object, \"nrequests_max\", client->nrequests_max) < 0)\n        goto error;\n\n    if (client->conn_time &&\n        virJSONValueObjectAppendNumberLong(object, \"conn_time\",\n                                           client->conn_time) < 0)\n        goto error;\n\n    if (!(child = virNetSocketPreExecRestart(client->sock)))\n        goto error;\n\n    if (virJSONValueObjectAppend(object, \"sock\", child) < 0) {\n        virJSONValueFree(child);\n        goto error;\n    }\n\n    if (!(child = client->privateDataPreExecRestart(client, client->privateData)))\n        goto error;\n\n    if (virJSONValueObjectAppend(object, \"privateData\", child) < 0) {\n        virJSONValueFree(child);\n        goto error;\n    }\n\n    virObjectUnlock(client);\n    return object;\n\n error:\n    virObjectUnlock(client);\n    virJSONValueFree(object);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetServerClientNewPostExecRestart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "471-588",
    "snippet": "virNetServerClientPtr virNetServerClientNewPostExecRestart(virNetServerPtr srv,\n                                                           virJSONValuePtr object,\n                                                           virNetServerClientPrivNewPostExecRestart privNew,\n                                                           virNetServerClientPrivPreExecRestart privPreExecRestart,\n                                                           virFreeCallback privFree,\n                                                           void *privOpaque)\n{\n    virJSONValuePtr child;\n    virNetServerClientPtr client = NULL;\n    virNetSocketPtr sock;\n    int auth;\n    bool readonly, auth_pending;\n    unsigned int nrequests_max;\n    unsigned long long id;\n    long long timestamp;\n\n    if (virJSONValueObjectGetNumberInt(object, \"auth\", &auth) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing auth field in JSON state document\"));\n        return NULL;\n    }\n\n    if (!virJSONValueObjectHasKey(object, \"auth_pending\")) {\n        auth_pending = !virNetServerClientAuthMethodImpliesAuthenticated(auth);\n    } else {\n        if (virJSONValueObjectGetBoolean(object, \"auth_pending\", &auth_pending) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Malformed auth_pending field in JSON state document\"));\n            return NULL;\n        }\n\n        /* If the used authentication method implies that the new\n         * client is automatically authenticated, the authentication\n         * cannot be pending */\n        if (auth_pending && virNetServerClientAuthMethodImpliesAuthenticated(auth)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Invalid auth_pending and auth combination in JSON state document\"));\n            return NULL;\n        }\n    }\n\n    if (virJSONValueObjectGetBoolean(object, \"readonly\", &readonly) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing readonly field in JSON state document\"));\n        return NULL;\n    }\n    if (virJSONValueObjectGetNumberUint(object, \"nrequests_max\",\n                                        &nrequests_max) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing nrequests_client_max field in JSON state document\"));\n        return NULL;\n    }\n\n    if (!(child = virJSONValueObjectGet(object, \"sock\"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing sock field in JSON state document\"));\n        return NULL;\n    }\n\n    if (!virJSONValueObjectHasKey(object, \"id\")) {\n        /* no ID found in, a new one must be generated */\n        id = virNetServerNextClientID(srv);\n    } else {\n        if (virJSONValueObjectGetNumberUlong(object, \"id\", &id) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Malformed id field in JSON state document\"));\n            return NULL;\n        }\n    }\n\n    if (!virJSONValueObjectHasKey(object, \"conn_time\")) {\n        timestamp = 0;\n    } else {\n        if (virJSONValueObjectGetNumberLong(object, \"conn_time\", &timestamp) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Malformed conn_time field in JSON \"\n                             \"state document\"));\n            return NULL;\n        }\n    }\n\n    if (!(sock = virNetSocketNewPostExecRestart(child))) {\n        virObjectUnref(sock);\n        return NULL;\n    }\n\n    if (!(client = virNetServerClientNewInternal(id,\n                                                 sock,\n                                                 auth,\n                                                 auth_pending,\n                                                 NULL,\n                                                 readonly,\n                                                 nrequests_max,\n                                                 timestamp))) {\n        virObjectUnref(sock);\n        return NULL;\n    }\n    virObjectUnref(sock);\n\n    if (!(child = virJSONValueObjectGet(object, \"privateData\"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing privateData field in JSON state document\"));\n        goto error;\n    }\n\n    if (!(client->privateData = privNew(client, child, privOpaque)))\n        goto error;\n\n    client->privateDataFreeFunc = privFree;\n    client->privateDataPreExecRestart = privPreExecRestart;\n\n\n    return client;\n\n error:\n    virObjectUnref(client);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "client"
          ],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "privNew",
          "args": [
            "client",
            "child",
            "privOpaque"
          ],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Missing privateData field in JSON state document\")"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Missing privateData field in JSON state document\""
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGet",
          "args": [
            "object",
            "\"privateData\""
          ],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientNewInternal",
          "args": [
            "id",
            "sock",
            "auth",
            "auth_pending",
            "NULL",
            "readonly",
            "nrequests_max",
            "timestamp"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientNewInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "381-430",
          "snippet": "static virNetServerClientPtr\nvirNetServerClientNewInternal(unsigned long long id,\n                              virNetSocketPtr sock,\n                              int auth,\n                              bool auth_pending,\n                              virNetTLSContextPtr tls,\n                              bool readonly,\n                              size_t nrequests_max,\n                              long long timestamp)\n{\n    virNetServerClientPtr client;\n\n    if (virNetServerClientInitialize() < 0)\n        return NULL;\n\n    if (!(client = virObjectLockableNew(virNetServerClientClass)))\n        return NULL;\n\n    client->id = id;\n    client->sock = virObjectRef(sock);\n    client->auth = auth;\n    client->auth_pending = auth_pending;\n    client->readonly = readonly;\n    client->tlsCtxt = virObjectRef(tls);\n    client->nrequests_max = nrequests_max;\n    client->conn_time = timestamp;\n\n    client->sockTimer = virEventAddTimeout(-1, virNetServerClientSockTimerFunc,\n                                           client, NULL);\n    if (client->sockTimer < 0)\n        goto error;\n\n    /* Prepare one for packet receive */\n    if (!(client->rx = virNetMessageNew(true)))\n        goto error;\n    client->rx->bufferLength = VIR_NET_MESSAGE_LEN_MAX;\n    if (VIR_ALLOC_N(client->rx->buffer, client->rx->bufferLength) < 0)\n        goto error;\n    client->nrequests = 1;\n\n    PROBE(RPC_SERVER_CLIENT_NEW,\n          \"client=%p sock=%p\",\n          client, client->sock);\n\n    return client;\n\n error:\n    virObjectUnref(client);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virNetServerClientClass;",
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic virClassPtr virNetServerClientClass;\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic virNetServerClientPtr\nvirNetServerClientNewInternal(unsigned long long id,\n                              virNetSocketPtr sock,\n                              int auth,\n                              bool auth_pending,\n                              virNetTLSContextPtr tls,\n                              bool readonly,\n                              size_t nrequests_max,\n                              long long timestamp)\n{\n    virNetServerClientPtr client;\n\n    if (virNetServerClientInitialize() < 0)\n        return NULL;\n\n    if (!(client = virObjectLockableNew(virNetServerClientClass)))\n        return NULL;\n\n    client->id = id;\n    client->sock = virObjectRef(sock);\n    client->auth = auth;\n    client->auth_pending = auth_pending;\n    client->readonly = readonly;\n    client->tlsCtxt = virObjectRef(tls);\n    client->nrequests_max = nrequests_max;\n    client->conn_time = timestamp;\n\n    client->sockTimer = virEventAddTimeout(-1, virNetServerClientSockTimerFunc,\n                                           client, NULL);\n    if (client->sockTimer < 0)\n        goto error;\n\n    /* Prepare one for packet receive */\n    if (!(client->rx = virNetMessageNew(true)))\n        goto error;\n    client->rx->bufferLength = VIR_NET_MESSAGE_LEN_MAX;\n    if (VIR_ALLOC_N(client->rx->buffer, client->rx->bufferLength) < 0)\n        goto error;\n    client->nrequests = 1;\n\n    PROBE(RPC_SERVER_CLIENT_NEW,\n          \"client=%p sock=%p\",\n          client, client->sock);\n\n    return client;\n\n error:\n    virObjectUnref(client);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketNewPostExecRestart",
          "args": [
            "child"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketNewPostExecRestart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1212-1264",
          "snippet": "virNetSocketPtr virNetSocketNewPostExecRestart(virJSONValuePtr object)\n{\n    virSocketAddr localAddr;\n    virSocketAddr remoteAddr;\n    int fd, thepid, errfd;\n    bool isClient;\n    bool unlinkUNIX;\n\n    if (virJSONValueObjectGetNumberInt(object, \"fd\", &fd) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing fd data in JSON document\"));\n        return NULL;\n    }\n\n    if (virJSONValueObjectGetNumberInt(object, \"pid\", &thepid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing pid data in JSON document\"));\n        return NULL;\n    }\n\n    if (virJSONValueObjectGetNumberInt(object, \"errfd\", &errfd) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing errfd data in JSON document\"));\n        return NULL;\n    }\n\n    if (virJSONValueObjectGetBoolean(object, \"isClient\", &isClient) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing isClient data in JSON document\"));\n        return NULL;\n    }\n\n    if (virJSONValueObjectGetBoolean(object, \"unlinkUNIX\", &unlinkUNIX) < 0)\n        unlinkUNIX = !isClient;\n\n    memset(&localAddr, 0, sizeof(localAddr));\n    memset(&remoteAddr, 0, sizeof(remoteAddr));\n\n    remoteAddr.len = sizeof(remoteAddr.data.stor);\n    if (getsockname(fd, &remoteAddr.data.sa, &remoteAddr.len) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"Unable to get peer socket name\"));\n        return NULL;\n    }\n\n    localAddr.len = sizeof(localAddr.data.stor);\n    if (getsockname(fd, &localAddr.data.sa, &localAddr.len) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"Unable to get local socket name\"));\n        return NULL;\n    }\n\n    return virNetSocketNew(&localAddr, &remoteAddr, isClient,\n                           fd, errfd, thepid, unlinkUNIX);\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvirNetSocketPtr virNetSocketNewPostExecRestart(virJSONValuePtr object)\n{\n    virSocketAddr localAddr;\n    virSocketAddr remoteAddr;\n    int fd, thepid, errfd;\n    bool isClient;\n    bool unlinkUNIX;\n\n    if (virJSONValueObjectGetNumberInt(object, \"fd\", &fd) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing fd data in JSON document\"));\n        return NULL;\n    }\n\n    if (virJSONValueObjectGetNumberInt(object, \"pid\", &thepid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing pid data in JSON document\"));\n        return NULL;\n    }\n\n    if (virJSONValueObjectGetNumberInt(object, \"errfd\", &errfd) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing errfd data in JSON document\"));\n        return NULL;\n    }\n\n    if (virJSONValueObjectGetBoolean(object, \"isClient\", &isClient) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing isClient data in JSON document\"));\n        return NULL;\n    }\n\n    if (virJSONValueObjectGetBoolean(object, \"unlinkUNIX\", &unlinkUNIX) < 0)\n        unlinkUNIX = !isClient;\n\n    memset(&localAddr, 0, sizeof(localAddr));\n    memset(&remoteAddr, 0, sizeof(remoteAddr));\n\n    remoteAddr.len = sizeof(remoteAddr.data.stor);\n    if (getsockname(fd, &remoteAddr.data.sa, &remoteAddr.len) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"Unable to get peer socket name\"));\n        return NULL;\n    }\n\n    localAddr.len = sizeof(localAddr.data.stor);\n    if (getsockname(fd, &localAddr.data.sa, &localAddr.len) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"Unable to get local socket name\"));\n        return NULL;\n    }\n\n    return virNetSocketNew(&localAddr, &remoteAddr, isClient,\n                           fd, errfd, thepid, unlinkUNIX);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Malformed conn_time field in JSON \"\n                             \"state document\")"
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetNumberLong",
          "args": [
            "object",
            "\"conn_time\"",
            "&timestamp"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetNumberLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1359-1370",
          "snippet": "int\nvirJSONValueObjectGetNumberLong(virJSONValuePtr object,\n                                const char *key,\n                                long long *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberLong(val, value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectGetNumberLong(virJSONValuePtr object,\n                                const char *key,\n                                long long *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberLong(val, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectHasKey",
          "args": [
            "object",
            "\"conn_time\""
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectHasKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "838-853",
          "snippet": "int\nvirJSONValueObjectHasKey(virJSONValuePtr object,\n                         const char *key)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key))\n            return 1;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectHasKey(virJSONValuePtr object,\n                         const char *key)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key))\n            return 1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Malformed id field in JSON state document\")"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetNumberUlong",
          "args": [
            "object",
            "\"id\"",
            "&id"
          ],
          "line": 534
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetNumberUlong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1373-1384",
          "snippet": "int\nvirJSONValueObjectGetNumberUlong(virJSONValuePtr object,\n                                 const char *key,\n                                 unsigned long long *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberUlong(val, value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectGetNumberUlong(virJSONValuePtr object,\n                                 const char *key,\n                                 unsigned long long *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberUlong(val, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerNextClientID",
          "args": [
            "srv"
          ],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerNextClientID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserver.c",
          "lines": "97-106",
          "snippet": "unsigned long long virNetServerNextClientID(virNetServerPtr srv)\n{\n    unsigned long long val;\n\n    virObjectLock(srv);\n    val = srv->next_client_id++;\n    virObjectUnlock(srv);\n\n    return val;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);",
            "static inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetserver.h\"\n#include <config.h>\n\nstatic inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);\nstatic inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);\n\nunsigned long long virNetServerNextClientID(virNetServerPtr srv)\n{\n    unsigned long long val;\n\n    virObjectLock(srv);\n    val = srv->next_client_id++;\n    virObjectUnlock(srv);\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Missing sock field in JSON state document\")"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Missing nrequests_client_max field in JSON state document\")"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetNumberUint",
          "args": [
            "object",
            "\"nrequests_max\"",
            "&nrequests_max"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetNumberUint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1345-1356",
          "snippet": "int\nvirJSONValueObjectGetNumberUint(virJSONValuePtr object,\n                                const char *key,\n                                unsigned int *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberUint(val, value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectGetNumberUint(virJSONValuePtr object,\n                                const char *key,\n                                unsigned int *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberUint(val, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Missing readonly field in JSON state document\")"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetBoolean",
          "args": [
            "object",
            "\"readonly\"",
            "&readonly"
          ],
          "line": 512
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1401-1412",
          "snippet": "int\nvirJSONValueObjectGetBoolean(virJSONValuePtr object,\n                             const char *key,\n                             bool *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetBoolean(val, value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectGetBoolean(virJSONValuePtr object,\n                             const char *key,\n                             bool *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetBoolean(val, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid auth_pending and auth combination in JSON state document\")"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetServerClientAuthMethodImpliesAuthenticated",
          "args": [
            "auth"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientAuthMethodImpliesAuthenticated",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "374-378",
          "snippet": "static bool\nvirNetServerClientAuthMethodImpliesAuthenticated(int auth)\n{\n    return auth == VIR_NET_SERVER_SERVICE_AUTH_NONE;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool\nvirNetServerClientAuthMethodImpliesAuthenticated(int auth)\n{\n    return auth == VIR_NET_SERVER_SERVICE_AUTH_NONE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Malformed auth_pending field in JSON state document\")"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Missing auth field in JSON state document\")"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetNumberInt",
          "args": [
            "object",
            "\"auth\"",
            "&auth"
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetNumberInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1331-1342",
          "snippet": "int\nvirJSONValueObjectGetNumberInt(virJSONValuePtr object,\n                               const char *key,\n                               int *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberInt(val, value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectGetNumberInt(virJSONValuePtr object,\n                               const char *key,\n                               int *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberInt(val, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvirNetServerClientPtr virNetServerClientNewPostExecRestart(virNetServerPtr srv,\n                                                           virJSONValuePtr object,\n                                                           virNetServerClientPrivNewPostExecRestart privNew,\n                                                           virNetServerClientPrivPreExecRestart privPreExecRestart,\n                                                           virFreeCallback privFree,\n                                                           void *privOpaque)\n{\n    virJSONValuePtr child;\n    virNetServerClientPtr client = NULL;\n    virNetSocketPtr sock;\n    int auth;\n    bool readonly, auth_pending;\n    unsigned int nrequests_max;\n    unsigned long long id;\n    long long timestamp;\n\n    if (virJSONValueObjectGetNumberInt(object, \"auth\", &auth) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing auth field in JSON state document\"));\n        return NULL;\n    }\n\n    if (!virJSONValueObjectHasKey(object, \"auth_pending\")) {\n        auth_pending = !virNetServerClientAuthMethodImpliesAuthenticated(auth);\n    } else {\n        if (virJSONValueObjectGetBoolean(object, \"auth_pending\", &auth_pending) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Malformed auth_pending field in JSON state document\"));\n            return NULL;\n        }\n\n        /* If the used authentication method implies that the new\n         * client is automatically authenticated, the authentication\n         * cannot be pending */\n        if (auth_pending && virNetServerClientAuthMethodImpliesAuthenticated(auth)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Invalid auth_pending and auth combination in JSON state document\"));\n            return NULL;\n        }\n    }\n\n    if (virJSONValueObjectGetBoolean(object, \"readonly\", &readonly) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing readonly field in JSON state document\"));\n        return NULL;\n    }\n    if (virJSONValueObjectGetNumberUint(object, \"nrequests_max\",\n                                        &nrequests_max) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing nrequests_client_max field in JSON state document\"));\n        return NULL;\n    }\n\n    if (!(child = virJSONValueObjectGet(object, \"sock\"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing sock field in JSON state document\"));\n        return NULL;\n    }\n\n    if (!virJSONValueObjectHasKey(object, \"id\")) {\n        /* no ID found in, a new one must be generated */\n        id = virNetServerNextClientID(srv);\n    } else {\n        if (virJSONValueObjectGetNumberUlong(object, \"id\", &id) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Malformed id field in JSON state document\"));\n            return NULL;\n        }\n    }\n\n    if (!virJSONValueObjectHasKey(object, \"conn_time\")) {\n        timestamp = 0;\n    } else {\n        if (virJSONValueObjectGetNumberLong(object, \"conn_time\", &timestamp) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Malformed conn_time field in JSON \"\n                             \"state document\"));\n            return NULL;\n        }\n    }\n\n    if (!(sock = virNetSocketNewPostExecRestart(child))) {\n        virObjectUnref(sock);\n        return NULL;\n    }\n\n    if (!(client = virNetServerClientNewInternal(id,\n                                                 sock,\n                                                 auth,\n                                                 auth_pending,\n                                                 NULL,\n                                                 readonly,\n                                                 nrequests_max,\n                                                 timestamp))) {\n        virObjectUnref(sock);\n        return NULL;\n    }\n    virObjectUnref(sock);\n\n    if (!(child = virJSONValueObjectGet(object, \"privateData\"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Missing privateData field in JSON state document\"));\n        goto error;\n    }\n\n    if (!(client->privateData = privNew(client, child, privOpaque)))\n        goto error;\n\n    client->privateDataFreeFunc = privFree;\n    client->privateDataPreExecRestart = privPreExecRestart;\n\n\n    return client;\n\n error:\n    virObjectUnref(client);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetServerClientNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "433-468",
    "snippet": "virNetServerClientPtr virNetServerClientNew(unsigned long long id,\n                                            virNetSocketPtr sock,\n                                            int auth,\n                                            bool readonly,\n                                            size_t nrequests_max,\n                                            virNetTLSContextPtr tls,\n                                            virNetServerClientPrivNew privNew,\n                                            virNetServerClientPrivPreExecRestart privPreExecRestart,\n                                            virFreeCallback privFree,\n                                            void *privOpaque)\n{\n    virNetServerClientPtr client;\n    time_t now;\n    bool auth_pending = !virNetServerClientAuthMethodImpliesAuthenticated(auth);\n\n    VIR_DEBUG(\"sock=%p auth=%d tls=%p\", sock, auth, tls);\n\n    if ((now = time(NULL)) == (time_t)-1) {\n        virReportSystemError(errno, \"%s\", _(\"failed to get current time\"));\n        return NULL;\n    }\n\n    if (!(client = virNetServerClientNewInternal(id, sock, auth, auth_pending,\n                                                 tls, readonly, nrequests_max,\n                                                 now)))\n        return NULL;\n\n    if (!(client->privateData = privNew(client, privOpaque))) {\n        virObjectUnref(client);\n        return NULL;\n    }\n    client->privateDataFreeFunc = privFree;\n    client->privateDataPreExecRestart = privPreExecRestart;\n\n    return client;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "client"
          ],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "privNew",
          "args": [
            "client",
            "privOpaque"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetServerClientNewInternal",
          "args": [
            "id",
            "sock",
            "auth",
            "auth_pending",
            "tls",
            "readonly",
            "nrequests_max",
            "now"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientNewInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "381-430",
          "snippet": "static virNetServerClientPtr\nvirNetServerClientNewInternal(unsigned long long id,\n                              virNetSocketPtr sock,\n                              int auth,\n                              bool auth_pending,\n                              virNetTLSContextPtr tls,\n                              bool readonly,\n                              size_t nrequests_max,\n                              long long timestamp)\n{\n    virNetServerClientPtr client;\n\n    if (virNetServerClientInitialize() < 0)\n        return NULL;\n\n    if (!(client = virObjectLockableNew(virNetServerClientClass)))\n        return NULL;\n\n    client->id = id;\n    client->sock = virObjectRef(sock);\n    client->auth = auth;\n    client->auth_pending = auth_pending;\n    client->readonly = readonly;\n    client->tlsCtxt = virObjectRef(tls);\n    client->nrequests_max = nrequests_max;\n    client->conn_time = timestamp;\n\n    client->sockTimer = virEventAddTimeout(-1, virNetServerClientSockTimerFunc,\n                                           client, NULL);\n    if (client->sockTimer < 0)\n        goto error;\n\n    /* Prepare one for packet receive */\n    if (!(client->rx = virNetMessageNew(true)))\n        goto error;\n    client->rx->bufferLength = VIR_NET_MESSAGE_LEN_MAX;\n    if (VIR_ALLOC_N(client->rx->buffer, client->rx->bufferLength) < 0)\n        goto error;\n    client->nrequests = 1;\n\n    PROBE(RPC_SERVER_CLIENT_NEW,\n          \"client=%p sock=%p\",\n          client, client->sock);\n\n    return client;\n\n error:\n    virObjectUnref(client);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virNetServerClientClass;",
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic virClassPtr virNetServerClientClass;\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic virNetServerClientPtr\nvirNetServerClientNewInternal(unsigned long long id,\n                              virNetSocketPtr sock,\n                              int auth,\n                              bool auth_pending,\n                              virNetTLSContextPtr tls,\n                              bool readonly,\n                              size_t nrequests_max,\n                              long long timestamp)\n{\n    virNetServerClientPtr client;\n\n    if (virNetServerClientInitialize() < 0)\n        return NULL;\n\n    if (!(client = virObjectLockableNew(virNetServerClientClass)))\n        return NULL;\n\n    client->id = id;\n    client->sock = virObjectRef(sock);\n    client->auth = auth;\n    client->auth_pending = auth_pending;\n    client->readonly = readonly;\n    client->tlsCtxt = virObjectRef(tls);\n    client->nrequests_max = nrequests_max;\n    client->conn_time = timestamp;\n\n    client->sockTimer = virEventAddTimeout(-1, virNetServerClientSockTimerFunc,\n                                           client, NULL);\n    if (client->sockTimer < 0)\n        goto error;\n\n    /* Prepare one for packet receive */\n    if (!(client->rx = virNetMessageNew(true)))\n        goto error;\n    client->rx->bufferLength = VIR_NET_MESSAGE_LEN_MAX;\n    if (VIR_ALLOC_N(client->rx->buffer, client->rx->bufferLength) < 0)\n        goto error;\n    client->nrequests = 1;\n\n    PROBE(RPC_SERVER_CLIENT_NEW,\n          \"client=%p sock=%p\",\n          client, client->sock);\n\n    return client;\n\n error:\n    virObjectUnref(client);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"failed to get current time\")"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to get current time\""
          ],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "NULL"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockJobCleanStorageSourceRuntime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_blockjob.c",
          "lines": "636-647",
          "snippet": "static void\nqemuBlockJobCleanStorageSourceRuntime(virStorageSourcePtr src)\n{\n    src->id = 0;\n    src->detected = false;\n    VIR_FREE(src->relPath);\n    VIR_FREE(src->backingStoreRaw);\n    VIR_FREE(src->nodestorage);\n    VIR_FREE(src->nodeformat);\n    VIR_FREE(src->tlsAlias);\n    VIR_FREE(src->tlsCertdir);\n}",
          "includes": [
            "#include \"qemu_security.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"virtime.h\"",
            "#include \"virthread.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virlog.h\"",
            "#include \"conf/domain_event.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_security.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"locking/domain_lock.h\"\n#include \"virtime.h\"\n#include \"virthread.h\"\n#include \"virstoragefile.h\"\n#include \"virlog.h\"\n#include \"conf/domain_event.h\"\n#include \"conf/domain_conf.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_block.h\"\n#include \"qemu_blockjob.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nqemuBlockJobCleanStorageSourceRuntime(virStorageSourcePtr src)\n{\n    src->id = 0;\n    src->detected = false;\n    VIR_FREE(src->relPath);\n    VIR_FREE(src->backingStoreRaw);\n    VIR_FREE(src->nodestorage);\n    VIR_FREE(src->nodeformat);\n    VIR_FREE(src->tlsAlias);\n    VIR_FREE(src->tlsCertdir);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"sock=%p auth=%d tls=%p\"",
            "sock",
            "auth",
            "tls"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetServerClientAuthMethodImpliesAuthenticated",
          "args": [
            "auth"
          ],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientAuthMethodImpliesAuthenticated",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "374-378",
          "snippet": "static bool\nvirNetServerClientAuthMethodImpliesAuthenticated(int auth)\n{\n    return auth == VIR_NET_SERVER_SERVICE_AUTH_NONE;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool\nvirNetServerClientAuthMethodImpliesAuthenticated(int auth)\n{\n    return auth == VIR_NET_SERVER_SERVICE_AUTH_NONE;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvirNetServerClientPtr virNetServerClientNew(unsigned long long id,\n                                            virNetSocketPtr sock,\n                                            int auth,\n                                            bool readonly,\n                                            size_t nrequests_max,\n                                            virNetTLSContextPtr tls,\n                                            virNetServerClientPrivNew privNew,\n                                            virNetServerClientPrivPreExecRestart privPreExecRestart,\n                                            virFreeCallback privFree,\n                                            void *privOpaque)\n{\n    virNetServerClientPtr client;\n    time_t now;\n    bool auth_pending = !virNetServerClientAuthMethodImpliesAuthenticated(auth);\n\n    VIR_DEBUG(\"sock=%p auth=%d tls=%p\", sock, auth, tls);\n\n    if ((now = time(NULL)) == (time_t)-1) {\n        virReportSystemError(errno, \"%s\", _(\"failed to get current time\"));\n        return NULL;\n    }\n\n    if (!(client = virNetServerClientNewInternal(id, sock, auth, auth_pending,\n                                                 tls, readonly, nrequests_max,\n                                                 now)))\n        return NULL;\n\n    if (!(client->privateData = privNew(client, privOpaque))) {\n        virObjectUnref(client);\n        return NULL;\n    }\n    client->privateDataFreeFunc = privFree;\n    client->privateDataPreExecRestart = privPreExecRestart;\n\n    return client;\n}"
  },
  {
    "function_name": "virNetServerClientNewInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "381-430",
    "snippet": "static virNetServerClientPtr\nvirNetServerClientNewInternal(unsigned long long id,\n                              virNetSocketPtr sock,\n                              int auth,\n                              bool auth_pending,\n                              virNetTLSContextPtr tls,\n                              bool readonly,\n                              size_t nrequests_max,\n                              long long timestamp)\n{\n    virNetServerClientPtr client;\n\n    if (virNetServerClientInitialize() < 0)\n        return NULL;\n\n    if (!(client = virObjectLockableNew(virNetServerClientClass)))\n        return NULL;\n\n    client->id = id;\n    client->sock = virObjectRef(sock);\n    client->auth = auth;\n    client->auth_pending = auth_pending;\n    client->readonly = readonly;\n    client->tlsCtxt = virObjectRef(tls);\n    client->nrequests_max = nrequests_max;\n    client->conn_time = timestamp;\n\n    client->sockTimer = virEventAddTimeout(-1, virNetServerClientSockTimerFunc,\n                                           client, NULL);\n    if (client->sockTimer < 0)\n        goto error;\n\n    /* Prepare one for packet receive */\n    if (!(client->rx = virNetMessageNew(true)))\n        goto error;\n    client->rx->bufferLength = VIR_NET_MESSAGE_LEN_MAX;\n    if (VIR_ALLOC_N(client->rx->buffer, client->rx->bufferLength) < 0)\n        goto error;\n    client->nrequests = 1;\n\n    PROBE(RPC_SERVER_CLIENT_NEW,\n          \"client=%p sock=%p\",\n          client, client->sock);\n\n    return client;\n\n error:\n    virObjectUnref(client);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virNetServerClientClass;",
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "client"
          ],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PROBE",
          "args": [
            "RPC_SERVER_CLIENT_NEW",
            "\"client=%p sock=%p\"",
            "client",
            "client->sock"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "client->rx->buffer",
            "client->rx->bufferLength"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetMessageNew",
          "args": [
            "true"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "virNetMessageNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetmessage.c",
          "lines": "37-48",
          "snippet": "virNetMessagePtr virNetMessageNew(bool tracked)\n{\n    virNetMessagePtr msg;\n\n    if (VIR_ALLOC(msg) < 0)\n        return NULL;\n\n    msg->tracked = tracked;\n    VIR_DEBUG(\"msg=%p tracked=%d\", msg, tracked);\n\n    return msg;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetmessage.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetmessage.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirNetMessagePtr virNetMessageNew(bool tracked)\n{\n    virNetMessagePtr msg;\n\n    if (VIR_ALLOC(msg) < 0)\n        return NULL;\n\n    msg->tracked = tracked;\n    VIR_DEBUG(\"msg=%p tracked=%d\", msg, tracked);\n\n    return msg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virEventAddTimeout",
          "args": [
            "-1",
            "virNetServerClientSockTimerFunc",
            "client",
            "NULL"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "virEventAddTimeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virevent.c",
          "lines": "143-153",
          "snippet": "int\nvirEventAddTimeout(int timeout,\n                   virEventTimeoutCallback cb,\n                   void *opaque,\n                   virFreeCallback ff)\n{\n    if (!addTimeoutImpl)\n        return -1;\n\n    return addTimeoutImpl(timeout, cb, opaque, ff);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vireventglib.h\"",
            "#include \"virevent.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virEventAddTimeoutFunc addTimeoutImpl;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vireventglib.h\"\n#include \"virevent.h\"\n#include <config.h>\n\nstatic virEventAddTimeoutFunc addTimeoutImpl;\n\nint\nvirEventAddTimeout(int timeout,\n                   virEventTimeoutCallback cb,\n                   void *opaque,\n                   virFreeCallback ff)\n{\n    if (!addTimeoutImpl)\n        return -1;\n\n    return addTimeoutImpl(timeout, cb, opaque, ff);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "tls"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virNetServerClientClass"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientInitialize",
          "args": [],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic virClassPtr virNetServerClientClass;\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic virNetServerClientPtr\nvirNetServerClientNewInternal(unsigned long long id,\n                              virNetSocketPtr sock,\n                              int auth,\n                              bool auth_pending,\n                              virNetTLSContextPtr tls,\n                              bool readonly,\n                              size_t nrequests_max,\n                              long long timestamp)\n{\n    virNetServerClientPtr client;\n\n    if (virNetServerClientInitialize() < 0)\n        return NULL;\n\n    if (!(client = virObjectLockableNew(virNetServerClientClass)))\n        return NULL;\n\n    client->id = id;\n    client->sock = virObjectRef(sock);\n    client->auth = auth;\n    client->auth_pending = auth_pending;\n    client->readonly = readonly;\n    client->tlsCtxt = virObjectRef(tls);\n    client->nrequests_max = nrequests_max;\n    client->conn_time = timestamp;\n\n    client->sockTimer = virEventAddTimeout(-1, virNetServerClientSockTimerFunc,\n                                           client, NULL);\n    if (client->sockTimer < 0)\n        goto error;\n\n    /* Prepare one for packet receive */\n    if (!(client->rx = virNetMessageNew(true)))\n        goto error;\n    client->rx->bufferLength = VIR_NET_MESSAGE_LEN_MAX;\n    if (VIR_ALLOC_N(client->rx->buffer, client->rx->bufferLength) < 0)\n        goto error;\n    client->nrequests = 1;\n\n    PROBE(RPC_SERVER_CLIENT_NEW,\n          \"client=%p sock=%p\",\n          client, client->sock);\n\n    return client;\n\n error:\n    virObjectUnref(client);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetServerClientAuthMethodImpliesAuthenticated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "374-378",
    "snippet": "static bool\nvirNetServerClientAuthMethodImpliesAuthenticated(int auth)\n{\n    return auth == VIR_NET_SERVER_SERVICE_AUTH_NONE;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool\nvirNetServerClientAuthMethodImpliesAuthenticated(int auth)\n{\n    return auth == VIR_NET_SERVER_SERVICE_AUTH_NONE;\n}"
  },
  {
    "function_name": "virNetServerClientSockTimerFunc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "346-361",
    "snippet": "static void virNetServerClientSockTimerFunc(int timer,\n                                            void *opaque)\n{\n    virNetServerClientPtr client = opaque;\n    virNetMessagePtr msg = NULL;\n    virObjectLock(client);\n    virEventUpdateTimeout(timer, -1);\n    /* Although client->rx != NULL when this timer is enabled, it might have\n     * changed since the client was unlocked in the meantime. */\n    if (client->rx)\n        msg = virNetServerClientDispatchRead(client);\n    virObjectUnlock(client);\n\n    if (msg)\n        virNetServerClientDispatchMessage(client, msg);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);",
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);",
      "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetServerClientDispatchMessage",
          "args": [
            "client",
            "msg"
          ],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientDispatchMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "327-343",
          "snippet": "static void virNetServerClientDispatchMessage(virNetServerClientPtr client,\n                                              virNetMessagePtr msg)\n{\n    virObjectLock(client);\n    if (!client->dispatchFunc) {\n        virNetMessageFree(msg);\n        client->wantClose = true;\n        virObjectUnlock(client);\n    } else {\n        virObjectUnlock(client);\n        /* Accessing 'client' is safe, because virNetServerClientSetDispatcher\n         * only permits setting 'dispatchFunc' once, so if non-NULL, it will\n         * never change again\n         */\n        client->dispatchFunc(client, msg, client->dispatchOpaque);\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);",
            "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nstatic void virNetServerClientDispatchMessage(virNetServerClientPtr client,\n                                              virNetMessagePtr msg)\n{\n    virObjectLock(client);\n    if (!client->dispatchFunc) {\n        virNetMessageFree(msg);\n        client->wantClose = true;\n        virObjectUnlock(client);\n    } else {\n        virObjectUnlock(client);\n        /* Accessing 'client' is safe, because virNetServerClientSetDispatcher\n         * only permits setting 'dispatchFunc' once, so if non-NULL, it will\n         * never change again\n         */\n        client->dispatchFunc(client, msg, client->dispatchOpaque);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientDispatchRead",
          "args": [
            "client"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientDispatchRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "1189-1321",
          "snippet": "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client)\n{\n readmore:\n    if (client->rx->nfds == 0) {\n        if (virNetServerClientRead(client) < 0) {\n            client->wantClose = true;\n            return NULL; /* Error */\n        }\n    }\n\n    if (client->rx->bufferOffset < client->rx->bufferLength)\n        return NULL; /* Still not read enough */\n\n    /* Either done with length word header */\n    if (client->rx->bufferLength == VIR_NET_MESSAGE_LEN_MAX) {\n        if (virNetMessageDecodeLength(client->rx) < 0) {\n            client->wantClose = true;\n            return NULL;\n        }\n\n        virNetServerClientUpdateEvent(client);\n\n        /* Try and read payload immediately instead of going back\n           into poll() because chances are the data is already\n           waiting for us */\n        goto readmore;\n    } else {\n        /* Grab the completed message */\n        virNetMessagePtr msg = client->rx;\n        virNetMessagePtr response = NULL;\n        virNetServerClientFilterPtr filter;\n        size_t i;\n\n        /* Decode the header so we can use it for routing decisions */\n        if (virNetMessageDecodeHeader(msg) < 0) {\n            virNetMessageQueueServe(&client->rx);\n            virNetMessageFree(msg);\n            client->wantClose = true;\n            return NULL;\n        }\n\n        /* Now figure out if we need to read more data to get some\n         * file descriptors */\n        if (msg->header.type == VIR_NET_CALL_WITH_FDS) {\n            if (virNetMessageDecodeNumFDs(msg) < 0) {\n                virNetMessageQueueServe(&client->rx);\n                virNetMessageFree(msg);\n                client->wantClose = true;\n                return NULL; /* Error */\n            }\n\n            /* Try getting the file descriptors (may fail if blocking) */\n            for (i = msg->donefds; i < msg->nfds; i++) {\n                int rv;\n                if ((rv = virNetSocketRecvFD(client->sock, &(msg->fds[i]))) < 0) {\n                    virNetMessageQueueServe(&client->rx);\n                    virNetMessageFree(msg);\n                    client->wantClose = true;\n                    return NULL;\n                }\n                if (rv == 0) /* Blocking */\n                    break;\n                msg->donefds++;\n            }\n\n            /* Need to poll() until FDs arrive */\n            if (msg->donefds < msg->nfds) {\n                /* Because DecodeHeader/NumFDs reset bufferOffset, we\n                 * put it back to what it was, so everything works\n                 * again next time we run this method\n                 */\n                client->rx->bufferOffset = client->rx->bufferLength;\n                return NULL;\n            }\n        }\n\n        /* Definitely finished reading, so remove from queue */\n        virNetMessageQueueServe(&client->rx);\n        PROBE(RPC_SERVER_CLIENT_MSG_RX,\n              \"client=%p len=%zu prog=%u vers=%u proc=%u type=%u status=%u serial=%u\",\n              client, msg->bufferLength,\n              msg->header.prog, msg->header.vers, msg->header.proc,\n              msg->header.type, msg->header.status, msg->header.serial);\n\n        if (virKeepAliveCheckMessage(client->keepalive, msg, &response)) {\n            virNetMessageFree(msg);\n            client->nrequests--;\n            msg = NULL;\n\n            if (response &&\n                virNetServerClientSendMessageLocked(client, response) < 0)\n                virNetMessageFree(response);\n        }\n\n        /* Maybe send off for queue against a filter */\n        if (msg) {\n            filter = client->filters;\n            while (filter) {\n                int ret = filter->func(client, msg, filter->opaque);\n                if (ret < 0) {\n                    virNetMessageFree(msg);\n                    msg = NULL;\n                    client->wantClose = true;\n                    break;\n                }\n                if (ret > 0) {\n                    msg = NULL;\n                    break;\n                }\n\n                filter = filter->next;\n            }\n        }\n\n        /* Possibly need to create another receive buffer */\n        if (client->nrequests < client->nrequests_max) {\n            if (!(client->rx = virNetMessageNew(true))) {\n                client->wantClose = true;\n            } else {\n                client->rx->bufferLength = VIR_NET_MESSAGE_LEN_MAX;\n                if (VIR_ALLOC_N(client->rx->buffer,\n                                client->rx->bufferLength) < 0) {\n                    client->wantClose = true;\n                } else {\n                    client->nrequests++;\n                }\n            }\n        }\n        virNetServerClientUpdateEvent(client);\n\n        return msg;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);",
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);",
            "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client)\n{\n readmore:\n    if (client->rx->nfds == 0) {\n        if (virNetServerClientRead(client) < 0) {\n            client->wantClose = true;\n            return NULL; /* Error */\n        }\n    }\n\n    if (client->rx->bufferOffset < client->rx->bufferLength)\n        return NULL; /* Still not read enough */\n\n    /* Either done with length word header */\n    if (client->rx->bufferLength == VIR_NET_MESSAGE_LEN_MAX) {\n        if (virNetMessageDecodeLength(client->rx) < 0) {\n            client->wantClose = true;\n            return NULL;\n        }\n\n        virNetServerClientUpdateEvent(client);\n\n        /* Try and read payload immediately instead of going back\n           into poll() because chances are the data is already\n           waiting for us */\n        goto readmore;\n    } else {\n        /* Grab the completed message */\n        virNetMessagePtr msg = client->rx;\n        virNetMessagePtr response = NULL;\n        virNetServerClientFilterPtr filter;\n        size_t i;\n\n        /* Decode the header so we can use it for routing decisions */\n        if (virNetMessageDecodeHeader(msg) < 0) {\n            virNetMessageQueueServe(&client->rx);\n            virNetMessageFree(msg);\n            client->wantClose = true;\n            return NULL;\n        }\n\n        /* Now figure out if we need to read more data to get some\n         * file descriptors */\n        if (msg->header.type == VIR_NET_CALL_WITH_FDS) {\n            if (virNetMessageDecodeNumFDs(msg) < 0) {\n                virNetMessageQueueServe(&client->rx);\n                virNetMessageFree(msg);\n                client->wantClose = true;\n                return NULL; /* Error */\n            }\n\n            /* Try getting the file descriptors (may fail if blocking) */\n            for (i = msg->donefds; i < msg->nfds; i++) {\n                int rv;\n                if ((rv = virNetSocketRecvFD(client->sock, &(msg->fds[i]))) < 0) {\n                    virNetMessageQueueServe(&client->rx);\n                    virNetMessageFree(msg);\n                    client->wantClose = true;\n                    return NULL;\n                }\n                if (rv == 0) /* Blocking */\n                    break;\n                msg->donefds++;\n            }\n\n            /* Need to poll() until FDs arrive */\n            if (msg->donefds < msg->nfds) {\n                /* Because DecodeHeader/NumFDs reset bufferOffset, we\n                 * put it back to what it was, so everything works\n                 * again next time we run this method\n                 */\n                client->rx->bufferOffset = client->rx->bufferLength;\n                return NULL;\n            }\n        }\n\n        /* Definitely finished reading, so remove from queue */\n        virNetMessageQueueServe(&client->rx);\n        PROBE(RPC_SERVER_CLIENT_MSG_RX,\n              \"client=%p len=%zu prog=%u vers=%u proc=%u type=%u status=%u serial=%u\",\n              client, msg->bufferLength,\n              msg->header.prog, msg->header.vers, msg->header.proc,\n              msg->header.type, msg->header.status, msg->header.serial);\n\n        if (virKeepAliveCheckMessage(client->keepalive, msg, &response)) {\n            virNetMessageFree(msg);\n            client->nrequests--;\n            msg = NULL;\n\n            if (response &&\n                virNetServerClientSendMessageLocked(client, response) < 0)\n                virNetMessageFree(response);\n        }\n\n        /* Maybe send off for queue against a filter */\n        if (msg) {\n            filter = client->filters;\n            while (filter) {\n                int ret = filter->func(client, msg, filter->opaque);\n                if (ret < 0) {\n                    virNetMessageFree(msg);\n                    msg = NULL;\n                    client->wantClose = true;\n                    break;\n                }\n                if (ret > 0) {\n                    msg = NULL;\n                    break;\n                }\n\n                filter = filter->next;\n            }\n        }\n\n        /* Possibly need to create another receive buffer */\n        if (client->nrequests < client->nrequests_max) {\n            if (!(client->rx = virNetMessageNew(true))) {\n                client->wantClose = true;\n            } else {\n                client->rx->bufferLength = VIR_NET_MESSAGE_LEN_MAX;\n                if (VIR_ALLOC_N(client->rx->buffer,\n                                client->rx->bufferLength) < 0) {\n                    client->wantClose = true;\n                } else {\n                    client->nrequests++;\n                }\n            }\n        }\n        virNetServerClientUpdateEvent(client);\n\n        return msg;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virEventUpdateTimeout",
          "args": [
            "timer",
            "-1"
          ],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "virEventUpdateTimeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virevent.c",
          "lines": "170-175",
          "snippet": "void\nvirEventUpdateTimeout(int timer, int timeout)\n{\n    if (updateTimeoutImpl)\n        updateTimeoutImpl(timer, timeout);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vireventglib.h\"",
            "#include \"virevent.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virEventUpdateTimeoutFunc updateTimeoutImpl;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vireventglib.h\"\n#include \"virevent.h\"\n#include <config.h>\n\nstatic virEventUpdateTimeoutFunc updateTimeoutImpl;\n\nvoid\nvirEventUpdateTimeout(int timer, int timeout)\n{\n    if (updateTimeoutImpl)\n        updateTimeoutImpl(timer, timeout);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nstatic void virNetServerClientSockTimerFunc(int timer,\n                                            void *opaque)\n{\n    virNetServerClientPtr client = opaque;\n    virNetMessagePtr msg = NULL;\n    virObjectLock(client);\n    virEventUpdateTimeout(timer, -1);\n    /* Although client->rx != NULL when this timer is enabled, it might have\n     * changed since the client was unlocked in the meantime. */\n    if (client->rx)\n        msg = virNetServerClientDispatchRead(client);\n    virObjectUnlock(client);\n\n    if (msg)\n        virNetServerClientDispatchMessage(client, msg);\n}"
  },
  {
    "function_name": "virNetServerClientDispatchMessage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "327-343",
    "snippet": "static void virNetServerClientDispatchMessage(virNetServerClientPtr client,\n                                              virNetMessagePtr msg)\n{\n    virObjectLock(client);\n    if (!client->dispatchFunc) {\n        virNetMessageFree(msg);\n        client->wantClose = true;\n        virObjectUnlock(client);\n    } else {\n        virObjectUnlock(client);\n        /* Accessing 'client' is safe, because virNetServerClientSetDispatcher\n         * only permits setting 'dispatchFunc' once, so if non-NULL, it will\n         * never change again\n         */\n        client->dispatchFunc(client, msg, client->dispatchOpaque);\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);",
      "static int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "client->dispatchFunc",
          "args": [
            "client",
            "msg",
            "client->dispatchOpaque"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetMessageFree",
          "args": [
            "msg"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "virNetMessageFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetmessage.c",
          "lines": "81-93",
          "snippet": "void virNetMessageFree(virNetMessagePtr msg)\n{\n    if (!msg)\n        return;\n\n    VIR_DEBUG(\"msg=%p nfds=%zu cb=%p\", msg, msg->nfds, msg->cb);\n\n    if (msg->cb)\n        msg->cb(msg, msg->opaque);\n\n    virNetMessageClearPayload(msg);\n    VIR_FREE(msg);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetmessage.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetmessage.h\"\n#include <unistd.h>\n#include <config.h>\n\nvoid virNetMessageFree(virNetMessagePtr msg)\n{\n    if (!msg)\n        return;\n\n    VIR_DEBUG(\"msg=%p nfds=%zu cb=%p\", msg, msg->nfds, msg->cb);\n\n    if (msg->cb)\n        msg->cb(msg, msg->opaque);\n\n    virNetMessageClearPayload(msg);\n    VIR_FREE(msg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\nstatic int virNetServerClientSendMessageLocked(virNetServerClientPtr client,\n                                               virNetMessagePtr msg);\n\nstatic void virNetServerClientDispatchMessage(virNetServerClientPtr client,\n                                              virNetMessagePtr msg)\n{\n    virObjectLock(client);\n    if (!client->dispatchFunc) {\n        virNetMessageFree(msg);\n        client->wantClose = true;\n        virObjectUnlock(client);\n    } else {\n        virObjectUnlock(client);\n        /* Accessing 'client' is safe, because virNetServerClientSetDispatcher\n         * only permits setting 'dispatchFunc' once, so if non-NULL, it will\n         * never change again\n         */\n        client->dispatchFunc(client, msg, client->dispatchOpaque);\n    }\n}"
  },
  {
    "function_name": "virNetServerClientCheckAccess",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "292-324",
    "snippet": "static int\nvirNetServerClientCheckAccess(virNetServerClientPtr client)\n{\n    virNetMessagePtr confirm;\n\n    /* Verify client certificate. */\n    if (virNetTLSContextCheckCertificate(client->tlsCtxt, client->tls) < 0)\n        return -1;\n\n    if (client->tx) {\n        VIR_DEBUG(\"client had unexpected data pending tx after access check\");\n        return -1;\n    }\n\n    if (!(confirm = virNetMessageNew(false)))\n        return -1;\n\n    /* Checks have succeeded.  Write a '\\1' byte back to the client to\n     * indicate this (otherwise the socket is abruptly closed).\n     * (NB. The '\\1' byte is sent in an encrypted record).\n     */\n    confirm->bufferLength = 1;\n    if (VIR_ALLOC_N(confirm->buffer, confirm->bufferLength) < 0) {\n        virNetMessageFree(confirm);\n        return -1;\n    }\n    confirm->bufferOffset = 0;\n    confirm->buffer[0] = '\\1';\n\n    client->tx = confirm;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetMessageFree",
          "args": [
            "confirm"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "virNetMessageFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetmessage.c",
          "lines": "81-93",
          "snippet": "void virNetMessageFree(virNetMessagePtr msg)\n{\n    if (!msg)\n        return;\n\n    VIR_DEBUG(\"msg=%p nfds=%zu cb=%p\", msg, msg->nfds, msg->cb);\n\n    if (msg->cb)\n        msg->cb(msg, msg->opaque);\n\n    virNetMessageClearPayload(msg);\n    VIR_FREE(msg);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetmessage.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetmessage.h\"\n#include <unistd.h>\n#include <config.h>\n\nvoid virNetMessageFree(virNetMessagePtr msg)\n{\n    if (!msg)\n        return;\n\n    VIR_DEBUG(\"msg=%p nfds=%zu cb=%p\", msg, msg->nfds, msg->cb);\n\n    if (msg->cb)\n        msg->cb(msg, msg->opaque);\n\n    virNetMessageClearPayload(msg);\n    VIR_FREE(msg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "confirm->buffer",
            "confirm->bufferLength"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetMessageNew",
          "args": [
            "false"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "virNetMessageNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetmessage.c",
          "lines": "37-48",
          "snippet": "virNetMessagePtr virNetMessageNew(bool tracked)\n{\n    virNetMessagePtr msg;\n\n    if (VIR_ALLOC(msg) < 0)\n        return NULL;\n\n    msg->tracked = tracked;\n    VIR_DEBUG(\"msg=%p tracked=%d\", msg, tracked);\n\n    return msg;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetmessage.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetmessage.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirNetMessagePtr virNetMessageNew(bool tracked)\n{\n    virNetMessagePtr msg;\n\n    if (VIR_ALLOC(msg) < 0)\n        return NULL;\n\n    msg->tracked = tracked;\n    VIR_DEBUG(\"msg=%p tracked=%d\", msg, tracked);\n\n    return msg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"client had unexpected data pending tx after access check\""
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetTLSContextCheckCertificate",
          "args": [
            "client->tlsCtxt",
            "client->tls"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "virNetTLSContextCheckCertificate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnettlscontext.c",
          "lines": "1120-1145",
          "snippet": "int virNetTLSContextCheckCertificate(virNetTLSContextPtr ctxt,\n                                     virNetTLSSessionPtr sess)\n{\n    int ret = -1;\n\n    virObjectLock(ctxt);\n    virObjectLock(sess);\n    if (virNetTLSContextValidCertificate(ctxt, sess) < 0) {\n        VIR_WARN(\"Certificate check failed %s\", virGetLastErrorMessage());\n        if (ctxt->requireValidCert) {\n            virReportError(VIR_ERR_AUTH_FAILED, \"%s\",\n                           _(\"Failed to verify peer's certificate\"));\n            goto cleanup;\n        }\n        virResetLastError();\n        VIR_INFO(\"Ignoring bad certificate at user request\");\n    }\n\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(ctxt);\n    virObjectUnlock(sess);\n\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virthread.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virnettlscontext.h\"",
            "#include <gnutls/x509.h>",
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virthread.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virnettlscontext.h\"\n#include <gnutls/x509.h>\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <unistd.h>\n#include <config.h>\n\nint virNetTLSContextCheckCertificate(virNetTLSContextPtr ctxt,\n                                     virNetTLSSessionPtr sess)\n{\n    int ret = -1;\n\n    virObjectLock(ctxt);\n    virObjectLock(sess);\n    if (virNetTLSContextValidCertificate(ctxt, sess) < 0) {\n        VIR_WARN(\"Certificate check failed %s\", virGetLastErrorMessage());\n        if (ctxt->requireValidCert) {\n            virReportError(VIR_ERR_AUTH_FAILED, \"%s\",\n                           _(\"Failed to verify peer's certificate\"));\n            goto cleanup;\n        }\n        virResetLastError();\n        VIR_INFO(\"Ignoring bad certificate at user request\");\n    }\n\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(ctxt);\n    virObjectUnlock(sess);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic int\nvirNetServerClientCheckAccess(virNetServerClientPtr client)\n{\n    virNetMessagePtr confirm;\n\n    /* Verify client certificate. */\n    if (virNetTLSContextCheckCertificate(client->tlsCtxt, client->tls) < 0)\n        return -1;\n\n    if (client->tx) {\n        VIR_DEBUG(\"client had unexpected data pending tx after access check\");\n        return -1;\n    }\n\n    if (!(confirm = virNetMessageNew(false)))\n        return -1;\n\n    /* Checks have succeeded.  Write a '\\1' byte back to the client to\n     * indicate this (otherwise the socket is abruptly closed).\n     * (NB. The '\\1' byte is sent in an encrypted record).\n     */\n    confirm->bufferLength = 1;\n    if (VIR_ALLOC_N(confirm->buffer, confirm->bufferLength) < 0) {\n        virNetMessageFree(confirm);\n        return -1;\n    }\n    confirm->bufferOffset = 0;\n    confirm->buffer[0] = '\\1';\n\n    client->tx = confirm;\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetServerClientRemoveFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "264-288",
    "snippet": "void virNetServerClientRemoveFilter(virNetServerClientPtr client,\n                                    int filterID)\n{\n    virNetServerClientFilterPtr tmp, prev;\n\n    virObjectLock(client);\n\n    prev = NULL;\n    tmp = client->filters;\n    while (tmp) {\n        if (tmp->id == filterID) {\n            if (prev)\n                prev->next = tmp->next;\n            else\n                client->filters = tmp->next;\n\n            VIR_FREE(tmp);\n            break;\n        }\n        prev = tmp;\n        tmp = tmp->next;\n    }\n\n    virObjectUnlock(client);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvoid virNetServerClientRemoveFilter(virNetServerClientPtr client,\n                                    int filterID)\n{\n    virNetServerClientFilterPtr tmp, prev;\n\n    virObjectLock(client);\n\n    prev = NULL;\n    tmp = client->filters;\n    while (tmp) {\n        if (tmp->id == filterID) {\n            if (prev)\n                prev->next = tmp->next;\n            else\n                client->filters = tmp->next;\n\n            VIR_FREE(tmp);\n            break;\n        }\n        prev = tmp;\n        tmp = tmp->next;\n    }\n\n    virObjectUnlock(client);\n}"
  },
  {
    "function_name": "virNetServerClientAddFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "235-262",
    "snippet": "int virNetServerClientAddFilter(virNetServerClientPtr client,\n                                virNetServerClientFilterFunc func,\n                                void *opaque)\n{\n    virNetServerClientFilterPtr filter;\n    virNetServerClientFilterPtr *place;\n    int ret;\n\n    if (VIR_ALLOC(filter) < 0)\n        return -1;\n\n    virObjectLock(client);\n\n    filter->id = client->nextFilterID++;\n    filter->func = func;\n    filter->opaque = opaque;\n\n    place = &client->filters;\n    while (*place)\n        place = &(*place)->next;\n    *place = filter;\n\n    ret = filter->id;\n\n    virObjectUnlock(client);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);",
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "client"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "client"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "filter"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientDispatchEvent(virNetSocketPtr sock, int events, void *opaque);\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nint virNetServerClientAddFilter(virNetServerClientPtr client,\n                                virNetServerClientFilterFunc func,\n                                void *opaque)\n{\n    virNetServerClientFilterPtr filter;\n    virNetServerClientFilterPtr *place;\n    int ret;\n\n    if (VIR_ALLOC(filter) < 0)\n        return -1;\n\n    virObjectLock(client);\n\n    filter->id = client->nextFilterID++;\n    filter->func = func;\n    filter->opaque = opaque;\n\n    place = &client->filters;\n    while (*place)\n        place = &(*place)->next;\n    *place = filter;\n\n    ret = filter->id;\n\n    virObjectUnlock(client);\n\n    return ret;\n}"
  },
  {
    "function_name": "virNetServerClientUpdateEvent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "219-232",
    "snippet": "static void virNetServerClientUpdateEvent(virNetServerClientPtr client)\n{\n    int mode;\n\n    if (!client->sock)\n        return;\n\n    mode = virNetServerClientCalculateHandleMode(client);\n\n    virNetSocketUpdateIOCallback(client->sock, mode);\n\n    if (client->rx && virNetSocketHasCachedData(client->sock))\n        virEventUpdateTimeout(client->sockTimer, 0);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virEventUpdateTimeout",
          "args": [
            "client->sockTimer",
            "0"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "virEventUpdateTimeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virevent.c",
          "lines": "170-175",
          "snippet": "void\nvirEventUpdateTimeout(int timer, int timeout)\n{\n    if (updateTimeoutImpl)\n        updateTimeoutImpl(timer, timeout);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vireventglib.h\"",
            "#include \"virevent.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virEventUpdateTimeoutFunc updateTimeoutImpl;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vireventglib.h\"\n#include \"virevent.h\"\n#include <config.h>\n\nstatic virEventUpdateTimeoutFunc updateTimeoutImpl;\n\nvoid\nvirEventUpdateTimeout(int timer, int timeout)\n{\n    if (updateTimeoutImpl)\n        updateTimeoutImpl(timer, timeout);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketHasCachedData",
          "args": [
            "client->sock"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketHasCachedData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "1701-1722",
          "snippet": "bool virNetSocketHasCachedData(virNetSocketPtr sock G_GNUC_UNUSED)\n{\n    bool hasCached = false;\n    virObjectLock(sock);\n\n#if WITH_SSH2\n    if (virNetSSHSessionHasCachedData(sock->sshSession))\n        hasCached = true;\n#endif\n\n#if WITH_LIBSSH\n    if (virNetLibsshSessionHasCachedData(sock->libsshSession))\n        hasCached = true;\n#endif\n\n#if WITH_SASL\n    if (sock->saslDecoded)\n        hasCached = true;\n#endif\n    virObjectUnlock(sock);\n    return hasCached;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nbool virNetSocketHasCachedData(virNetSocketPtr sock G_GNUC_UNUSED)\n{\n    bool hasCached = false;\n    virObjectLock(sock);\n\n#if WITH_SSH2\n    if (virNetSSHSessionHasCachedData(sock->sshSession))\n        hasCached = true;\n#endif\n\n#if WITH_LIBSSH\n    if (virNetLibsshSessionHasCachedData(sock->libsshSession))\n        hasCached = true;\n#endif\n\n#if WITH_SASL\n    if (sock->saslDecoded)\n        hasCached = true;\n#endif\n    virObjectUnlock(sock);\n    return hasCached;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketUpdateIOCallback",
          "args": [
            "client->sock",
            "mode"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketUpdateIOCallback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "2222-2235",
          "snippet": "void virNetSocketUpdateIOCallback(virNetSocketPtr sock,\n                                  int events)\n{\n    virObjectLock(sock);\n    if (sock->watch < 0) {\n        VIR_DEBUG(\"Watch not registered on socket %p\", sock);\n        virObjectUnlock(sock);\n        return;\n    }\n\n    virEventUpdateHandle(sock->watch, events);\n\n    virObjectUnlock(sock);\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid virNetSocketUpdateIOCallback(virNetSocketPtr sock,\n                                  int events)\n{\n    virObjectLock(sock);\n    if (sock->watch < 0) {\n        VIR_DEBUG(\"Watch not registered on socket %p\", sock);\n        virObjectUnlock(sock);\n        return;\n    }\n\n    virEventUpdateHandle(sock->watch, events);\n\n    virObjectUnlock(sock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientCalculateHandleMode",
          "args": [
            "client"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientCalculateHandleMode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "146-189",
          "snippet": "static int\nvirNetServerClientCalculateHandleMode(virNetServerClientPtr client)\n{\n    int mode = 0;\n\n\n    VIR_DEBUG(\"tls=%p hs=%d, rx=%p tx=%p\",\n              client->tls,\n              client->tls ? virNetTLSSessionGetHandshakeStatus(client->tls) : -1,\n              client->rx,\n              client->tx);\n    if (!client->sock || client->wantClose)\n        return 0;\n\n    if (client->tls) {\n        switch (virNetTLSSessionGetHandshakeStatus(client->tls)) {\n        case VIR_NET_TLS_HANDSHAKE_RECVING:\n            mode |= VIR_EVENT_HANDLE_READABLE;\n            break;\n        case VIR_NET_TLS_HANDSHAKE_SENDING:\n            mode |= VIR_EVENT_HANDLE_WRITABLE;\n            break;\n        default:\n        case VIR_NET_TLS_HANDSHAKE_COMPLETE:\n            if (client->rx)\n                mode |= VIR_EVENT_HANDLE_READABLE;\n            if (client->tx)\n                mode |= VIR_EVENT_HANDLE_WRITABLE;\n        }\n    } else {\n        /* If there is a message on the rx queue, and\n         * we're not in middle of a delayedClose, then\n         * we're wanting more input */\n        if (client->rx && !client->delayedClose)\n            mode |= VIR_EVENT_HANDLE_READABLE;\n\n        /* If there are one or more messages to send back to client,\n           then monitor for writability on socket */\n        if (client->tx)\n            mode |= VIR_EVENT_HANDLE_WRITABLE;\n    }\n    VIR_DEBUG(\"mode=0%o\", mode);\n    return mode;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic int\nvirNetServerClientCalculateHandleMode(virNetServerClientPtr client)\n{\n    int mode = 0;\n\n\n    VIR_DEBUG(\"tls=%p hs=%d, rx=%p tx=%p\",\n              client->tls,\n              client->tls ? virNetTLSSessionGetHandshakeStatus(client->tls) : -1,\n              client->rx,\n              client->tx);\n    if (!client->sock || client->wantClose)\n        return 0;\n\n    if (client->tls) {\n        switch (virNetTLSSessionGetHandshakeStatus(client->tls)) {\n        case VIR_NET_TLS_HANDSHAKE_RECVING:\n            mode |= VIR_EVENT_HANDLE_READABLE;\n            break;\n        case VIR_NET_TLS_HANDSHAKE_SENDING:\n            mode |= VIR_EVENT_HANDLE_WRITABLE;\n            break;\n        default:\n        case VIR_NET_TLS_HANDSHAKE_COMPLETE:\n            if (client->rx)\n                mode |= VIR_EVENT_HANDLE_READABLE;\n            if (client->tx)\n                mode |= VIR_EVENT_HANDLE_WRITABLE;\n        }\n    } else {\n        /* If there is a message on the rx queue, and\n         * we're not in middle of a delayedClose, then\n         * we're wanting more input */\n        if (client->rx && !client->delayedClose)\n            mode |= VIR_EVENT_HANDLE_READABLE;\n\n        /* If there are one or more messages to send back to client,\n           then monitor for writability on socket */\n        if (client->tx)\n            mode |= VIR_EVENT_HANDLE_WRITABLE;\n    }\n    VIR_DEBUG(\"mode=0%o\", mode);\n    return mode;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client)\n{\n    int mode;\n\n    if (!client->sock)\n        return;\n\n    mode = virNetServerClientCalculateHandleMode(client);\n\n    virNetSocketUpdateIOCallback(client->sock, mode);\n\n    if (client->rx && virNetSocketHasCachedData(client->sock))\n        virEventUpdateTimeout(client->sockTimer, 0);\n}"
  },
  {
    "function_name": "virNetServerClientRegisterEvent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "195-214",
    "snippet": "static int virNetServerClientRegisterEvent(virNetServerClientPtr client)\n{\n    int mode = virNetServerClientCalculateHandleMode(client);\n\n    if (!client->sock)\n        return -1;\n\n    virObjectRef(client);\n    VIR_DEBUG(\"Registering client event callback %d\", mode);\n    if (virNetSocketAddIOCallback(client->sock,\n                                  mode,\n                                  virNetServerClientDispatchEvent,\n                                  client,\n                                  virObjectFreeCallback) < 0) {\n        virObjectUnref(client);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "client"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSocketAddIOCallback",
          "args": [
            "client->sock",
            "mode",
            "virNetServerClientDispatchEvent",
            "client",
            "virObjectFreeCallback"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSocketAddIOCallback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsocket.c",
          "lines": "2186-2220",
          "snippet": "int virNetSocketAddIOCallback(virNetSocketPtr sock,\n                              int events,\n                              virNetSocketIOFunc func,\n                              void *opaque,\n                              virFreeCallback ff)\n{\n    int ret = -1;\n\n    virObjectRef(sock);\n    virObjectLock(sock);\n    if (sock->watch >= 0) {\n        VIR_DEBUG(\"Watch already registered on socket %p\", sock);\n        goto cleanup;\n    }\n\n    if ((sock->watch = virEventAddHandle(sock->fd,\n                                         events,\n                                         virNetSocketEventHandle,\n                                         sock,\n                                         virNetSocketEventFree)) < 0) {\n        VIR_DEBUG(\"Failed to register watch on socket %p\", sock);\n        goto cleanup;\n    }\n    sock->func = func;\n    sock->opaque = opaque;\n    sock->ff = ff;\n\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(sock);\n    if (ret != 0)\n        virObjectUnref(sock);\n    return ret;\n}",
          "includes": [
            "# include \"virnetlibsshsession.h\"",
            "# include \"virnetsshsession.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virprobe.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virsocket.h\"",
            "# include <selinux/selinux.h>",
            "# include <sys/ucred.h>",
            "# include <ifaddrs.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virnetlibsshsession.h\"\n# include \"virnetsshsession.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virprobe.h\"\n#include \"virpidfile.h\"\n#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"virnetsocket.h\"\n#include \"virsocket.h\"\n# include <selinux/selinux.h>\n# include <sys/ucred.h>\n# include <ifaddrs.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nint virNetSocketAddIOCallback(virNetSocketPtr sock,\n                              int events,\n                              virNetSocketIOFunc func,\n                              void *opaque,\n                              virFreeCallback ff)\n{\n    int ret = -1;\n\n    virObjectRef(sock);\n    virObjectLock(sock);\n    if (sock->watch >= 0) {\n        VIR_DEBUG(\"Watch already registered on socket %p\", sock);\n        goto cleanup;\n    }\n\n    if ((sock->watch = virEventAddHandle(sock->fd,\n                                         events,\n                                         virNetSocketEventHandle,\n                                         sock,\n                                         virNetSocketEventFree)) < 0) {\n        VIR_DEBUG(\"Failed to register watch on socket %p\", sock);\n        goto cleanup;\n    }\n    sock->func = func;\n    sock->opaque = opaque;\n    sock->ff = ff;\n\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(sock);\n    if (ret != 0)\n        virObjectUnref(sock);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Registering client event callback %d\"",
            "mode"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "client"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientCalculateHandleMode",
          "args": [
            "client"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientCalculateHandleMode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "146-189",
          "snippet": "static int\nvirNetServerClientCalculateHandleMode(virNetServerClientPtr client)\n{\n    int mode = 0;\n\n\n    VIR_DEBUG(\"tls=%p hs=%d, rx=%p tx=%p\",\n              client->tls,\n              client->tls ? virNetTLSSessionGetHandshakeStatus(client->tls) : -1,\n              client->rx,\n              client->tx);\n    if (!client->sock || client->wantClose)\n        return 0;\n\n    if (client->tls) {\n        switch (virNetTLSSessionGetHandshakeStatus(client->tls)) {\n        case VIR_NET_TLS_HANDSHAKE_RECVING:\n            mode |= VIR_EVENT_HANDLE_READABLE;\n            break;\n        case VIR_NET_TLS_HANDSHAKE_SENDING:\n            mode |= VIR_EVENT_HANDLE_WRITABLE;\n            break;\n        default:\n        case VIR_NET_TLS_HANDSHAKE_COMPLETE:\n            if (client->rx)\n                mode |= VIR_EVENT_HANDLE_READABLE;\n            if (client->tx)\n                mode |= VIR_EVENT_HANDLE_WRITABLE;\n        }\n    } else {\n        /* If there is a message on the rx queue, and\n         * we're not in middle of a delayedClose, then\n         * we're wanting more input */\n        if (client->rx && !client->delayedClose)\n            mode |= VIR_EVENT_HANDLE_READABLE;\n\n        /* If there are one or more messages to send back to client,\n           then monitor for writability on socket */\n        if (client->tx)\n            mode |= VIR_EVENT_HANDLE_WRITABLE;\n    }\n    VIR_DEBUG(\"mode=0%o\", mode);\n    return mode;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic int\nvirNetServerClientCalculateHandleMode(virNetServerClientPtr client)\n{\n    int mode = 0;\n\n\n    VIR_DEBUG(\"tls=%p hs=%d, rx=%p tx=%p\",\n              client->tls,\n              client->tls ? virNetTLSSessionGetHandshakeStatus(client->tls) : -1,\n              client->rx,\n              client->tx);\n    if (!client->sock || client->wantClose)\n        return 0;\n\n    if (client->tls) {\n        switch (virNetTLSSessionGetHandshakeStatus(client->tls)) {\n        case VIR_NET_TLS_HANDSHAKE_RECVING:\n            mode |= VIR_EVENT_HANDLE_READABLE;\n            break;\n        case VIR_NET_TLS_HANDSHAKE_SENDING:\n            mode |= VIR_EVENT_HANDLE_WRITABLE;\n            break;\n        default:\n        case VIR_NET_TLS_HANDSHAKE_COMPLETE:\n            if (client->rx)\n                mode |= VIR_EVENT_HANDLE_READABLE;\n            if (client->tx)\n                mode |= VIR_EVENT_HANDLE_WRITABLE;\n        }\n    } else {\n        /* If there is a message on the rx queue, and\n         * we're not in middle of a delayedClose, then\n         * we're wanting more input */\n        if (client->rx && !client->delayedClose)\n            mode |= VIR_EVENT_HANDLE_READABLE;\n\n        /* If there are one or more messages to send back to client,\n           then monitor for writability on socket */\n        if (client->tx)\n            mode |= VIR_EVENT_HANDLE_WRITABLE;\n    }\n    VIR_DEBUG(\"mode=0%o\", mode);\n    return mode;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic int virNetServerClientRegisterEvent(virNetServerClientPtr client)\n{\n    int mode = virNetServerClientCalculateHandleMode(client);\n\n    if (!client->sock)\n        return -1;\n\n    virObjectRef(client);\n    VIR_DEBUG(\"Registering client event callback %d\", mode);\n    if (virNetSocketAddIOCallback(client->sock,\n                                  mode,\n                                  virNetServerClientDispatchEvent,\n                                  client,\n                                  virObjectFreeCallback) < 0) {\n        virObjectUnref(client);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetServerClientCalculateHandleMode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "146-189",
    "snippet": "static int\nvirNetServerClientCalculateHandleMode(virNetServerClientPtr client)\n{\n    int mode = 0;\n\n\n    VIR_DEBUG(\"tls=%p hs=%d, rx=%p tx=%p\",\n              client->tls,\n              client->tls ? virNetTLSSessionGetHandshakeStatus(client->tls) : -1,\n              client->rx,\n              client->tx);\n    if (!client->sock || client->wantClose)\n        return 0;\n\n    if (client->tls) {\n        switch (virNetTLSSessionGetHandshakeStatus(client->tls)) {\n        case VIR_NET_TLS_HANDSHAKE_RECVING:\n            mode |= VIR_EVENT_HANDLE_READABLE;\n            break;\n        case VIR_NET_TLS_HANDSHAKE_SENDING:\n            mode |= VIR_EVENT_HANDLE_WRITABLE;\n            break;\n        default:\n        case VIR_NET_TLS_HANDSHAKE_COMPLETE:\n            if (client->rx)\n                mode |= VIR_EVENT_HANDLE_READABLE;\n            if (client->tx)\n                mode |= VIR_EVENT_HANDLE_WRITABLE;\n        }\n    } else {\n        /* If there is a message on the rx queue, and\n         * we're not in middle of a delayedClose, then\n         * we're wanting more input */\n        if (client->rx && !client->delayedClose)\n            mode |= VIR_EVENT_HANDLE_READABLE;\n\n        /* If there are one or more messages to send back to client,\n           then monitor for writability on socket */\n        if (client->tx)\n            mode |= VIR_EVENT_HANDLE_WRITABLE;\n    }\n    VIR_DEBUG(\"mode=0%o\", mode);\n    return mode;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
      "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"mode=0%o\"",
            "mode"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetTLSSessionGetHandshakeStatus",
          "args": [
            "client->tls"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "virNetTLSSessionGetHandshakeStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnettlscontext.c",
          "lines": "1370-1383",
          "snippet": "virNetTLSSessionHandshakeStatus\nvirNetTLSSessionGetHandshakeStatus(virNetTLSSessionPtr sess)\n{\n    virNetTLSSessionHandshakeStatus ret;\n    virObjectLock(sess);\n    if (sess->handshakeComplete)\n        ret = VIR_NET_TLS_HANDSHAKE_COMPLETE;\n    else if (gnutls_record_get_direction(sess->session) == 0)\n        ret = VIR_NET_TLS_HANDSHAKE_RECVING;\n    else\n        ret = VIR_NET_TLS_HANDSHAKE_SENDING;\n    virObjectUnlock(sess);\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virthread.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virnettlscontext.h\"",
            "#include <gnutls/x509.h>",
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virthread.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virnettlscontext.h\"\n#include <gnutls/x509.h>\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <unistd.h>\n#include <config.h>\n\nvirNetTLSSessionHandshakeStatus\nvirNetTLSSessionGetHandshakeStatus(virNetTLSSessionPtr sess)\n{\n    virNetTLSSessionHandshakeStatus ret;\n    virObjectLock(sess);\n    if (sess->handshakeComplete)\n        ret = VIR_NET_TLS_HANDSHAKE_COMPLETE;\n    else if (gnutls_record_get_direction(sess->session) == 0)\n        ret = VIR_NET_TLS_HANDSHAKE_RECVING;\n    else\n        ret = VIR_NET_TLS_HANDSHAKE_SENDING;\n    virObjectUnlock(sess);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"tls=%p hs=%d, rx=%p tx=%p\"",
            "client->tls",
            "client->tls ? virNetTLSSessionGetHandshakeStatus(client->tls) : -1",
            "client->rx",
            "client->tx"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nstatic int\nvirNetServerClientCalculateHandleMode(virNetServerClientPtr client)\n{\n    int mode = 0;\n\n\n    VIR_DEBUG(\"tls=%p hs=%d, rx=%p tx=%p\",\n              client->tls,\n              client->tls ? virNetTLSSessionGetHandshakeStatus(client->tls) : -1,\n              client->rx,\n              client->tx);\n    if (!client->sock || client->wantClose)\n        return 0;\n\n    if (client->tls) {\n        switch (virNetTLSSessionGetHandshakeStatus(client->tls)) {\n        case VIR_NET_TLS_HANDSHAKE_RECVING:\n            mode |= VIR_EVENT_HANDLE_READABLE;\n            break;\n        case VIR_NET_TLS_HANDSHAKE_SENDING:\n            mode |= VIR_EVENT_HANDLE_WRITABLE;\n            break;\n        default:\n        case VIR_NET_TLS_HANDSHAKE_COMPLETE:\n            if (client->rx)\n                mode |= VIR_EVENT_HANDLE_READABLE;\n            if (client->tx)\n                mode |= VIR_EVENT_HANDLE_WRITABLE;\n        }\n    } else {\n        /* If there is a message on the rx queue, and\n         * we're not in middle of a delayedClose, then\n         * we're wanting more input */\n        if (client->rx && !client->delayedClose)\n            mode |= VIR_EVENT_HANDLE_READABLE;\n\n        /* If there are one or more messages to send back to client,\n           then monitor for writability on socket */\n        if (client->tx)\n            mode |= VIR_EVENT_HANDLE_WRITABLE;\n    }\n    VIR_DEBUG(\"mode=0%o\", mode);\n    return mode;\n}"
  },
  {
    "function_name": "virNetServerClientOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
    "lines": "126-132",
    "snippet": "static int virNetServerClientOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNetServerClient, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprobe.h\"",
      "#include \"virkeepalive.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virnetserverclient.h\"",
      "#include \"virnetserver.h\"",
      "# include <sasl/sasl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virNetServerClient",
            "virClassForObjectLockable()"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int virNetServerClientOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNetServerClient, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}"
  }
]