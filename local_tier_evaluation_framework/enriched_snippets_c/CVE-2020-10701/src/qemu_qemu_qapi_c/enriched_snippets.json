[
  {
    "function_name": "virQEMUQAPISchemaConvert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
    "lines": "514-529",
    "snippet": "virHashTablePtr\nvirQEMUQAPISchemaConvert(virJSONValuePtr schemareply)\n{\n    g_autoptr(virHashTable) schema = NULL;\n    g_autoptr(virJSONValue) schemajson = schemareply;\n\n    if (!(schema = virHashCreate(512, virJSONValueHashFree)))\n        return NULL;\n\n    if (virJSONValueArrayForeachSteal(schemajson,\n                                      virQEMUQAPISchemaEntryProcess,\n                                      schema) < 0)\n        return NULL;\n\n    return g_steal_pointer(&schema);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_qapi.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&schema"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayForeachSteal",
          "args": [
            "schemajson",
            "virQEMUQAPISchemaEntryProcess",
            "schema"
          ],
          "line": 523
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayForeachSteal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1078-1112",
          "snippet": "int\nvirJSONValueArrayForeachSteal(virJSONValuePtr array,\n                              virJSONArrayIteratorFunc cb,\n                              void *opaque)\n{\n    size_t i;\n    size_t j = 0;\n    int ret = 0;\n    int rc;\n\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return -1;\n\n    for (i = 0; i < array->data.array.nvalues; i++) {\n        if ((rc = cb(i, array->data.array.values[i], opaque)) < 0) {\n            ret = -1;\n            break;\n        }\n\n        if (rc == 0)\n            array->data.array.values[i] = NULL;\n    }\n\n    /* condense the remaining entries at the beginning */\n    for (i = 0; i < array->data.array.nvalues; i++) {\n        if (!array->data.array.values[i])\n            continue;\n\n        array->data.array.values[j++] = array->data.array.values[i];\n    }\n\n    array->data.array.nvalues = j;\n\n    return ret;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueArrayForeachSteal(virJSONValuePtr array,\n                              virJSONArrayIteratorFunc cb,\n                              void *opaque)\n{\n    size_t i;\n    size_t j = 0;\n    int ret = 0;\n    int rc;\n\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return -1;\n\n    for (i = 0; i < array->data.array.nvalues; i++) {\n        if ((rc = cb(i, array->data.array.values[i], opaque)) < 0) {\n            ret = -1;\n            break;\n        }\n\n        if (rc == 0)\n            array->data.array.values[i] = NULL;\n    }\n\n    /* condense the remaining entries at the beginning */\n    for (i = 0; i < array->data.array.nvalues; i++) {\n        if (!array->data.array.values[i])\n            continue;\n\n        array->data.array.values[j++] = array->data.array.values[i];\n    }\n\n    array->data.array.nvalues = j;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "512",
            "virJSONValueHashFree"
          ],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nvirHashTablePtr\nvirQEMUQAPISchemaConvert(virJSONValuePtr schemareply)\n{\n    g_autoptr(virHashTable) schema = NULL;\n    g_autoptr(virJSONValue) schemajson = schemareply;\n\n    if (!(schema = virHashCreate(512, virJSONValueHashFree)))\n        return NULL;\n\n    if (virJSONValueArrayForeachSteal(schemajson,\n                                      virQEMUQAPISchemaEntryProcess,\n                                      schema) < 0)\n        return NULL;\n\n    return g_steal_pointer(&schema);\n}"
  },
  {
    "function_name": "virQEMUQAPISchemaEntryProcess",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
    "lines": "486-504",
    "snippet": "static int\nvirQEMUQAPISchemaEntryProcess(size_t pos G_GNUC_UNUSED,\n                              virJSONValuePtr item,\n                              void *opaque)\n{\n    const char *name;\n    virHashTablePtr schema = opaque;\n\n    if (!(name = virJSONValueObjectGetString(item, \"name\"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"malformed QMP schema\"));\n        return -1;\n    }\n\n    if (virHashAddEntry(schema, name, item) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_qapi.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "schema",
            "name",
            "item"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"malformed QMP schema\")"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"malformed QMP schema\""
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetString",
          "args": [
            "item",
            "\"name\""
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetStringOrNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1313-1328",
          "snippet": "const char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaEntryProcess(size_t pos G_GNUC_UNUSED,\n                              virJSONValuePtr item,\n                              void *opaque)\n{\n    const char *name;\n    virHashTablePtr schema = opaque;\n\n    if (!(name = virJSONValueObjectGetString(item, \"name\"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"malformed QMP schema\"));\n        return -1;\n    }\n\n    if (virHashAddEntry(schema, name, item) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUQAPISchemaPathExists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
    "lines": "479-484",
    "snippet": "bool\nvirQEMUQAPISchemaPathExists(const char *query,\n                            virHashTablePtr schema)\n{\n    return virQEMUQAPISchemaPathGet(query, schema, NULL) == 1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_qapi.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaPathGet",
          "args": [
            "query",
            "schema",
            "NULL"
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaPathGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "430-476",
          "snippet": "int\nvirQEMUQAPISchemaPathGet(const char *query,\n                         virHashTablePtr schema,\n                         virJSONValuePtr *entry)\n{\n    VIR_AUTOSTRINGLIST elems = NULL;\n    struct virQEMUQAPISchemaTraverseContext ctxt;\n    const char *cmdname;\n    int rc;\n\n    if (entry)\n        *entry = NULL;\n\n    if (!(elems = virStringSplit(query, \"/\", 0)))\n        return -1;\n\n    if (!*elems) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"malformed query string\"));\n        return -1;\n    }\n\n    virQEMUQAPISchemaTraverseContextInit(&ctxt, elems, schema);\n    cmdname = virQEMUQAPISchemaTraverseContextNextQuery(&ctxt);\n\n    if (!virHashLookup(schema, cmdname))\n        return 0;\n\n    rc = virQEMUQAPISchemaTraverse(cmdname, &ctxt);\n\n    if (entry)\n        *entry = ctxt.returnType;\n\n    if (rc >= 0)\n        return rc;\n\n    if (rc == -2) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"malformed QAPI schema when querying '%s' of '%s'\"),\n                       NULLSTR(ctxt.prevquery), query);\n    } else if (rc == -3) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"terminal QAPI query component '%s' of '%s' must not have followers\"),\n                       NULLSTR(ctxt.prevquery), query);\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nint\nvirQEMUQAPISchemaPathGet(const char *query,\n                         virHashTablePtr schema,\n                         virJSONValuePtr *entry)\n{\n    VIR_AUTOSTRINGLIST elems = NULL;\n    struct virQEMUQAPISchemaTraverseContext ctxt;\n    const char *cmdname;\n    int rc;\n\n    if (entry)\n        *entry = NULL;\n\n    if (!(elems = virStringSplit(query, \"/\", 0)))\n        return -1;\n\n    if (!*elems) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"malformed query string\"));\n        return -1;\n    }\n\n    virQEMUQAPISchemaTraverseContextInit(&ctxt, elems, schema);\n    cmdname = virQEMUQAPISchemaTraverseContextNextQuery(&ctxt);\n\n    if (!virHashLookup(schema, cmdname))\n        return 0;\n\n    rc = virQEMUQAPISchemaTraverse(cmdname, &ctxt);\n\n    if (entry)\n        *entry = ctxt.returnType;\n\n    if (rc >= 0)\n        return rc;\n\n    if (rc == -2) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"malformed QAPI schema when querying '%s' of '%s'\"),\n                       NULLSTR(ctxt.prevquery), query);\n    } else if (rc == -3) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"terminal QAPI query component '%s' of '%s' must not have followers\"),\n                       NULLSTR(ctxt.prevquery), query);\n    }\n\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nbool\nvirQEMUQAPISchemaPathExists(const char *query,\n                            virHashTablePtr schema)\n{\n    return virQEMUQAPISchemaPathGet(query, schema, NULL) == 1;\n}"
  },
  {
    "function_name": "virQEMUQAPISchemaPathGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
    "lines": "430-476",
    "snippet": "int\nvirQEMUQAPISchemaPathGet(const char *query,\n                         virHashTablePtr schema,\n                         virJSONValuePtr *entry)\n{\n    VIR_AUTOSTRINGLIST elems = NULL;\n    struct virQEMUQAPISchemaTraverseContext ctxt;\n    const char *cmdname;\n    int rc;\n\n    if (entry)\n        *entry = NULL;\n\n    if (!(elems = virStringSplit(query, \"/\", 0)))\n        return -1;\n\n    if (!*elems) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"malformed query string\"));\n        return -1;\n    }\n\n    virQEMUQAPISchemaTraverseContextInit(&ctxt, elems, schema);\n    cmdname = virQEMUQAPISchemaTraverseContextNextQuery(&ctxt);\n\n    if (!virHashLookup(schema, cmdname))\n        return 0;\n\n    rc = virQEMUQAPISchemaTraverse(cmdname, &ctxt);\n\n    if (entry)\n        *entry = ctxt.returnType;\n\n    if (rc >= 0)\n        return rc;\n\n    if (rc == -2) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"malformed QAPI schema when querying '%s' of '%s'\"),\n                       NULLSTR(ctxt.prevquery), query);\n    } else if (rc == -3) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"terminal QAPI query component '%s' of '%s' must not have followers\"),\n                       NULLSTR(ctxt.prevquery), query);\n    }\n\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_qapi.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"terminal QAPI query component '%s' of '%s' must not have followers\")",
            "NULLSTR(ctxt.prevquery)",
            "query"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "ctxt.prevquery"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"terminal QAPI query component '%s' of '%s' must not have followers\""
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"malformed QAPI schema when querying '%s' of '%s'\")",
            "NULLSTR(ctxt.prevquery)",
            "query"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "ctxt.prevquery"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverse",
          "args": [
            "cmdname",
            "&ctxt"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "351-379",
          "snippet": "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    virJSONValuePtr cur;\n    const char *metatype;\n    size_t i;\n\n    if (virQEMUQAPISchemaTraverseContextValidateDepth(ctxt) < 0)\n        return -2;\n\n    if (!(cur = virHashLookup(ctxt->schema, baseName)))\n        return -2;\n\n    if (!virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt)) {\n        ctxt->returnType = cur;\n        return 1;\n    }\n\n    if (!(metatype = virJSONValueObjectGetString(cur, \"meta-type\")))\n        return -2;\n\n    for (i = 0; i < G_N_ELEMENTS(traverseMetaType); i++) {\n        if (STREQ(metatype, traverseMetaType[i].metatype))\n            return traverseMetaType[i].func(cur, ctxt);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);",
            "static const struct virQEMUQAPISchemaTraverseMetaType traverseMetaType[] = {\n    { \"object\", virQEMUQAPISchemaTraverseObject },\n    { \"array\", virQEMUQAPISchemaTraverseArray },\n    { \"command\", virQEMUQAPISchemaTraverseCommand },\n    { \"event\", virQEMUQAPISchemaTraverseCommand },\n    { \"enum\", virQEMUQAPISchemaTraverseEnum },\n    { \"builtin\", virQEMUQAPISchemaTraverseBuiltin },\n    { \"alternate\", virQEMUQAPISchemaTraverseAlternate },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\nstatic const struct virQEMUQAPISchemaTraverseMetaType traverseMetaType[] = {\n    { \"object\", virQEMUQAPISchemaTraverseObject },\n    { \"array\", virQEMUQAPISchemaTraverseArray },\n    { \"command\", virQEMUQAPISchemaTraverseCommand },\n    { \"event\", virQEMUQAPISchemaTraverseCommand },\n    { \"enum\", virQEMUQAPISchemaTraverseEnum },\n    { \"builtin\", virQEMUQAPISchemaTraverseBuiltin },\n    { \"alternate\", virQEMUQAPISchemaTraverseAlternate },\n};\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    virJSONValuePtr cur;\n    const char *metatype;\n    size_t i;\n\n    if (virQEMUQAPISchemaTraverseContextValidateDepth(ctxt) < 0)\n        return -2;\n\n    if (!(cur = virHashLookup(ctxt->schema, baseName)))\n        return -2;\n\n    if (!virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt)) {\n        ctxt->returnType = cur;\n        return 1;\n    }\n\n    if (!(metatype = virJSONValueObjectGetString(cur, \"meta-type\")))\n        return -2;\n\n    for (i = 0; i < G_N_ELEMENTS(traverseMetaType); i++) {\n        if (STREQ(metatype, traverseMetaType[i].metatype))\n            return traverseMetaType[i].func(cur, ctxt);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "schema",
            "cmdname"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverseContextNextQuery",
          "args": [
            "&ctxt"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverseContextNextQuery",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "103-109",
          "snippet": "static const char *\nvirQEMUQAPISchemaTraverseContextNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    ctxt->prevquery = ctxt->queries[0];\n    ctxt->queries++;\n    return ctxt->prevquery;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic const char *\nvirQEMUQAPISchemaTraverseContextNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    ctxt->prevquery = ctxt->queries[0];\n    ctxt->queries++;\n    return ctxt->prevquery;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverseContextInit",
          "args": [
            "&ctxt",
            "elems",
            "schema"
          ],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverseContextInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "92-100",
          "snippet": "static void\nvirQEMUQAPISchemaTraverseContextInit(struct virQEMUQAPISchemaTraverseContext *ctxt,\n                                     char **queries,\n                                     virHashTablePtr schema)\n{\n    memset(ctxt, 0, sizeof(*ctxt));\n    ctxt->schema = schema;\n    ctxt->queries = queries;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic void\nvirQEMUQAPISchemaTraverseContextInit(struct virQEMUQAPISchemaTraverseContext *ctxt,\n                                     char **queries,\n                                     virHashTablePtr schema)\n{\n    memset(ctxt, 0, sizeof(*ctxt));\n    ctxt->schema = schema;\n    ctxt->queries = queries;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"malformed query string\")"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringSplit",
          "args": [
            "query",
            "\"/\"",
            "0"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "126-132",
          "snippet": "char **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nint\nvirQEMUQAPISchemaPathGet(const char *query,\n                         virHashTablePtr schema,\n                         virJSONValuePtr *entry)\n{\n    VIR_AUTOSTRINGLIST elems = NULL;\n    struct virQEMUQAPISchemaTraverseContext ctxt;\n    const char *cmdname;\n    int rc;\n\n    if (entry)\n        *entry = NULL;\n\n    if (!(elems = virStringSplit(query, \"/\", 0)))\n        return -1;\n\n    if (!*elems) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"malformed query string\"));\n        return -1;\n    }\n\n    virQEMUQAPISchemaTraverseContextInit(&ctxt, elems, schema);\n    cmdname = virQEMUQAPISchemaTraverseContextNextQuery(&ctxt);\n\n    if (!virHashLookup(schema, cmdname))\n        return 0;\n\n    rc = virQEMUQAPISchemaTraverse(cmdname, &ctxt);\n\n    if (entry)\n        *entry = ctxt.returnType;\n\n    if (rc >= 0)\n        return rc;\n\n    if (rc == -2) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"malformed QAPI schema when querying '%s' of '%s'\"),\n                       NULLSTR(ctxt.prevquery), query);\n    } else if (rc == -3) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"terminal QAPI query component '%s' of '%s' must not have followers\"),\n                       NULLSTR(ctxt.prevquery), query);\n    }\n\n    return -1;\n}"
  },
  {
    "function_name": "virQEMUQAPISchemaTraverse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
    "lines": "351-379",
    "snippet": "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    virJSONValuePtr cur;\n    const char *metatype;\n    size_t i;\n\n    if (virQEMUQAPISchemaTraverseContextValidateDepth(ctxt) < 0)\n        return -2;\n\n    if (!(cur = virHashLookup(ctxt->schema, baseName)))\n        return -2;\n\n    if (!virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt)) {\n        ctxt->returnType = cur;\n        return 1;\n    }\n\n    if (!(metatype = virJSONValueObjectGetString(cur, \"meta-type\")))\n        return -2;\n\n    for (i = 0; i < G_N_ELEMENTS(traverseMetaType); i++) {\n        if (STREQ(metatype, traverseMetaType[i].metatype))\n            return traverseMetaType[i].func(cur, ctxt);\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_qapi.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);",
      "static const struct virQEMUQAPISchemaTraverseMetaType traverseMetaType[] = {\n    { \"object\", virQEMUQAPISchemaTraverseObject },\n    { \"array\", virQEMUQAPISchemaTraverseArray },\n    { \"command\", virQEMUQAPISchemaTraverseCommand },\n    { \"event\", virQEMUQAPISchemaTraverseCommand },\n    { \"enum\", virQEMUQAPISchemaTraverseEnum },\n    { \"builtin\", virQEMUQAPISchemaTraverseBuiltin },\n    { \"alternate\", virQEMUQAPISchemaTraverseAlternate },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "traverseMetaType[i].func",
          "args": [
            "cur",
            "ctxt"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "metatype",
            "traverseMetaType[i].metatype"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "traverseMetaType"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetString",
          "args": [
            "cur",
            "\"meta-type\""
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetStringOrNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1313-1328",
          "snippet": "const char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverseContextHasNextQuery",
          "args": [
            "ctxt"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverseContextHasNextQuery",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "112-116",
          "snippet": "static bool\nvirQEMUQAPISchemaTraverseContextHasNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    return !!ctxt->queries[0];\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic bool\nvirQEMUQAPISchemaTraverseContextHasNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    return !!ctxt->queries[0];\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "ctxt->schema",
            "baseName"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverseContextValidateDepth",
          "args": [
            "ctxt"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverseContextValidateDepth",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "79-89",
          "snippet": "static int\nvirQEMUQAPISchemaTraverseContextValidateDepth(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    if (ctxt->depth++ > 1000) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"possible loop in QMP schema\"));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic int\nvirQEMUQAPISchemaTraverseContextValidateDepth(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    if (ctxt->depth++ > 1000) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"possible loop in QMP schema\"));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\nstatic const struct virQEMUQAPISchemaTraverseMetaType traverseMetaType[] = {\n    { \"object\", virQEMUQAPISchemaTraverseObject },\n    { \"array\", virQEMUQAPISchemaTraverseArray },\n    { \"command\", virQEMUQAPISchemaTraverseCommand },\n    { \"event\", virQEMUQAPISchemaTraverseCommand },\n    { \"enum\", virQEMUQAPISchemaTraverseEnum },\n    { \"builtin\", virQEMUQAPISchemaTraverseBuiltin },\n    { \"alternate\", virQEMUQAPISchemaTraverseAlternate },\n};\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    virJSONValuePtr cur;\n    const char *metatype;\n    size_t i;\n\n    if (virQEMUQAPISchemaTraverseContextValidateDepth(ctxt) < 0)\n        return -2;\n\n    if (!(cur = virHashLookup(ctxt->schema, baseName)))\n        return -2;\n\n    if (!virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt)) {\n        ctxt->returnType = cur;\n        return 1;\n    }\n\n    if (!(metatype = virJSONValueObjectGetString(cur, \"meta-type\")))\n        return -2;\n\n    for (i = 0; i < G_N_ELEMENTS(traverseMetaType); i++) {\n        if (STREQ(metatype, traverseMetaType[i].metatype))\n            return traverseMetaType[i].func(cur, ctxt);\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUQAPISchemaTraverseAlternate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
    "lines": "299-325",
    "snippet": "static int\nvirQEMUQAPISchemaTraverseAlternate(virJSONValuePtr cur,\n                                   struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    struct virQEMUQAPISchemaTraverseContext savectxt = *ctxt;\n    virJSONValuePtr members;\n    virJSONValuePtr member;\n    const char *membertype;\n    int rc;\n    size_t i;\n\n    if (!(members = virJSONValueObjectGetArray(cur, \"members\")))\n        return -2;\n\n    for (i = 0; i < virJSONValueArraySize(members); i++) {\n        if (!(member = virJSONValueArrayGet(members, i)) ||\n            !(membertype = virJSONValueObjectGetString(member, \"type\")))\n            continue;\n\n        *ctxt = savectxt;\n\n        if ((rc = virQEMUQAPISchemaTraverse(membertype, ctxt)) != 0)\n            return rc;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_qapi.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverse",
          "args": [
            "membertype",
            "ctxt"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "351-379",
          "snippet": "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    virJSONValuePtr cur;\n    const char *metatype;\n    size_t i;\n\n    if (virQEMUQAPISchemaTraverseContextValidateDepth(ctxt) < 0)\n        return -2;\n\n    if (!(cur = virHashLookup(ctxt->schema, baseName)))\n        return -2;\n\n    if (!virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt)) {\n        ctxt->returnType = cur;\n        return 1;\n    }\n\n    if (!(metatype = virJSONValueObjectGetString(cur, \"meta-type\")))\n        return -2;\n\n    for (i = 0; i < G_N_ELEMENTS(traverseMetaType); i++) {\n        if (STREQ(metatype, traverseMetaType[i].metatype))\n            return traverseMetaType[i].func(cur, ctxt);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);",
            "static const struct virQEMUQAPISchemaTraverseMetaType traverseMetaType[] = {\n    { \"object\", virQEMUQAPISchemaTraverseObject },\n    { \"array\", virQEMUQAPISchemaTraverseArray },\n    { \"command\", virQEMUQAPISchemaTraverseCommand },\n    { \"event\", virQEMUQAPISchemaTraverseCommand },\n    { \"enum\", virQEMUQAPISchemaTraverseEnum },\n    { \"builtin\", virQEMUQAPISchemaTraverseBuiltin },\n    { \"alternate\", virQEMUQAPISchemaTraverseAlternate },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\nstatic const struct virQEMUQAPISchemaTraverseMetaType traverseMetaType[] = {\n    { \"object\", virQEMUQAPISchemaTraverseObject },\n    { \"array\", virQEMUQAPISchemaTraverseArray },\n    { \"command\", virQEMUQAPISchemaTraverseCommand },\n    { \"event\", virQEMUQAPISchemaTraverseCommand },\n    { \"enum\", virQEMUQAPISchemaTraverseEnum },\n    { \"builtin\", virQEMUQAPISchemaTraverseBuiltin },\n    { \"alternate\", virQEMUQAPISchemaTraverseAlternate },\n};\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    virJSONValuePtr cur;\n    const char *metatype;\n    size_t i;\n\n    if (virQEMUQAPISchemaTraverseContextValidateDepth(ctxt) < 0)\n        return -2;\n\n    if (!(cur = virHashLookup(ctxt->schema, baseName)))\n        return -2;\n\n    if (!virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt)) {\n        ctxt->returnType = cur;\n        return 1;\n    }\n\n    if (!(metatype = virJSONValueObjectGetString(cur, \"meta-type\")))\n        return -2;\n\n    for (i = 0; i < G_N_ELEMENTS(traverseMetaType); i++) {\n        if (STREQ(metatype, traverseMetaType[i].metatype))\n            return traverseMetaType[i].func(cur, ctxt);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetString",
          "args": [
            "member",
            "\"type\""
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetStringOrNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1313-1328",
          "snippet": "const char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayGet",
          "args": [
            "members",
            "i"
          ],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1024-1035",
          "snippet": "virJSONValuePtr\nvirJSONValueArrayGet(virJSONValuePtr array,\n                     unsigned int element)\n{\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return NULL;\n\n    if (element >= array->data.array.nvalues)\n        return NULL;\n\n    return array->data.array.values[element];\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueArrayGet(virJSONValuePtr array,\n                     unsigned int element)\n{\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return NULL;\n\n    if (element >= array->data.array.nvalues)\n        return NULL;\n\n    return array->data.array.values[element];\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueArraySize",
          "args": [
            "members"
          ],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArraySize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1017-1021",
          "snippet": "size_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nsize_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetArray",
          "args": [
            "cur",
            "\"members\""
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic int\nvirQEMUQAPISchemaTraverseAlternate(virJSONValuePtr cur,\n                                   struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    struct virQEMUQAPISchemaTraverseContext savectxt = *ctxt;\n    virJSONValuePtr members;\n    virJSONValuePtr member;\n    const char *membertype;\n    int rc;\n    size_t i;\n\n    if (!(members = virJSONValueObjectGetArray(cur, \"members\")))\n        return -2;\n\n    for (i = 0; i < virJSONValueArraySize(members); i++) {\n        if (!(member = virJSONValueArrayGet(members, i)) ||\n            !(membertype = virJSONValueObjectGetString(member, \"type\")))\n            continue;\n\n        *ctxt = savectxt;\n\n        if ((rc = virQEMUQAPISchemaTraverse(membertype, ctxt)) != 0)\n            return rc;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUQAPISchemaTraverseBuiltin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
    "lines": "274-296",
    "snippet": "static int\nvirQEMUQAPISchemaTraverseBuiltin(virJSONValuePtr cur,\n                                 struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    const char *query = virQEMUQAPISchemaTraverseContextNextQuery(ctxt);\n    const char *jsontype;\n\n    if (query[0] != '!')\n        return 0;\n\n    if (virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt))\n        return -3;\n\n    query++;\n\n    if (!(jsontype = virJSONValueObjectGetString(cur, \"json-type\")))\n        return -1;\n\n    if (STREQ(jsontype, query))\n        return 1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_qapi.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "jsontype",
            "query"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetString",
          "args": [
            "cur",
            "\"json-type\""
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetStringOrNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1313-1328",
          "snippet": "const char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverseContextHasNextQuery",
          "args": [
            "ctxt"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverseContextHasNextQuery",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "112-116",
          "snippet": "static bool\nvirQEMUQAPISchemaTraverseContextHasNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    return !!ctxt->queries[0];\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic bool\nvirQEMUQAPISchemaTraverseContextHasNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    return !!ctxt->queries[0];\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverseContextNextQuery",
          "args": [
            "ctxt"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverseContextNextQuery",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "103-109",
          "snippet": "static const char *\nvirQEMUQAPISchemaTraverseContextNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    ctxt->prevquery = ctxt->queries[0];\n    ctxt->queries++;\n    return ctxt->prevquery;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic const char *\nvirQEMUQAPISchemaTraverseContextNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    ctxt->prevquery = ctxt->queries[0];\n    ctxt->queries++;\n    return ctxt->prevquery;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic int\nvirQEMUQAPISchemaTraverseBuiltin(virJSONValuePtr cur,\n                                 struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    const char *query = virQEMUQAPISchemaTraverseContextNextQuery(ctxt);\n    const char *jsontype;\n\n    if (query[0] != '!')\n        return 0;\n\n    if (virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt))\n        return -3;\n\n    query++;\n\n    if (!(jsontype = virJSONValueObjectGetString(cur, \"json-type\")))\n        return -1;\n\n    if (STREQ(jsontype, query))\n        return 1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUQAPISchemaTraverseEnum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
    "lines": "240-271",
    "snippet": "static int\nvirQEMUQAPISchemaTraverseEnum(virJSONValuePtr cur,\n                              struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    const char *query = virQEMUQAPISchemaTraverseContextNextQuery(ctxt);\n    virJSONValuePtr values;\n    virJSONValuePtr enumval;\n    const char *value;\n    size_t i;\n\n    if (query[0] != '^')\n        return 0;\n\n    if (virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt))\n        return -3;\n\n    query++;\n\n    if (!(values = virJSONValueObjectGetArray(cur, \"values\")))\n        return -2;\n\n    for (i = 0; i < virJSONValueArraySize(values); i++) {\n        if (!(enumval = virJSONValueArrayGet(values, i)) ||\n            !(value = virJSONValueGetString(enumval)))\n            continue;\n\n        if (STREQ(value, query))\n            return 1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_qapi.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "value",
            "query"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueGetString",
          "args": [
            "enumval"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueGetString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1115-1122",
          "snippet": "const char *\nvirJSONValueGetString(virJSONValuePtr string)\n{\n    if (string->type != VIR_JSON_TYPE_STRING)\n        return NULL;\n\n    return string->data.string;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueGetString(virJSONValuePtr string)\n{\n    if (string->type != VIR_JSON_TYPE_STRING)\n        return NULL;\n\n    return string->data.string;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayGet",
          "args": [
            "values",
            "i"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1024-1035",
          "snippet": "virJSONValuePtr\nvirJSONValueArrayGet(virJSONValuePtr array,\n                     unsigned int element)\n{\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return NULL;\n\n    if (element >= array->data.array.nvalues)\n        return NULL;\n\n    return array->data.array.values[element];\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueArrayGet(virJSONValuePtr array,\n                     unsigned int element)\n{\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return NULL;\n\n    if (element >= array->data.array.nvalues)\n        return NULL;\n\n    return array->data.array.values[element];\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueArraySize",
          "args": [
            "values"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArraySize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1017-1021",
          "snippet": "size_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nsize_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetArray",
          "args": [
            "cur",
            "\"values\""
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverseContextHasNextQuery",
          "args": [
            "ctxt"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverseContextHasNextQuery",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "112-116",
          "snippet": "static bool\nvirQEMUQAPISchemaTraverseContextHasNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    return !!ctxt->queries[0];\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic bool\nvirQEMUQAPISchemaTraverseContextHasNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    return !!ctxt->queries[0];\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverseContextNextQuery",
          "args": [
            "ctxt"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverseContextNextQuery",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "103-109",
          "snippet": "static const char *\nvirQEMUQAPISchemaTraverseContextNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    ctxt->prevquery = ctxt->queries[0];\n    ctxt->queries++;\n    return ctxt->prevquery;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic const char *\nvirQEMUQAPISchemaTraverseContextNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    ctxt->prevquery = ctxt->queries[0];\n    ctxt->queries++;\n    return ctxt->prevquery;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic int\nvirQEMUQAPISchemaTraverseEnum(virJSONValuePtr cur,\n                              struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    const char *query = virQEMUQAPISchemaTraverseContextNextQuery(ctxt);\n    virJSONValuePtr values;\n    virJSONValuePtr enumval;\n    const char *value;\n    size_t i;\n\n    if (query[0] != '^')\n        return 0;\n\n    if (virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt))\n        return -3;\n\n    query++;\n\n    if (!(values = virJSONValueObjectGetArray(cur, \"values\")))\n        return -2;\n\n    for (i = 0; i < virJSONValueArraySize(values); i++) {\n        if (!(enumval = virJSONValueArrayGet(values, i)) ||\n            !(value = virJSONValueGetString(enumval)))\n            continue;\n\n        if (STREQ(value, query))\n            return 1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUQAPISchemaTraverseCommand",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
    "lines": "211-237",
    "snippet": "static int\nvirQEMUQAPISchemaTraverseCommand(virJSONValuePtr cur,\n                                 struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    const char *query = virQEMUQAPISchemaTraverseContextNextQuery(ctxt);\n    const char *querytype;\n    char modifier = *query;\n\n    if (!g_ascii_isalpha(modifier))\n        query++;\n\n    /* exit on modifers for other types */\n    if (modifier == '^' || modifier == '!' || modifier == '+' || modifier == '*')\n        return 0;\n\n    if (modifier == '$') {\n        if (virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt))\n            return -3;\n\n        return virQEMUQAPISchemaTraverseHasObjectFeature(query, cur);\n    }\n\n    if (!(querytype = virJSONValueObjectGetString(cur, query)))\n        return 0;\n\n    return virQEMUQAPISchemaTraverse(querytype, ctxt);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_qapi.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverse",
          "args": [
            "querytype",
            "ctxt"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "351-379",
          "snippet": "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    virJSONValuePtr cur;\n    const char *metatype;\n    size_t i;\n\n    if (virQEMUQAPISchemaTraverseContextValidateDepth(ctxt) < 0)\n        return -2;\n\n    if (!(cur = virHashLookup(ctxt->schema, baseName)))\n        return -2;\n\n    if (!virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt)) {\n        ctxt->returnType = cur;\n        return 1;\n    }\n\n    if (!(metatype = virJSONValueObjectGetString(cur, \"meta-type\")))\n        return -2;\n\n    for (i = 0; i < G_N_ELEMENTS(traverseMetaType); i++) {\n        if (STREQ(metatype, traverseMetaType[i].metatype))\n            return traverseMetaType[i].func(cur, ctxt);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);",
            "static const struct virQEMUQAPISchemaTraverseMetaType traverseMetaType[] = {\n    { \"object\", virQEMUQAPISchemaTraverseObject },\n    { \"array\", virQEMUQAPISchemaTraverseArray },\n    { \"command\", virQEMUQAPISchemaTraverseCommand },\n    { \"event\", virQEMUQAPISchemaTraverseCommand },\n    { \"enum\", virQEMUQAPISchemaTraverseEnum },\n    { \"builtin\", virQEMUQAPISchemaTraverseBuiltin },\n    { \"alternate\", virQEMUQAPISchemaTraverseAlternate },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\nstatic const struct virQEMUQAPISchemaTraverseMetaType traverseMetaType[] = {\n    { \"object\", virQEMUQAPISchemaTraverseObject },\n    { \"array\", virQEMUQAPISchemaTraverseArray },\n    { \"command\", virQEMUQAPISchemaTraverseCommand },\n    { \"event\", virQEMUQAPISchemaTraverseCommand },\n    { \"enum\", virQEMUQAPISchemaTraverseEnum },\n    { \"builtin\", virQEMUQAPISchemaTraverseBuiltin },\n    { \"alternate\", virQEMUQAPISchemaTraverseAlternate },\n};\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    virJSONValuePtr cur;\n    const char *metatype;\n    size_t i;\n\n    if (virQEMUQAPISchemaTraverseContextValidateDepth(ctxt) < 0)\n        return -2;\n\n    if (!(cur = virHashLookup(ctxt->schema, baseName)))\n        return -2;\n\n    if (!virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt)) {\n        ctxt->returnType = cur;\n        return 1;\n    }\n\n    if (!(metatype = virJSONValueObjectGetString(cur, \"meta-type\")))\n        return -2;\n\n    for (i = 0; i < G_N_ELEMENTS(traverseMetaType); i++) {\n        if (STREQ(metatype, traverseMetaType[i].metatype))\n            return traverseMetaType[i].func(cur, ctxt);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetString",
          "args": [
            "cur",
            "query"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetStringOrNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1313-1328",
          "snippet": "const char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverseHasObjectFeature",
          "args": [
            "query",
            "cur"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverseHasObjectFeature",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "133-155",
          "snippet": "static int\nvirQEMUQAPISchemaTraverseHasObjectFeature(const char *featurename,\n                                          virJSONValuePtr elem)\n{\n    virJSONValuePtr featuresarray;\n    virJSONValuePtr cur;\n    const char *curstr;\n    size_t i;\n\n    if (!(featuresarray = virJSONValueObjectGetArray(elem, \"features\")))\n        return 0;\n\n    for (i = 0; i < virJSONValueArraySize(featuresarray); i++) {\n        if (!(cur = virJSONValueArrayGet(featuresarray, i)) ||\n            !(curstr = virJSONValueGetString(cur)))\n            return -2;\n\n        if (STREQ(featurename, curstr))\n            return 1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverseHasObjectFeature(const char *featurename,\n                                          virJSONValuePtr elem)\n{\n    virJSONValuePtr featuresarray;\n    virJSONValuePtr cur;\n    const char *curstr;\n    size_t i;\n\n    if (!(featuresarray = virJSONValueObjectGetArray(elem, \"features\")))\n        return 0;\n\n    for (i = 0; i < virJSONValueArraySize(featuresarray); i++) {\n        if (!(cur = virJSONValueArrayGet(featuresarray, i)) ||\n            !(curstr = virJSONValueGetString(cur)))\n            return -2;\n\n        if (STREQ(featurename, curstr))\n            return 1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverseContextHasNextQuery",
          "args": [
            "ctxt"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverseContextHasNextQuery",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "112-116",
          "snippet": "static bool\nvirQEMUQAPISchemaTraverseContextHasNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    return !!ctxt->queries[0];\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic bool\nvirQEMUQAPISchemaTraverseContextHasNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    return !!ctxt->queries[0];\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_ascii_isalpha",
          "args": [
            "modifier"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverseContextNextQuery",
          "args": [
            "ctxt"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverseContextNextQuery",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "103-109",
          "snippet": "static const char *\nvirQEMUQAPISchemaTraverseContextNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    ctxt->prevquery = ctxt->queries[0];\n    ctxt->queries++;\n    return ctxt->prevquery;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic const char *\nvirQEMUQAPISchemaTraverseContextNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    ctxt->prevquery = ctxt->queries[0];\n    ctxt->queries++;\n    return ctxt->prevquery;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic int\nvirQEMUQAPISchemaTraverseCommand(virJSONValuePtr cur,\n                                 struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    const char *query = virQEMUQAPISchemaTraverseContextNextQuery(ctxt);\n    const char *querytype;\n    char modifier = *query;\n\n    if (!g_ascii_isalpha(modifier))\n        query++;\n\n    /* exit on modifers for other types */\n    if (modifier == '^' || modifier == '!' || modifier == '+' || modifier == '*')\n        return 0;\n\n    if (modifier == '$') {\n        if (virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt))\n            return -3;\n\n        return virQEMUQAPISchemaTraverseHasObjectFeature(query, cur);\n    }\n\n    if (!(querytype = virJSONValueObjectGetString(cur, query)))\n        return 0;\n\n    return virQEMUQAPISchemaTraverse(querytype, ctxt);\n}"
  },
  {
    "function_name": "virQEMUQAPISchemaTraverseArray",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
    "lines": "197-208",
    "snippet": "static int\nvirQEMUQAPISchemaTraverseArray(virJSONValuePtr cur,\n                               struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    const char *querytype;\n\n    /* arrays are just flattened by default */\n    if (!(querytype = virJSONValueObjectGetString(cur, \"element-type\")))\n        return -2;\n\n    return virQEMUQAPISchemaTraverse(querytype, ctxt);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_qapi.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverse",
          "args": [
            "querytype",
            "ctxt"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "351-379",
          "snippet": "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    virJSONValuePtr cur;\n    const char *metatype;\n    size_t i;\n\n    if (virQEMUQAPISchemaTraverseContextValidateDepth(ctxt) < 0)\n        return -2;\n\n    if (!(cur = virHashLookup(ctxt->schema, baseName)))\n        return -2;\n\n    if (!virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt)) {\n        ctxt->returnType = cur;\n        return 1;\n    }\n\n    if (!(metatype = virJSONValueObjectGetString(cur, \"meta-type\")))\n        return -2;\n\n    for (i = 0; i < G_N_ELEMENTS(traverseMetaType); i++) {\n        if (STREQ(metatype, traverseMetaType[i].metatype))\n            return traverseMetaType[i].func(cur, ctxt);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);",
            "static const struct virQEMUQAPISchemaTraverseMetaType traverseMetaType[] = {\n    { \"object\", virQEMUQAPISchemaTraverseObject },\n    { \"array\", virQEMUQAPISchemaTraverseArray },\n    { \"command\", virQEMUQAPISchemaTraverseCommand },\n    { \"event\", virQEMUQAPISchemaTraverseCommand },\n    { \"enum\", virQEMUQAPISchemaTraverseEnum },\n    { \"builtin\", virQEMUQAPISchemaTraverseBuiltin },\n    { \"alternate\", virQEMUQAPISchemaTraverseAlternate },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\nstatic const struct virQEMUQAPISchemaTraverseMetaType traverseMetaType[] = {\n    { \"object\", virQEMUQAPISchemaTraverseObject },\n    { \"array\", virQEMUQAPISchemaTraverseArray },\n    { \"command\", virQEMUQAPISchemaTraverseCommand },\n    { \"event\", virQEMUQAPISchemaTraverseCommand },\n    { \"enum\", virQEMUQAPISchemaTraverseEnum },\n    { \"builtin\", virQEMUQAPISchemaTraverseBuiltin },\n    { \"alternate\", virQEMUQAPISchemaTraverseAlternate },\n};\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    virJSONValuePtr cur;\n    const char *metatype;\n    size_t i;\n\n    if (virQEMUQAPISchemaTraverseContextValidateDepth(ctxt) < 0)\n        return -2;\n\n    if (!(cur = virHashLookup(ctxt->schema, baseName)))\n        return -2;\n\n    if (!virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt)) {\n        ctxt->returnType = cur;\n        return 1;\n    }\n\n    if (!(metatype = virJSONValueObjectGetString(cur, \"meta-type\")))\n        return -2;\n\n    for (i = 0; i < G_N_ELEMENTS(traverseMetaType); i++) {\n        if (STREQ(metatype, traverseMetaType[i].metatype))\n            return traverseMetaType[i].func(cur, ctxt);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetString",
          "args": [
            "cur",
            "\"element-type\""
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetStringOrNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1313-1328",
          "snippet": "const char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic int\nvirQEMUQAPISchemaTraverseArray(virJSONValuePtr cur,\n                               struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    const char *querytype;\n\n    /* arrays are just flattened by default */\n    if (!(querytype = virJSONValueObjectGetString(cur, \"element-type\")))\n        return -2;\n\n    return virQEMUQAPISchemaTraverse(querytype, ctxt);\n}"
  },
  {
    "function_name": "virQEMUQAPISchemaTraverseObject",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
    "lines": "158-194",
    "snippet": "static int\nvirQEMUQAPISchemaTraverseObject(virJSONValuePtr cur,\n                                struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    virJSONValuePtr obj;\n    const char *query = virQEMUQAPISchemaTraverseContextNextQuery(ctxt);\n    char modifier = *query;\n\n    if (!g_ascii_isalpha(modifier))\n        query++;\n\n    /* exit on modifers for other types */\n    if (modifier == '^' || modifier == '!')\n        return 0;\n\n    if (modifier == '$') {\n        if (virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt))\n            return -3;\n\n        return virQEMUQAPISchemaTraverseHasObjectFeature(query, cur);\n    }\n\n    if (modifier == '+') {\n        obj = virQEMUQAPISchemaObjectGet(\"variants\", query, \"case\", cur);\n    } else {\n        obj = virQEMUQAPISchemaObjectGet(\"members\", query, \"name\", cur);\n\n        if (modifier == '*' &&\n            !virJSONValueObjectHasKey(obj, \"default\"))\n            return 0;\n    }\n\n    if (!obj)\n        return 0;\n\n    return virQEMUQAPISchemaTraverse(virJSONValueObjectGetString(obj, \"type\"), ctxt);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_qapi.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverse",
          "args": [
            "virJSONValueObjectGetString(obj, \"type\")",
            "ctxt"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "351-379",
          "snippet": "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    virJSONValuePtr cur;\n    const char *metatype;\n    size_t i;\n\n    if (virQEMUQAPISchemaTraverseContextValidateDepth(ctxt) < 0)\n        return -2;\n\n    if (!(cur = virHashLookup(ctxt->schema, baseName)))\n        return -2;\n\n    if (!virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt)) {\n        ctxt->returnType = cur;\n        return 1;\n    }\n\n    if (!(metatype = virJSONValueObjectGetString(cur, \"meta-type\")))\n        return -2;\n\n    for (i = 0; i < G_N_ELEMENTS(traverseMetaType); i++) {\n        if (STREQ(metatype, traverseMetaType[i].metatype))\n            return traverseMetaType[i].func(cur, ctxt);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);",
            "static const struct virQEMUQAPISchemaTraverseMetaType traverseMetaType[] = {\n    { \"object\", virQEMUQAPISchemaTraverseObject },\n    { \"array\", virQEMUQAPISchemaTraverseArray },\n    { \"command\", virQEMUQAPISchemaTraverseCommand },\n    { \"event\", virQEMUQAPISchemaTraverseCommand },\n    { \"enum\", virQEMUQAPISchemaTraverseEnum },\n    { \"builtin\", virQEMUQAPISchemaTraverseBuiltin },\n    { \"alternate\", virQEMUQAPISchemaTraverseAlternate },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\nstatic const struct virQEMUQAPISchemaTraverseMetaType traverseMetaType[] = {\n    { \"object\", virQEMUQAPISchemaTraverseObject },\n    { \"array\", virQEMUQAPISchemaTraverseArray },\n    { \"command\", virQEMUQAPISchemaTraverseCommand },\n    { \"event\", virQEMUQAPISchemaTraverseCommand },\n    { \"enum\", virQEMUQAPISchemaTraverseEnum },\n    { \"builtin\", virQEMUQAPISchemaTraverseBuiltin },\n    { \"alternate\", virQEMUQAPISchemaTraverseAlternate },\n};\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    virJSONValuePtr cur;\n    const char *metatype;\n    size_t i;\n\n    if (virQEMUQAPISchemaTraverseContextValidateDepth(ctxt) < 0)\n        return -2;\n\n    if (!(cur = virHashLookup(ctxt->schema, baseName)))\n        return -2;\n\n    if (!virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt)) {\n        ctxt->returnType = cur;\n        return 1;\n    }\n\n    if (!(metatype = virJSONValueObjectGetString(cur, \"meta-type\")))\n        return -2;\n\n    for (i = 0; i < G_N_ELEMENTS(traverseMetaType); i++) {\n        if (STREQ(metatype, traverseMetaType[i].metatype))\n            return traverseMetaType[i].func(cur, ctxt);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetString",
          "args": [
            "obj",
            "\"type\""
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetStringOrNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1313-1328",
          "snippet": "const char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectHasKey",
          "args": [
            "obj",
            "\"default\""
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectHasKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "838-853",
          "snippet": "int\nvirJSONValueObjectHasKey(virJSONValuePtr object,\n                         const char *key)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key))\n            return 1;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectHasKey(virJSONValuePtr object,\n                         const char *key)\n{\n    size_t i;\n\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    for (i = 0; i < object->data.object.npairs; i++) {\n        if (STREQ(object->data.object.pairs[i].key, key))\n            return 1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaObjectGet",
          "args": [
            "\"members\"",
            "query",
            "\"name\"",
            "cur"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaObjectGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "43-67",
          "snippet": "static virJSONValuePtr\nvirQEMUQAPISchemaObjectGet(const char *field,\n                           const char *name,\n                           const char *namefield,\n                           virJSONValuePtr elem)\n{\n    virJSONValuePtr arr;\n    virJSONValuePtr cur;\n    const char *curname;\n    size_t i;\n\n    if (!(arr = virJSONValueObjectGetArray(elem, field)))\n        return NULL;\n\n    for (i = 0; i < virJSONValueArraySize(arr); i++) {\n        if (!(cur = virJSONValueArrayGet(arr, i)) ||\n            !(curname = virJSONValueObjectGetString(cur, namefield)))\n            continue;\n\n        if (STREQ(name, curname))\n            return cur;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nvirQEMUQAPISchemaObjectGet(const char *field,\n                           const char *name,\n                           const char *namefield,\n                           virJSONValuePtr elem)\n{\n    virJSONValuePtr arr;\n    virJSONValuePtr cur;\n    const char *curname;\n    size_t i;\n\n    if (!(arr = virJSONValueObjectGetArray(elem, field)))\n        return NULL;\n\n    for (i = 0; i < virJSONValueArraySize(arr); i++) {\n        if (!(cur = virJSONValueArrayGet(arr, i)) ||\n            !(curname = virJSONValueObjectGetString(cur, namefield)))\n            continue;\n\n        if (STREQ(name, curname))\n            return cur;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverseHasObjectFeature",
          "args": [
            "query",
            "cur"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverseHasObjectFeature",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "133-155",
          "snippet": "static int\nvirQEMUQAPISchemaTraverseHasObjectFeature(const char *featurename,\n                                          virJSONValuePtr elem)\n{\n    virJSONValuePtr featuresarray;\n    virJSONValuePtr cur;\n    const char *curstr;\n    size_t i;\n\n    if (!(featuresarray = virJSONValueObjectGetArray(elem, \"features\")))\n        return 0;\n\n    for (i = 0; i < virJSONValueArraySize(featuresarray); i++) {\n        if (!(cur = virJSONValueArrayGet(featuresarray, i)) ||\n            !(curstr = virJSONValueGetString(cur)))\n            return -2;\n\n        if (STREQ(featurename, curstr))\n            return 1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverseHasObjectFeature(const char *featurename,\n                                          virJSONValuePtr elem)\n{\n    virJSONValuePtr featuresarray;\n    virJSONValuePtr cur;\n    const char *curstr;\n    size_t i;\n\n    if (!(featuresarray = virJSONValueObjectGetArray(elem, \"features\")))\n        return 0;\n\n    for (i = 0; i < virJSONValueArraySize(featuresarray); i++) {\n        if (!(cur = virJSONValueArrayGet(featuresarray, i)) ||\n            !(curstr = virJSONValueGetString(cur)))\n            return -2;\n\n        if (STREQ(featurename, curstr))\n            return 1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverseContextHasNextQuery",
          "args": [
            "ctxt"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverseContextHasNextQuery",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "112-116",
          "snippet": "static bool\nvirQEMUQAPISchemaTraverseContextHasNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    return !!ctxt->queries[0];\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic bool\nvirQEMUQAPISchemaTraverseContextHasNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    return !!ctxt->queries[0];\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_ascii_isalpha",
          "args": [
            "modifier"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virQEMUQAPISchemaTraverseContextNextQuery",
          "args": [
            "ctxt"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUQAPISchemaTraverseContextNextQuery",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
          "lines": "103-109",
          "snippet": "static const char *\nvirQEMUQAPISchemaTraverseContextNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    ctxt->prevquery = ctxt->queries[0];\n    ctxt->queries++;\n    return ctxt->prevquery;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_qapi.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic const char *\nvirQEMUQAPISchemaTraverseContextNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    ctxt->prevquery = ctxt->queries[0];\n    ctxt->queries++;\n    return ctxt->prevquery;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic int\nvirQEMUQAPISchemaTraverseObject(virJSONValuePtr cur,\n                                struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    virJSONValuePtr obj;\n    const char *query = virQEMUQAPISchemaTraverseContextNextQuery(ctxt);\n    char modifier = *query;\n\n    if (!g_ascii_isalpha(modifier))\n        query++;\n\n    /* exit on modifers for other types */\n    if (modifier == '^' || modifier == '!')\n        return 0;\n\n    if (modifier == '$') {\n        if (virQEMUQAPISchemaTraverseContextHasNextQuery(ctxt))\n            return -3;\n\n        return virQEMUQAPISchemaTraverseHasObjectFeature(query, cur);\n    }\n\n    if (modifier == '+') {\n        obj = virQEMUQAPISchemaObjectGet(\"variants\", query, \"case\", cur);\n    } else {\n        obj = virQEMUQAPISchemaObjectGet(\"members\", query, \"name\", cur);\n\n        if (modifier == '*' &&\n            !virJSONValueObjectHasKey(obj, \"default\"))\n            return 0;\n    }\n\n    if (!obj)\n        return 0;\n\n    return virQEMUQAPISchemaTraverse(virJSONValueObjectGetString(obj, \"type\"), ctxt);\n}"
  },
  {
    "function_name": "virQEMUQAPISchemaTraverseHasObjectFeature",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
    "lines": "133-155",
    "snippet": "static int\nvirQEMUQAPISchemaTraverseHasObjectFeature(const char *featurename,\n                                          virJSONValuePtr elem)\n{\n    virJSONValuePtr featuresarray;\n    virJSONValuePtr cur;\n    const char *curstr;\n    size_t i;\n\n    if (!(featuresarray = virJSONValueObjectGetArray(elem, \"features\")))\n        return 0;\n\n    for (i = 0; i < virJSONValueArraySize(featuresarray); i++) {\n        if (!(cur = virJSONValueArrayGet(featuresarray, i)) ||\n            !(curstr = virJSONValueGetString(cur)))\n            return -2;\n\n        if (STREQ(featurename, curstr))\n            return 1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_qapi.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "featurename",
            "curstr"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueGetString",
          "args": [
            "cur"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueGetString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1115-1122",
          "snippet": "const char *\nvirJSONValueGetString(virJSONValuePtr string)\n{\n    if (string->type != VIR_JSON_TYPE_STRING)\n        return NULL;\n\n    return string->data.string;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueGetString(virJSONValuePtr string)\n{\n    if (string->type != VIR_JSON_TYPE_STRING)\n        return NULL;\n\n    return string->data.string;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayGet",
          "args": [
            "featuresarray",
            "i"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1024-1035",
          "snippet": "virJSONValuePtr\nvirJSONValueArrayGet(virJSONValuePtr array,\n                     unsigned int element)\n{\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return NULL;\n\n    if (element >= array->data.array.nvalues)\n        return NULL;\n\n    return array->data.array.values[element];\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueArrayGet(virJSONValuePtr array,\n                     unsigned int element)\n{\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return NULL;\n\n    if (element >= array->data.array.nvalues)\n        return NULL;\n\n    return array->data.array.values[element];\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueArraySize",
          "args": [
            "featuresarray"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArraySize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1017-1021",
          "snippet": "size_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nsize_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetArray",
          "args": [
            "elem",
            "\"features\""
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverseHasObjectFeature(const char *featurename,\n                                          virJSONValuePtr elem)\n{\n    virJSONValuePtr featuresarray;\n    virJSONValuePtr cur;\n    const char *curstr;\n    size_t i;\n\n    if (!(featuresarray = virJSONValueObjectGetArray(elem, \"features\")))\n        return 0;\n\n    for (i = 0; i < virJSONValueArraySize(featuresarray); i++) {\n        if (!(cur = virJSONValueArrayGet(featuresarray, i)) ||\n            !(curstr = virJSONValueGetString(cur)))\n            return -2;\n\n        if (STREQ(featurename, curstr))\n            return 1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUQAPISchemaTraverseContextHasNextQuery",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
    "lines": "112-116",
    "snippet": "static bool\nvirQEMUQAPISchemaTraverseContextHasNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    return !!ctxt->queries[0];\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_qapi.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic bool\nvirQEMUQAPISchemaTraverseContextHasNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    return !!ctxt->queries[0];\n}"
  },
  {
    "function_name": "virQEMUQAPISchemaTraverseContextNextQuery",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
    "lines": "103-109",
    "snippet": "static const char *\nvirQEMUQAPISchemaTraverseContextNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    ctxt->prevquery = ctxt->queries[0];\n    ctxt->queries++;\n    return ctxt->prevquery;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_qapi.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic const char *\nvirQEMUQAPISchemaTraverseContextNextQuery(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    ctxt->prevquery = ctxt->queries[0];\n    ctxt->queries++;\n    return ctxt->prevquery;\n}"
  },
  {
    "function_name": "virQEMUQAPISchemaTraverseContextInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
    "lines": "92-100",
    "snippet": "static void\nvirQEMUQAPISchemaTraverseContextInit(struct virQEMUQAPISchemaTraverseContext *ctxt,\n                                     char **queries,\n                                     virHashTablePtr schema)\n{\n    memset(ctxt, 0, sizeof(*ctxt));\n    ctxt->schema = schema;\n    ctxt->queries = queries;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_qapi.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "ctxt",
            "0",
            "sizeof(*ctxt)"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic void\nvirQEMUQAPISchemaTraverseContextInit(struct virQEMUQAPISchemaTraverseContext *ctxt,\n                                     char **queries,\n                                     virHashTablePtr schema)\n{\n    memset(ctxt, 0, sizeof(*ctxt));\n    ctxt->schema = schema;\n    ctxt->queries = queries;\n}"
  },
  {
    "function_name": "virQEMUQAPISchemaTraverseContextValidateDepth",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
    "lines": "79-89",
    "snippet": "static int\nvirQEMUQAPISchemaTraverseContextValidateDepth(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    if (ctxt->depth++ > 1000) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"possible loop in QMP schema\"));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_qapi.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"possible loop in QMP schema\")"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"possible loop in QMP schema\""
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic int\nvirQEMUQAPISchemaTraverse(const char *baseName,\n                          struct virQEMUQAPISchemaTraverseContext *ctxt);\n\nstatic int\nvirQEMUQAPISchemaTraverseContextValidateDepth(struct virQEMUQAPISchemaTraverseContext *ctxt)\n{\n    if (ctxt->depth++ > 1000) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"possible loop in QMP schema\"));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUQAPISchemaObjectGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_qapi.c",
    "lines": "43-67",
    "snippet": "static virJSONValuePtr\nvirQEMUQAPISchemaObjectGet(const char *field,\n                           const char *name,\n                           const char *namefield,\n                           virJSONValuePtr elem)\n{\n    virJSONValuePtr arr;\n    virJSONValuePtr cur;\n    const char *curname;\n    size_t i;\n\n    if (!(arr = virJSONValueObjectGetArray(elem, field)))\n        return NULL;\n\n    for (i = 0; i < virJSONValueArraySize(arr); i++) {\n        if (!(cur = virJSONValueArrayGet(arr, i)) ||\n            !(curname = virJSONValueObjectGetString(cur, namefield)))\n            continue;\n\n        if (STREQ(name, curname))\n            return cur;\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_qapi.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "name",
            "curname"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetString",
          "args": [
            "cur",
            "namefield"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetStringOrNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1313-1328",
          "snippet": "const char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayGet",
          "args": [
            "arr",
            "i"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1024-1035",
          "snippet": "virJSONValuePtr\nvirJSONValueArrayGet(virJSONValuePtr array,\n                     unsigned int element)\n{\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return NULL;\n\n    if (element >= array->data.array.nvalues)\n        return NULL;\n\n    return array->data.array.values[element];\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueArrayGet(virJSONValuePtr array,\n                     unsigned int element)\n{\n    if (array->type != VIR_JSON_TYPE_ARRAY)\n        return NULL;\n\n    if (element >= array->data.array.nvalues)\n        return NULL;\n\n    return array->data.array.values[element];\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueArraySize",
          "args": [
            "arr"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArraySize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1017-1021",
          "snippet": "size_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nsize_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetArray",
          "args": [
            "elem",
            "field"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1422-1426",
          "snippet": "virJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueObjectGetArray(virJSONValuePtr object, const char *key)\n{\n    return virJSONValueObjectGetByType(object, key, VIR_JSON_TYPE_ARRAY);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_qapi.h\"\n#include <config.h>\n\nstatic virJSONValuePtr\nvirQEMUQAPISchemaObjectGet(const char *field,\n                           const char *name,\n                           const char *namefield,\n                           virJSONValuePtr elem)\n{\n    virJSONValuePtr arr;\n    virJSONValuePtr cur;\n    const char *curname;\n    size_t i;\n\n    if (!(arr = virJSONValueObjectGetArray(elem, field)))\n        return NULL;\n\n    for (i = 0; i < virJSONValueArraySize(arr); i++) {\n        if (!(cur = virJSONValueArrayGet(arr, i)) ||\n            !(curname = virJSONValueObjectGetString(cur, namefield)))\n            continue;\n\n        if (STREQ(name, curname))\n            return cur;\n    }\n\n    return NULL;\n}"
  }
]