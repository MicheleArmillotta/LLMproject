[
  {
    "function_name": "virFirewallDInterfaceSetZone",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewalld.c",
    "lines": "353-372",
    "snippet": "int\nvirFirewallDInterfaceSetZone(const char *iface,\n                             const char *zone)\n{\n    DBusConnection *sysbus = virDBusGetSystemBus();\n\n    if (!sysbus)\n        return -1;\n\n    return virDBusCallMethod(sysbus,\n                             NULL,\n                             NULL,\n                             VIR_FIREWALL_FIREWALLD_SERVICE,\n                             \"/org/fedoraproject/FirewallD1\",\n                             \"org.fedoraproject.FirewallD1.zone\",\n                             \"changeZoneOfInterface\",\n                             \"ss\",\n                             zone,\n                             iface);\n}",
    "includes": [
      "#include \"virenum.h\"",
      "#include \"virdbus.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfirewalldpriv.h\"",
      "#include \"virfirewalld.h\"",
      "#include \"virfirewall.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDBusCallMethod",
          "args": [
            "sysbus",
            "NULL",
            "NULL",
            "VIR_FIREWALL_FIREWALLD_SERVICE",
            "\"/org/fedoraproject/FirewallD1\"",
            "\"org.fedoraproject.FirewallD1.zone\"",
            "\"changeZoneOfInterface\"",
            "\"ss\"",
            "zone",
            "iface"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusCallMethod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1813-1825",
          "snippet": "int virDBusCallMethod(DBusConnection *conn G_GNUC_UNUSED,\n                      DBusMessage **reply G_GNUC_UNUSED,\n                      virErrorPtr error G_GNUC_UNUSED,\n                      const char *destination G_GNUC_UNUSED,\n                      const char *path G_GNUC_UNUSED,\n                      const char *iface G_GNUC_UNUSED,\n                      const char *member G_GNUC_UNUSED,\n                      const char *types G_GNUC_UNUSED, ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nint virDBusCallMethod(DBusConnection *conn G_GNUC_UNUSED,\n                      DBusMessage **reply G_GNUC_UNUSED,\n                      virErrorPtr error G_GNUC_UNUSED,\n                      const char *destination G_GNUC_UNUSED,\n                      const char *path G_GNUC_UNUSED,\n                      const char *iface G_GNUC_UNUSED,\n                      const char *member G_GNUC_UNUSED,\n                      const char *types G_GNUC_UNUSED, ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDBusGetSystemBus",
          "args": [],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusGetSystemBus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1744-1749",
          "snippet": "DBusConnection *virDBusGetSystemBus(void)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return NULL;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nDBusConnection *virDBusGetSystemBus(void)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virenum.h\"\n#include \"virdbus.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalldpriv.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewall.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirFirewallDInterfaceSetZone(const char *iface,\n                             const char *zone)\n{\n    DBusConnection *sysbus = virDBusGetSystemBus();\n\n    if (!sysbus)\n        return -1;\n\n    return virDBusCallMethod(sysbus,\n                             NULL,\n                             NULL,\n                             VIR_FIREWALL_FIREWALLD_SERVICE,\n                             \"/org/fedoraproject/FirewallD1\",\n                             \"org.fedoraproject.FirewallD1.zone\",\n                             \"changeZoneOfInterface\",\n                             \"ss\",\n                             zone,\n                             iface);\n}"
  },
  {
    "function_name": "virFirewallDApplyRule",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewalld.c",
    "lines": "269-350",
    "snippet": "int\nvirFirewallDApplyRule(virFirewallLayer layer,\n                      char **args, size_t argsLen,\n                      bool ignoreErrors,\n                      char **output)\n{\n    const char *ipv = virFirewallLayerFirewallDTypeToString(layer);\n    DBusConnection *sysbus = virDBusGetSystemBus();\n    DBusMessage *reply = NULL;\n    virError error;\n    int ret = -1;\n\n    if (!sysbus)\n        return -1;\n\n    memset(&error, 0, sizeof(error));\n\n    if (!ipv) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unknown firewall layer %d\"),\n                       layer);\n        goto cleanup;\n    }\n\n    if (virDBusCallMethod(sysbus,\n                          &reply,\n                          &error,\n                          VIR_FIREWALL_FIREWALLD_SERVICE,\n                          \"/org/fedoraproject/FirewallD1\",\n                          \"org.fedoraproject.FirewallD1.direct\",\n                          \"passthrough\",\n                          \"sa&s\",\n                          ipv,\n                          (int)argsLen,\n                          args) < 0)\n        goto cleanup;\n\n    if (error.level == VIR_ERR_ERROR) {\n        /*\n         * As of firewalld-0.3.9.3-1.fc20.noarch the name and\n         * message fields in the error look like\n         *\n         *    name=\"org.freedesktop.DBus.Python.dbus.exceptions.DBusException\"\n         * message=\"COMMAND_FAILED: '/sbin/iptables --table filter --delete\n         *          INPUT --in-interface virbr0 --protocol udp --destination-port 53\n         *          --jump ACCEPT' failed: iptables: Bad rule (does a matching rule\n         *          exist in that chain?).\"\n         *\n         * We'd like to only ignore DBus errors precisely related to the failure\n         * of iptables/ebtables commands. A well designed DBus interface would\n         * return specific named exceptions not the top level generic python dbus\n         * exception name. With this current scheme our only option is todo a\n         * sub-string match for 'COMMAND_FAILED' on the message. eg like\n         *\n         * if (ignoreErrors &&\n         *     STREQ(error.name,\n         *           \"org.freedesktop.DBus.Python.dbus.exceptions.DBusException\") &&\n         *     STRPREFIX(error.message, \"COMMAND_FAILED\"))\n         *    ...\n         *\n         * But this risks our error detecting code being broken if firewalld changes\n         * ever alter the message string, so we're avoiding doing that.\n         */\n        if (ignoreErrors) {\n            VIR_DEBUG(\"Ignoring error '%s': '%s'\",\n                      error.str1, error.message);\n        } else {\n            virReportErrorObject(&error);\n            goto cleanup;\n        }\n    } else {\n        if (virDBusMessageDecode(reply, \"s\", output) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virResetError(&error);\n    virDBusMessageUnref(reply);\n    return ret;\n}",
    "includes": [
      "#include \"virenum.h\"",
      "#include \"virdbus.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfirewalldpriv.h\"",
      "#include \"virfirewalld.h\"",
      "#include \"virfirewall.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDBusMessageUnref",
          "args": [
            "reply"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusMessageUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1858-1861",
          "snippet": "void virDBusMessageUnref(DBusMessage *msg G_GNUC_UNUSED)\n{\n    /* nothing */\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nvoid virDBusMessageUnref(DBusMessage *msg G_GNUC_UNUSED)\n{\n    /* nothing */\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetError",
          "args": [
            "&error"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "virResetError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "466-476",
          "snippet": "void\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDBusMessageDecode",
          "args": [
            "reply",
            "\"s\"",
            "output"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusMessageDecode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1837-1844",
          "snippet": "int virDBusMessageDecode(DBusMessage* msg G_GNUC_UNUSED,\n                         const char *types G_GNUC_UNUSED,\n                         ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nint virDBusMessageDecode(DBusMessage* msg G_GNUC_UNUSED,\n                         const char *types G_GNUC_UNUSED,\n                         ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportErrorObject",
          "args": [
            "&error"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Ignoring error '%s': '%s'\"",
            "error.str1",
            "error.message"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDBusCallMethod",
          "args": [
            "sysbus",
            "&reply",
            "&error",
            "VIR_FIREWALL_FIREWALLD_SERVICE",
            "\"/org/fedoraproject/FirewallD1\"",
            "\"org.fedoraproject.FirewallD1.direct\"",
            "\"passthrough\"",
            "\"sa&s\"",
            "ipv",
            "(int)argsLen",
            "args"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusCallMethod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1813-1825",
          "snippet": "int virDBusCallMethod(DBusConnection *conn G_GNUC_UNUSED,\n                      DBusMessage **reply G_GNUC_UNUSED,\n                      virErrorPtr error G_GNUC_UNUSED,\n                      const char *destination G_GNUC_UNUSED,\n                      const char *path G_GNUC_UNUSED,\n                      const char *iface G_GNUC_UNUSED,\n                      const char *member G_GNUC_UNUSED,\n                      const char *types G_GNUC_UNUSED, ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nint virDBusCallMethod(DBusConnection *conn G_GNUC_UNUSED,\n                      DBusMessage **reply G_GNUC_UNUSED,\n                      virErrorPtr error G_GNUC_UNUSED,\n                      const char *destination G_GNUC_UNUSED,\n                      const char *path G_GNUC_UNUSED,\n                      const char *iface G_GNUC_UNUSED,\n                      const char *member G_GNUC_UNUSED,\n                      const char *types G_GNUC_UNUSED, ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unknown firewall layer %d\")",
            "layer"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unknown firewall layer %d\""
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&error",
            "0",
            "sizeof(error)"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDBusGetSystemBus",
          "args": [],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusGetSystemBus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1744-1749",
          "snippet": "DBusConnection *virDBusGetSystemBus(void)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return NULL;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nDBusConnection *virDBusGetSystemBus(void)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFirewallLayerFirewallDTypeToString",
          "args": [
            "layer"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virenum.h\"\n#include \"virdbus.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalldpriv.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewall.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirFirewallDApplyRule(virFirewallLayer layer,\n                      char **args, size_t argsLen,\n                      bool ignoreErrors,\n                      char **output)\n{\n    const char *ipv = virFirewallLayerFirewallDTypeToString(layer);\n    DBusConnection *sysbus = virDBusGetSystemBus();\n    DBusMessage *reply = NULL;\n    virError error;\n    int ret = -1;\n\n    if (!sysbus)\n        return -1;\n\n    memset(&error, 0, sizeof(error));\n\n    if (!ipv) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unknown firewall layer %d\"),\n                       layer);\n        goto cleanup;\n    }\n\n    if (virDBusCallMethod(sysbus,\n                          &reply,\n                          &error,\n                          VIR_FIREWALL_FIREWALLD_SERVICE,\n                          \"/org/fedoraproject/FirewallD1\",\n                          \"org.fedoraproject.FirewallD1.direct\",\n                          \"passthrough\",\n                          \"sa&s\",\n                          ipv,\n                          (int)argsLen,\n                          args) < 0)\n        goto cleanup;\n\n    if (error.level == VIR_ERR_ERROR) {\n        /*\n         * As of firewalld-0.3.9.3-1.fc20.noarch the name and\n         * message fields in the error look like\n         *\n         *    name=\"org.freedesktop.DBus.Python.dbus.exceptions.DBusException\"\n         * message=\"COMMAND_FAILED: '/sbin/iptables --table filter --delete\n         *          INPUT --in-interface virbr0 --protocol udp --destination-port 53\n         *          --jump ACCEPT' failed: iptables: Bad rule (does a matching rule\n         *          exist in that chain?).\"\n         *\n         * We'd like to only ignore DBus errors precisely related to the failure\n         * of iptables/ebtables commands. A well designed DBus interface would\n         * return specific named exceptions not the top level generic python dbus\n         * exception name. With this current scheme our only option is todo a\n         * sub-string match for 'COMMAND_FAILED' on the message. eg like\n         *\n         * if (ignoreErrors &&\n         *     STREQ(error.name,\n         *           \"org.freedesktop.DBus.Python.dbus.exceptions.DBusException\") &&\n         *     STRPREFIX(error.message, \"COMMAND_FAILED\"))\n         *    ...\n         *\n         * But this risks our error detecting code being broken if firewalld changes\n         * ever alter the message string, so we're avoiding doing that.\n         */\n        if (ignoreErrors) {\n            VIR_DEBUG(\"Ignoring error '%s': '%s'\",\n                      error.str1, error.message);\n        } else {\n            virReportErrorObject(&error);\n            goto cleanup;\n        }\n    } else {\n        if (virDBusMessageDecode(reply, \"s\", output) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virResetError(&error);\n    virDBusMessageUnref(reply);\n    return ret;\n}"
  },
  {
    "function_name": "virFirewallDZoneExists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewalld.c",
    "lines": "235-257",
    "snippet": "bool\nvirFirewallDZoneExists(const char *match)\n{\n    size_t nzones = 0, i;\n    char **zones = NULL;\n    bool result = false;\n\n    if (virFirewallDGetZones(&zones, &nzones) < 0)\n        goto cleanup;\n\n    for (i = 0; i < nzones; i++) {\n        if (STREQ_NULLABLE(zones[i], match))\n            result = true;\n    }\n\n cleanup:\n    VIR_DEBUG(\"Requested zone '%s' %s exist\",\n              match, result ? \"does\" : \"doesn't\");\n    for (i = 0; i < nzones; i++)\n       VIR_FREE(zones[i]);\n    VIR_FREE(zones);\n    return result;\n}",
    "includes": [
      "#include \"virenum.h\"",
      "#include \"virdbus.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfirewalldpriv.h\"",
      "#include \"virfirewalld.h\"",
      "#include \"virfirewall.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "zones"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "zones[i]"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Requested zone '%s' %s exist\"",
            "match",
            "result ? \"does\" : \"doesn't\""
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "zones[i]",
            "match"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFirewallDGetZones",
          "args": [
            "&zones",
            "&nzones"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallDGetZones",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewalld.c",
          "lines": "196-226",
          "snippet": "int\nvirFirewallDGetZones(char ***zones, size_t *nzones)\n{\n    DBusConnection *sysbus = virDBusGetSystemBus();\n    DBusMessage *reply = NULL;\n    int ret = -1;\n\n    *nzones = 0;\n    *zones = NULL;\n\n    if (!sysbus)\n        return -1;\n\n    if (virDBusCallMethod(sysbus,\n                          &reply,\n                          NULL,\n                          VIR_FIREWALL_FIREWALLD_SERVICE,\n                          \"/org/fedoraproject/FirewallD1\",\n                          \"org.fedoraproject.FirewallD1.zone\",\n                          \"getZones\",\n                          NULL) < 0)\n        goto cleanup;\n\n    if (virDBusMessageDecode(reply, \"a&s\", nzones, zones) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virDBusMessageUnref(reply);\n    return ret;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virdbus.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalldpriv.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewall.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virdbus.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalldpriv.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewall.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirFirewallDGetZones(char ***zones, size_t *nzones)\n{\n    DBusConnection *sysbus = virDBusGetSystemBus();\n    DBusMessage *reply = NULL;\n    int ret = -1;\n\n    *nzones = 0;\n    *zones = NULL;\n\n    if (!sysbus)\n        return -1;\n\n    if (virDBusCallMethod(sysbus,\n                          &reply,\n                          NULL,\n                          VIR_FIREWALL_FIREWALLD_SERVICE,\n                          \"/org/fedoraproject/FirewallD1\",\n                          \"org.fedoraproject.FirewallD1.zone\",\n                          \"getZones\",\n                          NULL) < 0)\n        goto cleanup;\n\n    if (virDBusMessageDecode(reply, \"a&s\", nzones, zones) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virDBusMessageUnref(reply);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virenum.h\"\n#include \"virdbus.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalldpriv.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewall.h\"\n#include <stdarg.h>\n#include <config.h>\n\nbool\nvirFirewallDZoneExists(const char *match)\n{\n    size_t nzones = 0, i;\n    char **zones = NULL;\n    bool result = false;\n\n    if (virFirewallDGetZones(&zones, &nzones) < 0)\n        goto cleanup;\n\n    for (i = 0; i < nzones; i++) {\n        if (STREQ_NULLABLE(zones[i], match))\n            result = true;\n    }\n\n cleanup:\n    VIR_DEBUG(\"Requested zone '%s' %s exist\",\n              match, result ? \"does\" : \"doesn't\");\n    for (i = 0; i < nzones; i++)\n       VIR_FREE(zones[i]);\n    VIR_FREE(zones);\n    return result;\n}"
  },
  {
    "function_name": "virFirewallDGetZones",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewalld.c",
    "lines": "196-226",
    "snippet": "int\nvirFirewallDGetZones(char ***zones, size_t *nzones)\n{\n    DBusConnection *sysbus = virDBusGetSystemBus();\n    DBusMessage *reply = NULL;\n    int ret = -1;\n\n    *nzones = 0;\n    *zones = NULL;\n\n    if (!sysbus)\n        return -1;\n\n    if (virDBusCallMethod(sysbus,\n                          &reply,\n                          NULL,\n                          VIR_FIREWALL_FIREWALLD_SERVICE,\n                          \"/org/fedoraproject/FirewallD1\",\n                          \"org.fedoraproject.FirewallD1.zone\",\n                          \"getZones\",\n                          NULL) < 0)\n        goto cleanup;\n\n    if (virDBusMessageDecode(reply, \"a&s\", nzones, zones) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virDBusMessageUnref(reply);\n    return ret;\n}",
    "includes": [
      "#include \"virenum.h\"",
      "#include \"virdbus.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfirewalldpriv.h\"",
      "#include \"virfirewalld.h\"",
      "#include \"virfirewall.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDBusMessageUnref",
          "args": [
            "reply"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusMessageUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1858-1861",
          "snippet": "void virDBusMessageUnref(DBusMessage *msg G_GNUC_UNUSED)\n{\n    /* nothing */\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nvoid virDBusMessageUnref(DBusMessage *msg G_GNUC_UNUSED)\n{\n    /* nothing */\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDBusMessageDecode",
          "args": [
            "reply",
            "\"a&s\"",
            "nzones",
            "zones"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusMessageDecode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1837-1844",
          "snippet": "int virDBusMessageDecode(DBusMessage* msg G_GNUC_UNUSED,\n                         const char *types G_GNUC_UNUSED,\n                         ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nint virDBusMessageDecode(DBusMessage* msg G_GNUC_UNUSED,\n                         const char *types G_GNUC_UNUSED,\n                         ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDBusCallMethod",
          "args": [
            "sysbus",
            "&reply",
            "NULL",
            "VIR_FIREWALL_FIREWALLD_SERVICE",
            "\"/org/fedoraproject/FirewallD1\"",
            "\"org.fedoraproject.FirewallD1.zone\"",
            "\"getZones\"",
            "NULL"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusCallMethod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1813-1825",
          "snippet": "int virDBusCallMethod(DBusConnection *conn G_GNUC_UNUSED,\n                      DBusMessage **reply G_GNUC_UNUSED,\n                      virErrorPtr error G_GNUC_UNUSED,\n                      const char *destination G_GNUC_UNUSED,\n                      const char *path G_GNUC_UNUSED,\n                      const char *iface G_GNUC_UNUSED,\n                      const char *member G_GNUC_UNUSED,\n                      const char *types G_GNUC_UNUSED, ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nint virDBusCallMethod(DBusConnection *conn G_GNUC_UNUSED,\n                      DBusMessage **reply G_GNUC_UNUSED,\n                      virErrorPtr error G_GNUC_UNUSED,\n                      const char *destination G_GNUC_UNUSED,\n                      const char *path G_GNUC_UNUSED,\n                      const char *iface G_GNUC_UNUSED,\n                      const char *member G_GNUC_UNUSED,\n                      const char *types G_GNUC_UNUSED, ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDBusGetSystemBus",
          "args": [],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusGetSystemBus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1744-1749",
          "snippet": "DBusConnection *virDBusGetSystemBus(void)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return NULL;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nDBusConnection *virDBusGetSystemBus(void)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virenum.h\"\n#include \"virdbus.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalldpriv.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewall.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirFirewallDGetZones(char ***zones, size_t *nzones)\n{\n    DBusConnection *sysbus = virDBusGetSystemBus();\n    DBusMessage *reply = NULL;\n    int ret = -1;\n\n    *nzones = 0;\n    *zones = NULL;\n\n    if (!sysbus)\n        return -1;\n\n    if (virDBusCallMethod(sysbus,\n                          &reply,\n                          NULL,\n                          VIR_FIREWALL_FIREWALLD_SERVICE,\n                          \"/org/fedoraproject/FirewallD1\",\n                          \"org.fedoraproject.FirewallD1.zone\",\n                          \"getZones\",\n                          NULL) < 0)\n        goto cleanup;\n\n    if (virDBusMessageDecode(reply, \"a&s\", nzones, zones) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virDBusMessageUnref(reply);\n    return ret;\n}"
  },
  {
    "function_name": "virFirewallDGetBackend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewalld.c",
    "lines": "129-182",
    "snippet": "int\nvirFirewallDGetBackend(void)\n{\n    DBusConnection *sysbus = virDBusGetSystemBus();\n    DBusMessage *reply = NULL;\n    virError error;\n    g_autofree char *backendStr = NULL;\n    int backend = -1;\n\n    if (!sysbus)\n        return -1;\n\n    memset(&error, 0, sizeof(error));\n\n    if (virDBusCallMethod(sysbus,\n                          &reply,\n                          &error,\n                          VIR_FIREWALL_FIREWALLD_SERVICE,\n                          \"/org/fedoraproject/FirewallD1/config\",\n                          \"org.freedesktop.DBus.Properties\",\n                          \"Get\",\n                          \"ss\",\n                          \"org.fedoraproject.FirewallD1.config\",\n                          \"FirewallBackend\") < 0)\n        goto cleanup;\n\n    if (error.level == VIR_ERR_ERROR) {\n        /* we don't want to log any error in the case that\n         * FirewallBackend isn't implemented in this firewalld, since\n         * that just means that it is an old version, and only has an\n         * iptables backend.\n         */\n        VIR_DEBUG(\"Failed to get FirewallBackend setting, assuming 'iptables'\");\n        backend = VIR_FIREWALLD_BACKEND_IPTABLES;\n        goto cleanup;\n    }\n\n    if (virDBusMessageDecode(reply, \"v\", \"s\", &backendStr) < 0)\n        goto cleanup;\n\n    VIR_DEBUG(\"FirewallD backend: %s\", backendStr);\n\n    if ((backend = virFirewallDBackendTypeFromString(backendStr)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unrecognized firewalld backend type: %s\"),\n                       backendStr);\n        goto cleanup;\n    }\n\n cleanup:\n    virResetError(&error);\n    virDBusMessageUnref(reply);\n    return backend;\n}",
    "includes": [
      "#include \"virenum.h\"",
      "#include \"virdbus.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfirewalldpriv.h\"",
      "#include \"virfirewalld.h\"",
      "#include \"virfirewall.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDBusMessageUnref",
          "args": [
            "reply"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusMessageUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1858-1861",
          "snippet": "void virDBusMessageUnref(DBusMessage *msg G_GNUC_UNUSED)\n{\n    /* nothing */\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nvoid virDBusMessageUnref(DBusMessage *msg G_GNUC_UNUSED)\n{\n    /* nothing */\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetError",
          "args": [
            "&error"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "virResetError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "466-476",
          "snippet": "void\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unrecognized firewalld backend type: %s\")",
            "backendStr"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unrecognized firewalld backend type: %s\""
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFirewallDBackendTypeFromString",
          "args": [
            "backendStr"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"FirewallD backend: %s\"",
            "backendStr"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDBusMessageDecode",
          "args": [
            "reply",
            "\"v\"",
            "\"s\"",
            "&backendStr"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusMessageDecode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1837-1844",
          "snippet": "int virDBusMessageDecode(DBusMessage* msg G_GNUC_UNUSED,\n                         const char *types G_GNUC_UNUSED,\n                         ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nint virDBusMessageDecode(DBusMessage* msg G_GNUC_UNUSED,\n                         const char *types G_GNUC_UNUSED,\n                         ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Failed to get FirewallBackend setting, assuming 'iptables'\""
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDBusCallMethod",
          "args": [
            "sysbus",
            "&reply",
            "&error",
            "VIR_FIREWALL_FIREWALLD_SERVICE",
            "\"/org/fedoraproject/FirewallD1/config\"",
            "\"org.freedesktop.DBus.Properties\"",
            "\"Get\"",
            "\"ss\"",
            "\"org.fedoraproject.FirewallD1.config\"",
            "\"FirewallBackend\""
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusCallMethod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1813-1825",
          "snippet": "int virDBusCallMethod(DBusConnection *conn G_GNUC_UNUSED,\n                      DBusMessage **reply G_GNUC_UNUSED,\n                      virErrorPtr error G_GNUC_UNUSED,\n                      const char *destination G_GNUC_UNUSED,\n                      const char *path G_GNUC_UNUSED,\n                      const char *iface G_GNUC_UNUSED,\n                      const char *member G_GNUC_UNUSED,\n                      const char *types G_GNUC_UNUSED, ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nint virDBusCallMethod(DBusConnection *conn G_GNUC_UNUSED,\n                      DBusMessage **reply G_GNUC_UNUSED,\n                      virErrorPtr error G_GNUC_UNUSED,\n                      const char *destination G_GNUC_UNUSED,\n                      const char *path G_GNUC_UNUSED,\n                      const char *iface G_GNUC_UNUSED,\n                      const char *member G_GNUC_UNUSED,\n                      const char *types G_GNUC_UNUSED, ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&error",
            "0",
            "sizeof(error)"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDBusGetSystemBus",
          "args": [],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusGetSystemBus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1744-1749",
          "snippet": "DBusConnection *virDBusGetSystemBus(void)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return NULL;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nDBusConnection *virDBusGetSystemBus(void)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virenum.h\"\n#include \"virdbus.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalldpriv.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewall.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirFirewallDGetBackend(void)\n{\n    DBusConnection *sysbus = virDBusGetSystemBus();\n    DBusMessage *reply = NULL;\n    virError error;\n    g_autofree char *backendStr = NULL;\n    int backend = -1;\n\n    if (!sysbus)\n        return -1;\n\n    memset(&error, 0, sizeof(error));\n\n    if (virDBusCallMethod(sysbus,\n                          &reply,\n                          &error,\n                          VIR_FIREWALL_FIREWALLD_SERVICE,\n                          \"/org/fedoraproject/FirewallD1/config\",\n                          \"org.freedesktop.DBus.Properties\",\n                          \"Get\",\n                          \"ss\",\n                          \"org.fedoraproject.FirewallD1.config\",\n                          \"FirewallBackend\") < 0)\n        goto cleanup;\n\n    if (error.level == VIR_ERR_ERROR) {\n        /* we don't want to log any error in the case that\n         * FirewallBackend isn't implemented in this firewalld, since\n         * that just means that it is an old version, and only has an\n         * iptables backend.\n         */\n        VIR_DEBUG(\"Failed to get FirewallBackend setting, assuming 'iptables'\");\n        backend = VIR_FIREWALLD_BACKEND_IPTABLES;\n        goto cleanup;\n    }\n\n    if (virDBusMessageDecode(reply, \"v\", \"s\", &backendStr) < 0)\n        goto cleanup;\n\n    VIR_DEBUG(\"FirewallD backend: %s\", backendStr);\n\n    if ((backend = virFirewallDBackendTypeFromString(backendStr)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unrecognized firewalld backend type: %s\"),\n                       backendStr);\n        goto cleanup;\n    }\n\n cleanup:\n    virResetError(&error);\n    virDBusMessageUnref(reply);\n    return backend;\n}"
  },
  {
    "function_name": "virFirewallDGetVersion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewalld.c",
    "lines": "82-121",
    "snippet": "int\nvirFirewallDGetVersion(unsigned long *version)\n{\n    int ret = -1;\n    DBusConnection *sysbus = virDBusGetSystemBus();\n    DBusMessage *reply = NULL;\n    g_autofree char *versionStr = NULL;\n\n    if (!sysbus)\n        return -1;\n\n    if (virDBusCallMethod(sysbus,\n                          &reply,\n                          NULL,\n                          VIR_FIREWALL_FIREWALLD_SERVICE,\n                          \"/org/fedoraproject/FirewallD1\",\n                          \"org.freedesktop.DBus.Properties\",\n                          \"Get\",\n                          \"ss\",\n                          \"org.fedoraproject.FirewallD1\",\n                          \"version\") < 0)\n        goto cleanup;\n\n    if (virDBusMessageDecode(reply, \"v\", \"s\", &versionStr) < 0)\n        goto cleanup;\n\n    if (virParseVersionString(versionStr, version, false) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse firewalld version '%s'\"),\n                       versionStr);\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"FirewallD version: %s - %lu\", versionStr, *version);\n\n    ret = 0;\n cleanup:\n    virDBusMessageUnref(reply);\n    return ret;\n}",
    "includes": [
      "#include \"virenum.h\"",
      "#include \"virdbus.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfirewalldpriv.h\"",
      "#include \"virfirewalld.h\"",
      "#include \"virfirewall.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDBusMessageUnref",
          "args": [
            "reply"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusMessageUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1858-1861",
          "snippet": "void virDBusMessageUnref(DBusMessage *msg G_GNUC_UNUSED)\n{\n    /* nothing */\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nvoid virDBusMessageUnref(DBusMessage *msg G_GNUC_UNUSED)\n{\n    /* nothing */\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"FirewallD version: %s - %lu\"",
            "versionStr",
            "*version"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to parse firewalld version '%s'\")",
            "versionStr"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to parse firewalld version '%s'\""
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virParseVersionString",
          "args": [
            "versionStr",
            "version",
            "false"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "virParseVersionString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "254-282",
          "snippet": "int\nvirParseVersionString(const char *str, unsigned long *version,\n                      bool allowMissing)\n{\n    unsigned int major, minor = 0, micro = 0;\n    char *tmp;\n\n    if (virStrToLong_ui(str, &tmp, 10, &major) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &minor) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &micro) < 0)\n        return -1;\n\n    if (major > UINT_MAX / 1000000 || minor > 999 || micro > 999)\n        return -1;\n\n    *version = 1000000 * major + 1000 * minor + micro;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirParseVersionString(const char *str, unsigned long *version,\n                      bool allowMissing)\n{\n    unsigned int major, minor = 0, micro = 0;\n    char *tmp;\n\n    if (virStrToLong_ui(str, &tmp, 10, &major) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &minor) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &micro) < 0)\n        return -1;\n\n    if (major > UINT_MAX / 1000000 || minor > 999 || micro > 999)\n        return -1;\n\n    *version = 1000000 * major + 1000 * minor + micro;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDBusMessageDecode",
          "args": [
            "reply",
            "\"v\"",
            "\"s\"",
            "&versionStr"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusMessageDecode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1837-1844",
          "snippet": "int virDBusMessageDecode(DBusMessage* msg G_GNUC_UNUSED,\n                         const char *types G_GNUC_UNUSED,\n                         ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nint virDBusMessageDecode(DBusMessage* msg G_GNUC_UNUSED,\n                         const char *types G_GNUC_UNUSED,\n                         ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDBusCallMethod",
          "args": [
            "sysbus",
            "&reply",
            "NULL",
            "VIR_FIREWALL_FIREWALLD_SERVICE",
            "\"/org/fedoraproject/FirewallD1\"",
            "\"org.freedesktop.DBus.Properties\"",
            "\"Get\"",
            "\"ss\"",
            "\"org.fedoraproject.FirewallD1\"",
            "\"version\""
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusCallMethod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1813-1825",
          "snippet": "int virDBusCallMethod(DBusConnection *conn G_GNUC_UNUSED,\n                      DBusMessage **reply G_GNUC_UNUSED,\n                      virErrorPtr error G_GNUC_UNUSED,\n                      const char *destination G_GNUC_UNUSED,\n                      const char *path G_GNUC_UNUSED,\n                      const char *iface G_GNUC_UNUSED,\n                      const char *member G_GNUC_UNUSED,\n                      const char *types G_GNUC_UNUSED, ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nint virDBusCallMethod(DBusConnection *conn G_GNUC_UNUSED,\n                      DBusMessage **reply G_GNUC_UNUSED,\n                      virErrorPtr error G_GNUC_UNUSED,\n                      const char *destination G_GNUC_UNUSED,\n                      const char *path G_GNUC_UNUSED,\n                      const char *iface G_GNUC_UNUSED,\n                      const char *member G_GNUC_UNUSED,\n                      const char *types G_GNUC_UNUSED, ...)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDBusGetSystemBus",
          "args": [],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusGetSystemBus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1744-1749",
          "snippet": "DBusConnection *virDBusGetSystemBus(void)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return NULL;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nDBusConnection *virDBusGetSystemBus(void)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virenum.h\"\n#include \"virdbus.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalldpriv.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewall.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirFirewallDGetVersion(unsigned long *version)\n{\n    int ret = -1;\n    DBusConnection *sysbus = virDBusGetSystemBus();\n    DBusMessage *reply = NULL;\n    g_autofree char *versionStr = NULL;\n\n    if (!sysbus)\n        return -1;\n\n    if (virDBusCallMethod(sysbus,\n                          &reply,\n                          NULL,\n                          VIR_FIREWALL_FIREWALLD_SERVICE,\n                          \"/org/fedoraproject/FirewallD1\",\n                          \"org.freedesktop.DBus.Properties\",\n                          \"Get\",\n                          \"ss\",\n                          \"org.fedoraproject.FirewallD1\",\n                          \"version\") < 0)\n        goto cleanup;\n\n    if (virDBusMessageDecode(reply, \"v\", \"s\", &versionStr) < 0)\n        goto cleanup;\n\n    if (virParseVersionString(versionStr, version, false) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse firewalld version '%s'\"),\n                       versionStr);\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"FirewallD version: %s - %lu\", versionStr, *version);\n\n    ret = 0;\n cleanup:\n    virDBusMessageUnref(reply);\n    return ret;\n}"
  },
  {
    "function_name": "virFirewallDIsRegistered",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewalld.c",
    "lines": "66-70",
    "snippet": "int\nvirFirewallDIsRegistered(void)\n{\n    return virDBusIsServiceRegistered(VIR_FIREWALL_FIREWALLD_SERVICE);\n}",
    "includes": [
      "#include \"virenum.h\"",
      "#include \"virdbus.h\"",
      "#include \"virlog.h\"",
      "#include \"virutil.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfirewalldpriv.h\"",
      "#include \"virfirewalld.h\"",
      "#include \"virfirewall.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDBusIsServiceRegistered",
          "args": [
            "VIR_FIREWALL_FIREWALLD_SERVICE"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusIsServiceRegistered",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1852-1856",
          "snippet": "int virDBusIsServiceRegistered(const char *name G_GNUC_UNUSED)\n{\n    VIR_DEBUG(\"DBus support not compiled into this binary\");\n    return -2;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nint virDBusIsServiceRegistered(const char *name G_GNUC_UNUSED)\n{\n    VIR_DEBUG(\"DBus support not compiled into this binary\");\n    return -2;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virenum.h\"\n#include \"virdbus.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalldpriv.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewall.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirFirewallDIsRegistered(void)\n{\n    return virDBusIsServiceRegistered(VIR_FIREWALL_FIREWALLD_SERVICE);\n}"
  }
]