[
  {
    "function_name": "virAdmConnectSetLoggingFilters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "1248-1267",
    "snippet": "int\nvirAdmConnectSetLoggingFilters(virAdmConnectPtr conn,\n                               const char *filters,\n                               unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"conn=%p, filters=%s, flags=0x%x\", conn, filters, flags);\n\n    virResetLastError();\n    virCheckAdmConnectReturn(conn, -1);\n\n    if ((ret = remoteAdminConnectSetLoggingFilters(conn, filters, flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 1265
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminConnectSetLoggingFilters",
          "args": [
            "conn",
            "filters",
            "flags"
          ],
          "line": 1260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckAdmConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 1258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1257
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, filters=%s, flags=0x%x\"",
            "conn",
            "filters",
            "flags"
          ],
          "line": 1255
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirAdmConnectSetLoggingFilters(virAdmConnectPtr conn,\n                               const char *filters,\n                               unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"conn=%p, filters=%s, flags=0x%x\", conn, filters, flags);\n\n    virResetLastError();\n    virCheckAdmConnectReturn(conn, -1);\n\n    if ((ret = remoteAdminConnectSetLoggingFilters(conn, filters, flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virAdmConnectSetLoggingOutputs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "1210-1229",
    "snippet": "int\nvirAdmConnectSetLoggingOutputs(virAdmConnectPtr conn,\n                               const char *outputs,\n                               unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"conn=%p, outputs=%s, flags=0x%x\", conn, outputs, flags);\n\n    virResetLastError();\n    virCheckAdmConnectReturn(conn, -1);\n\n    if ((ret = remoteAdminConnectSetLoggingOutputs(conn, outputs, flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 1227
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminConnectSetLoggingOutputs",
          "args": [
            "conn",
            "outputs",
            "flags"
          ],
          "line": 1222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckAdmConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 1220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1219
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, outputs=%s, flags=0x%x\"",
            "conn",
            "outputs",
            "flags"
          ],
          "line": 1217
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirAdmConnectSetLoggingOutputs(virAdmConnectPtr conn,\n                               const char *outputs,\n                               unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"conn=%p, outputs=%s, flags=0x%x\", conn, outputs, flags);\n\n    virResetLastError();\n    virCheckAdmConnectReturn(conn, -1);\n\n    if ((ret = remoteAdminConnectSetLoggingOutputs(conn, outputs, flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virAdmConnectGetLoggingFilters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "1170-1191",
    "snippet": "int\nvirAdmConnectGetLoggingFilters(virAdmConnectPtr conn,\n                               char **filters,\n                               unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"conn=%p, filters=%p, flags=0x%x\",\n              conn, filters, flags);\n\n    virResetLastError();\n    virCheckAdmConnectReturn(conn, -1);\n\n    if ((ret = remoteAdminConnectGetLoggingFilters(conn, filters,\n                                                   flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 1189
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminConnectGetLoggingFilters",
          "args": [
            "conn",
            "filters",
            "flags"
          ],
          "line": 1183
        },
        "resolved": true,
        "details": {
          "function_name": "remoteAdminConnectGetLoggingFilters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_remote.c",
          "lines": "464-497",
          "snippet": "static int\nremoteAdminConnectGetLoggingFilters(virAdmConnectPtr conn,\n                                    char **filters,\n                                    unsigned int flags)\n{\n    int rv = -1;\n    remoteAdminPrivPtr priv = conn->privateData;\n    admin_connect_get_logging_filters_args args;\n    admin_connect_get_logging_filters_ret ret;\n\n    args.flags = flags;\n\n    memset(&ret, 0, sizeof(ret));\n    virObjectLock(priv);\n\n    if (call(conn,\n             0,\n             ADMIN_PROC_CONNECT_GET_LOGGING_FILTERS,\n             (xdrproc_t) xdr_admin_connect_get_logging_filters_args,\n             (char *) &args,\n             (xdrproc_t) xdr_admin_connect_get_logging_filters_ret,\n             (char *) &ret) == -1)\n        goto done;\n\n    if (filters)\n        *filters = ret.filters ? *ret.filters : NULL;\n\n    rv = ret.nfilters;\n    VIR_FREE(ret.filters);\n\n done:\n    virObjectUnlock(priv);\n    return rv;\n}",
          "includes": [
            "#include \"admin_client.h\"",
            "#include \"admin_protocol.h\"",
            "#include \"virtypedparam.h\"",
            "#include <rpc/rpc.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"admin_client.h\"\n#include \"admin_protocol.h\"\n#include \"virtypedparam.h\"\n#include <rpc/rpc.h>\n#include <config.h>\n\nstatic int\nremoteAdminConnectGetLoggingFilters(virAdmConnectPtr conn,\n                                    char **filters,\n                                    unsigned int flags)\n{\n    int rv = -1;\n    remoteAdminPrivPtr priv = conn->privateData;\n    admin_connect_get_logging_filters_args args;\n    admin_connect_get_logging_filters_ret ret;\n\n    args.flags = flags;\n\n    memset(&ret, 0, sizeof(ret));\n    virObjectLock(priv);\n\n    if (call(conn,\n             0,\n             ADMIN_PROC_CONNECT_GET_LOGGING_FILTERS,\n             (xdrproc_t) xdr_admin_connect_get_logging_filters_args,\n             (char *) &args,\n             (xdrproc_t) xdr_admin_connect_get_logging_filters_ret,\n             (char *) &ret) == -1)\n        goto done;\n\n    if (filters)\n        *filters = ret.filters ? *ret.filters : NULL;\n\n    rv = ret.nfilters;\n    VIR_FREE(ret.filters);\n\n done:\n    virObjectUnlock(priv);\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckAdmConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 1181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1180
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, filters=%p, flags=0x%x\"",
            "conn",
            "filters",
            "flags"
          ],
          "line": 1177
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirAdmConnectGetLoggingFilters(virAdmConnectPtr conn,\n                               char **filters,\n                               unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"conn=%p, filters=%p, flags=0x%x\",\n              conn, filters, flags);\n\n    virResetLastError();\n    virCheckAdmConnectReturn(conn, -1);\n\n    if ((ret = remoteAdminConnectGetLoggingFilters(conn, filters,\n                                                   flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virAdmConnectGetLoggingOutputs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "1129-1149",
    "snippet": "int\nvirAdmConnectGetLoggingOutputs(virAdmConnectPtr conn,\n                               char **outputs,\n                               unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"conn=%p, flags=0x%x\", conn, flags);\n\n    virResetLastError();\n    virCheckAdmConnectReturn(conn, -1);\n\n    if ((ret = remoteAdminConnectGetLoggingOutputs(conn, outputs,\n                                                   flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 1147
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminConnectGetLoggingOutputs",
          "args": [
            "conn",
            "outputs",
            "flags"
          ],
          "line": 1141
        },
        "resolved": true,
        "details": {
          "function_name": "remoteAdminConnectGetLoggingOutputs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_remote.c",
          "lines": "429-462",
          "snippet": "static int\nremoteAdminConnectGetLoggingOutputs(virAdmConnectPtr conn,\n                                    char **outputs,\n                                    unsigned int flags)\n{\n    int rv = -1;\n    remoteAdminPrivPtr priv = conn->privateData;\n    admin_connect_get_logging_outputs_args args;\n    admin_connect_get_logging_outputs_ret ret;\n\n    args.flags = flags;\n\n    memset(&ret, 0, sizeof(ret));\n    virObjectLock(priv);\n\n    if (call(conn,\n             0,\n             ADMIN_PROC_CONNECT_GET_LOGGING_OUTPUTS,\n             (xdrproc_t) xdr_admin_connect_get_logging_outputs_args,\n             (char *) &args,\n             (xdrproc_t) xdr_admin_connect_get_logging_outputs_ret,\n             (char *) &ret) == -1)\n        goto done;\n\n    if (outputs)\n        *outputs = g_steal_pointer(&ret.outputs);\n\n    rv = ret.noutputs;\n    xdr_free((xdrproc_t) xdr_admin_connect_get_logging_outputs_ret, (char *) &ret);\n\n done:\n    virObjectUnlock(priv);\n    return rv;\n}",
          "includes": [
            "#include \"admin_client.h\"",
            "#include \"admin_protocol.h\"",
            "#include \"virtypedparam.h\"",
            "#include <rpc/rpc.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"admin_client.h\"\n#include \"admin_protocol.h\"\n#include \"virtypedparam.h\"\n#include <rpc/rpc.h>\n#include <config.h>\n\nstatic int\nremoteAdminConnectGetLoggingOutputs(virAdmConnectPtr conn,\n                                    char **outputs,\n                                    unsigned int flags)\n{\n    int rv = -1;\n    remoteAdminPrivPtr priv = conn->privateData;\n    admin_connect_get_logging_outputs_args args;\n    admin_connect_get_logging_outputs_ret ret;\n\n    args.flags = flags;\n\n    memset(&ret, 0, sizeof(ret));\n    virObjectLock(priv);\n\n    if (call(conn,\n             0,\n             ADMIN_PROC_CONNECT_GET_LOGGING_OUTPUTS,\n             (xdrproc_t) xdr_admin_connect_get_logging_outputs_args,\n             (char *) &args,\n             (xdrproc_t) xdr_admin_connect_get_logging_outputs_ret,\n             (char *) &ret) == -1)\n        goto done;\n\n    if (outputs)\n        *outputs = g_steal_pointer(&ret.outputs);\n\n    rv = ret.noutputs;\n    xdr_free((xdrproc_t) xdr_admin_connect_get_logging_outputs_ret, (char *) &ret);\n\n done:\n    virObjectUnlock(priv);\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckAdmConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 1139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1138
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, flags=0x%x\"",
            "conn",
            "flags"
          ],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirAdmConnectGetLoggingOutputs(virAdmConnectPtr conn,\n                               char **outputs,\n                               unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"conn=%p, flags=0x%x\", conn, flags);\n\n    virResetLastError();\n    virCheckAdmConnectReturn(conn, -1);\n\n    if ((ret = remoteAdminConnectGetLoggingOutputs(conn, outputs,\n                                                   flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virAdmServerUpdateTlsFiles",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "1091-1109",
    "snippet": "int\nvirAdmServerUpdateTlsFiles(virAdmServerPtr srv,\n                           unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"srv=%p, flags=0x%x\", srv, flags);\n    virResetLastError();\n\n    virCheckAdmServerGoto(srv, error);\n\n    if ((ret = remoteAdminServerUpdateTlsFiles(srv, flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return ret;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 1107
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminServerUpdateTlsFiles",
          "args": [
            "srv",
            "flags"
          ],
          "line": 1102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckAdmServerGoto",
          "args": [
            "srv",
            "error"
          ],
          "line": 1100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1098
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"srv=%p, flags=0x%x\"",
            "srv",
            "flags"
          ],
          "line": 1097
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirAdmServerUpdateTlsFiles(virAdmServerPtr srv,\n                           unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"srv=%p, flags=0x%x\", srv, flags);\n    virResetLastError();\n\n    virCheckAdmServerGoto(srv, error);\n\n    if ((ret = remoteAdminServerUpdateTlsFiles(srv, flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return ret;\n}"
  },
  {
    "function_name": "virAdmServerSetClientLimits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "1053-1079",
    "snippet": "int\nvirAdmServerSetClientLimits(virAdmServerPtr srv,\n                            virTypedParameterPtr params,\n                            int nparams,\n                            unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"srv=%p, params=%p, nparams=%d, flags=0x%x\", srv, params, nparams,\n              flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckAdmServerGoto(srv, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNegativeArgGoto(nparams, error);\n\n    if ((ret = remoteAdminServerSetClientLimits(srv, params, nparams,\n                                                flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return ret;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 1077
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminServerSetClientLimits",
          "args": [
            "srv",
            "params",
            "nparams",
            "flags"
          ],
          "line": 1071
        },
        "resolved": true,
        "details": {
          "function_name": "remoteAdminServerSetClientLimits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_remote.c",
          "lines": "393-427",
          "snippet": "static int\nremoteAdminServerSetClientLimits(virAdmServerPtr srv,\n                                 virTypedParameterPtr params,\n                                 int nparams,\n                                 unsigned int flags)\n{\n    int rv = -1;\n    admin_server_set_client_limits_args args;\n    remoteAdminPrivPtr priv = srv->conn->privateData;\n\n    args.flags = flags;\n    make_nonnull_server(&args.srv, srv);\n\n    virObjectLock(priv);\n\n    if (virTypedParamsSerialize(params, nparams,\n                                ADMIN_SERVER_CLIENT_LIMITS_MAX,\n                                (virTypedParameterRemotePtr *) &args.params.params_val,\n                                &args.params.params_len,\n                                0) < 0)\n        goto cleanup;\n\n    if (call(srv->conn, 0, ADMIN_PROC_SERVER_SET_CLIENT_LIMITS,\n             (xdrproc_t) xdr_admin_server_set_client_limits_args,\n             (char *) &args,\n             (xdrproc_t) xdr_void, (char *) NULL) == -1)\n        goto cleanup;\n\n    rv = 0;\n cleanup:\n    virTypedParamsRemoteFree((virTypedParameterRemotePtr) args.params.params_val,\n                             args.params.params_len);\n    virObjectUnlock(priv);\n    return rv;\n}",
          "includes": [
            "#include \"admin_client.h\"",
            "#include \"admin_protocol.h\"",
            "#include \"virtypedparam.h\"",
            "#include <rpc/rpc.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"admin_client.h\"\n#include \"admin_protocol.h\"\n#include \"virtypedparam.h\"\n#include <rpc/rpc.h>\n#include <config.h>\n\nstatic int\nremoteAdminServerSetClientLimits(virAdmServerPtr srv,\n                                 virTypedParameterPtr params,\n                                 int nparams,\n                                 unsigned int flags)\n{\n    int rv = -1;\n    admin_server_set_client_limits_args args;\n    remoteAdminPrivPtr priv = srv->conn->privateData;\n\n    args.flags = flags;\n    make_nonnull_server(&args.srv, srv);\n\n    virObjectLock(priv);\n\n    if (virTypedParamsSerialize(params, nparams,\n                                ADMIN_SERVER_CLIENT_LIMITS_MAX,\n                                (virTypedParameterRemotePtr *) &args.params.params_val,\n                                &args.params.params_len,\n                                0) < 0)\n        goto cleanup;\n\n    if (call(srv->conn, 0, ADMIN_PROC_SERVER_SET_CLIENT_LIMITS,\n             (xdrproc_t) xdr_admin_server_set_client_limits_args,\n             (char *) &args,\n             (xdrproc_t) xdr_void, (char *) NULL) == -1)\n        goto cleanup;\n\n    rv = 0;\n cleanup:\n    virTypedParamsRemoteFree((virTypedParameterRemotePtr) args.params.params_val,\n                             args.params.params_len);\n    virObjectUnlock(priv);\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 1069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 1068
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckAdmServerGoto",
          "args": [
            "srv",
            "error"
          ],
          "line": 1067
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1065
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 1063
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"srv=%p, params=%p, nparams=%d, flags=0x%x\"",
            "srv",
            "params",
            "nparams",
            "flags"
          ],
          "line": 1061
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirAdmServerSetClientLimits(virAdmServerPtr srv,\n                            virTypedParameterPtr params,\n                            int nparams,\n                            unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"srv=%p, params=%p, nparams=%d, flags=0x%x\", srv, params, nparams,\n              flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckAdmServerGoto(srv, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNegativeArgGoto(nparams, error);\n\n    if ((ret = remoteAdminServerSetClientLimits(srv, params, nparams,\n                                                flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return ret;\n}"
  },
  {
    "function_name": "virAdmServerGetClientLimits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "1013-1035",
    "snippet": "int\nvirAdmServerGetClientLimits(virAdmServerPtr srv,\n                            virTypedParameterPtr *params,\n                            int *nparams,\n                            unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"srv=%p, params=%p, nparams=%p, flags=0x%x\",\n              srv, params, nparams, flags);\n    virResetLastError();\n\n    virCheckAdmServerGoto(srv, error);\n\n    if ((ret = remoteAdminServerGetClientLimits(srv, params,\n                                                nparams, flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 1033
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminServerGetClientLimits",
          "args": [
            "srv",
            "params",
            "nparams",
            "flags"
          ],
          "line": 1027
        },
        "resolved": true,
        "details": {
          "function_name": "remoteAdminServerGetClientLimits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_remote.c",
          "lines": "354-391",
          "snippet": "static int\nremoteAdminServerGetClientLimits(virAdmServerPtr srv,\n                                 virTypedParameterPtr *params,\n                                 int *nparams,\n                                 unsigned int flags)\n{\n    int rv = -1;\n    admin_server_get_client_limits_args args;\n    admin_server_get_client_limits_ret ret;\n    remoteAdminPrivPtr priv = srv->conn->privateData;\n    args.flags = flags;\n    make_nonnull_server(&args.srv, srv);\n\n    memset(&ret, 0, sizeof(ret));\n    virObjectLock(priv);\n\n    if (call(srv->conn, 0, ADMIN_PROC_SERVER_GET_CLIENT_LIMITS,\n             (xdrproc_t) xdr_admin_server_get_client_limits_args,\n             (char *) &args,\n             (xdrproc_t) xdr_admin_server_get_client_limits_ret,\n             (char *) &ret) == -1)\n        goto cleanup;\n\n    if (virTypedParamsDeserialize((virTypedParameterRemotePtr) ret.params.params_val,\n                                  ret.params.params_len,\n                                  ADMIN_SERVER_CLIENT_LIMITS_MAX,\n                                  params,\n                                  nparams) < 0)\n        goto cleanup;\n\n    rv = 0;\n    xdr_free((xdrproc_t) xdr_admin_server_get_client_limits_ret,\n             (char *) &ret);\n\n cleanup:\n    virObjectUnlock(priv);\n    return rv;\n}",
          "includes": [
            "#include \"admin_client.h\"",
            "#include \"admin_protocol.h\"",
            "#include \"virtypedparam.h\"",
            "#include <rpc/rpc.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"admin_client.h\"\n#include \"admin_protocol.h\"\n#include \"virtypedparam.h\"\n#include <rpc/rpc.h>\n#include <config.h>\n\nstatic int\nremoteAdminServerGetClientLimits(virAdmServerPtr srv,\n                                 virTypedParameterPtr *params,\n                                 int *nparams,\n                                 unsigned int flags)\n{\n    int rv = -1;\n    admin_server_get_client_limits_args args;\n    admin_server_get_client_limits_ret ret;\n    remoteAdminPrivPtr priv = srv->conn->privateData;\n    args.flags = flags;\n    make_nonnull_server(&args.srv, srv);\n\n    memset(&ret, 0, sizeof(ret));\n    virObjectLock(priv);\n\n    if (call(srv->conn, 0, ADMIN_PROC_SERVER_GET_CLIENT_LIMITS,\n             (xdrproc_t) xdr_admin_server_get_client_limits_args,\n             (char *) &args,\n             (xdrproc_t) xdr_admin_server_get_client_limits_ret,\n             (char *) &ret) == -1)\n        goto cleanup;\n\n    if (virTypedParamsDeserialize((virTypedParameterRemotePtr) ret.params.params_val,\n                                  ret.params.params_len,\n                                  ADMIN_SERVER_CLIENT_LIMITS_MAX,\n                                  params,\n                                  nparams) < 0)\n        goto cleanup;\n\n    rv = 0;\n    xdr_free((xdrproc_t) xdr_admin_server_get_client_limits_ret,\n             (char *) &ret);\n\n cleanup:\n    virObjectUnlock(priv);\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckAdmServerGoto",
          "args": [
            "srv",
            "error"
          ],
          "line": 1025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1023
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"srv=%p, params=%p, nparams=%p, flags=0x%x\"",
            "srv",
            "params",
            "nparams",
            "flags"
          ],
          "line": 1021
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirAdmServerGetClientLimits(virAdmServerPtr srv,\n                            virTypedParameterPtr *params,\n                            int *nparams,\n                            unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"srv=%p, params=%p, nparams=%p, flags=0x%x\",\n              srv, params, nparams, flags);\n    virResetLastError();\n\n    virCheckAdmServerGoto(srv, error);\n\n    if ((ret = remoteAdminServerGetClientLimits(srv, params,\n                                                nparams, flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virAdmClientClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "976-993",
    "snippet": "int virAdmClientClose(virAdmClientPtr client,\n                      unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"client=%p, flags=0x%x\", client, flags);\n    virResetLastError();\n\n    virCheckAdmClientGoto(client, error);\n\n    if ((ret = remoteAdminClientClose(client, flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 991
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminClientClose",
          "args": [
            "client",
            "flags"
          ],
          "line": 986
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckAdmClientGoto",
          "args": [
            "client",
            "error"
          ],
          "line": 984
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 982
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"client=%p, flags=0x%x\"",
            "client",
            "flags"
          ],
          "line": 981
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint virAdmClientClose(virAdmClientPtr client,\n                      unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"client=%p, flags=0x%x\", client, flags);\n    virResetLastError();\n\n    virCheckAdmClientGoto(client, error);\n\n    if ((ret = remoteAdminClientClose(client, flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virAdmClientGetInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "942-964",
    "snippet": "int\nvirAdmClientGetInfo(virAdmClientPtr client,\n                    virTypedParameterPtr *params,\n                    int *nparams,\n                    unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"client=%p, params=%p, nparams=%p, flags=0x%x\",\n              client, params, nparams, flags);\n\n    virResetLastError();\n    virCheckAdmClientReturn(client, -1);\n    virCheckNonNullArgGoto(params, error);\n\n    if ((ret = remoteAdminClientGetInfo(client, params, nparams, flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 962
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminClientGetInfo",
          "args": [
            "client",
            "params",
            "nparams",
            "flags"
          ],
          "line": 957
        },
        "resolved": true,
        "details": {
          "function_name": "remoteAdminClientGetInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_remote.c",
          "lines": "317-352",
          "snippet": "static int\nremoteAdminClientGetInfo(virAdmClientPtr client,\n                         virTypedParameterPtr *params,\n                         int *nparams,\n                         unsigned int flags)\n{\n    int rv = -1;\n    remoteAdminPrivPtr priv = client->srv->conn->privateData;\n    admin_client_get_info_args args;\n    admin_client_get_info_ret ret;\n\n    args.flags = flags;\n    make_nonnull_client(&args.clnt, client);\n\n    memset(&ret, 0, sizeof(ret));\n    virObjectLock(priv);\n\n    if (call(client->srv->conn, 0, ADMIN_PROC_CLIENT_GET_INFO,\n             (xdrproc_t)xdr_admin_client_get_info_args, (char *) &args,\n             (xdrproc_t)xdr_admin_client_get_info_ret, (char *) &ret) == -1)\n        goto cleanup;\n\n    if (virTypedParamsDeserialize((virTypedParameterRemotePtr) ret.params.params_val,\n                                  ret.params.params_len,\n                                  ADMIN_CLIENT_INFO_PARAMETERS_MAX,\n                                  params,\n                                  nparams) < 0)\n        goto cleanup;\n\n    rv = 0;\n    xdr_free((xdrproc_t)xdr_admin_client_get_info_ret, (char *) &ret);\n\n cleanup:\n    virObjectUnlock(priv);\n    return rv;\n}",
          "includes": [
            "#include \"admin_client.h\"",
            "#include \"admin_protocol.h\"",
            "#include \"virtypedparam.h\"",
            "#include <rpc/rpc.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"admin_client.h\"\n#include \"admin_protocol.h\"\n#include \"virtypedparam.h\"\n#include <rpc/rpc.h>\n#include <config.h>\n\nstatic int\nremoteAdminClientGetInfo(virAdmClientPtr client,\n                         virTypedParameterPtr *params,\n                         int *nparams,\n                         unsigned int flags)\n{\n    int rv = -1;\n    remoteAdminPrivPtr priv = client->srv->conn->privateData;\n    admin_client_get_info_args args;\n    admin_client_get_info_ret ret;\n\n    args.flags = flags;\n    make_nonnull_client(&args.clnt, client);\n\n    memset(&ret, 0, sizeof(ret));\n    virObjectLock(priv);\n\n    if (call(client->srv->conn, 0, ADMIN_PROC_CLIENT_GET_INFO,\n             (xdrproc_t)xdr_admin_client_get_info_args, (char *) &args,\n             (xdrproc_t)xdr_admin_client_get_info_ret, (char *) &ret) == -1)\n        goto cleanup;\n\n    if (virTypedParamsDeserialize((virTypedParameterRemotePtr) ret.params.params_val,\n                                  ret.params.params_len,\n                                  ADMIN_CLIENT_INFO_PARAMETERS_MAX,\n                                  params,\n                                  nparams) < 0)\n        goto cleanup;\n\n    rv = 0;\n    xdr_free((xdrproc_t)xdr_admin_client_get_info_ret, (char *) &ret);\n\n cleanup:\n    virObjectUnlock(priv);\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckAdmClientReturn",
          "args": [
            "client",
            "-1"
          ],
          "line": 954
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 953
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"client=%p, params=%p, nparams=%p, flags=0x%x\"",
            "client",
            "params",
            "nparams",
            "flags"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirAdmClientGetInfo(virAdmClientPtr client,\n                    virTypedParameterPtr *params,\n                    int *nparams,\n                    unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"client=%p, params=%p, nparams=%p, flags=0x%x\",\n              client, params, nparams, flags);\n\n    virResetLastError();\n    virCheckAdmClientReturn(client, -1);\n    virCheckNonNullArgGoto(params, error);\n\n    if ((ret = remoteAdminClientGetInfo(client, params, nparams, flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virAdmServerLookupClient",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "896-915",
    "snippet": "virAdmClientPtr\nvirAdmServerLookupClient(virAdmServerPtr srv,\n                         unsigned long long id,\n                         unsigned int flags)\n{\n    virAdmClientPtr ret = NULL;\n\n    VIR_DEBUG(\"srv=%p, id=%llu, flags=0x%x\", srv, id, flags);\n    virResetLastError();\n\n    virCheckAdmServerGoto(srv, error);\n\n    if (!(ret = remoteAdminServerLookupClient(srv, id, flags)))\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return NULL;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 913
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminServerLookupClient",
          "args": [
            "srv",
            "id",
            "flags"
          ],
          "line": 908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckAdmServerGoto",
          "args": [
            "srv",
            "error"
          ],
          "line": 906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 904
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"srv=%p, id=%llu, flags=0x%x\"",
            "srv",
            "id",
            "flags"
          ],
          "line": 903
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirAdmClientPtr\nvirAdmServerLookupClient(virAdmServerPtr srv,\n                         unsigned long long id,\n                         unsigned int flags)\n{\n    virAdmClientPtr ret = NULL;\n\n    VIR_DEBUG(\"srv=%p, id=%llu, flags=0x%x\", srv, id, flags);\n    virResetLastError();\n\n    virCheckAdmServerGoto(srv, error);\n\n    if (!(ret = remoteAdminServerLookupClient(srv, id, flags)))\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return NULL;\n}"
  },
  {
    "function_name": "virAdmServerListClients",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "858-880",
    "snippet": "int\nvirAdmServerListClients(virAdmServerPtr srv,\n                        virAdmClientPtr **clients,\n                        unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"srv=%p, clients=%p, flags=0x%x\", srv, clients, flags);\n\n    virResetLastError();\n\n    if (clients)\n        *clients = NULL;\n\n    virCheckAdmServerReturn(srv, -1);\n    if ((ret = remoteAdminServerListClients(srv, clients, flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 878
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminServerListClients",
          "args": [
            "srv",
            "clients",
            "flags"
          ],
          "line": 873
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckAdmServerReturn",
          "args": [
            "srv",
            "-1"
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 867
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"srv=%p, clients=%p, flags=0x%x\"",
            "srv",
            "clients",
            "flags"
          ],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirAdmServerListClients(virAdmServerPtr srv,\n                        virAdmClientPtr **clients,\n                        unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"srv=%p, clients=%p, flags=0x%x\", srv, clients, flags);\n\n    virResetLastError();\n\n    if (clients)\n        *clients = NULL;\n\n    virCheckAdmServerReturn(srv, -1);\n    if ((ret = remoteAdminServerListClients(srv, clients, flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virAdmServerSetThreadPoolParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "817-840",
    "snippet": "int\nvirAdmServerSetThreadPoolParameters(virAdmServerPtr srv,\n                                    virTypedParameterPtr params,\n                                    int nparams,\n                                    unsigned int flags)\n{\n    VIR_DEBUG(\"srv=%p, params=%p, nparams=%d, flags=0x%x\",\n              srv, params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckAdmServerReturn(srv, -1);\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNegativeArgGoto(nparams, error);\n\n    if (remoteAdminServerSetThreadPoolParameters(srv, params,\n                                                 nparams, flags) < 0)\n        goto error;\n\n    return 0;\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 838
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminServerSetThreadPoolParameters",
          "args": [
            "srv",
            "params",
            "nparams",
            "flags"
          ],
          "line": 832
        },
        "resolved": true,
        "details": {
          "function_name": "remoteAdminServerSetThreadPoolParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_remote.c",
          "lines": "281-315",
          "snippet": "static int\nremoteAdminServerSetThreadPoolParameters(virAdmServerPtr srv,\n                                         virTypedParameterPtr params,\n                                         int nparams,\n                                         unsigned int flags)\n{\n    int rv = -1;\n    remoteAdminPrivPtr priv = srv->conn->privateData;\n    admin_server_set_threadpool_parameters_args args;\n\n    args.flags = flags;\n    make_nonnull_server(&args.srv, srv);\n\n    virObjectLock(priv);\n\n    if (virTypedParamsSerialize(params, nparams,\n                                ADMIN_SERVER_THREADPOOL_PARAMETERS_MAX,\n                                (virTypedParameterRemotePtr *) &args.params.params_val,\n                                &args.params.params_len,\n                                0) < 0)\n        goto cleanup;\n\n\n    if (call(srv->conn, 0, ADMIN_PROC_SERVER_SET_THREADPOOL_PARAMETERS,\n             (xdrproc_t)xdr_admin_server_set_threadpool_parameters_args, (char *) &args,\n             (xdrproc_t)xdr_void, (char *) NULL) == -1)\n        goto cleanup;\n\n    rv = 0;\n cleanup:\n    virTypedParamsRemoteFree((virTypedParameterRemotePtr) args.params.params_val,\n                             args.params.params_len);\n    virObjectUnlock(priv);\n    return rv;\n}",
          "includes": [
            "#include \"admin_client.h\"",
            "#include \"admin_protocol.h\"",
            "#include \"virtypedparam.h\"",
            "#include <rpc/rpc.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"admin_client.h\"\n#include \"admin_protocol.h\"\n#include \"virtypedparam.h\"\n#include <rpc/rpc.h>\n#include <config.h>\n\nstatic int\nremoteAdminServerSetThreadPoolParameters(virAdmServerPtr srv,\n                                         virTypedParameterPtr params,\n                                         int nparams,\n                                         unsigned int flags)\n{\n    int rv = -1;\n    remoteAdminPrivPtr priv = srv->conn->privateData;\n    admin_server_set_threadpool_parameters_args args;\n\n    args.flags = flags;\n    make_nonnull_server(&args.srv, srv);\n\n    virObjectLock(priv);\n\n    if (virTypedParamsSerialize(params, nparams,\n                                ADMIN_SERVER_THREADPOOL_PARAMETERS_MAX,\n                                (virTypedParameterRemotePtr *) &args.params.params_val,\n                                &args.params.params_len,\n                                0) < 0)\n        goto cleanup;\n\n\n    if (call(srv->conn, 0, ADMIN_PROC_SERVER_SET_THREADPOOL_PARAMETERS,\n             (xdrproc_t)xdr_admin_server_set_threadpool_parameters_args, (char *) &args,\n             (xdrproc_t)xdr_void, (char *) NULL) == -1)\n        goto cleanup;\n\n    rv = 0;\n cleanup:\n    virTypedParamsRemoteFree((virTypedParameterRemotePtr) args.params.params_val,\n                             args.params.params_len);\n    virObjectUnlock(priv);\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckAdmServerReturn",
          "args": [
            "srv",
            "-1"
          ],
          "line": 828
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"srv=%p, params=%p, nparams=%d, flags=0x%x\"",
            "srv",
            "params",
            "nparams",
            "flags"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirAdmServerSetThreadPoolParameters(virAdmServerPtr srv,\n                                    virTypedParameterPtr params,\n                                    int nparams,\n                                    unsigned int flags)\n{\n    VIR_DEBUG(\"srv=%p, params=%p, nparams=%d, flags=0x%x\",\n              srv, params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckAdmServerReturn(srv, -1);\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNegativeArgGoto(nparams, error);\n\n    if (remoteAdminServerSetThreadPoolParameters(srv, params,\n                                                 nparams, flags) < 0)\n        goto error;\n\n    return 0;\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virAdmServerGetThreadPoolParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "778-802",
    "snippet": "int\nvirAdmServerGetThreadPoolParameters(virAdmServerPtr srv,\n                                    virTypedParameterPtr *params,\n                                    int *nparams,\n                                    unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"srv=%p, params=%p, nparams=%p, flags=0x%x\",\n              srv, params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckAdmServerReturn(srv, -1);\n    virCheckNonNullArgGoto(params, error);\n\n    if ((ret = remoteAdminServerGetThreadPoolParameters(srv, params, nparams,\n                                                        flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 800
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminServerGetThreadPoolParameters",
          "args": [
            "srv",
            "params",
            "nparams",
            "flags"
          ],
          "line": 794
        },
        "resolved": true,
        "details": {
          "function_name": "remoteAdminServerGetThreadPoolParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_remote.c",
          "lines": "244-279",
          "snippet": "static int\nremoteAdminServerGetThreadPoolParameters(virAdmServerPtr srv,\n                                         virTypedParameterPtr *params,\n                                         int *nparams,\n                                         unsigned int flags)\n{\n    int rv = -1;\n    remoteAdminPrivPtr priv = srv->conn->privateData;\n    admin_server_get_threadpool_parameters_args args;\n    admin_server_get_threadpool_parameters_ret ret;\n\n    args.flags = flags;\n    make_nonnull_server(&args.srv, srv);\n\n    memset(&ret, 0, sizeof(ret));\n    virObjectLock(priv);\n\n    if (call(srv->conn, 0, ADMIN_PROC_SERVER_GET_THREADPOOL_PARAMETERS,\n             (xdrproc_t)xdr_admin_server_get_threadpool_parameters_args, (char *) &args,\n             (xdrproc_t)xdr_admin_server_get_threadpool_parameters_ret, (char *) &ret) == -1)\n        goto cleanup;\n\n    if (virTypedParamsDeserialize((virTypedParameterRemotePtr) ret.params.params_val,\n                                  ret.params.params_len,\n                                  ADMIN_SERVER_THREADPOOL_PARAMETERS_MAX,\n                                  params,\n                                  nparams) < 0)\n        goto cleanup;\n\n    rv = 0;\n    xdr_free((xdrproc_t)xdr_admin_server_get_threadpool_parameters_ret, (char *) &ret);\n\n cleanup:\n    virObjectUnlock(priv);\n    return rv;\n}",
          "includes": [
            "#include \"admin_client.h\"",
            "#include \"admin_protocol.h\"",
            "#include \"virtypedparam.h\"",
            "#include <rpc/rpc.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"admin_client.h\"\n#include \"admin_protocol.h\"\n#include \"virtypedparam.h\"\n#include <rpc/rpc.h>\n#include <config.h>\n\nstatic int\nremoteAdminServerGetThreadPoolParameters(virAdmServerPtr srv,\n                                         virTypedParameterPtr *params,\n                                         int *nparams,\n                                         unsigned int flags)\n{\n    int rv = -1;\n    remoteAdminPrivPtr priv = srv->conn->privateData;\n    admin_server_get_threadpool_parameters_args args;\n    admin_server_get_threadpool_parameters_ret ret;\n\n    args.flags = flags;\n    make_nonnull_server(&args.srv, srv);\n\n    memset(&ret, 0, sizeof(ret));\n    virObjectLock(priv);\n\n    if (call(srv->conn, 0, ADMIN_PROC_SERVER_GET_THREADPOOL_PARAMETERS,\n             (xdrproc_t)xdr_admin_server_get_threadpool_parameters_args, (char *) &args,\n             (xdrproc_t)xdr_admin_server_get_threadpool_parameters_ret, (char *) &ret) == -1)\n        goto cleanup;\n\n    if (virTypedParamsDeserialize((virTypedParameterRemotePtr) ret.params.params_val,\n                                  ret.params.params_len,\n                                  ADMIN_SERVER_THREADPOOL_PARAMETERS_MAX,\n                                  params,\n                                  nparams) < 0)\n        goto cleanup;\n\n    rv = 0;\n    xdr_free((xdrproc_t)xdr_admin_server_get_threadpool_parameters_ret, (char *) &ret);\n\n cleanup:\n    virObjectUnlock(priv);\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckAdmServerReturn",
          "args": [
            "srv",
            "-1"
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 789
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"srv=%p, params=%p, nparams=%p, flags=0x%x\"",
            "srv",
            "params",
            "nparams",
            "flags"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirAdmServerGetThreadPoolParameters(virAdmServerPtr srv,\n                                    virTypedParameterPtr *params,\n                                    int *nparams,\n                                    unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"srv=%p, params=%p, nparams=%p, flags=0x%x\",\n              srv, params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckAdmServerReturn(srv, -1);\n    virCheckNonNullArgGoto(params, error);\n\n    if ((ret = remoteAdminServerGetThreadPoolParameters(srv, params, nparams,\n                                                        flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virAdmConnectLookupServer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "737-755",
    "snippet": "virAdmServerPtr\nvirAdmConnectLookupServer(virAdmConnectPtr conn,\n                          const char *name,\n                          unsigned int flags)\n{\n    virAdmServerPtr ret = NULL;\n\n    VIR_DEBUG(\"conn=%p, name=%s, flags=0x%x\", conn, NULLSTR(name), flags);\n    virResetLastError();\n\n    virCheckAdmConnectGoto(conn, cleanup);\n    virCheckNonNullArgGoto(name, cleanup);\n\n    ret = remoteAdminConnectLookupServer(conn, name, flags);\n cleanup:\n    if (!ret)\n        virDispatchError(NULL);\n    return ret;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 753
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminConnectLookupServer",
          "args": [
            "conn",
            "name",
            "flags"
          ],
          "line": 750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "name",
            "cleanup"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckAdmConnectGoto",
          "args": [
            "conn",
            "cleanup"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 745
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, name=%s, flags=0x%x\"",
            "conn",
            "NULLSTR(name)",
            "flags"
          ],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "name"
          ],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirAdmServerPtr\nvirAdmConnectLookupServer(virAdmConnectPtr conn,\n                          const char *name,\n                          unsigned int flags)\n{\n    virAdmServerPtr ret = NULL;\n\n    VIR_DEBUG(\"conn=%p, name=%s, flags=0x%x\", conn, NULLSTR(name), flags);\n    virResetLastError();\n\n    virCheckAdmConnectGoto(conn, cleanup);\n    virCheckNonNullArgGoto(name, cleanup);\n\n    ret = remoteAdminConnectLookupServer(conn, name, flags);\n cleanup:\n    if (!ret)\n        virDispatchError(NULL);\n    return ret;\n}"
  },
  {
    "function_name": "virAdmConnectListServers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "699-721",
    "snippet": "int\nvirAdmConnectListServers(virAdmConnectPtr conn,\n                         virAdmServerPtr **servers,\n                         unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"conn=%p, servers=%p, flags=0x%x\", conn, servers, flags);\n\n    virResetLastError();\n\n    if (servers)\n        *servers = NULL;\n\n    virCheckAdmConnectReturn(conn, -1);\n    if ((ret = remoteAdminConnectListServers(conn, servers, flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 719
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminConnectListServers",
          "args": [
            "conn",
            "servers",
            "flags"
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckAdmConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 708
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, servers=%p, flags=0x%x\"",
            "conn",
            "servers",
            "flags"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirAdmConnectListServers(virAdmConnectPtr conn,\n                         virAdmServerPtr **servers,\n                         unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"conn=%p, servers=%p, flags=0x%x\", conn, servers, flags);\n\n    virResetLastError();\n\n    if (servers)\n        *servers = NULL;\n\n    virCheckAdmConnectReturn(conn, -1);\n    if ((ret = remoteAdminConnectListServers(conn, servers, flags)) < 0)\n        goto error;\n\n    return ret;\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virAdmClientFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "668-681",
    "snippet": "int virAdmClientFree(virAdmClientPtr client)\n{\n    VIR_DEBUG(\"client=%p\", client);\n\n    virResetLastError();\n\n    if (!client)\n        return 0;\n\n    virCheckAdmClientReturn(client, -1);\n\n    virObjectUnref(client);\n    return 0;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "client"
          ],
          "line": 679
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckAdmClientReturn",
          "args": [
            "client",
            "-1"
          ],
          "line": 677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 672
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"client=%p\"",
            "client"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint virAdmClientFree(virAdmClientPtr client)\n{\n    VIR_DEBUG(\"client=%p\", client);\n\n    virResetLastError();\n\n    if (!client)\n        return 0;\n\n    virCheckAdmClientReturn(client, -1);\n\n    virObjectUnref(client);\n    return 0;\n}"
  },
  {
    "function_name": "virAdmClientGetTransport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "649-657",
    "snippet": "int\nvirAdmClientGetTransport(virAdmClientPtr client)\n{\n    VIR_DEBUG(\"client=%p\", client);\n\n    virResetLastError();\n    virCheckAdmClientReturn(client, -1);\n    return client->transport;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckAdmClientReturn",
          "args": [
            "client",
            "-1"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 654
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"client=%p\"",
            "client"
          ],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirAdmClientGetTransport(virAdmClientPtr client)\n{\n    VIR_DEBUG(\"client=%p\", client);\n\n    virResetLastError();\n    virCheckAdmClientReturn(client, -1);\n    return client->transport;\n}"
  },
  {
    "function_name": "virAdmClientGetTimestamp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "624-632",
    "snippet": "long long\nvirAdmClientGetTimestamp(virAdmClientPtr client)\n{\n    VIR_DEBUG(\"client=%p\", client);\n\n    virResetLastError();\n    virCheckAdmClientReturn(client, -1);\n    return client->timestamp;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckAdmClientReturn",
          "args": [
            "client",
            "-1"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 629
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"client=%p\"",
            "client"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nlong long\nvirAdmClientGetTimestamp(virAdmClientPtr client)\n{\n    VIR_DEBUG(\"client=%p\", client);\n\n    virResetLastError();\n    virCheckAdmClientReturn(client, -1);\n    return client->timestamp;\n}"
  },
  {
    "function_name": "virAdmClientGetID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "601-609",
    "snippet": "unsigned long long\nvirAdmClientGetID(virAdmClientPtr client)\n{\n    VIR_DEBUG(\"client=%p\", client);\n\n    virResetLastError();\n    virCheckAdmClientReturn(client, -1);\n    return client->id;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckAdmClientReturn",
          "args": [
            "client",
            "-1"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"client=%p\"",
            "client"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nunsigned long long\nvirAdmClientGetID(virAdmClientPtr client)\n{\n    VIR_DEBUG(\"client=%p\", client);\n\n    virResetLastError();\n    virCheckAdmClientReturn(client, -1);\n    return client->id;\n}"
  },
  {
    "function_name": "virAdmServerFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "578-591",
    "snippet": "int virAdmServerFree(virAdmServerPtr srv)\n{\n    VIR_DEBUG(\"server=%p\", srv);\n\n    virResetLastError();\n\n    if (!srv)\n        return 0;\n\n    virCheckAdmServerReturn(srv, -1);\n\n    virObjectUnref(srv);\n    return 0;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "srv"
          ],
          "line": 589
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckAdmServerReturn",
          "args": [
            "srv",
            "-1"
          ],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"server=%p\"",
            "srv"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint virAdmServerFree(virAdmServerPtr srv)\n{\n    VIR_DEBUG(\"server=%p\", srv);\n\n    virResetLastError();\n\n    if (!srv)\n        return 0;\n\n    virCheckAdmServerReturn(srv, -1);\n\n    virObjectUnref(srv);\n    return 0;\n}"
  },
  {
    "function_name": "virAdmServerGetName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "558-567",
    "snippet": "const char *\nvirAdmServerGetName(virAdmServerPtr srv)\n{\n    VIR_DEBUG(\"server=%p\", srv);\n\n    virResetLastError();\n    virCheckAdmServerReturn(srv, NULL);\n\n    return srv->name;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckAdmServerReturn",
          "args": [
            "srv",
            "NULL"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 563
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"server=%p\"",
            "srv"
          ],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nconst char *\nvirAdmServerGetName(virAdmServerPtr srv)\n{\n    VIR_DEBUG(\"server=%p\", srv);\n\n    virResetLastError();\n    virCheckAdmServerReturn(srv, NULL);\n\n    return srv->name;\n}"
  },
  {
    "function_name": "virAdmConnectGetLibVersion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "530-547",
    "snippet": "int virAdmConnectGetLibVersion(virAdmConnectPtr conn,\n                               unsigned long long *libVer)\n{\n    VIR_DEBUG(\"conn=%p, libVir=%p\", conn, libVer);\n\n    virResetLastError();\n\n    virCheckAdmConnectReturn(conn, -1);\n    virCheckNonNullArgReturn(libVer, -1);\n\n    if (remoteAdminConnectGetLibVersion(conn, libVer) < 0)\n        goto error;\n\n    return 0;\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminConnectGetLibVersion",
          "args": [
            "conn",
            "libVer"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgReturn",
          "args": [
            "libVer",
            "-1"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckAdmConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, libVir=%p\"",
            "conn",
            "libVer"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint virAdmConnectGetLibVersion(virAdmConnectPtr conn,\n                               unsigned long long *libVer)\n{\n    VIR_DEBUG(\"conn=%p, libVir=%p\", conn, libVer);\n\n    virResetLastError();\n\n    virCheckAdmConnectReturn(conn, -1);\n    virCheckNonNullArgReturn(libVer, -1);\n\n    if (remoteAdminConnectGetLibVersion(conn, libVer) < 0)\n        goto error;\n\n    return 0;\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virAdmConnectUnregisterCloseCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "500-517",
    "snippet": "int virAdmConnectUnregisterCloseCallback(virAdmConnectPtr conn,\n                                         virAdmConnectCloseFunc cb)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckAdmConnectReturn(conn, -1);\n    virCheckNonNullArgGoto(cb, error);\n\n    if (virAdmConnectCloseCallbackDataUnregister(conn->closeCallback, cb) < 0)\n        goto error;\n\n    return 0;\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAdmConnectCloseCallbackDataUnregister",
          "args": [
            "conn->closeCallback",
            "cb"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "virAdmConnectCloseCallbackDataUnregister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "1125-1143",
          "snippet": "int\nvirAdmConnectCloseCallbackDataUnregister(virAdmConnectCloseCallbackDataPtr cbdata,\n                                         virAdmConnectCloseFunc cb)\n{\n    int ret = -1;\n\n    virObjectLock(cbdata);\n    if (cbdata->callback != cb) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"A different callback was requested\"));\n        goto cleanup;\n    }\n\n    virAdmConnectCloseCallbackDataReset(cbdata);\n    ret = 0;\n cleanup:\n    virObjectUnlock(cbdata);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirAdmConnectCloseCallbackDataUnregister(virAdmConnectCloseCallbackDataPtr cbdata,\n                                         virAdmConnectCloseFunc cb)\n{\n    int ret = -1;\n\n    virObjectLock(cbdata);\n    if (cbdata->callback != cb) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"A different callback was requested\"));\n        goto cleanup;\n    }\n\n    virAdmConnectCloseCallbackDataReset(cbdata);\n    ret = 0;\n cleanup:\n    virObjectUnlock(cbdata);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "cb",
            "error"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckAdmConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p\"",
            "conn"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint virAdmConnectUnregisterCloseCallback(virAdmConnectPtr conn,\n                                         virAdmConnectCloseFunc cb)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckAdmConnectReturn(conn, -1);\n    virCheckNonNullArgGoto(cb, error);\n\n    if (virAdmConnectCloseCallbackDataUnregister(conn->closeCallback, cb) < 0)\n        goto error;\n\n    return 0;\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virAdmConnectRegisterCloseCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "447-485",
    "snippet": "int virAdmConnectRegisterCloseCallback(virAdmConnectPtr conn,\n                                       virAdmConnectCloseFunc cb,\n                                       void *opaque,\n                                       virFreeCallback freecb)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckAdmConnectReturn(conn, -1);\n\n    virObjectRef(conn);\n\n    virObjectLock(conn->closeCallback);\n\n    virCheckNonNullArgGoto(cb, error);\n\n    if (conn->closeCallback->callback) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"A close callback is already registered\"));\n        goto error;\n    }\n\n    conn->closeCallback->conn = conn;\n    conn->closeCallback->callback = cb;\n    conn->closeCallback->opaque = opaque;\n    conn->closeCallback->freeCallback = freecb;\n\n    virObjectUnlock(conn->closeCallback);\n\n    return 0;\n\n error:\n    virObjectUnlock(conn->closeCallback);\n    virDispatchError(NULL);\n    virObjectUnref(conn);\n    return -1;\n\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "conn"
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "conn->closeCallback"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"A close callback is already registered\")"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"A close callback is already registered\""
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "cb",
            "error"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "conn->closeCallback"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "conn"
          ],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckAdmConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p\"",
            "conn"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint virAdmConnectRegisterCloseCallback(virAdmConnectPtr conn,\n                                       virAdmConnectCloseFunc cb,\n                                       void *opaque,\n                                       virFreeCallback freecb)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckAdmConnectReturn(conn, -1);\n\n    virObjectRef(conn);\n\n    virObjectLock(conn->closeCallback);\n\n    virCheckNonNullArgGoto(cb, error);\n\n    if (conn->closeCallback->callback) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"A close callback is already registered\"));\n        goto error;\n    }\n\n    conn->closeCallback->conn = conn;\n    conn->closeCallback->callback = cb;\n    conn->closeCallback->opaque = opaque;\n    conn->closeCallback->freeCallback = freecb;\n\n    virObjectUnlock(conn->closeCallback);\n\n    return 0;\n\n error:\n    virObjectUnlock(conn->closeCallback);\n    virDispatchError(NULL);\n    virObjectUnref(conn);\n    return -1;\n\n}"
  },
  {
    "function_name": "virAdmConnectGetURI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "413-427",
    "snippet": "char *\nvirAdmConnectGetURI(virAdmConnectPtr conn)\n{\n    char *uri = NULL;\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckAdmConnectReturn(conn, NULL);\n\n    if (!(uri = virURIFormat(conn->uri)))\n        virDispatchError(NULL);\n\n    return uri;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virURIFormat",
          "args": [
            "conn->uri"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "virURIFormatParams",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruri.c",
          "lines": "253-269",
          "snippet": "char *virURIFormatParams(virURIPtr uri)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    size_t i;\n    bool amp = false;\n\n    for (i = 0; i < uri->paramsCount; ++i) {\n        if (!uri->params[i].ignore) {\n            if (amp) virBufferAddChar(&buf, '&');\n            virBufferStrcat(&buf, uri->params[i].name, \"=\", NULL);\n            virBufferURIEncodeString(&buf, uri->params[i].value);\n            amp = true;\n        }\n    }\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruri.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruri.h\"\n#include <config.h>\n\nchar *virURIFormatParams(virURIPtr uri)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    size_t i;\n    bool amp = false;\n\n    for (i = 0; i < uri->paramsCount; ++i) {\n        if (!uri->params[i].ignore) {\n            if (amp) virBufferAddChar(&buf, '&');\n            virBufferStrcat(&buf, uri->params[i].name, \"=\", NULL);\n            virBufferURIEncodeString(&buf, uri->params[i].value);\n            amp = true;\n        }\n    }\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckAdmConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p\"",
            "conn"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirAdmConnectGetURI(virAdmConnectPtr conn)\n{\n    char *uri = NULL;\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckAdmConnectReturn(conn, NULL);\n\n    if (!(uri = virURIFormat(conn->uri)))\n        virDispatchError(NULL);\n\n    return uri;\n}"
  },
  {
    "function_name": "virAdmConnectIsAlive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "379-400",
    "snippet": "int\nvirAdmConnectIsAlive(virAdmConnectPtr conn)\n{\n    bool ret;\n    remoteAdminPrivPtr priv = NULL;\n\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    if (!conn)\n        return 0;\n\n    virCheckAdmConnectReturn(conn, -1);\n\n    priv = conn->privateData;\n    virObjectLock(priv);\n    ret = virNetClientIsOpen(priv->client);\n    virObjectUnlock(priv);\n\n    return ret;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "priv"
          ],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetClientIsOpen",
          "args": [
            "priv->client"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "virNetClientIsOpen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetclient.c",
          "lines": "991-1002",
          "snippet": "bool virNetClientIsOpen(virNetClientPtr client)\n{\n    bool ret;\n\n    if (!client)\n        return false;\n\n    virObjectLock(client);\n    ret = client->sock && !client->wantClose;\n    virObjectUnlock(client);\n    return ret;\n}",
          "includes": [
            "#include \"vireventglibwatch.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virerror.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virnetclient.h\"",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vireventglibwatch.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virerror.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virkeepalive.h\"\n#include \"virnetsocket.h\"\n#include \"virnetclient.h\"\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <config.h>\n\nbool virNetClientIsOpen(virNetClientPtr client)\n{\n    bool ret;\n\n    if (!client)\n        return false;\n\n    virObjectLock(client);\n    ret = client->sock && !client->wantClose;\n    virObjectUnlock(client);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "priv"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckAdmConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p\"",
            "conn"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirAdmConnectIsAlive(virAdmConnectPtr conn)\n{\n    bool ret;\n    remoteAdminPrivPtr priv = NULL;\n\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    if (!conn)\n        return 0;\n\n    virCheckAdmConnectReturn(conn, -1);\n\n    priv = conn->privateData;\n    virObjectLock(priv);\n    ret = virNetClientIsOpen(priv->client);\n    virObjectUnlock(priv);\n\n    return ret;\n}"
  },
  {
    "function_name": "virAdmGetVersion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "348-366",
    "snippet": "int\nvirAdmGetVersion(unsigned long long *libVer)\n{\n    if (virAdmInitialize() < 0)\n        goto error;\n\n    VIR_DEBUG(\"libVer=%p\", libVer);\n\n    virResetLastError();\n    if (!libVer)\n        goto error;\n    *libVer = LIBVIR_VERSION_NUMBER;\n\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"libVer=%p\"",
            "libVer"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAdmInitialize",
          "args": [],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "virAdmInitialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
          "lines": "87-97",
          "snippet": "int\nvirAdmInitialize(void)\n{\n    if (virOnce(&virAdmGlobalOnce, virAdmGlobalInit) < 0)\n        return -1;\n\n    if (virAdmGlobalError)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"admin_remote.c\"",
            "#include \"viruuid.h\"",
            "#include \"virutil.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetclient.h\"",
            "#include \"virlog.h\"",
            "#include \"virconf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool virAdmGlobalError;",
            "static virOnceControl virAdmGlobalOnce = VIR_ONCE_CONTROL_INITIALIZER;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool virAdmGlobalError;\nstatic virOnceControl virAdmGlobalOnce = VIR_ONCE_CONTROL_INITIALIZER;\n\nint\nvirAdmInitialize(void)\n{\n    if (virOnce(&virAdmGlobalOnce, virAdmGlobalInit) < 0)\n        return -1;\n\n    if (virAdmGlobalError)\n        return -1;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirAdmGetVersion(unsigned long long *libVer)\n{\n    if (virAdmInitialize() < 0)\n        goto error;\n\n    VIR_DEBUG(\"libVer=%p\", libVer);\n\n    virResetLastError();\n    if (!libVer)\n        goto error;\n    *libVer = LIBVIR_VERSION_NUMBER;\n\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
  },
  {
    "function_name": "virAdmConnectRef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "320-332",
    "snippet": "int\nvirAdmConnectRef(virAdmConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p refs=%d\", conn,\n              conn ? conn->parent.parent.u.s.refs : 0);\n\n    virResetLastError();\n    virCheckAdmConnectReturn(conn, -1);\n\n    virObjectRef(conn);\n\n    return 0;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "conn"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckAdmConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p refs=%d\"",
            "conn",
            "conn ? conn->parent.parent.u.s.refs : 0"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirAdmConnectRef(virAdmConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p refs=%d\", conn,\n              conn ? conn->parent.parent.u.s.refs : 0);\n\n    virResetLastError();\n    virCheckAdmConnectReturn(conn, -1);\n\n    virObjectRef(conn);\n\n    return 0;\n}"
  },
  {
    "function_name": "virAdmConnectClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "287-301",
    "snippet": "int\nvirAdmConnectClose(virAdmConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n    if (!conn)\n        return 0;\n\n    virCheckAdmConnectReturn(conn, -1);\n\n    if (!virObjectUnref(conn))\n        return 0;\n    return 1;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "conn"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckAdmConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p\"",
            "conn"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirAdmConnectClose(virAdmConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n    if (!conn)\n        return 0;\n\n    virCheckAdmConnectReturn(conn, -1);\n\n    if (!virObjectUnref(conn))\n        return 0;\n    return 1;\n}"
  },
  {
    "function_name": "virAdmConnectOpen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "203-260",
    "snippet": "virAdmConnectPtr\nvirAdmConnectOpen(const char *name, unsigned int flags)\n{\n    g_autofree char *sock_path = NULL;\n    char *alias = NULL;\n    virAdmConnectPtr conn = NULL;\n    g_autoptr(virConf) conf = NULL;\n    g_autofree char *uristr = NULL;\n\n    if (virAdmInitialize() < 0)\n        goto error;\n\n    VIR_DEBUG(\"name=%s flags=0x%x\", NULLSTR(name), flags);\n    virResetLastError();\n\n    if (!(conn = virAdmConnectNew()))\n        goto error;\n\n    if (virConfLoadConfig(&conf, \"libvirt-admin.conf\") < 0)\n        goto error;\n\n    if (name) {\n        uristr = g_strdup(name);\n    } else {\n        if (virAdmGetDefaultURI(conf, &uristr) < 0)\n            goto error;\n    }\n\n    if ((!(flags & VIR_CONNECT_NO_ALIASES) &&\n         virURIResolveAlias(conf, uristr, &alias) < 0))\n        goto error;\n\n    if (alias) {\n        g_free(uristr);\n        uristr = alias;\n    }\n\n    if (!(conn->uri = virURIParse(uristr)))\n        goto error;\n\n    if (!(sock_path = getSocketPath(conn->uri)))\n        goto error;\n\n    if (!(conn->privateData = remoteAdminPrivNew(sock_path)))\n        goto error;\n\n    conn->privateDataFreeFunc = remoteAdminPrivFree;\n\n    if (remoteAdminConnectOpen(conn, flags) < 0)\n        goto error;\n\n    return conn;\n\n error:\n    virDispatchError(NULL);\n    virObjectUnref(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "conn"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "NULL"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminConnectOpen",
          "args": [
            "conn",
            "flags"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "remoteAdminConnectOpen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_remote.c",
          "lines": "150-183",
          "snippet": "static int\nremoteAdminConnectOpen(virAdmConnectPtr conn, unsigned int flags)\n{\n    int rv = -1;\n    remoteAdminPrivPtr priv = conn->privateData;\n    admin_connect_open_args args;\n\n    virObjectLock(priv);\n\n    args.flags = flags & ~VIR_CONNECT_NO_ALIASES;\n\n    if (virNetClientRegisterAsyncIO(priv->client) < 0) {\n        VIR_DEBUG(\"Failed to add event watch, disabling events and support for\"\n                  \" keepalive messages\");\n        virResetLastError();\n    }\n\n    virObjectRef(conn->closeCallback);\n    virNetClientSetCloseCallback(priv->client, remoteAdminClientCloseFunc,\n                                 conn->closeCallback,\n                                 virObjectFreeCallback);\n\n    if (call(conn, 0, ADMIN_PROC_CONNECT_OPEN,\n             (xdrproc_t)xdr_admin_connect_open_args, (char *)&args,\n             (xdrproc_t)xdr_void, (char *)NULL) == -1) {\n        goto done;\n    }\n\n    rv = 0;\n\n done:\n    virObjectUnlock(priv);\n    return rv;\n}",
          "includes": [
            "#include \"admin_client.h\"",
            "#include \"admin_protocol.h\"",
            "#include \"virtypedparam.h\"",
            "#include <rpc/rpc.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"admin_client.h\"\n#include \"admin_protocol.h\"\n#include \"virtypedparam.h\"\n#include <rpc/rpc.h>\n#include <config.h>\n\nstatic int\nremoteAdminConnectOpen(virAdmConnectPtr conn, unsigned int flags)\n{\n    int rv = -1;\n    remoteAdminPrivPtr priv = conn->privateData;\n    admin_connect_open_args args;\n\n    virObjectLock(priv);\n\n    args.flags = flags & ~VIR_CONNECT_NO_ALIASES;\n\n    if (virNetClientRegisterAsyncIO(priv->client) < 0) {\n        VIR_DEBUG(\"Failed to add event watch, disabling events and support for\"\n                  \" keepalive messages\");\n        virResetLastError();\n    }\n\n    virObjectRef(conn->closeCallback);\n    virNetClientSetCloseCallback(priv->client, remoteAdminClientCloseFunc,\n                                 conn->closeCallback,\n                                 virObjectFreeCallback);\n\n    if (call(conn, 0, ADMIN_PROC_CONNECT_OPEN,\n             (xdrproc_t)xdr_admin_connect_open_args, (char *)&args,\n             (xdrproc_t)xdr_void, (char *)NULL) == -1) {\n        goto done;\n    }\n\n    rv = 0;\n\n done:\n    virObjectUnlock(priv);\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "remoteAdminPrivNew",
          "args": [
            "sock_path"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "remoteAdminPrivNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_remote.c",
          "lines": "219-242",
          "snippet": "static remoteAdminPrivPtr\nremoteAdminPrivNew(const char *sock_path)\n{\n    remoteAdminPrivPtr priv = NULL;\n\n    if (!(priv = virObjectLockableNew(remoteAdminPrivClass)))\n        goto error;\n\n    if (!(priv->client = virNetClientNewUNIX(sock_path, false, NULL)))\n        goto error;\n\n    if (!(priv->program = virNetClientProgramNew(ADMIN_PROGRAM,\n                                                 ADMIN_PROTOCOL_VERSION,\n                                                 NULL, 0, NULL)))\n        goto error;\n\n    if (virNetClientAddProgram(priv->client, priv->program) < 0)\n        goto error;\n\n    return priv;\n error:\n    virObjectUnref(priv);\n    return NULL;\n}",
          "includes": [
            "#include \"admin_client.h\"",
            "#include \"admin_protocol.h\"",
            "#include \"virtypedparam.h\"",
            "#include <rpc/rpc.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr remoteAdminPrivClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"admin_client.h\"\n#include \"admin_protocol.h\"\n#include \"virtypedparam.h\"\n#include <rpc/rpc.h>\n#include <config.h>\n\nstatic virClassPtr remoteAdminPrivClass;\n\nstatic remoteAdminPrivPtr\nremoteAdminPrivNew(const char *sock_path)\n{\n    remoteAdminPrivPtr priv = NULL;\n\n    if (!(priv = virObjectLockableNew(remoteAdminPrivClass)))\n        goto error;\n\n    if (!(priv->client = virNetClientNewUNIX(sock_path, false, NULL)))\n        goto error;\n\n    if (!(priv->program = virNetClientProgramNew(ADMIN_PROGRAM,\n                                                 ADMIN_PROTOCOL_VERSION,\n                                                 NULL, 0, NULL)))\n        goto error;\n\n    if (virNetClientAddProgram(priv->client, priv->program) < 0)\n        goto error;\n\n    return priv;\n error:\n    virObjectUnref(priv);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getSocketPath",
          "args": [
            "conn->uri"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "getSocketPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
          "lines": "99-160",
          "snippet": "static char *\ngetSocketPath(virURIPtr uri)\n{\n    g_autofree char *rundir = virGetUserRuntimeDirectory();\n    g_autofree char *sock_path = NULL;\n    size_t i = 0;\n\n    if (!uri)\n        return NULL;\n\n\n    for (i = 0; i < uri->paramsCount; i++) {\n        virURIParamPtr param = &uri->params[i];\n\n        if (STREQ(param->name, \"socket\")) {\n            g_free(sock_path);\n            sock_path = g_strdup(param->value);\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unknown URI parameter '%s'\"), param->name);\n            return NULL;\n        }\n    }\n\n    if (!sock_path) {\n        g_autofree char *sockbase = NULL;\n        bool legacy = false;\n\n        if (!uri->scheme) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           \"%s\", _(\"No URI scheme specified\"));\n            return NULL;\n        }\n        if (STREQ(uri->scheme, \"libvirtd\")) {\n            legacy = true;\n        } else if (!STRPREFIX(uri->scheme, \"virt\")) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unsupported URI scheme '%s'\"),\n                           uri->scheme);\n            return NULL;\n        }\n\n        if (legacy) {\n            sockbase = g_strdup(\"libvirt-admin-sock\");\n        } else {\n            sockbase = g_strdup_printf(\"%s-admin-sock\", uri->scheme);\n        }\n\n        if (STREQ_NULLABLE(uri->path, \"/system\")) {\n            sock_path = g_strdup_printf(RUNSTATEDIR \"/libvirt/%s\", sockbase);\n        } else if (STREQ_NULLABLE(uri->path, \"/session\")) {\n            sock_path = g_strdup_printf(\"%s/%s\", rundir, sockbase);\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Invalid URI path '%s', try '/system'\"),\n                           NULLSTR_EMPTY(uri->path));\n            return NULL;\n        }\n    }\n\n    return g_steal_pointer(&sock_path);\n}",
          "includes": [
            "#include \"admin_remote.c\"",
            "#include \"viruuid.h\"",
            "#include \"virutil.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetclient.h\"",
            "#include \"virlog.h\"",
            "#include \"virconf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\ngetSocketPath(virURIPtr uri)\n{\n    g_autofree char *rundir = virGetUserRuntimeDirectory();\n    g_autofree char *sock_path = NULL;\n    size_t i = 0;\n\n    if (!uri)\n        return NULL;\n\n\n    for (i = 0; i < uri->paramsCount; i++) {\n        virURIParamPtr param = &uri->params[i];\n\n        if (STREQ(param->name, \"socket\")) {\n            g_free(sock_path);\n            sock_path = g_strdup(param->value);\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unknown URI parameter '%s'\"), param->name);\n            return NULL;\n        }\n    }\n\n    if (!sock_path) {\n        g_autofree char *sockbase = NULL;\n        bool legacy = false;\n\n        if (!uri->scheme) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           \"%s\", _(\"No URI scheme specified\"));\n            return NULL;\n        }\n        if (STREQ(uri->scheme, \"libvirtd\")) {\n            legacy = true;\n        } else if (!STRPREFIX(uri->scheme, \"virt\")) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unsupported URI scheme '%s'\"),\n                           uri->scheme);\n            return NULL;\n        }\n\n        if (legacy) {\n            sockbase = g_strdup(\"libvirt-admin-sock\");\n        } else {\n            sockbase = g_strdup_printf(\"%s-admin-sock\", uri->scheme);\n        }\n\n        if (STREQ_NULLABLE(uri->path, \"/system\")) {\n            sock_path = g_strdup_printf(RUNSTATEDIR \"/libvirt/%s\", sockbase);\n        } else if (STREQ_NULLABLE(uri->path, \"/session\")) {\n            sock_path = g_strdup_printf(\"%s/%s\", rundir, sockbase);\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Invalid URI path '%s', try '/system'\"),\n                           NULLSTR_EMPTY(uri->path));\n            return NULL;\n        }\n    }\n\n    return g_steal_pointer(&sock_path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virURIParse",
          "args": [
            "uristr"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "virURIParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruri.c",
          "lines": "143-194",
          "snippet": "virURIPtr\nvirURIParse(const char *uri)\n{\n    xmlURIPtr xmluri;\n    virURIPtr ret = NULL;\n\n    xmluri = xmlParseURI(uri);\n\n    if (!xmluri) {\n        /* libxml2 does not tell us what failed. Grr :-( */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse URI %s\"), uri);\n        return NULL;\n    }\n\n    if (VIR_ALLOC(ret) < 0)\n        goto error;\n\n    ret->scheme = g_strdup(xmluri->scheme);\n    ret->server = g_strdup(xmluri->server);\n    /* xmluri->port value is not defined if server was\n     * not given. Modern versions libxml2 fill port\n     * differently to old versions in this case, so\n     * don't rely on it. eg libxml2 git commit:\n     *   beb7281055dbf0ed4d041022a67c6c5cfd126f25\n     */\n    if (!ret->server || STREQ(ret->server, \"\"))\n        ret->port = 0;\n    else\n        ret->port = xmluri->port;\n    ret->path = g_strdup(xmluri->path);\n    ret->query = g_strdup(xmluri->query_raw);\n    ret->fragment = g_strdup(xmluri->fragment);\n    ret->user = g_strdup(xmluri->user);\n\n    /* Strip square bracket from an IPv6 address.\n     * The function modifies the string in-place. Even after such\n     * modification, it is OK to free the URI with xmlFreeURI. */\n    virStringStripIPv6Brackets(ret->server);\n\n    if (virURIParseParams(ret) < 0)\n        goto error;\n\n    xmlFreeURI(xmluri);\n\n    return ret;\n\n error:\n    xmlFreeURI(xmluri);\n    virURIFree(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruri.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruri.h\"\n#include <config.h>\n\nvirURIPtr\nvirURIParse(const char *uri)\n{\n    xmlURIPtr xmluri;\n    virURIPtr ret = NULL;\n\n    xmluri = xmlParseURI(uri);\n\n    if (!xmluri) {\n        /* libxml2 does not tell us what failed. Grr :-( */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse URI %s\"), uri);\n        return NULL;\n    }\n\n    if (VIR_ALLOC(ret) < 0)\n        goto error;\n\n    ret->scheme = g_strdup(xmluri->scheme);\n    ret->server = g_strdup(xmluri->server);\n    /* xmluri->port value is not defined if server was\n     * not given. Modern versions libxml2 fill port\n     * differently to old versions in this case, so\n     * don't rely on it. eg libxml2 git commit:\n     *   beb7281055dbf0ed4d041022a67c6c5cfd126f25\n     */\n    if (!ret->server || STREQ(ret->server, \"\"))\n        ret->port = 0;\n    else\n        ret->port = xmluri->port;\n    ret->path = g_strdup(xmluri->path);\n    ret->query = g_strdup(xmluri->query_raw);\n    ret->fragment = g_strdup(xmluri->fragment);\n    ret->user = g_strdup(xmluri->user);\n\n    /* Strip square bracket from an IPv6 address.\n     * The function modifies the string in-place. Even after such\n     * modification, it is OK to free the URI with xmlFreeURI. */\n    virStringStripIPv6Brackets(ret->server);\n\n    if (virURIParseParams(ret) < 0)\n        goto error;\n\n    xmlFreeURI(xmluri);\n\n    return ret;\n\n error:\n    xmlFreeURI(xmluri);\n    virURIFree(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "uristr"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virURIResolveAlias",
          "args": [
            "conf",
            "uristr",
            "&alias"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "virURIResolveAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruri.c",
          "lines": "358-377",
          "snippet": "int\nvirURIResolveAlias(virConfPtr conf, const char *alias, char **uri)\n{\n    int ret = -1;\n    char **aliases = NULL;\n\n    *uri = NULL;\n\n    if (virConfGetValueStringList(conf, \"uri_aliases\", false, &aliases) < 0)\n        return -1;\n\n    if (aliases && *aliases) {\n        ret = virURIFindAliasMatch(aliases, alias, uri);\n        virStringListFree(aliases);\n    } else {\n        ret = 0;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruri.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruri.h\"\n#include <config.h>\n\nint\nvirURIResolveAlias(virConfPtr conf, const char *alias, char **uri)\n{\n    int ret = -1;\n    char **aliases = NULL;\n\n    *uri = NULL;\n\n    if (virConfGetValueStringList(conf, \"uri_aliases\", false, &aliases) < 0)\n        return -1;\n\n    if (aliases && *aliases) {\n        ret = virURIFindAliasMatch(aliases, alias, uri);\n        virStringListFree(aliases);\n    } else {\n        ret = 0;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAdmGetDefaultURI",
          "args": [
            "conf",
            "&uristr"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "virAdmGetDefaultURI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
          "lines": "162-191",
          "snippet": "static int\nvirAdmGetDefaultURI(virConfPtr conf, char **uristr)\n{\n    const char *defname = getenv(\"LIBVIRT_ADMIN_DEFAULT_URI\");\n    if (defname && *defname) {\n        *uristr = g_strdup(defname);\n        VIR_DEBUG(\"Using LIBVIRT_ADMIN_DEFAULT_URI '%s'\", *uristr);\n    } else {\n        if (virConfGetValueString(conf, \"uri_default\", uristr) < 0)\n            return -1;\n\n        if (*uristr) {\n            VIR_DEBUG(\"Using config file uri '%s'\", *uristr);\n        } else {\n            /* Since we can't probe connecting via any hypervisor driver as libvirt\n             * does, if no explicit URI was given and neither the environment\n             * variable, nor the configuration parameter had previously been set,\n             * we set the default admin server URI to 'libvirtd:///system' or\n             * 'libvirtd:///session' depending on the process's EUID.\n             */\n            if (geteuid() == 0) {\n                *uristr = g_strdup(\"libvirtd:///system\");\n            } else {\n                *uristr = g_strdup(\"libvirtd:///session\");\n            }\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"admin_remote.c\"",
            "#include \"viruuid.h\"",
            "#include \"virutil.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetclient.h\"",
            "#include \"virlog.h\"",
            "#include \"virconf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirAdmGetDefaultURI(virConfPtr conf, char **uristr)\n{\n    const char *defname = getenv(\"LIBVIRT_ADMIN_DEFAULT_URI\");\n    if (defname && *defname) {\n        *uristr = g_strdup(defname);\n        VIR_DEBUG(\"Using LIBVIRT_ADMIN_DEFAULT_URI '%s'\", *uristr);\n    } else {\n        if (virConfGetValueString(conf, \"uri_default\", uristr) < 0)\n            return -1;\n\n        if (*uristr) {\n            VIR_DEBUG(\"Using config file uri '%s'\", *uristr);\n        } else {\n            /* Since we can't probe connecting via any hypervisor driver as libvirt\n             * does, if no explicit URI was given and neither the environment\n             * variable, nor the configuration parameter had previously been set,\n             * we set the default admin server URI to 'libvirtd:///system' or\n             * 'libvirtd:///session' depending on the process's EUID.\n             */\n            if (geteuid() == 0) {\n                *uristr = g_strdup(\"libvirtd:///system\");\n            } else {\n                *uristr = g_strdup(\"libvirtd:///session\");\n            }\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "name"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfLoadConfig",
          "args": [
            "&conf",
            "\"libvirt-admin.conf\""
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "virConfLoadConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1517-1542",
          "snippet": "int\nvirConfLoadConfig(virConfPtr *conf, const char *name)\n{\n    char *path = NULL;\n    int ret = -1;\n\n    *conf = NULL;\n\n    if (!(path = virConfLoadConfigPath(name)))\n        goto cleanup;\n\n    if (!virFileExists(path)) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"Loading config file '%s'\", path);\n    if (!(*conf = virConfReadFile(path, 0)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(path);\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirConfLoadConfig(virConfPtr *conf, const char *name)\n{\n    char *path = NULL;\n    int ret = -1;\n\n    *conf = NULL;\n\n    if (!(path = virConfLoadConfigPath(name)))\n        goto cleanup;\n\n    if (!virFileExists(path)) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"Loading config file '%s'\", path);\n    if (!(*conf = virConfReadFile(path, 0)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(path);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAdmConnectNew",
          "args": [],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "virAdmConnectNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "1069-1088",
          "snippet": "virAdmConnectPtr\nvirAdmConnectNew(void)\n{\n    virAdmConnectPtr ret;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    if (!(ret = virObjectLockableNew(virAdmConnectClass)))\n        return NULL;\n\n    if (!(ret->closeCallback = virObjectLockableNew(virAdmConnectCloseCallbackDataClass)))\n        goto error;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virAdmConnectClass;",
            "virClassPtr virAdmConnectCloseCallbackDataClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virAdmConnectClass;\nvirClassPtr virAdmConnectCloseCallbackDataClass;\n\nvirAdmConnectPtr\nvirAdmConnectNew(void)\n{\n    virAdmConnectPtr ret;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    if (!(ret = virObjectLockableNew(virAdmConnectClass)))\n        return NULL;\n\n    if (!(ret->closeCallback = virObjectLockableNew(virAdmConnectCloseCallbackDataClass)))\n        goto error;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"name=%s flags=0x%x\"",
            "NULLSTR(name)",
            "flags"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "name"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAdmInitialize",
          "args": [],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "virAdmInitialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
          "lines": "87-97",
          "snippet": "int\nvirAdmInitialize(void)\n{\n    if (virOnce(&virAdmGlobalOnce, virAdmGlobalInit) < 0)\n        return -1;\n\n    if (virAdmGlobalError)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"admin_remote.c\"",
            "#include \"viruuid.h\"",
            "#include \"virutil.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetclient.h\"",
            "#include \"virlog.h\"",
            "#include \"virconf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool virAdmGlobalError;",
            "static virOnceControl virAdmGlobalOnce = VIR_ONCE_CONTROL_INITIALIZER;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool virAdmGlobalError;\nstatic virOnceControl virAdmGlobalOnce = VIR_ONCE_CONTROL_INITIALIZER;\n\nint\nvirAdmInitialize(void)\n{\n    if (virOnce(&virAdmGlobalOnce, virAdmGlobalInit) < 0)\n        return -1;\n\n    if (virAdmGlobalError)\n        return -1;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirAdmConnectPtr\nvirAdmConnectOpen(const char *name, unsigned int flags)\n{\n    g_autofree char *sock_path = NULL;\n    char *alias = NULL;\n    virAdmConnectPtr conn = NULL;\n    g_autoptr(virConf) conf = NULL;\n    g_autofree char *uristr = NULL;\n\n    if (virAdmInitialize() < 0)\n        goto error;\n\n    VIR_DEBUG(\"name=%s flags=0x%x\", NULLSTR(name), flags);\n    virResetLastError();\n\n    if (!(conn = virAdmConnectNew()))\n        goto error;\n\n    if (virConfLoadConfig(&conf, \"libvirt-admin.conf\") < 0)\n        goto error;\n\n    if (name) {\n        uristr = g_strdup(name);\n    } else {\n        if (virAdmGetDefaultURI(conf, &uristr) < 0)\n            goto error;\n    }\n\n    if ((!(flags & VIR_CONNECT_NO_ALIASES) &&\n         virURIResolveAlias(conf, uristr, &alias) < 0))\n        goto error;\n\n    if (alias) {\n        g_free(uristr);\n        uristr = alias;\n    }\n\n    if (!(conn->uri = virURIParse(uristr)))\n        goto error;\n\n    if (!(sock_path = getSocketPath(conn->uri)))\n        goto error;\n\n    if (!(conn->privateData = remoteAdminPrivNew(sock_path)))\n        goto error;\n\n    conn->privateDataFreeFunc = remoteAdminPrivFree;\n\n    if (remoteAdminConnectOpen(conn, flags) < 0)\n        goto error;\n\n    return conn;\n\n error:\n    virDispatchError(NULL);\n    virObjectUnref(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virAdmGetDefaultURI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "162-191",
    "snippet": "static int\nvirAdmGetDefaultURI(virConfPtr conf, char **uristr)\n{\n    const char *defname = getenv(\"LIBVIRT_ADMIN_DEFAULT_URI\");\n    if (defname && *defname) {\n        *uristr = g_strdup(defname);\n        VIR_DEBUG(\"Using LIBVIRT_ADMIN_DEFAULT_URI '%s'\", *uristr);\n    } else {\n        if (virConfGetValueString(conf, \"uri_default\", uristr) < 0)\n            return -1;\n\n        if (*uristr) {\n            VIR_DEBUG(\"Using config file uri '%s'\", *uristr);\n        } else {\n            /* Since we can't probe connecting via any hypervisor driver as libvirt\n             * does, if no explicit URI was given and neither the environment\n             * variable, nor the configuration parameter had previously been set,\n             * we set the default admin server URI to 'libvirtd:///system' or\n             * 'libvirtd:///session' depending on the process's EUID.\n             */\n            if (geteuid() == 0) {\n                *uristr = g_strdup(\"libvirtd:///system\");\n            } else {\n                *uristr = g_strdup(\"libvirtd:///session\");\n            }\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"libvirtd:///session\""
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "geteuid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "68-69",
          "snippet": "static inline int geteuid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int geteuid(void)\n{ return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Using config file uri '%s'\"",
            "*uristr"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "conf",
            "\"uri_default\"",
            "uristr"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Using LIBVIRT_ADMIN_DEFAULT_URI '%s'\"",
            "*uristr"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"LIBVIRT_ADMIN_DEFAULT_URI\""
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirAdmGetDefaultURI(virConfPtr conf, char **uristr)\n{\n    const char *defname = getenv(\"LIBVIRT_ADMIN_DEFAULT_URI\");\n    if (defname && *defname) {\n        *uristr = g_strdup(defname);\n        VIR_DEBUG(\"Using LIBVIRT_ADMIN_DEFAULT_URI '%s'\", *uristr);\n    } else {\n        if (virConfGetValueString(conf, \"uri_default\", uristr) < 0)\n            return -1;\n\n        if (*uristr) {\n            VIR_DEBUG(\"Using config file uri '%s'\", *uristr);\n        } else {\n            /* Since we can't probe connecting via any hypervisor driver as libvirt\n             * does, if no explicit URI was given and neither the environment\n             * variable, nor the configuration parameter had previously been set,\n             * we set the default admin server URI to 'libvirtd:///system' or\n             * 'libvirtd:///session' depending on the process's EUID.\n             */\n            if (geteuid() == 0) {\n                *uristr = g_strdup(\"libvirtd:///system\");\n            } else {\n                *uristr = g_strdup(\"libvirtd:///session\");\n            }\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "getSocketPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "99-160",
    "snippet": "static char *\ngetSocketPath(virURIPtr uri)\n{\n    g_autofree char *rundir = virGetUserRuntimeDirectory();\n    g_autofree char *sock_path = NULL;\n    size_t i = 0;\n\n    if (!uri)\n        return NULL;\n\n\n    for (i = 0; i < uri->paramsCount; i++) {\n        virURIParamPtr param = &uri->params[i];\n\n        if (STREQ(param->name, \"socket\")) {\n            g_free(sock_path);\n            sock_path = g_strdup(param->value);\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unknown URI parameter '%s'\"), param->name);\n            return NULL;\n        }\n    }\n\n    if (!sock_path) {\n        g_autofree char *sockbase = NULL;\n        bool legacy = false;\n\n        if (!uri->scheme) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           \"%s\", _(\"No URI scheme specified\"));\n            return NULL;\n        }\n        if (STREQ(uri->scheme, \"libvirtd\")) {\n            legacy = true;\n        } else if (!STRPREFIX(uri->scheme, \"virt\")) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unsupported URI scheme '%s'\"),\n                           uri->scheme);\n            return NULL;\n        }\n\n        if (legacy) {\n            sockbase = g_strdup(\"libvirt-admin-sock\");\n        } else {\n            sockbase = g_strdup_printf(\"%s-admin-sock\", uri->scheme);\n        }\n\n        if (STREQ_NULLABLE(uri->path, \"/system\")) {\n            sock_path = g_strdup_printf(RUNSTATEDIR \"/libvirt/%s\", sockbase);\n        } else if (STREQ_NULLABLE(uri->path, \"/session\")) {\n            sock_path = g_strdup_printf(\"%s/%s\", rundir, sockbase);\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Invalid URI path '%s', try '/system'\"),\n                           NULLSTR_EMPTY(uri->path));\n            return NULL;\n        }\n    }\n\n    return g_steal_pointer(&sock_path);\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&sock_path"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Invalid URI path '%s', try '/system'\")",
            "NULLSTR_EMPTY(uri->path)"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR_EMPTY",
          "args": [
            "uri->path"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid URI path '%s', try '/system'\""
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "uri->path",
            "\"/session\""
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "uri->path",
            "\"/system\""
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Unsupported URI scheme '%s'\")",
            "uri->scheme"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "uri->scheme",
            "\"virt\""
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "uri->scheme",
            "\"libvirtd\""
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"No URI scheme specified\")"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Unknown URI parameter '%s'\")",
            "param->name"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "sock_path"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->name",
            "\"socket\""
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetUserRuntimeDirectory",
          "args": [],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserRuntimeDirectory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "594-601",
          "snippet": "char *virGetUserRuntimeDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_runtime_dir());\n#else\n    return g_build_filename(g_get_user_runtime_dir(), \"libvirt\", NULL);\n#endif\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virGetUserRuntimeDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_runtime_dir());\n#else\n    return g_build_filename(g_get_user_runtime_dir(), \"libvirt\", NULL);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\ngetSocketPath(virURIPtr uri)\n{\n    g_autofree char *rundir = virGetUserRuntimeDirectory();\n    g_autofree char *sock_path = NULL;\n    size_t i = 0;\n\n    if (!uri)\n        return NULL;\n\n\n    for (i = 0; i < uri->paramsCount; i++) {\n        virURIParamPtr param = &uri->params[i];\n\n        if (STREQ(param->name, \"socket\")) {\n            g_free(sock_path);\n            sock_path = g_strdup(param->value);\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unknown URI parameter '%s'\"), param->name);\n            return NULL;\n        }\n    }\n\n    if (!sock_path) {\n        g_autofree char *sockbase = NULL;\n        bool legacy = false;\n\n        if (!uri->scheme) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           \"%s\", _(\"No URI scheme specified\"));\n            return NULL;\n        }\n        if (STREQ(uri->scheme, \"libvirtd\")) {\n            legacy = true;\n        } else if (!STRPREFIX(uri->scheme, \"virt\")) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unsupported URI scheme '%s'\"),\n                           uri->scheme);\n            return NULL;\n        }\n\n        if (legacy) {\n            sockbase = g_strdup(\"libvirt-admin-sock\");\n        } else {\n            sockbase = g_strdup_printf(\"%s-admin-sock\", uri->scheme);\n        }\n\n        if (STREQ_NULLABLE(uri->path, \"/system\")) {\n            sock_path = g_strdup_printf(RUNSTATEDIR \"/libvirt/%s\", sockbase);\n        } else if (STREQ_NULLABLE(uri->path, \"/session\")) {\n            sock_path = g_strdup_printf(\"%s/%s\", rundir, sockbase);\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Invalid URI path '%s', try '/system'\"),\n                           NULLSTR_EMPTY(uri->path));\n            return NULL;\n        }\n    }\n\n    return g_steal_pointer(&sock_path);\n}"
  },
  {
    "function_name": "virAdmInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "87-97",
    "snippet": "int\nvirAdmInitialize(void)\n{\n    if (virOnce(&virAdmGlobalOnce, virAdmGlobalInit) < 0)\n        return -1;\n\n    if (virAdmGlobalError)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool virAdmGlobalError;",
      "static virOnceControl virAdmGlobalOnce = VIR_ONCE_CONTROL_INITIALIZER;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virOnce",
          "args": [
            "&virAdmGlobalOnce",
            "virAdmGlobalInit"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "virOnce",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "40-43",
          "snippet": "int virOnce(virOnceControlPtr once, virOnceFunc init)\n{\n    return pthread_once(&once->once, init);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virOnce(virOnceControlPtr once, virOnceFunc init)\n{\n    return pthread_once(&once->once, init);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool virAdmGlobalError;\nstatic virOnceControl virAdmGlobalOnce = VIR_ONCE_CONTROL_INITIALIZER;\n\nint\nvirAdmInitialize(void)\n{\n    if (virOnce(&virAdmGlobalOnce, virAdmGlobalInit) < 0)\n        return -1;\n\n    if (virAdmGlobalError)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virAdmGlobalInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/libvirt-admin.c",
    "lines": "47-71",
    "snippet": "static void\nvirAdmGlobalInit(void)\n{\n    /* It would be nice if we could trace the use of this call, to\n     * help diagnose in log files if a user calls something other than\n     * virAdmConnectOpen first.  But we can't rely on VIR_DEBUG working\n     * until after initialization is complete, and since this is\n     * one-shot, we never get here again.  */\n    if (virErrorInitialize() < 0)\n        goto error;\n\n    virLogSetFromEnv();\n\n#ifdef HAVE_LIBINTL_H\n    if (!bindtextdomain(PACKAGE, LOCALEDIR))\n        goto error;\n#endif /* HAVE_LIBINTL_H */\n\n    if (!VIR_CLASS_NEW(remoteAdminPriv, virClassForObjectLockable()))\n        goto error;\n\n    return;\n error:\n    virAdmGlobalError = true;\n}",
    "includes": [
      "#include \"admin_remote.c\"",
      "#include \"viruuid.h\"",
      "#include \"virutil.h\"",
      "#include \"viruri.h\"",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virnetclient.h\"",
      "#include \"virlog.h\"",
      "#include \"virconf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool virAdmGlobalError;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "remoteAdminPriv",
            "virClassForObjectLockable()"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bindtextdomain",
          "args": [
            "PACKAGE",
            "LOCALEDIR"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogSetFromEnv",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "virLogSetFromEnv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1208-1225",
          "snippet": "void\nvirLogSetFromEnv(void)\n{\n    const char *debugEnv;\n\n    if (virLogInitialize() < 0)\n        return;\n\n    debugEnv = getenv(\"LIBVIRT_DEBUG\");\n    if (debugEnv && *debugEnv)\n        virLogSetDefaultPriority(virLogParseDefaultPriority(debugEnv));\n    debugEnv = getenv(\"LIBVIRT_LOG_FILTERS\");\n    if (debugEnv && *debugEnv)\n        virLogSetFilters(debugEnv);\n    debugEnv = getenv(\"LIBVIRT_LOG_OUTPUTS\");\n    if (debugEnv && *debugEnv)\n        virLogSetOutputs(debugEnv);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirLogSetFromEnv(void)\n{\n    const char *debugEnv;\n\n    if (virLogInitialize() < 0)\n        return;\n\n    debugEnv = getenv(\"LIBVIRT_DEBUG\");\n    if (debugEnv && *debugEnv)\n        virLogSetDefaultPriority(virLogParseDefaultPriority(debugEnv));\n    debugEnv = getenv(\"LIBVIRT_LOG_FILTERS\");\n    if (debugEnv && *debugEnv)\n        virLogSetFilters(debugEnv);\n    debugEnv = getenv(\"LIBVIRT_LOG_OUTPUTS\");\n    if (debugEnv && *debugEnv)\n        virLogSetOutputs(debugEnv);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virErrorInitialize",
          "args": [],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorInitialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "172-176",
          "snippet": "int\nvirErrorInitialize(void)\n{\n    return virThreadLocalInit(&virLastErr, virLastErrFreeData);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal virLastErr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirThreadLocal virLastErr;\n\nint\nvirErrorInitialize(void)\n{\n    return virThreadLocalInit(&virLastErr, virLastErrFreeData);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"admin_remote.c\"\n#include \"viruuid.h\"\n#include \"virutil.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virnetclient.h\"\n#include \"virlog.h\"\n#include \"virconf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool virAdmGlobalError;\n\nstatic void\nvirAdmGlobalInit(void)\n{\n    /* It would be nice if we could trace the use of this call, to\n     * help diagnose in log files if a user calls something other than\n     * virAdmConnectOpen first.  But we can't rely on VIR_DEBUG working\n     * until after initialization is complete, and since this is\n     * one-shot, we never get here again.  */\n    if (virErrorInitialize() < 0)\n        goto error;\n\n    virLogSetFromEnv();\n\n#ifdef HAVE_LIBINTL_H\n    if (!bindtextdomain(PACKAGE, LOCALEDIR))\n        goto error;\n#endif /* HAVE_LIBINTL_H */\n\n    if (!VIR_CLASS_NEW(remoteAdminPriv, virClassForObjectLockable()))\n        goto error;\n\n    return;\n error:\n    virAdmGlobalError = true;\n}"
  }
]