[
  {
    "function_name": "qemuMigrationCapsGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "1487-1498",
    "snippet": "bool\nqemuMigrationCapsGet(virDomainObjPtr vm,\n                     qemuMigrationCapability cap)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    bool enabled = false;\n\n    if (priv->migrationCaps)\n        ignore_value(virBitmapGetBit(priv->migrationCaps, cap, &enabled));\n\n    return enabled;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapGetBit(priv->migrationCaps, cap, &enabled)"
          ],
          "line": 1495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapGetBit",
          "args": [
            "priv->migrationCaps",
            "cap",
            "&enabled"
          ],
          "line": 1495
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapGetBit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "320-330",
          "snippet": "int\nvirBitmapGetBit(virBitmapPtr bitmap,\n                size_t b,\n                bool *result)\n{\n    if (bitmap->nbits <= b)\n        return -1;\n\n    *result = virBitmapIsSet(bitmap, b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapGetBit(virBitmapPtr bitmap,\n                size_t b,\n                bool *result)\n{\n    if (bitmap->nbits <= b)\n        return -1;\n\n    *result = virBitmapIsSet(bitmap, b);\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nbool\nqemuMigrationCapsGet(virDomainObjPtr vm,\n                     qemuMigrationCapability cap)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    bool enabled = false;\n\n    if (priv->migrationCaps)\n        ignore_value(virBitmapGetBit(priv->migrationCaps, cap, &enabled));\n\n    return enabled;\n}"
  },
  {
    "function_name": "qemuMigrationCapsCheck",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "1403-1484",
    "snippet": "int\nqemuMigrationCapsCheck(virQEMUDriverPtr driver,\n                       virDomainObjPtr vm,\n                       int asyncJob)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virBitmapPtr migEvent = NULL;\n    virJSONValuePtr json = NULL;\n    char **caps = NULL;\n    char **capStr;\n    int ret = -1;\n    int rc;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    rc = qemuMonitorGetMigrationCapabilities(priv->mon, &caps);\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    if (!caps) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    priv->migrationCaps = virBitmapNew(QEMU_MIGRATION_CAP_LAST);\n    if (!priv->migrationCaps)\n        goto cleanup;\n\n    for (capStr = caps; *capStr; capStr++) {\n        int cap = qemuMigrationCapabilityTypeFromString(*capStr);\n\n        if (cap < 0) {\n            VIR_DEBUG(\"Unknown migration capability: '%s'\", *capStr);\n        } else {\n            ignore_value(virBitmapSetBit(priv->migrationCaps, cap));\n            VIR_DEBUG(\"Found migration capability: '%s'\", *capStr);\n        }\n    }\n\n    if (virQEMUCapsGet(priv->qemuCaps, QEMU_CAPS_MIGRATION_EVENT)) {\n        migEvent = virBitmapNew(QEMU_MIGRATION_CAP_LAST);\n        if (!migEvent)\n            goto cleanup;\n\n        ignore_value(virBitmapSetBit(migEvent, QEMU_MIGRATION_CAP_EVENTS));\n\n        if (!(json = qemuMigrationCapsToJSON(migEvent, migEvent)))\n            goto cleanup;\n\n        if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n            goto cleanup;\n\n        rc = qemuMonitorSetMigrationCapabilities(priv->mon, json);\n        json = NULL;\n\n        if (qemuDomainObjExitMonitor(driver, vm) < 0)\n            goto cleanup;\n\n        if (rc < 0) {\n            virResetLastError();\n            VIR_DEBUG(\"Cannot enable migration events; clearing capability\");\n            virQEMUCapsClear(priv->qemuCaps, QEMU_CAPS_MIGRATION_EVENT);\n        }\n    }\n\n    /* Migration events capability must always be enabled, clearing it from\n     * migration capabilities bitmap makes sure it won't be touched anywhere\n     * else.\n     */\n    ignore_value(virBitmapClearBit(priv->migrationCaps,\n                                   QEMU_MIGRATION_CAP_EVENTS));\n\n    ret = 0;\n\n cleanup:\n    virBitmapFree(migEvent);\n    virJSONValueFree(json);\n    virStringListFree(caps);\n    return ret;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "caps"
          ],
          "line": 1482
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "json"
          ],
          "line": 1481
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapFree",
          "args": [
            "migEvent"
          ],
          "line": 1480
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "128-135",
          "snippet": "void\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapClearBit(priv->migrationCaps,\n                                   QEMU_MIGRATION_CAP_EVENTS)"
          ],
          "line": 1474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapClearBit",
          "args": [
            "priv->migrationCaps",
            "QEMU_MIGRATION_CAP_EVENTS"
          ],
          "line": 1474
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapClearBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "265-277",
          "snippet": "int\nvirBitmapClearBitExpand(virBitmapPtr bitmap,\n                        size_t b)\n{\n    if (bitmap->nbits <= b) {\n        if (virBitmapExpand(bitmap, b) < 0)\n            return -1;\n    } else {\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] &= ~VIR_BITMAP_BIT(b);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapClearBitExpand(virBitmapPtr bitmap,\n                        size_t b)\n{\n    if (bitmap->nbits <= b) {\n        if (virBitmapExpand(bitmap, b) < 0)\n            return -1;\n    } else {\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] &= ~VIR_BITMAP_BIT(b);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUCapsClear",
          "args": [
            "priv->qemuCaps",
            "QEMU_CAPS_MIGRATION_EVENT"
          ],
          "line": 1466
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUCapsClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_capabilities.c",
          "lines": "1925-1930",
          "snippet": "void\nvirQEMUCapsClear(virQEMUCapsPtr qemuCaps,\n                 virQEMUCapsFlags flag)\n{\n    ignore_value(virBitmapClearBit(qemuCaps->flags, flag));\n}",
          "includes": [
            "#include <sys/utsname.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"virutil.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_qapi.h\"",
            "#include \"qemu_capspriv.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"virstring.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnuma.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virbitmap.h\"",
            "#include \"vircommand.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu/cpu_x86.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfilecache.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vircrypto.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/utsname.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"virutil.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_process.h\"\n#include \"qemu_qapi.h\"\n#include \"qemu_capspriv.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_hostdev.h\"\n#include \"virstring.h\"\n#include \"qemu_monitor.h\"\n#include \"virhostcpu.h\"\n#include \"virnuma.h\"\n#include \"virnodesuspend.h\"\n#include \"virbitmap.h\"\n#include \"vircommand.h\"\n#include \"domain_conf.h\"\n#include \"cpu/cpu_x86.h\"\n#include \"cpu/cpu.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vircrypto.h\"\n#include \"viralloc.h\"\n#include \"qemu_capabilities.h\"\n#include <config.h>\n\nvoid\nvirQEMUCapsClear(virQEMUCapsPtr qemuCaps,\n                 virQEMUCapsFlags flag)\n{\n    ignore_value(virBitmapClearBit(qemuCaps->flags, flag));\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Cannot enable migration events; clearing capability\""
          ],
          "line": 1465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1464
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainObjExitMonitor",
          "args": [
            "driver",
            "vm"
          ],
          "line": 1460
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjExitMonitor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10189-10200",
          "snippet": "int qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\n\nint qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMonitorSetMigrationCapabilities",
          "args": [
            "priv->mon",
            "json"
          ],
          "line": 1457
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorSetMigrationCapabilities",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "3801-3812",
          "snippet": "int\nqemuMonitorSetMigrationCapabilities(qemuMonitorPtr mon,\n                                    virJSONValuePtr caps)\n{\n    QEMU_CHECK_MONITOR_GOTO(mon, error);\n\n    return qemuMonitorJSONSetMigrationCapabilities(mon, caps);\n\n error:\n    virJSONValueFree(caps);\n    return -1;\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorSetMigrationCapabilities(qemuMonitorPtr mon,\n                                    virJSONValuePtr caps)\n{\n    QEMU_CHECK_MONITOR_GOTO(mon, error);\n\n    return qemuMonitorJSONSetMigrationCapabilities(mon, caps);\n\n error:\n    virJSONValueFree(caps);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainObjEnterMonitorAsync",
          "args": [
            "driver",
            "vm",
            "asyncJob"
          ],
          "line": 1454
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjEnterMonitorAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10216-10222",
          "snippet": "int\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);",
            "qemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\nqemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));\n\nint\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationCapsToJSON",
          "args": [
            "migEvent",
            "migEvent"
          ],
          "line": 1451
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationCapsToJSON",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "776-818",
          "snippet": "virJSONValuePtr\nqemuMigrationCapsToJSON(virBitmapPtr caps,\n                        virBitmapPtr states)\n{\n    virJSONValuePtr json = NULL;\n    virJSONValuePtr cap = NULL;\n    qemuMigrationCapability bit;\n    const char *name;\n\n    json = virJSONValueNewArray();\n\n    for (bit = 0; bit < QEMU_MIGRATION_CAP_LAST; bit++) {\n        bool supported = false;\n        bool state = false;\n\n        ignore_value(virBitmapGetBit(caps, bit, &supported));\n        if (!supported)\n            continue;\n\n        ignore_value(virBitmapGetBit(states, bit, &state));\n\n        cap = virJSONValueNewObject();\n\n        name = qemuMigrationCapabilityTypeToString(bit);\n        if (virJSONValueObjectAppendString(cap, \"capability\", name) < 0)\n            goto error;\n\n        if (virJSONValueObjectAppendBoolean(cap, \"state\", state) < 0)\n            goto error;\n\n        if (virJSONValueArrayAppend(json, cap) < 0)\n            goto error;\n\n        cap = NULL;\n    }\n\n    return json;\n\n error:\n    virJSONValueFree(json);\n    virJSONValueFree(cap);\n    return NULL;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nvirJSONValuePtr\nqemuMigrationCapsToJSON(virBitmapPtr caps,\n                        virBitmapPtr states)\n{\n    virJSONValuePtr json = NULL;\n    virJSONValuePtr cap = NULL;\n    qemuMigrationCapability bit;\n    const char *name;\n\n    json = virJSONValueNewArray();\n\n    for (bit = 0; bit < QEMU_MIGRATION_CAP_LAST; bit++) {\n        bool supported = false;\n        bool state = false;\n\n        ignore_value(virBitmapGetBit(caps, bit, &supported));\n        if (!supported)\n            continue;\n\n        ignore_value(virBitmapGetBit(states, bit, &state));\n\n        cap = virJSONValueNewObject();\n\n        name = qemuMigrationCapabilityTypeToString(bit);\n        if (virJSONValueObjectAppendString(cap, \"capability\", name) < 0)\n            goto error;\n\n        if (virJSONValueObjectAppendBoolean(cap, \"state\", state) < 0)\n            goto error;\n\n        if (virJSONValueArrayAppend(json, cap) < 0)\n            goto error;\n\n        cap = NULL;\n    }\n\n    return json;\n\n error:\n    virJSONValueFree(json);\n    virJSONValueFree(cap);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapSetBit(migEvent, QEMU_MIGRATION_CAP_EVENTS)"
          ],
          "line": 1449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "migEvent",
            "QEMU_MIGRATION_CAP_EVENTS"
          ],
          "line": 1449
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapNew",
          "args": [
            "QEMU_MIGRATION_CAP_LAST"
          ],
          "line": 1445
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1144-1168",
          "snippet": "virBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUCapsGet",
          "args": [
            "priv->qemuCaps",
            "QEMU_CAPS_MIGRATION_EVENT"
          ],
          "line": 1444
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUCapsGetPreferredMachine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_capabilities.c",
          "lines": "5555-5564",
          "snippet": "const char *\nvirQEMUCapsGetPreferredMachine(virQEMUCapsPtr qemuCaps,\n                               virDomainVirtType virtType)\n{\n    virQEMUCapsAccelPtr accel = virQEMUCapsGetAccel(qemuCaps, virtType);\n\n    if (!accel->nmachineTypes)\n        return NULL;\n    return accel->machineTypes[0].name;\n}",
          "includes": [
            "#include <sys/utsname.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"virutil.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_qapi.h\"",
            "#include \"qemu_capspriv.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"virstring.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnuma.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virbitmap.h\"",
            "#include \"vircommand.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu/cpu_x86.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfilecache.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vircrypto.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/utsname.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"virutil.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_process.h\"\n#include \"qemu_qapi.h\"\n#include \"qemu_capspriv.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_hostdev.h\"\n#include \"virstring.h\"\n#include \"qemu_monitor.h\"\n#include \"virhostcpu.h\"\n#include \"virnuma.h\"\n#include \"virnodesuspend.h\"\n#include \"virbitmap.h\"\n#include \"vircommand.h\"\n#include \"domain_conf.h\"\n#include \"cpu/cpu_x86.h\"\n#include \"cpu/cpu.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vircrypto.h\"\n#include \"viralloc.h\"\n#include \"qemu_capabilities.h\"\n#include <config.h>\n\nconst char *\nvirQEMUCapsGetPreferredMachine(virQEMUCapsPtr qemuCaps,\n                               virDomainVirtType virtType)\n{\n    virQEMUCapsAccelPtr accel = virQEMUCapsGetAccel(qemuCaps, virtType);\n\n    if (!accel->nmachineTypes)\n        return NULL;\n    return accel->machineTypes[0].name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Found migration capability: '%s'\"",
            "*capStr"
          ],
          "line": 1440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapSetBit(priv->migrationCaps, cap)"
          ],
          "line": 1439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Unknown migration capability: '%s'\"",
            "*capStr"
          ],
          "line": 1437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMigrationCapabilityTypeFromString",
          "args": [
            "*capStr"
          ],
          "line": 1434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMonitorGetMigrationCapabilities",
          "args": [
            "priv->mon",
            "&caps"
          ],
          "line": 1419
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorGetMigrationCapabilities",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "3781-3788",
          "snippet": "int\nqemuMonitorGetMigrationCapabilities(qemuMonitorPtr mon,\n                                    char ***capabilities)\n{\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONGetMigrationCapabilities(mon, capabilities);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorGetMigrationCapabilities(qemuMonitorPtr mon,\n                                    char ***capabilities)\n{\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONGetMigrationCapabilities(mon, capabilities);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nqemuMigrationCapsCheck(virQEMUDriverPtr driver,\n                       virDomainObjPtr vm,\n                       int asyncJob)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virBitmapPtr migEvent = NULL;\n    virJSONValuePtr json = NULL;\n    char **caps = NULL;\n    char **capStr;\n    int ret = -1;\n    int rc;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    rc = qemuMonitorGetMigrationCapabilities(priv->mon, &caps);\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    if (!caps) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    priv->migrationCaps = virBitmapNew(QEMU_MIGRATION_CAP_LAST);\n    if (!priv->migrationCaps)\n        goto cleanup;\n\n    for (capStr = caps; *capStr; capStr++) {\n        int cap = qemuMigrationCapabilityTypeFromString(*capStr);\n\n        if (cap < 0) {\n            VIR_DEBUG(\"Unknown migration capability: '%s'\", *capStr);\n        } else {\n            ignore_value(virBitmapSetBit(priv->migrationCaps, cap));\n            VIR_DEBUG(\"Found migration capability: '%s'\", *capStr);\n        }\n    }\n\n    if (virQEMUCapsGet(priv->qemuCaps, QEMU_CAPS_MIGRATION_EVENT)) {\n        migEvent = virBitmapNew(QEMU_MIGRATION_CAP_LAST);\n        if (!migEvent)\n            goto cleanup;\n\n        ignore_value(virBitmapSetBit(migEvent, QEMU_MIGRATION_CAP_EVENTS));\n\n        if (!(json = qemuMigrationCapsToJSON(migEvent, migEvent)))\n            goto cleanup;\n\n        if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n            goto cleanup;\n\n        rc = qemuMonitorSetMigrationCapabilities(priv->mon, json);\n        json = NULL;\n\n        if (qemuDomainObjExitMonitor(driver, vm) < 0)\n            goto cleanup;\n\n        if (rc < 0) {\n            virResetLastError();\n            VIR_DEBUG(\"Cannot enable migration events; clearing capability\");\n            virQEMUCapsClear(priv->qemuCaps, QEMU_CAPS_MIGRATION_EVENT);\n        }\n    }\n\n    /* Migration events capability must always be enabled, clearing it from\n     * migration capabilities bitmap makes sure it won't be touched anywhere\n     * else.\n     */\n    ignore_value(virBitmapClearBit(priv->migrationCaps,\n                                   QEMU_MIGRATION_CAP_EVENTS));\n\n    ret = 0;\n\n cleanup:\n    virBitmapFree(migEvent);\n    virJSONValueFree(json);\n    virStringListFree(caps);\n    return ret;\n}"
  },
  {
    "function_name": "qemuMigrationParamsParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "1308-1400",
    "snippet": "int\nqemuMigrationParamsParse(xmlXPathContextPtr ctxt,\n                         qemuMigrationParamsPtr *migParams)\n{\n    qemuMigrationParamsPtr params = NULL;\n    qemuMigrationParamValuePtr pv;\n    xmlNodePtr *nodes = NULL;\n    char *name = NULL;\n    char *value = NULL;\n    int param;\n    size_t i;\n    int rc;\n    int n;\n    int ret = -1;\n\n    *migParams = NULL;\n\n    if ((rc = virXPathBoolean(\"boolean(./migParams)\", ctxt)) < 0)\n        goto cleanup;\n\n    if (rc == 0) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    if ((n = virXPathNodeSet(\"./migParams[1]/param\", ctxt, &nodes)) < 0)\n        return -1;\n\n    if (!(params = qemuMigrationParamsNew()))\n        goto cleanup;\n\n    for (i = 0; i < n; i++) {\n        if (!(name = virXMLPropString(nodes[i], \"name\"))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"missing migration parameter name\"));\n            goto cleanup;\n        }\n\n        if ((param = qemuMigrationParamTypeFromString(name)) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unknown migration parameter '%s'\"), name);\n            goto cleanup;\n        }\n        pv = &params->params[param];\n\n        if (!(value = virXMLPropString(nodes[i], \"value\"))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"missing value for migration parameter '%s'\"),\n                           name);\n            goto cleanup;\n        }\n\n        rc = 0;\n        switch (qemuMigrationParamTypes[param]) {\n        case QEMU_MIGRATION_PARAM_TYPE_INT:\n            rc = virStrToLong_i(value, NULL, 10, &pv->value.i);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_ULL:\n            rc = virStrToLong_ullp(value, NULL, 10, &pv->value.ull);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_BOOL:\n            rc = virStringParseYesNo(value, &pv->value.b);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_STRING:\n            pv->value.s = g_steal_pointer(&value);\n            break;\n        }\n\n        if (rc < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"invalid value '%s' for migration parameter '%s'\"),\n                           value, name);\n            goto cleanup;\n        }\n\n        pv->set = true;\n        VIR_FREE(name);\n        VIR_FREE(value);\n    }\n\n    *migParams = g_steal_pointer(&params);\n    ret = 0;\n\n cleanup:\n    qemuMigrationParamsFree(params);\n    VIR_FREE(nodes);\n    VIR_FREE(name);\n    VIR_FREE(value);\n    return ret;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value"
          ],
          "line": 1398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "name"
          ],
          "line": 1397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "nodes"
          ],
          "line": 1396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsFree",
          "args": [
            "params"
          ],
          "line": 1395
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "264-279",
          "snippet": "void\nqemuMigrationParamsFree(qemuMigrationParamsPtr migParams)\n{\n    size_t i;\n\n    if (!migParams)\n        return;\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        if (qemuMigrationParamTypes[i] == QEMU_MIGRATION_PARAM_TYPE_STRING)\n            VIR_FREE(migParams->params[i].value.s);\n    }\n\n    virBitmapFree(migParams->caps);\n    VIR_FREE(migParams);\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nvoid\nqemuMigrationParamsFree(qemuMigrationParamsPtr migParams)\n{\n    size_t i;\n\n    if (!migParams)\n        return;\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        if (qemuMigrationParamTypes[i] == QEMU_MIGRATION_PARAM_TYPE_STRING)\n            VIR_FREE(migParams->params[i].value.s);\n    }\n\n    virBitmapFree(migParams->caps);\n    VIR_FREE(migParams);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&params"
          ],
          "line": 1391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value"
          ],
          "line": 1388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "name"
          ],
          "line": 1387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"invalid value '%s' for migration parameter '%s'\")",
            "value",
            "name"
          ],
          "line": 1380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"invalid value '%s' for migration parameter '%s'\""
          ],
          "line": 1381
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&value"
          ],
          "line": 1375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringParseYesNo",
          "args": [
            "value",
            "&pv->value.b"
          ],
          "line": 1371
        },
        "resolved": true,
        "details": {
          "function_name": "virStringParseYesNo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1396-1406",
          "snippet": "int virStringParseYesNo(const char *str, bool *result)\n{\n    if (STREQ(str, \"yes\"))\n        *result = true;\n    else if (STREQ(str, \"no\"))\n        *result = false;\n    else\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint virStringParseYesNo(const char *str, bool *result)\n{\n    if (STREQ(str, \"yes\"))\n        *result = true;\n    else if (STREQ(str, \"no\"))\n        *result = false;\n    else\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ullp",
          "args": [
            "value",
            "NULL",
            "10",
            "&pv->value.ull"
          ],
          "line": 1367
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "value",
            "NULL",
            "10",
            "&pv->value.i"
          ],
          "line": 1363
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"missing value for migration parameter '%s'\")",
            "name"
          ],
          "line": 1354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "nodes[i]",
            "\"value\""
          ],
          "line": 1353
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unknown migration parameter '%s'\")",
            "name"
          ],
          "line": 1347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamTypeFromString",
          "args": [
            "name"
          ],
          "line": 1346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"missing migration parameter name\")"
          ],
          "line": 1341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsNew",
          "args": [],
          "line": 1336
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "244-261",
          "snippet": "qemuMigrationParamsPtr\nqemuMigrationParamsNew(void)\n{\n    qemuMigrationParamsPtr params;\n\n    if (VIR_ALLOC(params) < 0)\n        return NULL;\n\n    params->caps = virBitmapNew(QEMU_MIGRATION_CAP_LAST);\n    if (!params->caps)\n        goto error;\n\n    return params;\n\n error:\n    qemuMigrationParamsFree(params);\n    return NULL;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nqemuMigrationParamsPtr\nqemuMigrationParamsNew(void)\n{\n    qemuMigrationParamsPtr params;\n\n    if (VIR_ALLOC(params) < 0)\n        return NULL;\n\n    params->caps = virBitmapNew(QEMU_MIGRATION_CAP_LAST);\n    if (!params->caps)\n        goto error;\n\n    return params;\n\n error:\n    qemuMigrationParamsFree(params);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathNodeSet",
          "args": [
            "\"./migParams[1]/param\"",
            "ctxt",
            "&nodes"
          ],
          "line": 1333
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNodeSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "647-694",
          "snippet": "int\nvirXPathNodeSet(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                xmlNodePtr **list)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNodeSet()\"));\n        return -1;\n    }\n\n    if (list != NULL)\n        *list = NULL;\n\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if (obj == NULL)\n        return 0;\n\n    if (obj->type != XPATH_NODESET) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Incorrect xpath '%s'\"), xpath);\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    if ((obj->nodesetval == NULL)  || (obj->nodesetval->nodeNr < 0)) {\n        xmlXPathFreeObject(obj);\n        return 0;\n    }\n\n    ret = obj->nodesetval->nodeNr;\n    if (list != NULL && ret) {\n        if (VIR_ALLOC_N(*list, ret) < 0) {\n            ret = -1;\n        } else {\n            memcpy(*list, obj->nodesetval->nodeTab,\n                   ret * sizeof(xmlNodePtr));\n        }\n    }\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathNodeSet(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                xmlNodePtr **list)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNodeSet()\"));\n        return -1;\n    }\n\n    if (list != NULL)\n        *list = NULL;\n\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if (obj == NULL)\n        return 0;\n\n    if (obj->type != XPATH_NODESET) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Incorrect xpath '%s'\"), xpath);\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    if ((obj->nodesetval == NULL)  || (obj->nodesetval->nodeNr < 0)) {\n        xmlXPathFreeObject(obj);\n        return 0;\n    }\n\n    ret = obj->nodesetval->nodeNr;\n    if (list != NULL && ret) {\n        if (VIR_ALLOC_N(*list, ret) < 0) {\n            ret = -1;\n        } else {\n            memcpy(*list, obj->nodesetval->nodeTab,\n                   ret * sizeof(xmlNodePtr));\n        }\n    }\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathBoolean",
          "args": [
            "\"boolean(./migParams)\"",
            "ctxt"
          ],
          "line": 1325
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "571-596",
          "snippet": "int\nvirXPathBoolean(const char *xpath,\n                xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathBoolean()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_BOOLEAN) ||\n        (obj->boolval < 0) || (obj->boolval > 1)) {\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n    ret = obj->boolval;\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathBoolean(const char *xpath,\n                xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathBoolean()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_BOOLEAN) ||\n        (obj->boolval < 0) || (obj->boolval > 1)) {\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n    ret = obj->boolval;\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nint\nqemuMigrationParamsParse(xmlXPathContextPtr ctxt,\n                         qemuMigrationParamsPtr *migParams)\n{\n    qemuMigrationParamsPtr params = NULL;\n    qemuMigrationParamValuePtr pv;\n    xmlNodePtr *nodes = NULL;\n    char *name = NULL;\n    char *value = NULL;\n    int param;\n    size_t i;\n    int rc;\n    int n;\n    int ret = -1;\n\n    *migParams = NULL;\n\n    if ((rc = virXPathBoolean(\"boolean(./migParams)\", ctxt)) < 0)\n        goto cleanup;\n\n    if (rc == 0) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    if ((n = virXPathNodeSet(\"./migParams[1]/param\", ctxt, &nodes)) < 0)\n        return -1;\n\n    if (!(params = qemuMigrationParamsNew()))\n        goto cleanup;\n\n    for (i = 0; i < n; i++) {\n        if (!(name = virXMLPropString(nodes[i], \"name\"))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"missing migration parameter name\"));\n            goto cleanup;\n        }\n\n        if ((param = qemuMigrationParamTypeFromString(name)) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unknown migration parameter '%s'\"), name);\n            goto cleanup;\n        }\n        pv = &params->params[param];\n\n        if (!(value = virXMLPropString(nodes[i], \"value\"))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"missing value for migration parameter '%s'\"),\n                           name);\n            goto cleanup;\n        }\n\n        rc = 0;\n        switch (qemuMigrationParamTypes[param]) {\n        case QEMU_MIGRATION_PARAM_TYPE_INT:\n            rc = virStrToLong_i(value, NULL, 10, &pv->value.i);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_ULL:\n            rc = virStrToLong_ullp(value, NULL, 10, &pv->value.ull);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_BOOL:\n            rc = virStringParseYesNo(value, &pv->value.b);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_STRING:\n            pv->value.s = g_steal_pointer(&value);\n            break;\n        }\n\n        if (rc < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"invalid value '%s' for migration parameter '%s'\"),\n                           value, name);\n            goto cleanup;\n        }\n\n        pv->set = true;\n        VIR_FREE(name);\n        VIR_FREE(value);\n    }\n\n    *migParams = g_steal_pointer(&params);\n    ret = 0;\n\n cleanup:\n    qemuMigrationParamsFree(params);\n    VIR_FREE(nodes);\n    VIR_FREE(name);\n    VIR_FREE(value);\n    return ret;\n}"
  },
  {
    "function_name": "qemuMigrationParamsFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "1263-1305",
    "snippet": "void\nqemuMigrationParamsFormat(virBufferPtr buf,\n                          qemuMigrationParamsPtr migParams)\n{\n    qemuMigrationParamValuePtr pv;\n    size_t i;\n\n    virBufferAddLit(buf, \"<migParams>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        pv = &migParams->params[i];\n\n        if (!pv->set)\n            continue;\n\n        virBufferAsprintf(buf, \"<param name='%s' \",\n                          qemuMigrationParamTypeToString(i));\n\n        switch (qemuMigrationParamTypes[i]) {\n        case QEMU_MIGRATION_PARAM_TYPE_INT:\n            virBufferAsprintf(buf, \"value='%d'\", pv->value.i);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_ULL:\n            virBufferAsprintf(buf, \"value='%llu'\", pv->value.ull);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_BOOL:\n            virBufferAsprintf(buf, \"value='%s'\", pv->value.b ? \"yes\" : \"no\");\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_STRING:\n            virBufferEscapeString(buf, \"value='%s'\", pv->value.s);\n            break;\n        }\n\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</migParams>\\n\");\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</migParams>\\n\""
          ],
          "line": 1304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 1303
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"/>\\n\""
          ],
          "line": 1300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\"value='%s'\"",
            "pv->value.s"
          ],
          "line": 1296
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"value='%s'\"",
            "pv->value.b ? \"yes\" : \"no\""
          ],
          "line": 1292
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamTypeToString",
          "args": [
            "i"
          ],
          "line": 1280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<migParams>\\n\""
          ],
          "line": 1270
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nvoid\nqemuMigrationParamsFormat(virBufferPtr buf,\n                          qemuMigrationParamsPtr migParams)\n{\n    qemuMigrationParamValuePtr pv;\n    size_t i;\n\n    virBufferAddLit(buf, \"<migParams>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        pv = &migParams->params[i];\n\n        if (!pv->set)\n            continue;\n\n        virBufferAsprintf(buf, \"<param name='%s' \",\n                          qemuMigrationParamTypeToString(i));\n\n        switch (qemuMigrationParamTypes[i]) {\n        case QEMU_MIGRATION_PARAM_TYPE_INT:\n            virBufferAsprintf(buf, \"value='%d'\", pv->value.i);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_ULL:\n            virBufferAsprintf(buf, \"value='%llu'\", pv->value.ull);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_BOOL:\n            virBufferAsprintf(buf, \"value='%s'\", pv->value.b ? \"yes\" : \"no\");\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_STRING:\n            virBufferEscapeString(buf, \"value='%s'\", pv->value.s);\n            break;\n        }\n\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</migParams>\\n\");\n}"
  },
  {
    "function_name": "qemuMigrationParamsReset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "1236-1260",
    "snippet": "void\nqemuMigrationParamsReset(virQEMUDriverPtr driver,\n                         virDomainObjPtr vm,\n                         int asyncJob,\n                         qemuMigrationParamsPtr origParams,\n                         unsigned long apiFlags)\n{\n    virErrorPtr err;\n\n    virErrorPreserveLast(&err);\n\n    VIR_DEBUG(\"Resetting migration parameters %p, flags 0x%lx\",\n              origParams, apiFlags);\n\n    if (!virDomainObjIsActive(vm) || !origParams)\n        goto cleanup;\n\n    if (qemuMigrationParamsApply(driver, vm, asyncJob, origParams) < 0)\n        goto cleanup;\n\n    qemuMigrationParamsResetTLS(driver, vm, asyncJob, origParams, apiFlags);\n\n cleanup:\n    virErrorRestore(&err);\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virErrorRestore",
          "args": [
            "&err"
          ],
          "line": 1259
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorRestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "445-457",
          "snippet": "void\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsResetTLS",
          "args": [
            "driver",
            "vm",
            "asyncJob",
            "origParams",
            "apiFlags"
          ],
          "line": 1256
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsResetTLS",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "1066-1087",
          "snippet": "static void\nqemuMigrationParamsResetTLS(virQEMUDriverPtr driver,\n                            virDomainObjPtr vm,\n                            int asyncJob,\n                            qemuMigrationParamsPtr origParams,\n                            unsigned long apiFlags)\n{\n    g_autofree char *tlsAlias = NULL;\n    g_autofree char *secAlias = NULL;\n\n    /* There's nothing to do if QEMU does not support TLS migration or we were\n     * not asked to enable it. */\n    if (!origParams->params[QEMU_MIGRATION_PARAM_TLS_CREDS].set ||\n        !(apiFlags & VIR_MIGRATE_TLS))\n        return;\n\n    tlsAlias = qemuAliasTLSObjFromSrcAlias(QEMU_MIGRATION_TLS_ALIAS_BASE);\n    secAlias = qemuAliasForSecret(QEMU_MIGRATION_TLS_ALIAS_BASE, NULL);\n\n    qemuDomainDelTLSObjects(driver, vm, asyncJob, secAlias, tlsAlias);\n    g_clear_pointer(&QEMU_DOMAIN_PRIVATE(vm)->migSecinfo, qemuDomainSecretInfoFree);\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define QEMU_MIGRATION_TLS_ALIAS_BASE \"libvirt_migrate\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\n#define QEMU_MIGRATION_TLS_ALIAS_BASE \"libvirt_migrate\"\n\nstatic void\nqemuMigrationParamsResetTLS(virQEMUDriverPtr driver,\n                            virDomainObjPtr vm,\n                            int asyncJob,\n                            qemuMigrationParamsPtr origParams,\n                            unsigned long apiFlags)\n{\n    g_autofree char *tlsAlias = NULL;\n    g_autofree char *secAlias = NULL;\n\n    /* There's nothing to do if QEMU does not support TLS migration or we were\n     * not asked to enable it. */\n    if (!origParams->params[QEMU_MIGRATION_PARAM_TLS_CREDS].set ||\n        !(apiFlags & VIR_MIGRATE_TLS))\n        return;\n\n    tlsAlias = qemuAliasTLSObjFromSrcAlias(QEMU_MIGRATION_TLS_ALIAS_BASE);\n    secAlias = qemuAliasForSecret(QEMU_MIGRATION_TLS_ALIAS_BASE, NULL);\n\n    qemuDomainDelTLSObjects(driver, vm, asyncJob, secAlias, tlsAlias);\n    g_clear_pointer(&QEMU_DOMAIN_PRIVATE(vm)->migSecinfo, qemuDomainSecretInfoFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsApply",
          "args": [
            "driver",
            "vm",
            "asyncJob",
            "origParams"
          ],
          "line": 1253
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsApply",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "832-905",
          "snippet": "int\nqemuMigrationParamsApply(virQEMUDriverPtr driver,\n                         virDomainObjPtr vm,\n                         int asyncJob,\n                         qemuMigrationParamsPtr migParams)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    bool xbzrleCacheSize_old = false;\n    virJSONValuePtr params = NULL;\n    virJSONValuePtr caps = NULL;\n    qemuMigrationParam xbzrle = QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE;\n    int ret = -1;\n    int rc;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    if (asyncJob == QEMU_ASYNC_JOB_NONE) {\n        if (!virBitmapIsAllClear(migParams->caps)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Migration capabilities can only be set by \"\n                             \"a migration job\"));\n            goto cleanup;\n        }\n    } else {\n        if (!(caps = qemuMigrationCapsToJSON(priv->migrationCaps, migParams->caps)))\n            goto cleanup;\n\n        if (virJSONValueArraySize(caps) > 0) {\n            rc = qemuMonitorSetMigrationCapabilities(priv->mon, caps);\n            caps = NULL;\n            if (rc < 0)\n                goto cleanup;\n        }\n    }\n\n    /* If QEMU is too old to support xbzrle-cache-size migration parameter,\n     * we need to set it via migrate-set-cache-size and tell\n     * qemuMonitorSetMigrationParams to ignore this parameter.\n     */\n    if (migParams->params[xbzrle].set &&\n        (!priv->job.migParams ||\n         !priv->job.migParams->params[xbzrle].set)) {\n        if (qemuMonitorSetMigrationCacheSize(priv->mon,\n                                             migParams->params[xbzrle].value.ull) < 0)\n            goto cleanup;\n        xbzrleCacheSize_old = true;\n        migParams->params[xbzrle].set = false;\n    }\n\n    if (!(params = qemuMigrationParamsToJSON(migParams)))\n        goto cleanup;\n\n    if (virJSONValueObjectKeysNumber(params) > 0) {\n        rc = qemuMonitorSetMigrationParams(priv->mon, params);\n        params = NULL;\n        if (rc < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    if (qemuDomainObjExitMonitor(driver, vm) < 0)\n        ret = -1;\n\n    if (xbzrleCacheSize_old)\n        migParams->params[xbzrle].set = true;\n\n    virJSONValueFree(params);\n    virJSONValueFree(caps);\n\n    return ret;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nqemuMigrationParamsApply(virQEMUDriverPtr driver,\n                         virDomainObjPtr vm,\n                         int asyncJob,\n                         qemuMigrationParamsPtr migParams)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    bool xbzrleCacheSize_old = false;\n    virJSONValuePtr params = NULL;\n    virJSONValuePtr caps = NULL;\n    qemuMigrationParam xbzrle = QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE;\n    int ret = -1;\n    int rc;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    if (asyncJob == QEMU_ASYNC_JOB_NONE) {\n        if (!virBitmapIsAllClear(migParams->caps)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Migration capabilities can only be set by \"\n                             \"a migration job\"));\n            goto cleanup;\n        }\n    } else {\n        if (!(caps = qemuMigrationCapsToJSON(priv->migrationCaps, migParams->caps)))\n            goto cleanup;\n\n        if (virJSONValueArraySize(caps) > 0) {\n            rc = qemuMonitorSetMigrationCapabilities(priv->mon, caps);\n            caps = NULL;\n            if (rc < 0)\n                goto cleanup;\n        }\n    }\n\n    /* If QEMU is too old to support xbzrle-cache-size migration parameter,\n     * we need to set it via migrate-set-cache-size and tell\n     * qemuMonitorSetMigrationParams to ignore this parameter.\n     */\n    if (migParams->params[xbzrle].set &&\n        (!priv->job.migParams ||\n         !priv->job.migParams->params[xbzrle].set)) {\n        if (qemuMonitorSetMigrationCacheSize(priv->mon,\n                                             migParams->params[xbzrle].value.ull) < 0)\n            goto cleanup;\n        xbzrleCacheSize_old = true;\n        migParams->params[xbzrle].set = false;\n    }\n\n    if (!(params = qemuMigrationParamsToJSON(migParams)))\n        goto cleanup;\n\n    if (virJSONValueObjectKeysNumber(params) > 0) {\n        rc = qemuMonitorSetMigrationParams(priv->mon, params);\n        params = NULL;\n        if (rc < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    if (qemuDomainObjExitMonitor(driver, vm) < 0)\n        ret = -1;\n\n    if (xbzrleCacheSize_old)\n        migParams->params[xbzrle].set = true;\n\n    virJSONValueFree(params);\n    virJSONValueFree(caps);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "vm"
          ],
          "line": 1250
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Resetting migration parameters %p, flags 0x%lx\"",
            "origParams",
            "apiFlags"
          ],
          "line": 1247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virErrorPreserveLast",
          "args": [
            "&err"
          ],
          "line": 1245
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorPreserveLast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "424-436",
          "snippet": "void\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nvoid\nqemuMigrationParamsReset(virQEMUDriverPtr driver,\n                         virDomainObjPtr vm,\n                         int asyncJob,\n                         qemuMigrationParamsPtr origParams,\n                         unsigned long apiFlags)\n{\n    virErrorPtr err;\n\n    virErrorPreserveLast(&err);\n\n    VIR_DEBUG(\"Resetting migration parameters %p, flags 0x%lx\",\n              origParams, apiFlags);\n\n    if (!virDomainObjIsActive(vm) || !origParams)\n        goto cleanup;\n\n    if (qemuMigrationParamsApply(driver, vm, asyncJob, origParams) < 0)\n        goto cleanup;\n\n    qemuMigrationParamsResetTLS(driver, vm, asyncJob, origParams, apiFlags);\n\n cleanup:\n    virErrorRestore(&err);\n}"
  },
  {
    "function_name": "qemuMigrationParamsCheck",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "1165-1227",
    "snippet": "int\nqemuMigrationParamsCheck(virQEMUDriverPtr driver,\n                         virDomainObjPtr vm,\n                         int asyncJob,\n                         qemuMigrationParamsPtr migParams,\n                         virBitmapPtr remoteCaps)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    qemuMigrationCapability cap;\n    qemuMigrationParty party;\n    size_t i;\n\n    if (asyncJob == QEMU_ASYNC_JOB_MIGRATION_OUT)\n        party = QEMU_MIGRATION_SOURCE;\n    else\n        party = QEMU_MIGRATION_DESTINATION;\n\n    for (cap = 0; cap < QEMU_MIGRATION_CAP_LAST; cap++) {\n        bool state = false;\n\n        ignore_value(virBitmapGetBit(migParams->caps, cap, &state));\n\n        if (state && !qemuMigrationCapsGet(vm, cap)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                           _(\"Migration option '%s' is not supported by QEMU binary\"),\n                           qemuMigrationCapabilityTypeToString(cap));\n            return -1;\n        }\n    }\n\n    for (i = 0; i < G_N_ELEMENTS(qemuMigrationParamsAlwaysOn); i++) {\n        cap = qemuMigrationParamsAlwaysOn[i].cap;\n\n        if (qemuMigrationParamsAlwaysOn[i].party & party &&\n            qemuMigrationCapsGet(vm, cap)) {\n            if (qemuMigrationParamsAlwaysOn[i].party != party) {\n                bool remote = false;\n\n                if (remoteCaps)\n                    ignore_value(virBitmapGetBit(remoteCaps, cap, &remote));\n\n                if (!remote) {\n                    VIR_DEBUG(\"Not enabling migration capability '%s'; it is \"\n                              \"not supported or automatically enabled by the \"\n                              \"other side of migration\",\n                              qemuMigrationCapabilityTypeToString(cap));\n                    continue;\n                }\n            }\n\n            VIR_DEBUG(\"Enabling migration capability '%s'\",\n                      qemuMigrationCapabilityTypeToString(cap));\n            ignore_value(virBitmapSetBit(migParams->caps, cap));\n        }\n    }\n\n    /*\n     * We want to disable all migration capabilities after migration, no need\n     * to ask QEMU for their current settings.\n     */\n\n    return qemuMigrationParamsFetch(driver, vm, asyncJob, &priv->job.migParams);\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const qemuMigrationParamsAlwaysOnItem qemuMigrationParamsAlwaysOn[] = {\n    {QEMU_MIGRATION_CAP_PAUSE_BEFORE_SWITCHOVER,\n     QEMU_MIGRATION_SOURCE},\n\n    {QEMU_MIGRATION_CAP_LATE_BLOCK_ACTIVATE,\n     QEMU_MIGRATION_DESTINATION},\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuMigrationParamsFetch",
          "args": [
            "driver",
            "vm",
            "asyncJob",
            "&priv->job.migParams"
          ],
          "line": 1226
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsFetch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "1090-1119",
          "snippet": "int\nqemuMigrationParamsFetch(virQEMUDriverPtr driver,\n                         virDomainObjPtr vm,\n                         int asyncJob,\n                         qemuMigrationParamsPtr *migParams)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virJSONValuePtr jsonParams = NULL;\n    int ret = -1;\n    int rc;\n\n    *migParams = NULL;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    rc = qemuMonitorGetMigrationParams(priv->mon, &jsonParams);\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    if (!(*migParams = qemuMigrationParamsFromJSON(jsonParams)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virJSONValueFree(jsonParams);\n    return ret;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nqemuMigrationParamsFetch(virQEMUDriverPtr driver,\n                         virDomainObjPtr vm,\n                         int asyncJob,\n                         qemuMigrationParamsPtr *migParams)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virJSONValuePtr jsonParams = NULL;\n    int ret = -1;\n    int rc;\n\n    *migParams = NULL;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    rc = qemuMonitorGetMigrationParams(priv->mon, &jsonParams);\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    if (!(*migParams = qemuMigrationParamsFromJSON(jsonParams)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virJSONValueFree(jsonParams);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapSetBit(migParams->caps, cap)"
          ],
          "line": 1217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "migParams->caps",
            "cap"
          ],
          "line": 1217
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Enabling migration capability '%s'\"",
            "qemuMigrationCapabilityTypeToString(cap)"
          ],
          "line": 1215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMigrationCapabilityTypeToString",
          "args": [
            "cap"
          ],
          "line": 1216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Not enabling migration capability '%s'; it is \"\n                              \"not supported or automatically enabled by the \"\n                              \"other side of migration\"",
            "qemuMigrationCapabilityTypeToString(cap)"
          ],
          "line": 1207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMigrationCapabilityTypeToString",
          "args": [
            "cap"
          ],
          "line": 1210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapGetBit(remoteCaps, cap, &remote)"
          ],
          "line": 1204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapGetBit",
          "args": [
            "remoteCaps",
            "cap",
            "&remote"
          ],
          "line": 1204
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapGetBit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "320-330",
          "snippet": "int\nvirBitmapGetBit(virBitmapPtr bitmap,\n                size_t b,\n                bool *result)\n{\n    if (bitmap->nbits <= b)\n        return -1;\n\n    *result = virBitmapIsSet(bitmap, b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapGetBit(virBitmapPtr bitmap,\n                size_t b,\n                bool *result)\n{\n    if (bitmap->nbits <= b)\n        return -1;\n\n    *result = virBitmapIsSet(bitmap, b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationCapsGet",
          "args": [
            "vm",
            "cap"
          ],
          "line": 1199
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationCapsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "1487-1498",
          "snippet": "bool\nqemuMigrationCapsGet(virDomainObjPtr vm,\n                     qemuMigrationCapability cap)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    bool enabled = false;\n\n    if (priv->migrationCaps)\n        ignore_value(virBitmapGetBit(priv->migrationCaps, cap, &enabled));\n\n    return enabled;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nbool\nqemuMigrationCapsGet(virDomainObjPtr vm,\n                     qemuMigrationCapability cap)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    bool enabled = false;\n\n    if (priv->migrationCaps)\n        ignore_value(virBitmapGetBit(priv->migrationCaps, cap, &enabled));\n\n    return enabled;\n}"
        }
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "qemuMigrationParamsAlwaysOn"
          ],
          "line": 1195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "_(\"Migration option '%s' is not supported by QEMU binary\")",
            "qemuMigrationCapabilityTypeToString(cap)"
          ],
          "line": 1188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMigrationCapabilityTypeToString",
          "args": [
            "cap"
          ],
          "line": 1190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Migration option '%s' is not supported by QEMU binary\""
          ],
          "line": 1189
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapGetBit(migParams->caps, cap, &state)"
          ],
          "line": 1185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamsAlwaysOnItem qemuMigrationParamsAlwaysOn[] = {\n    {QEMU_MIGRATION_CAP_PAUSE_BEFORE_SWITCHOVER,\n     QEMU_MIGRATION_SOURCE},\n\n    {QEMU_MIGRATION_CAP_LATE_BLOCK_ACTIVATE,\n     QEMU_MIGRATION_DESTINATION},\n};\n\nint\nqemuMigrationParamsCheck(virQEMUDriverPtr driver,\n                         virDomainObjPtr vm,\n                         int asyncJob,\n                         qemuMigrationParamsPtr migParams,\n                         virBitmapPtr remoteCaps)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    qemuMigrationCapability cap;\n    qemuMigrationParty party;\n    size_t i;\n\n    if (asyncJob == QEMU_ASYNC_JOB_MIGRATION_OUT)\n        party = QEMU_MIGRATION_SOURCE;\n    else\n        party = QEMU_MIGRATION_DESTINATION;\n\n    for (cap = 0; cap < QEMU_MIGRATION_CAP_LAST; cap++) {\n        bool state = false;\n\n        ignore_value(virBitmapGetBit(migParams->caps, cap, &state));\n\n        if (state && !qemuMigrationCapsGet(vm, cap)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                           _(\"Migration option '%s' is not supported by QEMU binary\"),\n                           qemuMigrationCapabilityTypeToString(cap));\n            return -1;\n        }\n    }\n\n    for (i = 0; i < G_N_ELEMENTS(qemuMigrationParamsAlwaysOn); i++) {\n        cap = qemuMigrationParamsAlwaysOn[i].cap;\n\n        if (qemuMigrationParamsAlwaysOn[i].party & party &&\n            qemuMigrationCapsGet(vm, cap)) {\n            if (qemuMigrationParamsAlwaysOn[i].party != party) {\n                bool remote = false;\n\n                if (remoteCaps)\n                    ignore_value(virBitmapGetBit(remoteCaps, cap, &remote));\n\n                if (!remote) {\n                    VIR_DEBUG(\"Not enabling migration capability '%s'; it is \"\n                              \"not supported or automatically enabled by the \"\n                              \"other side of migration\",\n                              qemuMigrationCapabilityTypeToString(cap));\n                    continue;\n                }\n            }\n\n            VIR_DEBUG(\"Enabling migration capability '%s'\",\n                      qemuMigrationCapabilityTypeToString(cap));\n            ignore_value(virBitmapSetBit(migParams->caps, cap));\n        }\n    }\n\n    /*\n     * We want to disable all migration capabilities after migration, no need\n     * to ask QEMU for their current settings.\n     */\n\n    return qemuMigrationParamsFetch(driver, vm, asyncJob, &priv->job.migParams);\n}"
  },
  {
    "function_name": "qemuMigrationParamsGetULL",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "1141-1154",
    "snippet": "int\nqemuMigrationParamsGetULL(qemuMigrationParamsPtr migParams,\n                          qemuMigrationParam param,\n                          unsigned long long *value)\n{\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_ULL) < 0)\n        return -1;\n\n    if (!migParams->params[param].set)\n        return 1;\n\n    *value = migParams->params[param].value.ull;\n    return 0;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuMigrationParamsCheckType",
          "args": [
            "param",
            "QEMU_MIGRATION_PARAM_TYPE_ULL"
          ],
          "line": 1146
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsCheckType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "282-294",
          "snippet": "static int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nstatic int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nqemuMigrationParamsGetULL(qemuMigrationParamsPtr migParams,\n                          qemuMigrationParam param,\n                          unsigned long long *value)\n{\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_ULL) < 0)\n        return -1;\n\n    if (!migParams->params[param].set)\n        return 1;\n\n    *value = migParams->params[param].value.ull;\n    return 0;\n}"
  },
  {
    "function_name": "qemuMigrationParamsSetULL",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "1122-1133",
    "snippet": "int\nqemuMigrationParamsSetULL(qemuMigrationParamsPtr migParams,\n                          qemuMigrationParam param,\n                          unsigned long long value)\n{\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_ULL) < 0)\n        return -1;\n\n    migParams->params[param].value.ull = value;\n    migParams->params[param].set = true;\n    return 0;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuMigrationParamsCheckType",
          "args": [
            "param",
            "QEMU_MIGRATION_PARAM_TYPE_ULL"
          ],
          "line": 1127
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsCheckType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "282-294",
          "snippet": "static int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nstatic int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nqemuMigrationParamsSetULL(qemuMigrationParamsPtr migParams,\n                          qemuMigrationParam param,\n                          unsigned long long value)\n{\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_ULL) < 0)\n        return -1;\n\n    migParams->params[param].value.ull = value;\n    migParams->params[param].set = true;\n    return 0;\n}"
  },
  {
    "function_name": "qemuMigrationParamsFetch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "1090-1119",
    "snippet": "int\nqemuMigrationParamsFetch(virQEMUDriverPtr driver,\n                         virDomainObjPtr vm,\n                         int asyncJob,\n                         qemuMigrationParamsPtr *migParams)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virJSONValuePtr jsonParams = NULL;\n    int ret = -1;\n    int rc;\n\n    *migParams = NULL;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    rc = qemuMonitorGetMigrationParams(priv->mon, &jsonParams);\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    if (!(*migParams = qemuMigrationParamsFromJSON(jsonParams)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virJSONValueFree(jsonParams);\n    return ret;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "jsonParams"
          ],
          "line": 1117
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsFromJSON",
          "args": [
            "jsonParams"
          ],
          "line": 1111
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsFromJSON",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "681-726",
          "snippet": "qemuMigrationParamsPtr\nqemuMigrationParamsFromJSON(virJSONValuePtr params)\n{\n    qemuMigrationParamsPtr migParams;\n    qemuMigrationParamValuePtr pv;\n    const char *name;\n    const char *str;\n    size_t i;\n\n    if (!(migParams = qemuMigrationParamsNew()))\n        return NULL;\n\n    if (!params)\n        return migParams;\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        name = qemuMigrationParamTypeToString(i);\n        pv = &migParams->params[i];\n\n        switch (qemuMigrationParamTypes[i]) {\n        case QEMU_MIGRATION_PARAM_TYPE_INT:\n            if (virJSONValueObjectGetNumberInt(params, name, &pv->value.i) == 0)\n                pv->set = true;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_ULL:\n            if (virJSONValueObjectGetNumberUlong(params, name, &pv->value.ull) == 0)\n                pv->set = true;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_BOOL:\n            if (virJSONValueObjectGetBoolean(params, name, &pv->value.b) == 0)\n                pv->set = true;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_STRING:\n            if ((str = virJSONValueObjectGetString(params, name))) {\n                pv->value.s = g_strdup(str);\n                pv->set = true;\n            }\n            break;\n        }\n    }\n\n    return migParams;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nqemuMigrationParamsPtr\nqemuMigrationParamsFromJSON(virJSONValuePtr params)\n{\n    qemuMigrationParamsPtr migParams;\n    qemuMigrationParamValuePtr pv;\n    const char *name;\n    const char *str;\n    size_t i;\n\n    if (!(migParams = qemuMigrationParamsNew()))\n        return NULL;\n\n    if (!params)\n        return migParams;\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        name = qemuMigrationParamTypeToString(i);\n        pv = &migParams->params[i];\n\n        switch (qemuMigrationParamTypes[i]) {\n        case QEMU_MIGRATION_PARAM_TYPE_INT:\n            if (virJSONValueObjectGetNumberInt(params, name, &pv->value.i) == 0)\n                pv->set = true;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_ULL:\n            if (virJSONValueObjectGetNumberUlong(params, name, &pv->value.ull) == 0)\n                pv->set = true;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_BOOL:\n            if (virJSONValueObjectGetBoolean(params, name, &pv->value.b) == 0)\n                pv->set = true;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_STRING:\n            if ((str = virJSONValueObjectGetString(params, name))) {\n                pv->value.s = g_strdup(str);\n                pv->set = true;\n            }\n            break;\n        }\n    }\n\n    return migParams;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainObjExitMonitor",
          "args": [
            "driver",
            "vm"
          ],
          "line": 1108
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjExitMonitor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10189-10200",
          "snippet": "int qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\n\nint qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMonitorGetMigrationParams",
          "args": [
            "priv->mon",
            "&jsonParams"
          ],
          "line": 1106
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorGetMigrationParams",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "2430-2437",
          "snippet": "int\nqemuMonitorGetMigrationParams(qemuMonitorPtr mon,\n                              virJSONValuePtr *params)\n{\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONGetMigrationParams(mon, params);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorGetMigrationParams(qemuMonitorPtr mon,\n                              virJSONValuePtr *params)\n{\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONGetMigrationParams(mon, params);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainObjEnterMonitorAsync",
          "args": [
            "driver",
            "vm",
            "asyncJob"
          ],
          "line": 1103
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjEnterMonitorAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10216-10222",
          "snippet": "int\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);",
            "qemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\nqemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));\n\nint\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nqemuMigrationParamsFetch(virQEMUDriverPtr driver,\n                         virDomainObjPtr vm,\n                         int asyncJob,\n                         qemuMigrationParamsPtr *migParams)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virJSONValuePtr jsonParams = NULL;\n    int ret = -1;\n    int rc;\n\n    *migParams = NULL;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    rc = qemuMonitorGetMigrationParams(priv->mon, &jsonParams);\n\n    if (qemuDomainObjExitMonitor(driver, vm) < 0 || rc < 0)\n        goto cleanup;\n\n    if (!(*migParams = qemuMigrationParamsFromJSON(jsonParams)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virJSONValueFree(jsonParams);\n    return ret;\n}"
  },
  {
    "function_name": "qemuMigrationParamsResetTLS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "1066-1087",
    "snippet": "static void\nqemuMigrationParamsResetTLS(virQEMUDriverPtr driver,\n                            virDomainObjPtr vm,\n                            int asyncJob,\n                            qemuMigrationParamsPtr origParams,\n                            unsigned long apiFlags)\n{\n    g_autofree char *tlsAlias = NULL;\n    g_autofree char *secAlias = NULL;\n\n    /* There's nothing to do if QEMU does not support TLS migration or we were\n     * not asked to enable it. */\n    if (!origParams->params[QEMU_MIGRATION_PARAM_TLS_CREDS].set ||\n        !(apiFlags & VIR_MIGRATE_TLS))\n        return;\n\n    tlsAlias = qemuAliasTLSObjFromSrcAlias(QEMU_MIGRATION_TLS_ALIAS_BASE);\n    secAlias = qemuAliasForSecret(QEMU_MIGRATION_TLS_ALIAS_BASE, NULL);\n\n    qemuDomainDelTLSObjects(driver, vm, asyncJob, secAlias, tlsAlias);\n    g_clear_pointer(&QEMU_DOMAIN_PRIVATE(vm)->migSecinfo, qemuDomainSecretInfoFree);\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define QEMU_MIGRATION_TLS_ALIAS_BASE \"libvirt_migrate\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_clear_pointer",
          "args": [
            "&QEMU_DOMAIN_PRIVATE(vm)->migSecinfo",
            "qemuDomainSecretInfoFree"
          ],
          "line": 1086
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QEMU_DOMAIN_PRIVATE",
          "args": [
            "vm"
          ],
          "line": 1086
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuDomainDelTLSObjects",
          "args": [
            "driver",
            "vm",
            "asyncJob",
            "secAlias",
            "tlsAlias"
          ],
          "line": 1085
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainDelTLSObjects",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_hotplug.c",
          "lines": "1670-1698",
          "snippet": "void\nqemuDomainDelTLSObjects(virQEMUDriverPtr driver,\n                        virDomainObjPtr vm,\n                        qemuDomainAsyncJob asyncJob,\n                        const char *secAlias,\n                        const char *tlsAlias)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virErrorPtr orig_err;\n\n    if (!tlsAlias && !secAlias)\n        return;\n\n    virErrorPreserveLast(&orig_err);\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    if (tlsAlias)\n        ignore_value(qemuMonitorDelObject(priv->mon, tlsAlias, false));\n\n    if (secAlias)\n        ignore_value(qemuMonitorDelObject(priv->mon, secAlias, false));\n\n    ignore_value(qemuDomainObjExitMonitor(driver, vm));\n\n cleanup:\n    virErrorRestore(&orig_err);\n}",
          "includes": [
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"device_conf.h\"",
            "#include \"virnetdevmidonet.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virpci.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"domain_audit.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_interface.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_domain_address.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nqemuDomainResetDeviceRemoval(virDomainObjPtr vm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"device_conf.h\"\n#include \"virnetdevmidonet.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"locking/domain_lock.h\"\n#include \"qemu_cgroup.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virpci.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"domain_nwfilter.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"domain_audit.h\"\n#include \"qemu_block.h\"\n#include \"qemu_security.h\"\n#include \"qemu_process.h\"\n#include \"qemu_interface.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_command.h\"\n#include \"qemu_domain_address.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_hotplug.h\"\n#include <config.h>\n\nstatic void\nqemuDomainResetDeviceRemoval(virDomainObjPtr vm);\n\nvoid\nqemuDomainDelTLSObjects(virQEMUDriverPtr driver,\n                        virDomainObjPtr vm,\n                        qemuDomainAsyncJob asyncJob,\n                        const char *secAlias,\n                        const char *tlsAlias)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virErrorPtr orig_err;\n\n    if (!tlsAlias && !secAlias)\n        return;\n\n    virErrorPreserveLast(&orig_err);\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    if (tlsAlias)\n        ignore_value(qemuMonitorDelObject(priv->mon, tlsAlias, false));\n\n    if (secAlias)\n        ignore_value(qemuMonitorDelObject(priv->mon, secAlias, false));\n\n    ignore_value(qemuDomainObjExitMonitor(driver, vm));\n\n cleanup:\n    virErrorRestore(&orig_err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAliasForSecret",
          "args": [
            "QEMU_MIGRATION_TLS_ALIAS_BASE",
            "NULL"
          ],
          "line": 1083
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAliasForSecret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "774-782",
          "snippet": "char *\nqemuAliasForSecret(const char *parentalias,\n                   const char *obj)\n{\n    if (obj)\n        return g_strdup_printf(\"%s-%s-secret0\", parentalias, obj);\n    else\n        return g_strdup_printf(\"%s-secret0\", parentalias);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nchar *\nqemuAliasForSecret(const char *parentalias,\n                   const char *obj)\n{\n    if (obj)\n        return g_strdup_printf(\"%s-%s-secret0\", parentalias, obj);\n    else\n        return g_strdup_printf(\"%s-secret0\", parentalias);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAliasTLSObjFromSrcAlias",
          "args": [
            "QEMU_MIGRATION_TLS_ALIAS_BASE"
          ],
          "line": 1082
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAliasTLSObjFromSrcAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "789-797",
          "snippet": "char *\nqemuAliasTLSObjFromSrcAlias(const char *srcAlias)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"obj%s_tls0\", srcAlias);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nchar *\nqemuAliasTLSObjFromSrcAlias(const char *srcAlias)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"obj%s_tls0\", srcAlias);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\n#define QEMU_MIGRATION_TLS_ALIAS_BASE \"libvirt_migrate\"\n\nstatic void\nqemuMigrationParamsResetTLS(virQEMUDriverPtr driver,\n                            virDomainObjPtr vm,\n                            int asyncJob,\n                            qemuMigrationParamsPtr origParams,\n                            unsigned long apiFlags)\n{\n    g_autofree char *tlsAlias = NULL;\n    g_autofree char *secAlias = NULL;\n\n    /* There's nothing to do if QEMU does not support TLS migration or we were\n     * not asked to enable it. */\n    if (!origParams->params[QEMU_MIGRATION_PARAM_TLS_CREDS].set ||\n        !(apiFlags & VIR_MIGRATE_TLS))\n        return;\n\n    tlsAlias = qemuAliasTLSObjFromSrcAlias(QEMU_MIGRATION_TLS_ALIAS_BASE);\n    secAlias = qemuAliasForSecret(QEMU_MIGRATION_TLS_ALIAS_BASE, NULL);\n\n    qemuDomainDelTLSObjects(driver, vm, asyncJob, secAlias, tlsAlias);\n    g_clear_pointer(&QEMU_DOMAIN_PRIVATE(vm)->migSecinfo, qemuDomainSecretInfoFree);\n}"
  },
  {
    "function_name": "qemuMigrationParamsDisableTLS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "1038-1054",
    "snippet": "int\nqemuMigrationParamsDisableTLS(virDomainObjPtr vm,\n                              qemuMigrationParamsPtr migParams)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!priv->job.migParams->params[QEMU_MIGRATION_PARAM_TLS_CREDS].set)\n        return 0;\n\n    if (qemuMigrationParamsSetString(migParams,\n                                     QEMU_MIGRATION_PARAM_TLS_CREDS, \"\") < 0 ||\n        qemuMigrationParamsSetString(migParams,\n                                     QEMU_MIGRATION_PARAM_TLS_HOSTNAME, \"\") < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuMigrationParamsSetString",
          "args": [
            "migParams",
            "QEMU_MIGRATION_PARAM_TLS_HOSTNAME",
            "\"\""
          ],
          "line": 1049
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsSetString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "917-930",
          "snippet": "static int\nqemuMigrationParamsSetString(qemuMigrationParamsPtr migParams,\n                             qemuMigrationParam param,\n                             const char *value)\n{\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_STRING) < 0)\n        return -1;\n\n    migParams->params[param].value.s = g_strdup(value);\n\n    migParams->params[param].set = true;\n\n    return 0;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int\nqemuMigrationParamsSetString(qemuMigrationParamsPtr migParams,\n                             qemuMigrationParam param,\n                             const char *value)\n{\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_STRING) < 0)\n        return -1;\n\n    migParams->params[param].value.s = g_strdup(value);\n\n    migParams->params[param].set = true;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nqemuMigrationParamsDisableTLS(virDomainObjPtr vm,\n                              qemuMigrationParamsPtr migParams)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!priv->job.migParams->params[QEMU_MIGRATION_PARAM_TLS_CREDS].set)\n        return 0;\n\n    if (qemuMigrationParamsSetString(migParams,\n                                     QEMU_MIGRATION_PARAM_TLS_CREDS, \"\") < 0 ||\n        qemuMigrationParamsSetString(migParams,\n                                     QEMU_MIGRATION_PARAM_TLS_HOSTNAME, \"\") < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuMigrationParamsEnableTLS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "948-1025",
    "snippet": "int\nqemuMigrationParamsEnableTLS(virQEMUDriverPtr driver,\n                             virDomainObjPtr vm,\n                             bool tlsListen,\n                             int asyncJob,\n                             char **tlsAlias,\n                             const char *hostname,\n                             qemuMigrationParamsPtr migParams)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virJSONValuePtr tlsProps = NULL;\n    virJSONValuePtr secProps = NULL;\n    virQEMUDriverConfigPtr cfg = virQEMUDriverGetConfig(driver);\n    const char *secAlias = NULL;\n    int ret = -1;\n\n    if (!cfg->migrateTLSx509certdir) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"host migration TLS directory not configured\"));\n        goto error;\n    }\n\n    if (!priv->job.migParams->params[QEMU_MIGRATION_PARAM_TLS_CREDS].set) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"TLS migration is not supported with this \"\n                         \"QEMU binary\"));\n        goto error;\n    }\n\n    /* If there's a secret, then grab/store it now using the connection */\n    if (cfg->migrateTLSx509secretUUID) {\n        if (!(priv->migSecinfo =\n              qemuDomainSecretInfoTLSNew(priv, QEMU_MIGRATION_TLS_ALIAS_BASE,\n                                         cfg->migrateTLSx509secretUUID)))\n            goto error;\n        secAlias = priv->migSecinfo->s.aes.alias;\n    }\n\n    if (!(*tlsAlias = qemuAliasTLSObjFromSrcAlias(QEMU_MIGRATION_TLS_ALIAS_BASE)))\n        goto error;\n\n    if (qemuDomainGetTLSObjects(priv->qemuCaps, priv->migSecinfo,\n                                cfg->migrateTLSx509certdir, tlsListen,\n                                cfg->migrateTLSx509verify,\n                                *tlsAlias, &tlsProps, &secProps) < 0)\n        goto error;\n\n    /* Ensure the domain doesn't already have the TLS objects defined...\n     * This should prevent any issues just in case some cleanup wasn't\n     * properly completed (both src and dst use the same alias) or\n     * some other error path between now and perform . */\n    qemuDomainDelTLSObjects(driver, vm, asyncJob, secAlias, *tlsAlias);\n\n    if (qemuDomainAddTLSObjects(driver, vm, asyncJob, &secProps, &tlsProps) < 0)\n        goto error;\n\n    if (qemuMigrationParamsSetString(migParams,\n                                     QEMU_MIGRATION_PARAM_TLS_CREDS,\n                                     *tlsAlias) < 0)\n        goto error;\n\n    if (!migParams->params[QEMU_MIGRATION_PARAM_TLS_HOSTNAME].set &&\n        qemuMigrationParamsSetString(migParams,\n                                     QEMU_MIGRATION_PARAM_TLS_HOSTNAME,\n                                     NULLSTR_EMPTY(hostname)) < 0)\n        goto error;\n\n    ret = 0;\n\n cleanup:\n    virObjectUnref(cfg);\n    return ret;\n\n error:\n    virJSONValueFree(tlsProps);\n    virJSONValueFree(secProps);\n    goto cleanup;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define QEMU_MIGRATION_TLS_ALIAS_BASE \"libvirt_migrate\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "secProps"
          ],
          "line": 1023
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 1018
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsSetString",
          "args": [
            "migParams",
            "QEMU_MIGRATION_PARAM_TLS_HOSTNAME",
            "NULLSTR_EMPTY(hostname)"
          ],
          "line": 1010
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsSetString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "917-930",
          "snippet": "static int\nqemuMigrationParamsSetString(qemuMigrationParamsPtr migParams,\n                             qemuMigrationParam param,\n                             const char *value)\n{\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_STRING) < 0)\n        return -1;\n\n    migParams->params[param].value.s = g_strdup(value);\n\n    migParams->params[param].set = true;\n\n    return 0;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int\nqemuMigrationParamsSetString(qemuMigrationParamsPtr migParams,\n                             qemuMigrationParam param,\n                             const char *value)\n{\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_STRING) < 0)\n        return -1;\n\n    migParams->params[param].value.s = g_strdup(value);\n\n    migParams->params[param].set = true;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NULLSTR_EMPTY",
          "args": [
            "hostname"
          ],
          "line": 1012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuDomainAddTLSObjects",
          "args": [
            "driver",
            "vm",
            "asyncJob",
            "&secProps",
            "&tlsProps"
          ],
          "line": 1001
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainAddTLSObjects",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_hotplug.c",
          "lines": "1701-1735",
          "snippet": "int\nqemuDomainAddTLSObjects(virQEMUDriverPtr driver,\n                        virDomainObjPtr vm,\n                        qemuDomainAsyncJob asyncJob,\n                        virJSONValuePtr *secProps,\n                        virJSONValuePtr *tlsProps)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virErrorPtr orig_err;\n    g_autofree char *secAlias = NULL;\n\n    if (!tlsProps && !secProps)\n        return 0;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    if (secProps && *secProps &&\n        qemuMonitorAddObject(priv->mon, secProps, &secAlias) < 0)\n        goto error;\n\n    if (tlsProps &&\n        qemuMonitorAddObject(priv->mon, tlsProps, NULL) < 0)\n        goto error;\n\n    return qemuDomainObjExitMonitor(driver, vm);\n\n error:\n    virErrorPreserveLast(&orig_err);\n    ignore_value(qemuDomainObjExitMonitor(driver, vm));\n    virErrorRestore(&orig_err);\n    qemuDomainDelTLSObjects(driver, vm, asyncJob, secAlias, NULL);\n\n    return -1;\n}",
          "includes": [
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"device_conf.h\"",
            "#include \"virnetdevmidonet.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virpci.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"domain_audit.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_interface.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_domain_address.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nqemuDomainResetDeviceRemoval(virDomainObjPtr vm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"device_conf.h\"\n#include \"virnetdevmidonet.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"locking/domain_lock.h\"\n#include \"qemu_cgroup.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virpci.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"domain_nwfilter.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"domain_audit.h\"\n#include \"qemu_block.h\"\n#include \"qemu_security.h\"\n#include \"qemu_process.h\"\n#include \"qemu_interface.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_command.h\"\n#include \"qemu_domain_address.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_hotplug.h\"\n#include <config.h>\n\nstatic void\nqemuDomainResetDeviceRemoval(virDomainObjPtr vm);\n\nint\nqemuDomainAddTLSObjects(virQEMUDriverPtr driver,\n                        virDomainObjPtr vm,\n                        qemuDomainAsyncJob asyncJob,\n                        virJSONValuePtr *secProps,\n                        virJSONValuePtr *tlsProps)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virErrorPtr orig_err;\n    g_autofree char *secAlias = NULL;\n\n    if (!tlsProps && !secProps)\n        return 0;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    if (secProps && *secProps &&\n        qemuMonitorAddObject(priv->mon, secProps, &secAlias) < 0)\n        goto error;\n\n    if (tlsProps &&\n        qemuMonitorAddObject(priv->mon, tlsProps, NULL) < 0)\n        goto error;\n\n    return qemuDomainObjExitMonitor(driver, vm);\n\n error:\n    virErrorPreserveLast(&orig_err);\n    ignore_value(qemuDomainObjExitMonitor(driver, vm));\n    virErrorRestore(&orig_err);\n    qemuDomainDelTLSObjects(driver, vm, asyncJob, secAlias, NULL);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainDelTLSObjects",
          "args": [
            "driver",
            "vm",
            "asyncJob",
            "secAlias",
            "*tlsAlias"
          ],
          "line": 999
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainDelTLSObjects",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_hotplug.c",
          "lines": "1670-1698",
          "snippet": "void\nqemuDomainDelTLSObjects(virQEMUDriverPtr driver,\n                        virDomainObjPtr vm,\n                        qemuDomainAsyncJob asyncJob,\n                        const char *secAlias,\n                        const char *tlsAlias)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virErrorPtr orig_err;\n\n    if (!tlsAlias && !secAlias)\n        return;\n\n    virErrorPreserveLast(&orig_err);\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    if (tlsAlias)\n        ignore_value(qemuMonitorDelObject(priv->mon, tlsAlias, false));\n\n    if (secAlias)\n        ignore_value(qemuMonitorDelObject(priv->mon, secAlias, false));\n\n    ignore_value(qemuDomainObjExitMonitor(driver, vm));\n\n cleanup:\n    virErrorRestore(&orig_err);\n}",
          "includes": [
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"device_conf.h\"",
            "#include \"virnetdevmidonet.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virpci.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"domain_audit.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_interface.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_domain_address.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nqemuDomainResetDeviceRemoval(virDomainObjPtr vm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"device_conf.h\"\n#include \"virnetdevmidonet.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"locking/domain_lock.h\"\n#include \"qemu_cgroup.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virpci.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"domain_nwfilter.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"domain_audit.h\"\n#include \"qemu_block.h\"\n#include \"qemu_security.h\"\n#include \"qemu_process.h\"\n#include \"qemu_interface.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_command.h\"\n#include \"qemu_domain_address.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_hotplug.h\"\n#include <config.h>\n\nstatic void\nqemuDomainResetDeviceRemoval(virDomainObjPtr vm);\n\nvoid\nqemuDomainDelTLSObjects(virQEMUDriverPtr driver,\n                        virDomainObjPtr vm,\n                        qemuDomainAsyncJob asyncJob,\n                        const char *secAlias,\n                        const char *tlsAlias)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virErrorPtr orig_err;\n\n    if (!tlsAlias && !secAlias)\n        return;\n\n    virErrorPreserveLast(&orig_err);\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        goto cleanup;\n\n    if (tlsAlias)\n        ignore_value(qemuMonitorDelObject(priv->mon, tlsAlias, false));\n\n    if (secAlias)\n        ignore_value(qemuMonitorDelObject(priv->mon, secAlias, false));\n\n    ignore_value(qemuDomainObjExitMonitor(driver, vm));\n\n cleanup:\n    virErrorRestore(&orig_err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainGetTLSObjects",
          "args": [
            "priv->qemuCaps",
            "priv->migSecinfo",
            "cfg->migrateTLSx509certdir",
            "tlsListen",
            "cfg->migrateTLSx509verify",
            "*tlsAlias",
            "&tlsProps",
            "&secProps"
          ],
          "line": 989
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainGetTLSObjects",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_hotplug.c",
          "lines": "1738-1762",
          "snippet": "int\nqemuDomainGetTLSObjects(virQEMUCapsPtr qemuCaps,\n                        qemuDomainSecretInfoPtr secinfo,\n                        const char *tlsCertdir,\n                        bool tlsListen,\n                        bool tlsVerify,\n                        const char *alias,\n                        virJSONValuePtr *tlsProps,\n                        virJSONValuePtr *secProps)\n{\n    const char *secAlias = NULL;\n\n    if (secinfo) {\n        if (qemuBuildSecretInfoProps(secinfo, secProps) < 0)\n            return -1;\n\n        secAlias = secinfo->s.aes.alias;\n    }\n\n    if (qemuBuildTLSx509BackendProps(tlsCertdir, tlsListen, tlsVerify,\n                                     alias, secAlias, qemuCaps, tlsProps) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"device_conf.h\"",
            "#include \"virnetdevmidonet.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virpci.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"domain_audit.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_interface.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_domain_address.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"device_conf.h\"\n#include \"virnetdevmidonet.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"locking/domain_lock.h\"\n#include \"qemu_cgroup.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virpci.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"domain_nwfilter.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"domain_audit.h\"\n#include \"qemu_block.h\"\n#include \"qemu_security.h\"\n#include \"qemu_process.h\"\n#include \"qemu_interface.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_command.h\"\n#include \"qemu_domain_address.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_hotplug.h\"\n#include <config.h>\n\nint\nqemuDomainGetTLSObjects(virQEMUCapsPtr qemuCaps,\n                        qemuDomainSecretInfoPtr secinfo,\n                        const char *tlsCertdir,\n                        bool tlsListen,\n                        bool tlsVerify,\n                        const char *alias,\n                        virJSONValuePtr *tlsProps,\n                        virJSONValuePtr *secProps)\n{\n    const char *secAlias = NULL;\n\n    if (secinfo) {\n        if (qemuBuildSecretInfoProps(secinfo, secProps) < 0)\n            return -1;\n\n        secAlias = secinfo->s.aes.alias;\n    }\n\n    if (qemuBuildTLSx509BackendProps(tlsCertdir, tlsListen, tlsVerify,\n                                     alias, secAlias, qemuCaps, tlsProps) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAliasTLSObjFromSrcAlias",
          "args": [
            "QEMU_MIGRATION_TLS_ALIAS_BASE"
          ],
          "line": 986
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAliasTLSObjFromSrcAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "789-797",
          "snippet": "char *\nqemuAliasTLSObjFromSrcAlias(const char *srcAlias)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"obj%s_tls0\", srcAlias);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nchar *\nqemuAliasTLSObjFromSrcAlias(const char *srcAlias)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"obj%s_tls0\", srcAlias);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainSecretInfoTLSNew",
          "args": [
            "priv",
            "QEMU_MIGRATION_TLS_ALIAS_BASE",
            "cfg->migrateTLSx509secretUUID"
          ],
          "line": 980
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainSecretInfoTLSNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "1682-1700",
          "snippet": "qemuDomainSecretInfoPtr\nqemuDomainSecretInfoTLSNew(qemuDomainObjPrivatePtr priv,\n                           const char *srcAlias,\n                           const char *secretUUID)\n{\n    virSecretLookupTypeDef seclookupdef = {0};\n\n    if (virUUIDParse(secretUUID, seclookupdef.u.uuid) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"malformed TLS secret uuid '%s' provided\"),\n                       secretUUID);\n        return NULL;\n    }\n    seclookupdef.type = VIR_SECRET_LOOKUP_TYPE_UUID;\n\n    return qemuDomainSecretAESSetupFromSecret(priv, srcAlias, NULL,\n                                              VIR_SECRET_USAGE_TYPE_TLS,\n                                              NULL, &seclookupdef);\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nqemuDomainSecretInfoPtr\nqemuDomainSecretInfoTLSNew(qemuDomainObjPrivatePtr priv,\n                           const char *srcAlias,\n                           const char *secretUUID)\n{\n    virSecretLookupTypeDef seclookupdef = {0};\n\n    if (virUUIDParse(secretUUID, seclookupdef.u.uuid) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"malformed TLS secret uuid '%s' provided\"),\n                       secretUUID);\n        return NULL;\n    }\n    seclookupdef.type = VIR_SECRET_LOOKUP_TYPE_UUID;\n\n    return qemuDomainSecretAESSetupFromSecret(priv, srcAlias, NULL,\n                                              VIR_SECRET_USAGE_TYPE_TLS,\n                                              NULL, &seclookupdef);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_UNSUPPORTED",
            "\"%s\"",
            "_(\"TLS migration is not supported with this \"\n                         \"QEMU binary\")"
          ],
          "line": 971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"TLS migration is not supported with this \"\n                         \"QEMU binary\""
          ],
          "line": 972
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"host migration TLS directory not configured\")"
          ],
          "line": 965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virQEMUDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 960
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1211-1218",
          "snippet": "virQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\n#define QEMU_MIGRATION_TLS_ALIAS_BASE \"libvirt_migrate\"\n\nint\nqemuMigrationParamsEnableTLS(virQEMUDriverPtr driver,\n                             virDomainObjPtr vm,\n                             bool tlsListen,\n                             int asyncJob,\n                             char **tlsAlias,\n                             const char *hostname,\n                             qemuMigrationParamsPtr migParams)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    virJSONValuePtr tlsProps = NULL;\n    virJSONValuePtr secProps = NULL;\n    virQEMUDriverConfigPtr cfg = virQEMUDriverGetConfig(driver);\n    const char *secAlias = NULL;\n    int ret = -1;\n\n    if (!cfg->migrateTLSx509certdir) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"host migration TLS directory not configured\"));\n        goto error;\n    }\n\n    if (!priv->job.migParams->params[QEMU_MIGRATION_PARAM_TLS_CREDS].set) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"TLS migration is not supported with this \"\n                         \"QEMU binary\"));\n        goto error;\n    }\n\n    /* If there's a secret, then grab/store it now using the connection */\n    if (cfg->migrateTLSx509secretUUID) {\n        if (!(priv->migSecinfo =\n              qemuDomainSecretInfoTLSNew(priv, QEMU_MIGRATION_TLS_ALIAS_BASE,\n                                         cfg->migrateTLSx509secretUUID)))\n            goto error;\n        secAlias = priv->migSecinfo->s.aes.alias;\n    }\n\n    if (!(*tlsAlias = qemuAliasTLSObjFromSrcAlias(QEMU_MIGRATION_TLS_ALIAS_BASE)))\n        goto error;\n\n    if (qemuDomainGetTLSObjects(priv->qemuCaps, priv->migSecinfo,\n                                cfg->migrateTLSx509certdir, tlsListen,\n                                cfg->migrateTLSx509verify,\n                                *tlsAlias, &tlsProps, &secProps) < 0)\n        goto error;\n\n    /* Ensure the domain doesn't already have the TLS objects defined...\n     * This should prevent any issues just in case some cleanup wasn't\n     * properly completed (both src and dst use the same alias) or\n     * some other error path between now and perform . */\n    qemuDomainDelTLSObjects(driver, vm, asyncJob, secAlias, *tlsAlias);\n\n    if (qemuDomainAddTLSObjects(driver, vm, asyncJob, &secProps, &tlsProps) < 0)\n        goto error;\n\n    if (qemuMigrationParamsSetString(migParams,\n                                     QEMU_MIGRATION_PARAM_TLS_CREDS,\n                                     *tlsAlias) < 0)\n        goto error;\n\n    if (!migParams->params[QEMU_MIGRATION_PARAM_TLS_HOSTNAME].set &&\n        qemuMigrationParamsSetString(migParams,\n                                     QEMU_MIGRATION_PARAM_TLS_HOSTNAME,\n                                     NULLSTR_EMPTY(hostname)) < 0)\n        goto error;\n\n    ret = 0;\n\n cleanup:\n    virObjectUnref(cfg);\n    return ret;\n\n error:\n    virJSONValueFree(tlsProps);\n    virJSONValueFree(secProps);\n    goto cleanup;\n}"
  },
  {
    "function_name": "qemuMigrationParamsSetString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "917-930",
    "snippet": "static int\nqemuMigrationParamsSetString(qemuMigrationParamsPtr migParams,\n                             qemuMigrationParam param,\n                             const char *value)\n{\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_STRING) < 0)\n        return -1;\n\n    migParams->params[param].value.s = g_strdup(value);\n\n    migParams->params[param].set = true;\n\n    return 0;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "value"
          ],
          "line": 925
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsCheckType",
          "args": [
            "param",
            "QEMU_MIGRATION_PARAM_TYPE_STRING"
          ],
          "line": 922
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsCheckType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "282-294",
          "snippet": "static int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nstatic int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int\nqemuMigrationParamsSetString(qemuMigrationParamsPtr migParams,\n                             qemuMigrationParam param,\n                             const char *value)\n{\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_STRING) < 0)\n        return -1;\n\n    migParams->params[param].value.s = g_strdup(value);\n\n    migParams->params[param].set = true;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuMigrationParamsApply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "832-905",
    "snippet": "int\nqemuMigrationParamsApply(virQEMUDriverPtr driver,\n                         virDomainObjPtr vm,\n                         int asyncJob,\n                         qemuMigrationParamsPtr migParams)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    bool xbzrleCacheSize_old = false;\n    virJSONValuePtr params = NULL;\n    virJSONValuePtr caps = NULL;\n    qemuMigrationParam xbzrle = QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE;\n    int ret = -1;\n    int rc;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    if (asyncJob == QEMU_ASYNC_JOB_NONE) {\n        if (!virBitmapIsAllClear(migParams->caps)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Migration capabilities can only be set by \"\n                             \"a migration job\"));\n            goto cleanup;\n        }\n    } else {\n        if (!(caps = qemuMigrationCapsToJSON(priv->migrationCaps, migParams->caps)))\n            goto cleanup;\n\n        if (virJSONValueArraySize(caps) > 0) {\n            rc = qemuMonitorSetMigrationCapabilities(priv->mon, caps);\n            caps = NULL;\n            if (rc < 0)\n                goto cleanup;\n        }\n    }\n\n    /* If QEMU is too old to support xbzrle-cache-size migration parameter,\n     * we need to set it via migrate-set-cache-size and tell\n     * qemuMonitorSetMigrationParams to ignore this parameter.\n     */\n    if (migParams->params[xbzrle].set &&\n        (!priv->job.migParams ||\n         !priv->job.migParams->params[xbzrle].set)) {\n        if (qemuMonitorSetMigrationCacheSize(priv->mon,\n                                             migParams->params[xbzrle].value.ull) < 0)\n            goto cleanup;\n        xbzrleCacheSize_old = true;\n        migParams->params[xbzrle].set = false;\n    }\n\n    if (!(params = qemuMigrationParamsToJSON(migParams)))\n        goto cleanup;\n\n    if (virJSONValueObjectKeysNumber(params) > 0) {\n        rc = qemuMonitorSetMigrationParams(priv->mon, params);\n        params = NULL;\n        if (rc < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    if (qemuDomainObjExitMonitor(driver, vm) < 0)\n        ret = -1;\n\n    if (xbzrleCacheSize_old)\n        migParams->params[xbzrle].set = true;\n\n    virJSONValueFree(params);\n    virJSONValueFree(caps);\n\n    return ret;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "caps"
          ],
          "line": 902
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainObjExitMonitor",
          "args": [
            "driver",
            "vm"
          ],
          "line": 895
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjExitMonitor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10189-10200",
          "snippet": "int qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\n\nint qemuDomainObjExitMonitor(virQEMUDriverPtr driver,\n                             virDomainObjPtr obj)\n{\n    qemuDomainObjExitMonitorInternal(driver, obj);\n    if (!virDomainObjIsActive(obj)) {\n        if (virGetLastErrorCode() == VIR_ERR_OK)\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"domain is no longer running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMonitorSetMigrationParams",
          "args": [
            "priv->mon",
            "params"
          ],
          "line": 886
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorSetMigrationParams",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "2450-2461",
          "snippet": "int\nqemuMonitorSetMigrationParams(qemuMonitorPtr mon,\n                              virJSONValuePtr params)\n{\n    QEMU_CHECK_MONITOR_GOTO(mon, error);\n\n    return qemuMonitorJSONSetMigrationParams(mon, params);\n\n error:\n    virJSONValueFree(params);\n    return -1;\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorSetMigrationParams(qemuMonitorPtr mon,\n                              virJSONValuePtr params)\n{\n    QEMU_CHECK_MONITOR_GOTO(mon, error);\n\n    return qemuMonitorJSONSetMigrationParams(mon, params);\n\n error:\n    virJSONValueFree(params);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectKeysNumber",
          "args": [
            "params"
          ],
          "line": 885
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectKeysNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "928-935",
          "snippet": "int\nvirJSONValueObjectKeysNumber(virJSONValuePtr object)\n{\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    return object->data.object.npairs;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectKeysNumber(virJSONValuePtr object)\n{\n    if (object->type != VIR_JSON_TYPE_OBJECT)\n        return -1;\n\n    return object->data.object.npairs;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsToJSON",
          "args": [
            "migParams"
          ],
          "line": 882
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsToJSON",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "729-773",
          "snippet": "virJSONValuePtr\nqemuMigrationParamsToJSON(qemuMigrationParamsPtr migParams)\n{\n    virJSONValuePtr params = virJSONValueNewObject();\n    qemuMigrationParamValuePtr pv;\n    const char *name;\n    size_t i;\n    int rc;\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        name = qemuMigrationParamTypeToString(i);\n        pv = &migParams->params[i];\n\n        if (!pv->set)\n            continue;\n\n        rc = 0;\n        switch (qemuMigrationParamTypes[i]) {\n        case QEMU_MIGRATION_PARAM_TYPE_INT:\n            rc = virJSONValueObjectAppendNumberInt(params, name, pv->value.i);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_ULL:\n            rc = virJSONValueObjectAppendNumberUlong(params, name, pv->value.ull);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_BOOL:\n            rc = virJSONValueObjectAppendBoolean(params, name, pv->value.b);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_STRING:\n            rc = virJSONValueObjectAppendString(params, name, pv->value.s);\n            break;\n        }\n\n        if (rc < 0)\n            goto error;\n    }\n\n    return params;\n\n error:\n    virJSONValueFree(params);\n    return NULL;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nvirJSONValuePtr\nqemuMigrationParamsToJSON(qemuMigrationParamsPtr migParams)\n{\n    virJSONValuePtr params = virJSONValueNewObject();\n    qemuMigrationParamValuePtr pv;\n    const char *name;\n    size_t i;\n    int rc;\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        name = qemuMigrationParamTypeToString(i);\n        pv = &migParams->params[i];\n\n        if (!pv->set)\n            continue;\n\n        rc = 0;\n        switch (qemuMigrationParamTypes[i]) {\n        case QEMU_MIGRATION_PARAM_TYPE_INT:\n            rc = virJSONValueObjectAppendNumberInt(params, name, pv->value.i);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_ULL:\n            rc = virJSONValueObjectAppendNumberUlong(params, name, pv->value.ull);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_BOOL:\n            rc = virJSONValueObjectAppendBoolean(params, name, pv->value.b);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_STRING:\n            rc = virJSONValueObjectAppendString(params, name, pv->value.s);\n            break;\n        }\n\n        if (rc < 0)\n            goto error;\n    }\n\n    return params;\n\n error:\n    virJSONValueFree(params);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMonitorSetMigrationCacheSize",
          "args": [
            "priv->mon",
            "migParams->params[xbzrle].value.ull"
          ],
          "line": 875
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorSetMigrationCacheSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "2407-2416",
          "snippet": "int\nqemuMonitorSetMigrationCacheSize(qemuMonitorPtr mon,\n                                 unsigned long long cacheSize)\n{\n    VIR_DEBUG(\"cacheSize=%llu\", cacheSize);\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONSetMigrationCacheSize(mon, cacheSize);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorSetMigrationCacheSize(qemuMonitorPtr mon,\n                                 unsigned long long cacheSize)\n{\n    VIR_DEBUG(\"cacheSize=%llu\", cacheSize);\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONSetMigrationCacheSize(mon, cacheSize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMonitorSetMigrationCapabilities",
          "args": [
            "priv->mon",
            "caps"
          ],
          "line": 861
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorSetMigrationCapabilities",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "3801-3812",
          "snippet": "int\nqemuMonitorSetMigrationCapabilities(qemuMonitorPtr mon,\n                                    virJSONValuePtr caps)\n{\n    QEMU_CHECK_MONITOR_GOTO(mon, error);\n\n    return qemuMonitorJSONSetMigrationCapabilities(mon, caps);\n\n error:\n    virJSONValueFree(caps);\n    return -1;\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorSetMigrationCapabilities(qemuMonitorPtr mon,\n                                    virJSONValuePtr caps)\n{\n    QEMU_CHECK_MONITOR_GOTO(mon, error);\n\n    return qemuMonitorJSONSetMigrationCapabilities(mon, caps);\n\n error:\n    virJSONValueFree(caps);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueArraySize",
          "args": [
            "caps"
          ],
          "line": 860
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArraySize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1017-1021",
          "snippet": "size_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nsize_t\nvirJSONValueArraySize(const virJSONValue *array)\n{\n    return array->data.array.nvalues;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationCapsToJSON",
          "args": [
            "priv->migrationCaps",
            "migParams->caps"
          ],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationCapsToJSON",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "776-818",
          "snippet": "virJSONValuePtr\nqemuMigrationCapsToJSON(virBitmapPtr caps,\n                        virBitmapPtr states)\n{\n    virJSONValuePtr json = NULL;\n    virJSONValuePtr cap = NULL;\n    qemuMigrationCapability bit;\n    const char *name;\n\n    json = virJSONValueNewArray();\n\n    for (bit = 0; bit < QEMU_MIGRATION_CAP_LAST; bit++) {\n        bool supported = false;\n        bool state = false;\n\n        ignore_value(virBitmapGetBit(caps, bit, &supported));\n        if (!supported)\n            continue;\n\n        ignore_value(virBitmapGetBit(states, bit, &state));\n\n        cap = virJSONValueNewObject();\n\n        name = qemuMigrationCapabilityTypeToString(bit);\n        if (virJSONValueObjectAppendString(cap, \"capability\", name) < 0)\n            goto error;\n\n        if (virJSONValueObjectAppendBoolean(cap, \"state\", state) < 0)\n            goto error;\n\n        if (virJSONValueArrayAppend(json, cap) < 0)\n            goto error;\n\n        cap = NULL;\n    }\n\n    return json;\n\n error:\n    virJSONValueFree(json);\n    virJSONValueFree(cap);\n    return NULL;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nvirJSONValuePtr\nqemuMigrationCapsToJSON(virBitmapPtr caps,\n                        virBitmapPtr states)\n{\n    virJSONValuePtr json = NULL;\n    virJSONValuePtr cap = NULL;\n    qemuMigrationCapability bit;\n    const char *name;\n\n    json = virJSONValueNewArray();\n\n    for (bit = 0; bit < QEMU_MIGRATION_CAP_LAST; bit++) {\n        bool supported = false;\n        bool state = false;\n\n        ignore_value(virBitmapGetBit(caps, bit, &supported));\n        if (!supported)\n            continue;\n\n        ignore_value(virBitmapGetBit(states, bit, &state));\n\n        cap = virJSONValueNewObject();\n\n        name = qemuMigrationCapabilityTypeToString(bit);\n        if (virJSONValueObjectAppendString(cap, \"capability\", name) < 0)\n            goto error;\n\n        if (virJSONValueObjectAppendBoolean(cap, \"state\", state) < 0)\n            goto error;\n\n        if (virJSONValueArrayAppend(json, cap) < 0)\n            goto error;\n\n        cap = NULL;\n    }\n\n    return json;\n\n error:\n    virJSONValueFree(json);\n    virJSONValueFree(cap);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Migration capabilities can only be set by \"\n                             \"a migration job\")"
          ],
          "line": 851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Migration capabilities can only be set by \"\n                             \"a migration job\""
          ],
          "line": 852
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapIsAllClear",
          "args": [
            "migParams->caps"
          ],
          "line": 850
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapIsAllClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "962-972",
          "snippet": "bool\nvirBitmapIsAllClear(virBitmapPtr bitmap)\n{\n    size_t i;\n\n    for (i = 0; i < bitmap->map_len; i++)\n        if (bitmap->map[i] != 0)\n            return false;\n\n    return true;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirBitmapIsAllClear(virBitmapPtr bitmap)\n{\n    size_t i;\n\n    for (i = 0; i < bitmap->map_len; i++)\n        if (bitmap->map[i] != 0)\n            return false;\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainObjEnterMonitorAsync",
          "args": [
            "driver",
            "vm",
            "asyncJob"
          ],
          "line": 846
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainObjEnterMonitorAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "10216-10222",
          "snippet": "int\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qemuDomainLogContextFinalize(GObject *obj);",
            "static void qemuDomainSaveCookieDispose(void *obj);",
            "static void qemuDomainDiskPrivateDispose(void *obj);",
            "static void qemuDomainStorageSourcePrivateDispose(void *obj);",
            "static void qemuDomainVcpuPrivateDispose(void *obj);",
            "static void qemuDomainChrSourcePrivateDispose(void *obj);",
            "static void qemuDomainVsockPrivateDispose(void *obj);",
            "static void qemuDomainGraphicsPrivateDispose(void *obj);",
            "static void qemuDomainNetworkPrivateDispose(void *obj);",
            "static void qemuDomainFSPrivateDispose(void *obj);",
            "static void qemuDomainVideoPrivateDispose(void *obj);",
            "qemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nstatic void qemuDomainLogContextFinalize(GObject *obj);\nstatic void qemuDomainSaveCookieDispose(void *obj);\nstatic void qemuDomainDiskPrivateDispose(void *obj);\nstatic void qemuDomainStorageSourcePrivateDispose(void *obj);\nstatic void qemuDomainVcpuPrivateDispose(void *obj);\nstatic void qemuDomainChrSourcePrivateDispose(void *obj);\nstatic void qemuDomainVsockPrivateDispose(void *obj);\nstatic void qemuDomainGraphicsPrivateDispose(void *obj);\nstatic void qemuDomainNetworkPrivateDispose(void *obj);\nstatic void qemuDomainFSPrivateDispose(void *obj);\nstatic void qemuDomainVideoPrivateDispose(void *obj);\nqemuDomainJobTypeToString(job),\n              qemuDomainAgentJobTypeToString(agentJob),\n              qemuDomainAsyncJobTypeToString(asyncJob),\n              obj, obj->def->name,\n              qemuDomainJobTypeToString(priv->job.active),\n              qemuDomainAgentJobTypeToString(priv->job.agentActive),\n              qemuDomainAsyncJobTypeToString(priv->job.asyncJob));\n\nint\nqemuDomainObjEnterMonitorAsync(virQEMUDriverPtr driver,\n                               virDomainObjPtr obj,\n                               qemuDomainAsyncJob asyncJob)\n{\n    return qemuDomainObjEnterMonitorInternal(driver, obj, asyncJob);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nqemuMigrationParamsApply(virQEMUDriverPtr driver,\n                         virDomainObjPtr vm,\n                         int asyncJob,\n                         qemuMigrationParamsPtr migParams)\n{\n    qemuDomainObjPrivatePtr priv = vm->privateData;\n    bool xbzrleCacheSize_old = false;\n    virJSONValuePtr params = NULL;\n    virJSONValuePtr caps = NULL;\n    qemuMigrationParam xbzrle = QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE;\n    int ret = -1;\n    int rc;\n\n    if (qemuDomainObjEnterMonitorAsync(driver, vm, asyncJob) < 0)\n        return -1;\n\n    if (asyncJob == QEMU_ASYNC_JOB_NONE) {\n        if (!virBitmapIsAllClear(migParams->caps)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Migration capabilities can only be set by \"\n                             \"a migration job\"));\n            goto cleanup;\n        }\n    } else {\n        if (!(caps = qemuMigrationCapsToJSON(priv->migrationCaps, migParams->caps)))\n            goto cleanup;\n\n        if (virJSONValueArraySize(caps) > 0) {\n            rc = qemuMonitorSetMigrationCapabilities(priv->mon, caps);\n            caps = NULL;\n            if (rc < 0)\n                goto cleanup;\n        }\n    }\n\n    /* If QEMU is too old to support xbzrle-cache-size migration parameter,\n     * we need to set it via migrate-set-cache-size and tell\n     * qemuMonitorSetMigrationParams to ignore this parameter.\n     */\n    if (migParams->params[xbzrle].set &&\n        (!priv->job.migParams ||\n         !priv->job.migParams->params[xbzrle].set)) {\n        if (qemuMonitorSetMigrationCacheSize(priv->mon,\n                                             migParams->params[xbzrle].value.ull) < 0)\n            goto cleanup;\n        xbzrleCacheSize_old = true;\n        migParams->params[xbzrle].set = false;\n    }\n\n    if (!(params = qemuMigrationParamsToJSON(migParams)))\n        goto cleanup;\n\n    if (virJSONValueObjectKeysNumber(params) > 0) {\n        rc = qemuMonitorSetMigrationParams(priv->mon, params);\n        params = NULL;\n        if (rc < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    if (qemuDomainObjExitMonitor(driver, vm) < 0)\n        ret = -1;\n\n    if (xbzrleCacheSize_old)\n        migParams->params[xbzrle].set = true;\n\n    virJSONValueFree(params);\n    virJSONValueFree(caps);\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuMigrationCapsToJSON",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "776-818",
    "snippet": "virJSONValuePtr\nqemuMigrationCapsToJSON(virBitmapPtr caps,\n                        virBitmapPtr states)\n{\n    virJSONValuePtr json = NULL;\n    virJSONValuePtr cap = NULL;\n    qemuMigrationCapability bit;\n    const char *name;\n\n    json = virJSONValueNewArray();\n\n    for (bit = 0; bit < QEMU_MIGRATION_CAP_LAST; bit++) {\n        bool supported = false;\n        bool state = false;\n\n        ignore_value(virBitmapGetBit(caps, bit, &supported));\n        if (!supported)\n            continue;\n\n        ignore_value(virBitmapGetBit(states, bit, &state));\n\n        cap = virJSONValueNewObject();\n\n        name = qemuMigrationCapabilityTypeToString(bit);\n        if (virJSONValueObjectAppendString(cap, \"capability\", name) < 0)\n            goto error;\n\n        if (virJSONValueObjectAppendBoolean(cap, \"state\", state) < 0)\n            goto error;\n\n        if (virJSONValueArrayAppend(json, cap) < 0)\n            goto error;\n\n        cap = NULL;\n    }\n\n    return json;\n\n error:\n    virJSONValueFree(json);\n    virJSONValueFree(cap);\n    return NULL;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "cap"
          ],
          "line": 816
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueArrayAppend",
          "args": [
            "json",
            "cap"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueArrayAppendString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "792-804",
          "snippet": "int\nvirJSONValueArrayAppendString(virJSONValuePtr object,\n                              const char *value)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueArrayAppend(object, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueArrayAppendString(virJSONValuePtr object,\n                              const char *value)\n{\n    virJSONValuePtr jvalue = virJSONValueNewString(value);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueArrayAppend(object, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendBoolean",
          "args": [
            "cap",
            "\"state\"",
            "state"
          ],
          "line": 803
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "741-754",
          "snippet": "int\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendString",
          "args": [
            "cap",
            "\"capability\"",
            "name"
          ],
          "line": 800
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "643-649",
          "snippet": "int\nvirJSONValueObjectAppendString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, false);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationCapabilityTypeToString",
          "args": [
            "bit"
          ],
          "line": 799
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueNewObject",
          "args": [],
          "line": 797
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "571-579",
          "snippet": "virJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapGetBit(states, bit, &state)"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapGetBit",
          "args": [
            "states",
            "bit",
            "&state"
          ],
          "line": 795
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapGetBit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "320-330",
          "snippet": "int\nvirBitmapGetBit(virBitmapPtr bitmap,\n                size_t b,\n                bool *result)\n{\n    if (bitmap->nbits <= b)\n        return -1;\n\n    *result = virBitmapIsSet(bitmap, b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapGetBit(virBitmapPtr bitmap,\n                size_t b,\n                bool *result)\n{\n    if (bitmap->nbits <= b)\n        return -1;\n\n    *result = virBitmapIsSet(bitmap, b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapGetBit(caps, bit, &supported)"
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueNewArray",
          "args": [],
          "line": 785
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "560-568",
          "snippet": "virJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewArray(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_ARRAY;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nvirJSONValuePtr\nqemuMigrationCapsToJSON(virBitmapPtr caps,\n                        virBitmapPtr states)\n{\n    virJSONValuePtr json = NULL;\n    virJSONValuePtr cap = NULL;\n    qemuMigrationCapability bit;\n    const char *name;\n\n    json = virJSONValueNewArray();\n\n    for (bit = 0; bit < QEMU_MIGRATION_CAP_LAST; bit++) {\n        bool supported = false;\n        bool state = false;\n\n        ignore_value(virBitmapGetBit(caps, bit, &supported));\n        if (!supported)\n            continue;\n\n        ignore_value(virBitmapGetBit(states, bit, &state));\n\n        cap = virJSONValueNewObject();\n\n        name = qemuMigrationCapabilityTypeToString(bit);\n        if (virJSONValueObjectAppendString(cap, \"capability\", name) < 0)\n            goto error;\n\n        if (virJSONValueObjectAppendBoolean(cap, \"state\", state) < 0)\n            goto error;\n\n        if (virJSONValueArrayAppend(json, cap) < 0)\n            goto error;\n\n        cap = NULL;\n    }\n\n    return json;\n\n error:\n    virJSONValueFree(json);\n    virJSONValueFree(cap);\n    return NULL;\n}"
  },
  {
    "function_name": "qemuMigrationParamsToJSON",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "729-773",
    "snippet": "virJSONValuePtr\nqemuMigrationParamsToJSON(qemuMigrationParamsPtr migParams)\n{\n    virJSONValuePtr params = virJSONValueNewObject();\n    qemuMigrationParamValuePtr pv;\n    const char *name;\n    size_t i;\n    int rc;\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        name = qemuMigrationParamTypeToString(i);\n        pv = &migParams->params[i];\n\n        if (!pv->set)\n            continue;\n\n        rc = 0;\n        switch (qemuMigrationParamTypes[i]) {\n        case QEMU_MIGRATION_PARAM_TYPE_INT:\n            rc = virJSONValueObjectAppendNumberInt(params, name, pv->value.i);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_ULL:\n            rc = virJSONValueObjectAppendNumberUlong(params, name, pv->value.ull);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_BOOL:\n            rc = virJSONValueObjectAppendBoolean(params, name, pv->value.b);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_STRING:\n            rc = virJSONValueObjectAppendString(params, name, pv->value.s);\n            break;\n        }\n\n        if (rc < 0)\n            goto error;\n    }\n\n    return params;\n\n error:\n    virJSONValueFree(params);\n    return NULL;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "params"
          ],
          "line": 771
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendString",
          "args": [
            "params",
            "name",
            "pv->value.s"
          ],
          "line": 760
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "643-649",
          "snippet": "int\nvirJSONValueObjectAppendString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, false);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendBoolean",
          "args": [
            "params",
            "name",
            "pv->value.b"
          ],
          "line": 756
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "741-754",
          "snippet": "int\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendBoolean(virJSONValuePtr object,\n                                const char *key,\n                                int boolean_)\n{\n    virJSONValuePtr jvalue = virJSONValueNewBoolean(boolean_);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendNumberUlong",
          "args": [
            "params",
            "name",
            "pv->value.ull"
          ],
          "line": 752
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendNumberUlong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "709-722",
          "snippet": "int\nvirJSONValueObjectAppendNumberUlong(virJSONValuePtr object,\n                                    const char *key,\n                                    unsigned long long number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberUlong(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNumberUlong(virJSONValuePtr object,\n                                    const char *key,\n                                    unsigned long long number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberUlong(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendNumberInt",
          "args": [
            "params",
            "name",
            "pv->value.i"
          ],
          "line": 748
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendNumberInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "661-674",
          "snippet": "int\nvirJSONValueObjectAppendNumberInt(virJSONValuePtr object,\n                                  const char *key,\n                                  int number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberInt(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNumberInt(virJSONValuePtr object,\n                                  const char *key,\n                                  int number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberInt(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamTypeToString",
          "args": [
            "i"
          ],
          "line": 739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueNewObject",
          "args": [],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "571-579",
          "snippet": "virJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nvirJSONValuePtr\nqemuMigrationParamsToJSON(qemuMigrationParamsPtr migParams)\n{\n    virJSONValuePtr params = virJSONValueNewObject();\n    qemuMigrationParamValuePtr pv;\n    const char *name;\n    size_t i;\n    int rc;\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        name = qemuMigrationParamTypeToString(i);\n        pv = &migParams->params[i];\n\n        if (!pv->set)\n            continue;\n\n        rc = 0;\n        switch (qemuMigrationParamTypes[i]) {\n        case QEMU_MIGRATION_PARAM_TYPE_INT:\n            rc = virJSONValueObjectAppendNumberInt(params, name, pv->value.i);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_ULL:\n            rc = virJSONValueObjectAppendNumberUlong(params, name, pv->value.ull);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_BOOL:\n            rc = virJSONValueObjectAppendBoolean(params, name, pv->value.b);\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_STRING:\n            rc = virJSONValueObjectAppendString(params, name, pv->value.s);\n            break;\n        }\n\n        if (rc < 0)\n            goto error;\n    }\n\n    return params;\n\n error:\n    virJSONValueFree(params);\n    return NULL;\n}"
  },
  {
    "function_name": "qemuMigrationParamsFromJSON",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "681-726",
    "snippet": "qemuMigrationParamsPtr\nqemuMigrationParamsFromJSON(virJSONValuePtr params)\n{\n    qemuMigrationParamsPtr migParams;\n    qemuMigrationParamValuePtr pv;\n    const char *name;\n    const char *str;\n    size_t i;\n\n    if (!(migParams = qemuMigrationParamsNew()))\n        return NULL;\n\n    if (!params)\n        return migParams;\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        name = qemuMigrationParamTypeToString(i);\n        pv = &migParams->params[i];\n\n        switch (qemuMigrationParamTypes[i]) {\n        case QEMU_MIGRATION_PARAM_TYPE_INT:\n            if (virJSONValueObjectGetNumberInt(params, name, &pv->value.i) == 0)\n                pv->set = true;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_ULL:\n            if (virJSONValueObjectGetNumberUlong(params, name, &pv->value.ull) == 0)\n                pv->set = true;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_BOOL:\n            if (virJSONValueObjectGetBoolean(params, name, &pv->value.b) == 0)\n                pv->set = true;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_STRING:\n            if ((str = virJSONValueObjectGetString(params, name))) {\n                pv->value.s = g_strdup(str);\n                pv->set = true;\n            }\n            break;\n        }\n    }\n\n    return migParams;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "str"
          ],
          "line": 718
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetString",
          "args": [
            "params",
            "name"
          ],
          "line": 717
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetStringOrNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1313-1328",
          "snippet": "const char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetBoolean",
          "args": [
            "params",
            "name",
            "&pv->value.b"
          ],
          "line": 712
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1401-1412",
          "snippet": "int\nvirJSONValueObjectGetBoolean(virJSONValuePtr object,\n                             const char *key,\n                             bool *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetBoolean(val, value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectGetBoolean(virJSONValuePtr object,\n                             const char *key,\n                             bool *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetBoolean(val, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetNumberUlong",
          "args": [
            "params",
            "name",
            "&pv->value.ull"
          ],
          "line": 707
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetNumberUlong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1373-1384",
          "snippet": "int\nvirJSONValueObjectGetNumberUlong(virJSONValuePtr object,\n                                 const char *key,\n                                 unsigned long long *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberUlong(val, value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectGetNumberUlong(virJSONValuePtr object,\n                                 const char *key,\n                                 unsigned long long *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberUlong(val, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetNumberInt",
          "args": [
            "params",
            "name",
            "&pv->value.i"
          ],
          "line": 702
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetNumberInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1331-1342",
          "snippet": "int\nvirJSONValueObjectGetNumberInt(virJSONValuePtr object,\n                               const char *key,\n                               int *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberInt(val, value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectGetNumberInt(virJSONValuePtr object,\n                               const char *key,\n                               int *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberInt(val, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamTypeToString",
          "args": [
            "i"
          ],
          "line": 697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsNew",
          "args": [],
          "line": 690
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "244-261",
          "snippet": "qemuMigrationParamsPtr\nqemuMigrationParamsNew(void)\n{\n    qemuMigrationParamsPtr params;\n\n    if (VIR_ALLOC(params) < 0)\n        return NULL;\n\n    params->caps = virBitmapNew(QEMU_MIGRATION_CAP_LAST);\n    if (!params->caps)\n        goto error;\n\n    return params;\n\n error:\n    qemuMigrationParamsFree(params);\n    return NULL;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nqemuMigrationParamsPtr\nqemuMigrationParamsNew(void)\n{\n    qemuMigrationParamsPtr params;\n\n    if (VIR_ALLOC(params) < 0)\n        return NULL;\n\n    params->caps = virBitmapNew(QEMU_MIGRATION_CAP_LAST);\n    if (!params->caps)\n        goto error;\n\n    return params;\n\n error:\n    qemuMigrationParamsFree(params);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nqemuMigrationParamsPtr\nqemuMigrationParamsFromJSON(virJSONValuePtr params)\n{\n    qemuMigrationParamsPtr migParams;\n    qemuMigrationParamValuePtr pv;\n    const char *name;\n    const char *str;\n    size_t i;\n\n    if (!(migParams = qemuMigrationParamsNew()))\n        return NULL;\n\n    if (!params)\n        return migParams;\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        name = qemuMigrationParamTypeToString(i);\n        pv = &migParams->params[i];\n\n        switch (qemuMigrationParamTypes[i]) {\n        case QEMU_MIGRATION_PARAM_TYPE_INT:\n            if (virJSONValueObjectGetNumberInt(params, name, &pv->value.i) == 0)\n                pv->set = true;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_ULL:\n            if (virJSONValueObjectGetNumberUlong(params, name, &pv->value.ull) == 0)\n                pv->set = true;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_BOOL:\n            if (virJSONValueObjectGetBoolean(params, name, &pv->value.b) == 0)\n                pv->set = true;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_STRING:\n            if ((str = virJSONValueObjectGetString(params, name))) {\n                pv->value.s = g_strdup(str);\n                pv->set = true;\n            }\n            break;\n        }\n    }\n\n    return migParams;\n}"
  },
  {
    "function_name": "qemuMigrationParamsDump",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "621-678",
    "snippet": "int\nqemuMigrationParamsDump(qemuMigrationParamsPtr migParams,\n                        virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        unsigned long *flags)\n{\n    size_t i;\n\n    if (migParams->compMethods == 1ULL << QEMU_MIGRATION_COMPRESS_XBZRLE &&\n        !migParams->params[QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE].set) {\n        *flags |= VIR_MIGRATE_COMPRESSED;\n        return 0;\n    }\n\n    for (i = 0; i < QEMU_MIGRATION_COMPRESS_LAST; ++i) {\n        if ((migParams->compMethods & (1ULL << i)) &&\n            virTypedParamsAddString(params, nparams, maxparams,\n                                    VIR_MIGRATE_PARAM_COMPRESSION,\n                                    qemuMigrationCompressMethodTypeToString(i)) < 0)\n            return -1;\n    }\n\n    for (i = 0; i < G_N_ELEMENTS(qemuMigrationParamsTPMap); i++) {\n        const qemuMigrationParamsTPMapItem *item = &qemuMigrationParamsTPMap[i];\n\n        if (!(item->party & QEMU_MIGRATION_DESTINATION))\n            continue;\n\n        switch (qemuMigrationParamTypes[item->param]) {\n        case QEMU_MIGRATION_PARAM_TYPE_INT:\n            if (qemuMigrationParamsSetTPInt(migParams, item->param,\n                                            params, nparams, maxparams,\n                                            item->typedParam, item->unit) < 0)\n                return -1;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_ULL:\n            if (qemuMigrationParamsSetTPULL(migParams, item->param,\n                                            params, nparams, maxparams,\n                                            item->typedParam, item->unit) < 0)\n                return -1;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_BOOL:\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_STRING:\n            if (qemuMigrationParamsSetTPString(migParams, item->param,\n                                               params, nparams, maxparams,\n                                               item->typedParam) < 0)\n                return -1;\n            break;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const qemuMigrationParamsTPMapItem qemuMigrationParamsTPMap[] = {\n    {.typedParam = VIR_MIGRATE_PARAM_AUTO_CONVERGE_INITIAL,\n     .param = QEMU_MIGRATION_PARAM_THROTTLE_INITIAL,\n     .party = QEMU_MIGRATION_SOURCE},\n\n    {.typedParam = VIR_MIGRATE_PARAM_AUTO_CONVERGE_INCREMENT,\n     .param = QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT,\n     .party = QEMU_MIGRATION_SOURCE},\n\n    {.typedParam = VIR_MIGRATE_PARAM_COMPRESSION_MT_LEVEL,\n     .param = QEMU_MIGRATION_PARAM_COMPRESS_LEVEL,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_COMPRESSION_MT_THREADS,\n     .param = QEMU_MIGRATION_PARAM_COMPRESS_THREADS,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_COMPRESSION_MT_DTHREADS,\n     .param = QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_COMPRESSION_XBZRLE_CACHE,\n     .param = QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_BANDWIDTH_POSTCOPY,\n     .unit = 1024 * 1024, /* MiB/s */\n     .param = QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_PARALLEL_CONNECTIONS,\n     .param = QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_TLS_DESTINATION,\n     .param = QEMU_MIGRATION_PARAM_TLS_HOSTNAME,\n     .party = QEMU_MIGRATION_SOURCE},\n};",
      "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuMigrationParamsSetTPString",
          "args": [
            "migParams",
            "item->param",
            "params",
            "nparams",
            "maxparams",
            "item->typedParam"
          ],
          "line": 669
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsSetTPString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "444-460",
          "snippet": "static int\nqemuMigrationParamsSetTPString(qemuMigrationParamsPtr migParams,\n                               qemuMigrationParam param,\n                               virTypedParameterPtr *params,\n                               int *nparams,\n                               int *maxparams,\n                               const char *name)\n{\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_STRING) < 0)\n        return -1;\n\n    if (!migParams->params[param].set)\n        return 0;\n\n    return virTypedParamsAddString(params, nparams, maxparams, name,\n                                   migParams->params[param].value.s);\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int\nqemuMigrationParamsSetTPString(qemuMigrationParamsPtr migParams,\n                               qemuMigrationParam param,\n                               virTypedParameterPtr *params,\n                               int *nparams,\n                               int *maxparams,\n                               const char *name)\n{\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_STRING) < 0)\n        return -1;\n\n    if (!migParams->params[param].set)\n        return 0;\n\n    return virTypedParamsAddString(params, nparams, maxparams, name,\n                                   migParams->params[param].value.s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsSetTPULL",
          "args": [
            "migParams",
            "item->param",
            "params",
            "nparams",
            "maxparams",
            "item->typedParam",
            "item->unit"
          ],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsSetTPULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "394-416",
          "snippet": "static int\nqemuMigrationParamsSetTPULL(qemuMigrationParamsPtr migParams,\n                            qemuMigrationParam param,\n                            virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            unsigned int unit)\n{\n    unsigned long long value;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_ULL) < 0)\n        return -1;\n\n    if (!migParams->params[param].set)\n        return 0;\n\n    value = migParams->params[param].value.ull;\n    if (unit > 0)\n        value /= unit;\n\n    return virTypedParamsAddULLong(params, nparams, maxparams, name, value);\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int\nqemuMigrationParamsSetTPULL(qemuMigrationParamsPtr migParams,\n                            qemuMigrationParam param,\n                            virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            unsigned int unit)\n{\n    unsigned long long value;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_ULL) < 0)\n        return -1;\n\n    if (!migParams->params[param].set)\n        return 0;\n\n    value = migParams->params[param].value.ull;\n    if (unit > 0)\n        value /= unit;\n\n    return virTypedParamsAddULLong(params, nparams, maxparams, name, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsSetTPInt",
          "args": [
            "migParams",
            "item->param",
            "params",
            "nparams",
            "maxparams",
            "item->typedParam",
            "item->unit"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsSetTPInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "333-355",
          "snippet": "static int\nqemuMigrationParamsSetTPInt(qemuMigrationParamsPtr migParams,\n                            qemuMigrationParam param,\n                            virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            unsigned int unit)\n{\n    int value;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_INT) < 0)\n        return -1;\n\n    if (!migParams->params[param].set)\n        return 0;\n\n    value = migParams->params[param].value.i;\n    if (unit > 0)\n        value /= unit;\n\n    return virTypedParamsAddInt(params, nparams, maxparams, name, value);\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int\nqemuMigrationParamsSetTPInt(qemuMigrationParamsPtr migParams,\n                            qemuMigrationParam param,\n                            virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            unsigned int unit)\n{\n    int value;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_INT) < 0)\n        return -1;\n\n    if (!migParams->params[param].set)\n        return 0;\n\n    value = migParams->params[param].value.i;\n    if (unit > 0)\n        value /= unit;\n\n    return virTypedParamsAddInt(params, nparams, maxparams, name, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "qemuMigrationParamsTPMap"
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsAddString",
          "args": [
            "params",
            "nparams",
            "maxparams",
            "VIR_MIGRATE_PARAM_COMPRESSION",
            "qemuMigrationCompressMethodTypeToString(i)"
          ],
          "line": 638
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "768-788",
          "snippet": "int\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationCompressMethodTypeToString",
          "args": [
            "i"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamsTPMapItem qemuMigrationParamsTPMap[] = {\n    {.typedParam = VIR_MIGRATE_PARAM_AUTO_CONVERGE_INITIAL,\n     .param = QEMU_MIGRATION_PARAM_THROTTLE_INITIAL,\n     .party = QEMU_MIGRATION_SOURCE},\n\n    {.typedParam = VIR_MIGRATE_PARAM_AUTO_CONVERGE_INCREMENT,\n     .param = QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT,\n     .party = QEMU_MIGRATION_SOURCE},\n\n    {.typedParam = VIR_MIGRATE_PARAM_COMPRESSION_MT_LEVEL,\n     .param = QEMU_MIGRATION_PARAM_COMPRESS_LEVEL,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_COMPRESSION_MT_THREADS,\n     .param = QEMU_MIGRATION_PARAM_COMPRESS_THREADS,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_COMPRESSION_MT_DTHREADS,\n     .param = QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_COMPRESSION_XBZRLE_CACHE,\n     .param = QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_BANDWIDTH_POSTCOPY,\n     .unit = 1024 * 1024, /* MiB/s */\n     .param = QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_PARALLEL_CONNECTIONS,\n     .param = QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_TLS_DESTINATION,\n     .param = QEMU_MIGRATION_PARAM_TLS_HOSTNAME,\n     .party = QEMU_MIGRATION_SOURCE},\n};\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nint\nqemuMigrationParamsDump(qemuMigrationParamsPtr migParams,\n                        virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        unsigned long *flags)\n{\n    size_t i;\n\n    if (migParams->compMethods == 1ULL << QEMU_MIGRATION_COMPRESS_XBZRLE &&\n        !migParams->params[QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE].set) {\n        *flags |= VIR_MIGRATE_COMPRESSED;\n        return 0;\n    }\n\n    for (i = 0; i < QEMU_MIGRATION_COMPRESS_LAST; ++i) {\n        if ((migParams->compMethods & (1ULL << i)) &&\n            virTypedParamsAddString(params, nparams, maxparams,\n                                    VIR_MIGRATE_PARAM_COMPRESSION,\n                                    qemuMigrationCompressMethodTypeToString(i)) < 0)\n            return -1;\n    }\n\n    for (i = 0; i < G_N_ELEMENTS(qemuMigrationParamsTPMap); i++) {\n        const qemuMigrationParamsTPMapItem *item = &qemuMigrationParamsTPMap[i];\n\n        if (!(item->party & QEMU_MIGRATION_DESTINATION))\n            continue;\n\n        switch (qemuMigrationParamTypes[item->param]) {\n        case QEMU_MIGRATION_PARAM_TYPE_INT:\n            if (qemuMigrationParamsSetTPInt(migParams, item->param,\n                                            params, nparams, maxparams,\n                                            item->typedParam, item->unit) < 0)\n                return -1;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_ULL:\n            if (qemuMigrationParamsSetTPULL(migParams, item->param,\n                                            params, nparams, maxparams,\n                                            item->typedParam, item->unit) < 0)\n                return -1;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_BOOL:\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_STRING:\n            if (qemuMigrationParamsSetTPString(migParams, item->param,\n                                               params, nparams, maxparams,\n                                               item->typedParam) < 0)\n                return -1;\n            break;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuMigrationParamsFromFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "537-618",
    "snippet": "qemuMigrationParamsPtr\nqemuMigrationParamsFromFlags(virTypedParameterPtr params,\n                             int nparams,\n                             unsigned long flags,\n                             qemuMigrationParty party)\n{\n    qemuMigrationParamsPtr migParams;\n    size_t i;\n\n    if (!(migParams = qemuMigrationParamsNew()))\n        return NULL;\n\n    for (i = 0; i < G_N_ELEMENTS(qemuMigrationParamsFlagMap); i++) {\n        qemuMigrationCapability cap = qemuMigrationParamsFlagMap[i].cap;\n\n        if (qemuMigrationParamsFlagMap[i].party & party &&\n            flags & qemuMigrationParamsFlagMap[i].flag) {\n            VIR_DEBUG(\"Enabling migration capability '%s'\",\n                      qemuMigrationCapabilityTypeToString(cap));\n            ignore_value(virBitmapSetBit(migParams->caps, cap));\n        }\n    }\n\n    for (i = 0; i < G_N_ELEMENTS(qemuMigrationParamsTPMap); i++) {\n        const qemuMigrationParamsTPMapItem *item = &qemuMigrationParamsTPMap[i];\n\n        if (!(item->party & party))\n            continue;\n\n        VIR_DEBUG(\"Setting migration parameter '%s' from '%s'\",\n                  qemuMigrationParamTypeToString(item->param), item->typedParam);\n\n        switch (qemuMigrationParamTypes[item->param]) {\n        case QEMU_MIGRATION_PARAM_TYPE_INT:\n            if (qemuMigrationParamsGetTPInt(migParams, item->param, params,\n                                            nparams, item->typedParam,\n                                            item->unit) < 0)\n                goto error;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_ULL:\n            if (qemuMigrationParamsGetTPULL(migParams, item->param, params,\n                                            nparams, item->typedParam,\n                                            item->unit) < 0)\n                goto error;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_BOOL:\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_STRING:\n            if (qemuMigrationParamsGetTPString(migParams, item->param, params,\n                                               nparams, item->typedParam) < 0)\n                goto error;\n            break;\n        }\n    }\n\n    if ((migParams->params[QEMU_MIGRATION_PARAM_THROTTLE_INITIAL].set ||\n         migParams->params[QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT].set) &&\n        !(flags & VIR_MIGRATE_AUTO_CONVERGE)) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Turn auto convergence on to tune it\"));\n        goto error;\n    }\n\n    if (migParams->params[QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS].set &&\n        !(flags & VIR_MIGRATE_PARALLEL)) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Turn parallel migration on to tune it\"));\n        goto error;\n    }\n\n    if (qemuMigrationParamsSetCompression(params, nparams, flags, migParams) < 0)\n        goto error;\n\n    return migParams;\n\n error:\n    qemuMigrationParamsFree(migParams);\n    return NULL;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const qemuMigrationParamsFlagMapItem qemuMigrationParamsFlagMap[] = {\n    {VIR_MIGRATE_RDMA_PIN_ALL,\n     QEMU_MIGRATION_CAP_RDMA_PIN_ALL,\n     QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {VIR_MIGRATE_AUTO_CONVERGE,\n     QEMU_MIGRATION_CAP_AUTO_CONVERGE,\n     QEMU_MIGRATION_SOURCE},\n\n    {VIR_MIGRATE_POSTCOPY,\n     QEMU_MIGRATION_CAP_POSTCOPY,\n     QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {VIR_MIGRATE_PARALLEL,\n     QEMU_MIGRATION_CAP_MULTIFD,\n     QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n};",
      "static const qemuMigrationParamsTPMapItem qemuMigrationParamsTPMap[] = {\n    {.typedParam = VIR_MIGRATE_PARAM_AUTO_CONVERGE_INITIAL,\n     .param = QEMU_MIGRATION_PARAM_THROTTLE_INITIAL,\n     .party = QEMU_MIGRATION_SOURCE},\n\n    {.typedParam = VIR_MIGRATE_PARAM_AUTO_CONVERGE_INCREMENT,\n     .param = QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT,\n     .party = QEMU_MIGRATION_SOURCE},\n\n    {.typedParam = VIR_MIGRATE_PARAM_COMPRESSION_MT_LEVEL,\n     .param = QEMU_MIGRATION_PARAM_COMPRESS_LEVEL,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_COMPRESSION_MT_THREADS,\n     .param = QEMU_MIGRATION_PARAM_COMPRESS_THREADS,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_COMPRESSION_MT_DTHREADS,\n     .param = QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_COMPRESSION_XBZRLE_CACHE,\n     .param = QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_BANDWIDTH_POSTCOPY,\n     .unit = 1024 * 1024, /* MiB/s */\n     .param = QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_PARALLEL_CONNECTIONS,\n     .param = QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_TLS_DESTINATION,\n     .param = QEMU_MIGRATION_PARAM_TLS_HOSTNAME,\n     .party = QEMU_MIGRATION_SOURCE},\n};",
      "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuMigrationParamsFree",
          "args": [
            "migParams"
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "264-279",
          "snippet": "void\nqemuMigrationParamsFree(qemuMigrationParamsPtr migParams)\n{\n    size_t i;\n\n    if (!migParams)\n        return;\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        if (qemuMigrationParamTypes[i] == QEMU_MIGRATION_PARAM_TYPE_STRING)\n            VIR_FREE(migParams->params[i].value.s);\n    }\n\n    virBitmapFree(migParams->caps);\n    VIR_FREE(migParams);\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nvoid\nqemuMigrationParamsFree(qemuMigrationParamsPtr migParams)\n{\n    size_t i;\n\n    if (!migParams)\n        return;\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        if (qemuMigrationParamTypes[i] == QEMU_MIGRATION_PARAM_TYPE_STRING)\n            VIR_FREE(migParams->params[i].value.s);\n    }\n\n    virBitmapFree(migParams->caps);\n    VIR_FREE(migParams);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsSetCompression",
          "args": [
            "params",
            "nparams",
            "flags",
            "migParams"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsSetCompression",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "464-534",
          "snippet": "static int\nqemuMigrationParamsSetCompression(virTypedParameterPtr params,\n                                  int nparams,\n                                  unsigned long flags,\n                                  qemuMigrationParamsPtr migParams)\n{\n    size_t i;\n    int method;\n    qemuMigrationCapability cap;\n\n    for (i = 0; i < nparams; i++) {\n        if (STRNEQ(params[i].field, VIR_MIGRATE_PARAM_COMPRESSION))\n            continue;\n\n        method = qemuMigrationCompressMethodTypeFromString(params[i].value.s);\n        if (method < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Unsupported compression method '%s'\"),\n                           params[i].value.s);\n            return -1;\n        }\n\n        if (migParams->compMethods & (1ULL << method)) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Compression method '%s' is specified twice\"),\n                           params[i].value.s);\n            return -1;\n        }\n\n        migParams->compMethods |= 1ULL << method;\n\n        switch ((qemuMigrationCompressMethod) method) {\n        case QEMU_MIGRATION_COMPRESS_XBZRLE:\n            cap = QEMU_MIGRATION_CAP_XBZRLE;\n            break;\n\n        case QEMU_MIGRATION_COMPRESS_MT:\n            cap = QEMU_MIGRATION_CAP_COMPRESS;\n            break;\n\n        case QEMU_MIGRATION_COMPRESS_LAST:\n        default:\n            continue;\n        }\n        ignore_value(virBitmapSetBit(migParams->caps, cap));\n    }\n\n    if ((migParams->params[QEMU_MIGRATION_PARAM_COMPRESS_LEVEL].set ||\n         migParams->params[QEMU_MIGRATION_PARAM_COMPRESS_THREADS].set ||\n         migParams->params[QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS].set) &&\n        !(migParams->compMethods & (1ULL << QEMU_MIGRATION_COMPRESS_MT))) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Turn multithread compression on to tune it\"));\n        return -1;\n    }\n\n    if (migParams->params[QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE].set &&\n        !(migParams->compMethods & (1ULL << QEMU_MIGRATION_COMPRESS_XBZRLE))) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Turn xbzrle compression on to tune it\"));\n        return -1;\n    }\n\n    if (!migParams->compMethods && (flags & VIR_MIGRATE_COMPRESSED)) {\n        migParams->compMethods = 1ULL << QEMU_MIGRATION_COMPRESS_XBZRLE;\n        ignore_value(virBitmapSetBit(migParams->caps,\n                                     QEMU_MIGRATION_CAP_XBZRLE));\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int\nqemuMigrationParamsSetCompression(virTypedParameterPtr params,\n                                  int nparams,\n                                  unsigned long flags,\n                                  qemuMigrationParamsPtr migParams)\n{\n    size_t i;\n    int method;\n    qemuMigrationCapability cap;\n\n    for (i = 0; i < nparams; i++) {\n        if (STRNEQ(params[i].field, VIR_MIGRATE_PARAM_COMPRESSION))\n            continue;\n\n        method = qemuMigrationCompressMethodTypeFromString(params[i].value.s);\n        if (method < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Unsupported compression method '%s'\"),\n                           params[i].value.s);\n            return -1;\n        }\n\n        if (migParams->compMethods & (1ULL << method)) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Compression method '%s' is specified twice\"),\n                           params[i].value.s);\n            return -1;\n        }\n\n        migParams->compMethods |= 1ULL << method;\n\n        switch ((qemuMigrationCompressMethod) method) {\n        case QEMU_MIGRATION_COMPRESS_XBZRLE:\n            cap = QEMU_MIGRATION_CAP_XBZRLE;\n            break;\n\n        case QEMU_MIGRATION_COMPRESS_MT:\n            cap = QEMU_MIGRATION_CAP_COMPRESS;\n            break;\n\n        case QEMU_MIGRATION_COMPRESS_LAST:\n        default:\n            continue;\n        }\n        ignore_value(virBitmapSetBit(migParams->caps, cap));\n    }\n\n    if ((migParams->params[QEMU_MIGRATION_PARAM_COMPRESS_LEVEL].set ||\n         migParams->params[QEMU_MIGRATION_PARAM_COMPRESS_THREADS].set ||\n         migParams->params[QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS].set) &&\n        !(migParams->compMethods & (1ULL << QEMU_MIGRATION_COMPRESS_MT))) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Turn multithread compression on to tune it\"));\n        return -1;\n    }\n\n    if (migParams->params[QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE].set &&\n        !(migParams->compMethods & (1ULL << QEMU_MIGRATION_COMPRESS_XBZRLE))) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Turn xbzrle compression on to tune it\"));\n        return -1;\n    }\n\n    if (!migParams->compMethods && (flags & VIR_MIGRATE_COMPRESSED)) {\n        migParams->compMethods = 1ULL << QEMU_MIGRATION_COMPRESS_XBZRLE;\n        ignore_value(virBitmapSetBit(migParams->caps,\n                                     QEMU_MIGRATION_CAP_XBZRLE));\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"Turn parallel migration on to tune it\")"
          ],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Turn parallel migration on to tune it\""
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"Turn auto convergence on to tune it\")"
          ],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsGetTPString",
          "args": [
            "migParams",
            "item->param",
            "params",
            "nparams",
            "item->typedParam"
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsGetTPString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "419-441",
          "snippet": "static int\nqemuMigrationParamsGetTPString(qemuMigrationParamsPtr migParams,\n                               qemuMigrationParam param,\n                               virTypedParameterPtr params,\n                               int nparams,\n                               const char *name)\n{\n    const char *value = NULL;\n    int rc;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_STRING) < 0)\n        return -1;\n\n    if (!params)\n        return 0;\n\n    if ((rc = virTypedParamsGetString(params, nparams, name, &value)) < 0)\n        return -1;\n\n    migParams->params[param].value.s = g_strdup(value);\n    migParams->params[param].set = !!rc;\n    return 0;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int\nqemuMigrationParamsGetTPString(qemuMigrationParamsPtr migParams,\n                               qemuMigrationParam param,\n                               virTypedParameterPtr params,\n                               int nparams,\n                               const char *name)\n{\n    const char *value = NULL;\n    int rc;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_STRING) < 0)\n        return -1;\n\n    if (!params)\n        return 0;\n\n    if ((rc = virTypedParamsGetString(params, nparams, name, &value)) < 0)\n        return -1;\n\n    migParams->params[param].value.s = g_strdup(value);\n    migParams->params[param].set = !!rc;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsGetTPULL",
          "args": [
            "migParams",
            "item->param",
            "params",
            "nparams",
            "item->typedParam",
            "item->unit"
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsGetTPULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "358-391",
          "snippet": "static int\nqemuMigrationParamsGetTPULL(qemuMigrationParamsPtr migParams,\n                            qemuMigrationParam param,\n                            virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            unsigned int unit)\n{\n    int rc;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_ULL) < 0)\n        return -1;\n\n    if (!params)\n        return 0;\n\n    if ((rc = virTypedParamsGetULLong(params, nparams, name,\n                                      &migParams->params[param].value.ull)) < 0)\n        return -1;\n\n    if (unit > 0) {\n        unsigned long long max = ULLONG_MAX / unit;\n        if (migParams->params[param].value.ull > max) {\n            virReportError(VIR_ERR_OVERFLOW,\n                           _(\"migration parameter '%s' must be less than %llu\"),\n                           name, max + 1);\n            return -1;\n        }\n        migParams->params[param].value.ull *= unit;\n    }\n\n    migParams->params[param].set = !!rc;\n    return 0;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int\nqemuMigrationParamsGetTPULL(qemuMigrationParamsPtr migParams,\n                            qemuMigrationParam param,\n                            virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            unsigned int unit)\n{\n    int rc;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_ULL) < 0)\n        return -1;\n\n    if (!params)\n        return 0;\n\n    if ((rc = virTypedParamsGetULLong(params, nparams, name,\n                                      &migParams->params[param].value.ull)) < 0)\n        return -1;\n\n    if (unit > 0) {\n        unsigned long long max = ULLONG_MAX / unit;\n        if (migParams->params[param].value.ull > max) {\n            virReportError(VIR_ERR_OVERFLOW,\n                           _(\"migration parameter '%s' must be less than %llu\"),\n                           name, max + 1);\n            return -1;\n        }\n        migParams->params[param].value.ull *= unit;\n    }\n\n    migParams->params[param].set = !!rc;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsGetTPInt",
          "args": [
            "migParams",
            "item->param",
            "params",
            "nparams",
            "item->typedParam",
            "item->unit"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsGetTPInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "297-330",
          "snippet": "static int\nqemuMigrationParamsGetTPInt(qemuMigrationParamsPtr migParams,\n                            qemuMigrationParam param,\n                            virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            unsigned int unit)\n{\n    int rc;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_INT) < 0)\n        return -1;\n\n    if (!params)\n        return 0;\n\n    if ((rc = virTypedParamsGetInt(params, nparams, name,\n                                   &migParams->params[param].value.i)) < 0)\n        return -1;\n\n    if (unit > 0) {\n        unsigned int max = UINT_MAX / unit;\n        if (migParams->params[param].value.i > max) {\n            virReportError(VIR_ERR_OVERFLOW,\n                           _(\"migration parameter '%s' must be less than %u\"),\n                           name, max + 1);\n            return -1;\n        }\n        migParams->params[param].value.i *= unit;\n    }\n\n    migParams->params[param].set = !!rc;\n    return 0;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int\nqemuMigrationParamsGetTPInt(qemuMigrationParamsPtr migParams,\n                            qemuMigrationParam param,\n                            virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            unsigned int unit)\n{\n    int rc;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_INT) < 0)\n        return -1;\n\n    if (!params)\n        return 0;\n\n    if ((rc = virTypedParamsGetInt(params, nparams, name,\n                                   &migParams->params[param].value.i)) < 0)\n        return -1;\n\n    if (unit > 0) {\n        unsigned int max = UINT_MAX / unit;\n        if (migParams->params[param].value.i > max) {\n            virReportError(VIR_ERR_OVERFLOW,\n                           _(\"migration parameter '%s' must be less than %u\"),\n                           name, max + 1);\n            return -1;\n        }\n        migParams->params[param].value.i *= unit;\n    }\n\n    migParams->params[param].set = !!rc;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Setting migration parameter '%s' from '%s'\"",
            "qemuMigrationParamTypeToString(item->param)",
            "item->typedParam"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamTypeToString",
          "args": [
            "item->param"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "qemuMigrationParamsTPMap"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapSetBit(migParams->caps, cap)"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "migParams->caps",
            "cap"
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Enabling migration capability '%s'\"",
            "qemuMigrationCapabilityTypeToString(cap)"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMigrationCapabilityTypeToString",
          "args": [
            "cap"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "qemuMigrationParamsFlagMap"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsNew",
          "args": [],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "244-261",
          "snippet": "qemuMigrationParamsPtr\nqemuMigrationParamsNew(void)\n{\n    qemuMigrationParamsPtr params;\n\n    if (VIR_ALLOC(params) < 0)\n        return NULL;\n\n    params->caps = virBitmapNew(QEMU_MIGRATION_CAP_LAST);\n    if (!params->caps)\n        goto error;\n\n    return params;\n\n error:\n    qemuMigrationParamsFree(params);\n    return NULL;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nqemuMigrationParamsPtr\nqemuMigrationParamsNew(void)\n{\n    qemuMigrationParamsPtr params;\n\n    if (VIR_ALLOC(params) < 0)\n        return NULL;\n\n    params->caps = virBitmapNew(QEMU_MIGRATION_CAP_LAST);\n    if (!params->caps)\n        goto error;\n\n    return params;\n\n error:\n    qemuMigrationParamsFree(params);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamsFlagMapItem qemuMigrationParamsFlagMap[] = {\n    {VIR_MIGRATE_RDMA_PIN_ALL,\n     QEMU_MIGRATION_CAP_RDMA_PIN_ALL,\n     QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {VIR_MIGRATE_AUTO_CONVERGE,\n     QEMU_MIGRATION_CAP_AUTO_CONVERGE,\n     QEMU_MIGRATION_SOURCE},\n\n    {VIR_MIGRATE_POSTCOPY,\n     QEMU_MIGRATION_CAP_POSTCOPY,\n     QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {VIR_MIGRATE_PARALLEL,\n     QEMU_MIGRATION_CAP_MULTIFD,\n     QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n};\nstatic const qemuMigrationParamsTPMapItem qemuMigrationParamsTPMap[] = {\n    {.typedParam = VIR_MIGRATE_PARAM_AUTO_CONVERGE_INITIAL,\n     .param = QEMU_MIGRATION_PARAM_THROTTLE_INITIAL,\n     .party = QEMU_MIGRATION_SOURCE},\n\n    {.typedParam = VIR_MIGRATE_PARAM_AUTO_CONVERGE_INCREMENT,\n     .param = QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT,\n     .party = QEMU_MIGRATION_SOURCE},\n\n    {.typedParam = VIR_MIGRATE_PARAM_COMPRESSION_MT_LEVEL,\n     .param = QEMU_MIGRATION_PARAM_COMPRESS_LEVEL,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_COMPRESSION_MT_THREADS,\n     .param = QEMU_MIGRATION_PARAM_COMPRESS_THREADS,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_COMPRESSION_MT_DTHREADS,\n     .param = QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_COMPRESSION_XBZRLE_CACHE,\n     .param = QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_BANDWIDTH_POSTCOPY,\n     .unit = 1024 * 1024, /* MiB/s */\n     .param = QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_PARALLEL_CONNECTIONS,\n     .param = QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS,\n     .party = QEMU_MIGRATION_SOURCE | QEMU_MIGRATION_DESTINATION},\n\n    {.typedParam = VIR_MIGRATE_PARAM_TLS_DESTINATION,\n     .param = QEMU_MIGRATION_PARAM_TLS_HOSTNAME,\n     .party = QEMU_MIGRATION_SOURCE},\n};\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nqemuMigrationParamsPtr\nqemuMigrationParamsFromFlags(virTypedParameterPtr params,\n                             int nparams,\n                             unsigned long flags,\n                             qemuMigrationParty party)\n{\n    qemuMigrationParamsPtr migParams;\n    size_t i;\n\n    if (!(migParams = qemuMigrationParamsNew()))\n        return NULL;\n\n    for (i = 0; i < G_N_ELEMENTS(qemuMigrationParamsFlagMap); i++) {\n        qemuMigrationCapability cap = qemuMigrationParamsFlagMap[i].cap;\n\n        if (qemuMigrationParamsFlagMap[i].party & party &&\n            flags & qemuMigrationParamsFlagMap[i].flag) {\n            VIR_DEBUG(\"Enabling migration capability '%s'\",\n                      qemuMigrationCapabilityTypeToString(cap));\n            ignore_value(virBitmapSetBit(migParams->caps, cap));\n        }\n    }\n\n    for (i = 0; i < G_N_ELEMENTS(qemuMigrationParamsTPMap); i++) {\n        const qemuMigrationParamsTPMapItem *item = &qemuMigrationParamsTPMap[i];\n\n        if (!(item->party & party))\n            continue;\n\n        VIR_DEBUG(\"Setting migration parameter '%s' from '%s'\",\n                  qemuMigrationParamTypeToString(item->param), item->typedParam);\n\n        switch (qemuMigrationParamTypes[item->param]) {\n        case QEMU_MIGRATION_PARAM_TYPE_INT:\n            if (qemuMigrationParamsGetTPInt(migParams, item->param, params,\n                                            nparams, item->typedParam,\n                                            item->unit) < 0)\n                goto error;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_ULL:\n            if (qemuMigrationParamsGetTPULL(migParams, item->param, params,\n                                            nparams, item->typedParam,\n                                            item->unit) < 0)\n                goto error;\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_BOOL:\n            break;\n\n        case QEMU_MIGRATION_PARAM_TYPE_STRING:\n            if (qemuMigrationParamsGetTPString(migParams, item->param, params,\n                                               nparams, item->typedParam) < 0)\n                goto error;\n            break;\n        }\n    }\n\n    if ((migParams->params[QEMU_MIGRATION_PARAM_THROTTLE_INITIAL].set ||\n         migParams->params[QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT].set) &&\n        !(flags & VIR_MIGRATE_AUTO_CONVERGE)) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Turn auto convergence on to tune it\"));\n        goto error;\n    }\n\n    if (migParams->params[QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS].set &&\n        !(flags & VIR_MIGRATE_PARALLEL)) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Turn parallel migration on to tune it\"));\n        goto error;\n    }\n\n    if (qemuMigrationParamsSetCompression(params, nparams, flags, migParams) < 0)\n        goto error;\n\n    return migParams;\n\n error:\n    qemuMigrationParamsFree(migParams);\n    return NULL;\n}"
  },
  {
    "function_name": "qemuMigrationParamsSetCompression",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "464-534",
    "snippet": "static int\nqemuMigrationParamsSetCompression(virTypedParameterPtr params,\n                                  int nparams,\n                                  unsigned long flags,\n                                  qemuMigrationParamsPtr migParams)\n{\n    size_t i;\n    int method;\n    qemuMigrationCapability cap;\n\n    for (i = 0; i < nparams; i++) {\n        if (STRNEQ(params[i].field, VIR_MIGRATE_PARAM_COMPRESSION))\n            continue;\n\n        method = qemuMigrationCompressMethodTypeFromString(params[i].value.s);\n        if (method < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Unsupported compression method '%s'\"),\n                           params[i].value.s);\n            return -1;\n        }\n\n        if (migParams->compMethods & (1ULL << method)) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Compression method '%s' is specified twice\"),\n                           params[i].value.s);\n            return -1;\n        }\n\n        migParams->compMethods |= 1ULL << method;\n\n        switch ((qemuMigrationCompressMethod) method) {\n        case QEMU_MIGRATION_COMPRESS_XBZRLE:\n            cap = QEMU_MIGRATION_CAP_XBZRLE;\n            break;\n\n        case QEMU_MIGRATION_COMPRESS_MT:\n            cap = QEMU_MIGRATION_CAP_COMPRESS;\n            break;\n\n        case QEMU_MIGRATION_COMPRESS_LAST:\n        default:\n            continue;\n        }\n        ignore_value(virBitmapSetBit(migParams->caps, cap));\n    }\n\n    if ((migParams->params[QEMU_MIGRATION_PARAM_COMPRESS_LEVEL].set ||\n         migParams->params[QEMU_MIGRATION_PARAM_COMPRESS_THREADS].set ||\n         migParams->params[QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS].set) &&\n        !(migParams->compMethods & (1ULL << QEMU_MIGRATION_COMPRESS_MT))) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Turn multithread compression on to tune it\"));\n        return -1;\n    }\n\n    if (migParams->params[QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE].set &&\n        !(migParams->compMethods & (1ULL << QEMU_MIGRATION_COMPRESS_XBZRLE))) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Turn xbzrle compression on to tune it\"));\n        return -1;\n    }\n\n    if (!migParams->compMethods && (flags & VIR_MIGRATE_COMPRESSED)) {\n        migParams->compMethods = 1ULL << QEMU_MIGRATION_COMPRESS_XBZRLE;\n        ignore_value(virBitmapSetBit(migParams->caps,\n                                     QEMU_MIGRATION_CAP_XBZRLE));\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapSetBit(migParams->caps,\n                                     QEMU_MIGRATION_CAP_XBZRLE)"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "migParams->caps",
            "QEMU_MIGRATION_CAP_XBZRLE"
          ],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"Turn xbzrle compression on to tune it\")"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Turn xbzrle compression on to tune it\""
          ],
          "line": 523
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"Turn multithread compression on to tune it\")"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapSetBit(migParams->caps, cap)"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Compression method '%s' is specified twice\")",
            "params[i].value.s"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Unsupported compression method '%s'\")",
            "params[i].value.s"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMigrationCompressMethodTypeFromString",
          "args": [
            "params[i].value.s"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "params[i].field",
            "VIR_MIGRATE_PARAM_COMPRESSION"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int\nqemuMigrationParamsSetCompression(virTypedParameterPtr params,\n                                  int nparams,\n                                  unsigned long flags,\n                                  qemuMigrationParamsPtr migParams)\n{\n    size_t i;\n    int method;\n    qemuMigrationCapability cap;\n\n    for (i = 0; i < nparams; i++) {\n        if (STRNEQ(params[i].field, VIR_MIGRATE_PARAM_COMPRESSION))\n            continue;\n\n        method = qemuMigrationCompressMethodTypeFromString(params[i].value.s);\n        if (method < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Unsupported compression method '%s'\"),\n                           params[i].value.s);\n            return -1;\n        }\n\n        if (migParams->compMethods & (1ULL << method)) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Compression method '%s' is specified twice\"),\n                           params[i].value.s);\n            return -1;\n        }\n\n        migParams->compMethods |= 1ULL << method;\n\n        switch ((qemuMigrationCompressMethod) method) {\n        case QEMU_MIGRATION_COMPRESS_XBZRLE:\n            cap = QEMU_MIGRATION_CAP_XBZRLE;\n            break;\n\n        case QEMU_MIGRATION_COMPRESS_MT:\n            cap = QEMU_MIGRATION_CAP_COMPRESS;\n            break;\n\n        case QEMU_MIGRATION_COMPRESS_LAST:\n        default:\n            continue;\n        }\n        ignore_value(virBitmapSetBit(migParams->caps, cap));\n    }\n\n    if ((migParams->params[QEMU_MIGRATION_PARAM_COMPRESS_LEVEL].set ||\n         migParams->params[QEMU_MIGRATION_PARAM_COMPRESS_THREADS].set ||\n         migParams->params[QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS].set) &&\n        !(migParams->compMethods & (1ULL << QEMU_MIGRATION_COMPRESS_MT))) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Turn multithread compression on to tune it\"));\n        return -1;\n    }\n\n    if (migParams->params[QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE].set &&\n        !(migParams->compMethods & (1ULL << QEMU_MIGRATION_COMPRESS_XBZRLE))) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Turn xbzrle compression on to tune it\"));\n        return -1;\n    }\n\n    if (!migParams->compMethods && (flags & VIR_MIGRATE_COMPRESSED)) {\n        migParams->compMethods = 1ULL << QEMU_MIGRATION_COMPRESS_XBZRLE;\n        ignore_value(virBitmapSetBit(migParams->caps,\n                                     QEMU_MIGRATION_CAP_XBZRLE));\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuMigrationParamsSetTPString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "444-460",
    "snippet": "static int\nqemuMigrationParamsSetTPString(qemuMigrationParamsPtr migParams,\n                               qemuMigrationParam param,\n                               virTypedParameterPtr *params,\n                               int *nparams,\n                               int *maxparams,\n                               const char *name)\n{\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_STRING) < 0)\n        return -1;\n\n    if (!migParams->params[param].set)\n        return 0;\n\n    return virTypedParamsAddString(params, nparams, maxparams, name,\n                                   migParams->params[param].value.s);\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsAddString",
          "args": [
            "params",
            "nparams",
            "maxparams",
            "name",
            "migParams->params[param].value.s"
          ],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "768-788",
          "snippet": "int\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsCheckType",
          "args": [
            "param",
            "QEMU_MIGRATION_PARAM_TYPE_STRING"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsCheckType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "282-294",
          "snippet": "static int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nstatic int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int\nqemuMigrationParamsSetTPString(qemuMigrationParamsPtr migParams,\n                               qemuMigrationParam param,\n                               virTypedParameterPtr *params,\n                               int *nparams,\n                               int *maxparams,\n                               const char *name)\n{\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_STRING) < 0)\n        return -1;\n\n    if (!migParams->params[param].set)\n        return 0;\n\n    return virTypedParamsAddString(params, nparams, maxparams, name,\n                                   migParams->params[param].value.s);\n}"
  },
  {
    "function_name": "qemuMigrationParamsGetTPString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "419-441",
    "snippet": "static int\nqemuMigrationParamsGetTPString(qemuMigrationParamsPtr migParams,\n                               qemuMigrationParam param,\n                               virTypedParameterPtr params,\n                               int nparams,\n                               const char *name)\n{\n    const char *value = NULL;\n    int rc;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_STRING) < 0)\n        return -1;\n\n    if (!params)\n        return 0;\n\n    if ((rc = virTypedParamsGetString(params, nparams, name, &value)) < 0)\n        return -1;\n\n    migParams->params[param].value.s = g_strdup(value);\n    migParams->params[param].set = !!rc;\n    return 0;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "value"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetString",
          "args": [
            "params",
            "nparams",
            "name",
            "&value"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "432-467",
          "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsCheckType",
          "args": [
            "param",
            "QEMU_MIGRATION_PARAM_TYPE_STRING"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsCheckType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "282-294",
          "snippet": "static int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nstatic int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int\nqemuMigrationParamsGetTPString(qemuMigrationParamsPtr migParams,\n                               qemuMigrationParam param,\n                               virTypedParameterPtr params,\n                               int nparams,\n                               const char *name)\n{\n    const char *value = NULL;\n    int rc;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_STRING) < 0)\n        return -1;\n\n    if (!params)\n        return 0;\n\n    if ((rc = virTypedParamsGetString(params, nparams, name, &value)) < 0)\n        return -1;\n\n    migParams->params[param].value.s = g_strdup(value);\n    migParams->params[param].set = !!rc;\n    return 0;\n}"
  },
  {
    "function_name": "qemuMigrationParamsSetTPULL",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "394-416",
    "snippet": "static int\nqemuMigrationParamsSetTPULL(qemuMigrationParamsPtr migParams,\n                            qemuMigrationParam param,\n                            virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            unsigned int unit)\n{\n    unsigned long long value;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_ULL) < 0)\n        return -1;\n\n    if (!migParams->params[param].set)\n        return 0;\n\n    value = migParams->params[param].value.ull;\n    if (unit > 0)\n        value /= unit;\n\n    return virTypedParamsAddULLong(params, nparams, maxparams, name, value);\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsAddULLong",
          "args": [
            "params",
            "nparams",
            "maxparams",
            "name",
            "value"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "578-604",
          "snippet": "int\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsCheckType",
          "args": [
            "param",
            "QEMU_MIGRATION_PARAM_TYPE_ULL"
          ],
          "line": 405
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsCheckType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "282-294",
          "snippet": "static int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nstatic int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int\nqemuMigrationParamsSetTPULL(qemuMigrationParamsPtr migParams,\n                            qemuMigrationParam param,\n                            virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            unsigned int unit)\n{\n    unsigned long long value;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_ULL) < 0)\n        return -1;\n\n    if (!migParams->params[param].set)\n        return 0;\n\n    value = migParams->params[param].value.ull;\n    if (unit > 0)\n        value /= unit;\n\n    return virTypedParamsAddULLong(params, nparams, maxparams, name, value);\n}"
  },
  {
    "function_name": "qemuMigrationParamsGetTPULL",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "358-391",
    "snippet": "static int\nqemuMigrationParamsGetTPULL(qemuMigrationParamsPtr migParams,\n                            qemuMigrationParam param,\n                            virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            unsigned int unit)\n{\n    int rc;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_ULL) < 0)\n        return -1;\n\n    if (!params)\n        return 0;\n\n    if ((rc = virTypedParamsGetULLong(params, nparams, name,\n                                      &migParams->params[param].value.ull)) < 0)\n        return -1;\n\n    if (unit > 0) {\n        unsigned long long max = ULLONG_MAX / unit;\n        if (migParams->params[param].value.ull > max) {\n            virReportError(VIR_ERR_OVERFLOW,\n                           _(\"migration parameter '%s' must be less than %llu\"),\n                           name, max + 1);\n            return -1;\n        }\n        migParams->params[param].value.ull *= unit;\n    }\n\n    migParams->params[param].set = !!rc;\n    return 0;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OVERFLOW",
            "_(\"migration parameter '%s' must be less than %llu\")",
            "name",
            "max + 1"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"migration parameter '%s' must be less than %llu\""
          ],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetULLong",
          "args": [
            "params",
            "nparams",
            "name",
            "&migParams->params[param].value.ull"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "288-306",
          "snippet": "int\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsCheckType",
          "args": [
            "param",
            "QEMU_MIGRATION_PARAM_TYPE_ULL"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsCheckType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "282-294",
          "snippet": "static int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nstatic int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int\nqemuMigrationParamsGetTPULL(qemuMigrationParamsPtr migParams,\n                            qemuMigrationParam param,\n                            virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            unsigned int unit)\n{\n    int rc;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_ULL) < 0)\n        return -1;\n\n    if (!params)\n        return 0;\n\n    if ((rc = virTypedParamsGetULLong(params, nparams, name,\n                                      &migParams->params[param].value.ull)) < 0)\n        return -1;\n\n    if (unit > 0) {\n        unsigned long long max = ULLONG_MAX / unit;\n        if (migParams->params[param].value.ull > max) {\n            virReportError(VIR_ERR_OVERFLOW,\n                           _(\"migration parameter '%s' must be less than %llu\"),\n                           name, max + 1);\n            return -1;\n        }\n        migParams->params[param].value.ull *= unit;\n    }\n\n    migParams->params[param].set = !!rc;\n    return 0;\n}"
  },
  {
    "function_name": "qemuMigrationParamsSetTPInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "333-355",
    "snippet": "static int\nqemuMigrationParamsSetTPInt(qemuMigrationParamsPtr migParams,\n                            qemuMigrationParam param,\n                            virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            unsigned int unit)\n{\n    int value;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_INT) < 0)\n        return -1;\n\n    if (!migParams->params[param].set)\n        return 0;\n\n    value = migParams->params[param].value.i;\n    if (unit > 0)\n        value /= unit;\n\n    return virTypedParamsAddInt(params, nparams, maxparams, name, value);\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsAddInt",
          "args": [
            "params",
            "nparams",
            "maxparams",
            "name",
            "value"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "437-463",
          "snippet": "int\nvirTypedParamsAddInt(virTypedParameterPtr *params,\n                     int *nparams,\n                     int *maxparams,\n                     const char *name,\n                     int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_INT, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddInt(virTypedParameterPtr *params,\n                     int *nparams,\n                     int *maxparams,\n                     const char *name,\n                     int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_INT, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsCheckType",
          "args": [
            "param",
            "QEMU_MIGRATION_PARAM_TYPE_INT"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsCheckType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "282-294",
          "snippet": "static int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nstatic int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int\nqemuMigrationParamsSetTPInt(qemuMigrationParamsPtr migParams,\n                            qemuMigrationParam param,\n                            virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            unsigned int unit)\n{\n    int value;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_INT) < 0)\n        return -1;\n\n    if (!migParams->params[param].set)\n        return 0;\n\n    value = migParams->params[param].value.i;\n    if (unit > 0)\n        value /= unit;\n\n    return virTypedParamsAddInt(params, nparams, maxparams, name, value);\n}"
  },
  {
    "function_name": "qemuMigrationParamsGetTPInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "297-330",
    "snippet": "static int\nqemuMigrationParamsGetTPInt(qemuMigrationParamsPtr migParams,\n                            qemuMigrationParam param,\n                            virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            unsigned int unit)\n{\n    int rc;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_INT) < 0)\n        return -1;\n\n    if (!params)\n        return 0;\n\n    if ((rc = virTypedParamsGetInt(params, nparams, name,\n                                   &migParams->params[param].value.i)) < 0)\n        return -1;\n\n    if (unit > 0) {\n        unsigned int max = UINT_MAX / unit;\n        if (migParams->params[param].value.i > max) {\n            virReportError(VIR_ERR_OVERFLOW,\n                           _(\"migration parameter '%s' must be less than %u\"),\n                           name, max + 1);\n            return -1;\n        }\n        migParams->params[param].value.i *= unit;\n    }\n\n    migParams->params[param].set = !!rc;\n    return 0;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OVERFLOW",
            "_(\"migration parameter '%s' must be less than %u\")",
            "name",
            "max + 1"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"migration parameter '%s' must be less than %u\""
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetInt",
          "args": [
            "params",
            "nparams",
            "name",
            "&migParams->params[param].value.i"
          ],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "180-198",
          "snippet": "int\nvirTypedParamsGetInt(virTypedParameterPtr params,\n                     int nparams,\n                     const char *name,\n                     int *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_INT);\n    if (value)\n        *value = param->value.i;\n\n    return 1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetInt(virTypedParameterPtr params,\n                     int nparams,\n                     const char *name,\n                     int *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_INT);\n    if (value)\n        *value = param->value.i;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamsCheckType",
          "args": [
            "param",
            "QEMU_MIGRATION_PARAM_TYPE_INT"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsCheckType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "282-294",
          "snippet": "static int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nstatic int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic int\nqemuMigrationParamsGetTPInt(qemuMigrationParamsPtr migParams,\n                            qemuMigrationParam param,\n                            virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            unsigned int unit)\n{\n    int rc;\n\n    if (qemuMigrationParamsCheckType(param, QEMU_MIGRATION_PARAM_TYPE_INT) < 0)\n        return -1;\n\n    if (!params)\n        return 0;\n\n    if ((rc = virTypedParamsGetInt(params, nparams, name,\n                                   &migParams->params[param].value.i)) < 0)\n        return -1;\n\n    if (unit > 0) {\n        unsigned int max = UINT_MAX / unit;\n        if (migParams->params[param].value.i > max) {\n            virReportError(VIR_ERR_OVERFLOW,\n                           _(\"migration parameter '%s' must be less than %u\"),\n                           name, max + 1);\n            return -1;\n        }\n        migParams->params[param].value.i *= unit;\n    }\n\n    migParams->params[param].set = !!rc;\n    return 0;\n}"
  },
  {
    "function_name": "qemuMigrationParamsCheckType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "282-294",
    "snippet": "static int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Type mismatch for '%s' migration parameter\")",
            "qemuMigrationParamTypeToString(param)"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuMigrationParamTypeToString",
          "args": [
            "param"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Type mismatch for '%s' migration parameter\""
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nstatic int\nqemuMigrationParamsCheckType(qemuMigrationParam param,\n                             qemuMigrationParamType type)\n{\n    if (qemuMigrationParamTypes[param] != type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Type mismatch for '%s' migration parameter\"),\n                       qemuMigrationParamTypeToString(param));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuMigrationParamsFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "264-279",
    "snippet": "void\nqemuMigrationParamsFree(qemuMigrationParamsPtr migParams)\n{\n    size_t i;\n\n    if (!migParams)\n        return;\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        if (qemuMigrationParamTypes[i] == QEMU_MIGRATION_PARAM_TYPE_STRING)\n            VIR_FREE(migParams->params[i].value.s);\n    }\n\n    virBitmapFree(migParams->caps);\n    VIR_FREE(migParams);\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "migParams"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapFree",
          "args": [
            "migParams->caps"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "128-135",
          "snippet": "void\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "migParams->params[i].value.s"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nvoid\nqemuMigrationParamsFree(qemuMigrationParamsPtr migParams)\n{\n    size_t i;\n\n    if (!migParams)\n        return;\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        if (qemuMigrationParamTypes[i] == QEMU_MIGRATION_PARAM_TYPE_STRING)\n            VIR_FREE(migParams->params[i].value.s);\n    }\n\n    virBitmapFree(migParams->caps);\n    VIR_FREE(migParams);\n}"
  },
  {
    "function_name": "qemuMigrationParamsNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "244-261",
    "snippet": "qemuMigrationParamsPtr\nqemuMigrationParamsNew(void)\n{\n    qemuMigrationParamsPtr params;\n\n    if (VIR_ALLOC(params) < 0)\n        return NULL;\n\n    params->caps = virBitmapNew(QEMU_MIGRATION_CAP_LAST);\n    if (!params->caps)\n        goto error;\n\n    return params;\n\n error:\n    qemuMigrationParamsFree(params);\n    return NULL;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuMigrationParamsFree",
          "args": [
            "params"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMigrationParamsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
          "lines": "264-279",
          "snippet": "void\nqemuMigrationParamsFree(qemuMigrationParamsPtr migParams)\n{\n    size_t i;\n\n    if (!migParams)\n        return;\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        if (qemuMigrationParamTypes[i] == QEMU_MIGRATION_PARAM_TYPE_STRING)\n            VIR_FREE(migParams->params[i].value.s);\n    }\n\n    virBitmapFree(migParams->caps);\n    VIR_FREE(migParams);\n}",
          "includes": [
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_migration_paramspriv.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamType qemuMigrationParamTypes[] = {\n    [QEMU_MIGRATION_PARAM_COMPRESS_LEVEL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_COMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_DECOMPRESS_THREADS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INITIAL] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_THROTTLE_INCREMENT] = QEMU_MIGRATION_PARAM_TYPE_INT,\n    [QEMU_MIGRATION_PARAM_TLS_CREDS] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_TLS_HOSTNAME] = QEMU_MIGRATION_PARAM_TYPE_STRING,\n    [QEMU_MIGRATION_PARAM_MAX_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_DOWNTIME_LIMIT] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_BLOCK_INCREMENTAL] = QEMU_MIGRATION_PARAM_TYPE_BOOL,\n    [QEMU_MIGRATION_PARAM_XBZRLE_CACHE_SIZE] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MAX_POSTCOPY_BANDWIDTH] = QEMU_MIGRATION_PARAM_TYPE_ULL,\n    [QEMU_MIGRATION_PARAM_MULTIFD_CHANNELS] = QEMU_MIGRATION_PARAM_TYPE_INT,\n};\n\nvoid\nqemuMigrationParamsFree(qemuMigrationParamsPtr migParams)\n{\n    size_t i;\n\n    if (!migParams)\n        return;\n\n    for (i = 0; i < QEMU_MIGRATION_PARAM_LAST; i++) {\n        if (qemuMigrationParamTypes[i] == QEMU_MIGRATION_PARAM_TYPE_STRING)\n            VIR_FREE(migParams->params[i].value.s);\n    }\n\n    virBitmapFree(migParams->caps);\n    VIR_FREE(migParams);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapNew",
          "args": [
            "QEMU_MIGRATION_CAP_LAST"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1144-1168",
          "snippet": "virBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "params"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nqemuMigrationParamsPtr\nqemuMigrationParamsNew(void)\n{\n    qemuMigrationParamsPtr params;\n\n    if (VIR_ALLOC(params) < 0)\n        return NULL;\n\n    params->caps = virBitmapNew(QEMU_MIGRATION_CAP_LAST);\n    if (!params->caps)\n        goto error;\n\n    return params;\n\n error:\n    qemuMigrationParamsFree(params);\n    return NULL;\n}"
  },
  {
    "function_name": "qemuMigrationParamsGetAlwaysOnCaps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_migration_params.c",
    "lines": "224-241",
    "snippet": "virBitmapPtr\nqemuMigrationParamsGetAlwaysOnCaps(qemuMigrationParty party)\n{\n    virBitmapPtr caps = NULL;\n    size_t i;\n\n    if (!(caps = virBitmapNew(QEMU_MIGRATION_CAP_LAST)))\n        return NULL;\n\n    for (i = 0; i < G_N_ELEMENTS(qemuMigrationParamsAlwaysOn); i++) {\n        if (!(qemuMigrationParamsAlwaysOn[i].party & party))\n            continue;\n\n        ignore_value(virBitmapSetBit(caps, qemuMigrationParamsAlwaysOn[i].cap));\n    }\n\n    return caps;\n}",
    "includes": [
      "#include \"qemu_monitor.h\"",
      "#include \"qemu_migration_paramspriv.h\"",
      "#include \"qemu_migration_params.h\"",
      "#include \"qemu_migration.h\"",
      "#include \"qemu_hotplug.h\"",
      "#include \"qemu_alias.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const qemuMigrationParamsAlwaysOnItem qemuMigrationParamsAlwaysOn[] = {\n    {QEMU_MIGRATION_CAP_PAUSE_BEFORE_SWITCHOVER,\n     QEMU_MIGRATION_SOURCE},\n\n    {QEMU_MIGRATION_CAP_LATE_BLOCK_ACTIVATE,\n     QEMU_MIGRATION_DESTINATION},\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapSetBit(caps, qemuMigrationParamsAlwaysOn[i].cap)"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "caps",
            "qemuMigrationParamsAlwaysOn[i].cap"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "qemuMigrationParamsAlwaysOn"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapNew",
          "args": [
            "QEMU_MIGRATION_CAP_LAST"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1144-1168",
          "snippet": "virBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"qemu_monitor.h\"\n#include \"qemu_migration_paramspriv.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_alias.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nstatic const qemuMigrationParamsAlwaysOnItem qemuMigrationParamsAlwaysOn[] = {\n    {QEMU_MIGRATION_CAP_PAUSE_BEFORE_SWITCHOVER,\n     QEMU_MIGRATION_SOURCE},\n\n    {QEMU_MIGRATION_CAP_LATE_BLOCK_ACTIVATE,\n     QEMU_MIGRATION_DESTINATION},\n};\n\nvirBitmapPtr\nqemuMigrationParamsGetAlwaysOnCaps(qemuMigrationParty party)\n{\n    virBitmapPtr caps = NULL;\n    size_t i;\n\n    if (!(caps = virBitmapNew(QEMU_MIGRATION_CAP_LAST)))\n        return NULL;\n\n    for (i = 0; i < G_N_ELEMENTS(qemuMigrationParamsAlwaysOn); i++) {\n        if (!(qemuMigrationParamsAlwaysOn[i].party & party))\n            continue;\n\n        ignore_value(virBitmapSetBit(caps, qemuMigrationParamsAlwaysOn[i].cap));\n    }\n\n    return caps;\n}"
  }
]