[
  {
    "function_name": "bhyveRegister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1741-1750",
    "snippet": "int\nbhyveRegister(void)\n{\n    if (virRegisterConnectDriver(&bhyveConnectDriver,\n                                 true) < 0)\n        return -1;\n    if (virRegisterStateDriver(&bhyveStateDriver) < 0)\n        return -1;\n    return 0;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virConnectDriver bhyveConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"bhyve\", NULL },\n    .hypervisorDriver = &bhyveHypervisorDriver,\n};",
      "static virStateDriver bhyveStateDriver = {\n    .name = \"bhyve\",\n    .stateInitialize = bhyveStateInitialize,\n    .stateCleanup = bhyveStateCleanup,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virRegisterStateDriver",
          "args": [
            "&bhyveStateDriver"
          ],
          "line": 1747
        },
        "resolved": true,
        "details": {
          "function_name": "virRegisterStateDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "588-602",
          "snippet": "int\nvirRegisterStateDriver(virStateDriverPtr driver)\n{\n    virCheckNonNullArgReturn(driver, -1);\n\n    if (virStateDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->name);\n        return -1;\n    }\n\n    virStateDriverTab[virStateDriverTabCount] = driver;\n    return virStateDriverTabCount++;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_DRIVERS 21"
          ],
          "globals_used": [
            "static virStateDriverPtr virStateDriverTab[MAX_DRIVERS];",
            "static int virStateDriverTabCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define MAX_DRIVERS 21\n\nstatic virStateDriverPtr virStateDriverTab[MAX_DRIVERS];\nstatic int virStateDriverTabCount;\n\nint\nvirRegisterStateDriver(virStateDriverPtr driver)\n{\n    virCheckNonNullArgReturn(driver, -1);\n\n    if (virStateDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->name);\n        return -1;\n    }\n\n    virStateDriverTab[virStateDriverTabCount] = driver;\n    return virStateDriverTabCount++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRegisterConnectDriver",
          "args": [
            "&bhyveConnectDriver",
            "true"
          ],
          "line": 1744
        },
        "resolved": true,
        "details": {
          "function_name": "virRegisterConnectDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "515-550",
          "snippet": "int\nvirRegisterConnectDriver(virConnectDriverPtr driver,\n                         bool setSharedDrivers)\n{\n    VIR_DEBUG(\"driver=%p name=%s\", driver,\n              driver ? NULLSTR(driver->hypervisorDriver->name) : \"(null)\");\n\n    virCheckNonNullArgReturn(driver, -1);\n    if (virConnectDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->hypervisorDriver->name);\n        return -1;\n    }\n\n    VIR_DEBUG(\"registering %s as driver %d\",\n           driver->hypervisorDriver->name, virConnectDriverTabCount);\n\n    if (setSharedDrivers) {\n        if (driver->interfaceDriver == NULL)\n            driver->interfaceDriver = virSharedInterfaceDriver;\n        if (driver->networkDriver == NULL)\n            driver->networkDriver = virSharedNetworkDriver;\n        if (driver->nodeDeviceDriver == NULL)\n            driver->nodeDeviceDriver = virSharedNodeDeviceDriver;\n        if (driver->nwfilterDriver == NULL)\n            driver->nwfilterDriver = virSharedNWFilterDriver;\n        if (driver->secretDriver == NULL)\n            driver->secretDriver = virSharedSecretDriver;\n        if (driver->storageDriver == NULL)\n            driver->storageDriver = virSharedStorageDriver;\n    }\n\n    virConnectDriverTab[virConnectDriverTabCount] = driver;\n    return virConnectDriverTabCount++;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_DRIVERS 21"
          ],
          "globals_used": [
            "static virConnectDriverPtr virConnectDriverTab[MAX_DRIVERS];",
            "static int virConnectDriverTabCount;",
            "static virNetworkDriverPtr virSharedNetworkDriver;",
            "static virInterfaceDriverPtr virSharedInterfaceDriver;",
            "static virStorageDriverPtr virSharedStorageDriver;",
            "static virNodeDeviceDriverPtr virSharedNodeDeviceDriver;",
            "static virSecretDriverPtr virSharedSecretDriver;",
            "static virNWFilterDriverPtr virSharedNWFilterDriver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define MAX_DRIVERS 21\n\nstatic virConnectDriverPtr virConnectDriverTab[MAX_DRIVERS];\nstatic int virConnectDriverTabCount;\nstatic virNetworkDriverPtr virSharedNetworkDriver;\nstatic virInterfaceDriverPtr virSharedInterfaceDriver;\nstatic virStorageDriverPtr virSharedStorageDriver;\nstatic virNodeDeviceDriverPtr virSharedNodeDeviceDriver;\nstatic virSecretDriverPtr virSharedSecretDriver;\nstatic virNWFilterDriverPtr virSharedNWFilterDriver;\n\nint\nvirRegisterConnectDriver(virConnectDriverPtr driver,\n                         bool setSharedDrivers)\n{\n    VIR_DEBUG(\"driver=%p name=%s\", driver,\n              driver ? NULLSTR(driver->hypervisorDriver->name) : \"(null)\");\n\n    virCheckNonNullArgReturn(driver, -1);\n    if (virConnectDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->hypervisorDriver->name);\n        return -1;\n    }\n\n    VIR_DEBUG(\"registering %s as driver %d\",\n           driver->hypervisorDriver->name, virConnectDriverTabCount);\n\n    if (setSharedDrivers) {\n        if (driver->interfaceDriver == NULL)\n            driver->interfaceDriver = virSharedInterfaceDriver;\n        if (driver->networkDriver == NULL)\n            driver->networkDriver = virSharedNetworkDriver;\n        if (driver->nodeDeviceDriver == NULL)\n            driver->nodeDeviceDriver = virSharedNodeDeviceDriver;\n        if (driver->nwfilterDriver == NULL)\n            driver->nwfilterDriver = virSharedNWFilterDriver;\n        if (driver->secretDriver == NULL)\n            driver->secretDriver = virSharedSecretDriver;\n        if (driver->storageDriver == NULL)\n            driver->storageDriver = virSharedStorageDriver;\n    }\n\n    virConnectDriverTab[virConnectDriverTabCount] = driver;\n    return virConnectDriverTabCount++;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virConnectDriver bhyveConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"bhyve\", NULL },\n    .hypervisorDriver = &bhyveHypervisorDriver,\n};\nstatic virStateDriver bhyveStateDriver = {\n    .name = \"bhyve\",\n    .stateInitialize = bhyveStateInitialize,\n    .stateCleanup = bhyveStateCleanup,\n};\n\nint\nbhyveRegister(void)\n{\n    if (virRegisterConnectDriver(&bhyveConnectDriver,\n                                 true) < 0)\n        return -1;\n    if (virRegisterStateDriver(&bhyveStateDriver) < 0)\n        return -1;\n    return 0;\n}"
  },
  {
    "function_name": "bhyveConnectGetDomainCapabilities",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1599-1664",
    "snippet": "static char *\nbhyveConnectGetDomainCapabilities(virConnectPtr conn,\n                                  const char *emulatorbin,\n                                  const char *arch_str,\n                                  const char *machine,\n                                  const char *virttype_str,\n                                  unsigned int flags)\n{\n    virDomainCapsPtr caps = NULL;\n    char *ret = NULL;\n    int virttype = VIR_DOMAIN_VIRT_BHYVE;\n    int arch = virArchFromHost(); /* virArch */\n\n    virCheckFlags(0, ret);\n\n    if (virConnectGetDomainCapabilitiesEnsureACL(conn) < 0)\n        return ret;\n\n    if (virttype_str &&\n        (virttype = virDomainVirtTypeFromString(virttype_str)) < 0) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unknown virttype: %s\"),\n                       virttype_str);\n        goto cleanup;\n    }\n\n    if (virttype != VIR_DOMAIN_VIRT_BHYVE) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unknown virttype: %s\"),\n                       virttype_str);\n        goto cleanup;\n    }\n\n    if (arch_str && (arch = virArchFromString(arch_str)) == VIR_ARCH_NONE) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unknown architecture: %s\"),\n                       arch_str);\n        goto cleanup;\n    }\n\n    if (!ARCH_IS_X86(arch)) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       _(\"unsupported architecture: %s\"),\n                       virArchToString(arch));\n        goto cleanup;\n    }\n\n    if (emulatorbin == NULL) {\n        emulatorbin = \"/usr/sbin/bhyve\";\n    } else if (STRNEQ(emulatorbin, \"/usr/sbin/bhyve\")) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unknown emulator binary: %s\"),\n                       emulatorbin);\n        goto cleanup;\n    }\n\n    if (!(caps = virBhyveDomainCapsBuild(conn->privateData, emulatorbin,\n                                         machine, arch, virttype)))\n        goto cleanup;\n\n    ret = virDomainCapsFormat(caps);\n\n cleanup:\n    virObjectUnref(caps);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "caps"
          ],
          "line": 1662
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCapsFormat",
          "args": [
            "caps"
          ],
          "line": 1659
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "585-628",
          "snippet": "char *\nvirDomainCapsFormat(const virDomainCaps *caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    const char *virttype_str = virDomainVirtTypeToString(caps->virttype);\n    const char *arch_str = virArchToString(caps->arch);\n\n    virBufferAddLit(&buf, \"<domainCapabilities>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    virBufferEscapeString(&buf, \"<path>%s</path>\\n\", caps->path);\n    virBufferAsprintf(&buf, \"<domain>%s</domain>\\n\", virttype_str);\n    if (caps->machine)\n        virBufferAsprintf(&buf, \"<machine>%s</machine>\\n\", caps->machine);\n    virBufferAsprintf(&buf, \"<arch>%s</arch>\\n\", arch_str);\n\n    if (caps->maxvcpus)\n        virBufferAsprintf(&buf, \"<vcpu max='%d'/>\\n\", caps->maxvcpus);\n\n    qemuDomainCapsFeatureFormatSimple(&buf, \"iothreads\",\n                                      caps->features[VIR_DOMAIN_CAPS_FEATURE_IOTHREADS]);\n\n    virDomainCapsOSFormat(&buf, &caps->os);\n    virDomainCapsCPUFormat(&buf, &caps->cpu);\n\n    virBufferAddLit(&buf, \"<devices>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    virDomainCapsDeviceDiskFormat(&buf, &caps->disk);\n    virDomainCapsDeviceGraphicsFormat(&buf, &caps->graphics);\n    virDomainCapsDeviceVideoFormat(&buf, &caps->video);\n    virDomainCapsDeviceHostdevFormat(&buf, &caps->hostdev);\n    virDomainCapsDeviceRNGFormat(&buf, &caps->rng);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</devices>\\n\");\n\n    virDomainCapsFormatFeatures(caps, &buf);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</domainCapabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nchar *\nvirDomainCapsFormat(const virDomainCaps *caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    const char *virttype_str = virDomainVirtTypeToString(caps->virttype);\n    const char *arch_str = virArchToString(caps->arch);\n\n    virBufferAddLit(&buf, \"<domainCapabilities>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    virBufferEscapeString(&buf, \"<path>%s</path>\\n\", caps->path);\n    virBufferAsprintf(&buf, \"<domain>%s</domain>\\n\", virttype_str);\n    if (caps->machine)\n        virBufferAsprintf(&buf, \"<machine>%s</machine>\\n\", caps->machine);\n    virBufferAsprintf(&buf, \"<arch>%s</arch>\\n\", arch_str);\n\n    if (caps->maxvcpus)\n        virBufferAsprintf(&buf, \"<vcpu max='%d'/>\\n\", caps->maxvcpus);\n\n    qemuDomainCapsFeatureFormatSimple(&buf, \"iothreads\",\n                                      caps->features[VIR_DOMAIN_CAPS_FEATURE_IOTHREADS]);\n\n    virDomainCapsOSFormat(&buf, &caps->os);\n    virDomainCapsCPUFormat(&buf, &caps->cpu);\n\n    virBufferAddLit(&buf, \"<devices>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    virDomainCapsDeviceDiskFormat(&buf, &caps->disk);\n    virDomainCapsDeviceGraphicsFormat(&buf, &caps->graphics);\n    virDomainCapsDeviceVideoFormat(&buf, &caps->video);\n    virDomainCapsDeviceHostdevFormat(&buf, &caps->hostdev);\n    virDomainCapsDeviceRNGFormat(&buf, &caps->rng);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</devices>\\n\");\n\n    virDomainCapsFormatFeatures(caps, &buf);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</domainCapabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBhyveDomainCapsBuild",
          "args": [
            "conn->privateData",
            "emulatorbin",
            "machine",
            "arch",
            "virttype"
          ],
          "line": 1655
        },
        "resolved": true,
        "details": {
          "function_name": "virBhyveDomainCapsBuild",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_capabilities.c",
          "lines": "128-178",
          "snippet": "virDomainCapsPtr\nvirBhyveDomainCapsBuild(bhyveConnPtr conn,\n                        const char *emulatorbin,\n                        const char *machine,\n                        virArch arch,\n                        virDomainVirtType virttype)\n{\n    virDomainCapsPtr caps = NULL;\n    unsigned int bhyve_caps = 0;\n    DIR *dir;\n    struct dirent *entry;\n    size_t firmwares_alloc = 0;\n    virBhyveDriverConfigPtr cfg = virBhyveDriverGetConfig(conn);\n    const char *firmware_dir = cfg->firmwareDir;\n    virDomainCapsStringValuesPtr firmwares = NULL;\n\n    if (!(caps = virDomainCapsNew(emulatorbin, machine, arch, virttype)))\n        goto cleanup;\n\n    if (virBhyveProbeCaps(&bhyve_caps)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed probing capabilities\"));\n        goto cleanup;\n    }\n\n    if (VIR_ALLOC(firmwares) < 0)\n        goto cleanup;\n\n    if (virDirOpenIfExists(&dir, firmware_dir) > 0) {\n        while ((virDirRead(dir, &entry, firmware_dir)) > 0) {\n            if (VIR_RESIZE_N(firmwares->values,\n                firmwares_alloc, firmwares->nvalues, 1) < 0)\n                goto cleanup;\n\n            firmwares->values[firmwares->nvalues] = g_strdup_printf(\"%s/%s\",\n                                                    firmware_dir, entry->d_name);\n            firmwares->nvalues++;\n        }\n    } else {\n        VIR_WARN(\"Cannot open firmware directory %s\", firmware_dir);\n    }\n\n    if (virBhyveDomainCapsFill(caps, bhyve_caps, firmwares) < 0)\n        goto cleanup;\n\n cleanup:\n    VIR_FREE(firmwares);\n    VIR_DIR_CLOSE(dir);\n    virObjectUnref(cfg);\n    return caps;\n}",
          "includes": [
            "#include \"bhyve_conf.h\"",
            "#include \"bhyve_capabilities.h\"",
            "#include \"vircommand.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include <sys/types.h>",
            "#include <dirent.h>",
            "#include <sys/utsname.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_conf.h\"\n#include \"bhyve_capabilities.h\"\n#include \"vircommand.h\"\n#include \"domain_conf.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include <sys/types.h>\n#include <dirent.h>\n#include <sys/utsname.h>\n#include <config.h>\n\nvirDomainCapsPtr\nvirBhyveDomainCapsBuild(bhyveConnPtr conn,\n                        const char *emulatorbin,\n                        const char *machine,\n                        virArch arch,\n                        virDomainVirtType virttype)\n{\n    virDomainCapsPtr caps = NULL;\n    unsigned int bhyve_caps = 0;\n    DIR *dir;\n    struct dirent *entry;\n    size_t firmwares_alloc = 0;\n    virBhyveDriverConfigPtr cfg = virBhyveDriverGetConfig(conn);\n    const char *firmware_dir = cfg->firmwareDir;\n    virDomainCapsStringValuesPtr firmwares = NULL;\n\n    if (!(caps = virDomainCapsNew(emulatorbin, machine, arch, virttype)))\n        goto cleanup;\n\n    if (virBhyveProbeCaps(&bhyve_caps)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed probing capabilities\"));\n        goto cleanup;\n    }\n\n    if (VIR_ALLOC(firmwares) < 0)\n        goto cleanup;\n\n    if (virDirOpenIfExists(&dir, firmware_dir) > 0) {\n        while ((virDirRead(dir, &entry, firmware_dir)) > 0) {\n            if (VIR_RESIZE_N(firmwares->values,\n                firmwares_alloc, firmwares->nvalues, 1) < 0)\n                goto cleanup;\n\n            firmwares->values[firmwares->nvalues] = g_strdup_printf(\"%s/%s\",\n                                                    firmware_dir, entry->d_name);\n            firmwares->nvalues++;\n        }\n    } else {\n        VIR_WARN(\"Cannot open firmware directory %s\", firmware_dir);\n    }\n\n    if (virBhyveDomainCapsFill(caps, bhyve_caps, firmwares) < 0)\n        goto cleanup;\n\n cleanup:\n    VIR_FREE(firmwares);\n    VIR_DIR_CLOSE(dir);\n    virObjectUnref(cfg);\n    return caps;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"unknown emulator binary: %s\")",
            "emulatorbin"
          ],
          "line": 1649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown emulator binary: %s\""
          ],
          "line": 1650
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "emulatorbin",
            "\"/usr/sbin/bhyve\""
          ],
          "line": 1648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_SUPPORT",
            "_(\"unsupported architecture: %s\")",
            "virArchToString(arch)"
          ],
          "line": 1640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virArchToString",
          "args": [
            "arch"
          ],
          "line": 1642
        },
        "resolved": true,
        "details": {
          "function_name": "virArchToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virarch.c",
          "lines": "126-132",
          "snippet": "const char *virArchToString(virArch arch)\n{\n    if (arch >= VIR_ARCH_LAST)\n        arch = VIR_ARCH_NONE;\n\n    return virArchData[arch].name;\n}",
          "includes": [
            "#include \"virarch.h\"",
            "#include \"virlog.h\"",
            "# include <sys/utsname.h>",
            "# include <windows.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct virArchData {\n    const char *name;\n    unsigned int wordsize;\n    virArchEndian endian;\n} virArchData[] = {\n    { \"none\",          0, VIR_ARCH_LITTLE_ENDIAN },\n    { \"alpha\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"armv6l\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"armv7l\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"armv7b\",       32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"aarch64\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"cris\",         32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"i686\",         32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ia64\",         64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"lm32\",         32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"m68k\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"microblaze\",   32, VIR_ARCH_BIG_ENDIAN },\n    { \"microblazeel\", 32, VIR_ARCH_LITTLE_ENDIAN},\n    { \"mips\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"mipsel\",       32, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"mips64\",       64, VIR_ARCH_BIG_ENDIAN },\n    { \"mips64el\",     64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"openrisc\",     32, VIR_ARCH_BIG_ENDIAN },\n    { \"parisc\",       32, VIR_ARCH_BIG_ENDIAN },\n    { \"parisc64\",     64, VIR_ARCH_BIG_ENDIAN },\n\n    { \"ppc\",          32, VIR_ARCH_BIG_ENDIAN },\n    { \"ppcle\",        32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ppc64\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"ppc64le\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ppcemb\",       32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"riscv32\",      32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"riscv64\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"s390\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"s390x\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"sh4\",          32, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"sh4eb\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"sparc\",        32, VIR_ARCH_BIG_ENDIAN },\n    { \"sparc64\",      64, VIR_ARCH_BIG_ENDIAN },\n    { \"unicore32\",    32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"x86_64\",       64, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"xtensa\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"xtensaeb\",     32, VIR_ARCH_BIG_ENDIAN },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virarch.h\"\n#include \"virlog.h\"\n# include <sys/utsname.h>\n# include <windows.h>\n#include <config.h>\n\nstatic const struct virArchData {\n    const char *name;\n    unsigned int wordsize;\n    virArchEndian endian;\n} virArchData[] = {\n    { \"none\",          0, VIR_ARCH_LITTLE_ENDIAN },\n    { \"alpha\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"armv6l\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"armv7l\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"armv7b\",       32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"aarch64\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"cris\",         32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"i686\",         32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ia64\",         64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"lm32\",         32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"m68k\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"microblaze\",   32, VIR_ARCH_BIG_ENDIAN },\n    { \"microblazeel\", 32, VIR_ARCH_LITTLE_ENDIAN},\n    { \"mips\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"mipsel\",       32, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"mips64\",       64, VIR_ARCH_BIG_ENDIAN },\n    { \"mips64el\",     64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"openrisc\",     32, VIR_ARCH_BIG_ENDIAN },\n    { \"parisc\",       32, VIR_ARCH_BIG_ENDIAN },\n    { \"parisc64\",     64, VIR_ARCH_BIG_ENDIAN },\n\n    { \"ppc\",          32, VIR_ARCH_BIG_ENDIAN },\n    { \"ppcle\",        32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ppc64\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"ppc64le\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ppcemb\",       32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"riscv32\",      32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"riscv64\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"s390\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"s390x\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"sh4\",          32, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"sh4eb\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"sparc\",        32, VIR_ARCH_BIG_ENDIAN },\n    { \"sparc64\",      64, VIR_ARCH_BIG_ENDIAN },\n    { \"unicore32\",    32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"x86_64\",       64, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"xtensa\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"xtensaeb\",     32, VIR_ARCH_BIG_ENDIAN },\n};\n\nconst char *virArchToString(virArch arch)\n{\n    if (arch >= VIR_ARCH_LAST)\n        arch = VIR_ARCH_NONE;\n\n    return virArchData[arch].name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARCH_IS_X86",
          "args": [
            "arch"
          ],
          "line": 1639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"unknown architecture: %s\")",
            "arch_str"
          ],
          "line": 1633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virArchFromString",
          "args": [
            "arch_str"
          ],
          "line": 1632
        },
        "resolved": true,
        "details": {
          "function_name": "virArchFromString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virarch.c",
          "lines": "142-152",
          "snippet": "virArch virArchFromString(const char *archstr)\n{\n    size_t i;\n    for (i = 1; i < VIR_ARCH_LAST; i++) {\n        if (STREQ(virArchData[i].name, archstr))\n            return i;\n    }\n\n    VIR_DEBUG(\"Unknown arch %s\", archstr);\n    return VIR_ARCH_NONE;\n}",
          "includes": [
            "#include \"virarch.h\"",
            "#include \"virlog.h\"",
            "# include <sys/utsname.h>",
            "# include <windows.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct virArchData {\n    const char *name;\n    unsigned int wordsize;\n    virArchEndian endian;\n} virArchData[] = {\n    { \"none\",          0, VIR_ARCH_LITTLE_ENDIAN },\n    { \"alpha\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"armv6l\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"armv7l\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"armv7b\",       32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"aarch64\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"cris\",         32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"i686\",         32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ia64\",         64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"lm32\",         32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"m68k\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"microblaze\",   32, VIR_ARCH_BIG_ENDIAN },\n    { \"microblazeel\", 32, VIR_ARCH_LITTLE_ENDIAN},\n    { \"mips\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"mipsel\",       32, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"mips64\",       64, VIR_ARCH_BIG_ENDIAN },\n    { \"mips64el\",     64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"openrisc\",     32, VIR_ARCH_BIG_ENDIAN },\n    { \"parisc\",       32, VIR_ARCH_BIG_ENDIAN },\n    { \"parisc64\",     64, VIR_ARCH_BIG_ENDIAN },\n\n    { \"ppc\",          32, VIR_ARCH_BIG_ENDIAN },\n    { \"ppcle\",        32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ppc64\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"ppc64le\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ppcemb\",       32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"riscv32\",      32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"riscv64\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"s390\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"s390x\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"sh4\",          32, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"sh4eb\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"sparc\",        32, VIR_ARCH_BIG_ENDIAN },\n    { \"sparc64\",      64, VIR_ARCH_BIG_ENDIAN },\n    { \"unicore32\",    32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"x86_64\",       64, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"xtensa\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"xtensaeb\",     32, VIR_ARCH_BIG_ENDIAN },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virarch.h\"\n#include \"virlog.h\"\n# include <sys/utsname.h>\n# include <windows.h>\n#include <config.h>\n\nstatic const struct virArchData {\n    const char *name;\n    unsigned int wordsize;\n    virArchEndian endian;\n} virArchData[] = {\n    { \"none\",          0, VIR_ARCH_LITTLE_ENDIAN },\n    { \"alpha\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"armv6l\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"armv7l\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"armv7b\",       32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"aarch64\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"cris\",         32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"i686\",         32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ia64\",         64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"lm32\",         32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"m68k\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"microblaze\",   32, VIR_ARCH_BIG_ENDIAN },\n    { \"microblazeel\", 32, VIR_ARCH_LITTLE_ENDIAN},\n    { \"mips\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"mipsel\",       32, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"mips64\",       64, VIR_ARCH_BIG_ENDIAN },\n    { \"mips64el\",     64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"openrisc\",     32, VIR_ARCH_BIG_ENDIAN },\n    { \"parisc\",       32, VIR_ARCH_BIG_ENDIAN },\n    { \"parisc64\",     64, VIR_ARCH_BIG_ENDIAN },\n\n    { \"ppc\",          32, VIR_ARCH_BIG_ENDIAN },\n    { \"ppcle\",        32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ppc64\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"ppc64le\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ppcemb\",       32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"riscv32\",      32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"riscv64\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"s390\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"s390x\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"sh4\",          32, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"sh4eb\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"sparc\",        32, VIR_ARCH_BIG_ENDIAN },\n    { \"sparc64\",      64, VIR_ARCH_BIG_ENDIAN },\n    { \"unicore32\",    32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"x86_64\",       64, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"xtensa\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"xtensaeb\",     32, VIR_ARCH_BIG_ENDIAN },\n};\n\nvirArch virArchFromString(const char *archstr)\n{\n    size_t i;\n    for (i = 1; i < VIR_ARCH_LAST; i++) {\n        if (STREQ(virArchData[i].name, archstr))\n            return i;\n    }\n\n    VIR_DEBUG(\"Unknown arch %s\", archstr);\n    return VIR_ARCH_NONE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"unknown virttype: %s\")",
            "virttype_str"
          ],
          "line": 1626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"unknown virttype: %s\")",
            "virttype_str"
          ],
          "line": 1619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainVirtTypeFromString",
          "args": [
            "virttype_str"
          ],
          "line": 1618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConnectGetDomainCapabilitiesEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "ret"
          ],
          "line": 1612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virArchFromHost",
          "args": [],
          "line": 1610
        },
        "resolved": true,
        "details": {
          "function_name": "virArchFromHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virarch.c",
          "lines": "206-235",
          "snippet": "virArch virArchFromHost(void)\n{\n    struct utsname ut;\n    virArch arch;\n\n    uname(&ut);\n\n    /* Some special cases we need to handle first\n     * for non-canonical names */\n    if (strlen(ut.machine) == 4 &&\n        ut.machine[0] == 'i' &&\n        ut.machine[2] == '8' &&\n        ut.machine[3] == '6' &&\n        ut.machine[4] == '\\0') {\n        arch = VIR_ARCH_I686;\n    } else if (STREQ(ut.machine, \"amd64\")) {\n        arch = VIR_ARCH_X86_64;\n    } else {\n        /* Otherwise assume the canonical name */\n        if ((arch = virArchFromString(ut.machine)) == VIR_ARCH_NONE) {\n            VIR_WARN(\"Unknown host arch %s, report to libvir-list@redhat.com\",\n                     ut.machine);\n        }\n    }\n\n    VIR_DEBUG(\"Mapped %s to %d (%s)\",\n              ut.machine, arch, virArchToString(arch));\n\n    return arch;\n}",
          "includes": [
            "#include \"virarch.h\"",
            "#include \"virlog.h\"",
            "# include <sys/utsname.h>",
            "# include <windows.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virarch.h\"\n#include \"virlog.h\"\n# include <sys/utsname.h>\n# include <windows.h>\n#include <config.h>\n\nvirArch virArchFromHost(void)\n{\n    struct utsname ut;\n    virArch arch;\n\n    uname(&ut);\n\n    /* Some special cases we need to handle first\n     * for non-canonical names */\n    if (strlen(ut.machine) == 4 &&\n        ut.machine[0] == 'i' &&\n        ut.machine[2] == '8' &&\n        ut.machine[3] == '6' &&\n        ut.machine[4] == '\\0') {\n        arch = VIR_ARCH_I686;\n    } else if (STREQ(ut.machine, \"amd64\")) {\n        arch = VIR_ARCH_X86_64;\n    } else {\n        /* Otherwise assume the canonical name */\n        if ((arch = virArchFromString(ut.machine)) == VIR_ARCH_NONE) {\n            VIR_WARN(\"Unknown host arch %s, report to libvir-list@redhat.com\",\n                     ut.machine);\n        }\n    }\n\n    VIR_DEBUG(\"Mapped %s to %d (%s)\",\n              ut.machine, arch, virArchToString(arch));\n\n    return arch;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *\nbhyveConnectGetDomainCapabilities(virConnectPtr conn,\n                                  const char *emulatorbin,\n                                  const char *arch_str,\n                                  const char *machine,\n                                  const char *virttype_str,\n                                  unsigned int flags)\n{\n    virDomainCapsPtr caps = NULL;\n    char *ret = NULL;\n    int virttype = VIR_DOMAIN_VIRT_BHYVE;\n    int arch = virArchFromHost(); /* virArch */\n\n    virCheckFlags(0, ret);\n\n    if (virConnectGetDomainCapabilitiesEnsureACL(conn) < 0)\n        return ret;\n\n    if (virttype_str &&\n        (virttype = virDomainVirtTypeFromString(virttype_str)) < 0) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unknown virttype: %s\"),\n                       virttype_str);\n        goto cleanup;\n    }\n\n    if (virttype != VIR_DOMAIN_VIRT_BHYVE) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unknown virttype: %s\"),\n                       virttype_str);\n        goto cleanup;\n    }\n\n    if (arch_str && (arch = virArchFromString(arch_str)) == VIR_ARCH_NONE) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unknown architecture: %s\"),\n                       arch_str);\n        goto cleanup;\n    }\n\n    if (!ARCH_IS_X86(arch)) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       _(\"unsupported architecture: %s\"),\n                       virArchToString(arch));\n        goto cleanup;\n    }\n\n    if (emulatorbin == NULL) {\n        emulatorbin = \"/usr/sbin/bhyve\";\n    } else if (STRNEQ(emulatorbin, \"/usr/sbin/bhyve\")) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unknown emulator binary: %s\"),\n                       emulatorbin);\n        goto cleanup;\n    }\n\n    if (!(caps = virBhyveDomainCapsBuild(conn->privateData, emulatorbin,\n                                         machine, arch, virttype)))\n        goto cleanup;\n\n    ret = virDomainCapsFormat(caps);\n\n cleanup:\n    virObjectUnref(caps);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveConnectDomainXMLFromNative",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1565-1597",
    "snippet": "static char *\nbhyveConnectDomainXMLFromNative(virConnectPtr conn,\n                                const char *nativeFormat,\n                                const char *nativeConfig,\n                                unsigned int flags)\n{\n    char *xml = NULL;\n    virDomainDefPtr def = NULL;\n    bhyveConnPtr privconn = conn->privateData;\n    unsigned bhyveCaps = bhyveDriverGetBhyveCaps(privconn);\n\n    virCheckFlags(0, NULL);\n\n    if (virConnectDomainXMLFromNativeEnsureACL(conn) < 0)\n        return NULL;\n\n    if (STRNEQ(nativeFormat, BHYVE_CONFIG_FORMAT_ARGV)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported config type %s\"), nativeFormat);\n        goto cleanup;\n    }\n\n    def = bhyveParseCommandLineString(nativeConfig, bhyveCaps,\n                                      privconn->xmlopt);\n    if (def == NULL)\n        goto cleanup;\n\n    xml = virDomainDefFormat(def, privconn->xmlopt, 0);\n\n cleanup:\n    virDomainDefFree(def);\n    return xml;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "def"
          ],
          "line": 1595
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFormat",
          "args": [
            "def",
            "privconn->xmlopt",
            "0"
          ],
          "line": 1592
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29496-29508",
          "snippet": "char *\nvirDomainDefFormat(virDomainDefPtr def,\n                   virDomainXMLOptionPtr xmlopt,\n                   unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS, NULL);\n    if (virDomainDefFormatInternal(def, xmlopt, &buf, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS \\\n    (VIR_DOMAIN_DEF_FORMAT_SECURE | \\\n     VIR_DOMAIN_DEF_FORMAT_INACTIVE | \\\n     VIR_DOMAIN_DEF_FORMAT_MIGRATABLE)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS \\\n    (VIR_DOMAIN_DEF_FORMAT_SECURE | \\\n     VIR_DOMAIN_DEF_FORMAT_INACTIVE | \\\n     VIR_DOMAIN_DEF_FORMAT_MIGRATABLE)\n\nchar *\nvirDomainDefFormat(virDomainDefPtr def,\n                   virDomainXMLOptionPtr xmlopt,\n                   unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS, NULL);\n    if (virDomainDefFormatInternal(def, xmlopt, &buf, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bhyveParseCommandLineString",
          "args": [
            "nativeConfig",
            "bhyveCaps",
            "privconn->xmlopt"
          ],
          "line": 1587
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveParseCommandLineString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_parse_command.c",
          "lines": "842-894",
          "snippet": "virDomainDefPtr\nbhyveParseCommandLineString(const char* nativeConfig,\n                            unsigned caps,\n                            virDomainXMLOptionPtr xmlopt)\n{\n    virDomainDefPtr def = NULL;\n    int bhyve_argc = 0;\n    char **bhyve_argv = NULL;\n    int loader_argc = 0;\n    char **loader_argv = NULL;\n\n    if (!(def = virDomainDefNew()))\n        goto cleanup;\n\n    /* Initialize defaults. */\n    def->virtType = VIR_DOMAIN_VIRT_BHYVE;\n    if (virUUIDGenerate(def->uuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to generate uuid\"));\n        virDomainDefFree(def);\n        def = NULL;\n        goto cleanup;\n    }\n    def->id = -1;\n    def->clock.offset = VIR_DOMAIN_CLOCK_OFFSET_LOCALTIME;\n\n    if (bhyveCommandLineToArgv(nativeConfig,\n                               &loader_argc, &loader_argv,\n                               &bhyve_argc, &bhyve_argv)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to convert the command string to argv-lists\"));\n        goto error;\n    }\n\n    if (bhyveParseBhyveCommandLine(def, xmlopt, caps, bhyve_argc, bhyve_argv))\n        goto error;\n    if (loader_argv && STREQ(loader_argv[0], \"/usr/sbin/bhyveload\")) {\n        if (bhyveParseBhyveLoadCommandLine(def, loader_argc, loader_argv))\n            goto error;\n    } else if (loader_argv) {\n        if (bhyveParseCustomLoaderCommandLine(def, loader_argc, loader_argv))\n            goto error;\n    }\n\n cleanup:\n    virStringListFree(loader_argv);\n    virStringListFree(bhyve_argv);\n    return def;\n error:\n    virDomainDefFree(def);\n    def = NULL;\n    goto cleanup;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_capabilities.h\"",
            "#include <libutil.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_capabilities.h\"\n#include <libutil.h>\n#include <config.h>\n\nvirDomainDefPtr\nbhyveParseCommandLineString(const char* nativeConfig,\n                            unsigned caps,\n                            virDomainXMLOptionPtr xmlopt)\n{\n    virDomainDefPtr def = NULL;\n    int bhyve_argc = 0;\n    char **bhyve_argv = NULL;\n    int loader_argc = 0;\n    char **loader_argv = NULL;\n\n    if (!(def = virDomainDefNew()))\n        goto cleanup;\n\n    /* Initialize defaults. */\n    def->virtType = VIR_DOMAIN_VIRT_BHYVE;\n    if (virUUIDGenerate(def->uuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to generate uuid\"));\n        virDomainDefFree(def);\n        def = NULL;\n        goto cleanup;\n    }\n    def->id = -1;\n    def->clock.offset = VIR_DOMAIN_CLOCK_OFFSET_LOCALTIME;\n\n    if (bhyveCommandLineToArgv(nativeConfig,\n                               &loader_argc, &loader_argv,\n                               &bhyve_argc, &bhyve_argv)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to convert the command string to argv-lists\"));\n        goto error;\n    }\n\n    if (bhyveParseBhyveCommandLine(def, xmlopt, caps, bhyve_argc, bhyve_argv))\n        goto error;\n    if (loader_argv && STREQ(loader_argv[0], \"/usr/sbin/bhyveload\")) {\n        if (bhyveParseBhyveLoadCommandLine(def, loader_argc, loader_argv))\n            goto error;\n    } else if (loader_argv) {\n        if (bhyveParseCustomLoaderCommandLine(def, loader_argc, loader_argv))\n            goto error;\n    }\n\n cleanup:\n    virStringListFree(loader_argv);\n    virStringListFree(bhyve_argv);\n    return def;\n error:\n    virDomainDefFree(def);\n    def = NULL;\n    goto cleanup;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"unsupported config type %s\")",
            "nativeFormat"
          ],
          "line": 1582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unsupported config type %s\""
          ],
          "line": 1583
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "nativeFormat",
            "BHYVE_CONFIG_FORMAT_ARGV"
          ],
          "line": 1581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConnectDomainXMLFromNativeEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "NULL"
          ],
          "line": 1576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDriverGetBhyveCaps",
          "args": [
            "privconn"
          ],
          "line": 1574
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDriverGetBhyveCaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "1316-1322",
          "snippet": "unsigned\nbhyveDriverGetBhyveCaps(bhyveConnPtr driver)\n{\n    if (driver != NULL)\n        return driver->bhyvecaps;\n    return 0;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned\nbhyveDriverGetBhyveCaps(bhyveConnPtr driver)\n{\n    if (driver != NULL)\n        return driver->bhyvecaps;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *\nbhyveConnectDomainXMLFromNative(virConnectPtr conn,\n                                const char *nativeFormat,\n                                const char *nativeConfig,\n                                unsigned int flags)\n{\n    char *xml = NULL;\n    virDomainDefPtr def = NULL;\n    bhyveConnPtr privconn = conn->privateData;\n    unsigned bhyveCaps = bhyveDriverGetBhyveCaps(privconn);\n\n    virCheckFlags(0, NULL);\n\n    if (virConnectDomainXMLFromNativeEnsureACL(conn) < 0)\n        return NULL;\n\n    if (STRNEQ(nativeFormat, BHYVE_CONFIG_FORMAT_ARGV)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported config type %s\"), nativeFormat);\n        goto cleanup;\n    }\n\n    def = bhyveParseCommandLineString(nativeConfig, bhyveCaps,\n                                      privconn->xmlopt);\n    if (def == NULL)\n        goto cleanup;\n\n    xml = virDomainDefFormat(def, privconn->xmlopt, 0);\n\n cleanup:\n    virDomainDefFree(def);\n    return xml;\n}"
  },
  {
    "function_name": "bhyveConnectIsEncrypted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1558-1563",
    "snippet": "static int\nbhyveConnectIsEncrypted(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Not encrypted, but remote driver takes care of that */\n    return 0;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveConnectIsEncrypted(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Not encrypted, but remote driver takes care of that */\n    return 0;\n}"
  },
  {
    "function_name": "bhyveConnectIsSecure",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1551-1556",
    "snippet": "static int\nbhyveConnectIsSecure(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Trivially secure, since always inside the daemon */\n    return 1;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveConnectIsSecure(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Trivially secure, since always inside the daemon */\n    return 1;\n}"
  },
  {
    "function_name": "bhyveConnectIsAlive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1546-1549",
    "snippet": "static int bhyveConnectIsAlive(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return 1;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int bhyveConnectIsAlive(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return 1;\n}"
  },
  {
    "function_name": "bhyveConnectGetType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1537-1544",
    "snippet": "static const char *\nbhyveConnectGetType(virConnectPtr conn)\n{\n    if (virConnectGetTypeEnsureACL(conn) < 0)\n        return NULL;\n\n    return \"BHYVE\";\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConnectGetTypeEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1540
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic const char *\nbhyveConnectGetType(virConnectPtr conn)\n{\n    if (virConnectGetTypeEnsureACL(conn) < 0)\n        return NULL;\n\n    return \"BHYVE\";\n}"
  },
  {
    "function_name": "bhyveDomainHasManagedSaveImage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1516-1535",
    "snippet": "static int\nbhyveDomainHasManagedSaveImage(virDomainPtr domain, unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainHasManagedSaveImageEnsureACL(domain->conn, vm->def) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1533
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainHasManagedSaveImageEnsureACL",
          "args": [
            "domain->conn",
            "vm->def"
          ],
          "line": 1527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1524
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "163-180",
          "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1522
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainHasManagedSaveImage(virDomainPtr domain, unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainHasManagedSaveImageEnsureACL(domain->conn, vm->def) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveConnectDomainEventDeregisterAny",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1499-1514",
    "snippet": "static int\nbhyveConnectDomainEventDeregisterAny(virConnectPtr conn,\n                                     int callbackID)\n{\n    bhyveConnPtr privconn = conn->privateData;\n\n    if (virConnectDomainEventDeregisterAnyEnsureACL(conn) < 0)\n        return -1;\n\n    if (virObjectEventStateDeregisterID(conn,\n                                        privconn->domainEventState,\n                                        callbackID, true) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateDeregisterID",
          "args": [
            "conn",
            "privconn->domainEventState",
            "callbackID",
            "true"
          ],
          "line": 1508
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateDeregisterID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "936-957",
          "snippet": "int\nvirObjectEventStateDeregisterID(virConnectPtr conn,\n                                virObjectEventStatePtr state,\n                                int callbackID,\n                                bool doFreeCb)\n{\n    int ret;\n\n    virObjectLock(state);\n    if (state->isDispatching)\n        ret = virObjectEventCallbackListMarkDeleteID(conn,\n                                                     state->callbacks,\n                                                     callbackID);\n    else\n        ret = virObjectEventCallbackListRemoveID(conn, state->callbacks,\n                                                 callbackID, doFreeCb);\n\n    virObjectEventStateCleanupTimer(state, true);\n\n    virObjectUnlock(state);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nint\nvirObjectEventStateDeregisterID(virConnectPtr conn,\n                                virObjectEventStatePtr state,\n                                int callbackID,\n                                bool doFreeCb)\n{\n    int ret;\n\n    virObjectLock(state);\n    if (state->isDispatching)\n        ret = virObjectEventCallbackListMarkDeleteID(conn,\n                                                     state->callbacks,\n                                                     callbackID);\n    else\n        ret = virObjectEventCallbackListRemoveID(conn, state->callbacks,\n                                                 callbackID, doFreeCb);\n\n    virObjectEventStateCleanupTimer(state, true);\n\n    virObjectUnlock(state);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectDomainEventDeregisterAnyEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1505
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveConnectDomainEventDeregisterAny(virConnectPtr conn,\n                                     int callbackID)\n{\n    bhyveConnPtr privconn = conn->privateData;\n\n    if (virConnectDomainEventDeregisterAnyEnsureACL(conn) < 0)\n        return -1;\n\n    if (virObjectEventStateDeregisterID(conn,\n                                        privconn->domainEventState,\n                                        callbackID, true) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "bhyveConnectDomainEventRegisterAny",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1476-1497",
    "snippet": "static int\nbhyveConnectDomainEventRegisterAny(virConnectPtr conn,\n                                   virDomainPtr dom,\n                                   int eventID,\n                                   virConnectDomainEventGenericCallback callback,\n                                   void *opaque,\n                                   virFreeCallback freecb)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    int ret;\n\n    if (virConnectDomainEventRegisterAnyEnsureACL(conn) < 0)\n        return -1;\n\n    if (virDomainEventStateRegisterID(conn,\n                                      privconn->domainEventState,\n                                      dom, eventID,\n                                      callback, opaque, freecb, &ret) < 0)\n        ret = -1;\n\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainEventStateRegisterID",
          "args": [
            "conn",
            "privconn->domainEventState",
            "dom",
            "eventID",
            "callback",
            "opaque",
            "freecb",
            "&ret"
          ],
          "line": 1490
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventStateRegisterID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "2036-2059",
          "snippet": "int\nvirDomainEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              virDomainPtr dom,\n                              int eventID,\n                              virConnectDomainEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virDomainEventsInitialize() < 0)\n        return -1;\n\n    if (dom)\n        virUUIDFormat(dom->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, dom ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virDomainEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, false);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virDomainEventClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virDomainEventClass;\n\nint\nvirDomainEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              virDomainPtr dom,\n                              int eventID,\n                              virConnectDomainEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virDomainEventsInitialize() < 0)\n        return -1;\n\n    if (dom)\n        virUUIDFormat(dom->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, dom ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virDomainEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectDomainEventRegisterAnyEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1487
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveConnectDomainEventRegisterAny(virConnectPtr conn,\n                                   virDomainPtr dom,\n                                   int eventID,\n                                   virConnectDomainEventGenericCallback callback,\n                                   void *opaque,\n                                   virFreeCallback freecb)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    int ret;\n\n    if (virConnectDomainEventRegisterAnyEnsureACL(conn) < 0)\n        return -1;\n\n    if (virDomainEventStateRegisterID(conn,\n                                      privconn->domainEventState,\n                                      dom, eventID,\n                                      callback, opaque, freecb, &ret) < 0)\n        ret = -1;\n\n    return ret;\n}"
  },
  {
    "function_name": "bhyveConnectCompareCPU",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1436-1474",
    "snippet": "static int\nbhyveConnectCompareCPU(virConnectPtr conn,\n                       const char *xmlDesc,\n                       unsigned int flags)\n{\n    bhyveConnPtr driver = conn->privateData;\n    int ret = VIR_CPU_COMPARE_ERROR;\n    virCapsPtr caps = NULL;\n    bool failIncompatible;\n\n    virCheckFlags(VIR_CONNECT_COMPARE_CPU_FAIL_INCOMPATIBLE,\n                  VIR_CPU_COMPARE_ERROR);\n\n    if (virConnectCompareCPUEnsureACL(conn) < 0)\n        goto cleanup;\n\n    failIncompatible = !!(flags & VIR_CONNECT_COMPARE_CPU_FAIL_INCOMPATIBLE);\n\n    if (!(caps = bhyveDriverGetCapabilities(driver)))\n        goto cleanup;\n\n    if (!caps->host.cpu ||\n        !caps->host.cpu->model) {\n        if (failIncompatible) {\n            virReportError(VIR_ERR_CPU_INCOMPATIBLE, \"%s\",\n                           _(\"cannot get host CPU capabilities\"));\n        } else {\n            VIR_WARN(\"cannot get host CPU capabilities\");\n            ret = VIR_CPU_COMPARE_INCOMPATIBLE;\n        }\n    } else {\n        ret = virCPUCompareXML(caps->host.arch, caps->host.cpu,\n                               xmlDesc, failIncompatible);\n    }\n\n cleanup:\n    virObjectUnref(caps);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "caps"
          ],
          "line": 1472
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUCompareXML",
          "args": [
            "caps->host.arch",
            "caps->host.cpu",
            "xmlDesc",
            "failIncompatible"
          ],
          "line": 1467
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUCompareXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu.c",
          "lines": "108-129",
          "snippet": "virCPUCompareResult\nvirCPUCompareXML(virArch arch,\n                 virCPUDefPtr host,\n                 const char *xml,\n                 bool failIncompatible)\n{\n    virCPUDefPtr cpu = NULL;\n    virCPUCompareResult ret = VIR_CPU_COMPARE_ERROR;\n\n    VIR_DEBUG(\"arch=%s, host=%p, xml=%s\",\n              virArchToString(arch), host, NULLSTR(xml));\n\n    if (virCPUDefParseXMLString(xml, VIR_CPU_TYPE_AUTO, &cpu) < 0)\n        goto cleanup;\n\n    ret = virCPUCompare(arch, host, cpu, failIncompatible);\n\n cleanup:\n    virCPUDefFree(cpu);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"capabilities.h\"",
            "#include \"cpu_arm.h\"",
            "#include \"cpu_s390.h\"",
            "#include \"cpu_ppc64.h\"",
            "#include \"cpu_x86.h\"",
            "#include \"cpu_map.h\"",
            "#include \"cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"capabilities.h\"\n#include \"cpu_arm.h\"\n#include \"cpu_s390.h\"\n#include \"cpu_ppc64.h\"\n#include \"cpu_x86.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nvirCPUCompareResult\nvirCPUCompareXML(virArch arch,\n                 virCPUDefPtr host,\n                 const char *xml,\n                 bool failIncompatible)\n{\n    virCPUDefPtr cpu = NULL;\n    virCPUCompareResult ret = VIR_CPU_COMPARE_ERROR;\n\n    VIR_DEBUG(\"arch=%s, host=%p, xml=%s\",\n              virArchToString(arch), host, NULLSTR(xml));\n\n    if (virCPUDefParseXMLString(xml, VIR_CPU_TYPE_AUTO, &cpu) < 0)\n        goto cleanup;\n\n    ret = virCPUCompare(arch, host, cpu, failIncompatible);\n\n cleanup:\n    virCPUDefFree(cpu);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"cannot get host CPU capabilities\""
          ],
          "line": 1463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CPU_INCOMPATIBLE",
            "\"%s\"",
            "_(\"cannot get host CPU capabilities\")"
          ],
          "line": 1460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot get host CPU capabilities\""
          ],
          "line": 1461
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bhyveDriverGetCapabilities",
          "args": [
            "driver"
          ],
          "line": 1454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConnectCompareCPUEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_CONNECT_COMPARE_CPU_FAIL_INCOMPATIBLE",
            "VIR_CPU_COMPARE_ERROR"
          ],
          "line": 1446
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveConnectCompareCPU(virConnectPtr conn,\n                       const char *xmlDesc,\n                       unsigned int flags)\n{\n    bhyveConnPtr driver = conn->privateData;\n    int ret = VIR_CPU_COMPARE_ERROR;\n    virCapsPtr caps = NULL;\n    bool failIncompatible;\n\n    virCheckFlags(VIR_CONNECT_COMPARE_CPU_FAIL_INCOMPATIBLE,\n                  VIR_CPU_COMPARE_ERROR);\n\n    if (virConnectCompareCPUEnsureACL(conn) < 0)\n        goto cleanup;\n\n    failIncompatible = !!(flags & VIR_CONNECT_COMPARE_CPU_FAIL_INCOMPATIBLE);\n\n    if (!(caps = bhyveDriverGetCapabilities(driver)))\n        goto cleanup;\n\n    if (!caps->host.cpu ||\n        !caps->host.cpu->model) {\n        if (failIncompatible) {\n            virReportError(VIR_ERR_CPU_INCOMPATIBLE, \"%s\",\n                           _(\"cannot get host CPU capabilities\"));\n        } else {\n            VIR_WARN(\"cannot get host CPU capabilities\");\n            ret = VIR_CPU_COMPARE_INCOMPATIBLE;\n        }\n    } else {\n        ret = virCPUCompareXML(caps->host.arch, caps->host.cpu,\n                               xmlDesc, failIncompatible);\n    }\n\n cleanup:\n    virObjectUnref(caps);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveConnectBaselineCPU",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1400-1434",
    "snippet": "static char *\nbhyveConnectBaselineCPU(virConnectPtr conn,\n                        const char **xmlCPUs,\n                        unsigned int ncpus,\n                        unsigned int flags)\n{\n    virCPUDefPtr *cpus = NULL;\n    virCPUDefPtr cpu = NULL;\n    char *cpustr = NULL;\n\n    virCheckFlags(VIR_CONNECT_BASELINE_CPU_EXPAND_FEATURES |\n                  VIR_CONNECT_BASELINE_CPU_MIGRATABLE, NULL);\n\n    if (virConnectBaselineCPUEnsureACL(conn) < 0)\n        goto cleanup;\n\n    if (!(cpus = virCPUDefListParse(xmlCPUs, ncpus, VIR_CPU_TYPE_HOST)))\n        goto cleanup;\n\n    if (!(cpu = virCPUBaseline(VIR_ARCH_NONE, cpus, ncpus, NULL, NULL,\n                               !!(flags & VIR_CONNECT_BASELINE_CPU_MIGRATABLE))))\n        goto cleanup;\n\n    if ((flags & VIR_CONNECT_BASELINE_CPU_EXPAND_FEATURES) &&\n        virCPUExpandFeatures(cpus[0]->arch, cpu) < 0)\n        goto cleanup;\n\n    cpustr = virCPUDefFormat(cpu, NULL);\n\n cleanup:\n    virCPUDefListFree(cpus);\n    virCPUDefFree(cpu);\n\n    return cpustr;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCPUDefFree",
          "args": [
            "cpu"
          ],
          "line": 1431
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "120-132",
          "snippet": "void\nvirCPUDefFree(virCPUDefPtr def)\n{\n    if (!def)\n        return;\n\n    if (g_atomic_int_dec_and_test(&def->refs)) {\n        virCPUDefFreeModel(def);\n        VIR_FREE(def->cache);\n        VIR_FREE(def->tsc);\n        VIR_FREE(def);\n    }\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirCPUDefFree(virCPUDefPtr def)\n{\n    if (!def)\n        return;\n\n    if (g_atomic_int_dec_and_test(&def->refs)) {\n        virCPUDefFreeModel(def);\n        VIR_FREE(def->cache);\n        VIR_FREE(def->tsc);\n        VIR_FREE(def);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUDefListFree",
          "args": [
            "cpus"
          ],
          "line": 1430
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUDefListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "1192-1204",
          "snippet": "void\nvirCPUDefListFree(virCPUDefPtr *cpus)\n{\n    virCPUDefPtr *cpu;\n\n    if (!cpus)\n        return;\n\n    for (cpu = cpus; *cpu != NULL; cpu++)\n        virCPUDefFree(*cpu);\n\n    VIR_FREE(cpus);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirCPUDefListFree(virCPUDefPtr *cpus)\n{\n    virCPUDefPtr *cpu;\n\n    if (!cpus)\n        return;\n\n    for (cpu = cpus; *cpu != NULL; cpu++)\n        virCPUDefFree(*cpu);\n\n    VIR_FREE(cpus);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUDefFormat",
          "args": [
            "cpu",
            "NULL"
          ],
          "line": 1427
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUDefFormatBuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "775-882",
          "snippet": "int\nvirCPUDefFormatBuf(virBufferPtr buf,\n                   virCPUDefPtr def)\n{\n    size_t i;\n    bool formatModel;\n\n    if (!def)\n        return 0;\n\n    formatModel = (def->mode == VIR_CPU_MODE_CUSTOM ||\n                   def->mode == VIR_CPU_MODE_HOST_MODEL);\n\n    if (!def->model && def->mode == VIR_CPU_MODE_CUSTOM && def->nfeatures) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Non-empty feature list specified without CPU model\"));\n        return -1;\n    }\n\n    if (formatModel && (def->model || def->vendor_id)) {\n        virBufferAddLit(buf, \"<model\");\n\n        if (def->type == VIR_CPU_TYPE_GUEST && def->model) {\n            const char *fallback;\n\n            fallback = virCPUFallbackTypeToString(def->fallback);\n            if (!fallback) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unexpected CPU fallback value: %d\"),\n                               def->fallback);\n                return -1;\n            }\n            virBufferAsprintf(buf, \" fallback='%s'\", fallback);\n        }\n\n        if (def->type == VIR_CPU_TYPE_GUEST)\n            virBufferEscapeString(buf, \" vendor_id='%s'\", def->vendor_id);\n\n        if (def->model)\n            virBufferEscapeString(buf, \">%s</model>\\n\", def->model);\n        else\n            virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (formatModel && def->vendor)\n        virBufferEscapeString(buf, \"<vendor>%s</vendor>\\n\", def->vendor);\n\n    if (def->type == VIR_CPU_TYPE_HOST && def->microcodeVersion)\n        virBufferAsprintf(buf, \"<microcode version='%u'/>\\n\",\n                          def->microcodeVersion);\n\n    if (def->type == VIR_CPU_TYPE_HOST && def->tsc) {\n        virBufferAddLit(buf, \"<counter name='tsc'\");\n        virBufferAsprintf(buf, \" frequency='%llu'\", def->tsc->frequency);\n        if (def->tsc->scaling) {\n            virBufferAsprintf(buf, \" scaling='%s'\",\n                              virTristateBoolTypeToString(def->tsc->scaling));\n        }\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (def->sockets && def->dies && def->cores && def->threads) {\n        virBufferAddLit(buf, \"<topology\");\n        virBufferAsprintf(buf, \" sockets='%u'\", def->sockets);\n        virBufferAsprintf(buf, \" dies='%u'\", def->dies);\n        virBufferAsprintf(buf, \" cores='%u'\", def->cores);\n        virBufferAsprintf(buf, \" threads='%u'\", def->threads);\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (def->cache) {\n        virBufferAddLit(buf, \"<cache \");\n        if (def->cache->level != -1)\n            virBufferAsprintf(buf, \"level='%d' \", def->cache->level);\n        virBufferAsprintf(buf, \"mode='%s'\",\n                          virCPUCacheModeTypeToString(def->cache->mode));\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    for (i = 0; i < def->nfeatures; i++) {\n        virCPUFeatureDefPtr feature = def->features + i;\n\n        if (!feature->name) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Missing CPU feature name\"));\n            return -1;\n        }\n\n        if (def->type == VIR_CPU_TYPE_GUEST) {\n            const char *policy;\n\n            policy = virCPUFeaturePolicyTypeToString(feature->policy);\n            if (!policy) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unexpected CPU feature policy %d\"),\n                               feature->policy);\n                return -1;\n            }\n            virBufferAsprintf(buf, \"<feature policy='%s' name='%s'/>\\n\",\n                              policy, feature->name);\n        } else {\n            virBufferAsprintf(buf, \"<feature name='%s'/>\\n\",\n                              feature->name);\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirCPUDefFormatBuf(virBufferPtr buf,\n                   virCPUDefPtr def)\n{\n    size_t i;\n    bool formatModel;\n\n    if (!def)\n        return 0;\n\n    formatModel = (def->mode == VIR_CPU_MODE_CUSTOM ||\n                   def->mode == VIR_CPU_MODE_HOST_MODEL);\n\n    if (!def->model && def->mode == VIR_CPU_MODE_CUSTOM && def->nfeatures) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Non-empty feature list specified without CPU model\"));\n        return -1;\n    }\n\n    if (formatModel && (def->model || def->vendor_id)) {\n        virBufferAddLit(buf, \"<model\");\n\n        if (def->type == VIR_CPU_TYPE_GUEST && def->model) {\n            const char *fallback;\n\n            fallback = virCPUFallbackTypeToString(def->fallback);\n            if (!fallback) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unexpected CPU fallback value: %d\"),\n                               def->fallback);\n                return -1;\n            }\n            virBufferAsprintf(buf, \" fallback='%s'\", fallback);\n        }\n\n        if (def->type == VIR_CPU_TYPE_GUEST)\n            virBufferEscapeString(buf, \" vendor_id='%s'\", def->vendor_id);\n\n        if (def->model)\n            virBufferEscapeString(buf, \">%s</model>\\n\", def->model);\n        else\n            virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (formatModel && def->vendor)\n        virBufferEscapeString(buf, \"<vendor>%s</vendor>\\n\", def->vendor);\n\n    if (def->type == VIR_CPU_TYPE_HOST && def->microcodeVersion)\n        virBufferAsprintf(buf, \"<microcode version='%u'/>\\n\",\n                          def->microcodeVersion);\n\n    if (def->type == VIR_CPU_TYPE_HOST && def->tsc) {\n        virBufferAddLit(buf, \"<counter name='tsc'\");\n        virBufferAsprintf(buf, \" frequency='%llu'\", def->tsc->frequency);\n        if (def->tsc->scaling) {\n            virBufferAsprintf(buf, \" scaling='%s'\",\n                              virTristateBoolTypeToString(def->tsc->scaling));\n        }\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (def->sockets && def->dies && def->cores && def->threads) {\n        virBufferAddLit(buf, \"<topology\");\n        virBufferAsprintf(buf, \" sockets='%u'\", def->sockets);\n        virBufferAsprintf(buf, \" dies='%u'\", def->dies);\n        virBufferAsprintf(buf, \" cores='%u'\", def->cores);\n        virBufferAsprintf(buf, \" threads='%u'\", def->threads);\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (def->cache) {\n        virBufferAddLit(buf, \"<cache \");\n        if (def->cache->level != -1)\n            virBufferAsprintf(buf, \"level='%d' \", def->cache->level);\n        virBufferAsprintf(buf, \"mode='%s'\",\n                          virCPUCacheModeTypeToString(def->cache->mode));\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    for (i = 0; i < def->nfeatures; i++) {\n        virCPUFeatureDefPtr feature = def->features + i;\n\n        if (!feature->name) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Missing CPU feature name\"));\n            return -1;\n        }\n\n        if (def->type == VIR_CPU_TYPE_GUEST) {\n            const char *policy;\n\n            policy = virCPUFeaturePolicyTypeToString(feature->policy);\n            if (!policy) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unexpected CPU feature policy %d\"),\n                               feature->policy);\n                return -1;\n            }\n            virBufferAsprintf(buf, \"<feature policy='%s' name='%s'/>\\n\",\n                              policy, feature->name);\n        } else {\n            virBufferAsprintf(buf, \"<feature name='%s'/>\\n\",\n                              feature->name);\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUExpandFeatures",
          "args": [
            "cpus[0]->arch",
            "cpu"
          ],
          "line": 1424
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUExpandFeatures",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu.c",
          "lines": "986-1007",
          "snippet": "int\nvirCPUExpandFeatures(virArch arch,\n                     virCPUDefPtr cpu)\n{\n    struct cpuArchDriver *driver;\n\n    VIR_DEBUG(\"arch=%s, cpu=%p, model=%s, nfeatures=%zu\",\n              virArchToString(arch), cpu, NULLSTR(cpu->model), cpu->nfeatures);\n\n    if (!(driver = cpuGetSubDriver(arch)))\n        return -1;\n\n    if (driver->expandFeatures &&\n        driver->expandFeatures(cpu) < 0)\n        return -1;\n\n    qsort(cpu->features, cpu->nfeatures, sizeof(*cpu->features),\n          virCPUFeatureCompare);\n\n    VIR_DEBUG(\"nfeatures=%zu\", cpu->nfeatures);\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"capabilities.h\"",
            "#include \"cpu_arm.h\"",
            "#include \"cpu_s390.h\"",
            "#include \"cpu_ppc64.h\"",
            "#include \"cpu_x86.h\"",
            "#include \"cpu_map.h\"",
            "#include \"cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"capabilities.h\"\n#include \"cpu_arm.h\"\n#include \"cpu_s390.h\"\n#include \"cpu_ppc64.h\"\n#include \"cpu_x86.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirCPUExpandFeatures(virArch arch,\n                     virCPUDefPtr cpu)\n{\n    struct cpuArchDriver *driver;\n\n    VIR_DEBUG(\"arch=%s, cpu=%p, model=%s, nfeatures=%zu\",\n              virArchToString(arch), cpu, NULLSTR(cpu->model), cpu->nfeatures);\n\n    if (!(driver = cpuGetSubDriver(arch)))\n        return -1;\n\n    if (driver->expandFeatures &&\n        driver->expandFeatures(cpu) < 0)\n        return -1;\n\n    qsort(cpu->features, cpu->nfeatures, sizeof(*cpu->features),\n          virCPUFeatureCompare);\n\n    VIR_DEBUG(\"nfeatures=%zu\", cpu->nfeatures);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUBaseline",
          "args": [
            "VIR_ARCH_NONE",
            "cpus",
            "ncpus",
            "NULL",
            "NULL",
            "!!(flags & VIR_CONNECT_BASELINE_CPU_MIGRATABLE)"
          ],
          "line": 1419
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUBaseline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu.c",
          "lines": "483-543",
          "snippet": "virCPUDefPtr\nvirCPUBaseline(virArch arch,\n               virCPUDefPtr *cpus,\n               unsigned int ncpus,\n               virDomainCapsCPUModelsPtr models,\n               const char **features,\n               bool migratable)\n{\n    struct cpuArchDriver *driver;\n    size_t i;\n\n    VIR_DEBUG(\"arch=%s, ncpus=%u, models=%p, features=%p, migratable=%d\",\n              virArchToString(arch), ncpus, models, features, migratable);\n    if (cpus) {\n        for (i = 0; i < ncpus; i++)\n            VIR_DEBUG(\"cpus[%zu]=%p\", i, cpus[i]);\n    }\n    if (models) {\n        for (i = 0; i < models->nmodels; i++)\n            VIR_DEBUG(\"models[%zu]=%s\", i, models->models[i].name);\n    }\n\n    if (!cpus && ncpus != 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"nonzero ncpus doesn't match with NULL cpus\"));\n        return NULL;\n    }\n\n    if (ncpus < 1) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\", _(\"no CPUs given\"));\n        return NULL;\n    }\n\n    for (i = 0; i < ncpus; i++) {\n        if (!cpus[i]) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"invalid CPU definition at index %zu\"), i);\n            return NULL;\n        }\n        if (!cpus[i]->model) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"no CPU model specified at index %zu\"), i);\n            return NULL;\n        }\n    }\n\n    if (arch == VIR_ARCH_NONE)\n        arch = cpus[0]->arch;\n\n    if (!(driver = cpuGetSubDriver(arch)))\n        return NULL;\n\n    if (!driver->baseline) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       _(\"cannot compute baseline CPU of %s architecture\"),\n                       virArchToString(arch));\n        return NULL;\n    }\n\n    return driver->baseline(cpus, ncpus, models, features, migratable);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"capabilities.h\"",
            "#include \"cpu_arm.h\"",
            "#include \"cpu_s390.h\"",
            "#include \"cpu_ppc64.h\"",
            "#include \"cpu_x86.h\"",
            "#include \"cpu_map.h\"",
            "#include \"cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"capabilities.h\"\n#include \"cpu_arm.h\"\n#include \"cpu_s390.h\"\n#include \"cpu_ppc64.h\"\n#include \"cpu_x86.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nvirCPUDefPtr\nvirCPUBaseline(virArch arch,\n               virCPUDefPtr *cpus,\n               unsigned int ncpus,\n               virDomainCapsCPUModelsPtr models,\n               const char **features,\n               bool migratable)\n{\n    struct cpuArchDriver *driver;\n    size_t i;\n\n    VIR_DEBUG(\"arch=%s, ncpus=%u, models=%p, features=%p, migratable=%d\",\n              virArchToString(arch), ncpus, models, features, migratable);\n    if (cpus) {\n        for (i = 0; i < ncpus; i++)\n            VIR_DEBUG(\"cpus[%zu]=%p\", i, cpus[i]);\n    }\n    if (models) {\n        for (i = 0; i < models->nmodels; i++)\n            VIR_DEBUG(\"models[%zu]=%s\", i, models->models[i].name);\n    }\n\n    if (!cpus && ncpus != 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"nonzero ncpus doesn't match with NULL cpus\"));\n        return NULL;\n    }\n\n    if (ncpus < 1) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\", _(\"no CPUs given\"));\n        return NULL;\n    }\n\n    for (i = 0; i < ncpus; i++) {\n        if (!cpus[i]) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"invalid CPU definition at index %zu\"), i);\n            return NULL;\n        }\n        if (!cpus[i]->model) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"no CPU model specified at index %zu\"), i);\n            return NULL;\n        }\n    }\n\n    if (arch == VIR_ARCH_NONE)\n        arch = cpus[0]->arch;\n\n    if (!(driver = cpuGetSubDriver(arch)))\n        return NULL;\n\n    if (!driver->baseline) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       _(\"cannot compute baseline CPU of %s architecture\"),\n                       virArchToString(arch));\n        return NULL;\n    }\n\n    return driver->baseline(cpus, ncpus, models, features, migratable);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUDefListParse",
          "args": [
            "xmlCPUs",
            "ncpus",
            "VIR_CPU_TYPE_HOST"
          ],
          "line": 1416
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUDefListParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "1135-1186",
          "snippet": "virCPUDefPtr *\nvirCPUDefListParse(const char **xmlCPUs,\n                   unsigned int ncpus,\n                   virCPUType cpuType)\n{\n    xmlDocPtr doc = NULL;\n    xmlXPathContextPtr ctxt = NULL;\n    virCPUDefPtr *cpus = NULL;\n    size_t i;\n\n    VIR_DEBUG(\"xmlCPUs=%p, ncpus=%u\", xmlCPUs, ncpus);\n\n    if (xmlCPUs) {\n        for (i = 0; i < ncpus; i++)\n            VIR_DEBUG(\"xmlCPUs[%zu]=%s\", i, NULLSTR(xmlCPUs[i]));\n    }\n\n    if (!xmlCPUs && ncpus != 0) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"nonzero ncpus doesn't match with NULL xmlCPUs\"));\n        goto error;\n    }\n\n    if (ncpus == 0) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\", _(\"no CPUs given\"));\n        goto error;\n    }\n\n    if (VIR_ALLOC_N(cpus, ncpus + 1))\n        goto error;\n\n    for (i = 0; i < ncpus; i++) {\n        if (!(doc = virXMLParseStringCtxt(xmlCPUs[i], _(\"(CPU_definition)\"), &ctxt)))\n            goto error;\n\n        if (virCPUDefParseXML(ctxt, NULL, cpuType, &cpus[i]) < 0)\n            goto error;\n\n        xmlXPathFreeContext(ctxt);\n        xmlFreeDoc(doc);\n        ctxt = NULL;\n        doc = NULL;\n    }\n\n    return cpus;\n\n error:\n    virCPUDefListFree(cpus);\n    xmlXPathFreeContext(ctxt);\n    xmlFreeDoc(doc);\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirCPUDefPtr *\nvirCPUDefListParse(const char **xmlCPUs,\n                   unsigned int ncpus,\n                   virCPUType cpuType)\n{\n    xmlDocPtr doc = NULL;\n    xmlXPathContextPtr ctxt = NULL;\n    virCPUDefPtr *cpus = NULL;\n    size_t i;\n\n    VIR_DEBUG(\"xmlCPUs=%p, ncpus=%u\", xmlCPUs, ncpus);\n\n    if (xmlCPUs) {\n        for (i = 0; i < ncpus; i++)\n            VIR_DEBUG(\"xmlCPUs[%zu]=%s\", i, NULLSTR(xmlCPUs[i]));\n    }\n\n    if (!xmlCPUs && ncpus != 0) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"nonzero ncpus doesn't match with NULL xmlCPUs\"));\n        goto error;\n    }\n\n    if (ncpus == 0) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\", _(\"no CPUs given\"));\n        goto error;\n    }\n\n    if (VIR_ALLOC_N(cpus, ncpus + 1))\n        goto error;\n\n    for (i = 0; i < ncpus; i++) {\n        if (!(doc = virXMLParseStringCtxt(xmlCPUs[i], _(\"(CPU_definition)\"), &ctxt)))\n            goto error;\n\n        if (virCPUDefParseXML(ctxt, NULL, cpuType, &cpus[i]) < 0)\n            goto error;\n\n        xmlXPathFreeContext(ctxt);\n        xmlFreeDoc(doc);\n        ctxt = NULL;\n        doc = NULL;\n    }\n\n    return cpus;\n\n error:\n    virCPUDefListFree(cpus);\n    xmlXPathFreeContext(ctxt);\n    xmlFreeDoc(doc);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectBaselineCPUEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_CONNECT_BASELINE_CPU_EXPAND_FEATURES |\n                  VIR_CONNECT_BASELINE_CPU_MIGRATABLE",
            "NULL"
          ],
          "line": 1410
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *\nbhyveConnectBaselineCPU(virConnectPtr conn,\n                        const char **xmlCPUs,\n                        unsigned int ncpus,\n                        unsigned int flags)\n{\n    virCPUDefPtr *cpus = NULL;\n    virCPUDefPtr cpu = NULL;\n    char *cpustr = NULL;\n\n    virCheckFlags(VIR_CONNECT_BASELINE_CPU_EXPAND_FEATURES |\n                  VIR_CONNECT_BASELINE_CPU_MIGRATABLE, NULL);\n\n    if (virConnectBaselineCPUEnsureACL(conn) < 0)\n        goto cleanup;\n\n    if (!(cpus = virCPUDefListParse(xmlCPUs, ncpus, VIR_CPU_TYPE_HOST)))\n        goto cleanup;\n\n    if (!(cpu = virCPUBaseline(VIR_ARCH_NONE, cpus, ncpus, NULL, NULL,\n                               !!(flags & VIR_CONNECT_BASELINE_CPU_MIGRATABLE))))\n        goto cleanup;\n\n    if ((flags & VIR_CONNECT_BASELINE_CPU_EXPAND_FEATURES) &&\n        virCPUExpandFeatures(cpus[0]->arch, cpu) < 0)\n        goto cleanup;\n\n    cpustr = virCPUDefFormat(cpu, NULL);\n\n cleanup:\n    virCPUDefListFree(cpus);\n    virCPUDefFree(cpu);\n\n    return cpustr;\n}"
  },
  {
    "function_name": "bhyveNodeSetMemoryParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1388-1398",
    "snippet": "static int\nbhyveNodeSetMemoryParameters(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams,\n                             unsigned int flags)\n{\n    if (virNodeSetMemoryParametersEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemSetParameters(params, nparams, flags);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostMemSetParameters",
          "args": [
            "params",
            "nparams",
            "flags"
          ],
          "line": 1397
        },
        "resolved": true,
        "details": {
          "function_name": "virHostMemSetParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostmem.c",
          "lines": "355-393",
          "snippet": "int\nvirHostMemSetParameters(virTypedParameterPtr params G_GNUC_UNUSED,\n                        int nparams G_GNUC_UNUSED,\n                        unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    size_t i;\n    int rc;\n\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_NODE_MEMORY_SHARED_PAGES_TO_SCAN,\n                               VIR_TYPED_PARAM_UINT,\n                               VIR_NODE_MEMORY_SHARED_SLEEP_MILLISECS,\n                               VIR_TYPED_PARAM_UINT,\n                               VIR_NODE_MEMORY_SHARED_MERGE_ACROSS_NODES,\n                               VIR_TYPED_PARAM_UINT,\n                               NULL) < 0)\n        return -1;\n\n    if (!virHostMemParametersAreAllSupported(params, nparams))\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        rc = virHostMemSetParameterValue(&params[i]);\n\n        if (rc < 0)\n            return -1;\n    }\n\n    return 0;\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node set memory parameters not implemented\"\n                     \" on this platform\"));\n    return -1;\n#endif\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostmem.h\"",
            "#include \"viralloc.h\"",
            "# include <windows.h>",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostmem.h\"\n#include \"viralloc.h\"\n# include <windows.h>\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirHostMemSetParameters(virTypedParameterPtr params G_GNUC_UNUSED,\n                        int nparams G_GNUC_UNUSED,\n                        unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    size_t i;\n    int rc;\n\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_NODE_MEMORY_SHARED_PAGES_TO_SCAN,\n                               VIR_TYPED_PARAM_UINT,\n                               VIR_NODE_MEMORY_SHARED_SLEEP_MILLISECS,\n                               VIR_TYPED_PARAM_UINT,\n                               VIR_NODE_MEMORY_SHARED_MERGE_ACROSS_NODES,\n                               VIR_TYPED_PARAM_UINT,\n                               NULL) < 0)\n        return -1;\n\n    if (!virHostMemParametersAreAllSupported(params, nparams))\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        rc = virHostMemSetParameterValue(&params[i]);\n\n        if (rc < 0)\n            return -1;\n    }\n\n    return 0;\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node set memory parameters not implemented\"\n                     \" on this platform\"));\n    return -1;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeSetMemoryParametersEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1394
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveNodeSetMemoryParameters(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams,\n                             unsigned int flags)\n{\n    if (virNodeSetMemoryParametersEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemSetParameters(params, nparams, flags);\n}"
  },
  {
    "function_name": "bhyveNodeGetMemoryParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1376-1386",
    "snippet": "static int\nbhyveNodeGetMemoryParameters(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int *nparams,\n                             unsigned int flags)\n{\n    if (virNodeGetMemoryParametersEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemGetParameters(params, nparams, flags);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostMemGetParameters",
          "args": [
            "params",
            "nparams",
            "flags"
          ],
          "line": 1385
        },
        "resolved": true,
        "details": {
          "function_name": "virHostMemGetParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostmem.c",
          "lines": "438-579",
          "snippet": "int\nvirHostMemGetParameters(virTypedParameterPtr params G_GNUC_UNUSED,\n                        int *nparams G_GNUC_UNUSED,\n                        unsigned int flags)\n{\n    virCheckFlags(VIR_TYPED_PARAM_STRING_OKAY, -1);\n\n#ifdef __linux__\n    unsigned int pages_to_scan;\n    unsigned int sleep_millisecs;\n    unsigned int merge_across_nodes;\n    unsigned long long pages_shared;\n    unsigned long long pages_sharing;\n    unsigned long long pages_unshared;\n    unsigned long long pages_volatile;\n    unsigned long long full_scans = 0;\n    size_t i;\n    int ret;\n\n    if ((*nparams) == 0) {\n        *nparams = NODE_MEMORY_PARAMETERS_NUM;\n        return 0;\n    }\n\n    for (i = 0; i < *nparams && i < NODE_MEMORY_PARAMETERS_NUM; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        switch (i) {\n        case 0:\n            ret = virHostMemGetParameterValue(\"pages_to_scan\", &pages_to_scan);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_TO_SCAN,\n                                        VIR_TYPED_PARAM_UINT, pages_to_scan) < 0)\n                return -1;\n\n            break;\n\n        case 1:\n            ret = virHostMemGetParameterValue(\"sleep_millisecs\", &sleep_millisecs);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_SLEEP_MILLISECS,\n                                        VIR_TYPED_PARAM_UINT, sleep_millisecs) < 0)\n                return -1;\n\n            break;\n\n        case 2:\n            ret = virHostMemGetParameterValue(\"pages_shared\", &pages_shared);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_SHARED,\n                                        VIR_TYPED_PARAM_ULLONG, pages_shared) < 0)\n                return -1;\n\n            break;\n\n        case 3:\n            ret = virHostMemGetParameterValue(\"pages_sharing\", &pages_sharing);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_SHARING,\n                                        VIR_TYPED_PARAM_ULLONG, pages_sharing) < 0)\n                return -1;\n\n            break;\n\n        case 4:\n            ret = virHostMemGetParameterValue(\"pages_unshared\", &pages_unshared);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_UNSHARED,\n                                        VIR_TYPED_PARAM_ULLONG, pages_unshared) < 0)\n                return -1;\n\n            break;\n\n        case 5:\n            ret = virHostMemGetParameterValue(\"pages_volatile\", &pages_volatile);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_VOLATILE,\n                                        VIR_TYPED_PARAM_ULLONG, pages_volatile) < 0)\n                return -1;\n\n            break;\n\n        case 6:\n            ret = virHostMemGetParameterValue(\"full_scans\", &full_scans);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_FULL_SCANS,\n                                        VIR_TYPED_PARAM_ULLONG, full_scans) < 0)\n                return -1;\n\n            break;\n\n        case 7:\n            ret = virHostMemGetParameterValue(\"merge_across_nodes\", &merge_across_nodes);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_MERGE_ACROSS_NODES,\n                                        VIR_TYPED_PARAM_UINT, merge_across_nodes) < 0)\n                return -1;\n\n            break;\n        }\n    }\n\n    return 0;\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node get memory parameters not implemented\"\n                     \" on this platform\"));\n    return -1;\n#endif\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostmem.h\"",
            "#include \"viralloc.h\"",
            "# include <windows.h>",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NODE_MEMORY_PARAMETERS_NUM 8"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostmem.h\"\n#include \"viralloc.h\"\n# include <windows.h>\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NODE_MEMORY_PARAMETERS_NUM 8\n\nint\nvirHostMemGetParameters(virTypedParameterPtr params G_GNUC_UNUSED,\n                        int *nparams G_GNUC_UNUSED,\n                        unsigned int flags)\n{\n    virCheckFlags(VIR_TYPED_PARAM_STRING_OKAY, -1);\n\n#ifdef __linux__\n    unsigned int pages_to_scan;\n    unsigned int sleep_millisecs;\n    unsigned int merge_across_nodes;\n    unsigned long long pages_shared;\n    unsigned long long pages_sharing;\n    unsigned long long pages_unshared;\n    unsigned long long pages_volatile;\n    unsigned long long full_scans = 0;\n    size_t i;\n    int ret;\n\n    if ((*nparams) == 0) {\n        *nparams = NODE_MEMORY_PARAMETERS_NUM;\n        return 0;\n    }\n\n    for (i = 0; i < *nparams && i < NODE_MEMORY_PARAMETERS_NUM; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        switch (i) {\n        case 0:\n            ret = virHostMemGetParameterValue(\"pages_to_scan\", &pages_to_scan);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_TO_SCAN,\n                                        VIR_TYPED_PARAM_UINT, pages_to_scan) < 0)\n                return -1;\n\n            break;\n\n        case 1:\n            ret = virHostMemGetParameterValue(\"sleep_millisecs\", &sleep_millisecs);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_SLEEP_MILLISECS,\n                                        VIR_TYPED_PARAM_UINT, sleep_millisecs) < 0)\n                return -1;\n\n            break;\n\n        case 2:\n            ret = virHostMemGetParameterValue(\"pages_shared\", &pages_shared);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_SHARED,\n                                        VIR_TYPED_PARAM_ULLONG, pages_shared) < 0)\n                return -1;\n\n            break;\n\n        case 3:\n            ret = virHostMemGetParameterValue(\"pages_sharing\", &pages_sharing);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_SHARING,\n                                        VIR_TYPED_PARAM_ULLONG, pages_sharing) < 0)\n                return -1;\n\n            break;\n\n        case 4:\n            ret = virHostMemGetParameterValue(\"pages_unshared\", &pages_unshared);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_UNSHARED,\n                                        VIR_TYPED_PARAM_ULLONG, pages_unshared) < 0)\n                return -1;\n\n            break;\n\n        case 5:\n            ret = virHostMemGetParameterValue(\"pages_volatile\", &pages_volatile);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_VOLATILE,\n                                        VIR_TYPED_PARAM_ULLONG, pages_volatile) < 0)\n                return -1;\n\n            break;\n\n        case 6:\n            ret = virHostMemGetParameterValue(\"full_scans\", &full_scans);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_FULL_SCANS,\n                                        VIR_TYPED_PARAM_ULLONG, full_scans) < 0)\n                return -1;\n\n            break;\n\n        case 7:\n            ret = virHostMemGetParameterValue(\"merge_across_nodes\", &merge_across_nodes);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_MERGE_ACROSS_NODES,\n                                        VIR_TYPED_PARAM_UINT, merge_across_nodes) < 0)\n                return -1;\n\n            break;\n        }\n    }\n\n    return 0;\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node get memory parameters not implemented\"\n                     \" on this platform\"));\n    return -1;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetMemoryParametersEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1382
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveNodeGetMemoryParameters(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int *nparams,\n                             unsigned int flags)\n{\n    if (virNodeGetMemoryParametersEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemGetParameters(params, nparams, flags);\n}"
  },
  {
    "function_name": "bhyveNodeGetCPUMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1364-1374",
    "snippet": "static int\nbhyveNodeGetCPUMap(virConnectPtr conn,\n                   unsigned char **cpumap,\n                   unsigned int *online,\n                   unsigned int flags)\n{\n    if (virNodeGetCPUMapEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostCPUGetMap(cpumap, online, flags);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostCPUGetMap",
          "args": [
            "cpumap",
            "online",
            "flags"
          ],
          "line": 1373
        },
        "resolved": true,
        "details": {
          "function_name": "virHostCPUGetMap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostcpu.c",
          "lines": "1087-1116",
          "snippet": "int\nvirHostCPUGetMap(unsigned char **cpumap,\n                 unsigned int *online,\n                 unsigned int flags)\n{\n    virBitmapPtr cpus = NULL;\n    int ret = -1;\n    int dummy;\n\n    virCheckFlags(0, -1);\n\n    if (!cpumap && !online)\n        return virHostCPUGetCount();\n\n    if (!(cpus = virHostCPUGetOnlineBitmap()))\n        goto cleanup;\n\n    if (cpumap && virBitmapToData(cpus, cpumap, &dummy) < 0)\n        goto cleanup;\n    if (online)\n        *online = virBitmapCountBits(cpus);\n\n    ret = virHostCPUGetCount();\n\n cleanup:\n    if (ret < 0 && cpumap)\n        VIR_FREE(*cpumap);\n    virBitmapFree(cpus);\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostcpupriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "# include <linux/kvm.h>",
            "#include <unistd.h>",
            "# include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostcpupriv.h\"\n#include \"viralloc.h\"\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n# include <linux/kvm.h>\n#include <unistd.h>\n# include <sys/ioctl.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nint\nvirHostCPUGetMap(unsigned char **cpumap,\n                 unsigned int *online,\n                 unsigned int flags)\n{\n    virBitmapPtr cpus = NULL;\n    int ret = -1;\n    int dummy;\n\n    virCheckFlags(0, -1);\n\n    if (!cpumap && !online)\n        return virHostCPUGetCount();\n\n    if (!(cpus = virHostCPUGetOnlineBitmap()))\n        goto cleanup;\n\n    if (cpumap && virBitmapToData(cpus, cpumap, &dummy) < 0)\n        goto cleanup;\n    if (online)\n        *online = virBitmapCountBits(cpus);\n\n    ret = virHostCPUGetCount();\n\n cleanup:\n    if (ret < 0 && cpumap)\n        VIR_FREE(*cpumap);\n    virBitmapFree(cpus);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetCPUMapEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1370
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveNodeGetCPUMap(virConnectPtr conn,\n                   unsigned char **cpumap,\n                   unsigned int *online,\n                   unsigned int flags)\n{\n    if (virNodeGetCPUMapEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostCPUGetMap(cpumap, online, flags);\n}"
  },
  {
    "function_name": "bhyveNodeGetFreeMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1350-1362",
    "snippet": "static unsigned long long\nbhyveNodeGetFreeMemory(virConnectPtr conn)\n{\n    unsigned long long freeMem;\n\n    if (virNodeGetFreeMemoryEnsureACL(conn) < 0)\n        return 0;\n\n    if (virHostMemGetInfo(NULL, &freeMem) < 0)\n        return 0;\n\n    return freeMem;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostMemGetInfo",
          "args": [
            "NULL",
            "&freeMem"
          ],
          "line": 1358
        },
        "resolved": true,
        "details": {
          "function_name": "virHostMemGetInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostmem.c",
          "lines": "790-826",
          "snippet": "int\nvirHostMemGetInfo(unsigned long long *mem,\n                  unsigned long long *freeMem)\n{\n    int max_node;\n    int n;\n\n    if (mem)\n        *mem = 0;\n\n    if (freeMem)\n        *freeMem = 0;\n\n    if (!virNumaIsAvailable())\n        return virHostMemGetInfoFake(mem, freeMem);\n\n    if ((max_node = virNumaGetMaxNode()) < 0)\n        return -1;\n\n    for (n = 0; n <= max_node; n++) {\n        unsigned long long tmp_mem = 0, tmp_freeMem = 0;\n\n        if (!virNumaNodeIsAvailable(n))\n            continue;\n\n        if (virNumaGetNodeMemory(n, &tmp_mem, &tmp_freeMem) < 0)\n            return -1;\n\n        if (mem)\n            *mem += tmp_mem;\n\n        if (freeMem)\n            *freeMem += tmp_freeMem;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostmem.h\"",
            "#include \"viralloc.h\"",
            "# include <windows.h>",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostmem.h\"\n#include \"viralloc.h\"\n# include <windows.h>\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirHostMemGetInfo(unsigned long long *mem,\n                  unsigned long long *freeMem)\n{\n    int max_node;\n    int n;\n\n    if (mem)\n        *mem = 0;\n\n    if (freeMem)\n        *freeMem = 0;\n\n    if (!virNumaIsAvailable())\n        return virHostMemGetInfoFake(mem, freeMem);\n\n    if ((max_node = virNumaGetMaxNode()) < 0)\n        return -1;\n\n    for (n = 0; n <= max_node; n++) {\n        unsigned long long tmp_mem = 0, tmp_freeMem = 0;\n\n        if (!virNumaNodeIsAvailable(n))\n            continue;\n\n        if (virNumaGetNodeMemory(n, &tmp_mem, &tmp_freeMem) < 0)\n            return -1;\n\n        if (mem)\n            *mem += tmp_mem;\n\n        if (freeMem)\n            *freeMem += tmp_freeMem;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetFreeMemoryEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1355
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic unsigned long long\nbhyveNodeGetFreeMemory(virConnectPtr conn)\n{\n    unsigned long long freeMem;\n\n    if (virNodeGetFreeMemoryEnsureACL(conn) < 0)\n        return 0;\n\n    if (virHostMemGetInfo(NULL, &freeMem) < 0)\n        return 0;\n\n    return freeMem;\n}"
  },
  {
    "function_name": "bhyveConnectGetMaxVcpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1332-1348",
    "snippet": "static int\nbhyveConnectGetMaxVcpus(virConnectPtr conn,\n                        const char *type)\n{\n    if (virConnectGetMaxVcpusEnsureACL(conn) < 0)\n        return -1;\n\n    /*\n     * Bhyve supports up to 16 VCPUs, but offers no method to check this\n     * value. Hardcode 16...\n     */\n    if (!type || STRCASEEQ(type, \"bhyve\"))\n        return 16;\n\n    virReportError(VIR_ERR_INVALID_ARG, _(\"unknown type '%s'\"), type);\n    return -1;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"unknown type '%s'\")",
            "type"
          ],
          "line": 1346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown type '%s'\""
          ],
          "line": 1346
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRCASEEQ",
          "args": [
            "type",
            "\"bhyve\""
          ],
          "line": 1343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConnectGetMaxVcpusEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1336
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveConnectGetMaxVcpus(virConnectPtr conn,\n                        const char *type)\n{\n    if (virConnectGetMaxVcpusEnsureACL(conn) < 0)\n        return -1;\n\n    /*\n     * Bhyve supports up to 16 VCPUs, but offers no method to check this\n     * value. Hardcode 16...\n     */\n    if (!type || STRCASEEQ(type, \"bhyve\"))\n        return 16;\n\n    virReportError(VIR_ERR_INVALID_ARG, _(\"unknown type '%s'\"), type);\n    return -1;\n}"
  },
  {
    "function_name": "bhyveDriverGetGrubCaps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1324-1330",
    "snippet": "unsigned\nbhyveDriverGetGrubCaps(bhyveConnPtr driver)\n{\n    if (driver != NULL)\n        return driver->grubcaps;\n    return 0;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned\nbhyveDriverGetGrubCaps(bhyveConnPtr driver)\n{\n    if (driver != NULL)\n        return driver->grubcaps;\n    return 0;\n}"
  },
  {
    "function_name": "bhyveDriverGetBhyveCaps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1316-1322",
    "snippet": "unsigned\nbhyveDriverGetBhyveCaps(bhyveConnPtr driver)\n{\n    if (driver != NULL)\n        return driver->bhyvecaps;\n    return 0;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned\nbhyveDriverGetBhyveCaps(bhyveConnPtr driver)\n{\n    if (driver != NULL)\n        return driver->bhyvecaps;\n    return 0;\n}"
  },
  {
    "function_name": "bhyveStateInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1208-1314",
    "snippet": "static int\nbhyveStateInitialize(bool privileged,\n                     const char *root,\n                     virStateInhibitCallback callback G_GNUC_UNUSED,\n                     void *opaque G_GNUC_UNUSED)\n{\n    bool autostart = true;\n\n    if (root != NULL) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Driver does not support embedded mode\"));\n        return -1;\n    }\n\n    if (!privileged) {\n        VIR_INFO(\"Not running privileged, disabling driver\");\n        return VIR_DRV_STATE_INIT_SKIPPED;\n    }\n\n    if (VIR_ALLOC(bhyve_driver) < 0)\n        return VIR_DRV_STATE_INIT_ERROR;\n\n    bhyve_driver->lockFD = -1;\n    if (virMutexInit(&bhyve_driver->lock) < 0) {\n        VIR_FREE(bhyve_driver);\n        return VIR_DRV_STATE_INIT_ERROR;\n    }\n\n    if (!(bhyve_driver->closeCallbacks = virCloseCallbacksNew()))\n        goto cleanup;\n\n    if (!(bhyve_driver->caps = virBhyveCapsBuild()))\n        goto cleanup;\n\n    if (virBhyveProbeCaps(&bhyve_driver->bhyvecaps) < 0)\n        goto cleanup;\n\n    if (virBhyveProbeGrubCaps(&bhyve_driver->grubcaps) < 0)\n        goto cleanup;\n\n    if (!(bhyve_driver->xmlopt = virBhyveDriverCreateXMLConf(bhyve_driver)))\n        goto cleanup;\n\n    if (!(bhyve_driver->domains = virDomainObjListNew()))\n        goto cleanup;\n\n    if (!(bhyve_driver->domainEventState = virObjectEventStateNew()))\n        goto cleanup;\n\n    if (!(bhyve_driver->remotePorts = virPortAllocatorRangeNew(_(\"display\"),\n                                                               5900, 65535)))\n        goto cleanup;\n\n    bhyve_driver->hostsysinfo = virSysinfoRead();\n\n    if (!(bhyve_driver->config = virBhyveDriverConfigNew()))\n        goto cleanup;\n\n    if (virBhyveLoadDriverConfig(bhyve_driver->config, SYSCONFDIR \"/libvirt/bhyve.conf\") < 0)\n        goto cleanup;\n\n    if (virFileMakePath(BHYVE_LOG_DIR) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to mkdir %s\"),\n                             BHYVE_LOG_DIR);\n        goto cleanup;\n    }\n\n    if (virFileMakePath(BHYVE_STATE_DIR) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to mkdir %s\"),\n                             BHYVE_STATE_DIR);\n        goto cleanup;\n    }\n\n    if ((bhyve_driver->lockFD =\n         virPidFileAcquire(BHYVE_STATE_DIR, \"driver\", false, getpid())) < 0)\n        goto cleanup;\n\n    if (virDomainObjListLoadAllConfigs(bhyve_driver->domains,\n                                       BHYVE_STATE_DIR,\n                                       NULL, true,\n                                       bhyve_driver->xmlopt,\n                                       NULL, NULL) < 0)\n        goto cleanup;\n\n    if (virDomainObjListLoadAllConfigs(bhyve_driver->domains,\n                                       BHYVE_CONFIG_DIR,\n                                       BHYVE_AUTOSTART_DIR, false,\n                                       bhyve_driver->xmlopt,\n                                       NULL, NULL) < 0)\n        goto cleanup;\n\n    virBhyveProcessReconnectAll(bhyve_driver);\n\n    if (virDriverShouldAutostart(BHYVE_STATE_DIR, &autostart) < 0)\n        goto cleanup;\n\n    if (autostart)\n        bhyveAutostartDomains(bhyve_driver);\n\n    return VIR_DRV_STATE_INIT_COMPLETE;\n\n cleanup:\n    bhyveStateCleanup();\n    return VIR_DRV_STATE_INIT_ERROR;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bhyveConnPtr bhyve_driver = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bhyveStateCleanup",
          "args": [],
          "line": 1312
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveStateCleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "1182-1206",
          "snippet": "static int\nbhyveStateCleanup(void)\n{\n    VIR_DEBUG(\"bhyve state cleanup\");\n\n    if (bhyve_driver == NULL)\n        return -1;\n\n    virObjectUnref(bhyve_driver->domains);\n    virObjectUnref(bhyve_driver->caps);\n    virObjectUnref(bhyve_driver->xmlopt);\n    virSysinfoDefFree(bhyve_driver->hostsysinfo);\n    virObjectUnref(bhyve_driver->closeCallbacks);\n    virObjectUnref(bhyve_driver->domainEventState);\n    virObjectUnref(bhyve_driver->config);\n    virPortAllocatorRangeFree(bhyve_driver->remotePorts);\n\n    if (bhyve_driver->lockFD != -1)\n        virPidFileRelease(BHYVE_STATE_DIR, \"driver\", bhyve_driver->lockFD);\n\n    virMutexDestroy(&bhyve_driver->lock);\n    VIR_FREE(bhyve_driver);\n\n    return 0;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "bhyveConnPtr bhyve_driver = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nbhyveConnPtr bhyve_driver = NULL;\n\nstatic int\nbhyveStateCleanup(void)\n{\n    VIR_DEBUG(\"bhyve state cleanup\");\n\n    if (bhyve_driver == NULL)\n        return -1;\n\n    virObjectUnref(bhyve_driver->domains);\n    virObjectUnref(bhyve_driver->caps);\n    virObjectUnref(bhyve_driver->xmlopt);\n    virSysinfoDefFree(bhyve_driver->hostsysinfo);\n    virObjectUnref(bhyve_driver->closeCallbacks);\n    virObjectUnref(bhyve_driver->domainEventState);\n    virObjectUnref(bhyve_driver->config);\n    virPortAllocatorRangeFree(bhyve_driver->remotePorts);\n\n    if (bhyve_driver->lockFD != -1)\n        virPidFileRelease(BHYVE_STATE_DIR, \"driver\", bhyve_driver->lockFD);\n\n    virMutexDestroy(&bhyve_driver->lock);\n    VIR_FREE(bhyve_driver);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bhyveAutostartDomains",
          "args": [
            "bhyve_driver"
          ],
          "line": 1307
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveAutostartDomains",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "105-121",
          "snippet": "static void\nbhyveAutostartDomains(bhyveConnPtr driver)\n{\n    /* XXX: Figure out a better way todo this. The domain\n     * startup code needs a connection handle in order\n     * to lookup the bridge associated with a virtual\n     * network\n     */\n    virConnectPtr conn = virConnectOpen(\"bhyve:///system\");\n    /* Ignoring NULL conn which is mostly harmless here */\n\n    struct bhyveAutostartData data = { driver, conn };\n\n    virDomainObjListForEach(driver->domains, false, bhyveAutostartDomain, &data);\n\n    virObjectUnref(conn);\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void\nbhyveAutostartDomains(bhyveConnPtr driver)\n{\n    /* XXX: Figure out a better way todo this. The domain\n     * startup code needs a connection handle in order\n     * to lookup the bridge associated with a virtual\n     * network\n     */\n    virConnectPtr conn = virConnectOpen(\"bhyve:///system\");\n    /* Ignoring NULL conn which is mostly harmless here */\n\n    struct bhyveAutostartData data = { driver, conn };\n\n    virDomainObjListForEach(driver->domains, false, bhyveAutostartDomain, &data);\n\n    virObjectUnref(conn);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDriverShouldAutostart",
          "args": [
            "BHYVE_STATE_DIR",
            "&autostart"
          ],
          "line": 1303
        },
        "resolved": true,
        "details": {
          "function_name": "virDriverShouldAutostart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/driver.c",
          "lines": "86-108",
          "snippet": "int\nvirDriverShouldAutostart(const char *dir,\n                         bool *autostart)\n{\n    g_autofree char *path = NULL;\n\n    *autostart = false;\n\n    path = g_strdup_printf(\"%s/autostarted\", dir);\n\n    if (virFileExists(path)) {\n        VIR_DEBUG(\"Autostart file %s exists, skipping autostart\", path);\n        return 0;\n    }\n\n    VIR_DEBUG(\"Autostart file %s does not exist, do autostart\", path);\n    *autostart = true;\n\n    if (virFileTouch(path, 0600) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"driver.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"driver.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirDriverShouldAutostart(const char *dir,\n                         bool *autostart)\n{\n    g_autofree char *path = NULL;\n\n    *autostart = false;\n\n    path = g_strdup_printf(\"%s/autostarted\", dir);\n\n    if (virFileExists(path)) {\n        VIR_DEBUG(\"Autostart file %s exists, skipping autostart\", path);\n        return 0;\n    }\n\n    VIR_DEBUG(\"Autostart file %s does not exist, do autostart\", path);\n    *autostart = true;\n\n    if (virFileTouch(path, 0600) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBhyveProcessReconnectAll",
          "args": [
            "bhyve_driver"
          ],
          "line": 1301
        },
        "resolved": true,
        "details": {
          "function_name": "virBhyveProcessReconnectAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_process.c",
          "lines": "476-497",
          "snippet": "void\nvirBhyveProcessReconnectAll(bhyveConnPtr driver)\n{\n    kvm_t *kd;\n    struct bhyveProcessReconnectData data;\n    char errbuf[_POSIX2_LINE_MAX];\n\n    if ((kd = kvm_openfiles(NULL, NULL, NULL, O_RDONLY, errbuf)) == NULL) {\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Unable to get kvm descriptor: %s\"),\n                       errbuf);\n        return;\n\n    }\n\n    data.driver = driver;\n    data.kd = kd;\n\n    virDomainObjListForEach(driver->domains, false, virBhyveProcessReconnect, &data);\n\n    kvm_close(kd);\n}",
          "includes": [
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virhook.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_monitor.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include <net/if_tap.h>",
            "#include <net/if.h>",
            "#include <sys/user.h>",
            "#include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>",
            "#include <kvm.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virnetdevtap.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virhook.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_monitor.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include <net/if_tap.h>\n#include <net/if.h>\n#include <sys/user.h>\n#include <sys/sysctl.h>\n#include <sys/types.h>\n#include <sys/param.h>\n#include <kvm.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirBhyveProcessReconnectAll(bhyveConnPtr driver)\n{\n    kvm_t *kd;\n    struct bhyveProcessReconnectData data;\n    char errbuf[_POSIX2_LINE_MAX];\n\n    if ((kd = kvm_openfiles(NULL, NULL, NULL, O_RDONLY, errbuf)) == NULL) {\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Unable to get kvm descriptor: %s\"),\n                       errbuf);\n        return;\n\n    }\n\n    data.driver = driver;\n    data.kd = kd;\n\n    virDomainObjListForEach(driver->domains, false, virBhyveProcessReconnect, &data);\n\n    kvm_close(kd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListLoadAllConfigs",
          "args": [
            "bhyve_driver->domains",
            "BHYVE_CONFIG_DIR",
            "BHYVE_AUTOSTART_DIR",
            "false",
            "bhyve_driver->xmlopt",
            "NULL",
            "NULL"
          ],
          "line": 1294
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListLoadAllConfigs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "582-639",
          "snippet": "int\nvirDomainObjListLoadAllConfigs(virDomainObjListPtr doms,\n                               const char *configDir,\n                               const char *autostartDir,\n                               bool liveStatus,\n                               virDomainXMLOptionPtr xmlopt,\n                               virDomainLoadConfigNotify notify,\n                               void *opaque)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    VIR_INFO(\"Scanning for configs in %s\", configDir);\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    virObjectRWLockWrite(doms);\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virDomainObjPtr dom;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        /* NB: ignoring errors, so one malformed config doesn't\n           kill the whole process */\n        VIR_INFO(\"Loading config file '%s.xml'\", entry->d_name);\n        if (liveStatus)\n            dom = virDomainObjListLoadStatus(doms,\n                                             configDir,\n                                             entry->d_name,\n                                             xmlopt,\n                                             notify,\n                                             opaque);\n        else\n            dom = virDomainObjListLoadConfig(doms,\n                                             xmlopt,\n                                             configDir,\n                                             autostartDir,\n                                             entry->d_name,\n                                             notify,\n                                             opaque);\n        if (dom) {\n            if (!liveStatus)\n                dom->persistent = 1;\n            virDomainObjEndAPI(&dom);\n        } else {\n            VIR_ERROR(_(\"Failed to load config for domain '%s'\"), entry->d_name);\n        }\n    }\n\n    VIR_DIR_CLOSE(dir);\n    virObjectRWUnlock(doms);\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListLoadAllConfigs(virDomainObjListPtr doms,\n                               const char *configDir,\n                               const char *autostartDir,\n                               bool liveStatus,\n                               virDomainXMLOptionPtr xmlopt,\n                               virDomainLoadConfigNotify notify,\n                               void *opaque)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    VIR_INFO(\"Scanning for configs in %s\", configDir);\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    virObjectRWLockWrite(doms);\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virDomainObjPtr dom;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        /* NB: ignoring errors, so one malformed config doesn't\n           kill the whole process */\n        VIR_INFO(\"Loading config file '%s.xml'\", entry->d_name);\n        if (liveStatus)\n            dom = virDomainObjListLoadStatus(doms,\n                                             configDir,\n                                             entry->d_name,\n                                             xmlopt,\n                                             notify,\n                                             opaque);\n        else\n            dom = virDomainObjListLoadConfig(doms,\n                                             xmlopt,\n                                             configDir,\n                                             autostartDir,\n                                             entry->d_name,\n                                             notify,\n                                             opaque);\n        if (dom) {\n            if (!liveStatus)\n                dom->persistent = 1;\n            virDomainObjEndAPI(&dom);\n        } else {\n            VIR_ERROR(_(\"Failed to load config for domain '%s'\"), entry->d_name);\n        }\n    }\n\n    VIR_DIR_CLOSE(dir);\n    virObjectRWUnlock(doms);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPidFileAcquire",
          "args": [
            "BHYVE_STATE_DIR",
            "\"driver\"",
            "false",
            "getpid()"
          ],
          "line": 1284
        },
        "resolved": true,
        "details": {
          "function_name": "virPidFileAcquire",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpidfile.c",
          "lines": "413-427",
          "snippet": "int virPidFileAcquire(const char *dir,\n                      const char *name,\n                      bool waitForLock,\n                      pid_t pid)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileAcquirePath(pidfile, waitForLock, pid);\n}",
          "includes": [
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virpidfile.h\"",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virpidfile.h\"\n#include <sys/stat.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virPidFileAcquire(const char *dir,\n                      const char *name,\n                      bool waitForLock,\n                      pid_t pid)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileAcquirePath(pidfile, waitForLock, pid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "getpid",
          "args": [],
          "line": 1284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to mkdir %s\")",
            "BHYVE_STATE_DIR"
          ],
          "line": 1277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to mkdir %s\""
          ],
          "line": 1278
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileMakePath",
          "args": [
            "BHYVE_STATE_DIR"
          ],
          "line": 1276
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3076-3080",
          "snippet": "int\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to mkdir %s\")",
            "BHYVE_LOG_DIR"
          ],
          "line": 1270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBhyveLoadDriverConfig",
          "args": [
            "bhyve_driver->config",
            "SYSCONFDIR \"/libvirt/bhyve.conf\""
          ],
          "line": 1266
        },
        "resolved": true,
        "details": {
          "function_name": "virBhyveLoadDriverConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_conf.c",
          "lines": "64-83",
          "snippet": "int\nvirBhyveLoadDriverConfig(virBhyveDriverConfigPtr cfg,\n                         const char *filename)\n{\n    g_autoptr(virConf) conf = NULL;\n\n    if (access(filename, R_OK) == -1) {\n        VIR_INFO(\"Could not read bhyve config file %s\", filename);\n        return 0;\n    }\n\n    if (!(conf = virConfReadFile(filename, 0)))\n        return -1;\n\n    if (virConfGetValueString(conf, \"firmware_dir\",\n                              &cfg->firmwareDir) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_conf.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint\nvirBhyveLoadDriverConfig(virBhyveDriverConfigPtr cfg,\n                         const char *filename)\n{\n    g_autoptr(virConf) conf = NULL;\n\n    if (access(filename, R_OK) == -1) {\n        VIR_INFO(\"Could not read bhyve config file %s\", filename);\n        return 0;\n    }\n\n    if (!(conf = virConfReadFile(filename, 0)))\n        return -1;\n\n    if (virConfGetValueString(conf, \"firmware_dir\",\n                              &cfg->firmwareDir) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBhyveDriverConfigNew",
          "args": [],
          "line": 1263
        },
        "resolved": true,
        "details": {
          "function_name": "virBhyveDriverConfigNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_conf.c",
          "lines": "48-62",
          "snippet": "virBhyveDriverConfigPtr\nvirBhyveDriverConfigNew(void)\n{\n    virBhyveDriverConfigPtr cfg;\n\n    if (virBhyveConfigInitialize() < 0)\n        return NULL;\n\n    if (!(cfg = virObjectNew(virBhyveDriverConfigClass)))\n        return NULL;\n\n    cfg->firmwareDir = g_strdup(DATADIR \"/uefi-firmware\");\n\n    return cfg;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virBhyveDriverConfigClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_conf.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virClassPtr virBhyveDriverConfigClass;\n\nvirBhyveDriverConfigPtr\nvirBhyveDriverConfigNew(void)\n{\n    virBhyveDriverConfigPtr cfg;\n\n    if (virBhyveConfigInitialize() < 0)\n        return NULL;\n\n    if (!(cfg = virObjectNew(virBhyveDriverConfigClass)))\n        return NULL;\n\n    cfg->firmwareDir = g_strdup(DATADIR \"/uefi-firmware\");\n\n    return cfg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoRead",
          "args": [],
          "line": 1261
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1188-1211",
          "snippet": "virSysinfoDefPtr\nvirSysinfoRead(void)\n{\n#if defined(__powerpc__)\n    return virSysinfoReadPPC();\n#elif defined(__arm__) || defined(__aarch64__)\n    return virSysinfoReadARM();\n#elif defined(__s390__) || defined(__s390x__)\n    return virSysinfoReadS390();\n#elif !defined(WIN32) && \\\n    (defined(__x86_64__) || \\\n     defined(__i386__) || \\\n     defined(__amd64__))\n    return virSysinfoReadDMI();\n#else /* WIN32 || not supported arch */\n    /*\n     * this can probably be extracted from Windows using API or registry\n     * http://www.microsoft.com/whdc/system/platform/firmware/SMBIOS.mspx\n     */\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Host sysinfo extraction not supported on this platform\"));\n    return NULL;\n#endif /* WIN32 || not supported arch */\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirSysinfoDefPtr\nvirSysinfoRead(void)\n{\n#if defined(__powerpc__)\n    return virSysinfoReadPPC();\n#elif defined(__arm__) || defined(__aarch64__)\n    return virSysinfoReadARM();\n#elif defined(__s390__) || defined(__s390x__)\n    return virSysinfoReadS390();\n#elif !defined(WIN32) && \\\n    (defined(__x86_64__) || \\\n     defined(__i386__) || \\\n     defined(__amd64__))\n    return virSysinfoReadDMI();\n#else /* WIN32 || not supported arch */\n    /*\n     * this can probably be extracted from Windows using API or registry\n     * http://www.microsoft.com/whdc/system/platform/firmware/SMBIOS.mspx\n     */\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Host sysinfo extraction not supported on this platform\"));\n    return NULL;\n#endif /* WIN32 || not supported arch */\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPortAllocatorRangeNew",
          "args": [
            "_(\"display\")",
            "5900",
            "65535"
          ],
          "line": 1257
        },
        "resolved": true,
        "details": {
          "function_name": "virPortAllocatorRangeNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virportallocator.c",
          "lines": "96-117",
          "snippet": "virPortAllocatorRangePtr\nvirPortAllocatorRangeNew(const char *name,\n                         unsigned short start,\n                         unsigned short end)\n{\n    virPortAllocatorRangePtr range;\n\n    if (start >= end) {\n        virReportInvalidArg(start, \"start port %d must be less than end port %d\",\n                            start, end);\n        return NULL;\n    }\n\n    if (VIR_ALLOC(range) < 0)\n        return NULL;\n\n    range->start = start;\n    range->end = end;\n    range->name = g_strdup(name);\n\n    return range;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virthread.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virbitmap.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsocket.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virthread.h\"\n#include \"virportallocator.h\"\n#include \"virbitmap.h\"\n#include \"viralloc.h\"\n#include \"virsocket.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirPortAllocatorRangePtr\nvirPortAllocatorRangeNew(const char *name,\n                         unsigned short start,\n                         unsigned short end)\n{\n    virPortAllocatorRangePtr range;\n\n    if (start >= end) {\n        virReportInvalidArg(start, \"start port %d must be less than end port %d\",\n                            start, end);\n        return NULL;\n    }\n\n    if (VIR_ALLOC(range) < 0)\n        return NULL;\n\n    range->start = start;\n    range->end = end;\n    range->name = g_strdup(name);\n\n    return range;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateNew",
          "args": [],
          "line": 1254
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "558-582",
          "snippet": "virObjectEventStatePtr\nvirObjectEventStateNew(void)\n{\n    virObjectEventStatePtr state = NULL;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!(state = virObjectLockableNew(virObjectEventStateClass)))\n        return NULL;\n\n    if (VIR_ALLOC(state->callbacks) < 0)\n        goto error;\n\n    if (!(state->queue = virObjectEventQueueNew()))\n        goto error;\n\n    state->timer = -1;\n\n    return state;\n\n error:\n    virObjectUnref(state);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectEventStateClass;",
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectEventStateClass;\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvirObjectEventStatePtr\nvirObjectEventStateNew(void)\n{\n    virObjectEventStatePtr state = NULL;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!(state = virObjectLockableNew(virObjectEventStateClass)))\n        return NULL;\n\n    if (VIR_ALLOC(state->callbacks) < 0)\n        goto error;\n\n    if (!(state->queue = virObjectEventQueueNew()))\n        goto error;\n\n    state->timer = -1;\n\n    return state;\n\n error:\n    virObjectUnref(state);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListNew",
          "args": [],
          "line": 1251
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "68-85",
          "snippet": "virDomainObjListPtr virDomainObjListNew(void)\n{\n    virDomainObjListPtr doms;\n\n    if (virDomainObjListInitialize() < 0)\n        return NULL;\n\n    if (!(doms = virObjectRWLockableNew(virDomainObjListClass)))\n        return NULL;\n\n    if (!(doms->objs = virHashCreate(50, virObjectFreeHashData)) ||\n        !(doms->objsName = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(doms);\n        return NULL;\n    }\n\n    return doms;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virDomainObjListClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virClassPtr virDomainObjListClass;\n\nvirDomainObjListPtr virDomainObjListNew(void)\n{\n    virDomainObjListPtr doms;\n\n    if (virDomainObjListInitialize() < 0)\n        return NULL;\n\n    if (!(doms = virObjectRWLockableNew(virDomainObjListClass)))\n        return NULL;\n\n    if (!(doms->objs = virHashCreate(50, virObjectFreeHashData)) ||\n        !(doms->objsName = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(doms);\n        return NULL;\n    }\n\n    return doms;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBhyveDriverCreateXMLConf",
          "args": [
            "bhyve_driver"
          ],
          "line": 1248
        },
        "resolved": true,
        "details": {
          "function_name": "virBhyveDriverCreateXMLConf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_domain.c",
          "lines": "179-187",
          "snippet": "virDomainXMLOptionPtr\nvirBhyveDriverCreateXMLConf(bhyveConnPtr driver)\n{\n    virBhyveDriverDomainDefParserConfig.priv = driver;\n    return virDomainXMLOptionNew(&virBhyveDriverDomainDefParserConfig,\n                                 &virBhyveDriverPrivateDataCallbacks,\n                                 &virBhyveDriverDomainXMLNamespace,\n                                 NULL, NULL);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"bhyve_driver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virDomainXMLPrivateDataCallbacks virBhyveDriverPrivateDataCallbacks = {\n    .alloc = bhyveDomainObjPrivateAlloc,\n    .free = bhyveDomainObjPrivateFree,\n};",
            "virDomainDefParserConfig virBhyveDriverDomainDefParserConfig = {\n    .devicesPostParseCallback = bhyveDomainDeviceDefPostParse,\n    .domainPostParseCallback = bhyveDomainDefPostParse,\n    .assignAddressesCallback = bhyveDomainDefAssignAddresses,\n};",
            "virXMLNamespace virBhyveDriverDomainXMLNamespace = {\n    .parse = bhyveDomainDefNamespaceParse,\n    .free = bhyveDomainDefNamespaceFree,\n    .format = bhyveDomainDefNamespaceFormatXML,\n    .prefix = \"bhyve\",\n    .uri = \"http://libvirt.org/schemas/domain/bhyve/1.0\",\n\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"bhyve_capabilities.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"bhyve_driver.h\"\n#include <config.h>\n\nvirDomainXMLPrivateDataCallbacks virBhyveDriverPrivateDataCallbacks = {\n    .alloc = bhyveDomainObjPrivateAlloc,\n    .free = bhyveDomainObjPrivateFree,\n};\nvirDomainDefParserConfig virBhyveDriverDomainDefParserConfig = {\n    .devicesPostParseCallback = bhyveDomainDeviceDefPostParse,\n    .domainPostParseCallback = bhyveDomainDefPostParse,\n    .assignAddressesCallback = bhyveDomainDefAssignAddresses,\n};\nvirXMLNamespace virBhyveDriverDomainXMLNamespace = {\n    .parse = bhyveDomainDefNamespaceParse,\n    .free = bhyveDomainDefNamespaceFree,\n    .format = bhyveDomainDefNamespaceFormatXML,\n    .prefix = \"bhyve\",\n    .uri = \"http://libvirt.org/schemas/domain/bhyve/1.0\",\n\n};\n\nvirDomainXMLOptionPtr\nvirBhyveDriverCreateXMLConf(bhyveConnPtr driver)\n{\n    virBhyveDriverDomainDefParserConfig.priv = driver;\n    return virDomainXMLOptionNew(&virBhyveDriverDomainDefParserConfig,\n                                 &virBhyveDriverPrivateDataCallbacks,\n                                 &virBhyveDriverDomainXMLNamespace,\n                                 NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBhyveProbeGrubCaps",
          "args": [
            "&bhyve_driver->grubcaps"
          ],
          "line": 1245
        },
        "resolved": true,
        "details": {
          "function_name": "virBhyveProbeGrubCaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_capabilities.c",
          "lines": "180-212",
          "snippet": "int\nvirBhyveProbeGrubCaps(virBhyveGrubCapsFlags *caps)\n{\n    char *binary, *help;\n    virCommandPtr cmd;\n    int ret, exit;\n\n    ret = 0;\n    *caps = 0;\n    cmd = NULL;\n    help = NULL;\n\n    binary = virFindFileInPath(\"grub-bhyve\");\n    if (binary == NULL)\n        goto out;\n\n    cmd = virCommandNew(binary);\n    virCommandAddArg(cmd, \"--help\");\n    virCommandSetOutputBuffer(cmd, &help);\n    if (virCommandRun(cmd, &exit) < 0) {\n        ret = -1;\n        goto out;\n    }\n\n    if (strstr(help, \"--cons-dev\") != NULL)\n        *caps |= BHYVE_GRUB_CAP_CONSDEV;\n\n out:\n    VIR_FREE(help);\n    virCommandFree(cmd);\n    VIR_FREE(binary);\n    return ret;\n}",
          "includes": [
            "#include \"bhyve_conf.h\"",
            "#include \"bhyve_capabilities.h\"",
            "#include \"vircommand.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include <sys/types.h>",
            "#include <dirent.h>",
            "#include <sys/utsname.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_conf.h\"\n#include \"bhyve_capabilities.h\"\n#include \"vircommand.h\"\n#include \"domain_conf.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include <sys/types.h>\n#include <dirent.h>\n#include <sys/utsname.h>\n#include <config.h>\n\nint\nvirBhyveProbeGrubCaps(virBhyveGrubCapsFlags *caps)\n{\n    char *binary, *help;\n    virCommandPtr cmd;\n    int ret, exit;\n\n    ret = 0;\n    *caps = 0;\n    cmd = NULL;\n    help = NULL;\n\n    binary = virFindFileInPath(\"grub-bhyve\");\n    if (binary == NULL)\n        goto out;\n\n    cmd = virCommandNew(binary);\n    virCommandAddArg(cmd, \"--help\");\n    virCommandSetOutputBuffer(cmd, &help);\n    if (virCommandRun(cmd, &exit) < 0) {\n        ret = -1;\n        goto out;\n    }\n\n    if (strstr(help, \"--cons-dev\") != NULL)\n        *caps |= BHYVE_GRUB_CAP_CONSDEV;\n\n out:\n    VIR_FREE(help);\n    virCommandFree(cmd);\n    VIR_FREE(binary);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBhyveProbeCaps",
          "args": [
            "&bhyve_driver->bhyvecaps"
          ],
          "line": 1242
        },
        "resolved": true,
        "details": {
          "function_name": "virBhyveProbeCaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_capabilities.c",
          "lines": "326-357",
          "snippet": "int\nvirBhyveProbeCaps(unsigned int *caps)\n{\n    char *binary;\n    int ret = 0;\n\n    binary = virFindFileInPath(\"bhyve\");\n    if (binary == NULL)\n        goto out;\n\n    if ((ret = bhyveProbeCapsFromHelp(caps, binary)))\n        goto out;\n\n    if ((ret = bhyveProbeCapsAHCI32Slot(caps, binary)))\n        goto out;\n\n    if ((ret = bhyveProbeCapsNetE1000(caps, binary)))\n        goto out;\n\n    if ((ret = bhyveProbeCapsLPC_Bootrom(caps, binary)))\n        goto out;\n\n    if ((ret = bhyveProbeCapsFramebuffer(caps, binary)))\n        goto out;\n\n    if ((ret = bhyveProbeCapsXHCIController(caps, binary)))\n        goto out;\n\n out:\n    VIR_FREE(binary);\n    return ret;\n}",
          "includes": [
            "#include \"bhyve_conf.h\"",
            "#include \"bhyve_capabilities.h\"",
            "#include \"vircommand.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include <sys/types.h>",
            "#include <dirent.h>",
            "#include <sys/utsname.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_conf.h\"\n#include \"bhyve_capabilities.h\"\n#include \"vircommand.h\"\n#include \"domain_conf.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include <sys/types.h>\n#include <dirent.h>\n#include <sys/utsname.h>\n#include <config.h>\n\nint\nvirBhyveProbeCaps(unsigned int *caps)\n{\n    char *binary;\n    int ret = 0;\n\n    binary = virFindFileInPath(\"bhyve\");\n    if (binary == NULL)\n        goto out;\n\n    if ((ret = bhyveProbeCapsFromHelp(caps, binary)))\n        goto out;\n\n    if ((ret = bhyveProbeCapsAHCI32Slot(caps, binary)))\n        goto out;\n\n    if ((ret = bhyveProbeCapsNetE1000(caps, binary)))\n        goto out;\n\n    if ((ret = bhyveProbeCapsLPC_Bootrom(caps, binary)))\n        goto out;\n\n    if ((ret = bhyveProbeCapsFramebuffer(caps, binary)))\n        goto out;\n\n    if ((ret = bhyveProbeCapsXHCIController(caps, binary)))\n        goto out;\n\n out:\n    VIR_FREE(binary);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBhyveCapsBuild",
          "args": [],
          "line": 1239
        },
        "resolved": true,
        "details": {
          "function_name": "virBhyveCapsBuild",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_capabilities.c",
          "lines": "43-71",
          "snippet": "virCapsPtr\nvirBhyveCapsBuild(void)\n{\n    virCapsPtr caps;\n    virCapsGuestPtr guest;\n\n    if ((caps = virCapabilitiesNew(virArchFromHost(),\n                                   false, false)) == NULL)\n        return NULL;\n\n    if ((guest = virCapabilitiesAddGuest(caps, VIR_DOMAIN_OSTYPE_HVM,\n                                         VIR_ARCH_X86_64,\n                                         \"bhyve\",\n                                         NULL, 0, NULL)) == NULL)\n        goto error;\n\n    if (virCapabilitiesAddGuestDomain(guest, VIR_DOMAIN_VIRT_BHYVE,\n                                      NULL, NULL, 0, NULL) == NULL)\n        goto error;\n\n    if (!(caps->host.cpu = virCPUProbeHost(caps->host.arch)))\n        VIR_WARN(\"Failed to get host CPU\");\n\n    return caps;\n\n error:\n    virObjectUnref(caps);\n    return NULL;\n}",
          "includes": [
            "#include \"bhyve_conf.h\"",
            "#include \"bhyve_capabilities.h\"",
            "#include \"vircommand.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include <sys/types.h>",
            "#include <dirent.h>",
            "#include <sys/utsname.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_conf.h\"\n#include \"bhyve_capabilities.h\"\n#include \"vircommand.h\"\n#include \"domain_conf.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include <sys/types.h>\n#include <dirent.h>\n#include <sys/utsname.h>\n#include <config.h>\n\nvirCapsPtr\nvirBhyveCapsBuild(void)\n{\n    virCapsPtr caps;\n    virCapsGuestPtr guest;\n\n    if ((caps = virCapabilitiesNew(virArchFromHost(),\n                                   false, false)) == NULL)\n        return NULL;\n\n    if ((guest = virCapabilitiesAddGuest(caps, VIR_DOMAIN_OSTYPE_HVM,\n                                         VIR_ARCH_X86_64,\n                                         \"bhyve\",\n                                         NULL, 0, NULL)) == NULL)\n        goto error;\n\n    if (virCapabilitiesAddGuestDomain(guest, VIR_DOMAIN_VIRT_BHYVE,\n                                      NULL, NULL, 0, NULL) == NULL)\n        goto error;\n\n    if (!(caps->host.cpu = virCPUProbeHost(caps->host.arch)))\n        VIR_WARN(\"Failed to get host CPU\");\n\n    return caps;\n\n error:\n    virObjectUnref(caps);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCloseCallbacksNew",
          "args": [],
          "line": 1236
        },
        "resolved": true,
        "details": {
          "function_name": "virCloseCallbacksNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/virclosecallbacks.c",
          "lines": "61-79",
          "snippet": "virCloseCallbacksPtr\nvirCloseCallbacksNew(void)\n{\n    virCloseCallbacksPtr closeCallbacks;\n\n    if (virCloseCallbacksInitialize() < 0)\n        return NULL;\n\n    if (!(closeCallbacks = virObjectLockableNew(virCloseCallbacksClass)))\n        return NULL;\n\n    closeCallbacks->list = virHashCreate(5, virHashValueFree);\n    if (!closeCallbacks->list) {\n        virObjectUnref(closeCallbacks);\n        return NULL;\n    }\n\n    return closeCallbacks;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"virclosecallbacks.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virCloseCallbacksClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virclosecallbacks.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virClassPtr virCloseCallbacksClass;\n\nvirCloseCallbacksPtr\nvirCloseCallbacksNew(void)\n{\n    virCloseCallbacksPtr closeCallbacks;\n\n    if (virCloseCallbacksInitialize() < 0)\n        return NULL;\n\n    if (!(closeCallbacks = virObjectLockableNew(virCloseCallbacksClass)))\n        return NULL;\n\n    closeCallbacks->list = virHashCreate(5, virHashValueFree);\n    if (!closeCallbacks->list) {\n        virObjectUnref(closeCallbacks);\n        return NULL;\n    }\n\n    return closeCallbacks;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "bhyve_driver"
          ],
          "line": 1232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMutexInit",
          "args": [
            "&bhyve_driver->lock"
          ],
          "line": 1231
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexInitRecursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "61-74",
          "snippet": "int virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "bhyve_driver"
          ],
          "line": 1227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Not running privileged, disabling driver\""
          ],
          "line": 1223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"Driver does not support embedded mode\")"
          ],
          "line": 1217
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nbhyveConnPtr bhyve_driver = NULL;\n\nstatic int\nbhyveStateInitialize(bool privileged,\n                     const char *root,\n                     virStateInhibitCallback callback G_GNUC_UNUSED,\n                     void *opaque G_GNUC_UNUSED)\n{\n    bool autostart = true;\n\n    if (root != NULL) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Driver does not support embedded mode\"));\n        return -1;\n    }\n\n    if (!privileged) {\n        VIR_INFO(\"Not running privileged, disabling driver\");\n        return VIR_DRV_STATE_INIT_SKIPPED;\n    }\n\n    if (VIR_ALLOC(bhyve_driver) < 0)\n        return VIR_DRV_STATE_INIT_ERROR;\n\n    bhyve_driver->lockFD = -1;\n    if (virMutexInit(&bhyve_driver->lock) < 0) {\n        VIR_FREE(bhyve_driver);\n        return VIR_DRV_STATE_INIT_ERROR;\n    }\n\n    if (!(bhyve_driver->closeCallbacks = virCloseCallbacksNew()))\n        goto cleanup;\n\n    if (!(bhyve_driver->caps = virBhyveCapsBuild()))\n        goto cleanup;\n\n    if (virBhyveProbeCaps(&bhyve_driver->bhyvecaps) < 0)\n        goto cleanup;\n\n    if (virBhyveProbeGrubCaps(&bhyve_driver->grubcaps) < 0)\n        goto cleanup;\n\n    if (!(bhyve_driver->xmlopt = virBhyveDriverCreateXMLConf(bhyve_driver)))\n        goto cleanup;\n\n    if (!(bhyve_driver->domains = virDomainObjListNew()))\n        goto cleanup;\n\n    if (!(bhyve_driver->domainEventState = virObjectEventStateNew()))\n        goto cleanup;\n\n    if (!(bhyve_driver->remotePorts = virPortAllocatorRangeNew(_(\"display\"),\n                                                               5900, 65535)))\n        goto cleanup;\n\n    bhyve_driver->hostsysinfo = virSysinfoRead();\n\n    if (!(bhyve_driver->config = virBhyveDriverConfigNew()))\n        goto cleanup;\n\n    if (virBhyveLoadDriverConfig(bhyve_driver->config, SYSCONFDIR \"/libvirt/bhyve.conf\") < 0)\n        goto cleanup;\n\n    if (virFileMakePath(BHYVE_LOG_DIR) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to mkdir %s\"),\n                             BHYVE_LOG_DIR);\n        goto cleanup;\n    }\n\n    if (virFileMakePath(BHYVE_STATE_DIR) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to mkdir %s\"),\n                             BHYVE_STATE_DIR);\n        goto cleanup;\n    }\n\n    if ((bhyve_driver->lockFD =\n         virPidFileAcquire(BHYVE_STATE_DIR, \"driver\", false, getpid())) < 0)\n        goto cleanup;\n\n    if (virDomainObjListLoadAllConfigs(bhyve_driver->domains,\n                                       BHYVE_STATE_DIR,\n                                       NULL, true,\n                                       bhyve_driver->xmlopt,\n                                       NULL, NULL) < 0)\n        goto cleanup;\n\n    if (virDomainObjListLoadAllConfigs(bhyve_driver->domains,\n                                       BHYVE_CONFIG_DIR,\n                                       BHYVE_AUTOSTART_DIR, false,\n                                       bhyve_driver->xmlopt,\n                                       NULL, NULL) < 0)\n        goto cleanup;\n\n    virBhyveProcessReconnectAll(bhyve_driver);\n\n    if (virDriverShouldAutostart(BHYVE_STATE_DIR, &autostart) < 0)\n        goto cleanup;\n\n    if (autostart)\n        bhyveAutostartDomains(bhyve_driver);\n\n    return VIR_DRV_STATE_INIT_COMPLETE;\n\n cleanup:\n    bhyveStateCleanup();\n    return VIR_DRV_STATE_INIT_ERROR;\n}"
  },
  {
    "function_name": "bhyveStateCleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1182-1206",
    "snippet": "static int\nbhyveStateCleanup(void)\n{\n    VIR_DEBUG(\"bhyve state cleanup\");\n\n    if (bhyve_driver == NULL)\n        return -1;\n\n    virObjectUnref(bhyve_driver->domains);\n    virObjectUnref(bhyve_driver->caps);\n    virObjectUnref(bhyve_driver->xmlopt);\n    virSysinfoDefFree(bhyve_driver->hostsysinfo);\n    virObjectUnref(bhyve_driver->closeCallbacks);\n    virObjectUnref(bhyve_driver->domainEventState);\n    virObjectUnref(bhyve_driver->config);\n    virPortAllocatorRangeFree(bhyve_driver->remotePorts);\n\n    if (bhyve_driver->lockFD != -1)\n        virPidFileRelease(BHYVE_STATE_DIR, \"driver\", bhyve_driver->lockFD);\n\n    virMutexDestroy(&bhyve_driver->lock);\n    VIR_FREE(bhyve_driver);\n\n    return 0;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bhyveConnPtr bhyve_driver = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "bhyve_driver"
          ],
          "line": 1203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMutexDestroy",
          "args": [
            "&bhyve_driver->lock"
          ],
          "line": 1202
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexDestroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "76-79",
          "snippet": "void virMutexDestroy(virMutexPtr m)\n{\n    pthread_mutex_destroy(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexDestroy(virMutexPtr m)\n{\n    pthread_mutex_destroy(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPidFileRelease",
          "args": [
            "BHYVE_STATE_DIR",
            "\"driver\"",
            "bhyve_driver->lockFD"
          ],
          "line": 1200
        },
        "resolved": true,
        "details": {
          "function_name": "virPidFileRelease",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpidfile.c",
          "lines": "453-466",
          "snippet": "int virPidFileRelease(const char *dir,\n                      const char *name,\n                      int fd)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileReleasePath(pidfile, fd);\n}",
          "includes": [
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virpidfile.h\"",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virpidfile.h\"\n#include <sys/stat.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virPidFileRelease(const char *dir,\n                      const char *name,\n                      int fd)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileReleasePath(pidfile, fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPortAllocatorRangeFree",
          "args": [
            "bhyve_driver->remotePorts"
          ],
          "line": 1197
        },
        "resolved": true,
        "details": {
          "function_name": "virPortAllocatorRangeFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virportallocator.c",
          "lines": "119-127",
          "snippet": "void\nvirPortAllocatorRangeFree(virPortAllocatorRangePtr range)\n{\n    if (!range)\n        return;\n\n    VIR_FREE(range->name);\n    VIR_FREE(range);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virthread.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virbitmap.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsocket.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virthread.h\"\n#include \"virportallocator.h\"\n#include \"virbitmap.h\"\n#include \"viralloc.h\"\n#include \"virsocket.h\"\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirPortAllocatorRangeFree(virPortAllocatorRangePtr range)\n{\n    if (!range)\n        return;\n\n    VIR_FREE(range->name);\n    VIR_FREE(range);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "bhyve_driver->config"
          ],
          "line": 1196
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoDefFree",
          "args": [
            "bhyve_driver->hostsysinfo"
          ],
          "line": 1193
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "144-191",
          "snippet": "void virSysinfoDefFree(virSysinfoDefPtr def)\n{\n    size_t i;\n\n    if (def == NULL)\n        return;\n\n    virSysinfoBIOSDefFree(def->bios);\n    virSysinfoSystemDefFree(def->system);\n\n    for (i = 0; i < def->nbaseBoard; i++)\n        virSysinfoBaseBoardDefClear(def->baseBoard + i);\n    VIR_FREE(def->baseBoard);\n\n    virSysinfoChassisDefFree(def->chassis);\n\n    for (i = 0; i < def->nprocessor; i++) {\n        VIR_FREE(def->processor[i].processor_socket_destination);\n        VIR_FREE(def->processor[i].processor_type);\n        VIR_FREE(def->processor[i].processor_family);\n        VIR_FREE(def->processor[i].processor_manufacturer);\n        VIR_FREE(def->processor[i].processor_signature);\n        VIR_FREE(def->processor[i].processor_version);\n        VIR_FREE(def->processor[i].processor_external_clock);\n        VIR_FREE(def->processor[i].processor_max_speed);\n        VIR_FREE(def->processor[i].processor_status);\n        VIR_FREE(def->processor[i].processor_serial_number);\n        VIR_FREE(def->processor[i].processor_part_number);\n    }\n    VIR_FREE(def->processor);\n    for (i = 0; i < def->nmemory; i++) {\n        VIR_FREE(def->memory[i].memory_size);\n        VIR_FREE(def->memory[i].memory_form_factor);\n        VIR_FREE(def->memory[i].memory_locator);\n        VIR_FREE(def->memory[i].memory_bank_locator);\n        VIR_FREE(def->memory[i].memory_type);\n        VIR_FREE(def->memory[i].memory_type_detail);\n        VIR_FREE(def->memory[i].memory_speed);\n        VIR_FREE(def->memory[i].memory_manufacturer);\n        VIR_FREE(def->memory[i].memory_serial_number);\n        VIR_FREE(def->memory[i].memory_part_number);\n    }\n    VIR_FREE(def->memory);\n\n    virSysinfoOEMStringsDefFree(def->oemStrings);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoDefFree(virSysinfoDefPtr def)\n{\n    size_t i;\n\n    if (def == NULL)\n        return;\n\n    virSysinfoBIOSDefFree(def->bios);\n    virSysinfoSystemDefFree(def->system);\n\n    for (i = 0; i < def->nbaseBoard; i++)\n        virSysinfoBaseBoardDefClear(def->baseBoard + i);\n    VIR_FREE(def->baseBoard);\n\n    virSysinfoChassisDefFree(def->chassis);\n\n    for (i = 0; i < def->nprocessor; i++) {\n        VIR_FREE(def->processor[i].processor_socket_destination);\n        VIR_FREE(def->processor[i].processor_type);\n        VIR_FREE(def->processor[i].processor_family);\n        VIR_FREE(def->processor[i].processor_manufacturer);\n        VIR_FREE(def->processor[i].processor_signature);\n        VIR_FREE(def->processor[i].processor_version);\n        VIR_FREE(def->processor[i].processor_external_clock);\n        VIR_FREE(def->processor[i].processor_max_speed);\n        VIR_FREE(def->processor[i].processor_status);\n        VIR_FREE(def->processor[i].processor_serial_number);\n        VIR_FREE(def->processor[i].processor_part_number);\n    }\n    VIR_FREE(def->processor);\n    for (i = 0; i < def->nmemory; i++) {\n        VIR_FREE(def->memory[i].memory_size);\n        VIR_FREE(def->memory[i].memory_form_factor);\n        VIR_FREE(def->memory[i].memory_locator);\n        VIR_FREE(def->memory[i].memory_bank_locator);\n        VIR_FREE(def->memory[i].memory_type);\n        VIR_FREE(def->memory[i].memory_type_detail);\n        VIR_FREE(def->memory[i].memory_speed);\n        VIR_FREE(def->memory[i].memory_manufacturer);\n        VIR_FREE(def->memory[i].memory_serial_number);\n        VIR_FREE(def->memory[i].memory_part_number);\n    }\n    VIR_FREE(def->memory);\n\n    virSysinfoOEMStringsDefFree(def->oemStrings);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"bhyve state cleanup\""
          ],
          "line": 1185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nbhyveConnPtr bhyve_driver = NULL;\n\nstatic int\nbhyveStateCleanup(void)\n{\n    VIR_DEBUG(\"bhyve state cleanup\");\n\n    if (bhyve_driver == NULL)\n        return -1;\n\n    virObjectUnref(bhyve_driver->domains);\n    virObjectUnref(bhyve_driver->caps);\n    virObjectUnref(bhyve_driver->xmlopt);\n    virSysinfoDefFree(bhyve_driver->hostsysinfo);\n    virObjectUnref(bhyve_driver->closeCallbacks);\n    virObjectUnref(bhyve_driver->domainEventState);\n    virObjectUnref(bhyve_driver->config);\n    virPortAllocatorRangeFree(bhyve_driver->remotePorts);\n\n    if (bhyve_driver->lockFD != -1)\n        virPidFileRelease(BHYVE_STATE_DIR, \"driver\", bhyve_driver->lockFD);\n\n    virMutexDestroy(&bhyve_driver->lock);\n    VIR_FREE(bhyve_driver);\n\n    return 0;\n}"
  },
  {
    "function_name": "bhyveNodeGetInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1172-1180",
    "snippet": "static int\nbhyveNodeGetInfo(virConnectPtr conn,\n                 virNodeInfoPtr nodeinfo)\n{\n    if (virNodeGetInfoEnsureACL(conn) < 0)\n        return -1;\n\n    return virCapabilitiesGetNodeInfo(nodeinfo);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCapabilitiesGetNodeInfo",
          "args": [
            "nodeinfo"
          ],
          "line": 1179
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesGetNodeInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "1434-1456",
          "snippet": "int\nvirCapabilitiesGetNodeInfo(virNodeInfoPtr nodeinfo)\n{\n    virArch hostarch = virArchFromHost();\n    unsigned long long memorybytes;\n\n    memset(nodeinfo, 0, sizeof(*nodeinfo));\n\n    if (virStrcpyStatic(nodeinfo->model, virArchToString(hostarch)) < 0)\n        return -1;\n\n    if (virHostMemGetInfo(&memorybytes, NULL) < 0)\n        return -1;\n    nodeinfo->memory = memorybytes / 1024;\n\n    if (virHostCPUGetInfo(hostarch,\n                          &nodeinfo->cpus, &nodeinfo->mhz,\n                          &nodeinfo->nodes, &nodeinfo->sockets,\n                          &nodeinfo->cores, &nodeinfo->threads) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirCapabilitiesGetNodeInfo(virNodeInfoPtr nodeinfo)\n{\n    virArch hostarch = virArchFromHost();\n    unsigned long long memorybytes;\n\n    memset(nodeinfo, 0, sizeof(*nodeinfo));\n\n    if (virStrcpyStatic(nodeinfo->model, virArchToString(hostarch)) < 0)\n        return -1;\n\n    if (virHostMemGetInfo(&memorybytes, NULL) < 0)\n        return -1;\n    nodeinfo->memory = memorybytes / 1024;\n\n    if (virHostCPUGetInfo(hostarch,\n                          &nodeinfo->cpus, &nodeinfo->mhz,\n                          &nodeinfo->nodes, &nodeinfo->sockets,\n                          &nodeinfo->cores, &nodeinfo->threads) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetInfoEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1176
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveNodeGetInfo(virConnectPtr conn,\n                 virNodeInfoPtr nodeinfo)\n{\n    if (virNodeGetInfoEnsureACL(conn) < 0)\n        return -1;\n\n    return virCapabilitiesGetNodeInfo(nodeinfo);\n}"
  },
  {
    "function_name": "bhyveNodeGetMemoryStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1159-1170",
    "snippet": "static int\nbhyveNodeGetMemoryStats(virConnectPtr conn,\n                        int cellNum,\n                        virNodeMemoryStatsPtr params,\n                        int *nparams,\n                        unsigned int flags)\n{\n    if (virNodeGetMemoryStatsEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemGetStats(cellNum, params, nparams, flags);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostMemGetStats",
          "args": [
            "cellNum",
            "params",
            "nparams",
            "flags"
          ],
          "line": 1169
        },
        "resolved": true,
        "details": {
          "function_name": "virHostMemGetStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostmem.c",
          "lines": "244-302",
          "snippet": "int\nvirHostMemGetStats(int cellNum G_GNUC_UNUSED,\n                   virNodeMemoryStatsPtr params G_GNUC_UNUSED,\n                   int *nparams G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    {\n        int ret;\n        g_autofree char *meminfo_path = NULL;\n        FILE *meminfo;\n        int max_node;\n\n        /*\n         * Even if built without numactl, libvirt claims\n         * to have a one-cells NUMA topology. In such a\n         * case return the statistics for the entire host.\n         */\n        if (!virNumaIsAvailable() && cellNum == 0)\n            cellNum = VIR_NODE_MEMORY_STATS_ALL_CELLS;\n\n        if (cellNum == VIR_NODE_MEMORY_STATS_ALL_CELLS) {\n            meminfo_path = g_strdup(MEMINFO_PATH);\n        } else {\n            if ((max_node = virNumaGetMaxNode()) < 0)\n                return -1;\n\n            if (cellNum > max_node) {\n                virReportInvalidArg(cellNum,\n                                    _(\"cellNum in %s must be less than or equal to %d\"),\n                                    __FUNCTION__, max_node);\n                return -1;\n            }\n\n            meminfo_path = g_strdup_printf(\n                                           SYSFS_SYSTEM_PATH \"/node/node%d/meminfo\", cellNum);\n        }\n        meminfo = fopen(meminfo_path, \"r\");\n\n        if (!meminfo) {\n            virReportSystemError(errno,\n                                 _(\"cannot open %s\"), meminfo_path);\n            return -1;\n        }\n        ret = virHostMemGetStatsLinux(meminfo, cellNum, params, nparams);\n        VIR_FORCE_FCLOSE(meminfo);\n\n        return ret;\n    }\n#elif defined(__FreeBSD__)\n    return virHostMemGetStatsFreeBSD(params, nparams);\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node memory stats not implemented on this platform\"));\n    return -1;\n#endif\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostmem.h\"",
            "#include \"viralloc.h\"",
            "# include <windows.h>",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostmem.h\"\n#include \"viralloc.h\"\n# include <windows.h>\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirHostMemGetStats(int cellNum G_GNUC_UNUSED,\n                   virNodeMemoryStatsPtr params G_GNUC_UNUSED,\n                   int *nparams G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    {\n        int ret;\n        g_autofree char *meminfo_path = NULL;\n        FILE *meminfo;\n        int max_node;\n\n        /*\n         * Even if built without numactl, libvirt claims\n         * to have a one-cells NUMA topology. In such a\n         * case return the statistics for the entire host.\n         */\n        if (!virNumaIsAvailable() && cellNum == 0)\n            cellNum = VIR_NODE_MEMORY_STATS_ALL_CELLS;\n\n        if (cellNum == VIR_NODE_MEMORY_STATS_ALL_CELLS) {\n            meminfo_path = g_strdup(MEMINFO_PATH);\n        } else {\n            if ((max_node = virNumaGetMaxNode()) < 0)\n                return -1;\n\n            if (cellNum > max_node) {\n                virReportInvalidArg(cellNum,\n                                    _(\"cellNum in %s must be less than or equal to %d\"),\n                                    __FUNCTION__, max_node);\n                return -1;\n            }\n\n            meminfo_path = g_strdup_printf(\n                                           SYSFS_SYSTEM_PATH \"/node/node%d/meminfo\", cellNum);\n        }\n        meminfo = fopen(meminfo_path, \"r\");\n\n        if (!meminfo) {\n            virReportSystemError(errno,\n                                 _(\"cannot open %s\"), meminfo_path);\n            return -1;\n        }\n        ret = virHostMemGetStatsLinux(meminfo, cellNum, params, nparams);\n        VIR_FORCE_FCLOSE(meminfo);\n\n        return ret;\n    }\n#elif defined(__FreeBSD__)\n    return virHostMemGetStatsFreeBSD(params, nparams);\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node memory stats not implemented on this platform\"));\n    return -1;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetMemoryStatsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1166
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveNodeGetMemoryStats(virConnectPtr conn,\n                        int cellNum,\n                        virNodeMemoryStatsPtr params,\n                        int *nparams,\n                        unsigned int flags)\n{\n    if (virNodeGetMemoryStatsEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemGetStats(cellNum, params, nparams, flags);\n}"
  },
  {
    "function_name": "bhyveNodeGetCPUStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1146-1157",
    "snippet": "static int\nbhyveNodeGetCPUStats(virConnectPtr conn,\n                     int cpuNum,\n                     virNodeCPUStatsPtr params,\n                     int *nparams,\n                     unsigned int flags)\n{\n    if (virNodeGetCPUStatsEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostCPUGetStats(cpuNum, params, nparams, flags);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostCPUGetStats",
          "args": [
            "cpuNum",
            "params",
            "nparams",
            "flags"
          ],
          "line": 1156
        },
        "resolved": true,
        "details": {
          "function_name": "virHostCPUGetStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostcpu.c",
          "lines": "998-1027",
          "snippet": "int\nvirHostCPUGetStats(int cpuNum G_GNUC_UNUSED,\n                   virNodeCPUStatsPtr params G_GNUC_UNUSED,\n                   int *nparams G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    {\n        int ret;\n        FILE *procstat = fopen(PROCSTAT_PATH, \"r\");\n        if (!procstat) {\n            virReportSystemError(errno,\n                                 _(\"cannot open %s\"), PROCSTAT_PATH);\n            return -1;\n        }\n        ret = virHostCPUGetStatsLinux(procstat, cpuNum, params, nparams);\n        VIR_FORCE_FCLOSE(procstat);\n\n        return ret;\n    }\n#elif defined(__FreeBSD__)\n    return virHostCPUGetStatsFreeBSD(cpuNum, params, nparams);\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node CPU stats not implemented on this platform\"));\n    return -1;\n#endif\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostcpupriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "# include <linux/kvm.h>",
            "#include <unistd.h>",
            "# include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostcpupriv.h\"\n#include \"viralloc.h\"\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n# include <linux/kvm.h>\n#include <unistd.h>\n# include <sys/ioctl.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nint\nvirHostCPUGetStats(int cpuNum G_GNUC_UNUSED,\n                   virNodeCPUStatsPtr params G_GNUC_UNUSED,\n                   int *nparams G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    {\n        int ret;\n        FILE *procstat = fopen(PROCSTAT_PATH, \"r\");\n        if (!procstat) {\n            virReportSystemError(errno,\n                                 _(\"cannot open %s\"), PROCSTAT_PATH);\n            return -1;\n        }\n        ret = virHostCPUGetStatsLinux(procstat, cpuNum, params, nparams);\n        VIR_FORCE_FCLOSE(procstat);\n\n        return ret;\n    }\n#elif defined(__FreeBSD__)\n    return virHostCPUGetStatsFreeBSD(cpuNum, params, nparams);\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node CPU stats not implemented on this platform\"));\n    return -1;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetCPUStatsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveNodeGetCPUStats(virConnectPtr conn,\n                     int cpuNum,\n                     virNodeCPUStatsPtr params,\n                     int *nparams,\n                     unsigned int flags)\n{\n    if (virNodeGetCPUStatsEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostCPUGetStats(cpuNum, params, nparams, flags);\n}"
  },
  {
    "function_name": "bhyveDomainGetMetadata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1124-1144",
    "snippet": "static char *\nbhyveDomainGetMetadata(virDomainPtr dom,\n                      int type,\n                      const char *uri,\n                      unsigned int flags)\n{\n    virDomainObjPtr vm;\n    char *ret = NULL;\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        return NULL;\n\n    if (virDomainGetMetadataEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    ret = virDomainObjGetMetadata(vm, type, uri, flags);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1142
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetMetadata",
          "args": [
            "vm",
            "type",
            "uri",
            "flags"
          ],
          "line": 1139
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetMetadata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30667-30715",
          "snippet": "char *\nvirDomainObjGetMetadata(virDomainObjPtr vm,\n                        int type,\n                        const char *uri,\n                        unsigned int flags)\n{\n    virDomainDefPtr def;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, NULL);\n\n    if (type >= VIR_DOMAIN_METADATA_LAST) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unknown metadata type '%d'\"), type);\n        return NULL;\n    }\n\n    if (!(def = virDomainObjGetOneDef(vm, flags)))\n        return NULL;\n\n    switch ((virDomainMetadataType) type) {\n    case VIR_DOMAIN_METADATA_DESCRIPTION:\n        ret = g_strdup(def->description);\n        break;\n\n    case VIR_DOMAIN_METADATA_TITLE:\n        ret = g_strdup(def->title);\n        break;\n\n    case VIR_DOMAIN_METADATA_ELEMENT:\n        if (!def->metadata)\n            break;\n\n        if (virXMLExtractNamespaceXML(def->metadata, uri, &ret) < 0)\n            return NULL;\n        break;\n\n    /* coverity[dead_error_begin] */\n    case VIR_DOMAIN_METADATA_LAST:\n        break;\n    }\n\n    if (!ret)\n        virReportError(VIR_ERR_NO_DOMAIN_METADATA, \"%s\",\n                       _(\"Requested metadata element is not present\"));\n\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nchar *\nvirDomainObjGetMetadata(virDomainObjPtr vm,\n                        int type,\n                        const char *uri,\n                        unsigned int flags)\n{\n    virDomainDefPtr def;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, NULL);\n\n    if (type >= VIR_DOMAIN_METADATA_LAST) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unknown metadata type '%d'\"), type);\n        return NULL;\n    }\n\n    if (!(def = virDomainObjGetOneDef(vm, flags)))\n        return NULL;\n\n    switch ((virDomainMetadataType) type) {\n    case VIR_DOMAIN_METADATA_DESCRIPTION:\n        ret = g_strdup(def->description);\n        break;\n\n    case VIR_DOMAIN_METADATA_TITLE:\n        ret = g_strdup(def->title);\n        break;\n\n    case VIR_DOMAIN_METADATA_ELEMENT:\n        if (!def->metadata)\n            break;\n\n        if (virXMLExtractNamespaceXML(def->metadata, uri, &ret) < 0)\n            return NULL;\n        break;\n\n    /* coverity[dead_error_begin] */\n    case VIR_DOMAIN_METADATA_LAST:\n        break;\n    }\n\n    if (!ret)\n        virReportError(VIR_ERR_NO_DOMAIN_METADATA, \"%s\",\n                       _(\"Requested metadata element is not present\"));\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetMetadataEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 1133
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "163-180",
          "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *\nbhyveDomainGetMetadata(virDomainPtr dom,\n                      int type,\n                      const char *uri,\n                      unsigned int flags)\n{\n    virDomainObjPtr vm;\n    char *ret = NULL;\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        return NULL;\n\n    if (virDomainGetMetadataEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    ret = virDomainObjGetMetadata(vm, type, uri, flags);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveDomainSetMetadata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1086-1122",
    "snippet": "static int\nbhyveDomainSetMetadata(virDomainPtr dom,\n                       int type,\n                       const char *metadata,\n                       const char *key,\n                       const char *uri,\n                       unsigned int flags)\n{\n    virConnectPtr conn = dom->conn;\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        return -1;\n\n    if (virDomainSetMetadataEnsureACL(conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    ret = virDomainObjSetMetadata(vm, type, metadata, key, uri,\n                                  privconn->xmlopt, BHYVE_STATE_DIR,\n                                  BHYVE_CONFIG_DIR, flags);\n\n    if (ret == 0) {\n        virObjectEventPtr ev = NULL;\n        ev = virDomainEventMetadataChangeNewFromObj(vm, type, uri);\n        virObjectEventStateQueue(privconn->domainEventState, ev);\n    }\n\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1120
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "privconn->domainEventState",
            "ev"
          ],
          "line": 1115
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainEventMetadataChangeNewFromObj",
          "args": [
            "vm",
            "type",
            "uri"
          ],
          "line": 1114
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventMetadataChangeNewFromObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "1552-1559",
          "snippet": "virObjectEventPtr\nvirDomainEventMetadataChangeNewFromObj(virDomainObjPtr obj,\n                                       int type,\n                                       const char *nsuri)\n{\n    return virDomainEventMetadataChangeNew(obj->def->id, obj->def->name,\n                                           obj->def->uuid, type, nsuri);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainEventDispose(void *obj);",
            "static void virDomainEventLifecycleDispose(void *obj);",
            "static void virDomainEventRTCChangeDispose(void *obj);",
            "static void virDomainEventWatchdogDispose(void *obj);",
            "static void virDomainEventIOErrorDispose(void *obj);",
            "static void virDomainEventGraphicsDispose(void *obj);",
            "static void virDomainEventBlockJobDispose(void *obj);",
            "static void virDomainEventDiskChangeDispose(void *obj);",
            "static void virDomainEventTrayChangeDispose(void *obj);",
            "static void virDomainEventBalloonChangeDispose(void *obj);",
            "static void virDomainEventDeviceRemovedDispose(void *obj);",
            "static void virDomainEventPMDispose(void *obj);",
            "static void virDomainQemuMonitorEventDispose(void *obj);",
            "static void virDomainEventTunableDispose(void *obj);",
            "static void virDomainEventAgentLifecycleDispose(void *obj);",
            "static void virDomainEventDeviceAddedDispose(void *obj);",
            "static void virDomainEventMigrationIterationDispose(void *obj);",
            "static void virDomainEventJobCompletedDispose(void *obj);",
            "static void virDomainEventDeviceRemovalFailedDispose(void *obj);",
            "static void virDomainEventMetadataChangeDispose(void *obj);",
            "static void virDomainEventBlockThresholdDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virDomainEventDispose(void *obj);\nstatic void virDomainEventLifecycleDispose(void *obj);\nstatic void virDomainEventRTCChangeDispose(void *obj);\nstatic void virDomainEventWatchdogDispose(void *obj);\nstatic void virDomainEventIOErrorDispose(void *obj);\nstatic void virDomainEventGraphicsDispose(void *obj);\nstatic void virDomainEventBlockJobDispose(void *obj);\nstatic void virDomainEventDiskChangeDispose(void *obj);\nstatic void virDomainEventTrayChangeDispose(void *obj);\nstatic void virDomainEventBalloonChangeDispose(void *obj);\nstatic void virDomainEventDeviceRemovedDispose(void *obj);\nstatic void virDomainEventPMDispose(void *obj);\nstatic void virDomainQemuMonitorEventDispose(void *obj);\nstatic void virDomainEventTunableDispose(void *obj);\nstatic void virDomainEventAgentLifecycleDispose(void *obj);\nstatic void virDomainEventDeviceAddedDispose(void *obj);\nstatic void virDomainEventMigrationIterationDispose(void *obj);\nstatic void virDomainEventJobCompletedDispose(void *obj);\nstatic void virDomainEventDeviceRemovalFailedDispose(void *obj);\nstatic void virDomainEventMetadataChangeDispose(void *obj);\nstatic void virDomainEventBlockThresholdDispose(void *obj);\n\nvirObjectEventPtr\nvirDomainEventMetadataChangeNewFromObj(virDomainObjPtr obj,\n                                       int type,\n                                       const char *nsuri)\n{\n    return virDomainEventMetadataChangeNew(obj->def->id, obj->def->name,\n                                           obj->def->uuid, type, nsuri);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSetMetadata",
          "args": [
            "vm",
            "type",
            "metadata",
            "key",
            "uri",
            "privconn->xmlopt",
            "BHYVE_STATE_DIR",
            "BHYVE_CONFIG_DIR",
            "flags"
          ],
          "line": 1108
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSetMetadata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30803-30841",
          "snippet": "int\nvirDomainObjSetMetadata(virDomainObjPtr vm,\n                        int type,\n                        const char *metadata,\n                        const char *key,\n                        const char *uri,\n                        virDomainXMLOptionPtr xmlopt,\n                        const char *stateDir,\n                        const char *configDir,\n                        unsigned int flags)\n{\n    virDomainDefPtr def;\n    virDomainDefPtr persistentDef;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        return -1;\n\n    if (def) {\n        if (virDomainDefSetMetadata(def, type, metadata, key, uri) < 0)\n            return -1;\n\n        if (virDomainObjSave(vm, xmlopt, stateDir) < 0)\n            return -1;\n    }\n\n    if (persistentDef) {\n        if (virDomainDefSetMetadata(persistentDef, type, metadata, key,\n                                    uri) < 0)\n            return -1;\n\n        if (virDomainDefSave(persistentDef, xmlopt, configDir) < 0)\n            return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjSetMetadata(virDomainObjPtr vm,\n                        int type,\n                        const char *metadata,\n                        const char *key,\n                        const char *uri,\n                        virDomainXMLOptionPtr xmlopt,\n                        const char *stateDir,\n                        const char *configDir,\n                        unsigned int flags)\n{\n    virDomainDefPtr def;\n    virDomainDefPtr persistentDef;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        return -1;\n\n    if (def) {\n        if (virDomainDefSetMetadata(def, type, metadata, key, uri) < 0)\n            return -1;\n\n        if (virDomainObjSave(vm, xmlopt, stateDir) < 0)\n            return -1;\n    }\n\n    if (persistentDef) {\n        if (virDomainDefSetMetadata(persistentDef, type, metadata, key,\n                                    uri) < 0)\n            return -1;\n\n        if (virDomainDefSave(persistentDef, xmlopt, configDir) < 0)\n            return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSetMetadataEnsureACL",
          "args": [
            "conn",
            "vm->def",
            "flags"
          ],
          "line": 1105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 1102
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "163-180",
          "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG",
            "-1"
          ],
          "line": 1099
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainSetMetadata(virDomainPtr dom,\n                       int type,\n                       const char *metadata,\n                       const char *key,\n                       const char *uri,\n                       unsigned int flags)\n{\n    virConnectPtr conn = dom->conn;\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        return -1;\n\n    if (virDomainSetMetadataEnsureACL(conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    ret = virDomainObjSetMetadata(vm, type, metadata, key, uri,\n                                  privconn->xmlopt, BHYVE_STATE_DIR,\n                                  BHYVE_CONFIG_DIR, flags);\n\n    if (ret == 0) {\n        virObjectEventPtr ev = NULL;\n        ev = virDomainEventMetadataChangeNewFromObj(vm, type, uri);\n        virObjectEventStateQueue(privconn->domainEventState, ev);\n    }\n\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveDomainOpenConsole",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1046-1084",
    "snippet": "static int\nbhyveDomainOpenConsole(virDomainPtr dom,\n                       const char *dev_name G_GNUC_UNUSED,\n                       virStreamPtr st,\n                       unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    virDomainChrDefPtr chr = NULL;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainOpenConsoleEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    if (!vm->def->nserials) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"no console devices available\"));\n        goto cleanup;\n    }\n\n    chr = vm->def->serials[0];\n\n    if (virFDStreamOpenPTY(st, chr->source->data.nmdm.slave,\n                           0, 0, O_RDWR) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1082
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFDStreamOpenPTY",
          "args": [
            "st",
            "chr->source->data.nmdm.slave",
            "0",
            "0",
            "O_RDWR"
          ],
          "line": 1075
        },
        "resolved": true,
        "details": {
          "function_name": "virFDStreamOpenPTY",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfdstream.c",
          "lines": "1473-1483",
          "snippet": "int\nvirFDStreamOpenPTY(virStreamPtr st G_GNUC_UNUSED,\n                   const char *path G_GNUC_UNUSED,\n                   unsigned long long offset G_GNUC_UNUSED,\n                   unsigned long long length G_GNUC_UNUSED,\n                   int oflags G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"File streams are not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virprocess.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virfdstream.h\"",
            "# include <termios.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virprocess.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virfdstream.h\"\n# include <termios.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirFDStreamOpenPTY(virStreamPtr st G_GNUC_UNUSED,\n                   const char *path G_GNUC_UNUSED,\n                   unsigned long long offset G_GNUC_UNUSED,\n                   unsigned long long length G_GNUC_UNUSED,\n                   int oflags G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"File streams are not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"no console devices available\")"
          ],
          "line": 1068
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no console devices available\""
          ],
          "line": 1069
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 1064
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainOpenConsoleEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 1061
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 1058
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "163-180",
          "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1056
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainOpenConsole(virDomainPtr dom,\n                       const char *dev_name G_GNUC_UNUSED,\n                       virStreamPtr st,\n                       unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    virDomainChrDefPtr chr = NULL;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainOpenConsoleEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    if (!vm->def->nserials) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"no console devices available\"));\n        goto cleanup;\n    }\n\n    chr = vm->def->serials[0];\n\n    if (virFDStreamOpenPTY(st, chr->source->data.nmdm.slave,\n                           0, 0, O_RDWR) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveDomainReboot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1017-1044",
    "snippet": "static int\nbhyveDomainReboot(virDomainPtr dom, unsigned int flags)\n{\n    virConnectPtr conn = dom->conn;\n    virDomainObjPtr vm;\n    bhyveDomainObjPrivatePtr priv;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_REBOOT_ACPI_POWER_BTN, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainRebootEnsureACL(conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    priv = vm->privateData;\n    bhyveMonitorSetReboot(priv->mon);\n\n    ret = virBhyveProcessShutdown(vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1042
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBhyveProcessShutdown",
          "args": [
            "vm"
          ],
          "line": 1039
        },
        "resolved": true,
        "details": {
          "function_name": "virBhyveProcessShutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_process.c",
          "lines": "338-359",
          "snippet": "int\nvirBhyveProcessShutdown(virDomainObjPtr vm)\n{\n    if (vm->pid <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Invalid PID %d for VM\"),\n                       (int)vm->pid);\n        return -1;\n    }\n\n    /* Bhyve tries to perform ACPI shutdown when it receives\n     * SIGTERM signal. So we just issue SIGTERM here and rely\n     * on the bhyve monitor to clean things up if process disappears.\n     */\n    if (virProcessKill(vm->pid, SIGTERM) != 0) {\n        VIR_WARN(\"Failed to terminate bhyve process for VM '%s': %s\",\n                 vm->def->name, virGetLastErrorMessage());\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virhook.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_monitor.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include <net/if_tap.h>",
            "#include <net/if.h>",
            "#include <sys/user.h>",
            "#include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>",
            "#include <kvm.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virnetdevtap.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virhook.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_monitor.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include <net/if_tap.h>\n#include <net/if.h>\n#include <sys/user.h>\n#include <sys/sysctl.h>\n#include <sys/types.h>\n#include <sys/param.h>\n#include <kvm.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirBhyveProcessShutdown(virDomainObjPtr vm)\n{\n    if (vm->pid <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Invalid PID %d for VM\"),\n                       (int)vm->pid);\n        return -1;\n    }\n\n    /* Bhyve tries to perform ACPI shutdown when it receives\n     * SIGTERM signal. So we just issue SIGTERM here and rely\n     * on the bhyve monitor to clean things up if process disappears.\n     */\n    if (virProcessKill(vm->pid, SIGTERM) != 0) {\n        VIR_WARN(\"Failed to terminate bhyve process for VM '%s': %s\",\n                 vm->def->name, virGetLastErrorMessage());\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bhyveMonitorSetReboot",
          "args": [
            "priv->mon"
          ],
          "line": 1037
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveMonitorSetReboot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_monitor.c",
          "lines": "104-108",
          "snippet": "void\nbhyveMonitorSetReboot(bhyveMonitorPtr mon)\n{\n    mon->reboot = true;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_monitor.h\"",
            "#include \"bhyve_domain.h\"",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/event.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_monitor.h\"\n#include \"bhyve_domain.h\"\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/event.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nbhyveMonitorSetReboot(bhyveMonitorPtr mon)\n{\n    mon->reboot = true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 1033
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainRebootEnsureACL",
          "args": [
            "conn",
            "vm->def",
            "flags"
          ],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 1027
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "163-180",
          "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_REBOOT_ACPI_POWER_BTN",
            "-1"
          ],
          "line": 1025
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainReboot(virDomainPtr dom, unsigned int flags)\n{\n    virConnectPtr conn = dom->conn;\n    virDomainObjPtr vm;\n    bhyveDomainObjPrivatePtr priv;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_REBOOT_ACPI_POWER_BTN, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainRebootEnsureACL(conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    priv = vm->privateData;\n    bhyveMonitorSetReboot(priv->mon);\n\n    ret = virBhyveProcessShutdown(vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveDomainShutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "1011-1015",
    "snippet": "static int\nbhyveDomainShutdown(virDomainPtr dom)\n{\n    return bhyveDomainShutdownFlags(dom, 0);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bhyveDomainShutdownFlags",
          "args": [
            "dom",
            "0"
          ],
          "line": 1014
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomainShutdownFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "987-1009",
          "snippet": "static int\nbhyveDomainShutdownFlags(virDomainPtr dom, unsigned int flags)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainShutdownFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    ret = virBhyveProcessShutdown(vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainShutdownFlags(virDomainPtr dom, unsigned int flags)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainShutdownFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    ret = virBhyveProcessShutdown(vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainShutdown(virDomainPtr dom)\n{\n    return bhyveDomainShutdownFlags(dom, 0);\n}"
  },
  {
    "function_name": "bhyveDomainShutdownFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "987-1009",
    "snippet": "static int\nbhyveDomainShutdownFlags(virDomainPtr dom, unsigned int flags)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainShutdownFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    ret = virBhyveProcessShutdown(vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1007
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBhyveProcessShutdown",
          "args": [
            "vm"
          ],
          "line": 1004
        },
        "resolved": true,
        "details": {
          "function_name": "virBhyveProcessShutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_process.c",
          "lines": "338-359",
          "snippet": "int\nvirBhyveProcessShutdown(virDomainObjPtr vm)\n{\n    if (vm->pid <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Invalid PID %d for VM\"),\n                       (int)vm->pid);\n        return -1;\n    }\n\n    /* Bhyve tries to perform ACPI shutdown when it receives\n     * SIGTERM signal. So we just issue SIGTERM here and rely\n     * on the bhyve monitor to clean things up if process disappears.\n     */\n    if (virProcessKill(vm->pid, SIGTERM) != 0) {\n        VIR_WARN(\"Failed to terminate bhyve process for VM '%s': %s\",\n                 vm->def->name, virGetLastErrorMessage());\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virhook.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_monitor.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include <net/if_tap.h>",
            "#include <net/if.h>",
            "#include <sys/user.h>",
            "#include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>",
            "#include <kvm.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virnetdevtap.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virhook.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_monitor.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include <net/if_tap.h>\n#include <net/if.h>\n#include <sys/user.h>\n#include <sys/sysctl.h>\n#include <sys/types.h>\n#include <sys/param.h>\n#include <kvm.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirBhyveProcessShutdown(virDomainObjPtr vm)\n{\n    if (vm->pid <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Invalid PID %d for VM\"),\n                       (int)vm->pid);\n        return -1;\n    }\n\n    /* Bhyve tries to perform ACPI shutdown when it receives\n     * SIGTERM signal. So we just issue SIGTERM here and rely\n     * on the bhyve monitor to clean things up if process disappears.\n     */\n    if (virProcessKill(vm->pid, SIGTERM) != 0) {\n        VIR_WARN(\"Failed to terminate bhyve process for VM '%s': %s\",\n                 vm->def->name, virGetLastErrorMessage());\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 1001
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainShutdownFlagsEnsureACL",
          "args": [
            "dom->conn",
            "vm->def",
            "flags"
          ],
          "line": 998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 995
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "163-180",
          "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainShutdownFlags(virDomainPtr dom, unsigned int flags)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainShutdownFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    ret = virBhyveProcessShutdown(vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveDomainDestroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "981-985",
    "snippet": "static int\nbhyveDomainDestroy(virDomainPtr dom)\n{\n    return bhyveDomainDestroyFlags(dom, 0);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bhyveDomainDestroyFlags",
          "args": [
            "dom",
            "0"
          ],
          "line": 984
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomainDestroyFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "947-979",
          "snippet": "static int\nbhyveDomainDestroyFlags(virDomainPtr dom, unsigned int flags)\n{\n    virConnectPtr conn = dom->conn;\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainDestroyFlagsEnsureACL(conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    ret = virBhyveProcessStop(privconn, vm, VIR_DOMAIN_SHUTOFF_DESTROYED);\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                              VIR_DOMAIN_EVENT_STOPPED,\n                                              VIR_DOMAIN_EVENT_STOPPED_DESTROYED);\n\n    if (!vm->persistent)\n        virDomainObjListRemove(privconn->domains, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n    return ret;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainDestroyFlags(virDomainPtr dom, unsigned int flags)\n{\n    virConnectPtr conn = dom->conn;\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainDestroyFlagsEnsureACL(conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    ret = virBhyveProcessStop(privconn, vm, VIR_DOMAIN_SHUTOFF_DESTROYED);\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                              VIR_DOMAIN_EVENT_STOPPED,\n                                              VIR_DOMAIN_EVENT_STOPPED_DESTROYED);\n\n    if (!vm->persistent)\n        virDomainObjListRemove(privconn->domains, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainDestroy(virDomainPtr dom)\n{\n    return bhyveDomainDestroyFlags(dom, 0);\n}"
  },
  {
    "function_name": "bhyveDomainDestroyFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "947-979",
    "snippet": "static int\nbhyveDomainDestroyFlags(virDomainPtr dom, unsigned int flags)\n{\n    virConnectPtr conn = dom->conn;\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainDestroyFlagsEnsureACL(conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    ret = virBhyveProcessStop(privconn, vm, VIR_DOMAIN_SHUTOFF_DESTROYED);\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                              VIR_DOMAIN_EVENT_STOPPED,\n                                              VIR_DOMAIN_EVENT_STOPPED_DESTROYED);\n\n    if (!vm->persistent)\n        virDomainObjListRemove(privconn->domains, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "privconn->domainEventState",
            "event"
          ],
          "line": 977
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 976
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListRemove",
          "args": [
            "privconn->domains",
            "vm"
          ],
          "line": 973
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "401-413",
          "snippet": "void\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainEventLifecycleNewFromObj",
          "args": [
            "vm",
            "VIR_DOMAIN_EVENT_STOPPED",
            "VIR_DOMAIN_EVENT_STOPPED_DESTROYED"
          ],
          "line": 968
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventLifecycleNewFromObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "610-616",
          "snippet": "virObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainEventDispose(void *obj);",
            "static void virDomainEventLifecycleDispose(void *obj);",
            "static void virDomainEventRTCChangeDispose(void *obj);",
            "static void virDomainEventWatchdogDispose(void *obj);",
            "static void virDomainEventIOErrorDispose(void *obj);",
            "static void virDomainEventGraphicsDispose(void *obj);",
            "static void virDomainEventBlockJobDispose(void *obj);",
            "static void virDomainEventDiskChangeDispose(void *obj);",
            "static void virDomainEventTrayChangeDispose(void *obj);",
            "static void virDomainEventBalloonChangeDispose(void *obj);",
            "static void virDomainEventDeviceRemovedDispose(void *obj);",
            "static void virDomainEventPMDispose(void *obj);",
            "static void virDomainQemuMonitorEventDispose(void *obj);",
            "static void virDomainEventTunableDispose(void *obj);",
            "static void virDomainEventAgentLifecycleDispose(void *obj);",
            "static void virDomainEventDeviceAddedDispose(void *obj);",
            "static void virDomainEventMigrationIterationDispose(void *obj);",
            "static void virDomainEventJobCompletedDispose(void *obj);",
            "static void virDomainEventDeviceRemovalFailedDispose(void *obj);",
            "static void virDomainEventMetadataChangeDispose(void *obj);",
            "static void virDomainEventBlockThresholdDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virDomainEventDispose(void *obj);\nstatic void virDomainEventLifecycleDispose(void *obj);\nstatic void virDomainEventRTCChangeDispose(void *obj);\nstatic void virDomainEventWatchdogDispose(void *obj);\nstatic void virDomainEventIOErrorDispose(void *obj);\nstatic void virDomainEventGraphicsDispose(void *obj);\nstatic void virDomainEventBlockJobDispose(void *obj);\nstatic void virDomainEventDiskChangeDispose(void *obj);\nstatic void virDomainEventTrayChangeDispose(void *obj);\nstatic void virDomainEventBalloonChangeDispose(void *obj);\nstatic void virDomainEventDeviceRemovedDispose(void *obj);\nstatic void virDomainEventPMDispose(void *obj);\nstatic void virDomainQemuMonitorEventDispose(void *obj);\nstatic void virDomainEventTunableDispose(void *obj);\nstatic void virDomainEventAgentLifecycleDispose(void *obj);\nstatic void virDomainEventDeviceAddedDispose(void *obj);\nstatic void virDomainEventMigrationIterationDispose(void *obj);\nstatic void virDomainEventJobCompletedDispose(void *obj);\nstatic void virDomainEventDeviceRemovalFailedDispose(void *obj);\nstatic void virDomainEventMetadataChangeDispose(void *obj);\nstatic void virDomainEventBlockThresholdDispose(void *obj);\n\nvirObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBhyveProcessStop",
          "args": [
            "privconn",
            "vm",
            "VIR_DOMAIN_SHUTOFF_DESTROYED"
          ],
          "line": 967
        },
        "resolved": true,
        "details": {
          "function_name": "virBhyveProcessStop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_process.c",
          "lines": "274-336",
          "snippet": "int\nvirBhyveProcessStop(bhyveConnPtr driver,\n                    virDomainObjPtr vm,\n                    virDomainShutoffReason reason)\n{\n    int ret = -1;\n    virCommandPtr cmd = NULL;\n    bhyveDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!virDomainObjIsActive(vm)) {\n        VIR_DEBUG(\"VM '%s' not active\", vm->def->name);\n        return 0;\n    }\n\n    if (vm->pid <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Invalid PID %d for VM\"),\n                       (int)vm->pid);\n        return -1;\n    }\n\n    if (!(cmd = virBhyveProcessBuildDestroyCmd(driver, vm->def)))\n        return -1;\n\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((priv != NULL) && (priv->mon != NULL))\n         bhyveMonitorClose(priv->mon);\n\n    bhyveProcessStopHook(vm, VIR_HOOK_BHYVE_OP_STOPPED);\n\n    /* Cleanup network interfaces */\n    bhyveNetCleanup(vm);\n\n    /* VNC autoport cleanup */\n    if ((vm->def->ngraphics == 1) &&\n        vm->def->graphics[0]->type == VIR_DOMAIN_GRAPHICS_TYPE_VNC) {\n        if (virPortAllocatorRelease(vm->def->graphics[0]->data.vnc.port) < 0) {\n            VIR_WARN(\"Failed to release VNC port for '%s'\",\n                     vm->def->name);\n        }\n    }\n\n    ret = 0;\n\n    virCloseCallbacksUnset(driver->closeCallbacks, vm,\n                           bhyveProcessAutoDestroy);\n\n    virDomainObjSetState(vm, VIR_DOMAIN_SHUTOFF, reason);\n    vm->pid = -1;\n    vm->def->id = -1;\n\n    bhyveProcessStopHook(vm, VIR_HOOK_BHYVE_OP_RELEASE);\n\n cleanup:\n    virCommandFree(cmd);\n\n    virPidFileDelete(BHYVE_STATE_DIR, vm->def->name);\n    virDomainDeleteConfig(BHYVE_STATE_DIR, NULL, vm);\n\n    return ret;\n}",
          "includes": [
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virhook.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_monitor.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include <net/if_tap.h>",
            "#include <net/if.h>",
            "#include <sys/user.h>",
            "#include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>",
            "#include <kvm.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virnetdevtap.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virhook.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_monitor.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include <net/if_tap.h>\n#include <net/if.h>\n#include <sys/user.h>\n#include <sys/sysctl.h>\n#include <sys/types.h>\n#include <sys/param.h>\n#include <kvm.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirBhyveProcessStop(bhyveConnPtr driver,\n                    virDomainObjPtr vm,\n                    virDomainShutoffReason reason)\n{\n    int ret = -1;\n    virCommandPtr cmd = NULL;\n    bhyveDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!virDomainObjIsActive(vm)) {\n        VIR_DEBUG(\"VM '%s' not active\", vm->def->name);\n        return 0;\n    }\n\n    if (vm->pid <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Invalid PID %d for VM\"),\n                       (int)vm->pid);\n        return -1;\n    }\n\n    if (!(cmd = virBhyveProcessBuildDestroyCmd(driver, vm->def)))\n        return -1;\n\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((priv != NULL) && (priv->mon != NULL))\n         bhyveMonitorClose(priv->mon);\n\n    bhyveProcessStopHook(vm, VIR_HOOK_BHYVE_OP_STOPPED);\n\n    /* Cleanup network interfaces */\n    bhyveNetCleanup(vm);\n\n    /* VNC autoport cleanup */\n    if ((vm->def->ngraphics == 1) &&\n        vm->def->graphics[0]->type == VIR_DOMAIN_GRAPHICS_TYPE_VNC) {\n        if (virPortAllocatorRelease(vm->def->graphics[0]->data.vnc.port) < 0) {\n            VIR_WARN(\"Failed to release VNC port for '%s'\",\n                     vm->def->name);\n        }\n    }\n\n    ret = 0;\n\n    virCloseCallbacksUnset(driver->closeCallbacks, vm,\n                           bhyveProcessAutoDestroy);\n\n    virDomainObjSetState(vm, VIR_DOMAIN_SHUTOFF, reason);\n    vm->pid = -1;\n    vm->def->id = -1;\n\n    bhyveProcessStopHook(vm, VIR_HOOK_BHYVE_OP_RELEASE);\n\n cleanup:\n    virCommandFree(cmd);\n\n    virPidFileDelete(BHYVE_STATE_DIR, vm->def->name);\n    virDomainDeleteConfig(BHYVE_STATE_DIR, NULL, vm);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 964
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDestroyFlagsEnsureACL",
          "args": [
            "conn",
            "vm->def"
          ],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 958
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "163-180",
          "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 956
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainDestroyFlags(virDomainPtr dom, unsigned int flags)\n{\n    virConnectPtr conn = dom->conn;\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainDestroyFlagsEnsureACL(conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    ret = virBhyveProcessStop(privconn, vm, VIR_DOMAIN_SHUTOFF_DESTROYED);\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                              VIR_DOMAIN_EVENT_STOPPED,\n                                              VIR_DOMAIN_EVENT_STOPPED_DESTROYED);\n\n    if (!vm->persistent)\n        virDomainObjListRemove(privconn->domains, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveDomainCreateXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "886-945",
    "snippet": "static virDomainPtr\nbhyveDomainCreateXML(virConnectPtr conn,\n                     const char *xml,\n                     unsigned int flags)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainPtr dom = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainObjPtr vm = NULL;\n    virObjectEventPtr event = NULL;\n    unsigned int start_flags = 0;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_START_AUTODESTROY |\n                  VIR_DOMAIN_START_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_START_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n    if (flags & VIR_DOMAIN_START_AUTODESTROY)\n        start_flags |= VIR_BHYVE_PROCESS_START_AUTODESTROY;\n\n    if ((def = virDomainDefParseString(xml, privconn->xmlopt,\n                                       NULL, parse_flags)) == NULL)\n        goto cleanup;\n\n    if (virDomainCreateXMLEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (bhyveDomainAssignAddresses(def, NULL) < 0)\n        goto cleanup;\n\n    if (!(vm = virDomainObjListAdd(privconn->domains, def,\n                                   privconn->xmlopt,\n                                   VIR_DOMAIN_OBJ_LIST_ADD_LIVE |\n                                   VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE, NULL)))\n        goto cleanup;\n    def = NULL;\n\n    if (virBhyveProcessStart(conn, vm,\n                             VIR_DOMAIN_RUNNING_BOOTED,\n                             start_flags) < 0) {\n        /* If domain is not persistent, remove its data */\n        if (!vm->persistent)\n            virDomainObjListRemove(privconn->domains, vm);\n        goto cleanup;\n    }\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                              VIR_DOMAIN_EVENT_STARTED,\n                                              VIR_DOMAIN_EVENT_STARTED_BOOTED);\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainDefFree(def);\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n\n    return dom;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "privconn->domainEventState",
            "event"
          ],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 941
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "def"
          ],
          "line": 940
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "vm->def->name",
            "vm->def->uuid",
            "vm->def->id"
          ],
          "line": 937
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainEventLifecycleNewFromObj",
          "args": [
            "vm",
            "VIR_DOMAIN_EVENT_STARTED",
            "VIR_DOMAIN_EVENT_STARTED_BOOTED"
          ],
          "line": 933
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventLifecycleNewFromObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "610-616",
          "snippet": "virObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainEventDispose(void *obj);",
            "static void virDomainEventLifecycleDispose(void *obj);",
            "static void virDomainEventRTCChangeDispose(void *obj);",
            "static void virDomainEventWatchdogDispose(void *obj);",
            "static void virDomainEventIOErrorDispose(void *obj);",
            "static void virDomainEventGraphicsDispose(void *obj);",
            "static void virDomainEventBlockJobDispose(void *obj);",
            "static void virDomainEventDiskChangeDispose(void *obj);",
            "static void virDomainEventTrayChangeDispose(void *obj);",
            "static void virDomainEventBalloonChangeDispose(void *obj);",
            "static void virDomainEventDeviceRemovedDispose(void *obj);",
            "static void virDomainEventPMDispose(void *obj);",
            "static void virDomainQemuMonitorEventDispose(void *obj);",
            "static void virDomainEventTunableDispose(void *obj);",
            "static void virDomainEventAgentLifecycleDispose(void *obj);",
            "static void virDomainEventDeviceAddedDispose(void *obj);",
            "static void virDomainEventMigrationIterationDispose(void *obj);",
            "static void virDomainEventJobCompletedDispose(void *obj);",
            "static void virDomainEventDeviceRemovalFailedDispose(void *obj);",
            "static void virDomainEventMetadataChangeDispose(void *obj);",
            "static void virDomainEventBlockThresholdDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virDomainEventDispose(void *obj);\nstatic void virDomainEventLifecycleDispose(void *obj);\nstatic void virDomainEventRTCChangeDispose(void *obj);\nstatic void virDomainEventWatchdogDispose(void *obj);\nstatic void virDomainEventIOErrorDispose(void *obj);\nstatic void virDomainEventGraphicsDispose(void *obj);\nstatic void virDomainEventBlockJobDispose(void *obj);\nstatic void virDomainEventDiskChangeDispose(void *obj);\nstatic void virDomainEventTrayChangeDispose(void *obj);\nstatic void virDomainEventBalloonChangeDispose(void *obj);\nstatic void virDomainEventDeviceRemovedDispose(void *obj);\nstatic void virDomainEventPMDispose(void *obj);\nstatic void virDomainQemuMonitorEventDispose(void *obj);\nstatic void virDomainEventTunableDispose(void *obj);\nstatic void virDomainEventAgentLifecycleDispose(void *obj);\nstatic void virDomainEventDeviceAddedDispose(void *obj);\nstatic void virDomainEventMigrationIterationDispose(void *obj);\nstatic void virDomainEventJobCompletedDispose(void *obj);\nstatic void virDomainEventDeviceRemovalFailedDispose(void *obj);\nstatic void virDomainEventMetadataChangeDispose(void *obj);\nstatic void virDomainEventBlockThresholdDispose(void *obj);\n\nvirObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListRemove",
          "args": [
            "privconn->domains",
            "vm"
          ],
          "line": 929
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "401-413",
          "snippet": "void\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBhyveProcessStart",
          "args": [
            "conn",
            "vm",
            "VIR_DOMAIN_RUNNING_BOOTED",
            "start_flags"
          ],
          "line": 924
        },
        "resolved": true,
        "details": {
          "function_name": "virBhyveProcessStart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_process.c",
          "lines": "254-272",
          "snippet": "int\nvirBhyveProcessStart(virConnectPtr conn,\n                     virDomainObjPtr vm,\n                     virDomainRunningReason reason,\n                     unsigned int flags)\n{\n    bhyveConnPtr driver = conn->privateData;\n\n    /* Run an early hook to setup missing devices. */\n    if (bhyveProcessStartHook(vm, VIR_HOOK_BHYVE_OP_PREPARE) < 0)\n        return -1;\n\n    if (flags & VIR_BHYVE_PROCESS_START_AUTODESTROY &&\n        virCloseCallbacksSet(driver->closeCallbacks, vm,\n                             conn, bhyveProcessAutoDestroy) < 0)\n        return -1;\n\n    return virBhyveProcessStartImpl(driver, vm, reason);\n}",
          "includes": [
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virhook.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_monitor.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include <net/if_tap.h>",
            "#include <net/if.h>",
            "#include <sys/user.h>",
            "#include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>",
            "#include <kvm.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virnetdevtap.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virhook.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_monitor.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include <net/if_tap.h>\n#include <net/if.h>\n#include <sys/user.h>\n#include <sys/sysctl.h>\n#include <sys/types.h>\n#include <sys/param.h>\n#include <kvm.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirBhyveProcessStart(virConnectPtr conn,\n                     virDomainObjPtr vm,\n                     virDomainRunningReason reason,\n                     unsigned int flags)\n{\n    bhyveConnPtr driver = conn->privateData;\n\n    /* Run an early hook to setup missing devices. */\n    if (bhyveProcessStartHook(vm, VIR_HOOK_BHYVE_OP_PREPARE) < 0)\n        return -1;\n\n    if (flags & VIR_BHYVE_PROCESS_START_AUTODESTROY &&\n        virCloseCallbacksSet(driver->closeCallbacks, vm,\n                             conn, bhyveProcessAutoDestroy) < 0)\n        return -1;\n\n    return virBhyveProcessStartImpl(driver, vm, reason);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListAdd",
          "args": [
            "privconn->domains",
            "def",
            "privconn->xmlopt",
            "VIR_DOMAIN_OBJ_LIST_ADD_LIVE |\n                                   VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE",
            "NULL"
          ],
          "line": 917
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "354-366",
          "snippet": "virDomainObjPtr virDomainObjListAdd(virDomainObjListPtr doms,\n                                    virDomainDefPtr def,\n                                    virDomainXMLOptionPtr xmlopt,\n                                    unsigned int flags,\n                                    virDomainDefPtr *oldDef)\n{\n    virDomainObjPtr ret;\n\n    virObjectRWLockWrite(doms);\n    ret = virDomainObjListAddLocked(doms, def, xmlopt, flags, oldDef);\n    virObjectRWUnlock(doms);\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainObjPtr virDomainObjListAdd(virDomainObjListPtr doms,\n                                    virDomainDefPtr def,\n                                    virDomainXMLOptionPtr xmlopt,\n                                    unsigned int flags,\n                                    virDomainDefPtr *oldDef)\n{\n    virDomainObjPtr ret;\n\n    virObjectRWLockWrite(doms);\n    ret = virDomainObjListAddLocked(doms, def, xmlopt, flags, oldDef);\n    virObjectRWUnlock(doms);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bhyveDomainAssignAddresses",
          "args": [
            "def",
            "NULL"
          ],
          "line": 914
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomainAssignAddresses",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_device.c",
          "lines": "186-189",
          "snippet": "int bhyveDomainAssignAddresses(virDomainDefPtr def, virDomainObjPtr obj)\n{\n    return bhyveDomainAssignPCIAddresses(def, obj);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_addr.h\"",
            "#include \"bhyve_device.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"domain_addr.h\"\n#include \"bhyve_device.h\"\n#include <config.h>\n\nint bhyveDomainAssignAddresses(virDomainDefPtr def, virDomainObjPtr obj)\n{\n    return bhyveDomainAssignPCIAddresses(def, obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCreateXMLEnsureACL",
          "args": [
            "conn",
            "def"
          ],
          "line": 911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDefParseString",
          "args": [
            "xml",
            "privconn->xmlopt",
            "NULL",
            "parse_flags"
          ],
          "line": 907
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "22134-22141",
          "snippet": "virDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_START_AUTODESTROY |\n                  VIR_DOMAIN_START_VALIDATE",
            "NULL"
          ],
          "line": 899
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainPtr\nbhyveDomainCreateXML(virConnectPtr conn,\n                     const char *xml,\n                     unsigned int flags)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainPtr dom = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainObjPtr vm = NULL;\n    virObjectEventPtr event = NULL;\n    unsigned int start_flags = 0;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_START_AUTODESTROY |\n                  VIR_DOMAIN_START_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_START_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n    if (flags & VIR_DOMAIN_START_AUTODESTROY)\n        start_flags |= VIR_BHYVE_PROCESS_START_AUTODESTROY;\n\n    if ((def = virDomainDefParseString(xml, privconn->xmlopt,\n                                       NULL, parse_flags)) == NULL)\n        goto cleanup;\n\n    if (virDomainCreateXMLEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (bhyveDomainAssignAddresses(def, NULL) < 0)\n        goto cleanup;\n\n    if (!(vm = virDomainObjListAdd(privconn->domains, def,\n                                   privconn->xmlopt,\n                                   VIR_DOMAIN_OBJ_LIST_ADD_LIVE |\n                                   VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE, NULL)))\n        goto cleanup;\n    def = NULL;\n\n    if (virBhyveProcessStart(conn, vm,\n                             VIR_DOMAIN_RUNNING_BOOTED,\n                             start_flags) < 0) {\n        /* If domain is not persistent, remove its data */\n        if (!vm->persistent)\n            virDomainObjListRemove(privconn->domains, vm);\n        goto cleanup;\n    }\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                              VIR_DOMAIN_EVENT_STARTED,\n                                              VIR_DOMAIN_EVENT_STARTED_BOOTED);\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainDefFree(def);\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n\n    return dom;\n}"
  },
  {
    "function_name": "bhyveDomainCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "880-884",
    "snippet": "static int\nbhyveDomainCreate(virDomainPtr dom)\n{\n    return bhyveDomainCreateWithFlags(dom, 0);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bhyveDomainCreateWithFlags",
          "args": [
            "dom",
            "0"
          ],
          "line": 883
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomainCreateWithFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "838-878",
          "snippet": "static int\nbhyveDomainCreateWithFlags(virDomainPtr dom,\n                           unsigned int flags)\n{\n    bhyveConnPtr privconn = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    unsigned int start_flags = 0;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_START_AUTODESTROY, -1);\n\n    if (flags & VIR_DOMAIN_START_AUTODESTROY)\n        start_flags |= VIR_BHYVE_PROCESS_START_AUTODESTROY;\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainCreateWithFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjIsActive(vm)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Domain is already running\"));\n        goto cleanup;\n    }\n\n    ret = virBhyveProcessStart(dom->conn, vm,\n                               VIR_DOMAIN_RUNNING_BOOTED,\n                               start_flags);\n\n    if (ret == 0)\n        event = virDomainEventLifecycleNewFromObj(vm,\n                                                  VIR_DOMAIN_EVENT_STARTED,\n                                                  VIR_DOMAIN_EVENT_STARTED_BOOTED);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n    return ret;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainCreateWithFlags(virDomainPtr dom,\n                           unsigned int flags)\n{\n    bhyveConnPtr privconn = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    unsigned int start_flags = 0;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_START_AUTODESTROY, -1);\n\n    if (flags & VIR_DOMAIN_START_AUTODESTROY)\n        start_flags |= VIR_BHYVE_PROCESS_START_AUTODESTROY;\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainCreateWithFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjIsActive(vm)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Domain is already running\"));\n        goto cleanup;\n    }\n\n    ret = virBhyveProcessStart(dom->conn, vm,\n                               VIR_DOMAIN_RUNNING_BOOTED,\n                               start_flags);\n\n    if (ret == 0)\n        event = virDomainEventLifecycleNewFromObj(vm,\n                                                  VIR_DOMAIN_EVENT_STARTED,\n                                                  VIR_DOMAIN_EVENT_STARTED_BOOTED);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainCreate(virDomainPtr dom)\n{\n    return bhyveDomainCreateWithFlags(dom, 0);\n}"
  },
  {
    "function_name": "bhyveDomainCreateWithFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "838-878",
    "snippet": "static int\nbhyveDomainCreateWithFlags(virDomainPtr dom,\n                           unsigned int flags)\n{\n    bhyveConnPtr privconn = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    unsigned int start_flags = 0;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_START_AUTODESTROY, -1);\n\n    if (flags & VIR_DOMAIN_START_AUTODESTROY)\n        start_flags |= VIR_BHYVE_PROCESS_START_AUTODESTROY;\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainCreateWithFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjIsActive(vm)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Domain is already running\"));\n        goto cleanup;\n    }\n\n    ret = virBhyveProcessStart(dom->conn, vm,\n                               VIR_DOMAIN_RUNNING_BOOTED,\n                               start_flags);\n\n    if (ret == 0)\n        event = virDomainEventLifecycleNewFromObj(vm,\n                                                  VIR_DOMAIN_EVENT_STARTED,\n                                                  VIR_DOMAIN_EVENT_STARTED_BOOTED);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "privconn->domainEventState",
            "event"
          ],
          "line": 876
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 875
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainEventLifecycleNewFromObj",
          "args": [
            "vm",
            "VIR_DOMAIN_EVENT_STARTED",
            "VIR_DOMAIN_EVENT_STARTED_BOOTED"
          ],
          "line": 870
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventLifecycleNewFromObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "610-616",
          "snippet": "virObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainEventDispose(void *obj);",
            "static void virDomainEventLifecycleDispose(void *obj);",
            "static void virDomainEventRTCChangeDispose(void *obj);",
            "static void virDomainEventWatchdogDispose(void *obj);",
            "static void virDomainEventIOErrorDispose(void *obj);",
            "static void virDomainEventGraphicsDispose(void *obj);",
            "static void virDomainEventBlockJobDispose(void *obj);",
            "static void virDomainEventDiskChangeDispose(void *obj);",
            "static void virDomainEventTrayChangeDispose(void *obj);",
            "static void virDomainEventBalloonChangeDispose(void *obj);",
            "static void virDomainEventDeviceRemovedDispose(void *obj);",
            "static void virDomainEventPMDispose(void *obj);",
            "static void virDomainQemuMonitorEventDispose(void *obj);",
            "static void virDomainEventTunableDispose(void *obj);",
            "static void virDomainEventAgentLifecycleDispose(void *obj);",
            "static void virDomainEventDeviceAddedDispose(void *obj);",
            "static void virDomainEventMigrationIterationDispose(void *obj);",
            "static void virDomainEventJobCompletedDispose(void *obj);",
            "static void virDomainEventDeviceRemovalFailedDispose(void *obj);",
            "static void virDomainEventMetadataChangeDispose(void *obj);",
            "static void virDomainEventBlockThresholdDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virDomainEventDispose(void *obj);\nstatic void virDomainEventLifecycleDispose(void *obj);\nstatic void virDomainEventRTCChangeDispose(void *obj);\nstatic void virDomainEventWatchdogDispose(void *obj);\nstatic void virDomainEventIOErrorDispose(void *obj);\nstatic void virDomainEventGraphicsDispose(void *obj);\nstatic void virDomainEventBlockJobDispose(void *obj);\nstatic void virDomainEventDiskChangeDispose(void *obj);\nstatic void virDomainEventTrayChangeDispose(void *obj);\nstatic void virDomainEventBalloonChangeDispose(void *obj);\nstatic void virDomainEventDeviceRemovedDispose(void *obj);\nstatic void virDomainEventPMDispose(void *obj);\nstatic void virDomainQemuMonitorEventDispose(void *obj);\nstatic void virDomainEventTunableDispose(void *obj);\nstatic void virDomainEventAgentLifecycleDispose(void *obj);\nstatic void virDomainEventDeviceAddedDispose(void *obj);\nstatic void virDomainEventMigrationIterationDispose(void *obj);\nstatic void virDomainEventJobCompletedDispose(void *obj);\nstatic void virDomainEventDeviceRemovalFailedDispose(void *obj);\nstatic void virDomainEventMetadataChangeDispose(void *obj);\nstatic void virDomainEventBlockThresholdDispose(void *obj);\n\nvirObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBhyveProcessStart",
          "args": [
            "dom->conn",
            "vm",
            "VIR_DOMAIN_RUNNING_BOOTED",
            "start_flags"
          ],
          "line": 865
        },
        "resolved": true,
        "details": {
          "function_name": "virBhyveProcessStart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_process.c",
          "lines": "254-272",
          "snippet": "int\nvirBhyveProcessStart(virConnectPtr conn,\n                     virDomainObjPtr vm,\n                     virDomainRunningReason reason,\n                     unsigned int flags)\n{\n    bhyveConnPtr driver = conn->privateData;\n\n    /* Run an early hook to setup missing devices. */\n    if (bhyveProcessStartHook(vm, VIR_HOOK_BHYVE_OP_PREPARE) < 0)\n        return -1;\n\n    if (flags & VIR_BHYVE_PROCESS_START_AUTODESTROY &&\n        virCloseCallbacksSet(driver->closeCallbacks, vm,\n                             conn, bhyveProcessAutoDestroy) < 0)\n        return -1;\n\n    return virBhyveProcessStartImpl(driver, vm, reason);\n}",
          "includes": [
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virhook.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_monitor.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include <net/if_tap.h>",
            "#include <net/if.h>",
            "#include <sys/user.h>",
            "#include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>",
            "#include <kvm.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virnetdevtap.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virhook.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_monitor.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include <net/if_tap.h>\n#include <net/if.h>\n#include <sys/user.h>\n#include <sys/sysctl.h>\n#include <sys/types.h>\n#include <sys/param.h>\n#include <kvm.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirBhyveProcessStart(virConnectPtr conn,\n                     virDomainObjPtr vm,\n                     virDomainRunningReason reason,\n                     unsigned int flags)\n{\n    bhyveConnPtr driver = conn->privateData;\n\n    /* Run an early hook to setup missing devices. */\n    if (bhyveProcessStartHook(vm, VIR_HOOK_BHYVE_OP_PREPARE) < 0)\n        return -1;\n\n    if (flags & VIR_BHYVE_PROCESS_START_AUTODESTROY &&\n        virCloseCallbacksSet(driver->closeCallbacks, vm,\n                             conn, bhyveProcessAutoDestroy) < 0)\n        return -1;\n\n    return virBhyveProcessStartImpl(driver, vm, reason);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Domain is already running\")"
          ],
          "line": 860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Domain is already running\""
          ],
          "line": 861
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "vm"
          ],
          "line": 859
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCreateWithFlagsEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 853
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "163-180",
          "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_START_AUTODESTROY",
            "-1"
          ],
          "line": 848
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainCreateWithFlags(virDomainPtr dom,\n                           unsigned int flags)\n{\n    bhyveConnPtr privconn = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    unsigned int start_flags = 0;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_START_AUTODESTROY, -1);\n\n    if (flags & VIR_DOMAIN_START_AUTODESTROY)\n        start_flags |= VIR_BHYVE_PROCESS_START_AUTODESTROY;\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainCreateWithFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjIsActive(vm)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Domain is already running\"));\n        goto cleanup;\n    }\n\n    ret = virBhyveProcessStart(dom->conn, vm,\n                               VIR_DOMAIN_RUNNING_BOOTED,\n                               start_flags);\n\n    if (ret == 0)\n        event = virDomainEventLifecycleNewFromObj(vm,\n                                                  VIR_DOMAIN_EVENT_STARTED,\n                                                  VIR_DOMAIN_EVENT_STARTED_BOOTED);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveDomainLookupByID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "812-836",
    "snippet": "static virDomainPtr\nbhyveDomainLookupByID(virConnectPtr conn,\n                      int id)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    vm = virDomainObjListFindByID(privconn->domains, id);\n\n    if (!vm) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"No domain with matching ID '%d'\"), id);\n        goto cleanup;\n    }\n\n    if (virDomainLookupByIDEnsureACL(conn, vm->def) < 0)\n        goto cleanup;\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 834
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "vm->def->name",
            "vm->def->uuid",
            "vm->def->id"
          ],
          "line": 831
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainLookupByIDEnsureACL",
          "args": [
            "conn",
            "vm->def"
          ],
          "line": 828
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN",
            "_(\"No domain with matching ID '%d'\")",
            "id"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"No domain with matching ID '%d'\""
          ],
          "line": 824
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByID",
          "args": [
            "privconn->domains",
            "id"
          ],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "114-134",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByID(virDomainObjListPtr doms,\n                         int id)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virHashSearch(doms->objs, virDomainObjListSearchID, &id, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(doms);\n    if (obj) {\n        virObjectLock(obj);\n        if (obj->removing) {\n            virObjectUnlock(obj);\n            virObjectUnref(obj);\n            obj = NULL;\n        }\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByID(virDomainObjListPtr doms,\n                         int id)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virHashSearch(doms->objs, virDomainObjListSearchID, &id, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(doms);\n    if (obj) {\n        virObjectLock(obj);\n        if (obj->removing) {\n            virObjectUnlock(obj);\n            virObjectUnref(obj);\n            obj = NULL;\n        }\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainPtr\nbhyveDomainLookupByID(virConnectPtr conn,\n                      int id)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    vm = virDomainObjListFindByID(privconn->domains, id);\n\n    if (!vm) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"No domain with matching ID '%d'\"), id);\n        goto cleanup;\n    }\n\n    if (virDomainLookupByIDEnsureACL(conn, vm->def) < 0)\n        goto cleanup;\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}"
  },
  {
    "function_name": "bhyveDomainLookupByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "787-810",
    "snippet": "static virDomainPtr bhyveDomainLookupByName(virConnectPtr conn,\n                                            const char *name)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    vm = virDomainObjListFindByName(privconn->domains, name);\n\n    if (!vm) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching name '%s'\"), name);\n        goto cleanup;\n    }\n\n    if (virDomainLookupByNameEnsureACL(conn, vm->def) < 0)\n        goto cleanup;\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 808
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "vm->def->name",
            "vm->def->uuid",
            "vm->def->id"
          ],
          "line": 805
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainLookupByNameEnsureACL",
          "args": [
            "conn",
            "vm->def"
          ],
          "line": 802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN",
            "_(\"no domain with matching name '%s'\")",
            "name"
          ],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no domain with matching name '%s'\""
          ],
          "line": 798
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByName",
          "args": [
            "privconn->domains",
            "name"
          ],
          "line": 794
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "205-222",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByName(virDomainObjListPtr doms,\n                           const char *name)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByNameLocked(doms, name);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByName(virDomainObjListPtr doms,\n                           const char *name)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByNameLocked(doms, name);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainPtr bhyveDomainLookupByName(virConnectPtr conn,\n                                            const char *name)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    vm = virDomainObjListFindByName(privconn->domains, name);\n\n    if (!vm) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching name '%s'\"), name);\n        goto cleanup;\n    }\n\n    if (virDomainLookupByNameEnsureACL(conn, vm->def) < 0)\n        goto cleanup;\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}"
  },
  {
    "function_name": "bhyveDomainLookupByUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "759-785",
    "snippet": "static virDomainPtr\nbhyveDomainLookupByUUID(virConnectPtr conn,\n                        const unsigned char *uuid)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    vm = virDomainObjListFindByUUID(privconn->domains, uuid);\n\n    if (!vm) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"No domain with matching uuid '%s'\"), uuidstr);\n        goto cleanup;\n    }\n\n    if (virDomainLookupByUUIDEnsureACL(conn, vm->def) < 0)\n        goto cleanup;\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 783
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "vm->def->name",
            "vm->def->uuid",
            "vm->def->id"
          ],
          "line": 780
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainLookupByUUIDEnsureACL",
          "args": [
            "conn",
            "vm->def"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN",
            "_(\"No domain with matching uuid '%s'\")",
            "uuidstr"
          ],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"No domain with matching uuid '%s'\""
          ],
          "line": 773
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "uuid",
            "uuidstr"
          ],
          "line": 771
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByUUID",
          "args": [
            "privconn->domains",
            "uuid"
          ],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "162-179",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByUUID(virDomainObjListPtr doms,\n                           const unsigned char *uuid)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByUUIDLocked(doms, uuid);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByUUID(virDomainObjListPtr doms,\n                           const unsigned char *uuid)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByUUIDLocked(doms, uuid);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainPtr\nbhyveDomainLookupByUUID(virConnectPtr conn,\n                        const unsigned char *uuid)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    vm = virDomainObjListFindByUUID(privconn->domains, uuid);\n\n    if (!vm) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"No domain with matching uuid '%s'\"), uuidstr);\n        goto cleanup;\n    }\n\n    if (virDomainLookupByUUIDEnsureACL(conn, vm->def) < 0)\n        goto cleanup;\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}"
  },
  {
    "function_name": "bhyveConnectListAllDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "743-757",
    "snippet": "static int\nbhyveConnectListAllDomains(virConnectPtr conn,\n                           virDomainPtr **domains,\n                           unsigned int flags)\n{\n    bhyveConnPtr privconn = conn->privateData;\n\n    virCheckFlags(VIR_CONNECT_LIST_DOMAINS_FILTERS_ALL, -1);\n\n    if (virConnectListAllDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListExport(privconn->domains, conn, domains,\n                                  virConnectListAllDomainsCheckACL, flags);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjListExport",
          "args": [
            "privconn->domains",
            "conn",
            "domains",
            "virConnectListAllDomainsCheckACL",
            "flags"
          ],
          "line": 755
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListExport",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "1060-1101",
          "snippet": "int\nvirDomainObjListExport(virDomainObjListPtr domlist,\n                       virConnectPtr conn,\n                       virDomainPtr **domains,\n                       virDomainObjListACLFilter filter,\n                       unsigned int flags)\n{\n    virDomainObjPtr *vms = NULL;\n    virDomainPtr *doms = NULL;\n    size_t nvms = 0;\n    size_t i;\n    int ret = -1;\n\n    if (virDomainObjListCollect(domlist, conn, &vms, &nvms, filter, flags) < 0)\n        return -1;\n\n    if (domains) {\n        if (VIR_ALLOC_N(doms, nvms + 1) < 0)\n            goto cleanup;\n\n        for (i = 0; i < nvms; i++) {\n            virDomainObjPtr vm = vms[i];\n\n            virObjectLock(vm);\n            doms[i] = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n            virObjectUnlock(vm);\n\n            if (!doms[i])\n                goto cleanup;\n        }\n\n        *domains = doms;\n        doms = NULL;\n    }\n\n    ret = nvms;\n\n cleanup:\n    virObjectListFree(doms);\n    virObjectListFreeCount(vms, nvms);\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListExport(virDomainObjListPtr domlist,\n                       virConnectPtr conn,\n                       virDomainPtr **domains,\n                       virDomainObjListACLFilter filter,\n                       unsigned int flags)\n{\n    virDomainObjPtr *vms = NULL;\n    virDomainPtr *doms = NULL;\n    size_t nvms = 0;\n    size_t i;\n    int ret = -1;\n\n    if (virDomainObjListCollect(domlist, conn, &vms, &nvms, filter, flags) < 0)\n        return -1;\n\n    if (domains) {\n        if (VIR_ALLOC_N(doms, nvms + 1) < 0)\n            goto cleanup;\n\n        for (i = 0; i < nvms; i++) {\n            virDomainObjPtr vm = vms[i];\n\n            virObjectLock(vm);\n            doms[i] = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n            virObjectUnlock(vm);\n\n            if (!doms[i])\n                goto cleanup;\n        }\n\n        *domains = doms;\n        doms = NULL;\n    }\n\n    ret = nvms;\n\n cleanup:\n    virObjectListFree(doms);\n    virObjectListFreeCount(vms, nvms);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectListAllDomainsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_CONNECT_LIST_DOMAINS_FILTERS_ALL",
            "-1"
          ],
          "line": 750
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveConnectListAllDomains(virConnectPtr conn,\n                           virDomainPtr **domains,\n                           unsigned int flags)\n{\n    bhyveConnPtr privconn = conn->privateData;\n\n    virCheckFlags(VIR_CONNECT_LIST_DOMAINS_FILTERS_ALL, -1);\n\n    if (virConnectListAllDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListExport(privconn->domains, conn, domains,\n                                  virConnectListAllDomainsCheckACL, flags);\n}"
  },
  {
    "function_name": "bhyveConnectDomainXMLToNative",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "675-741",
    "snippet": "static char *\nbhyveConnectDomainXMLToNative(virConnectPtr conn,\n                              const char *format,\n                              const char *xmlData,\n                              unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainDefPtr def = NULL;\n    virCommandPtr cmd = NULL, loadcmd = NULL;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (virConnectDomainXMLToNativeEnsureACL(conn) < 0)\n        goto cleanup;\n\n    if (STRNEQ(format, BHYVE_CONFIG_FORMAT_ARGV)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Unsupported config type %s\"), format);\n        goto cleanup;\n    }\n\n    if (!(def = virDomainDefParseString(xmlData, privconn->xmlopt,\n                                        NULL, VIR_DOMAIN_DEF_PARSE_INACTIVE)))\n        goto cleanup;\n\n    if (bhyveDomainAssignAddresses(def, NULL) < 0)\n        goto cleanup;\n\n    if (def->os.bootloader == NULL &&\n        def->os.loader) {\n\n        if (!virDomainDefHasOldStyleROUEFI(def)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Only read-only pflash is supported.\"));\n            goto cleanup;\n        }\n\n        if ((bhyveDriverGetBhyveCaps(privconn) & BHYVE_CAP_LPC_BOOTROM) == 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Installed bhyve binary does not support \"\n                          \"bootrom\"));\n            goto cleanup;\n        }\n    } else {\n        if (!(loadcmd = virBhyveProcessBuildLoadCmd(privconn, def,\n                                                    \"<device.map>\", NULL)))\n            goto cleanup;\n\n        virBufferAdd(&buf, virCommandToString(loadcmd, false), -1);\n        virBufferAddChar(&buf, '\\n');\n    }\n\n    if (!(cmd = virBhyveProcessBuildBhyveCmd(privconn, def, true)))\n        goto cleanup;\n\n    virBufferAdd(&buf, virCommandToString(cmd, false), -1);\n\n    ret = virBufferContentAndReset(&buf);\n\n cleanup:\n    virCommandFree(loadcmd);\n    virCommandFree(cmd);\n    virDomainDefFree(def);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "def"
          ],
          "line": 739
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 734
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAdd",
          "args": [
            "&buf",
            "virCommandToString(cmd, false)",
            "-1"
          ],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "156-169",
          "snippet": "void\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandToString",
          "args": [
            "cmd",
            "false"
          ],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2082-2135",
          "snippet": "char *\nvirCommandToString(virCommandPtr cmd, bool linebreaks)\n{\n    size_t i;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bool prevopt = false;\n\n    /* Cannot assume virCommandRun will be called; so report the error\n     * now.  If virCommandRun is called, it will report the same error. */\n    if (!cmd ||cmd->has_error == ENOMEM) {\n        virReportOOMError();\n        return NULL;\n    }\n    if (cmd->has_error) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"invalid use of command API\"));\n        return NULL;\n    }\n\n    for (i = 0; i < cmd->nenv; i++) {\n        /* In shell, a='b c' has a different meaning than 'a=b c', so\n         * we must determine where the '=' lives.  */\n        char *eq = strchr(cmd->env[i], '=');\n\n        if (!eq) {\n            virBufferFreeAndReset(&buf);\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"invalid use of command API\"));\n            return NULL;\n        }\n        eq++;\n        virBufferAdd(&buf, cmd->env[i], eq - cmd->env[i]);\n        virBufferEscapeShell(&buf, eq);\n        virBufferAddChar(&buf, ' ');\n        if (linebreaks)\n            virBufferAddLit(&buf, \"\\\\\\n\");\n    }\n    virBufferEscapeShell(&buf, cmd->args[0]);\n    for (i = 1; i < cmd->nargs; i++) {\n        virBufferAddChar(&buf, ' ');\n        if (linebreaks) {\n            /* Line break if this is a --arg or if\n             * the previous arg was a positional option\n             */\n            if (cmd->args[i][0] == '-' ||\n                !prevopt)\n                virBufferAddLit(&buf, \"\\\\\\n\");\n        }\n        virBufferEscapeShell(&buf, cmd->args[i]);\n        prevopt = (cmd->args[i][0] == '-');\n    }\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nchar *\nvirCommandToString(virCommandPtr cmd, bool linebreaks)\n{\n    size_t i;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bool prevopt = false;\n\n    /* Cannot assume virCommandRun will be called; so report the error\n     * now.  If virCommandRun is called, it will report the same error. */\n    if (!cmd ||cmd->has_error == ENOMEM) {\n        virReportOOMError();\n        return NULL;\n    }\n    if (cmd->has_error) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"invalid use of command API\"));\n        return NULL;\n    }\n\n    for (i = 0; i < cmd->nenv; i++) {\n        /* In shell, a='b c' has a different meaning than 'a=b c', so\n         * we must determine where the '=' lives.  */\n        char *eq = strchr(cmd->env[i], '=');\n\n        if (!eq) {\n            virBufferFreeAndReset(&buf);\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"invalid use of command API\"));\n            return NULL;\n        }\n        eq++;\n        virBufferAdd(&buf, cmd->env[i], eq - cmd->env[i]);\n        virBufferEscapeShell(&buf, eq);\n        virBufferAddChar(&buf, ' ');\n        if (linebreaks)\n            virBufferAddLit(&buf, \"\\\\\\n\");\n    }\n    virBufferEscapeShell(&buf, cmd->args[0]);\n    for (i = 1; i < cmd->nargs; i++) {\n        virBufferAddChar(&buf, ' ');\n        if (linebreaks) {\n            /* Line break if this is a --arg or if\n             * the previous arg was a positional option\n             */\n            if (cmd->args[i][0] == '-' ||\n                !prevopt)\n                virBufferAddLit(&buf, \"\\\\\\n\");\n        }\n        virBufferEscapeShell(&buf, cmd->args[i]);\n        prevopt = (cmd->args[i][0] == '-');\n    }\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBhyveProcessBuildBhyveCmd",
          "args": [
            "privconn",
            "def",
            "true"
          ],
          "line": 729
        },
        "resolved": true,
        "details": {
          "function_name": "virBhyveProcessBuildBhyveCmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_command.c",
          "lines": "485-654",
          "snippet": "virCommandPtr\nvirBhyveProcessBuildBhyveCmd(bhyveConnPtr driver, virDomainDefPtr def,\n                             bool dryRun)\n{\n    /*\n     * /usr/sbin/bhyve -c 2 -m 256 -AI -H -P \\\n     *            -s 0:0,hostbridge \\\n     *            -s 1:0,virtio-net,tap0 \\\n     *            -s 2:0,ahci-hd,${IMG} \\\n     *            -S 31,uart,stdio \\\n     *            vm0\n     */\n    virCommandPtr cmd = virCommandNew(BHYVE);\n    size_t i;\n    unsigned nusbcontrollers = 0;\n    unsigned nvcpus = virDomainDefGetVcpus(def);\n\n    /* CPUs */\n    virCommandAddArg(cmd, \"-c\");\n    if (def->cpu && def->cpu->sockets) {\n        if (def->cpu->dies != 1) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Only 1 die per socket is supported\"));\n            goto error;\n        }\n        if (nvcpus != def->cpu->sockets * def->cpu->cores * def->cpu->threads) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Invalid CPU topology: total number of vCPUs \"\n                             \"must equal the product of sockets, cores, \"\n                             \"and threads\"));\n            goto error;\n        }\n\n        if ((bhyveDriverGetBhyveCaps(driver) & BHYVE_CAP_CPUTOPOLOGY) != 0) {\n            virCommandAddArgFormat(cmd, \"cpus=%d,sockets=%d,cores=%d,threads=%d\",\n                                   nvcpus,\n                                   def->cpu->sockets,\n                                   def->cpu->cores,\n                                   def->cpu->threads);\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Installed bhyve binary does not support \"\n                             \"defining CPU topology\"));\n            goto error;\n        }\n    } else {\n        virCommandAddArgFormat(cmd, \"%d\", nvcpus);\n    }\n\n    /* Memory */\n    virCommandAddArg(cmd, \"-m\");\n    virCommandAddArgFormat(cmd, \"%llu\",\n                           VIR_DIV_UP(virDomainDefGetMemoryInitial(def), 1024));\n\n    if (def->mem.locked)\n        virCommandAddArg(cmd, \"-S\"); /* Wire guest memory */\n\n    /* Options */\n    if (def->features[VIR_DOMAIN_FEATURE_ACPI] == VIR_TRISTATE_SWITCH_ON)\n        virCommandAddArg(cmd, \"-A\"); /* Create an ACPI table */\n    if (def->features[VIR_DOMAIN_FEATURE_APIC] == VIR_TRISTATE_SWITCH_ON)\n        virCommandAddArg(cmd, \"-I\"); /* Present ioapic to the guest */\n    if (def->features[VIR_DOMAIN_FEATURE_MSRS] == VIR_TRISTATE_SWITCH_ON) {\n        if (def->msrs_features[VIR_DOMAIN_MSRS_UNKNOWN] == VIR_DOMAIN_MSRS_UNKNOWN_IGNORE)\n            virCommandAddArg(cmd, \"-w\");\n    }\n\n    switch (def->clock.offset) {\n    case VIR_DOMAIN_CLOCK_OFFSET_LOCALTIME:\n        /* used by default in bhyve */\n        break;\n    case VIR_DOMAIN_CLOCK_OFFSET_UTC:\n        if ((bhyveDriverGetBhyveCaps(driver) & BHYVE_CAP_RTC_UTC) != 0) {\n            virCommandAddArg(cmd, \"-u\");\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Installed bhyve binary does not support \"\n                          \"UTC clock\"));\n            goto error;\n        }\n        break;\n    default:\n         virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                        _(\"unsupported clock offset '%s'\"),\n                        virDomainClockOffsetTypeToString(def->clock.offset));\n         goto error;\n    }\n\n    /* Clarification about -H and -P flags from Peter Grehan:\n     * -H and -P flags force the guest to exit when it executes IA32 HLT and PAUSE\n     * instructions respectively.\n     *\n     * For the HLT exit, bhyve uses that to infer that the guest is idling and can\n     * be put to sleep until an external event arrives. If this option is not used,\n     * the guest will always use 100% of CPU on the host.\n     *\n     * The PAUSE exit is most useful when there are large numbers of guest VMs running,\n     * since it forces the guest to exit when it spins on a lock acquisition.\n     */\n    virCommandAddArg(cmd, \"-H\"); /* vmexit from guest on hlt */\n    virCommandAddArg(cmd, \"-P\"); /* vmexit from guest on pause */\n\n    virCommandAddArgList(cmd, \"-s\", \"0:0,hostbridge\", NULL);\n\n    if (def->os.bootloader == NULL &&\n        def->os.loader) {\n        if ((bhyveDriverGetBhyveCaps(driver) & BHYVE_CAP_LPC_BOOTROM)) {\n            virCommandAddArg(cmd, \"-l\");\n            virCommandAddArgFormat(cmd, \"bootrom,%s\", def->os.loader->path);\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Installed bhyve binary does not support \"\n                             \"UEFI loader\"));\n            goto error;\n        }\n    }\n\n    /* Devices */\n    for (i = 0; i < def->ncontrollers; i++) {\n        if (bhyveBuildControllerArgStr(def, def->controllers[i], driver, cmd,\n                                       &nusbcontrollers) < 0)\n            goto error;\n    }\n    for (i = 0; i < def->nnets; i++) {\n        if (bhyveBuildNetArgStr(def, def->nets[i], driver, cmd, dryRun) < 0)\n            goto error;\n    }\n    for (i = 0; i < def->ndisks; i++) {\n        if (bhyveBuildDiskArgStr(def, def->disks[i], cmd) < 0)\n            goto error;\n    }\n\n    if (def->ngraphics && def->nvideos) {\n        if (def->ngraphics == 1 && def->nvideos == 1) {\n            if (bhyveBuildGraphicsArgStr(def, def->graphics[0], def->videos[0],\n                                         driver, cmd, dryRun) < 0)\n                goto error;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Multiple graphics devices are not supported\"));\n             goto error;\n        }\n    }\n\n    if (bhyveDomainDefNeedsISAController(def))\n        bhyveBuildLPCArgStr(def, cmd);\n\n    if (bhyveBuildConsoleArgStr(def, cmd) < 0)\n        goto error;\n\n    if (def->namespaceData) {\n        bhyveDomainCmdlineDefPtr bhyvecmd;\n\n        VIR_WARN(\"Booting the guest using command line pass-through feature, \"\n                 \"which could potentially cause inconsistent state and \"\n                 \"upgrade issues\");\n\n        bhyvecmd = def->namespaceData;\n        for (i = 0; i < bhyvecmd->num_args; i++)\n            virCommandAddArg(cmd, bhyvecmd->args[i]);\n    }\n\n    virCommandAddArg(cmd, def->name);\n\n    return cmd;\n\n error:\n    virCommandFree(cmd);\n    return NULL;\n}",
          "includes": [
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_capabilities.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virnetdevtap.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_conf.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_capabilities.h\"\n#include <config.h>\n\nvirCommandPtr\nvirBhyveProcessBuildBhyveCmd(bhyveConnPtr driver, virDomainDefPtr def,\n                             bool dryRun)\n{\n    /*\n     * /usr/sbin/bhyve -c 2 -m 256 -AI -H -P \\\n     *            -s 0:0,hostbridge \\\n     *            -s 1:0,virtio-net,tap0 \\\n     *            -s 2:0,ahci-hd,${IMG} \\\n     *            -S 31,uart,stdio \\\n     *            vm0\n     */\n    virCommandPtr cmd = virCommandNew(BHYVE);\n    size_t i;\n    unsigned nusbcontrollers = 0;\n    unsigned nvcpus = virDomainDefGetVcpus(def);\n\n    /* CPUs */\n    virCommandAddArg(cmd, \"-c\");\n    if (def->cpu && def->cpu->sockets) {\n        if (def->cpu->dies != 1) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Only 1 die per socket is supported\"));\n            goto error;\n        }\n        if (nvcpus != def->cpu->sockets * def->cpu->cores * def->cpu->threads) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Invalid CPU topology: total number of vCPUs \"\n                             \"must equal the product of sockets, cores, \"\n                             \"and threads\"));\n            goto error;\n        }\n\n        if ((bhyveDriverGetBhyveCaps(driver) & BHYVE_CAP_CPUTOPOLOGY) != 0) {\n            virCommandAddArgFormat(cmd, \"cpus=%d,sockets=%d,cores=%d,threads=%d\",\n                                   nvcpus,\n                                   def->cpu->sockets,\n                                   def->cpu->cores,\n                                   def->cpu->threads);\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Installed bhyve binary does not support \"\n                             \"defining CPU topology\"));\n            goto error;\n        }\n    } else {\n        virCommandAddArgFormat(cmd, \"%d\", nvcpus);\n    }\n\n    /* Memory */\n    virCommandAddArg(cmd, \"-m\");\n    virCommandAddArgFormat(cmd, \"%llu\",\n                           VIR_DIV_UP(virDomainDefGetMemoryInitial(def), 1024));\n\n    if (def->mem.locked)\n        virCommandAddArg(cmd, \"-S\"); /* Wire guest memory */\n\n    /* Options */\n    if (def->features[VIR_DOMAIN_FEATURE_ACPI] == VIR_TRISTATE_SWITCH_ON)\n        virCommandAddArg(cmd, \"-A\"); /* Create an ACPI table */\n    if (def->features[VIR_DOMAIN_FEATURE_APIC] == VIR_TRISTATE_SWITCH_ON)\n        virCommandAddArg(cmd, \"-I\"); /* Present ioapic to the guest */\n    if (def->features[VIR_DOMAIN_FEATURE_MSRS] == VIR_TRISTATE_SWITCH_ON) {\n        if (def->msrs_features[VIR_DOMAIN_MSRS_UNKNOWN] == VIR_DOMAIN_MSRS_UNKNOWN_IGNORE)\n            virCommandAddArg(cmd, \"-w\");\n    }\n\n    switch (def->clock.offset) {\n    case VIR_DOMAIN_CLOCK_OFFSET_LOCALTIME:\n        /* used by default in bhyve */\n        break;\n    case VIR_DOMAIN_CLOCK_OFFSET_UTC:\n        if ((bhyveDriverGetBhyveCaps(driver) & BHYVE_CAP_RTC_UTC) != 0) {\n            virCommandAddArg(cmd, \"-u\");\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Installed bhyve binary does not support \"\n                          \"UTC clock\"));\n            goto error;\n        }\n        break;\n    default:\n         virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                        _(\"unsupported clock offset '%s'\"),\n                        virDomainClockOffsetTypeToString(def->clock.offset));\n         goto error;\n    }\n\n    /* Clarification about -H and -P flags from Peter Grehan:\n     * -H and -P flags force the guest to exit when it executes IA32 HLT and PAUSE\n     * instructions respectively.\n     *\n     * For the HLT exit, bhyve uses that to infer that the guest is idling and can\n     * be put to sleep until an external event arrives. If this option is not used,\n     * the guest will always use 100% of CPU on the host.\n     *\n     * The PAUSE exit is most useful when there are large numbers of guest VMs running,\n     * since it forces the guest to exit when it spins on a lock acquisition.\n     */\n    virCommandAddArg(cmd, \"-H\"); /* vmexit from guest on hlt */\n    virCommandAddArg(cmd, \"-P\"); /* vmexit from guest on pause */\n\n    virCommandAddArgList(cmd, \"-s\", \"0:0,hostbridge\", NULL);\n\n    if (def->os.bootloader == NULL &&\n        def->os.loader) {\n        if ((bhyveDriverGetBhyveCaps(driver) & BHYVE_CAP_LPC_BOOTROM)) {\n            virCommandAddArg(cmd, \"-l\");\n            virCommandAddArgFormat(cmd, \"bootrom,%s\", def->os.loader->path);\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Installed bhyve binary does not support \"\n                             \"UEFI loader\"));\n            goto error;\n        }\n    }\n\n    /* Devices */\n    for (i = 0; i < def->ncontrollers; i++) {\n        if (bhyveBuildControllerArgStr(def, def->controllers[i], driver, cmd,\n                                       &nusbcontrollers) < 0)\n            goto error;\n    }\n    for (i = 0; i < def->nnets; i++) {\n        if (bhyveBuildNetArgStr(def, def->nets[i], driver, cmd, dryRun) < 0)\n            goto error;\n    }\n    for (i = 0; i < def->ndisks; i++) {\n        if (bhyveBuildDiskArgStr(def, def->disks[i], cmd) < 0)\n            goto error;\n    }\n\n    if (def->ngraphics && def->nvideos) {\n        if (def->ngraphics == 1 && def->nvideos == 1) {\n            if (bhyveBuildGraphicsArgStr(def, def->graphics[0], def->videos[0],\n                                         driver, cmd, dryRun) < 0)\n                goto error;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Multiple graphics devices are not supported\"));\n             goto error;\n        }\n    }\n\n    if (bhyveDomainDefNeedsISAController(def))\n        bhyveBuildLPCArgStr(def, cmd);\n\n    if (bhyveBuildConsoleArgStr(def, cmd) < 0)\n        goto error;\n\n    if (def->namespaceData) {\n        bhyveDomainCmdlineDefPtr bhyvecmd;\n\n        VIR_WARN(\"Booting the guest using command line pass-through feature, \"\n                 \"which could potentially cause inconsistent state and \"\n                 \"upgrade issues\");\n\n        bhyvecmd = def->namespaceData;\n        for (i = 0; i < bhyvecmd->num_args; i++)\n            virCommandAddArg(cmd, bhyvecmd->args[i]);\n    }\n\n    virCommandAddArg(cmd, def->name);\n\n    return cmd;\n\n error:\n    virCommandFree(cmd);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddChar",
          "args": [
            "&buf",
            "'\\n'"
          ],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAddChar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "206-210",
          "snippet": "void\nvirBufferAddChar(virBufferPtr buf, char c)\n{\n    virBufferAdd(buf, &c, 1);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAddChar(virBufferPtr buf, char c)\n{\n    virBufferAdd(buf, &c, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBhyveProcessBuildLoadCmd",
          "args": [
            "privconn",
            "def",
            "\"<device.map>\"",
            "NULL"
          ],
          "line": 721
        },
        "resolved": true,
        "details": {
          "function_name": "virBhyveProcessBuildLoadCmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_command.c",
          "lines": "954-973",
          "snippet": "virCommandPtr\nvirBhyveProcessBuildLoadCmd(bhyveConnPtr driver, virDomainDefPtr def,\n                            const char *devmap_file, char **devicesmap_out)\n{\n    virDomainDiskDefPtr disk = NULL;\n\n    if (def->os.bootloader == NULL) {\n        disk = virBhyveGetBootDisk(def);\n\n        if (disk == NULL)\n            return NULL;\n\n        return virBhyveProcessBuildBhyveloadCmd(def, disk);\n    } else if (strstr(def->os.bootloader, \"grub-bhyve\") != NULL) {\n        return virBhyveProcessBuildGrubbhyveCmd(def, driver, devmap_file,\n                                                devicesmap_out);\n    } else {\n        return virBhyveProcessBuildCustomLoaderCmd(def);\n    }\n}",
          "includes": [
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_capabilities.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virnetdevtap.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_conf.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_capabilities.h\"\n#include <config.h>\n\nvirCommandPtr\nvirBhyveProcessBuildLoadCmd(bhyveConnPtr driver, virDomainDefPtr def,\n                            const char *devmap_file, char **devicesmap_out)\n{\n    virDomainDiskDefPtr disk = NULL;\n\n    if (def->os.bootloader == NULL) {\n        disk = virBhyveGetBootDisk(def);\n\n        if (disk == NULL)\n            return NULL;\n\n        return virBhyveProcessBuildBhyveloadCmd(def, disk);\n    } else if (strstr(def->os.bootloader, \"grub-bhyve\") != NULL) {\n        return virBhyveProcessBuildGrubbhyveCmd(def, driver, devmap_file,\n                                                devicesmap_out);\n    } else {\n        return virBhyveProcessBuildCustomLoaderCmd(def);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Installed bhyve binary does not support \"\n                          \"bootrom\")"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Installed bhyve binary does not support \"\n                          \"bootrom\""
          ],
          "line": 716
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bhyveDriverGetBhyveCaps",
          "args": [
            "privconn"
          ],
          "line": 714
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDriverGetBhyveCaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "1316-1322",
          "snippet": "unsigned\nbhyveDriverGetBhyveCaps(bhyveConnPtr driver)\n{\n    if (driver != NULL)\n        return driver->bhyvecaps;\n    return 0;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned\nbhyveDriverGetBhyveCaps(bhyveConnPtr driver)\n{\n    if (driver != NULL)\n        return driver->bhyvecaps;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Only read-only pflash is supported.\")"
          ],
          "line": 709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDefHasOldStyleROUEFI",
          "args": [
            "def"
          ],
          "line": 708
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefHasOldStyleROUEFI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "32090-32095",
          "snippet": "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def)\n{\n    return virDomainDefHasOldStyleUEFI(def) &&\n           def->os.loader->readonly == VIR_TRISTATE_BOOL_YES;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def)\n{\n    return virDomainDefHasOldStyleUEFI(def) &&\n           def->os.loader->readonly == VIR_TRISTATE_BOOL_YES;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bhyveDomainAssignAddresses",
          "args": [
            "def",
            "NULL"
          ],
          "line": 702
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomainAssignAddresses",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_device.c",
          "lines": "186-189",
          "snippet": "int bhyveDomainAssignAddresses(virDomainDefPtr def, virDomainObjPtr obj)\n{\n    return bhyveDomainAssignPCIAddresses(def, obj);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_addr.h\"",
            "#include \"bhyve_device.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"domain_addr.h\"\n#include \"bhyve_device.h\"\n#include <config.h>\n\nint bhyveDomainAssignAddresses(virDomainDefPtr def, virDomainObjPtr obj)\n{\n    return bhyveDomainAssignPCIAddresses(def, obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefParseString",
          "args": [
            "xmlData",
            "privconn->xmlopt",
            "NULL",
            "VIR_DOMAIN_DEF_PARSE_INACTIVE"
          ],
          "line": 698
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "22134-22141",
          "snippet": "virDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Unsupported config type %s\")",
            "format"
          ],
          "line": 693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "format",
            "BHYVE_CONFIG_FORMAT_ARGV"
          ],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConnectDomainXMLToNativeEnsureACL",
          "args": [
            "conn"
          ],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "NULL"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *\nbhyveConnectDomainXMLToNative(virConnectPtr conn,\n                              const char *format,\n                              const char *xmlData,\n                              unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainDefPtr def = NULL;\n    virCommandPtr cmd = NULL, loadcmd = NULL;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (virConnectDomainXMLToNativeEnsureACL(conn) < 0)\n        goto cleanup;\n\n    if (STRNEQ(format, BHYVE_CONFIG_FORMAT_ARGV)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Unsupported config type %s\"), format);\n        goto cleanup;\n    }\n\n    if (!(def = virDomainDefParseString(xmlData, privconn->xmlopt,\n                                        NULL, VIR_DOMAIN_DEF_PARSE_INACTIVE)))\n        goto cleanup;\n\n    if (bhyveDomainAssignAddresses(def, NULL) < 0)\n        goto cleanup;\n\n    if (def->os.bootloader == NULL &&\n        def->os.loader) {\n\n        if (!virDomainDefHasOldStyleROUEFI(def)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Only read-only pflash is supported.\"));\n            goto cleanup;\n        }\n\n        if ((bhyveDriverGetBhyveCaps(privconn) & BHYVE_CAP_LPC_BOOTROM) == 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Installed bhyve binary does not support \"\n                          \"bootrom\"));\n            goto cleanup;\n        }\n    } else {\n        if (!(loadcmd = virBhyveProcessBuildLoadCmd(privconn, def,\n                                                    \"<device.map>\", NULL)))\n            goto cleanup;\n\n        virBufferAdd(&buf, virCommandToString(loadcmd, false), -1);\n        virBufferAddChar(&buf, '\\n');\n    }\n\n    if (!(cmd = virBhyveProcessBuildBhyveCmd(privconn, def, true)))\n        goto cleanup;\n\n    virBufferAdd(&buf, virCommandToString(cmd, false), -1);\n\n    ret = virBufferContentAndReset(&buf);\n\n cleanup:\n    virCommandFree(loadcmd);\n    virCommandFree(cmd);\n    virDomainDefFree(def);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveConnectNumOfDefinedDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "662-673",
    "snippet": "static int\nbhyveConnectNumOfDefinedDomains(virConnectPtr conn)\n{\n    bhyveConnPtr privconn = conn->privateData;\n\n    if (virConnectNumOfDefinedDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListNumOfDomains(privconn->domains, false,\n                                        virConnectNumOfDefinedDomainsCheckACL,\n                                        conn);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjListNumOfDomains",
          "args": [
            "privconn->domains",
            "false",
            "virConnectNumOfDefinedDomainsCheckACL",
            "conn"
          ],
          "line": 670
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListNumOfDomains",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "674-685",
          "snippet": "int\nvirDomainObjListNumOfDomains(virDomainObjListPtr doms,\n                             bool active,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainObjListData data = { filter, conn, active, 0 };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCount, &data);\n    virObjectRWUnlock(doms);\n    return data.count;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListNumOfDomains(virDomainObjListPtr doms,\n                             bool active,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainObjListData data = { filter, conn, active, 0 };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCount, &data);\n    virObjectRWUnlock(doms);\n    return data.count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectNumOfDefinedDomainsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveConnectNumOfDefinedDomains(virConnectPtr conn)\n{\n    bhyveConnPtr privconn = conn->privateData;\n\n    if (virConnectNumOfDefinedDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListNumOfDomains(privconn->domains, false,\n                                        virConnectNumOfDefinedDomainsCheckACL,\n                                        conn);\n}"
  },
  {
    "function_name": "bhyveConnectListDefinedDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "646-660",
    "snippet": "static int\nbhyveConnectListDefinedDomains(virConnectPtr conn, char **const names,\n                               int maxnames)\n{\n    bhyveConnPtr privconn = conn->privateData;\n\n    if (virConnectListDefinedDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    memset(names, 0, sizeof(*names) * maxnames);\n    return virDomainObjListGetInactiveNames(privconn->domains, names,\n                                            maxnames,\n                                            virConnectListDefinedDomainsCheckACL,\n                                            conn);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjListGetInactiveNames",
          "args": [
            "privconn->domains",
            "names",
            "maxnames",
            "virConnectListDefinedDomainsCheckACL",
            "conn"
          ],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListGetInactiveNames",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "768-788",
          "snippet": "int\nvirDomainObjListGetInactiveNames(virDomainObjListPtr doms,\n                                 char **const names,\n                                 int maxnames,\n                                 virDomainObjListACLFilter filter,\n                                 virConnectPtr conn)\n{\n    struct virDomainNameData data = { filter, conn,\n                                      0, 0, maxnames, names };\n    size_t i;\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCopyInactiveNames, &data);\n    virObjectRWUnlock(doms);\n    if (data.oom) {\n        for (i = 0; i < data.numnames; i++)\n            VIR_FREE(data.names[i]);\n        return -1;\n    }\n\n    return data.numnames;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListGetInactiveNames(virDomainObjListPtr doms,\n                                 char **const names,\n                                 int maxnames,\n                                 virDomainObjListACLFilter filter,\n                                 virConnectPtr conn)\n{\n    struct virDomainNameData data = { filter, conn,\n                                      0, 0, maxnames, names };\n    size_t i;\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCopyInactiveNames, &data);\n    virObjectRWUnlock(doms);\n    if (data.oom) {\n        for (i = 0; i < data.numnames; i++)\n            VIR_FREE(data.names[i]);\n        return -1;\n    }\n\n    return data.numnames;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "names",
            "0",
            "sizeof(*names) * maxnames"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConnectListDefinedDomainsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveConnectListDefinedDomains(virConnectPtr conn, char **const names,\n                               int maxnames)\n{\n    bhyveConnPtr privconn = conn->privateData;\n\n    if (virConnectListDefinedDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    memset(names, 0, sizeof(*names) * maxnames);\n    return virDomainObjListGetInactiveNames(privconn->domains, names,\n                                            maxnames,\n                                            virConnectListDefinedDomainsCheckACL,\n                                            conn);\n}"
  },
  {
    "function_name": "bhyveConnectNumOfDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "634-644",
    "snippet": "static int\nbhyveConnectNumOfDomains(virConnectPtr conn)\n{\n    bhyveConnPtr privconn = conn->privateData;\n\n    if (virConnectNumOfDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListNumOfDomains(privconn->domains, true,\n                                        virConnectNumOfDomainsCheckACL, conn);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjListNumOfDomains",
          "args": [
            "privconn->domains",
            "true",
            "virConnectNumOfDomainsCheckACL",
            "conn"
          ],
          "line": 642
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListNumOfDomains",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "674-685",
          "snippet": "int\nvirDomainObjListNumOfDomains(virDomainObjListPtr doms,\n                             bool active,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainObjListData data = { filter, conn, active, 0 };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCount, &data);\n    virObjectRWUnlock(doms);\n    return data.count;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListNumOfDomains(virDomainObjListPtr doms,\n                             bool active,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainObjListData data = { filter, conn, active, 0 };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCount, &data);\n    virObjectRWUnlock(doms);\n    return data.count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectNumOfDomainsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveConnectNumOfDomains(virConnectPtr conn)\n{\n    bhyveConnPtr privconn = conn->privateData;\n\n    if (virConnectNumOfDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListNumOfDomains(privconn->domains, true,\n                                        virConnectNumOfDomainsCheckACL, conn);\n}"
  },
  {
    "function_name": "bhyveConnectListDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "622-632",
    "snippet": "static int\nbhyveConnectListDomains(virConnectPtr conn, int *ids, int maxids)\n{\n    bhyveConnPtr privconn = conn->privateData;\n\n    if (virConnectListDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListGetActiveIDs(privconn->domains, ids, maxids,\n                                        virConnectListDomainsCheckACL, conn);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjListGetActiveIDs",
          "args": [
            "privconn->domains",
            "ids",
            "maxids",
            "virConnectListDomainsCheckACL",
            "conn"
          ],
          "line": 630
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListGetActiveIDs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "716-729",
          "snippet": "int\nvirDomainObjListGetActiveIDs(virDomainObjListPtr doms,\n                             int *ids,\n                             int maxids,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainIDData data = { filter, conn,\n                                    0, maxids, ids };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCopyActiveIDs, &data);\n    virObjectRWUnlock(doms);\n    return data.numids;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListGetActiveIDs(virDomainObjListPtr doms,\n                             int *ids,\n                             int maxids,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainIDData data = { filter, conn,\n                                    0, maxids, ids };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCopyActiveIDs, &data);\n    virObjectRWUnlock(doms);\n    return data.numids;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectListDomainsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveConnectListDomains(virConnectPtr conn, int *ids, int maxids)\n{\n    bhyveConnPtr privconn = conn->privateData;\n\n    if (virConnectListDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListGetActiveIDs(privconn->domains, ids, maxids,\n                                        virConnectListDomainsCheckACL, conn);\n}"
  },
  {
    "function_name": "bhyveDomainUndefine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "616-620",
    "snippet": "static int\nbhyveDomainUndefine(virDomainPtr domain)\n{\n    return bhyveDomainUndefineFlags(domain, 0);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bhyveDomainUndefineFlags",
          "args": [
            "domain",
            "0"
          ],
          "line": 619
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomainUndefineFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "573-614",
          "snippet": "static int\nbhyveDomainUndefineFlags(virDomainPtr domain, unsigned int flags)\n{\n    bhyveConnPtr privconn = domain->conn->privateData;\n    virObjectEventPtr event = NULL;\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n    if (!(vm = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainUndefineFlagsEnsureACL(domain->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (!vm->persistent) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Cannot undefine transient domain\"));\n        goto cleanup;\n    }\n\n    if (virDomainDeleteConfig(BHYVE_CONFIG_DIR,\n                              BHYVE_AUTOSTART_DIR,\n                              vm) < 0)\n        goto cleanup;\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                              VIR_DOMAIN_EVENT_UNDEFINED,\n                                              VIR_DOMAIN_EVENT_UNDEFINED_REMOVED);\n\n    if (virDomainObjIsActive(vm))\n        vm->persistent = 0;\n    else\n        virDomainObjListRemove(privconn->domains, vm);\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n    return ret;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainUndefineFlags(virDomainPtr domain, unsigned int flags)\n{\n    bhyveConnPtr privconn = domain->conn->privateData;\n    virObjectEventPtr event = NULL;\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n    if (!(vm = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainUndefineFlagsEnsureACL(domain->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (!vm->persistent) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Cannot undefine transient domain\"));\n        goto cleanup;\n    }\n\n    if (virDomainDeleteConfig(BHYVE_CONFIG_DIR,\n                              BHYVE_AUTOSTART_DIR,\n                              vm) < 0)\n        goto cleanup;\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                              VIR_DOMAIN_EVENT_UNDEFINED,\n                                              VIR_DOMAIN_EVENT_UNDEFINED_REMOVED);\n\n    if (virDomainObjIsActive(vm))\n        vm->persistent = 0;\n    else\n        virDomainObjListRemove(privconn->domains, vm);\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainUndefine(virDomainPtr domain)\n{\n    return bhyveDomainUndefineFlags(domain, 0);\n}"
  },
  {
    "function_name": "bhyveDomainUndefineFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "573-614",
    "snippet": "static int\nbhyveDomainUndefineFlags(virDomainPtr domain, unsigned int flags)\n{\n    bhyveConnPtr privconn = domain->conn->privateData;\n    virObjectEventPtr event = NULL;\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n    if (!(vm = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainUndefineFlagsEnsureACL(domain->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (!vm->persistent) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Cannot undefine transient domain\"));\n        goto cleanup;\n    }\n\n    if (virDomainDeleteConfig(BHYVE_CONFIG_DIR,\n                              BHYVE_AUTOSTART_DIR,\n                              vm) < 0)\n        goto cleanup;\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                              VIR_DOMAIN_EVENT_UNDEFINED,\n                                              VIR_DOMAIN_EVENT_UNDEFINED_REMOVED);\n\n    if (virDomainObjIsActive(vm))\n        vm->persistent = 0;\n    else\n        virDomainObjListRemove(privconn->domains, vm);\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "privconn->domainEventState",
            "event"
          ],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListRemove",
          "args": [
            "privconn->domains",
            "vm"
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "401-413",
          "snippet": "void\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "vm"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainEventLifecycleNewFromObj",
          "args": [
            "vm",
            "VIR_DOMAIN_EVENT_UNDEFINED",
            "VIR_DOMAIN_EVENT_UNDEFINED_REMOVED"
          ],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventLifecycleNewFromObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "610-616",
          "snippet": "virObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainEventDispose(void *obj);",
            "static void virDomainEventLifecycleDispose(void *obj);",
            "static void virDomainEventRTCChangeDispose(void *obj);",
            "static void virDomainEventWatchdogDispose(void *obj);",
            "static void virDomainEventIOErrorDispose(void *obj);",
            "static void virDomainEventGraphicsDispose(void *obj);",
            "static void virDomainEventBlockJobDispose(void *obj);",
            "static void virDomainEventDiskChangeDispose(void *obj);",
            "static void virDomainEventTrayChangeDispose(void *obj);",
            "static void virDomainEventBalloonChangeDispose(void *obj);",
            "static void virDomainEventDeviceRemovedDispose(void *obj);",
            "static void virDomainEventPMDispose(void *obj);",
            "static void virDomainQemuMonitorEventDispose(void *obj);",
            "static void virDomainEventTunableDispose(void *obj);",
            "static void virDomainEventAgentLifecycleDispose(void *obj);",
            "static void virDomainEventDeviceAddedDispose(void *obj);",
            "static void virDomainEventMigrationIterationDispose(void *obj);",
            "static void virDomainEventJobCompletedDispose(void *obj);",
            "static void virDomainEventDeviceRemovalFailedDispose(void *obj);",
            "static void virDomainEventMetadataChangeDispose(void *obj);",
            "static void virDomainEventBlockThresholdDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virDomainEventDispose(void *obj);\nstatic void virDomainEventLifecycleDispose(void *obj);\nstatic void virDomainEventRTCChangeDispose(void *obj);\nstatic void virDomainEventWatchdogDispose(void *obj);\nstatic void virDomainEventIOErrorDispose(void *obj);\nstatic void virDomainEventGraphicsDispose(void *obj);\nstatic void virDomainEventBlockJobDispose(void *obj);\nstatic void virDomainEventDiskChangeDispose(void *obj);\nstatic void virDomainEventTrayChangeDispose(void *obj);\nstatic void virDomainEventBalloonChangeDispose(void *obj);\nstatic void virDomainEventDeviceRemovedDispose(void *obj);\nstatic void virDomainEventPMDispose(void *obj);\nstatic void virDomainQemuMonitorEventDispose(void *obj);\nstatic void virDomainEventTunableDispose(void *obj);\nstatic void virDomainEventAgentLifecycleDispose(void *obj);\nstatic void virDomainEventDeviceAddedDispose(void *obj);\nstatic void virDomainEventMigrationIterationDispose(void *obj);\nstatic void virDomainEventJobCompletedDispose(void *obj);\nstatic void virDomainEventDeviceRemovalFailedDispose(void *obj);\nstatic void virDomainEventMetadataChangeDispose(void *obj);\nstatic void virDomainEventBlockThresholdDispose(void *obj);\n\nvirObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeleteConfig",
          "args": [
            "BHYVE_CONFIG_DIR",
            "BHYVE_AUTOSTART_DIR",
            "vm"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeleteConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29726-29753",
          "snippet": "int\nvirDomainDeleteConfig(const char *configDir,\n                      const char *autostartDir,\n                      virDomainObjPtr dom)\n{\n    g_autofree char *configFile = NULL;\n    g_autofree char *autostartLink = NULL;\n\n    if ((configFile = virDomainConfigFile(configDir, dom->def->name)) == NULL)\n        return -1;\n    if ((autostartLink = virDomainConfigFile(autostartDir,\n                                             dom->def->name)) == NULL)\n        return -1;\n\n    /* Not fatal if this doesn't work */\n    unlink(autostartLink);\n    dom->autostart = 0;\n\n    if (unlink(configFile) < 0 &&\n        errno != ENOENT) {\n        virReportSystemError(errno,\n                             _(\"cannot remove config %s\"),\n                             configFile);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDeleteConfig(const char *configDir,\n                      const char *autostartDir,\n                      virDomainObjPtr dom)\n{\n    g_autofree char *configFile = NULL;\n    g_autofree char *autostartLink = NULL;\n\n    if ((configFile = virDomainConfigFile(configDir, dom->def->name)) == NULL)\n        return -1;\n    if ((autostartLink = virDomainConfigFile(autostartDir,\n                                             dom->def->name)) == NULL)\n        return -1;\n\n    /* Not fatal if this doesn't work */\n    unlink(autostartLink);\n    dom->autostart = 0;\n\n    if (unlink(configFile) < 0 &&\n        errno != ENOENT) {\n        virReportSystemError(errno,\n                             _(\"cannot remove config %s\"),\n                             configFile);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Cannot undefine transient domain\")"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot undefine transient domain\""
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainUndefineFlagsEnsureACL",
          "args": [
            "domain->conn",
            "vm->def"
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "163-180",
          "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainUndefineFlags(virDomainPtr domain, unsigned int flags)\n{\n    bhyveConnPtr privconn = domain->conn->privateData;\n    virObjectEventPtr event = NULL;\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n    if (!(vm = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainUndefineFlagsEnsureACL(domain->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (!vm->persistent) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Cannot undefine transient domain\"));\n        goto cleanup;\n    }\n\n    if (virDomainDeleteConfig(BHYVE_CONFIG_DIR,\n                              BHYVE_AUTOSTART_DIR,\n                              vm) < 0)\n        goto cleanup;\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                              VIR_DOMAIN_EVENT_UNDEFINED,\n                                              VIR_DOMAIN_EVENT_UNDEFINED_REMOVED);\n\n    if (virDomainObjIsActive(vm))\n        vm->persistent = 0;\n    else\n        virDomainObjListRemove(privconn->domains, vm);\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveDomainDefineXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "567-571",
    "snippet": "static virDomainPtr\nbhyveDomainDefineXML(virConnectPtr conn, const char *xml)\n{\n    return bhyveDomainDefineXMLFlags(conn, xml, 0);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bhyveDomainDefineXMLFlags",
          "args": [
            "conn",
            "xml",
            "0"
          ],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomainDefineXMLFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "502-565",
          "snippet": "static virDomainPtr\nbhyveDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainPtr dom = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr oldDef = NULL;\n    virDomainObjPtr vm = NULL;\n    virObjectEventPtr event = NULL;\n    virCapsPtr caps = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_DEFINE_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_DEFINE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    caps = bhyveDriverGetCapabilities(privconn);\n    if (!caps)\n        return NULL;\n\n    if ((def = virDomainDefParseString(xml, privconn->xmlopt,\n                                       NULL, parse_flags)) == NULL)\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", def->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (virDomainDefineXMLFlagsEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (bhyveDomainAssignAddresses(def, NULL) < 0)\n        goto cleanup;\n\n    if (!(vm = virDomainObjListAdd(privconn->domains, def,\n                                   privconn->xmlopt,\n                                   0, &oldDef)))\n        goto cleanup;\n    def = NULL;\n    vm->persistent = 1;\n\n    if (virDomainDefSave(vm->newDef ? vm->newDef : vm->def,\n                         privconn->xmlopt, BHYVE_CONFIG_DIR) < 0) {\n        virDomainObjListRemove(privconn->domains, vm);\n        goto cleanup;\n    }\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                              VIR_DOMAIN_EVENT_DEFINED,\n                                              !oldDef ?\n                                              VIR_DOMAIN_EVENT_DEFINED_ADDED :\n                                              VIR_DOMAIN_EVENT_DEFINED_UPDATED);\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virObjectUnref(caps);\n    virDomainDefFree(def);\n    virDomainDefFree(oldDef);\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n\n    return dom;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainPtr\nbhyveDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainPtr dom = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr oldDef = NULL;\n    virDomainObjPtr vm = NULL;\n    virObjectEventPtr event = NULL;\n    virCapsPtr caps = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_DEFINE_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_DEFINE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    caps = bhyveDriverGetCapabilities(privconn);\n    if (!caps)\n        return NULL;\n\n    if ((def = virDomainDefParseString(xml, privconn->xmlopt,\n                                       NULL, parse_flags)) == NULL)\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", def->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (virDomainDefineXMLFlagsEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (bhyveDomainAssignAddresses(def, NULL) < 0)\n        goto cleanup;\n\n    if (!(vm = virDomainObjListAdd(privconn->domains, def,\n                                   privconn->xmlopt,\n                                   0, &oldDef)))\n        goto cleanup;\n    def = NULL;\n    vm->persistent = 1;\n\n    if (virDomainDefSave(vm->newDef ? vm->newDef : vm->def,\n                         privconn->xmlopt, BHYVE_CONFIG_DIR) < 0) {\n        virDomainObjListRemove(privconn->domains, vm);\n        goto cleanup;\n    }\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                              VIR_DOMAIN_EVENT_DEFINED,\n                                              !oldDef ?\n                                              VIR_DOMAIN_EVENT_DEFINED_ADDED :\n                                              VIR_DOMAIN_EVENT_DEFINED_UPDATED);\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virObjectUnref(caps);\n    virDomainDefFree(def);\n    virDomainDefFree(oldDef);\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n\n    return dom;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainPtr\nbhyveDomainDefineXML(virConnectPtr conn, const char *xml)\n{\n    return bhyveDomainDefineXMLFlags(conn, xml, 0);\n}"
  },
  {
    "function_name": "bhyveDomainDefineXMLFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "502-565",
    "snippet": "static virDomainPtr\nbhyveDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainPtr dom = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr oldDef = NULL;\n    virDomainObjPtr vm = NULL;\n    virObjectEventPtr event = NULL;\n    virCapsPtr caps = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_DEFINE_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_DEFINE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    caps = bhyveDriverGetCapabilities(privconn);\n    if (!caps)\n        return NULL;\n\n    if ((def = virDomainDefParseString(xml, privconn->xmlopt,\n                                       NULL, parse_flags)) == NULL)\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", def->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (virDomainDefineXMLFlagsEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (bhyveDomainAssignAddresses(def, NULL) < 0)\n        goto cleanup;\n\n    if (!(vm = virDomainObjListAdd(privconn->domains, def,\n                                   privconn->xmlopt,\n                                   0, &oldDef)))\n        goto cleanup;\n    def = NULL;\n    vm->persistent = 1;\n\n    if (virDomainDefSave(vm->newDef ? vm->newDef : vm->def,\n                         privconn->xmlopt, BHYVE_CONFIG_DIR) < 0) {\n        virDomainObjListRemove(privconn->domains, vm);\n        goto cleanup;\n    }\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                              VIR_DOMAIN_EVENT_DEFINED,\n                                              !oldDef ?\n                                              VIR_DOMAIN_EVENT_DEFINED_ADDED :\n                                              VIR_DOMAIN_EVENT_DEFINED_UPDATED);\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virObjectUnref(caps);\n    virDomainDefFree(def);\n    virDomainDefFree(oldDef);\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n\n    return dom;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "privconn->domainEventState",
            "event"
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "oldDef"
          ],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "caps"
          ],
          "line": 558
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "vm->def->name",
            "vm->def->uuid",
            "vm->def->id"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainEventLifecycleNewFromObj",
          "args": [
            "vm",
            "VIR_DOMAIN_EVENT_DEFINED",
            "!oldDef ?\n                                              VIR_DOMAIN_EVENT_DEFINED_ADDED :\n                                              VIR_DOMAIN_EVENT_DEFINED_UPDATED"
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventLifecycleNewFromObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "610-616",
          "snippet": "virObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainEventDispose(void *obj);",
            "static void virDomainEventLifecycleDispose(void *obj);",
            "static void virDomainEventRTCChangeDispose(void *obj);",
            "static void virDomainEventWatchdogDispose(void *obj);",
            "static void virDomainEventIOErrorDispose(void *obj);",
            "static void virDomainEventGraphicsDispose(void *obj);",
            "static void virDomainEventBlockJobDispose(void *obj);",
            "static void virDomainEventDiskChangeDispose(void *obj);",
            "static void virDomainEventTrayChangeDispose(void *obj);",
            "static void virDomainEventBalloonChangeDispose(void *obj);",
            "static void virDomainEventDeviceRemovedDispose(void *obj);",
            "static void virDomainEventPMDispose(void *obj);",
            "static void virDomainQemuMonitorEventDispose(void *obj);",
            "static void virDomainEventTunableDispose(void *obj);",
            "static void virDomainEventAgentLifecycleDispose(void *obj);",
            "static void virDomainEventDeviceAddedDispose(void *obj);",
            "static void virDomainEventMigrationIterationDispose(void *obj);",
            "static void virDomainEventJobCompletedDispose(void *obj);",
            "static void virDomainEventDeviceRemovalFailedDispose(void *obj);",
            "static void virDomainEventMetadataChangeDispose(void *obj);",
            "static void virDomainEventBlockThresholdDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virDomainEventDispose(void *obj);\nstatic void virDomainEventLifecycleDispose(void *obj);\nstatic void virDomainEventRTCChangeDispose(void *obj);\nstatic void virDomainEventWatchdogDispose(void *obj);\nstatic void virDomainEventIOErrorDispose(void *obj);\nstatic void virDomainEventGraphicsDispose(void *obj);\nstatic void virDomainEventBlockJobDispose(void *obj);\nstatic void virDomainEventDiskChangeDispose(void *obj);\nstatic void virDomainEventTrayChangeDispose(void *obj);\nstatic void virDomainEventBalloonChangeDispose(void *obj);\nstatic void virDomainEventDeviceRemovedDispose(void *obj);\nstatic void virDomainEventPMDispose(void *obj);\nstatic void virDomainQemuMonitorEventDispose(void *obj);\nstatic void virDomainEventTunableDispose(void *obj);\nstatic void virDomainEventAgentLifecycleDispose(void *obj);\nstatic void virDomainEventDeviceAddedDispose(void *obj);\nstatic void virDomainEventMigrationIterationDispose(void *obj);\nstatic void virDomainEventJobCompletedDispose(void *obj);\nstatic void virDomainEventDeviceRemovalFailedDispose(void *obj);\nstatic void virDomainEventMetadataChangeDispose(void *obj);\nstatic void virDomainEventBlockThresholdDispose(void *obj);\n\nvirObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListRemove",
          "args": [
            "privconn->domains",
            "vm"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "401-413",
          "snippet": "void\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefSave",
          "args": [
            "vm->newDef ? vm->newDef : vm->def",
            "privconn->xmlopt",
            "BHYVE_CONFIG_DIR"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29693-29704",
          "snippet": "int\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListAdd",
          "args": [
            "privconn->domains",
            "def",
            "privconn->xmlopt",
            "0",
            "&oldDef"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "354-366",
          "snippet": "virDomainObjPtr virDomainObjListAdd(virDomainObjListPtr doms,\n                                    virDomainDefPtr def,\n                                    virDomainXMLOptionPtr xmlopt,\n                                    unsigned int flags,\n                                    virDomainDefPtr *oldDef)\n{\n    virDomainObjPtr ret;\n\n    virObjectRWLockWrite(doms);\n    ret = virDomainObjListAddLocked(doms, def, xmlopt, flags, oldDef);\n    virObjectRWUnlock(doms);\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainObjPtr virDomainObjListAdd(virDomainObjListPtr doms,\n                                    virDomainDefPtr def,\n                                    virDomainXMLOptionPtr xmlopt,\n                                    unsigned int flags,\n                                    virDomainDefPtr *oldDef)\n{\n    virDomainObjPtr ret;\n\n    virObjectRWLockWrite(doms);\n    ret = virDomainObjListAddLocked(doms, def, xmlopt, flags, oldDef);\n    virObjectRWUnlock(doms);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bhyveDomainAssignAddresses",
          "args": [
            "def",
            "NULL"
          ],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomainAssignAddresses",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_device.c",
          "lines": "186-189",
          "snippet": "int bhyveDomainAssignAddresses(virDomainDefPtr def, virDomainObjPtr obj)\n{\n    return bhyveDomainAssignPCIAddresses(def, obj);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_addr.h\"",
            "#include \"bhyve_device.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"domain_addr.h\"\n#include \"bhyve_device.h\"\n#include <config.h>\n\nint bhyveDomainAssignAddresses(virDomainDefPtr def, virDomainObjPtr obj)\n{\n    return bhyveDomainAssignPCIAddresses(def, obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefineXMLFlagsEnsureACL",
          "args": [
            "conn",
            "def"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLCheckIllegalChars",
          "args": [
            "\"name\"",
            "def->name",
            "\"\\n\""
          ],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLCheckIllegalChars",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "490-502",
          "snippet": "int\nvirXMLCheckIllegalChars(const char *nodeName,\n                        const char *str,\n                        const char *illegal)\n{\n    char *c;\n    if ((c = strpbrk(str, illegal))) {\n        virReportError(VIR_ERR_XML_DETAIL,\n                       _(\"invalid char in %s: %c\"), nodeName, *c);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXMLCheckIllegalChars(const char *nodeName,\n                        const char *str,\n                        const char *illegal)\n{\n    char *c;\n    if ((c = strpbrk(str, illegal))) {\n        virReportError(VIR_ERR_XML_DETAIL,\n                       _(\"invalid char in %s: %c\"), nodeName, *c);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefParseString",
          "args": [
            "xml",
            "privconn->xmlopt",
            "NULL",
            "parse_flags"
          ],
          "line": 523
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "22134-22141",
          "snippet": "virDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bhyveDriverGetCapabilities",
          "args": [
            "privconn"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_DEFINE_VALIDATE",
            "NULL"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainPtr\nbhyveDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    virDomainPtr dom = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr oldDef = NULL;\n    virDomainObjPtr vm = NULL;\n    virObjectEventPtr event = NULL;\n    virCapsPtr caps = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_DEFINE_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_DEFINE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    caps = bhyveDriverGetCapabilities(privconn);\n    if (!caps)\n        return NULL;\n\n    if ((def = virDomainDefParseString(xml, privconn->xmlopt,\n                                       NULL, parse_flags)) == NULL)\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", def->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (virDomainDefineXMLFlagsEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (bhyveDomainAssignAddresses(def, NULL) < 0)\n        goto cleanup;\n\n    if (!(vm = virDomainObjListAdd(privconn->domains, def,\n                                   privconn->xmlopt,\n                                   0, &oldDef)))\n        goto cleanup;\n    def = NULL;\n    vm->persistent = 1;\n\n    if (virDomainDefSave(vm->newDef ? vm->newDef : vm->def,\n                         privconn->xmlopt, BHYVE_CONFIG_DIR) < 0) {\n        virDomainObjListRemove(privconn->domains, vm);\n        goto cleanup;\n    }\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                              VIR_DOMAIN_EVENT_DEFINED,\n                                              !oldDef ?\n                                              VIR_DOMAIN_EVENT_DEFINED_ADDED :\n                                              VIR_DOMAIN_EVENT_DEFINED_UPDATED);\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virObjectUnref(caps);\n    virDomainDefFree(def);\n    virDomainDefFree(oldDef);\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(privconn->domainEventState, event);\n\n    return dom;\n}"
  },
  {
    "function_name": "bhyveDomainGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "479-500",
    "snippet": "static char *\nbhyveDomainGetXMLDesc(virDomainPtr domain, unsigned int flags)\n{\n    bhyveConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr vm;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_DOMAIN_XML_COMMON_FLAGS, NULL);\n\n    if (!(vm = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainGetXMLDescEnsureACL(domain->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    ret = virDomainDefFormat(vm->def, privconn->xmlopt,\n                             virDomainDefFormatConvertXMLFlags(flags));\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFormat",
          "args": [
            "vm->def",
            "privconn->xmlopt",
            "virDomainDefFormatConvertXMLFlags(flags)"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29496-29508",
          "snippet": "char *\nvirDomainDefFormat(virDomainDefPtr def,\n                   virDomainXMLOptionPtr xmlopt,\n                   unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS, NULL);\n    if (virDomainDefFormatInternal(def, xmlopt, &buf, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS \\\n    (VIR_DOMAIN_DEF_FORMAT_SECURE | \\\n     VIR_DOMAIN_DEF_FORMAT_INACTIVE | \\\n     VIR_DOMAIN_DEF_FORMAT_MIGRATABLE)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS \\\n    (VIR_DOMAIN_DEF_FORMAT_SECURE | \\\n     VIR_DOMAIN_DEF_FORMAT_INACTIVE | \\\n     VIR_DOMAIN_DEF_FORMAT_MIGRATABLE)\n\nchar *\nvirDomainDefFormat(virDomainDefPtr def,\n                   virDomainXMLOptionPtr xmlopt,\n                   unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS, NULL);\n    if (virDomainDefFormatInternal(def, xmlopt, &buf, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFormatConvertXMLFlags",
          "args": [
            "flags"
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFormatConvertXMLFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29481-29493",
          "snippet": "unsigned int virDomainDefFormatConvertXMLFlags(unsigned int flags)\n{\n    unsigned int formatFlags = 0;\n\n    if (flags & VIR_DOMAIN_XML_SECURE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_SECURE;\n    if (flags & VIR_DOMAIN_XML_INACTIVE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_INACTIVE;\n    if (flags & VIR_DOMAIN_XML_MIGRATABLE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_MIGRATABLE;\n\n    return formatFlags;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned int virDomainDefFormatConvertXMLFlags(unsigned int flags)\n{\n    unsigned int formatFlags = 0;\n\n    if (flags & VIR_DOMAIN_XML_SECURE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_SECURE;\n    if (flags & VIR_DOMAIN_XML_INACTIVE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_INACTIVE;\n    if (flags & VIR_DOMAIN_XML_MIGRATABLE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_MIGRATABLE;\n\n    return formatFlags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetXMLDescEnsureACL",
          "args": [
            "domain->conn",
            "vm->def",
            "flags"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "163-180",
          "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_XML_COMMON_FLAGS",
            "NULL"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *\nbhyveDomainGetXMLDesc(virDomainPtr domain, unsigned int flags)\n{\n    bhyveConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr vm;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_DOMAIN_XML_COMMON_FLAGS, NULL);\n\n    if (!(vm = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainGetXMLDescEnsureACL(domain->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    ret = virDomainDefFormat(vm->def, privconn->xmlopt,\n                             virDomainDefFormatConvertXMLFlags(flags));\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveDomainGetOSType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "460-477",
    "snippet": "static char *\nbhyveDomainGetOSType(virDomainPtr dom)\n{\n    virDomainObjPtr vm;\n    char *ret = NULL;\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainGetOSTypeEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    ret = g_strdup(virDomainOSTypeToString(vm->def->os.type));\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "virDomainOSTypeToString(vm->def->os.type)"
          ],
          "line": 472
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainOSTypeToString",
          "args": [
            "vm->def->os.type"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainGetOSTypeEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "163-180",
          "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *\nbhyveDomainGetOSType(virDomainPtr dom)\n{\n    virDomainObjPtr vm;\n    char *ret = NULL;\n\n    if (!(vm = bhyveDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainGetOSTypeEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    ret = g_strdup(virDomainOSTypeToString(vm->def->os.type));\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveDomainIsPersistent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "441-458",
    "snippet": "static int\nbhyveDomainIsPersistent(virDomainPtr domain)\n{\n    virDomainObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainIsPersistentEnsureACL(domain->conn, obj->def) < 0)\n        goto cleanup;\n\n    ret = obj->persistent;\n\n cleanup:\n    virDomainObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 456
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainIsPersistentEnsureACL",
          "args": [
            "domain->conn",
            "obj->def"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "163-180",
          "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainIsPersistent(virDomainPtr domain)\n{\n    virDomainObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainIsPersistentEnsureACL(domain->conn, obj->def) < 0)\n        goto cleanup;\n\n    ret = obj->persistent;\n\n cleanup:\n    virDomainObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveDomainIsActive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "422-439",
    "snippet": "static int\nbhyveDomainIsActive(virDomainPtr domain)\n{\n    virDomainObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainIsActiveEnsureACL(domain->conn, obj->def) < 0)\n        goto cleanup;\n\n    ret = virDomainObjIsActive(obj);\n\n cleanup:\n    virDomainObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 437
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "obj"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainIsActiveEnsureACL",
          "args": [
            "domain->conn",
            "obj->def"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "163-180",
          "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainIsActive(virDomainPtr domain)\n{\n    virDomainObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainIsActiveEnsureACL(domain->conn, obj->def) < 0)\n        goto cleanup;\n\n    ret = virDomainObjIsActive(obj);\n\n cleanup:\n    virDomainObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveDomainSetAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "359-420",
    "snippet": "static int\nbhyveDomainSetAutostart(virDomainPtr domain, int autostart)\n{\n    virDomainObjPtr vm;\n    char *configFile = NULL;\n    char *autostartLink = NULL;\n    int ret = -1;\n\n    if (!(vm = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainSetAutostartEnsureACL(domain->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (!vm->persistent) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"cannot set autostart for transient domain\"));\n        goto cleanup;\n    }\n\n    autostart = (autostart != 0);\n\n    if (vm->autostart != autostart) {\n        if ((configFile = virDomainConfigFile(BHYVE_CONFIG_DIR, vm->def->name)) == NULL)\n            goto cleanup;\n        if ((autostartLink = virDomainConfigFile(BHYVE_AUTOSTART_DIR, vm->def->name)) == NULL)\n            goto cleanup;\n\n        if (autostart) {\n            if (virFileMakePath(BHYVE_AUTOSTART_DIR) < 0) {\n                virReportSystemError(errno,\n                                     _(\"cannot create autostart directory %s\"),\n                                     BHYVE_AUTOSTART_DIR);\n                goto cleanup;\n            }\n\n            if (symlink(configFile, autostartLink) < 0) {\n                virReportSystemError(errno,\n                                     _(\"Failed to create symlink '%s' to '%s'\"),\n                                     autostartLink, configFile);\n                goto cleanup;\n            }\n        } else {\n            if (unlink(autostartLink) < 0 && errno != ENOENT && errno != ENOTDIR) {\n                virReportSystemError(errno,\n                                     _(\"Failed to delete symlink '%s'\"),\n                                     autostartLink);\n                goto cleanup;\n            }\n        }\n\n        vm->autostart = autostart;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(configFile);\n    VIR_FREE(autostartLink);\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 418
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "autostartLink"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "configFile"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to delete symlink '%s'\")",
            "autostartLink"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to delete symlink '%s'\""
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "autostartLink"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to create symlink '%s' to '%s'\")",
            "autostartLink",
            "configFile"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "symlink",
          "args": [
            "configFile",
            "autostartLink"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot create autostart directory %s\")",
            "BHYVE_AUTOSTART_DIR"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileMakePath",
          "args": [
            "BHYVE_AUTOSTART_DIR"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3076-3080",
          "snippet": "int\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainConfigFile",
          "args": [
            "BHYVE_AUTOSTART_DIR",
            "vm->def->name"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainConfigFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29755-29763",
          "snippet": "char\n*virDomainConfigFile(const char *dir,\n                     const char *name)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nchar\n*virDomainConfigFile(const char *dir,\n                     const char *name)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"cannot set autostart for transient domain\")"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainSetAutostartEnsureACL",
          "args": [
            "domain->conn",
            "vm->def"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "163-180",
          "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainSetAutostart(virDomainPtr domain, int autostart)\n{\n    virDomainObjPtr vm;\n    char *configFile = NULL;\n    char *autostartLink = NULL;\n    int ret = -1;\n\n    if (!(vm = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainSetAutostartEnsureACL(domain->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (!vm->persistent) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"cannot set autostart for transient domain\"));\n        goto cleanup;\n    }\n\n    autostart = (autostart != 0);\n\n    if (vm->autostart != autostart) {\n        if ((configFile = virDomainConfigFile(BHYVE_CONFIG_DIR, vm->def->name)) == NULL)\n            goto cleanup;\n        if ((autostartLink = virDomainConfigFile(BHYVE_AUTOSTART_DIR, vm->def->name)) == NULL)\n            goto cleanup;\n\n        if (autostart) {\n            if (virFileMakePath(BHYVE_AUTOSTART_DIR) < 0) {\n                virReportSystemError(errno,\n                                     _(\"cannot create autostart directory %s\"),\n                                     BHYVE_AUTOSTART_DIR);\n                goto cleanup;\n            }\n\n            if (symlink(configFile, autostartLink) < 0) {\n                virReportSystemError(errno,\n                                     _(\"Failed to create symlink '%s' to '%s'\"),\n                                     autostartLink, configFile);\n                goto cleanup;\n            }\n        } else {\n            if (unlink(autostartLink) < 0 && errno != ENOENT && errno != ENOTDIR) {\n                virReportSystemError(errno,\n                                     _(\"Failed to delete symlink '%s'\"),\n                                     autostartLink);\n                goto cleanup;\n            }\n        }\n\n        vm->autostart = autostart;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(configFile);\n    VIR_FREE(autostartLink);\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveDomainGetAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "339-357",
    "snippet": "static int\nbhyveDomainGetAutostart(virDomainPtr domain, int *autostart)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    if (!(vm = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainGetAutostartEnsureACL(domain->conn, vm->def) < 0)\n        goto cleanup;\n\n    *autostart = vm->autostart;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetAutostartEnsureACL",
          "args": [
            "domain->conn",
            "vm->def"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "163-180",
          "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainGetAutostart(virDomainPtr domain, int *autostart)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    if (!(vm = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainGetAutostartEnsureACL(domain->conn, vm->def) < 0)\n        goto cleanup;\n\n    *autostart = vm->autostart;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveDomainGetState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "314-337",
    "snippet": "static int\nbhyveDomainGetState(virDomainPtr domain,\n                    int *state,\n                    int *reason,\n                    unsigned int flags)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainGetStateEnsureACL(domain->conn, vm->def) < 0)\n       goto cleanup;\n\n    *state = virDomainObjGetState(vm, reason);\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetState",
          "args": [
            "vm",
            "reason"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30038-30045",
          "snippet": "virDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetStateEnsureACL",
          "args": [
            "domain->conn",
            "vm->def"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "163-180",
          "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainGetState(virDomainPtr domain,\n                    int *state,\n                    int *reason,\n                    unsigned int flags)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainGetStateEnsureACL(domain->conn, vm->def) < 0)\n       goto cleanup;\n\n    *state = virDomainObjGetState(vm, reason);\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveDomainGetInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "285-312",
    "snippet": "static int\nbhyveDomainGetInfo(virDomainPtr domain, virDomainInfoPtr info)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    if (!(vm = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainGetInfoEnsureACL(domain->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjIsActive(vm)) {\n        if (virBhyveGetDomainTotalCpuStats(vm, &(info->cpuTime)) < 0)\n            goto cleanup;\n    } else {\n        info->cpuTime = 0;\n    }\n\n    info->state = virDomainObjGetState(vm, NULL);\n    info->maxMem = virDomainDefGetMemoryTotal(vm->def);\n    info->nrVirtCpu = virDomainDefGetVcpus(vm->def);\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetVcpus",
          "args": [
            "vm->def"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetVcpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1912-1924",
          "snippet": "unsigned int\nvirDomainDefGetVcpus(const virDomainDef *def)\n{\n    size_t i;\n    unsigned int ret = 0;\n\n    for (i = 0; i < def->maxvcpus; i++) {\n        if (def->vcpus[i]->online)\n            ret++;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned int\nvirDomainDefGetVcpus(const virDomainDef *def)\n{\n    size_t i;\n    unsigned int ret = 0;\n\n    for (i = 0; i < def->maxvcpus; i++) {\n        if (def->vcpus[i]->online)\n            ret++;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetMemoryTotal",
          "args": [
            "vm->def"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetMemoryTotal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "10946-10950",
          "snippet": "unsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetState",
          "args": [
            "vm",
            "NULL"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30038-30045",
          "snippet": "virDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBhyveGetDomainTotalCpuStats",
          "args": [
            "vm",
            "&(info->cpuTime)"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "virBhyveGetDomainTotalCpuStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_process.c",
          "lines": "374-408",
          "snippet": "int\nvirBhyveGetDomainTotalCpuStats(virDomainObjPtr vm,\n                               unsigned long long *cpustats)\n{\n    struct kinfo_proc *kp;\n    kvm_t *kd;\n    char errbuf[_POSIX2_LINE_MAX];\n    int nprocs;\n    int ret = -1;\n\n    if ((kd = kvm_openfiles(NULL, NULL, NULL, O_RDONLY, errbuf)) == NULL) {\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Unable to get kvm descriptor: %s\"),\n                       errbuf);\n        return -1;\n\n    }\n\n    kp = kvm_getprocs(kd, KERN_PROC_PID, vm->pid, &nprocs);\n    if (kp == NULL || nprocs != 1) {\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Unable to obtain information about pid: %d\"),\n                       (int)vm->pid);\n        goto cleanup;\n    }\n\n    *cpustats = kp->ki_runtime * 1000ull;\n\n    ret = 0;\n\n cleanup:\n    kvm_close(kd);\n\n    return ret;\n}",
          "includes": [
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virhook.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_monitor.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include <net/if_tap.h>",
            "#include <net/if.h>",
            "#include <sys/user.h>",
            "#include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>",
            "#include <kvm.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virnetdevtap.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virhook.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_monitor.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include <net/if_tap.h>\n#include <net/if.h>\n#include <sys/user.h>\n#include <sys/sysctl.h>\n#include <sys/types.h>\n#include <sys/param.h>\n#include <kvm.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirBhyveGetDomainTotalCpuStats(virDomainObjPtr vm,\n                               unsigned long long *cpustats)\n{\n    struct kinfo_proc *kp;\n    kvm_t *kd;\n    char errbuf[_POSIX2_LINE_MAX];\n    int nprocs;\n    int ret = -1;\n\n    if ((kd = kvm_openfiles(NULL, NULL, NULL, O_RDONLY, errbuf)) == NULL) {\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Unable to get kvm descriptor: %s\"),\n                       errbuf);\n        return -1;\n\n    }\n\n    kp = kvm_getprocs(kd, KERN_PROC_PID, vm->pid, &nprocs);\n    if (kp == NULL || nprocs != 1) {\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Unable to obtain information about pid: %d\"),\n                       (int)vm->pid);\n        goto cleanup;\n    }\n\n    *cpustats = kp->ki_runtime * 1000ull;\n\n    ret = 0;\n\n cleanup:\n    kvm_close(kd);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "vm"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetInfoEnsureACL",
          "args": [
            "domain->conn",
            "vm->def"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bhyveDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "163-180",
          "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveDomainGetInfo(virDomainPtr domain, virDomainInfoPtr info)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    if (!(vm = bhyveDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainGetInfoEnsureACL(domain->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjIsActive(vm)) {\n        if (virBhyveGetDomainTotalCpuStats(vm, &(info->cpuTime)) < 0)\n            goto cleanup;\n    } else {\n        info->cpuTime = 0;\n    }\n\n    info->state = virDomainObjGetState(vm, NULL);\n    info->maxMem = virDomainDefGetMemoryTotal(vm->def);\n    info->nrVirtCpu = virDomainDefGetVcpus(vm->def);\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveConnectGetVersion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "266-283",
    "snippet": "static int\nbhyveConnectGetVersion(virConnectPtr conn, unsigned long *version)\n{\n    struct utsname ver;\n\n    if (virConnectGetVersionEnsureACL(conn) < 0)\n        return -1;\n\n    uname(&ver);\n\n    if (virParseVersionString(ver.release, version, true) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unknown release: %s\"), ver.release);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unknown release: %s\")",
            "ver.release"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unknown release: %s\""
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virParseVersionString",
          "args": [
            "ver.release",
            "version",
            "true"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "virParseVersionString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "254-282",
          "snippet": "int\nvirParseVersionString(const char *str, unsigned long *version,\n                      bool allowMissing)\n{\n    unsigned int major, minor = 0, micro = 0;\n    char *tmp;\n\n    if (virStrToLong_ui(str, &tmp, 10, &major) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &minor) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &micro) < 0)\n        return -1;\n\n    if (major > UINT_MAX / 1000000 || minor > 999 || micro > 999)\n        return -1;\n\n    *version = 1000000 * major + 1000 * minor + micro;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirParseVersionString(const char *str, unsigned long *version,\n                      bool allowMissing)\n{\n    unsigned int major, minor = 0, micro = 0;\n    char *tmp;\n\n    if (virStrToLong_ui(str, &tmp, 10, &major) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &minor) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &micro) < 0)\n        return -1;\n\n    if (major > UINT_MAX / 1000000 || minor > 999 || micro > 999)\n        return -1;\n\n    *version = 1000000 * major + 1000 * minor + micro;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "uname",
          "args": [
            "&ver"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConnectGetVersionEnsureACL",
          "args": [
            "conn"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveConnectGetVersion(virConnectPtr conn, unsigned long *version)\n{\n    struct utsname ver;\n\n    if (virConnectGetVersionEnsureACL(conn) < 0)\n        return -1;\n\n    uname(&ver);\n\n    if (virParseVersionString(ver.release, version, true) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unknown release: %s\"), ver.release);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "bhyveConnectGetSysinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "243-264",
    "snippet": "static char *\nbhyveConnectGetSysinfo(virConnectPtr conn, unsigned int flags)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(0, NULL);\n\n    if (virConnectGetSysinfoEnsureACL(conn) < 0)\n        return NULL;\n\n    if (!privconn->hostsysinfo) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Host SMBIOS information is not available\"));\n        return NULL;\n    }\n\n    if (virSysinfoFormat(&buf, privconn->hostsysinfo) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoFormat",
          "args": [
            "&buf",
            "privconn->hostsysinfo"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1446-1474",
          "snippet": "int\nvirSysinfoFormat(virBufferPtr buf, virSysinfoDefPtr def)\n{\n    virBuffer attrBuf = VIR_BUFFER_INITIALIZER;\n    virBuffer childrenBuf = VIR_BUFFER_INIT_CHILD(buf);\n    const char *type = virSysinfoTypeToString(def->type);\n\n    if (!type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected sysinfo type model %d\"),\n                       def->type);\n        virBufferFreeAndReset(buf);\n        return -1;\n    }\n\n    virSysinfoBIOSFormat(&childrenBuf, def->bios);\n    virSysinfoSystemFormat(&childrenBuf, def->system);\n    virSysinfoBaseBoardFormat(&childrenBuf, def->baseBoard, def->nbaseBoard);\n    virSysinfoChassisFormat(&childrenBuf, def->chassis);\n    virSysinfoProcessorFormat(&childrenBuf, def);\n    virSysinfoMemoryFormat(&childrenBuf, def);\n    virSysinfoOEMStringsFormat(&childrenBuf, def->oemStrings);\n\n    virBufferAsprintf(&attrBuf, \" type='%s'\", type);\n\n    virXMLFormatElement(buf, \"sysinfo\", &attrBuf, &childrenBuf);\n\n    return 0;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSysinfoFormat(virBufferPtr buf, virSysinfoDefPtr def)\n{\n    virBuffer attrBuf = VIR_BUFFER_INITIALIZER;\n    virBuffer childrenBuf = VIR_BUFFER_INIT_CHILD(buf);\n    const char *type = virSysinfoTypeToString(def->type);\n\n    if (!type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected sysinfo type model %d\"),\n                       def->type);\n        virBufferFreeAndReset(buf);\n        return -1;\n    }\n\n    virSysinfoBIOSFormat(&childrenBuf, def->bios);\n    virSysinfoSystemFormat(&childrenBuf, def->system);\n    virSysinfoBaseBoardFormat(&childrenBuf, def->baseBoard, def->nbaseBoard);\n    virSysinfoChassisFormat(&childrenBuf, def->chassis);\n    virSysinfoProcessorFormat(&childrenBuf, def);\n    virSysinfoMemoryFormat(&childrenBuf, def);\n    virSysinfoOEMStringsFormat(&childrenBuf, def->oemStrings);\n\n    virBufferAsprintf(&attrBuf, \" type='%s'\", type);\n\n    virXMLFormatElement(buf, \"sysinfo\", &attrBuf, &childrenBuf);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Host SMBIOS information is not available\")"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Host SMBIOS information is not available\""
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectGetSysinfoEnsureACL",
          "args": [
            "conn"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "NULL"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *\nbhyveConnectGetSysinfo(virConnectPtr conn, unsigned int flags)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(0, NULL);\n\n    if (virConnectGetSysinfoEnsureACL(conn) < 0)\n        return NULL;\n\n    if (!privconn->hostsysinfo) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Host SMBIOS information is not available\"));\n        return NULL;\n    }\n\n    if (virSysinfoFormat(&buf, privconn->hostsysinfo) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}"
  },
  {
    "function_name": "bhyveConnectGetHostname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "234-241",
    "snippet": "static char *\nbhyveConnectGetHostname(virConnectPtr conn)\n{\n    if (virConnectGetHostnameEnsureACL(conn) < 0)\n        return NULL;\n\n    return virGetHostname();\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetHostname",
          "args": [],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "virGetHostnameQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "560-564",
          "snippet": "char *\nvirGetHostnameQuiet(void)\n{\n    return virGetHostnameImpl(true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetHostnameQuiet(void)\n{\n    return virGetHostnameImpl(true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectGetHostnameEnsureACL",
          "args": [
            "conn"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *\nbhyveConnectGetHostname(virConnectPtr conn)\n{\n    if (virConnectGetHostnameEnsureACL(conn) < 0)\n        return NULL;\n\n    return virGetHostname();\n}"
  },
  {
    "function_name": "bhyveConnectClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "223-232",
    "snippet": "static int\nbhyveConnectClose(virConnectPtr conn)\n{\n    bhyveConnPtr privconn = conn->privateData;\n\n    virCloseCallbacksRun(privconn->closeCallbacks, conn, privconn->domains, privconn);\n    conn->privateData = NULL;\n\n    return 0;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCloseCallbacksRun",
          "args": [
            "privconn->closeCallbacks",
            "conn",
            "privconn->domains",
            "privconn"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "virCloseCallbacksRun",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/virclosecallbacks.c",
          "lines": "307-360",
          "snippet": "void\nvirCloseCallbacksRun(virCloseCallbacksPtr closeCallbacks,\n                     virConnectPtr conn,\n                     virDomainObjListPtr domains,\n                     void *opaque)\n{\n    virCloseCallbacksListPtr list;\n    size_t i;\n\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    /* We must not hold the lock while running the callbacks,\n     * so first we obtain the list of callbacks, then remove\n     * them all from the hash. At that point we can release\n     * the lock and run the callbacks safely. */\n\n    virObjectLock(closeCallbacks);\n    list = virCloseCallbacksGetForConn(closeCallbacks, conn);\n    if (!list) {\n        virObjectUnlock(closeCallbacks);\n        return;\n    }\n\n    for (i = 0; i < list->nentries; i++) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(list->entries[i].uuid, uuidstr);\n        virHashRemoveEntry(closeCallbacks->list, uuidstr);\n    }\n    virObjectUnlock(closeCallbacks);\n\n    for (i = 0; i < list->nentries; i++) {\n        virDomainObjPtr vm;\n\n        /* Grab a ref and lock to the vm */\n        if (!(vm = virDomainObjListFindByUUID(domains,\n                                              list->entries[i].uuid))) {\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n            virUUIDFormat(list->entries[i].uuid, uuidstr);\n            VIR_DEBUG(\"No domain object with UUID %s\", uuidstr);\n            continue;\n        }\n\n        /* Remove the ref taken out during virCloseCallbacksSet since\n         * we're about to call the callback function and we have another\n         * ref anyway (so it cannot be deleted).\n         *\n         * Call the callback function and end the API usage. */\n        virObjectUnref(vm);\n        list->entries[i].callback(vm, conn, opaque);\n        virDomainObjEndAPI(&vm);\n    }\n    VIR_FREE(list->entries);\n    VIR_FREE(list);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"virclosecallbacks.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virclosecallbacks.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirCloseCallbacksRun(virCloseCallbacksPtr closeCallbacks,\n                     virConnectPtr conn,\n                     virDomainObjListPtr domains,\n                     void *opaque)\n{\n    virCloseCallbacksListPtr list;\n    size_t i;\n\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    /* We must not hold the lock while running the callbacks,\n     * so first we obtain the list of callbacks, then remove\n     * them all from the hash. At that point we can release\n     * the lock and run the callbacks safely. */\n\n    virObjectLock(closeCallbacks);\n    list = virCloseCallbacksGetForConn(closeCallbacks, conn);\n    if (!list) {\n        virObjectUnlock(closeCallbacks);\n        return;\n    }\n\n    for (i = 0; i < list->nentries; i++) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(list->entries[i].uuid, uuidstr);\n        virHashRemoveEntry(closeCallbacks->list, uuidstr);\n    }\n    virObjectUnlock(closeCallbacks);\n\n    for (i = 0; i < list->nentries; i++) {\n        virDomainObjPtr vm;\n\n        /* Grab a ref and lock to the vm */\n        if (!(vm = virDomainObjListFindByUUID(domains,\n                                              list->entries[i].uuid))) {\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n            virUUIDFormat(list->entries[i].uuid, uuidstr);\n            VIR_DEBUG(\"No domain object with UUID %s\", uuidstr);\n            continue;\n        }\n\n        /* Remove the ref taken out during virCloseCallbacksSet since\n         * we're about to call the callback function and we have another\n         * ref anyway (so it cannot be deleted).\n         *\n         * Call the callback function and end the API usage. */\n        virObjectUnref(vm);\n        list->entries[i].callback(vm, conn, opaque);\n        virDomainObjEndAPI(&vm);\n    }\n    VIR_FREE(list->entries);\n    VIR_FREE(list);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveConnectClose(virConnectPtr conn)\n{\n    bhyveConnPtr privconn = conn->privateData;\n\n    virCloseCallbacksRun(privconn->closeCallbacks, conn, privconn->domains, privconn);\n    conn->privateData = NULL;\n\n    return 0;\n}"
  },
  {
    "function_name": "bhyveConnectOpen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "194-221",
    "snippet": "static virDrvOpenStatus\nbhyveConnectOpen(virConnectPtr conn,\n                 virConnectAuthPtr auth G_GNUC_UNUSED,\n                 virConfPtr conf G_GNUC_UNUSED,\n                 unsigned int flags)\n{\n    virCheckFlags(VIR_CONNECT_RO, VIR_DRV_OPEN_ERROR);\n\n    if (STRNEQ(conn->uri->path, \"/system\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unexpected bhyve URI path '%s', try bhyve:///system\"),\n                       conn->uri->path);\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (bhyve_driver == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"bhyve state driver is not active\"));\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (virConnectOpenEnsureACL(conn) < 0)\n        return VIR_DRV_OPEN_ERROR;\n\n    conn->privateData = bhyve_driver;\n\n    return VIR_DRV_OPEN_SUCCESS;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bhyveConnPtr bhyve_driver = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConnectOpenEnsureACL",
          "args": [
            "conn"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"bhyve state driver is not active\")"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"bhyve state driver is not active\""
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unexpected bhyve URI path '%s', try bhyve:///system\")",
            "conn->uri->path"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "conn->uri->path",
            "\"/system\""
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_CONNECT_RO",
            "VIR_DRV_OPEN_ERROR"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nbhyveConnPtr bhyve_driver = NULL;\n\nstatic virDrvOpenStatus\nbhyveConnectOpen(virConnectPtr conn,\n                 virConnectAuthPtr auth G_GNUC_UNUSED,\n                 virConfPtr conf G_GNUC_UNUSED,\n                 unsigned int flags)\n{\n    virCheckFlags(VIR_CONNECT_RO, VIR_DRV_OPEN_ERROR);\n\n    if (STRNEQ(conn->uri->path, \"/system\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unexpected bhyve URI path '%s', try bhyve:///system\"),\n                       conn->uri->path);\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (bhyve_driver == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"bhyve state driver is not active\"));\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (virConnectOpenEnsureACL(conn) < 0)\n        return VIR_DRV_OPEN_ERROR;\n\n    conn->privateData = bhyve_driver;\n\n    return VIR_DRV_OPEN_SUCCESS;\n}"
  },
  {
    "function_name": "bhyveConnectURIProbe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "183-191",
    "snippet": "static int\nbhyveConnectURIProbe(char **uri)\n{\n    if (bhyve_driver == NULL)\n        return 0;\n\n    *uri = g_strdup(\"bhyve:///system\");\n    return 1;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bhyveConnPtr bhyve_driver = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"bhyve:///system\""
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nbhyveConnPtr bhyve_driver = NULL;\n\nstatic int\nbhyveConnectURIProbe(char **uri)\n{\n    if (bhyve_driver == NULL)\n        return 0;\n\n    *uri = g_strdup(\"bhyve:///system\");\n    return 1;\n}"
  },
  {
    "function_name": "bhyveDomObjFromDomain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "163-180",
    "snippet": "static virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN",
            "_(\"no domain with matching uuid '%s' (%s)\")",
            "uuidstr",
            "domain->name"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no domain with matching uuid '%s' (%s)\""
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "domain->uuid",
            "uuidstr"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByUUID",
          "args": [
            "privconn->domains",
            "domain->uuid"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "162-179",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByUUID(virDomainObjListPtr doms,\n                           const unsigned char *uuid)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByUUIDLocked(doms, uuid);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByUUID(virDomainObjListPtr doms,\n                           const unsigned char *uuid)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByUUIDLocked(doms, uuid);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nbhyveDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    bhyveConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(privconn->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
  },
  {
    "function_name": "bhyveConnectGetCapabilities",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "139-161",
    "snippet": "static char *\nbhyveConnectGetCapabilities(virConnectPtr conn)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    virCapsPtr caps;\n    char *xml = NULL;\n\n    if (virConnectGetCapabilitiesEnsureACL(conn) < 0)\n        return NULL;\n\n    if (!(caps = bhyveDriverGetCapabilities(privconn))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to get Capabilities\"));\n        goto cleanup;\n    }\n\n    if (!(xml = virCapabilitiesFormatXML(caps)))\n        goto cleanup;\n\n cleanup:\n    virObjectUnref(caps);\n    return xml;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "caps"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCapabilitiesFormatXML",
          "args": [
            "caps"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesFormatXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "1335-1358",
          "snippet": "char *\nvirCapabilitiesFormatXML(virCapsPtr caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"<capabilities>\\n\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virCapabilitiesFormatHostXML(&caps->host, &buf) < 0)\n        goto error;\n\n    virCapabilitiesFormatGuestXML(caps->guests, caps->nguests, &buf);\n\n    virCapabilitiesFormatStoragePoolXML(caps->pools, caps->npools, &buf);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</capabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirCapabilitiesFormatXML(virCapsPtr caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"<capabilities>\\n\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virCapabilitiesFormatHostXML(&caps->host, &buf) < 0)\n        goto error;\n\n    virCapabilitiesFormatGuestXML(caps->guests, caps->nguests, &buf);\n\n    virCapabilitiesFormatStoragePoolXML(caps->pools, caps->npools, &buf);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</capabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Unable to get Capabilities\")"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get Capabilities\""
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bhyveDriverGetCapabilities",
          "args": [
            "privconn"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConnectGetCapabilitiesEnsureACL",
          "args": [
            "conn"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *\nbhyveConnectGetCapabilities(virConnectPtr conn)\n{\n    bhyveConnPtr privconn = conn->privateData;\n    virCapsPtr caps;\n    char *xml = NULL;\n\n    if (virConnectGetCapabilitiesEnsureACL(conn) < 0)\n        return NULL;\n\n    if (!(caps = bhyveDriverGetCapabilities(privconn))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to get Capabilities\"));\n        goto cleanup;\n    }\n\n    if (!(xml = virCapabilitiesFormatXML(caps)))\n        goto cleanup;\n\n cleanup:\n    virObjectUnref(caps);\n    return xml;\n}"
  },
  {
    "function_name": "bhyveAutostartDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "105-121",
    "snippet": "static void\nbhyveAutostartDomains(bhyveConnPtr driver)\n{\n    /* XXX: Figure out a better way todo this. The domain\n     * startup code needs a connection handle in order\n     * to lookup the bridge associated with a virtual\n     * network\n     */\n    virConnectPtr conn = virConnectOpen(\"bhyve:///system\");\n    /* Ignoring NULL conn which is mostly harmless here */\n\n    struct bhyveAutostartData data = { driver, conn };\n\n    virDomainObjListForEach(driver->domains, false, bhyveAutostartDomain, &data);\n\n    virObjectUnref(conn);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "conn"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListForEach",
          "args": [
            "driver->domains",
            "false",
            "bhyveAutostartDomain",
            "&data"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "827-844",
          "snippet": "int\nvirDomainObjListForEach(virDomainObjListPtr doms,\n                        bool modify,\n                        virDomainObjListIterator callback,\n                        void *opaque)\n{\n    struct virDomainListIterData data = {\n        callback, opaque, 0,\n    };\n\n    if (modify)\n        virObjectRWLockWrite(doms);\n    else\n        virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListHelper, &data);\n    virObjectRWUnlock(doms);\n    return data.ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListForEach(virDomainObjListPtr doms,\n                        bool modify,\n                        virDomainObjListIterator callback,\n                        void *opaque)\n{\n    struct virDomainListIterData data = {\n        callback, opaque, 0,\n    };\n\n    if (modify)\n        virObjectRWLockWrite(doms);\n    else\n        virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListHelper, &data);\n    virObjectRWUnlock(doms);\n    return data.ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectOpen",
          "args": [
            "\"bhyve:///system\""
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "virConnectOpenReadOnly",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "1181-1199",
          "snippet": "virConnectPtr\nvirConnectOpenReadOnly(const char *name)\n{\n    virConnectPtr ret = NULL;\n\n    if (virInitialize() < 0)\n        goto error;\n\n    VIR_DEBUG(\"name=%s\", NULLSTR(name));\n    virResetLastError();\n    ret = virConnectOpenInternal(name, NULL, VIR_CONNECT_RO);\n    if (!ret)\n        goto error;\n    return ret;\n\n error:\n    virDispatchError(NULL);\n    return NULL;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirConnectPtr\nvirConnectOpenReadOnly(const char *name)\n{\n    virConnectPtr ret = NULL;\n\n    if (virInitialize() < 0)\n        goto error;\n\n    VIR_DEBUG(\"name=%s\", NULLSTR(name));\n    virResetLastError();\n    ret = virConnectOpenInternal(name, NULL, VIR_CONNECT_RO);\n    if (!ret)\n        goto error;\n    return ret;\n\n error:\n    virDispatchError(NULL);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void\nbhyveAutostartDomains(bhyveConnPtr driver)\n{\n    /* XXX: Figure out a better way todo this. The domain\n     * startup code needs a connection handle in order\n     * to lookup the bridge associated with a virtual\n     * network\n     */\n    virConnectPtr conn = virConnectOpen(\"bhyve:///system\");\n    /* Ignoring NULL conn which is mostly harmless here */\n\n    struct bhyveAutostartData data = { driver, conn };\n\n    virDomainObjListForEach(driver->domains, false, bhyveAutostartDomain, &data);\n\n    virObjectUnref(conn);\n}"
  },
  {
    "function_name": "bhyveAutostartDomain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "85-103",
    "snippet": "static int\nbhyveAutostartDomain(virDomainObjPtr vm, void *opaque)\n{\n    const struct bhyveAutostartData *data = opaque;\n    int ret = 0;\n    virObjectLock(vm);\n    if (vm->autostart && !virDomainObjIsActive(vm)) {\n        virResetLastError();\n        ret = virBhyveProcessStart(data->conn, vm,\n                                   VIR_DOMAIN_RUNNING_BOOTED, 0);\n        if (ret < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Failed to autostart VM '%s': %s\"),\n                           vm->def->name, virGetLastErrorMessage());\n        }\n    }\n    virObjectUnlock(vm);\n    return ret;\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "vm"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to autostart VM '%s': %s\")",
            "vm->def->name",
            "virGetLastErrorMessage()"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetLastErrorMessage",
          "args": [],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to autostart VM '%s': %s\""
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBhyveProcessStart",
          "args": [
            "data->conn",
            "vm",
            "VIR_DOMAIN_RUNNING_BOOTED",
            "0"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "virBhyveProcessStart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_process.c",
          "lines": "254-272",
          "snippet": "int\nvirBhyveProcessStart(virConnectPtr conn,\n                     virDomainObjPtr vm,\n                     virDomainRunningReason reason,\n                     unsigned int flags)\n{\n    bhyveConnPtr driver = conn->privateData;\n\n    /* Run an early hook to setup missing devices. */\n    if (bhyveProcessStartHook(vm, VIR_HOOK_BHYVE_OP_PREPARE) < 0)\n        return -1;\n\n    if (flags & VIR_BHYVE_PROCESS_START_AUTODESTROY &&\n        virCloseCallbacksSet(driver->closeCallbacks, vm,\n                             conn, bhyveProcessAutoDestroy) < 0)\n        return -1;\n\n    return virBhyveProcessStartImpl(driver, vm, reason);\n}",
          "includes": [
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virhook.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_monitor.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include <net/if_tap.h>",
            "#include <net/if.h>",
            "#include <sys/user.h>",
            "#include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "#include <sys/param.h>",
            "#include <kvm.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virnetdevtap.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virhook.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_monitor.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include <net/if_tap.h>\n#include <net/if.h>\n#include <sys/user.h>\n#include <sys/sysctl.h>\n#include <sys/types.h>\n#include <sys/param.h>\n#include <kvm.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirBhyveProcessStart(virConnectPtr conn,\n                     virDomainObjPtr vm,\n                     virDomainRunningReason reason,\n                     unsigned int flags)\n{\n    bhyveConnPtr driver = conn->privateData;\n\n    /* Run an early hook to setup missing devices. */\n    if (bhyveProcessStartHook(vm, VIR_HOOK_BHYVE_OP_PREPARE) < 0)\n        return -1;\n\n    if (flags & VIR_BHYVE_PROCESS_START_AUTODESTROY &&\n        virCloseCallbacksSet(driver->closeCallbacks, vm,\n                             conn, bhyveProcessAutoDestroy) < 0)\n        return -1;\n\n    return virBhyveProcessStartImpl(driver, vm, reason);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "vm"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "vm"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nbhyveAutostartDomain(virDomainObjPtr vm, void *opaque)\n{\n    const struct bhyveAutostartData *data = opaque;\n    int ret = 0;\n    virObjectLock(vm);\n    if (vm->autostart && !virDomainObjIsActive(vm)) {\n        virResetLastError();\n        ret = virBhyveProcessStart(data->conn, vm,\n                                   VIR_DOMAIN_RUNNING_BOOTED, 0);\n        if (ret < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Failed to autostart VM '%s': %s\"),\n                           vm->def->name, virGetLastErrorMessage());\n        }\n    }\n    virObjectUnlock(vm);\n    return ret;\n}"
  },
  {
    "function_name": "bhyveDriverUnlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "79-83",
    "snippet": "void\nbhyveDriverUnlock(bhyveConnPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexUnlock",
          "args": [
            "&driver->lock"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "86-89",
          "snippet": "void virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nbhyveDriverUnlock(bhyveConnPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
  },
  {
    "function_name": "bhyveDriverLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
    "lines": "73-77",
    "snippet": "void\nbhyveDriverLock(bhyveConnPtr driver)\n{\n    virMutexLock(&driver->lock);\n}",
    "includes": [
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_process.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_parse_command.h\"",
      "#include \"bhyve_command.h\"",
      "#include \"bhyve_driver.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virutil.h\"",
      "#include \"conf/domain_capabilities.h\"",
      "#include \"virportallocator.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virrandom.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virxml.h\"",
      "#include \"virdomainobjlist.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virfdstream.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"domain_event.h\"",
      "#include \"domain_audit.h\"",
      "#include \"interface_conf.h\"",
      "#include \"network_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "#include \"viruuid.h\"",
      "#include \"virbuffer.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <sys/utsname.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexLock",
          "args": [
            "&driver->lock"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "81-84",
          "snippet": "void virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nbhyveDriverLock(bhyveConnPtr driver)\n{\n    virMutexLock(&driver->lock);\n}"
  }
]