[
  {
    "function_name": "virThreadJobClear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthreadjob.c",
    "lines": "102-124",
    "snippet": "void\nvirThreadJobClear(int rv)\n{\n    const char *old;\n    const char *worker;\n\n    if (virThreadJobInitialize() < 0)\n        return;\n\n    if (!(old = virThreadLocalGet(&virThreadJobName)))\n        return;\n\n    if (virThreadLocalSet(&virThreadJobName, NULL) < 0)\n        virReportSystemError(errno, \"%s\", _(\"cannot reset current job\"));\n\n    if ((worker = virThreadLocalGet(&virThreadJobWorker))) {\n        VIR_DEBUG(\"Thread %llu (%s) finished job %s with ret=%d\",\n                  virThreadSelfID(), worker, old, rv);\n    } else {\n        VIR_DEBUG(\"Thread %llu finished job %s with ret=%d\",\n                  virThreadSelfID(), old, rv);\n    }\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virThreadLocal virThreadJobWorker;",
      "virThreadLocal virThreadJobName;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Thread %llu finished job %s with ret=%d\"",
            "virThreadSelfID()",
            "old",
            "rv"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virThreadSelfID",
          "args": [],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadSelfID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "298-311",
          "snippet": "unsigned long long virThreadSelfID(void)\n{\n#if defined(HAVE_SYS_SYSCALL_H) && defined(SYS_gettid) && defined(__linux__)\n    pid_t tid = syscall(SYS_gettid);\n    return tid;\n#else\n    union {\n        unsigned long long l;\n        pthread_t t;\n    } u;\n    u.t = pthread_self();\n    return u.l;\n#endif\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nunsigned long long virThreadSelfID(void)\n{\n#if defined(HAVE_SYS_SYSCALL_H) && defined(SYS_gettid) && defined(__linux__)\n    pid_t tid = syscall(SYS_gettid);\n    return tid;\n#else\n    union {\n        unsigned long long l;\n        pthread_t t;\n    } u;\n    u.t = pthread_self();\n    return u.l;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Thread %llu (%s) finished job %s with ret=%d\"",
            "virThreadSelfID()",
            "worker",
            "old",
            "rv"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virThreadLocalGet",
          "args": [
            "&virThreadJobWorker"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadLocalGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "347-350",
          "snippet": "void *virThreadLocalGet(virThreadLocalPtr l)\n{\n    return pthread_getspecific(l->key);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid *virThreadLocalGet(virThreadLocalPtr l)\n{\n    return pthread_getspecific(l->key);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"cannot reset current job\")"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot reset current job\""
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virThreadLocalSet",
          "args": [
            "&virThreadJobName",
            "NULL"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadLocalSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "352-360",
          "snippet": "int virThreadLocalSet(virThreadLocalPtr l, void *val)\n{\n    int err = pthread_setspecific(l->key, val);\n    if (err) {\n        errno = err;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virThreadLocalSet(virThreadLocalPtr l, void *val)\n{\n    int err = pthread_setspecific(l->key, val);\n    if (err) {\n        errno = err;\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virThreadJobInitialize",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirThreadLocal virThreadJobWorker;\nvirThreadLocal virThreadJobName;\n\nvoid\nvirThreadJobClear(int rv)\n{\n    const char *old;\n    const char *worker;\n\n    if (virThreadJobInitialize() < 0)\n        return;\n\n    if (!(old = virThreadLocalGet(&virThreadJobName)))\n        return;\n\n    if (virThreadLocalSet(&virThreadJobName, NULL) < 0)\n        virReportSystemError(errno, \"%s\", _(\"cannot reset current job\"));\n\n    if ((worker = virThreadLocalGet(&virThreadJobWorker))) {\n        VIR_DEBUG(\"Thread %llu (%s) finished job %s with ret=%d\",\n                  virThreadSelfID(), worker, old, rv);\n    } else {\n        VIR_DEBUG(\"Thread %llu finished job %s with ret=%d\",\n                  virThreadSelfID(), old, rv);\n    }\n}"
  },
  {
    "function_name": "virThreadJobSet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthreadjob.c",
    "lines": "79-99",
    "snippet": "void\nvirThreadJobSet(const char *caller)\n{\n    const char *worker;\n\n    if (!caller || virThreadJobInitialize() < 0)\n        return;\n\n    if (virThreadLocalSet(&virThreadJobName, (void *) caller) < 0)\n        virReportSystemError(errno,\n                             _(\"cannot set current job to %s\"),\n                             caller);\n\n    if ((worker = virThreadLocalGet(&virThreadJobWorker))) {\n        VIR_DEBUG(\"Thread %llu (%s) is now running job %s\",\n                  virThreadSelfID(), worker, caller);\n    } else {\n        VIR_DEBUG(\"Thread %llu is now running job %s\",\n                  virThreadSelfID(), caller);\n    }\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virThreadLocal virThreadJobWorker;",
      "virThreadLocal virThreadJobName;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Thread %llu is now running job %s\"",
            "virThreadSelfID()",
            "caller"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virThreadSelfID",
          "args": [],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadSelfID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "298-311",
          "snippet": "unsigned long long virThreadSelfID(void)\n{\n#if defined(HAVE_SYS_SYSCALL_H) && defined(SYS_gettid) && defined(__linux__)\n    pid_t tid = syscall(SYS_gettid);\n    return tid;\n#else\n    union {\n        unsigned long long l;\n        pthread_t t;\n    } u;\n    u.t = pthread_self();\n    return u.l;\n#endif\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nunsigned long long virThreadSelfID(void)\n{\n#if defined(HAVE_SYS_SYSCALL_H) && defined(SYS_gettid) && defined(__linux__)\n    pid_t tid = syscall(SYS_gettid);\n    return tid;\n#else\n    union {\n        unsigned long long l;\n        pthread_t t;\n    } u;\n    u.t = pthread_self();\n    return u.l;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Thread %llu (%s) is now running job %s\"",
            "virThreadSelfID()",
            "worker",
            "caller"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virThreadLocalGet",
          "args": [
            "&virThreadJobWorker"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadLocalGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "347-350",
          "snippet": "void *virThreadLocalGet(virThreadLocalPtr l)\n{\n    return pthread_getspecific(l->key);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid *virThreadLocalGet(virThreadLocalPtr l)\n{\n    return pthread_getspecific(l->key);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot set current job to %s\")",
            "caller"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot set current job to %s\""
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virThreadLocalSet",
          "args": [
            "&virThreadJobName",
            "(void *) caller"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadLocalSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "352-360",
          "snippet": "int virThreadLocalSet(virThreadLocalPtr l, void *val)\n{\n    int err = pthread_setspecific(l->key, val);\n    if (err) {\n        errno = err;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virThreadLocalSet(virThreadLocalPtr l, void *val)\n{\n    int err = pthread_setspecific(l->key, val);\n    if (err) {\n        errno = err;\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virThreadJobInitialize",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirThreadLocal virThreadJobWorker;\nvirThreadLocal virThreadJobName;\n\nvoid\nvirThreadJobSet(const char *caller)\n{\n    const char *worker;\n\n    if (!caller || virThreadJobInitialize() < 0)\n        return;\n\n    if (virThreadLocalSet(&virThreadJobName, (void *) caller) < 0)\n        virReportSystemError(errno,\n                             _(\"cannot set current job to %s\"),\n                             caller);\n\n    if ((worker = virThreadLocalGet(&virThreadJobWorker))) {\n        VIR_DEBUG(\"Thread %llu (%s) is now running job %s\",\n                  virThreadSelfID(), worker, caller);\n    } else {\n        VIR_DEBUG(\"Thread %llu is now running job %s\",\n                  virThreadSelfID(), caller);\n    }\n}"
  },
  {
    "function_name": "virThreadJobSetWorker",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthreadjob.c",
    "lines": "64-76",
    "snippet": "void\nvirThreadJobSetWorker(const char *worker)\n{\n    if (!worker || virThreadJobInitialize() < 0)\n        return;\n\n    if (virThreadLocalSet(&virThreadJobWorker, (void *) worker) < 0)\n        virReportSystemError(errno,\n                             _(\"cannot set worker name to %s\"),\n                             worker);\n\n    VIR_DEBUG(\"Thread %llu is running worker %s\", virThreadSelfID(), worker);\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virThreadLocal virThreadJobWorker;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Thread %llu is running worker %s\"",
            "virThreadSelfID()",
            "worker"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virThreadSelfID",
          "args": [],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadSelfID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "298-311",
          "snippet": "unsigned long long virThreadSelfID(void)\n{\n#if defined(HAVE_SYS_SYSCALL_H) && defined(SYS_gettid) && defined(__linux__)\n    pid_t tid = syscall(SYS_gettid);\n    return tid;\n#else\n    union {\n        unsigned long long l;\n        pthread_t t;\n    } u;\n    u.t = pthread_self();\n    return u.l;\n#endif\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nunsigned long long virThreadSelfID(void)\n{\n#if defined(HAVE_SYS_SYSCALL_H) && defined(SYS_gettid) && defined(__linux__)\n    pid_t tid = syscall(SYS_gettid);\n    return tid;\n#else\n    union {\n        unsigned long long l;\n        pthread_t t;\n    } u;\n    u.t = pthread_self();\n    return u.l;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot set worker name to %s\")",
            "worker"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot set worker name to %s\""
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virThreadLocalSet",
          "args": [
            "&virThreadJobWorker",
            "(void *) worker"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadLocalSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "352-360",
          "snippet": "int virThreadLocalSet(virThreadLocalPtr l, void *val)\n{\n    int err = pthread_setspecific(l->key, val);\n    if (err) {\n        errno = err;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virThreadLocalSet(virThreadLocalPtr l, void *val)\n{\n    int err = pthread_setspecific(l->key, val);\n    if (err) {\n        errno = err;\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virThreadJobInitialize",
          "args": [],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirThreadLocal virThreadJobWorker;\n\nvoid\nvirThreadJobSetWorker(const char *worker)\n{\n    if (!worker || virThreadJobInitialize() < 0)\n        return;\n\n    if (virThreadLocalSet(&virThreadJobWorker, (void *) worker) < 0)\n        virReportSystemError(errno,\n                             _(\"cannot set worker name to %s\"),\n                             worker);\n\n    VIR_DEBUG(\"Thread %llu is running worker %s\", virThreadSelfID(), worker);\n}"
  },
  {
    "function_name": "virThreadJobGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthreadjob.c",
    "lines": "48-61",
    "snippet": "const char *\nvirThreadJobGet(void)\n{\n    const char *job;\n\n    if (virThreadJobInitialize() < 0)\n        return NULL;\n\n    job = virThreadLocalGet(&virThreadJobName);\n    if (!job)\n        job = virThreadLocalGet(&virThreadJobWorker);\n\n    return job;\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virThreadLocal virThreadJobWorker;",
      "virThreadLocal virThreadJobName;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virThreadLocalGet",
          "args": [
            "&virThreadJobWorker"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadLocalGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "347-350",
          "snippet": "void *virThreadLocalGet(virThreadLocalPtr l)\n{\n    return pthread_getspecific(l->key);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid *virThreadLocalGet(virThreadLocalPtr l)\n{\n    return pthread_getspecific(l->key);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virThreadJobInitialize",
          "args": [],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirThreadLocal virThreadJobWorker;\nvirThreadLocal virThreadJobName;\n\nconst char *\nvirThreadJobGet(void)\n{\n    const char *job;\n\n    if (virThreadJobInitialize() < 0)\n        return NULL;\n\n    job = virThreadLocalGet(&virThreadJobName);\n    if (!job)\n        job = virThreadLocalGet(&virThreadJobWorker);\n\n    return job;\n}"
  },
  {
    "function_name": "virThreadJobOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthreadjob.c",
    "lines": "36-43",
    "snippet": "static int\nvirThreadJobOnceInit(void)\n{\n    if (virThreadLocalInit(&virThreadJobWorker, NULL) < 0 ||\n        virThreadLocalInit(&virThreadJobName, NULL) < 0)\n        return -1;\n    return 0;\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virThreadLocal virThreadJobWorker;",
      "virThreadLocal virThreadJobName;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virThreadLocalInit",
          "args": [
            "&virThreadJobName",
            "NULL"
          ],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadLocalInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "336-345",
          "snippet": "int virThreadLocalInit(virThreadLocalPtr l,\n                       virThreadLocalCleanup c)\n{\n    int ret;\n    if ((ret = pthread_key_create(&l->key, c)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virThreadLocalInit(virThreadLocalPtr l,\n                       virThreadLocalCleanup c)\n{\n    int ret;\n    if ((ret = pthread_key_create(&l->key, c)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirThreadLocal virThreadJobWorker;\nvirThreadLocal virThreadJobName;\n\nstatic int\nvirThreadJobOnceInit(void)\n{\n    if (virThreadLocalInit(&virThreadJobWorker, NULL) < 0 ||\n        virThreadLocalInit(&virThreadJobName, NULL) < 0)\n        return -1;\n    return 0;\n}"
  }
]