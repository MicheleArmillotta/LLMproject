[
  {
    "function_name": "virStoragePoolObjListExport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "2067-2100",
    "snippet": "int\nvirStoragePoolObjListExport(virConnectPtr conn,\n                            virStoragePoolObjListPtr poolobjs,\n                            virStoragePoolPtr **pools,\n                            virStoragePoolObjListFilter filter,\n                            unsigned int flags)\n{\n    virStoragePoolObjListExportData data = {\n        .conn = conn, .filter = filter, .flags = flags, .error = false,\n        .nPools = 0, .pools = NULL };\n\n    virObjectRWLockRead(poolobjs);\n\n    if (pools && VIR_ALLOC_N(data.pools, virHashSize(poolobjs->objs) + 1) < 0)\n        goto error;\n\n    virHashForEach(poolobjs->objs, virStoragePoolObjListExportCallback, &data);\n    virObjectRWUnlock(poolobjs);\n\n    if (data.error)\n        goto error;\n\n    if (data.pools) {\n        /* trim the array to the final size */\n        ignore_value(VIR_REALLOC_N(data.pools, data.nPools + 1));\n        *pools = data.pools;\n    }\n\n    return data.nPools;\n\n error:\n    virObjectListFree(data.pools);\n    return -1;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectListFree",
          "args": [
            "data.pools"
          ],
          "line": 2098
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "603-615",
          "snippet": "void\nvirObjectListFree(void *list)\n{\n    void **next;\n\n    if (!list)\n        return;\n\n    for (next = (void **) list; *next; next++)\n        virObjectUnref(*next);\n\n    VIR_FREE(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid\nvirObjectListFree(void *list)\n{\n    void **next;\n\n    if (!list)\n        return;\n\n    for (next = (void **) list; *next; next++)\n        virObjectUnref(*next);\n\n    VIR_FREE(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "VIR_REALLOC_N(data.pools, data.nPools + 1)"
          ],
          "line": 2091
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "data.pools",
            "data.nPools + 1"
          ],
          "line": 2091
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "poolobjs"
          ],
          "line": 2084
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "poolobjs->objs",
            "virStoragePoolObjListExportCallback",
            "&data"
          ],
          "line": 2083
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "data.pools",
            "virHashSize(poolobjs->objs) + 1"
          ],
          "line": 2080
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashSize",
          "args": [
            "poolobjs->objs"
          ],
          "line": 2080
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "547-553",
          "snippet": "ssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "poolobjs"
          ],
          "line": 2078
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjListExport(virConnectPtr conn,\n                            virStoragePoolObjListPtr poolobjs,\n                            virStoragePoolPtr **pools,\n                            virStoragePoolObjListFilter filter,\n                            unsigned int flags)\n{\n    virStoragePoolObjListExportData data = {\n        .conn = conn, .filter = filter, .flags = flags, .error = false,\n        .nPools = 0, .pools = NULL };\n\n    virObjectRWLockRead(poolobjs);\n\n    if (pools && VIR_ALLOC_N(data.pools, virHashSize(poolobjs->objs) + 1) < 0)\n        goto error;\n\n    virHashForEach(poolobjs->objs, virStoragePoolObjListExportCallback, &data);\n    virObjectRWUnlock(poolobjs);\n\n    if (data.error)\n        goto error;\n\n    if (data.pools) {\n        /* trim the array to the final size */\n        ignore_value(VIR_REALLOC_N(data.pools, data.nPools + 1));\n        *pools = data.pools;\n    }\n\n    return data.nPools;\n\n error:\n    virObjectListFree(data.pools);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolObjListExportCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "2030-2064",
    "snippet": "static int\nvirStoragePoolObjListExportCallback(void *payload,\n                                    const void *name G_GNUC_UNUSED,\n                                    void *opaque)\n{\n    virStoragePoolObjPtr obj = payload;\n    virStoragePoolObjListExportDataPtr data = opaque;\n    virStoragePoolPtr pool = NULL;\n\n    if (data->error)\n        return 0;\n\n    virObjectLock(obj);\n\n    if (data->filter && !data->filter(data->conn, obj->def))\n        goto cleanup;\n\n    if (!virStoragePoolObjMatch(obj, data->flags))\n        goto cleanup;\n\n    if (data->pools) {\n        if (!(pool = virGetStoragePool(data->conn, obj->def->name,\n                                       obj->def->uuid, NULL, NULL))) {\n            data->error = true;\n            goto cleanup;\n        }\n        data->pools[data->nPools] = pool;\n    }\n\n    data->nPools++;\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 2062
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetStoragePool",
          "args": [
            "data->conn",
            "obj->def->name",
            "obj->def->uuid",
            "NULL",
            "NULL"
          ],
          "line": 2051
        },
        "resolved": true,
        "details": {
          "function_name": "virGetStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "525-556",
          "snippet": "virStoragePoolPtr\nvirGetStoragePool(virConnectPtr conn, const char *name,\n                  const unsigned char *uuid,\n                  void *privateData, virFreeCallback freeFunc)\n{\n    virStoragePoolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virStoragePoolClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    /* set the driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virStoragePoolClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virStoragePoolClass;\n\nvirStoragePoolPtr\nvirGetStoragePool(virConnectPtr conn, const char *name,\n                  const unsigned char *uuid,\n                  void *privateData, virFreeCallback freeFunc)\n{\n    virStoragePoolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virStoragePoolClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    /* set the driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjMatch",
          "args": [
            "obj",
            "data->flags"
          ],
          "line": 2047
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjMatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1949-2011",
          "snippet": "static bool\nvirStoragePoolObjMatch(virStoragePoolObjPtr obj,\n                       unsigned int flags)\n{\n    /* filter by active state */\n    if (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_ACTIVE) &&\n        !((MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_ACTIVE) &&\n           virStoragePoolObjIsActive(obj)) ||\n          (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_INACTIVE) &&\n           !virStoragePoolObjIsActive(obj))))\n        return false;\n\n    /* filter by persistence */\n    if (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_PERSISTENT) &&\n        !((MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_PERSISTENT) &&\n           obj->configFile) ||\n          (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_TRANSIENT) &&\n           !obj->configFile)))\n        return false;\n\n    /* filter by autostart option */\n    if (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_AUTOSTART) &&\n        !((MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_AUTOSTART) &&\n           obj->autostart) ||\n          (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_NO_AUTOSTART) &&\n           !obj->autostart)))\n        return false;\n\n    /* filter by pool type */\n    if (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_POOL_TYPE)) {\n        if (!((MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_DIR) &&\n               (obj->def->type == VIR_STORAGE_POOL_DIR))     ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FS) &&\n               (obj->def->type == VIR_STORAGE_POOL_FS))      ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_NETFS) &&\n               (obj->def->type == VIR_STORAGE_POOL_NETFS))   ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_LOGICAL) &&\n               (obj->def->type == VIR_STORAGE_POOL_LOGICAL)) ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_DISK) &&\n               (obj->def->type == VIR_STORAGE_POOL_DISK))    ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_ISCSI) &&\n               (obj->def->type == VIR_STORAGE_POOL_ISCSI))   ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_SCSI) &&\n               (obj->def->type == VIR_STORAGE_POOL_SCSI))    ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_MPATH) &&\n               (obj->def->type == VIR_STORAGE_POOL_MPATH))   ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_RBD) &&\n               (obj->def->type == VIR_STORAGE_POOL_RBD))     ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_SHEEPDOG) &&\n               (obj->def->type == VIR_STORAGE_POOL_SHEEPDOG)) ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_GLUSTER) &&\n               (obj->def->type == VIR_STORAGE_POOL_GLUSTER)) ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_ZFS) &&\n               (obj->def->type == VIR_STORAGE_POOL_ZFS))     ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_VSTORAGE) &&\n               (obj->def->type == VIR_STORAGE_POOL_VSTORAGE)) ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_ISCSI_DIRECT) &&\n               (obj->def->type == VIR_STORAGE_POOL_ISCSI_DIRECT))))\n            return false;\n    }\n\n    return true;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic bool\nvirStoragePoolObjMatch(virStoragePoolObjPtr obj,\n                       unsigned int flags)\n{\n    /* filter by active state */\n    if (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_ACTIVE) &&\n        !((MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_ACTIVE) &&\n           virStoragePoolObjIsActive(obj)) ||\n          (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_INACTIVE) &&\n           !virStoragePoolObjIsActive(obj))))\n        return false;\n\n    /* filter by persistence */\n    if (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_PERSISTENT) &&\n        !((MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_PERSISTENT) &&\n           obj->configFile) ||\n          (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_TRANSIENT) &&\n           !obj->configFile)))\n        return false;\n\n    /* filter by autostart option */\n    if (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_AUTOSTART) &&\n        !((MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_AUTOSTART) &&\n           obj->autostart) ||\n          (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_NO_AUTOSTART) &&\n           !obj->autostart)))\n        return false;\n\n    /* filter by pool type */\n    if (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_POOL_TYPE)) {\n        if (!((MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_DIR) &&\n               (obj->def->type == VIR_STORAGE_POOL_DIR))     ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FS) &&\n               (obj->def->type == VIR_STORAGE_POOL_FS))      ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_NETFS) &&\n               (obj->def->type == VIR_STORAGE_POOL_NETFS))   ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_LOGICAL) &&\n               (obj->def->type == VIR_STORAGE_POOL_LOGICAL)) ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_DISK) &&\n               (obj->def->type == VIR_STORAGE_POOL_DISK))    ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_ISCSI) &&\n               (obj->def->type == VIR_STORAGE_POOL_ISCSI))   ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_SCSI) &&\n               (obj->def->type == VIR_STORAGE_POOL_SCSI))    ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_MPATH) &&\n               (obj->def->type == VIR_STORAGE_POOL_MPATH))   ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_RBD) &&\n               (obj->def->type == VIR_STORAGE_POOL_RBD))     ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_SHEEPDOG) &&\n               (obj->def->type == VIR_STORAGE_POOL_SHEEPDOG)) ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_GLUSTER) &&\n               (obj->def->type == VIR_STORAGE_POOL_GLUSTER)) ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_ZFS) &&\n               (obj->def->type == VIR_STORAGE_POOL_ZFS))     ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_VSTORAGE) &&\n               (obj->def->type == VIR_STORAGE_POOL_VSTORAGE)) ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_ISCSI_DIRECT) &&\n               (obj->def->type == VIR_STORAGE_POOL_ISCSI_DIRECT))))\n            return false;\n    }\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->filter",
          "args": [
            "data->conn",
            "obj->def"
          ],
          "line": 2044
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 2042
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nstatic int\nvirStoragePoolObjListExportCallback(void *payload,\n                                    const void *name G_GNUC_UNUSED,\n                                    void *opaque)\n{\n    virStoragePoolObjPtr obj = payload;\n    virStoragePoolObjListExportDataPtr data = opaque;\n    virStoragePoolPtr pool = NULL;\n\n    if (data->error)\n        return 0;\n\n    virObjectLock(obj);\n\n    if (data->filter && !data->filter(data->conn, obj->def))\n        goto cleanup;\n\n    if (!virStoragePoolObjMatch(obj, data->flags))\n        goto cleanup;\n\n    if (data->pools) {\n        if (!(pool = virGetStoragePool(data->conn, obj->def->name,\n                                       obj->def->uuid, NULL, NULL))) {\n            data->error = true;\n            goto cleanup;\n        }\n        data->pools[data->nPools] = pool;\n    }\n\n    data->nPools++;\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolObjMatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1949-2011",
    "snippet": "static bool\nvirStoragePoolObjMatch(virStoragePoolObjPtr obj,\n                       unsigned int flags)\n{\n    /* filter by active state */\n    if (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_ACTIVE) &&\n        !((MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_ACTIVE) &&\n           virStoragePoolObjIsActive(obj)) ||\n          (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_INACTIVE) &&\n           !virStoragePoolObjIsActive(obj))))\n        return false;\n\n    /* filter by persistence */\n    if (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_PERSISTENT) &&\n        !((MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_PERSISTENT) &&\n           obj->configFile) ||\n          (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_TRANSIENT) &&\n           !obj->configFile)))\n        return false;\n\n    /* filter by autostart option */\n    if (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_AUTOSTART) &&\n        !((MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_AUTOSTART) &&\n           obj->autostart) ||\n          (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_NO_AUTOSTART) &&\n           !obj->autostart)))\n        return false;\n\n    /* filter by pool type */\n    if (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_POOL_TYPE)) {\n        if (!((MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_DIR) &&\n               (obj->def->type == VIR_STORAGE_POOL_DIR))     ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FS) &&\n               (obj->def->type == VIR_STORAGE_POOL_FS))      ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_NETFS) &&\n               (obj->def->type == VIR_STORAGE_POOL_NETFS))   ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_LOGICAL) &&\n               (obj->def->type == VIR_STORAGE_POOL_LOGICAL)) ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_DISK) &&\n               (obj->def->type == VIR_STORAGE_POOL_DISK))    ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_ISCSI) &&\n               (obj->def->type == VIR_STORAGE_POOL_ISCSI))   ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_SCSI) &&\n               (obj->def->type == VIR_STORAGE_POOL_SCSI))    ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_MPATH) &&\n               (obj->def->type == VIR_STORAGE_POOL_MPATH))   ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_RBD) &&\n               (obj->def->type == VIR_STORAGE_POOL_RBD))     ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_SHEEPDOG) &&\n               (obj->def->type == VIR_STORAGE_POOL_SHEEPDOG)) ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_GLUSTER) &&\n               (obj->def->type == VIR_STORAGE_POOL_GLUSTER)) ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_ZFS) &&\n               (obj->def->type == VIR_STORAGE_POOL_ZFS))     ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_VSTORAGE) &&\n               (obj->def->type == VIR_STORAGE_POOL_VSTORAGE)) ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_ISCSI_DIRECT) &&\n               (obj->def->type == VIR_STORAGE_POOL_ISCSI_DIRECT))))\n            return false;\n    }\n\n    return true;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_ISCSI_DIRECT"
          ],
          "line": 2005
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_VSTORAGE"
          ],
          "line": 2003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_ZFS"
          ],
          "line": 2001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_GLUSTER"
          ],
          "line": 1999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_SHEEPDOG"
          ],
          "line": 1997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_RBD"
          ],
          "line": 1995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_MPATH"
          ],
          "line": 1993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_SCSI"
          ],
          "line": 1991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_ISCSI"
          ],
          "line": 1989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_DISK"
          ],
          "line": 1987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_LOGICAL"
          ],
          "line": 1985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_NETFS"
          ],
          "line": 1983
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_FS"
          ],
          "line": 1981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_DIR"
          ],
          "line": 1979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_POOL_TYPE"
          ],
          "line": 1978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_NO_AUTOSTART"
          ],
          "line": 1973
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_AUTOSTART"
          ],
          "line": 1971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_AUTOSTART"
          ],
          "line": 1970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_TRANSIENT"
          ],
          "line": 1965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_PERSISTENT"
          ],
          "line": 1963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_PERSISTENT"
          ],
          "line": 1962
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1958
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_INACTIVE"
          ],
          "line": 1957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_ACTIVE"
          ],
          "line": 1955
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_ACTIVE"
          ],
          "line": 1954
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic bool\nvirStoragePoolObjMatch(virStoragePoolObjPtr obj,\n                       unsigned int flags)\n{\n    /* filter by active state */\n    if (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_ACTIVE) &&\n        !((MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_ACTIVE) &&\n           virStoragePoolObjIsActive(obj)) ||\n          (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_INACTIVE) &&\n           !virStoragePoolObjIsActive(obj))))\n        return false;\n\n    /* filter by persistence */\n    if (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_PERSISTENT) &&\n        !((MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_PERSISTENT) &&\n           obj->configFile) ||\n          (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_TRANSIENT) &&\n           !obj->configFile)))\n        return false;\n\n    /* filter by autostart option */\n    if (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_AUTOSTART) &&\n        !((MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_AUTOSTART) &&\n           obj->autostart) ||\n          (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_NO_AUTOSTART) &&\n           !obj->autostart)))\n        return false;\n\n    /* filter by pool type */\n    if (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FILTERS_POOL_TYPE)) {\n        if (!((MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_DIR) &&\n               (obj->def->type == VIR_STORAGE_POOL_DIR))     ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_FS) &&\n               (obj->def->type == VIR_STORAGE_POOL_FS))      ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_NETFS) &&\n               (obj->def->type == VIR_STORAGE_POOL_NETFS))   ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_LOGICAL) &&\n               (obj->def->type == VIR_STORAGE_POOL_LOGICAL)) ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_DISK) &&\n               (obj->def->type == VIR_STORAGE_POOL_DISK))    ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_ISCSI) &&\n               (obj->def->type == VIR_STORAGE_POOL_ISCSI))   ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_SCSI) &&\n               (obj->def->type == VIR_STORAGE_POOL_SCSI))    ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_MPATH) &&\n               (obj->def->type == VIR_STORAGE_POOL_MPATH))   ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_RBD) &&\n               (obj->def->type == VIR_STORAGE_POOL_RBD))     ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_SHEEPDOG) &&\n               (obj->def->type == VIR_STORAGE_POOL_SHEEPDOG)) ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_GLUSTER) &&\n               (obj->def->type == VIR_STORAGE_POOL_GLUSTER)) ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_ZFS) &&\n               (obj->def->type == VIR_STORAGE_POOL_ZFS))     ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_VSTORAGE) &&\n               (obj->def->type == VIR_STORAGE_POOL_VSTORAGE)) ||\n              (MATCH(VIR_CONNECT_LIST_STORAGE_POOLS_ISCSI_DIRECT) &&\n               (obj->def->type == VIR_STORAGE_POOL_ISCSI_DIRECT))))\n            return false;\n    }\n\n    return true;\n}"
  },
  {
    "function_name": "virStoragePoolObjGetNames",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1920-1945",
    "snippet": "int\nvirStoragePoolObjGetNames(virStoragePoolObjListPtr pools,\n                          virConnectPtr conn,\n                          bool wantActive,\n                          virStoragePoolObjListACLFilter filter,\n                          char **const names,\n                          int maxnames)\n{\n    struct _virStoragePoolNameData data = {\n        .conn = conn, .filter = filter, .wantActive = wantActive,\n        .error = false, .nnames = 0, .maxnames = maxnames, .names = names };\n\n    virObjectRWLockRead(pools);\n    virHashForEach(pools->objs, virStoragePoolObjGetNamesCb, &data);\n    virObjectRWUnlock(pools);\n\n    if (data.error)\n        goto error;\n\n    return data.nnames;\n\n error:\n    while (data.nnames)\n        VIR_FREE(data.names[--data.nnames]);\n    return -1;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data.names[--data.nnames]"
          ],
          "line": 1943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "pools"
          ],
          "line": 1934
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "pools->objs",
            "virStoragePoolObjGetNamesCb",
            "&data"
          ],
          "line": 1933
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "pools"
          ],
          "line": 1932
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjGetNames(virStoragePoolObjListPtr pools,\n                          virConnectPtr conn,\n                          bool wantActive,\n                          virStoragePoolObjListACLFilter filter,\n                          char **const names,\n                          int maxnames)\n{\n    struct _virStoragePoolNameData data = {\n        .conn = conn, .filter = filter, .wantActive = wantActive,\n        .error = false, .nnames = 0, .maxnames = maxnames, .names = names };\n\n    virObjectRWLockRead(pools);\n    virHashForEach(pools->objs, virStoragePoolObjGetNamesCb, &data);\n    virObjectRWUnlock(pools);\n\n    if (data.error)\n        goto error;\n\n    return data.nnames;\n\n error:\n    while (data.nnames)\n        VIR_FREE(data.names[--data.nnames]);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolObjGetNamesCb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1887-1917",
    "snippet": "static int\nvirStoragePoolObjGetNamesCb(void *payload,\n                            const void *name G_GNUC_UNUSED,\n                            void *opaque)\n{\n    virStoragePoolObjPtr obj = payload;\n    struct _virStoragePoolNameData *data = opaque;\n\n    if (data->error)\n        return 0;\n\n    if (data->maxnames >= 0 && data->nnames == data->maxnames)\n        return 0;\n\n    virObjectLock(obj);\n\n    if (data->filter && !data->filter(data->conn, obj->def))\n        goto cleanup;\n\n    if (data->wantActive != virStoragePoolObjIsActive(obj))\n        goto cleanup;\n\n    if (data->names)\n        data->names[data->nnames] = g_strdup(obj->def->name);\n\n    data->nnames++;\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 1915
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "obj->def->name"
          ],
          "line": 1910
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1906
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->filter",
          "args": [
            "data->conn",
            "obj->def"
          ],
          "line": 1903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 1901
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nstatic int\nvirStoragePoolObjGetNamesCb(void *payload,\n                            const void *name G_GNUC_UNUSED,\n                            void *opaque)\n{\n    virStoragePoolObjPtr obj = payload;\n    struct _virStoragePoolNameData *data = opaque;\n\n    if (data->error)\n        return 0;\n\n    if (data->maxnames >= 0 && data->nnames == data->maxnames)\n        return 0;\n\n    virObjectLock(obj);\n\n    if (data->filter && !data->filter(data->conn, obj->def))\n        goto cleanup;\n\n    if (data->wantActive != virStoragePoolObjIsActive(obj))\n        goto cleanup;\n\n    if (data->names)\n        data->names[data->nnames] = g_strdup(obj->def->name);\n\n    data->nnames++;\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolObjNumOfStoragePools",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1859-1873",
    "snippet": "int\nvirStoragePoolObjNumOfStoragePools(virStoragePoolObjListPtr pools,\n                                   virConnectPtr conn,\n                                   bool wantActive,\n                                   virStoragePoolObjListACLFilter filter)\n{\n    struct _virStoragePoolCountData data = {\n        .conn = conn, .filter = filter, .wantActive = wantActive, .count = 0 };\n\n    virObjectRWLockRead(pools);\n    virHashForEach(pools->objs, virStoragePoolObjNumOfStoragePoolsCb, &data);\n    virObjectRWUnlock(pools);\n\n    return data.count;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "pools"
          ],
          "line": 1870
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "pools->objs",
            "virStoragePoolObjNumOfStoragePoolsCb",
            "&data"
          ],
          "line": 1869
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "pools"
          ],
          "line": 1868
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjNumOfStoragePools(virStoragePoolObjListPtr pools,\n                                   virConnectPtr conn,\n                                   bool wantActive,\n                                   virStoragePoolObjListACLFilter filter)\n{\n    struct _virStoragePoolCountData data = {\n        .conn = conn, .filter = filter, .wantActive = wantActive, .count = 0 };\n\n    virObjectRWLockRead(pools);\n    virHashForEach(pools->objs, virStoragePoolObjNumOfStoragePoolsCb, &data);\n    virObjectRWUnlock(pools);\n\n    return data.count;\n}"
  },
  {
    "function_name": "virStoragePoolObjNumOfStoragePoolsCb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1835-1856",
    "snippet": "static int\nvirStoragePoolObjNumOfStoragePoolsCb(void *payload,\n                                     const void *name G_GNUC_UNUSED,\n                                     void *opaque)\n{\n    virStoragePoolObjPtr obj = payload;\n    struct _virStoragePoolCountData *data = opaque;\n\n    virObjectLock(obj);\n\n    if (data->filter && !data->filter(data->conn, obj->def))\n        goto cleanup;\n\n    if (data->wantActive != virStoragePoolObjIsActive(obj))\n        goto cleanup;\n\n    data->count++;\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 1854
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1848
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->filter",
          "args": [
            "data->conn",
            "obj->def"
          ],
          "line": 1845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 1843
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nstatic int\nvirStoragePoolObjNumOfStoragePoolsCb(void *payload,\n                                     const void *name G_GNUC_UNUSED,\n                                     void *opaque)\n{\n    virStoragePoolObjPtr obj = payload;\n    struct _virStoragePoolCountData *data = opaque;\n\n    virObjectLock(obj);\n\n    if (data->filter && !data->filter(data->conn, obj->def))\n        goto cleanup;\n\n    if (data->wantActive != virStoragePoolObjIsActive(obj))\n        goto cleanup;\n\n    data->count++;\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolObjDeleteDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1807-1824",
    "snippet": "int\nvirStoragePoolObjDeleteDef(virStoragePoolObjPtr obj)\n{\n    if (!obj->configFile) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"no config file for %s\"), obj->def->name);\n        return -1;\n    }\n\n    if (unlink(obj->configFile) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot remove config for %s\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot remove config for %s\")",
            "obj->def->name"
          ],
          "line": 1817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot remove config for %s\""
          ],
          "line": 1818
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "obj->configFile"
          ],
          "line": 1816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"no config file for %s\")",
            "obj->def->name"
          ],
          "line": 1811
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjDeleteDef(virStoragePoolObjPtr obj)\n{\n    if (!obj->configFile) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"no config file for %s\"), obj->def->name);\n        return -1;\n    }\n\n    if (unlink(obj->configFile) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot remove config for %s\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolObjSaveDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1778-1804",
    "snippet": "int\nvirStoragePoolObjSaveDef(virStorageDriverStatePtr driver,\n                         virStoragePoolObjPtr obj,\n                         virStoragePoolDefPtr def)\n{\n    if (!obj->configFile) {\n        if (virFileMakePath(driver->configDir) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot create config directory %s\"),\n                                 driver->configDir);\n            return -1;\n        }\n\n        if (!(obj->configFile = virFileBuildPath(driver->configDir,\n                                                 def->name, \".xml\"))) {\n            return -1;\n        }\n\n        if (!(obj->autostartLink = virFileBuildPath(driver->autostartDir,\n                                                    def->name, \".xml\"))) {\n            VIR_FREE(obj->configFile);\n            return -1;\n        }\n    }\n\n    return virStoragePoolSaveConfig(obj->configFile, def);\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolSaveConfig",
          "args": [
            "obj->configFile",
            "def"
          ],
          "line": 1803
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolSaveConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1713-1726",
          "snippet": "int\nvirStoragePoolSaveConfig(const char *configFile,\n                         virStoragePoolDefPtr def)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virStoragePoolDefFormat(def))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to generate XML\"));\n        return -1;\n    }\n\n    return virStoragePoolSaveXML(configFile, def, xml);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirStoragePoolSaveConfig(const char *configFile,\n                         virStoragePoolDefPtr def)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virStoragePoolDefFormat(def))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to generate XML\"));\n        return -1;\n    }\n\n    return virStoragePoolSaveXML(configFile, def, xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "obj->configFile"
          ],
          "line": 1798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileBuildPath",
          "args": [
            "driver->autostartDir",
            "def->name",
            "\".xml\""
          ],
          "line": 1796
        },
        "resolved": true,
        "details": {
          "function_name": "virFileBuildPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3116-3128",
          "snippet": "char *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot create config directory %s\")",
            "driver->configDir"
          ],
          "line": 1785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot create config directory %s\""
          ],
          "line": 1786
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileMakePath",
          "args": [
            "driver->configDir"
          ],
          "line": 1784
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3076-3080",
          "snippet": "int\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjSaveDef(virStorageDriverStatePtr driver,\n                         virStoragePoolObjPtr obj,\n                         virStoragePoolDefPtr def)\n{\n    if (!obj->configFile) {\n        if (virFileMakePath(driver->configDir) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot create config directory %s\"),\n                                 driver->configDir);\n            return -1;\n        }\n\n        if (!(obj->configFile = virFileBuildPath(driver->configDir,\n                                                 def->name, \".xml\"))) {\n            return -1;\n        }\n\n        if (!(obj->autostartLink = virFileBuildPath(driver->autostartDir,\n                                                    def->name, \".xml\"))) {\n            VIR_FREE(obj->configFile);\n            return -1;\n        }\n    }\n\n    return virStoragePoolSaveConfig(obj->configFile, def);\n}"
  },
  {
    "function_name": "virStoragePoolObjLoadAllConfigs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1736-1775",
    "snippet": "int\nvirStoragePoolObjLoadAllConfigs(virStoragePoolObjListPtr pools,\n                                const char *configDir,\n                                const char *autostartDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        char *path;\n        char *autostartLink;\n        virStoragePoolObjPtr obj;\n\n        if (!virStringHasSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        if (!(path = virFileBuildPath(configDir, entry->d_name, NULL)))\n            continue;\n\n        if (!(autostartLink = virFileBuildPath(autostartDir, entry->d_name,\n                                               NULL))) {\n            VIR_FREE(path);\n            continue;\n        }\n\n        obj = virStoragePoolObjLoad(pools, entry->d_name, path, autostartLink);\n        virStoragePoolObjEndAPI(&obj);\n\n        VIR_FREE(path);\n        VIR_FREE(autostartLink);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dir"
          ],
          "line": 1773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "autostartLink"
          ],
          "line": 1770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "path"
          ],
          "line": 1769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1767
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjLoad",
          "args": [
            "pools",
            "entry->d_name",
            "path",
            "autostartLink"
          ],
          "line": 1766
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjLoad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1615-1648",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjLoad(virStoragePoolObjListPtr pools,\n                      const char *file,\n                      const char *path,\n                      const char *autostartLink)\n{\n    virStoragePoolObjPtr obj;\n    g_autoptr(virStoragePoolDef) def = NULL;\n\n    if (!(def = virStoragePoolDefParseFile(path)))\n        return NULL;\n\n    if (!virStringMatchesNameSuffix(file, def->name, \".xml\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Storage pool config filename '%s' does \"\n                         \"not match pool name '%s'\"),\n                       path, def->name);\n        return NULL;\n    }\n\n    if (!(obj = virStoragePoolObjListAdd(pools, def, 0)))\n        return NULL;\n    def = NULL;\n\n    VIR_FREE(obj->configFile);  /* for driver reload */\n    obj->configFile = g_strdup(path);\n    VIR_FREE(obj->autostartLink); /* for driver reload */\n    obj->autostartLink = g_strdup(autostartLink);\n\n    obj->autostart = virFileLinkPointsTo(obj->autostartLink,\n                                         obj->configFile);\n\n    return obj;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjLoad(virStoragePoolObjListPtr pools,\n                      const char *file,\n                      const char *path,\n                      const char *autostartLink)\n{\n    virStoragePoolObjPtr obj;\n    g_autoptr(virStoragePoolDef) def = NULL;\n\n    if (!(def = virStoragePoolDefParseFile(path)))\n        return NULL;\n\n    if (!virStringMatchesNameSuffix(file, def->name, \".xml\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Storage pool config filename '%s' does \"\n                         \"not match pool name '%s'\"),\n                       path, def->name);\n        return NULL;\n    }\n\n    if (!(obj = virStoragePoolObjListAdd(pools, def, 0)))\n        return NULL;\n    def = NULL;\n\n    VIR_FREE(obj->configFile);  /* for driver reload */\n    obj->configFile = g_strdup(path);\n    VIR_FREE(obj->autostartLink); /* for driver reload */\n    obj->autostartLink = g_strdup(autostartLink);\n\n    obj->autostart = virFileLinkPointsTo(obj->autostartLink,\n                                         obj->configFile);\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "path"
          ],
          "line": 1762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileBuildPath",
          "args": [
            "autostartDir",
            "entry->d_name",
            "NULL"
          ],
          "line": 1760
        },
        "resolved": true,
        "details": {
          "function_name": "virFileBuildPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3116-3128",
          "snippet": "char *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringHasSuffix",
          "args": [
            "entry->d_name",
            "\".xml\""
          ],
          "line": 1754
        },
        "resolved": true,
        "details": {
          "function_name": "virStringHasSuffix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1097-1108",
          "snippet": "bool\nvirStringHasSuffix(const char *str,\n                   const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    return STREQ(str + len - suffixlen, suffix);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringHasSuffix(const char *str,\n                   const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    return STREQ(str + len - suffixlen, suffix);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dir",
            "&entry",
            "configDir"
          ],
          "line": 1749
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpenIfExists",
          "args": [
            "&dir",
            "configDir"
          ],
          "line": 1746
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenIfExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2898-2902",
          "snippet": "int\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjLoadAllConfigs(virStoragePoolObjListPtr pools,\n                                const char *configDir,\n                                const char *autostartDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        char *path;\n        char *autostartLink;\n        virStoragePoolObjPtr obj;\n\n        if (!virStringHasSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        if (!(path = virFileBuildPath(configDir, entry->d_name, NULL)))\n            continue;\n\n        if (!(autostartLink = virFileBuildPath(autostartDir, entry->d_name,\n                                               NULL))) {\n            VIR_FREE(path);\n            continue;\n        }\n\n        obj = virStoragePoolObjLoad(pools, entry->d_name, path, autostartLink);\n        virStoragePoolObjEndAPI(&obj);\n\n        VIR_FREE(path);\n        VIR_FREE(autostartLink);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}"
  },
  {
    "function_name": "virStoragePoolObjLoadAllState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1708-1733",
    "snippet": "int\nvirStoragePoolObjLoadAllState(virStoragePoolObjListPtr pools,\n                              const char *stateDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, stateDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, stateDir)) > 0) {\n        virStoragePoolObjPtr obj;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        if (!(obj = virStoragePoolObjLoadState(pools, stateDir, entry->d_name)))\n            continue;\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dir"
          ],
          "line": 1731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1728
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjLoadState",
          "args": [
            "pools",
            "stateDir",
            "entry->d_name"
          ],
          "line": 1726
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjLoadState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1651-1705",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjLoadState(virStoragePoolObjListPtr pools,\n                           const char *stateDir,\n                           const char *name)\n{\n    char *stateFile = NULL;\n    virStoragePoolObjPtr obj = NULL;\n    xmlDocPtr xml = NULL;\n    xmlXPathContextPtr ctxt = NULL;\n    xmlNodePtr node = NULL;\n    g_autoptr(virStoragePoolDef) def = NULL;\n\n    if (!(stateFile = virFileBuildPath(stateDir, name, \".xml\")))\n        return NULL;\n\n    if (!(xml = virXMLParseCtxt(stateFile, NULL, _(\"(pool state)\"), &ctxt)))\n        goto cleanup;\n\n    if (!(node = virXPathNode(\"//pool\", ctxt))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not find any 'pool' element in state file\"));\n        goto cleanup;\n    }\n\n    ctxt->node = node;\n    if (!(def = virStoragePoolDefParseXML(ctxt)))\n        goto cleanup;\n\n    if (STRNEQ(name, def->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Storage pool state file '%s' does not match \"\n                         \"pool name '%s'\"),\n                       stateFile, def->name);\n        goto cleanup;\n    }\n\n    /* create the object */\n    if (!(obj = virStoragePoolObjListAdd(pools, def,\n                                         VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE)))\n        goto cleanup;\n    def = NULL;\n\n    /* XXX: future handling of some additional useful status data,\n     * for now, if a status file for a pool exists, the pool will be marked\n     * as active\n     */\n\n    obj->active = true;\n\n cleanup:\n    VIR_FREE(stateFile);\n    xmlFreeDoc(xml);\n    xmlXPathFreeContext(ctxt);\n    return obj;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjLoadState(virStoragePoolObjListPtr pools,\n                           const char *stateDir,\n                           const char *name)\n{\n    char *stateFile = NULL;\n    virStoragePoolObjPtr obj = NULL;\n    xmlDocPtr xml = NULL;\n    xmlXPathContextPtr ctxt = NULL;\n    xmlNodePtr node = NULL;\n    g_autoptr(virStoragePoolDef) def = NULL;\n\n    if (!(stateFile = virFileBuildPath(stateDir, name, \".xml\")))\n        return NULL;\n\n    if (!(xml = virXMLParseCtxt(stateFile, NULL, _(\"(pool state)\"), &ctxt)))\n        goto cleanup;\n\n    if (!(node = virXPathNode(\"//pool\", ctxt))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not find any 'pool' element in state file\"));\n        goto cleanup;\n    }\n\n    ctxt->node = node;\n    if (!(def = virStoragePoolDefParseXML(ctxt)))\n        goto cleanup;\n\n    if (STRNEQ(name, def->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Storage pool state file '%s' does not match \"\n                         \"pool name '%s'\"),\n                       stateFile, def->name);\n        goto cleanup;\n    }\n\n    /* create the object */\n    if (!(obj = virStoragePoolObjListAdd(pools, def,\n                                         VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE)))\n        goto cleanup;\n    def = NULL;\n\n    /* XXX: future handling of some additional useful status data,\n     * for now, if a status file for a pool exists, the pool will be marked\n     * as active\n     */\n\n    obj->active = true;\n\n cleanup:\n    VIR_FREE(stateFile);\n    xmlFreeDoc(xml);\n    xmlXPathFreeContext(ctxt);\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringStripSuffix",
          "args": [
            "entry->d_name",
            "\".xml\""
          ],
          "line": 1723
        },
        "resolved": true,
        "details": {
          "function_name": "virStringStripSuffix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1123-1139",
          "snippet": "bool\nvirStringStripSuffix(char *str,\n                     const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    if (STRNEQ(str + len - suffixlen, suffix))\n        return false;\n\n    str[len - suffixlen] = '\\0';\n\n    return true;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringStripSuffix(char *str,\n                     const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    if (STRNEQ(str + len - suffixlen, suffix))\n        return false;\n\n    str[len - suffixlen] = '\\0';\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dir",
            "&entry",
            "stateDir"
          ],
          "line": 1720
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpenIfExists",
          "args": [
            "&dir",
            "stateDir"
          ],
          "line": 1717
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenIfExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2898-2902",
          "snippet": "int\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjLoadAllState(virStoragePoolObjListPtr pools,\n                              const char *stateDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, stateDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, stateDir)) > 0) {\n        virStoragePoolObjPtr obj;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        if (!(obj = virStoragePoolObjLoadState(pools, stateDir, entry->d_name)))\n            continue;\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}"
  },
  {
    "function_name": "virStoragePoolObjLoadState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1651-1705",
    "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjLoadState(virStoragePoolObjListPtr pools,\n                           const char *stateDir,\n                           const char *name)\n{\n    char *stateFile = NULL;\n    virStoragePoolObjPtr obj = NULL;\n    xmlDocPtr xml = NULL;\n    xmlXPathContextPtr ctxt = NULL;\n    xmlNodePtr node = NULL;\n    g_autoptr(virStoragePoolDef) def = NULL;\n\n    if (!(stateFile = virFileBuildPath(stateDir, name, \".xml\")))\n        return NULL;\n\n    if (!(xml = virXMLParseCtxt(stateFile, NULL, _(\"(pool state)\"), &ctxt)))\n        goto cleanup;\n\n    if (!(node = virXPathNode(\"//pool\", ctxt))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not find any 'pool' element in state file\"));\n        goto cleanup;\n    }\n\n    ctxt->node = node;\n    if (!(def = virStoragePoolDefParseXML(ctxt)))\n        goto cleanup;\n\n    if (STRNEQ(name, def->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Storage pool state file '%s' does not match \"\n                         \"pool name '%s'\"),\n                       stateFile, def->name);\n        goto cleanup;\n    }\n\n    /* create the object */\n    if (!(obj = virStoragePoolObjListAdd(pools, def,\n                                         VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE)))\n        goto cleanup;\n    def = NULL;\n\n    /* XXX: future handling of some additional useful status data,\n     * for now, if a status file for a pool exists, the pool will be marked\n     * as active\n     */\n\n    obj->active = true;\n\n cleanup:\n    VIR_FREE(stateFile);\n    xmlFreeDoc(xml);\n    xmlXPathFreeContext(ctxt);\n    return obj;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlXPathFreeContext",
          "args": [
            "ctxt"
          ],
          "line": 1703
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlFreeDoc",
          "args": [
            "xml"
          ],
          "line": 1702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "stateFile"
          ],
          "line": 1701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjListAdd",
          "args": [
            "pools",
            "def",
            "VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE"
          ],
          "line": 1688
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjListAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1565-1612",
          "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjListAdd(virStoragePoolObjListPtr pools,\n                         virStoragePoolDefPtr def,\n                         unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    int rc;\n\n    virObjectRWLockWrite(pools);\n\n    if (virStoragePoolObjSourceFindDuplicate(pools, def) < 0)\n        goto error;\n\n    rc = virStoragePoolObjIsDuplicate(pools, def,\n                                      !!(flags & VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE),\n                                      &obj);\n\n    if (rc < 0)\n        goto error;\n    if (rc > 0) {\n        virStoragePoolObjAssignDef(obj, def, flags);\n        virObjectRWUnlock(pools);\n        return obj;\n    }\n\n    if (!(obj = virStoragePoolObjNew()))\n        goto error;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    if (virHashAddEntry(pools->objs, uuidstr, obj) < 0)\n        goto error;\n    virObjectRef(obj);\n\n    if (virHashAddEntry(pools->objsName, def->name, obj) < 0) {\n        virHashRemoveEntry(pools->objs, uuidstr);\n        goto error;\n    }\n    virObjectRef(obj);\n    obj->def = def;\n    virObjectRWUnlock(pools);\n    return obj;\n\n error:\n    virStoragePoolObjEndAPI(&obj);\n    virObjectRWUnlock(pools);\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolObjPtr\nvirStoragePoolObjListAdd(virStoragePoolObjListPtr pools,\n                         virStoragePoolDefPtr def,\n                         unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    int rc;\n\n    virObjectRWLockWrite(pools);\n\n    if (virStoragePoolObjSourceFindDuplicate(pools, def) < 0)\n        goto error;\n\n    rc = virStoragePoolObjIsDuplicate(pools, def,\n                                      !!(flags & VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE),\n                                      &obj);\n\n    if (rc < 0)\n        goto error;\n    if (rc > 0) {\n        virStoragePoolObjAssignDef(obj, def, flags);\n        virObjectRWUnlock(pools);\n        return obj;\n    }\n\n    if (!(obj = virStoragePoolObjNew()))\n        goto error;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    if (virHashAddEntry(pools->objs, uuidstr, obj) < 0)\n        goto error;\n    virObjectRef(obj);\n\n    if (virHashAddEntry(pools->objsName, def->name, obj) < 0) {\n        virHashRemoveEntry(pools->objs, uuidstr);\n        goto error;\n    }\n    virObjectRef(obj);\n    obj->def = def;\n    virObjectRWUnlock(pools);\n    return obj;\n\n error:\n    virStoragePoolObjEndAPI(&obj);\n    virObjectRWUnlock(pools);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Storage pool state file '%s' does not match \"\n                         \"pool name '%s'\")",
            "stateFile",
            "def->name"
          ],
          "line": 1680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Storage pool state file '%s' does not match \"\n                         \"pool name '%s'\""
          ],
          "line": 1681
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "name",
            "def->name"
          ],
          "line": 1679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolDefParseXML",
          "args": [
            "ctxt"
          ],
          "line": 1676
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefParseXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "844-995",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolDefParseXML(xmlXPathContextPtr ctxt)\n{\n    virStoragePoolOptionsPtr options;\n    xmlNodePtr source_node;\n    g_autoptr(virStoragePoolDef) def = NULL;\n    g_autofree char *type = NULL;\n    g_autofree char *uuid = NULL;\n    g_autofree char *target_path = NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    type = virXPathString(\"string(./@type)\", ctxt);\n    if (type == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"storage pool missing type attribute\"));\n        return NULL;\n    }\n\n    if ((def->type = virStoragePoolTypeFromString(type)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown storage pool type %s\"), type);\n        return NULL;\n    }\n\n    if ((options = virStoragePoolOptionsForPoolType(def->type)) == NULL)\n        return NULL;\n\n    source_node = virXPathNode(\"./source\", ctxt);\n    if (source_node) {\n        if (virStoragePoolDefParseSource(ctxt, &def->source, def->type,\n                                         source_node) < 0)\n            return NULL;\n    } else {\n        if (options->formatFromString)\n            def->source.format = options->defaultFormat;\n    }\n\n    def->name = virXPathString(\"string(./name)\", ctxt);\n    if (def->name == NULL &&\n        options->flags & VIR_STORAGE_POOL_SOURCE_NAME)\n        def->name = g_strdup(def->source.name);\n\n    if (def->name == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing pool source name element\"));\n        return NULL;\n    }\n\n    if (strchr(def->name, '/')) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"name %s cannot contain '/'\"), def->name);\n        return NULL;\n    }\n\n    uuid = virXPathString(\"string(./uuid)\", ctxt);\n    if (uuid == NULL) {\n        if (virUUIDGenerate(def->uuid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"unable to generate uuid\"));\n            return NULL;\n        }\n    } else {\n        if (virUUIDParse(uuid, def->uuid) < 0) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed uuid element\"));\n            return NULL;\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_HOST) {\n        if (!def->source.nhost) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source host name\"));\n            return NULL;\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_DIR) {\n        if (!def->source.dir) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source path\"));\n            return NULL;\n        }\n    }\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_NAME) {\n        if (def->source.name == NULL) {\n            /* source name defaults to pool name */\n            def->source.name = g_strdup(def->name);\n        }\n    }\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_ADAPTER) &&\n        (virStorageAdapterValidate(&def->source.adapter)) < 0)\n            return NULL;\n\n    /* If DEVICE is the only source type, then its required */\n    if (options->flags == VIR_STORAGE_POOL_SOURCE_DEVICE) {\n        if (!def->source.ndevice) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source device name\"));\n            return NULL;\n        }\n    }\n\n    /* When we are working with a virtual disk we can skip the target\n     * path and permissions */\n    if (!(options->flags & VIR_STORAGE_POOL_SOURCE_NETWORK)) {\n        if (def->type == VIR_STORAGE_POOL_LOGICAL) {\n            target_path = g_strdup_printf(\"/dev/%s\", def->source.name);\n        } else if (def->type == VIR_STORAGE_POOL_ZFS) {\n            target_path = g_strdup_printf(\"/dev/zvol/%s\", def->source.name);\n        } else {\n            target_path = virXPathString(\"string(./target/path)\", ctxt);\n            if (!target_path) {\n                virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                               _(\"missing storage pool target path\"));\n                return NULL;\n            }\n        }\n        def->target.path = virFileSanitizePath(target_path);\n        if (!def->target.path)\n            return NULL;\n\n        if (virStorageDefParsePerms(ctxt, &def->target.perms,\n                                    \"./target/permissions\") < 0)\n            return NULL;\n    }\n\n    if (def->type == VIR_STORAGE_POOL_ISCSI_DIRECT &&\n        !def->source.initiator.iqn) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"missing initiator IQN\"));\n        return NULL;\n    }\n\n    if (virStoragePoolDefRefreshParse(ctxt, def) < 0)\n        return NULL;\n\n    /* Make a copy of all the callback pointers here for easier use,\n     * especially during the virStoragePoolSourceClear method */\n    def->ns = options->ns;\n    if (def->ns.parse) {\n        if (virXMLNamespaceRegister(ctxt, &def->ns) < 0)\n            return NULL;\n        if ((def->ns.parse)(ctxt, &def->namespaceData) < 0)\n            return NULL;\n    }\n\n    return g_steal_pointer(&def);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolDefParseXML(xmlXPathContextPtr ctxt)\n{\n    virStoragePoolOptionsPtr options;\n    xmlNodePtr source_node;\n    g_autoptr(virStoragePoolDef) def = NULL;\n    g_autofree char *type = NULL;\n    g_autofree char *uuid = NULL;\n    g_autofree char *target_path = NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    type = virXPathString(\"string(./@type)\", ctxt);\n    if (type == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"storage pool missing type attribute\"));\n        return NULL;\n    }\n\n    if ((def->type = virStoragePoolTypeFromString(type)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown storage pool type %s\"), type);\n        return NULL;\n    }\n\n    if ((options = virStoragePoolOptionsForPoolType(def->type)) == NULL)\n        return NULL;\n\n    source_node = virXPathNode(\"./source\", ctxt);\n    if (source_node) {\n        if (virStoragePoolDefParseSource(ctxt, &def->source, def->type,\n                                         source_node) < 0)\n            return NULL;\n    } else {\n        if (options->formatFromString)\n            def->source.format = options->defaultFormat;\n    }\n\n    def->name = virXPathString(\"string(./name)\", ctxt);\n    if (def->name == NULL &&\n        options->flags & VIR_STORAGE_POOL_SOURCE_NAME)\n        def->name = g_strdup(def->source.name);\n\n    if (def->name == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing pool source name element\"));\n        return NULL;\n    }\n\n    if (strchr(def->name, '/')) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"name %s cannot contain '/'\"), def->name);\n        return NULL;\n    }\n\n    uuid = virXPathString(\"string(./uuid)\", ctxt);\n    if (uuid == NULL) {\n        if (virUUIDGenerate(def->uuid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"unable to generate uuid\"));\n            return NULL;\n        }\n    } else {\n        if (virUUIDParse(uuid, def->uuid) < 0) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed uuid element\"));\n            return NULL;\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_HOST) {\n        if (!def->source.nhost) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source host name\"));\n            return NULL;\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_DIR) {\n        if (!def->source.dir) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source path\"));\n            return NULL;\n        }\n    }\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_NAME) {\n        if (def->source.name == NULL) {\n            /* source name defaults to pool name */\n            def->source.name = g_strdup(def->name);\n        }\n    }\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_ADAPTER) &&\n        (virStorageAdapterValidate(&def->source.adapter)) < 0)\n            return NULL;\n\n    /* If DEVICE is the only source type, then its required */\n    if (options->flags == VIR_STORAGE_POOL_SOURCE_DEVICE) {\n        if (!def->source.ndevice) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source device name\"));\n            return NULL;\n        }\n    }\n\n    /* When we are working with a virtual disk we can skip the target\n     * path and permissions */\n    if (!(options->flags & VIR_STORAGE_POOL_SOURCE_NETWORK)) {\n        if (def->type == VIR_STORAGE_POOL_LOGICAL) {\n            target_path = g_strdup_printf(\"/dev/%s\", def->source.name);\n        } else if (def->type == VIR_STORAGE_POOL_ZFS) {\n            target_path = g_strdup_printf(\"/dev/zvol/%s\", def->source.name);\n        } else {\n            target_path = virXPathString(\"string(./target/path)\", ctxt);\n            if (!target_path) {\n                virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                               _(\"missing storage pool target path\"));\n                return NULL;\n            }\n        }\n        def->target.path = virFileSanitizePath(target_path);\n        if (!def->target.path)\n            return NULL;\n\n        if (virStorageDefParsePerms(ctxt, &def->target.perms,\n                                    \"./target/permissions\") < 0)\n            return NULL;\n    }\n\n    if (def->type == VIR_STORAGE_POOL_ISCSI_DIRECT &&\n        !def->source.initiator.iqn) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"missing initiator IQN\"));\n        return NULL;\n    }\n\n    if (virStoragePoolDefRefreshParse(ctxt, def) < 0)\n        return NULL;\n\n    /* Make a copy of all the callback pointers here for easier use,\n     * especially during the virStoragePoolSourceClear method */\n    def->ns = options->ns;\n    if (def->ns.parse) {\n        if (virXMLNamespaceRegister(ctxt, &def->ns) < 0)\n            return NULL;\n        if ((def->ns.parse)(ctxt, &def->namespaceData) < 0)\n            return NULL;\n    }\n\n    return g_steal_pointer(&def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not find any 'pool' element in state file\")"
          ],
          "line": 1670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXPathNode",
          "args": [
            "\"//pool\"",
            "ctxt"
          ],
          "line": 1669
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "608-634",
          "snippet": "xmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLParseCtxt",
          "args": [
            "stateFile",
            "NULL",
            "_(\"(pool state)\")",
            "&ctxt"
          ],
          "line": 1666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileBuildPath",
          "args": [
            "stateDir",
            "name",
            "\".xml\""
          ],
          "line": 1663
        },
        "resolved": true,
        "details": {
          "function_name": "virFileBuildPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3116-3128",
          "snippet": "char *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjLoadState(virStoragePoolObjListPtr pools,\n                           const char *stateDir,\n                           const char *name)\n{\n    char *stateFile = NULL;\n    virStoragePoolObjPtr obj = NULL;\n    xmlDocPtr xml = NULL;\n    xmlXPathContextPtr ctxt = NULL;\n    xmlNodePtr node = NULL;\n    g_autoptr(virStoragePoolDef) def = NULL;\n\n    if (!(stateFile = virFileBuildPath(stateDir, name, \".xml\")))\n        return NULL;\n\n    if (!(xml = virXMLParseCtxt(stateFile, NULL, _(\"(pool state)\"), &ctxt)))\n        goto cleanup;\n\n    if (!(node = virXPathNode(\"//pool\", ctxt))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not find any 'pool' element in state file\"));\n        goto cleanup;\n    }\n\n    ctxt->node = node;\n    if (!(def = virStoragePoolDefParseXML(ctxt)))\n        goto cleanup;\n\n    if (STRNEQ(name, def->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Storage pool state file '%s' does not match \"\n                         \"pool name '%s'\"),\n                       stateFile, def->name);\n        goto cleanup;\n    }\n\n    /* create the object */\n    if (!(obj = virStoragePoolObjListAdd(pools, def,\n                                         VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE)))\n        goto cleanup;\n    def = NULL;\n\n    /* XXX: future handling of some additional useful status data,\n     * for now, if a status file for a pool exists, the pool will be marked\n     * as active\n     */\n\n    obj->active = true;\n\n cleanup:\n    VIR_FREE(stateFile);\n    xmlFreeDoc(xml);\n    xmlXPathFreeContext(ctxt);\n    return obj;\n}"
  },
  {
    "function_name": "virStoragePoolObjLoad",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1615-1648",
    "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjLoad(virStoragePoolObjListPtr pools,\n                      const char *file,\n                      const char *path,\n                      const char *autostartLink)\n{\n    virStoragePoolObjPtr obj;\n    g_autoptr(virStoragePoolDef) def = NULL;\n\n    if (!(def = virStoragePoolDefParseFile(path)))\n        return NULL;\n\n    if (!virStringMatchesNameSuffix(file, def->name, \".xml\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Storage pool config filename '%s' does \"\n                         \"not match pool name '%s'\"),\n                       path, def->name);\n        return NULL;\n    }\n\n    if (!(obj = virStoragePoolObjListAdd(pools, def, 0)))\n        return NULL;\n    def = NULL;\n\n    VIR_FREE(obj->configFile);  /* for driver reload */\n    obj->configFile = g_strdup(path);\n    VIR_FREE(obj->autostartLink); /* for driver reload */\n    obj->autostartLink = g_strdup(autostartLink);\n\n    obj->autostart = virFileLinkPointsTo(obj->autostartLink,\n                                         obj->configFile);\n\n    return obj;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileLinkPointsTo",
          "args": [
            "obj->autostartLink",
            "obj->configFile"
          ],
          "line": 1644
        },
        "resolved": true,
        "details": {
          "function_name": "virFileLinkPointsTo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1533-1543",
          "snippet": "int\nvirFileLinkPointsTo(const char *checkLink,\n                    const char *checkDest)\n{\n    struct stat src_sb;\n    struct stat dest_sb;\n\n    return (stat(checkLink, &src_sb) == 0\n            && stat(checkDest, &dest_sb) == 0\n            && SAME_INODE(src_sb, dest_sb));\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileLinkPointsTo(const char *checkLink,\n                    const char *checkDest)\n{\n    struct stat src_sb;\n    struct stat dest_sb;\n\n    return (stat(checkLink, &src_sb) == 0\n            && stat(checkDest, &dest_sb) == 0\n            && SAME_INODE(src_sb, dest_sb));\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "autostartLink"
          ],
          "line": 1642
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "obj->autostartLink"
          ],
          "line": 1641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "obj->configFile"
          ],
          "line": 1639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjListAdd",
          "args": [
            "pools",
            "def",
            "0"
          ],
          "line": 1635
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjListAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1565-1612",
          "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjListAdd(virStoragePoolObjListPtr pools,\n                         virStoragePoolDefPtr def,\n                         unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    int rc;\n\n    virObjectRWLockWrite(pools);\n\n    if (virStoragePoolObjSourceFindDuplicate(pools, def) < 0)\n        goto error;\n\n    rc = virStoragePoolObjIsDuplicate(pools, def,\n                                      !!(flags & VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE),\n                                      &obj);\n\n    if (rc < 0)\n        goto error;\n    if (rc > 0) {\n        virStoragePoolObjAssignDef(obj, def, flags);\n        virObjectRWUnlock(pools);\n        return obj;\n    }\n\n    if (!(obj = virStoragePoolObjNew()))\n        goto error;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    if (virHashAddEntry(pools->objs, uuidstr, obj) < 0)\n        goto error;\n    virObjectRef(obj);\n\n    if (virHashAddEntry(pools->objsName, def->name, obj) < 0) {\n        virHashRemoveEntry(pools->objs, uuidstr);\n        goto error;\n    }\n    virObjectRef(obj);\n    obj->def = def;\n    virObjectRWUnlock(pools);\n    return obj;\n\n error:\n    virStoragePoolObjEndAPI(&obj);\n    virObjectRWUnlock(pools);\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolObjPtr\nvirStoragePoolObjListAdd(virStoragePoolObjListPtr pools,\n                         virStoragePoolDefPtr def,\n                         unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    int rc;\n\n    virObjectRWLockWrite(pools);\n\n    if (virStoragePoolObjSourceFindDuplicate(pools, def) < 0)\n        goto error;\n\n    rc = virStoragePoolObjIsDuplicate(pools, def,\n                                      !!(flags & VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE),\n                                      &obj);\n\n    if (rc < 0)\n        goto error;\n    if (rc > 0) {\n        virStoragePoolObjAssignDef(obj, def, flags);\n        virObjectRWUnlock(pools);\n        return obj;\n    }\n\n    if (!(obj = virStoragePoolObjNew()))\n        goto error;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    if (virHashAddEntry(pools->objs, uuidstr, obj) < 0)\n        goto error;\n    virObjectRef(obj);\n\n    if (virHashAddEntry(pools->objsName, def->name, obj) < 0) {\n        virHashRemoveEntry(pools->objs, uuidstr);\n        goto error;\n    }\n    virObjectRef(obj);\n    obj->def = def;\n    virObjectRWUnlock(pools);\n    return obj;\n\n error:\n    virStoragePoolObjEndAPI(&obj);\n    virObjectRWUnlock(pools);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"Storage pool config filename '%s' does \"\n                         \"not match pool name '%s'\")",
            "path",
            "def->name"
          ],
          "line": 1628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Storage pool config filename '%s' does \"\n                         \"not match pool name '%s'\""
          ],
          "line": 1629
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringMatchesNameSuffix",
          "args": [
            "file",
            "def->name",
            "\".xml\""
          ],
          "line": 1627
        },
        "resolved": true,
        "details": {
          "function_name": "virStringMatchesNameSuffix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1141-1156",
          "snippet": "bool\nvirStringMatchesNameSuffix(const char *file,\n                           const char *name,\n                           const char *suffix)\n{\n    int filelen = strlen(file);\n    int namelen = strlen(name);\n    int suffixlen = strlen(suffix);\n\n    if (filelen == (namelen + suffixlen) &&\n        STREQLEN(file, name, namelen) &&\n        STREQ(file + namelen, suffix))\n        return true;\n    else\n        return false;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringMatchesNameSuffix(const char *file,\n                           const char *name,\n                           const char *suffix)\n{\n    int filelen = strlen(file);\n    int namelen = strlen(name);\n    int suffixlen = strlen(suffix);\n\n    if (filelen == (namelen + suffixlen) &&\n        STREQLEN(file, name, namelen) &&\n        STREQ(file + namelen, suffix))\n        return true;\n    else\n        return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolDefParseFile",
          "args": [
            "path"
          ],
          "line": 1624
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefParseFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1043-1047",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolDefParseFile(const char *filename)\n{\n    return virStoragePoolDefParse(NULL, filename);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolDefParseFile(const char *filename)\n{\n    return virStoragePoolDefParse(NULL, filename);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjLoad(virStoragePoolObjListPtr pools,\n                      const char *file,\n                      const char *path,\n                      const char *autostartLink)\n{\n    virStoragePoolObjPtr obj;\n    g_autoptr(virStoragePoolDef) def = NULL;\n\n    if (!(def = virStoragePoolDefParseFile(path)))\n        return NULL;\n\n    if (!virStringMatchesNameSuffix(file, def->name, \".xml\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Storage pool config filename '%s' does \"\n                         \"not match pool name '%s'\"),\n                       path, def->name);\n        return NULL;\n    }\n\n    if (!(obj = virStoragePoolObjListAdd(pools, def, 0)))\n        return NULL;\n    def = NULL;\n\n    VIR_FREE(obj->configFile);  /* for driver reload */\n    obj->configFile = g_strdup(path);\n    VIR_FREE(obj->autostartLink); /* for driver reload */\n    obj->autostartLink = g_strdup(autostartLink);\n\n    obj->autostart = virFileLinkPointsTo(obj->autostartLink,\n                                         obj->configFile);\n\n    return obj;\n}"
  },
  {
    "function_name": "virStoragePoolObjListAdd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1565-1612",
    "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjListAdd(virStoragePoolObjListPtr pools,\n                         virStoragePoolDefPtr def,\n                         unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    int rc;\n\n    virObjectRWLockWrite(pools);\n\n    if (virStoragePoolObjSourceFindDuplicate(pools, def) < 0)\n        goto error;\n\n    rc = virStoragePoolObjIsDuplicate(pools, def,\n                                      !!(flags & VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE),\n                                      &obj);\n\n    if (rc < 0)\n        goto error;\n    if (rc > 0) {\n        virStoragePoolObjAssignDef(obj, def, flags);\n        virObjectRWUnlock(pools);\n        return obj;\n    }\n\n    if (!(obj = virStoragePoolObjNew()))\n        goto error;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    if (virHashAddEntry(pools->objs, uuidstr, obj) < 0)\n        goto error;\n    virObjectRef(obj);\n\n    if (virHashAddEntry(pools->objsName, def->name, obj) < 0) {\n        virHashRemoveEntry(pools->objs, uuidstr);\n        goto error;\n    }\n    virObjectRef(obj);\n    obj->def = def;\n    virObjectRWUnlock(pools);\n    return obj;\n\n error:\n    virStoragePoolObjEndAPI(&obj);\n    virObjectRWUnlock(pools);\n    return NULL;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "pools"
          ],
          "line": 1610
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1609
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "obj"
          ],
          "line": 1603
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashRemoveEntry",
          "args": [
            "pools->objs",
            "uuidstr"
          ],
          "line": 1600
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "584-609",
          "snippet": "int\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "pools->objsName",
            "def->name",
            "obj"
          ],
          "line": 1599
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "def->uuid",
            "uuidstr"
          ],
          "line": 1594
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjNew",
          "args": [],
          "line": 1591
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "212-231",
          "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjNew(void)\n{\n    virStoragePoolObjPtr obj;\n\n    if (virStoragePoolObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virStoragePoolObjClass)))\n        return NULL;\n\n    if (!(obj->volumes = virStorageVolObjListNew())) {\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    virObjectLock(obj);\n    obj->active = false;\n    return obj;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virStoragePoolObjClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virClassPtr virStoragePoolObjClass;\n\nvirStoragePoolObjPtr\nvirStoragePoolObjNew(void)\n{\n    virStoragePoolObjPtr obj;\n\n    if (virStoragePoolObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virStoragePoolObjClass)))\n        return NULL;\n\n    if (!(obj->volumes = virStorageVolObjListNew())) {\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    virObjectLock(obj);\n    obj->active = false;\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjAssignDef",
          "args": [
            "obj",
            "def",
            "flags"
          ],
          "line": 1586
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjAssignDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1526-1543",
          "snippet": "static void\nvirStoragePoolObjAssignDef(virStoragePoolObjPtr obj,\n                           virStoragePoolDefPtr def,\n                           unsigned int flags)\n{\n    if (virStoragePoolObjIsActive(obj) ||\n        virStoragePoolObjIsStarting(obj)) {\n        virStoragePoolDefFree(obj->newDef);\n        obj->newDef = def;\n    } else {\n        if (!obj->newDef &&\n            flags & VIR_STORAGE_POOL_OBJ_LIST_ADD_LIVE)\n            obj->newDef = g_steal_pointer(&obj->def);\n\n        virStoragePoolDefFree(obj->def);\n        obj->def = def;\n    }\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjAssignDef(virStoragePoolObjPtr obj,\n                           virStoragePoolDefPtr def,\n                           unsigned int flags)\n{\n    if (virStoragePoolObjIsActive(obj) ||\n        virStoragePoolObjIsStarting(obj)) {\n        virStoragePoolDefFree(obj->newDef);\n        obj->newDef = def;\n    } else {\n        if (!obj->newDef &&\n            flags & VIR_STORAGE_POOL_OBJ_LIST_ADD_LIVE)\n            obj->newDef = g_steal_pointer(&obj->def);\n\n        virStoragePoolDefFree(obj->def);\n        obj->def = def;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsDuplicate",
          "args": [
            "pools",
            "def",
            "!!(flags & VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE)",
            "&obj"
          ],
          "line": 1579
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsDuplicate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1073-1135",
          "snippet": "static int\nvirStoragePoolObjIsDuplicate(virStoragePoolObjListPtr pools,\n                             virStoragePoolDefPtr def,\n                             bool check_active,\n                             virStoragePoolObjPtr *objRet)\n{\n    int ret = -1;\n    virStoragePoolObjPtr obj = NULL;\n\n    /* See if a Pool with matching UUID already exists */\n    obj = virStoragePoolObjFindByUUIDLocked(pools, def->uuid);\n    if (obj) {\n        virObjectLock(obj);\n\n        /* UUID matches, but if names don't match, refuse it */\n        if (STRNEQ(obj->def->name, def->name)) {\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n            virUUIDFormat(obj->def->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"pool '%s' is already defined with uuid %s\"),\n                           obj->def->name, uuidstr);\n            goto cleanup;\n        }\n\n        if (check_active) {\n            /* UUID & name match, but if Pool is already active, refuse it */\n            if (virStoragePoolObjIsActive(obj)) {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"pool is already active as '%s'\"),\n                               obj->def->name);\n                goto cleanup;\n            }\n\n            if (virStoragePoolObjIsStarting(obj)) {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"pool '%s' is starting up\"),\n                               obj->def->name);\n                goto cleanup;\n            }\n        }\n\n        *objRet = g_steal_pointer(&obj);\n        ret = 1;\n    } else {\n        /* UUID does not match, but if a name matches, refuse it */\n        obj = virStoragePoolObjFindByNameLocked(pools, def->name);\n        if (obj) {\n            virObjectLock(obj);\n\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n            virUUIDFormat(obj->def->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"pool '%s' already exists with uuid %s\"),\n                           def->name, uuidstr);\n            goto cleanup;\n        }\n        ret = 0;\n    }\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolObjIsDuplicate(virStoragePoolObjListPtr pools,\n                             virStoragePoolDefPtr def,\n                             bool check_active,\n                             virStoragePoolObjPtr *objRet)\n{\n    int ret = -1;\n    virStoragePoolObjPtr obj = NULL;\n\n    /* See if a Pool with matching UUID already exists */\n    obj = virStoragePoolObjFindByUUIDLocked(pools, def->uuid);\n    if (obj) {\n        virObjectLock(obj);\n\n        /* UUID matches, but if names don't match, refuse it */\n        if (STRNEQ(obj->def->name, def->name)) {\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n            virUUIDFormat(obj->def->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"pool '%s' is already defined with uuid %s\"),\n                           obj->def->name, uuidstr);\n            goto cleanup;\n        }\n\n        if (check_active) {\n            /* UUID & name match, but if Pool is already active, refuse it */\n            if (virStoragePoolObjIsActive(obj)) {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"pool is already active as '%s'\"),\n                               obj->def->name);\n                goto cleanup;\n            }\n\n            if (virStoragePoolObjIsStarting(obj)) {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"pool '%s' is starting up\"),\n                               obj->def->name);\n                goto cleanup;\n            }\n        }\n\n        *objRet = g_steal_pointer(&obj);\n        ret = 1;\n    } else {\n        /* UUID does not match, but if a name matches, refuse it */\n        obj = virStoragePoolObjFindByNameLocked(pools, def->name);\n        if (obj) {\n            virObjectLock(obj);\n\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n            virUUIDFormat(obj->def->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"pool '%s' already exists with uuid %s\"),\n                           def->name, uuidstr);\n            goto cleanup;\n        }\n        ret = 0;\n    }\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjSourceFindDuplicate",
          "args": [
            "pools",
            "def"
          ],
          "line": 1576
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjSourceFindDuplicate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1505-1523",
          "snippet": "static int\nvirStoragePoolObjSourceFindDuplicate(virStoragePoolObjListPtr pools,\n                                     virStoragePoolDefPtr def)\n{\n    struct _virStoragePoolObjFindDuplicateData data = {.def = def};\n    virStoragePoolObjPtr obj = NULL;\n\n    obj = virHashSearch(pools->objs, virStoragePoolObjSourceFindDuplicateCb,\n                        &data, NULL);\n\n    if (obj) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Storage source conflict with pool: '%s'\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolObjSourceFindDuplicate(virStoragePoolObjListPtr pools,\n                                     virStoragePoolDefPtr def)\n{\n    struct _virStoragePoolObjFindDuplicateData data = {.def = def};\n    virStoragePoolObjPtr obj = NULL;\n\n    obj = virHashSearch(pools->objs, virStoragePoolObjSourceFindDuplicateCb,\n                        &data, NULL);\n\n    if (obj) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Storage source conflict with pool: '%s'\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockWrite",
          "args": [
            "pools"
          ],
          "line": 1574
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "482-491",
          "snippet": "void\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolObjPtr\nvirStoragePoolObjListAdd(virStoragePoolObjListPtr pools,\n                         virStoragePoolDefPtr def,\n                         unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    int rc;\n\n    virObjectRWLockWrite(pools);\n\n    if (virStoragePoolObjSourceFindDuplicate(pools, def) < 0)\n        goto error;\n\n    rc = virStoragePoolObjIsDuplicate(pools, def,\n                                      !!(flags & VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE),\n                                      &obj);\n\n    if (rc < 0)\n        goto error;\n    if (rc > 0) {\n        virStoragePoolObjAssignDef(obj, def, flags);\n        virObjectRWUnlock(pools);\n        return obj;\n    }\n\n    if (!(obj = virStoragePoolObjNew()))\n        goto error;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    if (virHashAddEntry(pools->objs, uuidstr, obj) < 0)\n        goto error;\n    virObjectRef(obj);\n\n    if (virHashAddEntry(pools->objsName, def->name, obj) < 0) {\n        virHashRemoveEntry(pools->objs, uuidstr);\n        goto error;\n    }\n    virObjectRef(obj);\n    obj->def = def;\n    virObjectRWUnlock(pools);\n    return obj;\n\n error:\n    virStoragePoolObjEndAPI(&obj);\n    virObjectRWUnlock(pools);\n    return NULL;\n}"
  },
  {
    "function_name": "virStoragePoolObjAssignDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1526-1543",
    "snippet": "static void\nvirStoragePoolObjAssignDef(virStoragePoolObjPtr obj,\n                           virStoragePoolDefPtr def,\n                           unsigned int flags)\n{\n    if (virStoragePoolObjIsActive(obj) ||\n        virStoragePoolObjIsStarting(obj)) {\n        virStoragePoolDefFree(obj->newDef);\n        obj->newDef = def;\n    } else {\n        if (!obj->newDef &&\n            flags & VIR_STORAGE_POOL_OBJ_LIST_ADD_LIVE)\n            obj->newDef = g_steal_pointer(&obj->def);\n\n        virStoragePoolDefFree(obj->def);\n        obj->def = def;\n    }\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolDefFree",
          "args": [
            "obj->def"
          ],
          "line": 1540
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "504-520",
          "snippet": "void\nvirStoragePoolDefFree(virStoragePoolDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    virStoragePoolSourceClear(&def->source);\n\n    VIR_FREE(def->target.path);\n    VIR_FREE(def->target.perms.label);\n    VIR_FREE(def->refresh);\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirStoragePoolDefFree(virStoragePoolDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    virStoragePoolSourceClear(&def->source);\n\n    VIR_FREE(def->target.path);\n    VIR_FREE(def->target.perms.label);\n    VIR_FREE(def->refresh);\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&obj->def"
          ],
          "line": 1538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsStarting",
          "args": [
            "obj"
          ],
          "line": 1532
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsStarting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "324-328",
          "snippet": "bool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1531
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjAssignDef(virStoragePoolObjPtr obj,\n                           virStoragePoolDefPtr def,\n                           unsigned int flags)\n{\n    if (virStoragePoolObjIsActive(obj) ||\n        virStoragePoolObjIsStarting(obj)) {\n        virStoragePoolDefFree(obj->newDef);\n        obj->newDef = def;\n    } else {\n        if (!obj->newDef &&\n            flags & VIR_STORAGE_POOL_OBJ_LIST_ADD_LIVE)\n            obj->newDef = g_steal_pointer(&obj->def);\n\n        virStoragePoolDefFree(obj->def);\n        obj->def = def;\n    }\n}"
  },
  {
    "function_name": "virStoragePoolObjSourceFindDuplicate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1505-1523",
    "snippet": "static int\nvirStoragePoolObjSourceFindDuplicate(virStoragePoolObjListPtr pools,\n                                     virStoragePoolDefPtr def)\n{\n    struct _virStoragePoolObjFindDuplicateData data = {.def = def};\n    virStoragePoolObjPtr obj = NULL;\n\n    obj = virHashSearch(pools->objs, virStoragePoolObjSourceFindDuplicateCb,\n                        &data, NULL);\n\n    if (obj) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Storage source conflict with pool: '%s'\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"Storage source conflict with pool: '%s'\")",
            "obj->def->name"
          ],
          "line": 1516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Storage source conflict with pool: '%s'\""
          ],
          "line": 1517
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashSearch",
          "args": [
            "pools->objs",
            "virStoragePoolObjSourceFindDuplicateCb",
            "&data",
            "NULL"
          ],
          "line": 1512
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "736-761",
          "snippet": "void *virHashSearch(const virHashTable *ctable,\n                    virHashSearcher iter,\n                    const void *data,\n                    void **name)\n{\n    size_t i;\n\n    /* Cast away const for internal detection of misuse.  */\n    virHashTablePtr table = (virHashTablePtr)ctable;\n\n    if (table == NULL || iter == NULL)\n        return NULL;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry;\n        for (entry = table->table[i]; entry; entry = entry->next) {\n            if (iter(entry->payload, entry->name, data)) {\n                if (name)\n                    *name = table->keyCopy(entry->name);\n                return entry->payload;\n            }\n        }\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *virHashSearch(const virHashTable *ctable,\n                    virHashSearcher iter,\n                    const void *data,\n                    void **name)\n{\n    size_t i;\n\n    /* Cast away const for internal detection of misuse.  */\n    virHashTablePtr table = (virHashTablePtr)ctable;\n\n    if (table == NULL || iter == NULL)\n        return NULL;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry;\n        for (entry = table->table[i]; entry; entry = entry->next) {\n            if (iter(entry->payload, entry->name, data)) {\n                if (name)\n                    *name = table->keyCopy(entry->name);\n                return entry->payload;\n            }\n        }\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolObjSourceFindDuplicate(virStoragePoolObjListPtr pools,\n                                     virStoragePoolDefPtr def)\n{\n    struct _virStoragePoolObjFindDuplicateData data = {.def = def};\n    virStoragePoolObjPtr obj = NULL;\n\n    obj = virHashSearch(pools->objs, virStoragePoolObjSourceFindDuplicateCb,\n                        &data, NULL);\n\n    if (obj) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Storage source conflict with pool: '%s'\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolObjSourceFindDuplicateCb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1433-1502",
    "snippet": "static int\nvirStoragePoolObjSourceFindDuplicateCb(const void *payload,\n                                       const void *name G_GNUC_UNUSED,\n                                       const void *opaque)\n{\n    virStoragePoolObjPtr obj = (virStoragePoolObjPtr) payload;\n    struct _virStoragePoolObjFindDuplicateData *data =\n        (struct _virStoragePoolObjFindDuplicateData *) opaque;\n\n    /* Don't match against ourself if re-defining existing pool ! */\n    if (STREQ(obj->def->name, data->def->name))\n        return 0;\n\n    switch ((virStoragePoolType)obj->def->type) {\n    case VIR_STORAGE_POOL_DIR:\n    case VIR_STORAGE_POOL_GLUSTER:\n    case VIR_STORAGE_POOL_NETFS:\n        if (data->def->type == obj->def->type &&\n            virStoragePoolObjSourceMatchTypeDIR(obj, data->def))\n            return 1;\n        break;\n\n    case VIR_STORAGE_POOL_SCSI:\n        if (data->def->type == obj->def->type &&\n            virStoragePoolObjSourceMatchTypeISCSI(obj, data->def))\n            return 1;\n        break;\n\n    case VIR_STORAGE_POOL_ISCSI:\n    case VIR_STORAGE_POOL_ISCSI_DIRECT:\n    case VIR_STORAGE_POOL_FS:\n    case VIR_STORAGE_POOL_LOGICAL:\n    case VIR_STORAGE_POOL_DISK:\n    case VIR_STORAGE_POOL_ZFS:\n        if ((data->def->type == VIR_STORAGE_POOL_ISCSI ||\n             data->def->type == VIR_STORAGE_POOL_ISCSI_DIRECT ||\n             data->def->type == VIR_STORAGE_POOL_FS ||\n             data->def->type == VIR_STORAGE_POOL_LOGICAL ||\n             data->def->type == VIR_STORAGE_POOL_DISK ||\n             data->def->type == VIR_STORAGE_POOL_ZFS) &&\n            virStoragePoolObjSourceMatchTypeDEVICE(obj, data->def))\n            return 1;\n        break;\n\n    case VIR_STORAGE_POOL_SHEEPDOG:\n        if (data->def->type == obj->def->type &&\n            virStoragePoolSourceMatchSingleHost(&obj->def->source,\n                                                &data->def->source))\n            return 1;\n        break;\n\n    case VIR_STORAGE_POOL_MPATH:\n        /* Only one mpath pool is valid per host */\n        if (data->def->type == obj->def->type)\n            return 1;\n        break;\n\n    case VIR_STORAGE_POOL_VSTORAGE:\n        if (data->def->type == obj->def->type &&\n            STREQ(obj->def->source.name, data->def->source.name))\n            return 1;\n        break;\n\n    case VIR_STORAGE_POOL_RBD:\n    case VIR_STORAGE_POOL_LAST:\n        break;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "obj->def->source.name",
            "data->def->source.name"
          ],
          "line": 1492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolSourceMatchSingleHost",
          "args": [
            "&obj->def->source",
            "&data->def->source"
          ],
          "line": 1479
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolSourceMatchSingleHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1282-1294",
          "snippet": "static bool\nvirStoragePoolSourceMatchSingleHost(virStoragePoolSourcePtr poolsrc,\n                                    virStoragePoolSourcePtr defsrc)\n{\n    if (poolsrc->nhost != 1 && defsrc->nhost != 1)\n        return false;\n\n    if (defsrc->hosts[0].port &&\n        poolsrc->hosts[0].port != defsrc->hosts[0].port)\n        return false;\n\n    return STREQ(poolsrc->hosts[0].name, defsrc->hosts[0].name);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic bool\nvirStoragePoolSourceMatchSingleHost(virStoragePoolSourcePtr poolsrc,\n                                    virStoragePoolSourcePtr defsrc)\n{\n    if (poolsrc->nhost != 1 && defsrc->nhost != 1)\n        return false;\n\n    if (defsrc->hosts[0].port &&\n        poolsrc->hosts[0].port != defsrc->hosts[0].port)\n        return false;\n\n    return STREQ(poolsrc->hosts[0].name, defsrc->hosts[0].name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjSourceMatchTypeDEVICE",
          "args": [
            "obj",
            "data->def"
          ],
          "line": 1473
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjSourceMatchTypeDEVICE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1401-1426",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjSourceMatchTypeDEVICE(virStoragePoolObjPtr obj,\n                                       virStoragePoolDefPtr def)\n{\n    virStoragePoolObjPtr matchobj = NULL;\n\n    if (obj->def->type == VIR_STORAGE_POOL_ISCSI) {\n        if (def->type != VIR_STORAGE_POOL_ISCSI)\n            return NULL;\n\n        if ((matchobj = virStoragePoolSourceFindDuplicateDevices(obj, def))) {\n            if (!virStoragePoolSourceISCSIMatch(matchobj, def))\n                return NULL;\n        }\n        return matchobj;\n    }\n\n    if (def->type == VIR_STORAGE_POOL_ISCSI)\n        return NULL;\n\n    /* VIR_STORAGE_POOL_FS\n     * VIR_STORAGE_POOL_LOGICAL\n     * VIR_STORAGE_POOL_DISK\n     * VIR_STORAGE_POOL_ZFS */\n    return virStoragePoolSourceFindDuplicateDevices(obj, def);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjSourceMatchTypeDEVICE(virStoragePoolObjPtr obj,\n                                       virStoragePoolDefPtr def)\n{\n    virStoragePoolObjPtr matchobj = NULL;\n\n    if (obj->def->type == VIR_STORAGE_POOL_ISCSI) {\n        if (def->type != VIR_STORAGE_POOL_ISCSI)\n            return NULL;\n\n        if ((matchobj = virStoragePoolSourceFindDuplicateDevices(obj, def))) {\n            if (!virStoragePoolSourceISCSIMatch(matchobj, def))\n                return NULL;\n        }\n        return matchobj;\n    }\n\n    if (def->type == VIR_STORAGE_POOL_ISCSI)\n        return NULL;\n\n    /* VIR_STORAGE_POOL_FS\n     * VIR_STORAGE_POOL_LOGICAL\n     * VIR_STORAGE_POOL_DISK\n     * VIR_STORAGE_POOL_ZFS */\n    return virStoragePoolSourceFindDuplicateDevices(obj, def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjSourceMatchTypeISCSI",
          "args": [
            "obj",
            "data->def"
          ],
          "line": 1457
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjSourceMatchTypeISCSI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1336-1398",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjSourceMatchTypeISCSI(virStoragePoolObjPtr obj,\n                                      virStoragePoolDefPtr def)\n{\n    virStorageAdapterPtr pool_adapter = &obj->def->source.adapter;\n    virStorageAdapterPtr def_adapter = &def->source.adapter;\n    virStorageAdapterSCSIHostPtr pool_scsi_host;\n    virStorageAdapterSCSIHostPtr def_scsi_host;\n    virStorageAdapterFCHostPtr pool_fchost;\n    virStorageAdapterFCHostPtr def_fchost;\n    unsigned int pool_hostnum;\n    unsigned int def_hostnum;\n    unsigned int scsi_hostnum;\n\n    if (pool_adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST &&\n        def_adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST) {\n        pool_fchost = &pool_adapter->data.fchost;\n        def_fchost = &def_adapter->data.fchost;\n\n        if (STREQ(pool_fchost->wwnn, def_fchost->wwnn) &&\n            STREQ(pool_fchost->wwpn, def_fchost->wwpn))\n            return obj;\n    } else if (pool_adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST &&\n               def_adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST) {\n        pool_scsi_host = &pool_adapter->data.scsi_host;\n        def_scsi_host = &def_adapter->data.scsi_host;\n\n        if (pool_scsi_host->has_parent &&\n            def_scsi_host->has_parent &&\n            matchSCSIAdapterParent(pool_scsi_host, def_scsi_host))\n            return obj;\n\n        if (getSCSIHostNumber(pool_scsi_host, &pool_hostnum) < 0 ||\n            getSCSIHostNumber(def_scsi_host, &def_hostnum) < 0)\n            return NULL;\n        if (pool_hostnum == def_hostnum)\n            return obj;\n    } else if (pool_adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST &&\n               def_adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST) {\n        pool_fchost = &pool_adapter->data.fchost;\n        def_scsi_host = &def_adapter->data.scsi_host;\n\n        /* Get the scsi_hostN for the scsi_host source adapter def */\n        if (getSCSIHostNumber(def_scsi_host, &scsi_hostnum) < 0)\n            return NULL;\n\n        if (matchFCHostToSCSIHost(pool_fchost, scsi_hostnum))\n            return obj;\n\n    } else if (pool_adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST &&\n               def_adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST) {\n        pool_scsi_host = &pool_adapter->data.scsi_host;\n        def_fchost = &def_adapter->data.fchost;\n\n        if (getSCSIHostNumber(pool_scsi_host, &scsi_hostnum) < 0)\n            return NULL;\n\n        if (matchFCHostToSCSIHost(def_fchost, scsi_hostnum))\n            return obj;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjSourceMatchTypeISCSI(virStoragePoolObjPtr obj,\n                                      virStoragePoolDefPtr def)\n{\n    virStorageAdapterPtr pool_adapter = &obj->def->source.adapter;\n    virStorageAdapterPtr def_adapter = &def->source.adapter;\n    virStorageAdapterSCSIHostPtr pool_scsi_host;\n    virStorageAdapterSCSIHostPtr def_scsi_host;\n    virStorageAdapterFCHostPtr pool_fchost;\n    virStorageAdapterFCHostPtr def_fchost;\n    unsigned int pool_hostnum;\n    unsigned int def_hostnum;\n    unsigned int scsi_hostnum;\n\n    if (pool_adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST &&\n        def_adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST) {\n        pool_fchost = &pool_adapter->data.fchost;\n        def_fchost = &def_adapter->data.fchost;\n\n        if (STREQ(pool_fchost->wwnn, def_fchost->wwnn) &&\n            STREQ(pool_fchost->wwpn, def_fchost->wwpn))\n            return obj;\n    } else if (pool_adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST &&\n               def_adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST) {\n        pool_scsi_host = &pool_adapter->data.scsi_host;\n        def_scsi_host = &def_adapter->data.scsi_host;\n\n        if (pool_scsi_host->has_parent &&\n            def_scsi_host->has_parent &&\n            matchSCSIAdapterParent(pool_scsi_host, def_scsi_host))\n            return obj;\n\n        if (getSCSIHostNumber(pool_scsi_host, &pool_hostnum) < 0 ||\n            getSCSIHostNumber(def_scsi_host, &def_hostnum) < 0)\n            return NULL;\n        if (pool_hostnum == def_hostnum)\n            return obj;\n    } else if (pool_adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST &&\n               def_adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST) {\n        pool_fchost = &pool_adapter->data.fchost;\n        def_scsi_host = &def_adapter->data.scsi_host;\n\n        /* Get the scsi_hostN for the scsi_host source adapter def */\n        if (getSCSIHostNumber(def_scsi_host, &scsi_hostnum) < 0)\n            return NULL;\n\n        if (matchFCHostToSCSIHost(pool_fchost, scsi_hostnum))\n            return obj;\n\n    } else if (pool_adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST &&\n               def_adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST) {\n        pool_scsi_host = &pool_adapter->data.scsi_host;\n        def_fchost = &def_adapter->data.fchost;\n\n        if (getSCSIHostNumber(pool_scsi_host, &scsi_hostnum) < 0)\n            return NULL;\n\n        if (matchFCHostToSCSIHost(def_fchost, scsi_hostnum))\n            return obj;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjSourceMatchTypeDIR",
          "args": [
            "obj",
            "data->def"
          ],
          "line": 1451
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjSourceMatchTypeDIR",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1312-1333",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjSourceMatchTypeDIR(virStoragePoolObjPtr obj,\n                                    virStoragePoolDefPtr def)\n{\n    if (obj->def->type == VIR_STORAGE_POOL_DIR) {\n        if (STREQ(obj->def->target.path, def->target.path))\n            return obj;\n    } else if (obj->def->type == VIR_STORAGE_POOL_GLUSTER) {\n        if (STREQ(obj->def->source.name, def->source.name) &&\n            STREQ_NULLABLE(obj->def->source.dir, def->source.dir) &&\n            virStoragePoolSourceMatchSingleHost(&obj->def->source,\n                                                &def->source))\n            return obj;\n    } else if (obj->def->type == VIR_STORAGE_POOL_NETFS) {\n        if (STREQ(obj->def->source.dir, def->source.dir) &&\n            virStoragePoolSourceMatchSingleHost(&obj->def->source,\n                                                &def->source))\n            return obj;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjSourceMatchTypeDIR(virStoragePoolObjPtr obj,\n                                    virStoragePoolDefPtr def)\n{\n    if (obj->def->type == VIR_STORAGE_POOL_DIR) {\n        if (STREQ(obj->def->target.path, def->target.path))\n            return obj;\n    } else if (obj->def->type == VIR_STORAGE_POOL_GLUSTER) {\n        if (STREQ(obj->def->source.name, def->source.name) &&\n            STREQ_NULLABLE(obj->def->source.dir, def->source.dir) &&\n            virStoragePoolSourceMatchSingleHost(&obj->def->source,\n                                                &def->source))\n            return obj;\n    } else if (obj->def->type == VIR_STORAGE_POOL_NETFS) {\n        if (STREQ(obj->def->source.dir, def->source.dir) &&\n            virStoragePoolSourceMatchSingleHost(&obj->def->source,\n                                                &def->source))\n            return obj;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "obj->def->name",
            "data->def->name"
          ],
          "line": 1443
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nstatic int\nvirStoragePoolObjSourceFindDuplicateCb(const void *payload,\n                                       const void *name G_GNUC_UNUSED,\n                                       const void *opaque)\n{\n    virStoragePoolObjPtr obj = (virStoragePoolObjPtr) payload;\n    struct _virStoragePoolObjFindDuplicateData *data =\n        (struct _virStoragePoolObjFindDuplicateData *) opaque;\n\n    /* Don't match against ourself if re-defining existing pool ! */\n    if (STREQ(obj->def->name, data->def->name))\n        return 0;\n\n    switch ((virStoragePoolType)obj->def->type) {\n    case VIR_STORAGE_POOL_DIR:\n    case VIR_STORAGE_POOL_GLUSTER:\n    case VIR_STORAGE_POOL_NETFS:\n        if (data->def->type == obj->def->type &&\n            virStoragePoolObjSourceMatchTypeDIR(obj, data->def))\n            return 1;\n        break;\n\n    case VIR_STORAGE_POOL_SCSI:\n        if (data->def->type == obj->def->type &&\n            virStoragePoolObjSourceMatchTypeISCSI(obj, data->def))\n            return 1;\n        break;\n\n    case VIR_STORAGE_POOL_ISCSI:\n    case VIR_STORAGE_POOL_ISCSI_DIRECT:\n    case VIR_STORAGE_POOL_FS:\n    case VIR_STORAGE_POOL_LOGICAL:\n    case VIR_STORAGE_POOL_DISK:\n    case VIR_STORAGE_POOL_ZFS:\n        if ((data->def->type == VIR_STORAGE_POOL_ISCSI ||\n             data->def->type == VIR_STORAGE_POOL_ISCSI_DIRECT ||\n             data->def->type == VIR_STORAGE_POOL_FS ||\n             data->def->type == VIR_STORAGE_POOL_LOGICAL ||\n             data->def->type == VIR_STORAGE_POOL_DISK ||\n             data->def->type == VIR_STORAGE_POOL_ZFS) &&\n            virStoragePoolObjSourceMatchTypeDEVICE(obj, data->def))\n            return 1;\n        break;\n\n    case VIR_STORAGE_POOL_SHEEPDOG:\n        if (data->def->type == obj->def->type &&\n            virStoragePoolSourceMatchSingleHost(&obj->def->source,\n                                                &data->def->source))\n            return 1;\n        break;\n\n    case VIR_STORAGE_POOL_MPATH:\n        /* Only one mpath pool is valid per host */\n        if (data->def->type == obj->def->type)\n            return 1;\n        break;\n\n    case VIR_STORAGE_POOL_VSTORAGE:\n        if (data->def->type == obj->def->type &&\n            STREQ(obj->def->source.name, data->def->source.name))\n            return 1;\n        break;\n\n    case VIR_STORAGE_POOL_RBD:\n    case VIR_STORAGE_POOL_LAST:\n        break;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolObjSourceMatchTypeDEVICE",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1401-1426",
    "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjSourceMatchTypeDEVICE(virStoragePoolObjPtr obj,\n                                       virStoragePoolDefPtr def)\n{\n    virStoragePoolObjPtr matchobj = NULL;\n\n    if (obj->def->type == VIR_STORAGE_POOL_ISCSI) {\n        if (def->type != VIR_STORAGE_POOL_ISCSI)\n            return NULL;\n\n        if ((matchobj = virStoragePoolSourceFindDuplicateDevices(obj, def))) {\n            if (!virStoragePoolSourceISCSIMatch(matchobj, def))\n                return NULL;\n        }\n        return matchobj;\n    }\n\n    if (def->type == VIR_STORAGE_POOL_ISCSI)\n        return NULL;\n\n    /* VIR_STORAGE_POOL_FS\n     * VIR_STORAGE_POOL_LOGICAL\n     * VIR_STORAGE_POOL_DISK\n     * VIR_STORAGE_POOL_ZFS */\n    return virStoragePoolSourceFindDuplicateDevices(obj, def);\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolSourceFindDuplicateDevices",
          "args": [
            "obj",
            "def"
          ],
          "line": 1425
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolSourceFindDuplicateDevices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "612-626",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolSourceFindDuplicateDevices(virStoragePoolObjPtr obj,\n                                         virStoragePoolDefPtr def)\n{\n    size_t i, j;\n\n    for (i = 0; i < obj->def->source.ndevice; i++) {\n        for (j = 0; j < def->source.ndevice; j++) {\n            if (STREQ(obj->def->source.devices[i].path, def->source.devices[j].path))\n                return obj;\n        }\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolSourceFindDuplicateDevices(virStoragePoolObjPtr obj,\n                                         virStoragePoolDefPtr def)\n{\n    size_t i, j;\n\n    for (i = 0; i < obj->def->source.ndevice; i++) {\n        for (j = 0; j < def->source.ndevice; j++) {\n            if (STREQ(obj->def->source.devices[i].path, def->source.devices[j].path))\n                return obj;\n        }\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolSourceISCSIMatch",
          "args": [
            "matchobj",
            "def"
          ],
          "line": 1412
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolSourceISCSIMatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1297-1309",
          "snippet": "static bool\nvirStoragePoolSourceISCSIMatch(virStoragePoolObjPtr obj,\n                               virStoragePoolDefPtr def)\n{\n    virStoragePoolSourcePtr poolsrc = &obj->def->source;\n    virStoragePoolSourcePtr defsrc = &def->source;\n\n    /* NB: Do not check the source host name */\n    if (STRNEQ_NULLABLE(poolsrc->initiator.iqn, defsrc->initiator.iqn))\n        return false;\n\n    return true;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic bool\nvirStoragePoolSourceISCSIMatch(virStoragePoolObjPtr obj,\n                               virStoragePoolDefPtr def)\n{\n    virStoragePoolSourcePtr poolsrc = &obj->def->source;\n    virStoragePoolSourcePtr defsrc = &def->source;\n\n    /* NB: Do not check the source host name */\n    if (STRNEQ_NULLABLE(poolsrc->initiator.iqn, defsrc->initiator.iqn))\n        return false;\n\n    return true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjSourceMatchTypeDEVICE(virStoragePoolObjPtr obj,\n                                       virStoragePoolDefPtr def)\n{\n    virStoragePoolObjPtr matchobj = NULL;\n\n    if (obj->def->type == VIR_STORAGE_POOL_ISCSI) {\n        if (def->type != VIR_STORAGE_POOL_ISCSI)\n            return NULL;\n\n        if ((matchobj = virStoragePoolSourceFindDuplicateDevices(obj, def))) {\n            if (!virStoragePoolSourceISCSIMatch(matchobj, def))\n                return NULL;\n        }\n        return matchobj;\n    }\n\n    if (def->type == VIR_STORAGE_POOL_ISCSI)\n        return NULL;\n\n    /* VIR_STORAGE_POOL_FS\n     * VIR_STORAGE_POOL_LOGICAL\n     * VIR_STORAGE_POOL_DISK\n     * VIR_STORAGE_POOL_ZFS */\n    return virStoragePoolSourceFindDuplicateDevices(obj, def);\n}"
  },
  {
    "function_name": "virStoragePoolObjSourceMatchTypeISCSI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1336-1398",
    "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjSourceMatchTypeISCSI(virStoragePoolObjPtr obj,\n                                      virStoragePoolDefPtr def)\n{\n    virStorageAdapterPtr pool_adapter = &obj->def->source.adapter;\n    virStorageAdapterPtr def_adapter = &def->source.adapter;\n    virStorageAdapterSCSIHostPtr pool_scsi_host;\n    virStorageAdapterSCSIHostPtr def_scsi_host;\n    virStorageAdapterFCHostPtr pool_fchost;\n    virStorageAdapterFCHostPtr def_fchost;\n    unsigned int pool_hostnum;\n    unsigned int def_hostnum;\n    unsigned int scsi_hostnum;\n\n    if (pool_adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST &&\n        def_adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST) {\n        pool_fchost = &pool_adapter->data.fchost;\n        def_fchost = &def_adapter->data.fchost;\n\n        if (STREQ(pool_fchost->wwnn, def_fchost->wwnn) &&\n            STREQ(pool_fchost->wwpn, def_fchost->wwpn))\n            return obj;\n    } else if (pool_adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST &&\n               def_adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST) {\n        pool_scsi_host = &pool_adapter->data.scsi_host;\n        def_scsi_host = &def_adapter->data.scsi_host;\n\n        if (pool_scsi_host->has_parent &&\n            def_scsi_host->has_parent &&\n            matchSCSIAdapterParent(pool_scsi_host, def_scsi_host))\n            return obj;\n\n        if (getSCSIHostNumber(pool_scsi_host, &pool_hostnum) < 0 ||\n            getSCSIHostNumber(def_scsi_host, &def_hostnum) < 0)\n            return NULL;\n        if (pool_hostnum == def_hostnum)\n            return obj;\n    } else if (pool_adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST &&\n               def_adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST) {\n        pool_fchost = &pool_adapter->data.fchost;\n        def_scsi_host = &def_adapter->data.scsi_host;\n\n        /* Get the scsi_hostN for the scsi_host source adapter def */\n        if (getSCSIHostNumber(def_scsi_host, &scsi_hostnum) < 0)\n            return NULL;\n\n        if (matchFCHostToSCSIHost(pool_fchost, scsi_hostnum))\n            return obj;\n\n    } else if (pool_adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST &&\n               def_adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST) {\n        pool_scsi_host = &pool_adapter->data.scsi_host;\n        def_fchost = &def_adapter->data.fchost;\n\n        if (getSCSIHostNumber(pool_scsi_host, &scsi_hostnum) < 0)\n            return NULL;\n\n        if (matchFCHostToSCSIHost(def_fchost, scsi_hostnum))\n            return obj;\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "matchFCHostToSCSIHost",
          "args": [
            "def_fchost",
            "scsi_hostnum"
          ],
          "line": 1393
        },
        "resolved": true,
        "details": {
          "function_name": "matchFCHostToSCSIHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1195-1261",
          "snippet": "static bool\nmatchFCHostToSCSIHost(virStorageAdapterFCHostPtr fchost,\n                      unsigned int scsi_hostnum)\n{\n    virConnectPtr conn = NULL;\n    bool ret = false;\n    char *name = NULL;\n    char *scsi_host_name = NULL;\n    char *parent_name = NULL;\n\n    /* If we have a parent defined, get its hostnum, and compare to the\n     * scsi_hostnum. If they are the same, then we have a match\n     */\n    if (fchost->parent &&\n        virStorageIsSameHostnum(fchost->parent, scsi_hostnum))\n        return true;\n\n    /* If we find an fc adapter name, then either libvirt created a vHBA\n     * for this fc_host or a 'virsh nodedev-create' generated a vHBA.\n     */\n    if ((name = virVHBAGetHostByWWN(NULL, fchost->wwnn, fchost->wwpn))) {\n\n        /* Get the scsi_hostN for the vHBA in order to see if it\n         * matches our scsi_hostnum\n         */\n        if (virStorageIsSameHostnum(name, scsi_hostnum)) {\n            ret = true;\n            goto cleanup;\n        }\n\n        /* We weren't provided a parent, so we have to query the node\n         * device driver in order to ascertain the parent of the vHBA.\n         * If the parent fc_hostnum is the same as the scsi_hostnum, we\n         * have a match.\n         */\n        if (!fchost->parent &&\n            (conn = virGetConnectNodeDev())) {\n            scsi_host_name = g_strdup_printf(\"scsi_%s\", name);\n            if ((parent_name = virNodeDeviceGetParentName(conn,\n                                                          scsi_host_name))) {\n                if (virStorageIsSameHostnum(parent_name, scsi_hostnum)) {\n                    ret = true;\n                    goto cleanup;\n                }\n            } else {\n                /* Throw away the error and fall through */\n                virResetLastError();\n                VIR_DEBUG(\"Could not determine parent vHBA\");\n            }\n        }\n    }\n\n    /* NB: Lack of a name means that this vHBA hasn't yet been created,\n     *     which means our scsi_host cannot be using the vHBA. Furthermore,\n     *     lack of a provided parent means libvirt is going to choose the\n     *     \"best\" fc_host capable adapter based on availability. That could\n     *     conflict with an existing scsi_host definition, but there's no\n     *     way to know that now.\n     */\n\n cleanup:\n    VIR_FREE(name);\n    VIR_FREE(parent_name);\n    VIR_FREE(scsi_host_name);\n    virConnectClose(conn);\n    return ret;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic bool\nmatchFCHostToSCSIHost(virStorageAdapterFCHostPtr fchost,\n                      unsigned int scsi_hostnum)\n{\n    virConnectPtr conn = NULL;\n    bool ret = false;\n    char *name = NULL;\n    char *scsi_host_name = NULL;\n    char *parent_name = NULL;\n\n    /* If we have a parent defined, get its hostnum, and compare to the\n     * scsi_hostnum. If they are the same, then we have a match\n     */\n    if (fchost->parent &&\n        virStorageIsSameHostnum(fchost->parent, scsi_hostnum))\n        return true;\n\n    /* If we find an fc adapter name, then either libvirt created a vHBA\n     * for this fc_host or a 'virsh nodedev-create' generated a vHBA.\n     */\n    if ((name = virVHBAGetHostByWWN(NULL, fchost->wwnn, fchost->wwpn))) {\n\n        /* Get the scsi_hostN for the vHBA in order to see if it\n         * matches our scsi_hostnum\n         */\n        if (virStorageIsSameHostnum(name, scsi_hostnum)) {\n            ret = true;\n            goto cleanup;\n        }\n\n        /* We weren't provided a parent, so we have to query the node\n         * device driver in order to ascertain the parent of the vHBA.\n         * If the parent fc_hostnum is the same as the scsi_hostnum, we\n         * have a match.\n         */\n        if (!fchost->parent &&\n            (conn = virGetConnectNodeDev())) {\n            scsi_host_name = g_strdup_printf(\"scsi_%s\", name);\n            if ((parent_name = virNodeDeviceGetParentName(conn,\n                                                          scsi_host_name))) {\n                if (virStorageIsSameHostnum(parent_name, scsi_hostnum)) {\n                    ret = true;\n                    goto cleanup;\n                }\n            } else {\n                /* Throw away the error and fall through */\n                virResetLastError();\n                VIR_DEBUG(\"Could not determine parent vHBA\");\n            }\n        }\n    }\n\n    /* NB: Lack of a name means that this vHBA hasn't yet been created,\n     *     which means our scsi_host cannot be using the vHBA. Furthermore,\n     *     lack of a provided parent means libvirt is going to choose the\n     *     \"best\" fc_host capable adapter based on availability. That could\n     *     conflict with an existing scsi_host definition, but there's no\n     *     way to know that now.\n     */\n\n cleanup:\n    VIR_FREE(name);\n    VIR_FREE(parent_name);\n    VIR_FREE(scsi_host_name);\n    virConnectClose(conn);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getSCSIHostNumber",
          "args": [
            "pool_scsi_host",
            "&scsi_hostnum"
          ],
          "line": 1390
        },
        "resolved": true,
        "details": {
          "function_name": "getSCSIHostNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1138-1169",
          "snippet": "static int\ngetSCSIHostNumber(virStorageAdapterSCSIHostPtr scsi_host,\n                  unsigned int *hostnum)\n{\n    int ret = -1;\n    unsigned int num;\n    char *name = NULL;\n\n    if (scsi_host->has_parent) {\n        virPCIDeviceAddressPtr addr = &scsi_host->parentaddr;\n        unsigned int unique_id = scsi_host->unique_id;\n\n        if (!(name = virSCSIHostGetNameByParentaddr(addr->domain,\n                                                    addr->bus,\n                                                    addr->slot,\n                                                    addr->function,\n                                                    unique_id)))\n            goto cleanup;\n        if (virSCSIHostGetNumber(name, &num) < 0)\n            goto cleanup;\n    } else {\n        if (virSCSIHostGetNumber(scsi_host->name, &num) < 0)\n            goto cleanup;\n    }\n\n    *hostnum = num;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(name);\n    return ret;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\ngetSCSIHostNumber(virStorageAdapterSCSIHostPtr scsi_host,\n                  unsigned int *hostnum)\n{\n    int ret = -1;\n    unsigned int num;\n    char *name = NULL;\n\n    if (scsi_host->has_parent) {\n        virPCIDeviceAddressPtr addr = &scsi_host->parentaddr;\n        unsigned int unique_id = scsi_host->unique_id;\n\n        if (!(name = virSCSIHostGetNameByParentaddr(addr->domain,\n                                                    addr->bus,\n                                                    addr->slot,\n                                                    addr->function,\n                                                    unique_id)))\n            goto cleanup;\n        if (virSCSIHostGetNumber(name, &num) < 0)\n            goto cleanup;\n    } else {\n        if (virSCSIHostGetNumber(scsi_host->name, &num) < 0)\n            goto cleanup;\n    }\n\n    *hostnum = num;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(name);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "matchSCSIAdapterParent",
          "args": [
            "pool_scsi_host",
            "def_scsi_host"
          ],
          "line": 1365
        },
        "resolved": true,
        "details": {
          "function_name": "matchSCSIAdapterParent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1264-1279",
          "snippet": "static bool\nmatchSCSIAdapterParent(virStorageAdapterSCSIHostPtr pool_scsi_host,\n                       virStorageAdapterSCSIHostPtr def_scsi_host)\n{\n    virPCIDeviceAddressPtr pooladdr = &pool_scsi_host->parentaddr;\n    virPCIDeviceAddressPtr defaddr = &def_scsi_host->parentaddr;\n\n    if (pooladdr->domain == defaddr->domain &&\n        pooladdr->bus == defaddr->bus &&\n        pooladdr->slot == defaddr->slot &&\n        pooladdr->function == defaddr->function &&\n        pool_scsi_host->unique_id == def_scsi_host->unique_id)\n        return true;\n\n    return false;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic bool\nmatchSCSIAdapterParent(virStorageAdapterSCSIHostPtr pool_scsi_host,\n                       virStorageAdapterSCSIHostPtr def_scsi_host)\n{\n    virPCIDeviceAddressPtr pooladdr = &pool_scsi_host->parentaddr;\n    virPCIDeviceAddressPtr defaddr = &def_scsi_host->parentaddr;\n\n    if (pooladdr->domain == defaddr->domain &&\n        pooladdr->bus == defaddr->bus &&\n        pooladdr->slot == defaddr->slot &&\n        pooladdr->function == defaddr->function &&\n        pool_scsi_host->unique_id == def_scsi_host->unique_id)\n        return true;\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "pool_fchost->wwpn",
            "def_fchost->wwpn"
          ],
          "line": 1356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "pool_fchost->wwnn",
            "def_fchost->wwnn"
          ],
          "line": 1355
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjSourceMatchTypeISCSI(virStoragePoolObjPtr obj,\n                                      virStoragePoolDefPtr def)\n{\n    virStorageAdapterPtr pool_adapter = &obj->def->source.adapter;\n    virStorageAdapterPtr def_adapter = &def->source.adapter;\n    virStorageAdapterSCSIHostPtr pool_scsi_host;\n    virStorageAdapterSCSIHostPtr def_scsi_host;\n    virStorageAdapterFCHostPtr pool_fchost;\n    virStorageAdapterFCHostPtr def_fchost;\n    unsigned int pool_hostnum;\n    unsigned int def_hostnum;\n    unsigned int scsi_hostnum;\n\n    if (pool_adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST &&\n        def_adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST) {\n        pool_fchost = &pool_adapter->data.fchost;\n        def_fchost = &def_adapter->data.fchost;\n\n        if (STREQ(pool_fchost->wwnn, def_fchost->wwnn) &&\n            STREQ(pool_fchost->wwpn, def_fchost->wwpn))\n            return obj;\n    } else if (pool_adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST &&\n               def_adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST) {\n        pool_scsi_host = &pool_adapter->data.scsi_host;\n        def_scsi_host = &def_adapter->data.scsi_host;\n\n        if (pool_scsi_host->has_parent &&\n            def_scsi_host->has_parent &&\n            matchSCSIAdapterParent(pool_scsi_host, def_scsi_host))\n            return obj;\n\n        if (getSCSIHostNumber(pool_scsi_host, &pool_hostnum) < 0 ||\n            getSCSIHostNumber(def_scsi_host, &def_hostnum) < 0)\n            return NULL;\n        if (pool_hostnum == def_hostnum)\n            return obj;\n    } else if (pool_adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST &&\n               def_adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST) {\n        pool_fchost = &pool_adapter->data.fchost;\n        def_scsi_host = &def_adapter->data.scsi_host;\n\n        /* Get the scsi_hostN for the scsi_host source adapter def */\n        if (getSCSIHostNumber(def_scsi_host, &scsi_hostnum) < 0)\n            return NULL;\n\n        if (matchFCHostToSCSIHost(pool_fchost, scsi_hostnum))\n            return obj;\n\n    } else if (pool_adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST &&\n               def_adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST) {\n        pool_scsi_host = &pool_adapter->data.scsi_host;\n        def_fchost = &def_adapter->data.fchost;\n\n        if (getSCSIHostNumber(pool_scsi_host, &scsi_hostnum) < 0)\n            return NULL;\n\n        if (matchFCHostToSCSIHost(def_fchost, scsi_hostnum))\n            return obj;\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "virStoragePoolObjSourceMatchTypeDIR",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1312-1333",
    "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjSourceMatchTypeDIR(virStoragePoolObjPtr obj,\n                                    virStoragePoolDefPtr def)\n{\n    if (obj->def->type == VIR_STORAGE_POOL_DIR) {\n        if (STREQ(obj->def->target.path, def->target.path))\n            return obj;\n    } else if (obj->def->type == VIR_STORAGE_POOL_GLUSTER) {\n        if (STREQ(obj->def->source.name, def->source.name) &&\n            STREQ_NULLABLE(obj->def->source.dir, def->source.dir) &&\n            virStoragePoolSourceMatchSingleHost(&obj->def->source,\n                                                &def->source))\n            return obj;\n    } else if (obj->def->type == VIR_STORAGE_POOL_NETFS) {\n        if (STREQ(obj->def->source.dir, def->source.dir) &&\n            virStoragePoolSourceMatchSingleHost(&obj->def->source,\n                                                &def->source))\n            return obj;\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolSourceMatchSingleHost",
          "args": [
            "&obj->def->source",
            "&def->source"
          ],
          "line": 1327
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolSourceMatchSingleHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1282-1294",
          "snippet": "static bool\nvirStoragePoolSourceMatchSingleHost(virStoragePoolSourcePtr poolsrc,\n                                    virStoragePoolSourcePtr defsrc)\n{\n    if (poolsrc->nhost != 1 && defsrc->nhost != 1)\n        return false;\n\n    if (defsrc->hosts[0].port &&\n        poolsrc->hosts[0].port != defsrc->hosts[0].port)\n        return false;\n\n    return STREQ(poolsrc->hosts[0].name, defsrc->hosts[0].name);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic bool\nvirStoragePoolSourceMatchSingleHost(virStoragePoolSourcePtr poolsrc,\n                                    virStoragePoolSourcePtr defsrc)\n{\n    if (poolsrc->nhost != 1 && defsrc->nhost != 1)\n        return false;\n\n    if (defsrc->hosts[0].port &&\n        poolsrc->hosts[0].port != defsrc->hosts[0].port)\n        return false;\n\n    return STREQ(poolsrc->hosts[0].name, defsrc->hosts[0].name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "obj->def->source.dir",
            "def->source.dir"
          ],
          "line": 1326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "obj->def->source.dir",
            "def->source.dir"
          ],
          "line": 1321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "obj->def->source.name",
            "def->source.name"
          ],
          "line": 1320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "obj->def->target.path",
            "def->target.path"
          ],
          "line": 1317
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjSourceMatchTypeDIR(virStoragePoolObjPtr obj,\n                                    virStoragePoolDefPtr def)\n{\n    if (obj->def->type == VIR_STORAGE_POOL_DIR) {\n        if (STREQ(obj->def->target.path, def->target.path))\n            return obj;\n    } else if (obj->def->type == VIR_STORAGE_POOL_GLUSTER) {\n        if (STREQ(obj->def->source.name, def->source.name) &&\n            STREQ_NULLABLE(obj->def->source.dir, def->source.dir) &&\n            virStoragePoolSourceMatchSingleHost(&obj->def->source,\n                                                &def->source))\n            return obj;\n    } else if (obj->def->type == VIR_STORAGE_POOL_NETFS) {\n        if (STREQ(obj->def->source.dir, def->source.dir) &&\n            virStoragePoolSourceMatchSingleHost(&obj->def->source,\n                                                &def->source))\n            return obj;\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "virStoragePoolSourceISCSIMatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1297-1309",
    "snippet": "static bool\nvirStoragePoolSourceISCSIMatch(virStoragePoolObjPtr obj,\n                               virStoragePoolDefPtr def)\n{\n    virStoragePoolSourcePtr poolsrc = &obj->def->source;\n    virStoragePoolSourcePtr defsrc = &def->source;\n\n    /* NB: Do not check the source host name */\n    if (STRNEQ_NULLABLE(poolsrc->initiator.iqn, defsrc->initiator.iqn))\n        return false;\n\n    return true;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STRNEQ_NULLABLE",
          "args": [
            "poolsrc->initiator.iqn",
            "defsrc->initiator.iqn"
          ],
          "line": 1305
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic bool\nvirStoragePoolSourceISCSIMatch(virStoragePoolObjPtr obj,\n                               virStoragePoolDefPtr def)\n{\n    virStoragePoolSourcePtr poolsrc = &obj->def->source;\n    virStoragePoolSourcePtr defsrc = &def->source;\n\n    /* NB: Do not check the source host name */\n    if (STRNEQ_NULLABLE(poolsrc->initiator.iqn, defsrc->initiator.iqn))\n        return false;\n\n    return true;\n}"
  },
  {
    "function_name": "virStoragePoolSourceMatchSingleHost",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1282-1294",
    "snippet": "static bool\nvirStoragePoolSourceMatchSingleHost(virStoragePoolSourcePtr poolsrc,\n                                    virStoragePoolSourcePtr defsrc)\n{\n    if (poolsrc->nhost != 1 && defsrc->nhost != 1)\n        return false;\n\n    if (defsrc->hosts[0].port &&\n        poolsrc->hosts[0].port != defsrc->hosts[0].port)\n        return false;\n\n    return STREQ(poolsrc->hosts[0].name, defsrc->hosts[0].name);\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "poolsrc->hosts[0].name",
            "defsrc->hosts[0].name"
          ],
          "line": 1293
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic bool\nvirStoragePoolSourceMatchSingleHost(virStoragePoolSourcePtr poolsrc,\n                                    virStoragePoolSourcePtr defsrc)\n{\n    if (poolsrc->nhost != 1 && defsrc->nhost != 1)\n        return false;\n\n    if (defsrc->hosts[0].port &&\n        poolsrc->hosts[0].port != defsrc->hosts[0].port)\n        return false;\n\n    return STREQ(poolsrc->hosts[0].name, defsrc->hosts[0].name);\n}"
  },
  {
    "function_name": "matchSCSIAdapterParent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1264-1279",
    "snippet": "static bool\nmatchSCSIAdapterParent(virStorageAdapterSCSIHostPtr pool_scsi_host,\n                       virStorageAdapterSCSIHostPtr def_scsi_host)\n{\n    virPCIDeviceAddressPtr pooladdr = &pool_scsi_host->parentaddr;\n    virPCIDeviceAddressPtr defaddr = &def_scsi_host->parentaddr;\n\n    if (pooladdr->domain == defaddr->domain &&\n        pooladdr->bus == defaddr->bus &&\n        pooladdr->slot == defaddr->slot &&\n        pooladdr->function == defaddr->function &&\n        pool_scsi_host->unique_id == def_scsi_host->unique_id)\n        return true;\n\n    return false;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic bool\nmatchSCSIAdapterParent(virStorageAdapterSCSIHostPtr pool_scsi_host,\n                       virStorageAdapterSCSIHostPtr def_scsi_host)\n{\n    virPCIDeviceAddressPtr pooladdr = &pool_scsi_host->parentaddr;\n    virPCIDeviceAddressPtr defaddr = &def_scsi_host->parentaddr;\n\n    if (pooladdr->domain == defaddr->domain &&\n        pooladdr->bus == defaddr->bus &&\n        pooladdr->slot == defaddr->slot &&\n        pooladdr->function == defaddr->function &&\n        pool_scsi_host->unique_id == def_scsi_host->unique_id)\n        return true;\n\n    return false;\n}"
  },
  {
    "function_name": "matchFCHostToSCSIHost",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1195-1261",
    "snippet": "static bool\nmatchFCHostToSCSIHost(virStorageAdapterFCHostPtr fchost,\n                      unsigned int scsi_hostnum)\n{\n    virConnectPtr conn = NULL;\n    bool ret = false;\n    char *name = NULL;\n    char *scsi_host_name = NULL;\n    char *parent_name = NULL;\n\n    /* If we have a parent defined, get its hostnum, and compare to the\n     * scsi_hostnum. If they are the same, then we have a match\n     */\n    if (fchost->parent &&\n        virStorageIsSameHostnum(fchost->parent, scsi_hostnum))\n        return true;\n\n    /* If we find an fc adapter name, then either libvirt created a vHBA\n     * for this fc_host or a 'virsh nodedev-create' generated a vHBA.\n     */\n    if ((name = virVHBAGetHostByWWN(NULL, fchost->wwnn, fchost->wwpn))) {\n\n        /* Get the scsi_hostN for the vHBA in order to see if it\n         * matches our scsi_hostnum\n         */\n        if (virStorageIsSameHostnum(name, scsi_hostnum)) {\n            ret = true;\n            goto cleanup;\n        }\n\n        /* We weren't provided a parent, so we have to query the node\n         * device driver in order to ascertain the parent of the vHBA.\n         * If the parent fc_hostnum is the same as the scsi_hostnum, we\n         * have a match.\n         */\n        if (!fchost->parent &&\n            (conn = virGetConnectNodeDev())) {\n            scsi_host_name = g_strdup_printf(\"scsi_%s\", name);\n            if ((parent_name = virNodeDeviceGetParentName(conn,\n                                                          scsi_host_name))) {\n                if (virStorageIsSameHostnum(parent_name, scsi_hostnum)) {\n                    ret = true;\n                    goto cleanup;\n                }\n            } else {\n                /* Throw away the error and fall through */\n                virResetLastError();\n                VIR_DEBUG(\"Could not determine parent vHBA\");\n            }\n        }\n    }\n\n    /* NB: Lack of a name means that this vHBA hasn't yet been created,\n     *     which means our scsi_host cannot be using the vHBA. Furthermore,\n     *     lack of a provided parent means libvirt is going to choose the\n     *     \"best\" fc_host capable adapter based on availability. That could\n     *     conflict with an existing scsi_host definition, but there's no\n     *     way to know that now.\n     */\n\n cleanup:\n    VIR_FREE(name);\n    VIR_FREE(parent_name);\n    VIR_FREE(scsi_host_name);\n    virConnectClose(conn);\n    return ret;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConnectClose",
          "args": [
            "conn"
          ],
          "line": 1259
        },
        "resolved": true,
        "details": {
          "function_name": "virConnectClose",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "1271-1283",
          "snippet": "int\nvirConnectClose(virConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (!virObjectUnref(conn))\n        return 0;\n    return 1;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirConnectClose(virConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (!virObjectUnref(conn))\n        return 0;\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "scsi_host_name"
          ],
          "line": 1258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "parent_name"
          ],
          "line": 1257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "name"
          ],
          "line": 1256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Could not determine parent vHBA\""
          ],
          "line": 1242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1241
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageIsSameHostnum",
          "args": [
            "parent_name",
            "scsi_hostnum"
          ],
          "line": 1235
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageIsSameHostnum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "1172-1183",
          "snippet": "static bool\nvirStorageIsSameHostnum(const char *name,\n                        unsigned int scsi_hostnum)\n{\n    unsigned int fc_hostnum;\n\n    if (virSCSIHostGetNumber(name, &fc_hostnum) == 0 &&\n        scsi_hostnum == fc_hostnum)\n        return true;\n\n    return false;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic bool\nvirStorageIsSameHostnum(const char *name,\n                        unsigned int scsi_hostnum)\n{\n    unsigned int fc_hostnum;\n\n    if (virSCSIHostGetNumber(name, &fc_hostnum) == 0 &&\n        scsi_hostnum == fc_hostnum)\n        return true;\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceGetParentName",
          "args": [
            "conn",
            "scsi_host_name"
          ],
          "line": 1233
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceGetParentName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/node_device_util.c",
          "lines": "44-62",
          "snippet": "char *\nvirNodeDeviceGetParentName(virConnectPtr conn,\n                           const char *nodedev_name)\n{\n    virNodeDevicePtr device = NULL;\n    char *parent;\n\n    if (!(device = virNodeDeviceLookupByName(conn, nodedev_name))) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Cannot find '%s' in node device database\"),\n                       nodedev_name);\n        return NULL;\n    }\n\n    parent = g_strdup(virNodeDeviceGetParent(device));\n    virObjectUnref(device);\n\n    return parent;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"node_device_util.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"node_device_util.h\"\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirNodeDeviceGetParentName(virConnectPtr conn,\n                           const char *nodedev_name)\n{\n    virNodeDevicePtr device = NULL;\n    char *parent;\n\n    if (!(device = virNodeDeviceLookupByName(conn, nodedev_name))) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Cannot find '%s' in node device database\"),\n                       nodedev_name);\n        return NULL;\n    }\n\n    parent = g_strdup(virNodeDeviceGetParent(device));\n    virObjectUnref(device);\n\n    return parent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"scsi_%s\"",
            "name"
          ],
          "line": 1232
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetConnectNodeDev",
          "args": [],
          "line": 1231
        },
        "resolved": true,
        "details": {
          "function_name": "virGetConnectNodeDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/driver.c",
          "lines": "179-182",
          "snippet": "virConnectPtr virGetConnectNodeDev(void)\n{\n    return virGetConnectGeneric(&connectNodeDev, \"nodedev\");\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"driver.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal connectNodeDev;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"driver.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirThreadLocal connectNodeDev;\n\nvirConnectPtr virGetConnectNodeDev(void)\n{\n    return virGetConnectGeneric(&connectNodeDev, \"nodedev\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "virVHBAGetHostByWWN",
          "args": [
            "NULL",
            "fchost->wwnn",
            "fchost->wwpn"
          ],
          "line": 1215
        },
        "resolved": true,
        "details": {
          "function_name": "virVHBAGetHostByWWN",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virvhba.c",
          "lines": "500-507",
          "snippet": "char *\nvirVHBAGetHostByWWN(const char *sysfs_prefix G_GNUC_UNUSED,\n                    const char *wwnn G_GNUC_UNUSED,\n                    const char *wwpn G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nchar *\nvirVHBAGetHostByWWN(const char *sysfs_prefix G_GNUC_UNUSED,\n                    const char *wwnn G_GNUC_UNUSED,\n                    const char *wwpn G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic bool\nmatchFCHostToSCSIHost(virStorageAdapterFCHostPtr fchost,\n                      unsigned int scsi_hostnum)\n{\n    virConnectPtr conn = NULL;\n    bool ret = false;\n    char *name = NULL;\n    char *scsi_host_name = NULL;\n    char *parent_name = NULL;\n\n    /* If we have a parent defined, get its hostnum, and compare to the\n     * scsi_hostnum. If they are the same, then we have a match\n     */\n    if (fchost->parent &&\n        virStorageIsSameHostnum(fchost->parent, scsi_hostnum))\n        return true;\n\n    /* If we find an fc adapter name, then either libvirt created a vHBA\n     * for this fc_host or a 'virsh nodedev-create' generated a vHBA.\n     */\n    if ((name = virVHBAGetHostByWWN(NULL, fchost->wwnn, fchost->wwpn))) {\n\n        /* Get the scsi_hostN for the vHBA in order to see if it\n         * matches our scsi_hostnum\n         */\n        if (virStorageIsSameHostnum(name, scsi_hostnum)) {\n            ret = true;\n            goto cleanup;\n        }\n\n        /* We weren't provided a parent, so we have to query the node\n         * device driver in order to ascertain the parent of the vHBA.\n         * If the parent fc_hostnum is the same as the scsi_hostnum, we\n         * have a match.\n         */\n        if (!fchost->parent &&\n            (conn = virGetConnectNodeDev())) {\n            scsi_host_name = g_strdup_printf(\"scsi_%s\", name);\n            if ((parent_name = virNodeDeviceGetParentName(conn,\n                                                          scsi_host_name))) {\n                if (virStorageIsSameHostnum(parent_name, scsi_hostnum)) {\n                    ret = true;\n                    goto cleanup;\n                }\n            } else {\n                /* Throw away the error and fall through */\n                virResetLastError();\n                VIR_DEBUG(\"Could not determine parent vHBA\");\n            }\n        }\n    }\n\n    /* NB: Lack of a name means that this vHBA hasn't yet been created,\n     *     which means our scsi_host cannot be using the vHBA. Furthermore,\n     *     lack of a provided parent means libvirt is going to choose the\n     *     \"best\" fc_host capable adapter based on availability. That could\n     *     conflict with an existing scsi_host definition, but there's no\n     *     way to know that now.\n     */\n\n cleanup:\n    VIR_FREE(name);\n    VIR_FREE(parent_name);\n    VIR_FREE(scsi_host_name);\n    virConnectClose(conn);\n    return ret;\n}"
  },
  {
    "function_name": "virStorageIsSameHostnum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1172-1183",
    "snippet": "static bool\nvirStorageIsSameHostnum(const char *name,\n                        unsigned int scsi_hostnum)\n{\n    unsigned int fc_hostnum;\n\n    if (virSCSIHostGetNumber(name, &fc_hostnum) == 0 &&\n        scsi_hostnum == fc_hostnum)\n        return true;\n\n    return false;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSCSIHostGetNumber",
          "args": [
            "name",
            "&fc_hostnum"
          ],
          "line": 1178
        },
        "resolved": true,
        "details": {
          "function_name": "virSCSIHostGetNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsihost.c",
          "lines": "272-278",
          "snippet": "int\nvirSCSIHostGetNumber(const char *adapter_name G_GNUC_UNUSED,\n                     unsigned int *result G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirSCSIHostGetNumber(const char *adapter_name G_GNUC_UNUSED,\n                     unsigned int *result G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic bool\nvirStorageIsSameHostnum(const char *name,\n                        unsigned int scsi_hostnum)\n{\n    unsigned int fc_hostnum;\n\n    if (virSCSIHostGetNumber(name, &fc_hostnum) == 0 &&\n        scsi_hostnum == fc_hostnum)\n        return true;\n\n    return false;\n}"
  },
  {
    "function_name": "getSCSIHostNumber",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1138-1169",
    "snippet": "static int\ngetSCSIHostNumber(virStorageAdapterSCSIHostPtr scsi_host,\n                  unsigned int *hostnum)\n{\n    int ret = -1;\n    unsigned int num;\n    char *name = NULL;\n\n    if (scsi_host->has_parent) {\n        virPCIDeviceAddressPtr addr = &scsi_host->parentaddr;\n        unsigned int unique_id = scsi_host->unique_id;\n\n        if (!(name = virSCSIHostGetNameByParentaddr(addr->domain,\n                                                    addr->bus,\n                                                    addr->slot,\n                                                    addr->function,\n                                                    unique_id)))\n            goto cleanup;\n        if (virSCSIHostGetNumber(name, &num) < 0)\n            goto cleanup;\n    } else {\n        if (virSCSIHostGetNumber(scsi_host->name, &num) < 0)\n            goto cleanup;\n    }\n\n    *hostnum = num;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(name);\n    return ret;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "name"
          ],
          "line": 1167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSCSIHostGetNumber",
          "args": [
            "scsi_host->name",
            "&num"
          ],
          "line": 1159
        },
        "resolved": true,
        "details": {
          "function_name": "virSCSIHostGetNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsihost.c",
          "lines": "272-278",
          "snippet": "int\nvirSCSIHostGetNumber(const char *adapter_name G_GNUC_UNUSED,\n                     unsigned int *result G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirSCSIHostGetNumber(const char *adapter_name G_GNUC_UNUSED,\n                     unsigned int *result G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSCSIHostGetNameByParentaddr",
          "args": [
            "addr->domain",
            "addr->bus",
            "addr->slot",
            "addr->function",
            "unique_id"
          ],
          "line": 1150
        },
        "resolved": true,
        "details": {
          "function_name": "virSCSIHostGetNameByParentaddr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsihost.c",
          "lines": "280-289",
          "snippet": "char *\nvirSCSIHostGetNameByParentaddr(unsigned int domain G_GNUC_UNUSED,\n                               unsigned int bus G_GNUC_UNUSED,\n                               unsigned int slot G_GNUC_UNUSED,\n                               unsigned int function G_GNUC_UNUSED,\n                               unsigned int unique_id G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <dirent.h>\n#include <config.h>\n\nchar *\nvirSCSIHostGetNameByParentaddr(unsigned int domain G_GNUC_UNUSED,\n                               unsigned int bus G_GNUC_UNUSED,\n                               unsigned int slot G_GNUC_UNUSED,\n                               unsigned int function G_GNUC_UNUSED,\n                               unsigned int unique_id G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\ngetSCSIHostNumber(virStorageAdapterSCSIHostPtr scsi_host,\n                  unsigned int *hostnum)\n{\n    int ret = -1;\n    unsigned int num;\n    char *name = NULL;\n\n    if (scsi_host->has_parent) {\n        virPCIDeviceAddressPtr addr = &scsi_host->parentaddr;\n        unsigned int unique_id = scsi_host->unique_id;\n\n        if (!(name = virSCSIHostGetNameByParentaddr(addr->domain,\n                                                    addr->bus,\n                                                    addr->slot,\n                                                    addr->function,\n                                                    unique_id)))\n            goto cleanup;\n        if (virSCSIHostGetNumber(name, &num) < 0)\n            goto cleanup;\n    } else {\n        if (virSCSIHostGetNumber(scsi_host->name, &num) < 0)\n            goto cleanup;\n    }\n\n    *hostnum = num;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(name);\n    return ret;\n}"
  },
  {
    "function_name": "virStoragePoolObjIsDuplicate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1073-1135",
    "snippet": "static int\nvirStoragePoolObjIsDuplicate(virStoragePoolObjListPtr pools,\n                             virStoragePoolDefPtr def,\n                             bool check_active,\n                             virStoragePoolObjPtr *objRet)\n{\n    int ret = -1;\n    virStoragePoolObjPtr obj = NULL;\n\n    /* See if a Pool with matching UUID already exists */\n    obj = virStoragePoolObjFindByUUIDLocked(pools, def->uuid);\n    if (obj) {\n        virObjectLock(obj);\n\n        /* UUID matches, but if names don't match, refuse it */\n        if (STRNEQ(obj->def->name, def->name)) {\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n            virUUIDFormat(obj->def->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"pool '%s' is already defined with uuid %s\"),\n                           obj->def->name, uuidstr);\n            goto cleanup;\n        }\n\n        if (check_active) {\n            /* UUID & name match, but if Pool is already active, refuse it */\n            if (virStoragePoolObjIsActive(obj)) {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"pool is already active as '%s'\"),\n                               obj->def->name);\n                goto cleanup;\n            }\n\n            if (virStoragePoolObjIsStarting(obj)) {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"pool '%s' is starting up\"),\n                               obj->def->name);\n                goto cleanup;\n            }\n        }\n\n        *objRet = g_steal_pointer(&obj);\n        ret = 1;\n    } else {\n        /* UUID does not match, but if a name matches, refuse it */\n        obj = virStoragePoolObjFindByNameLocked(pools, def->name);\n        if (obj) {\n            virObjectLock(obj);\n\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n            virUUIDFormat(obj->def->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"pool '%s' already exists with uuid %s\"),\n                           def->name, uuidstr);\n            goto cleanup;\n        }\n        ret = 0;\n    }\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1133
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"pool '%s' already exists with uuid %s\")",
            "def->name",
            "uuidstr"
          ],
          "line": 1124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"pool '%s' already exists with uuid %s\""
          ],
          "line": 1125
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "obj->def->uuid",
            "uuidstr"
          ],
          "line": 1123
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 1120
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFindByNameLocked",
          "args": [
            "pools",
            "def->name"
          ],
          "line": 1118
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFindByNameLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "579-584",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFindByNameLocked(virStoragePoolObjListPtr pools,\n                                  const char *name)\n{\n    return virObjectRef(virHashLookup(pools->objsName, name));\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFindByNameLocked(virStoragePoolObjListPtr pools,\n                                  const char *name)\n{\n    return virObjectRef(virHashLookup(pools->objsName, name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&obj"
          ],
          "line": 1114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"pool '%s' is starting up\")",
            "obj->def->name"
          ],
          "line": 1107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsStarting",
          "args": [
            "obj"
          ],
          "line": 1106
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsStarting",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "324-328",
          "snippet": "bool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"pool is already active as '%s'\")",
            "obj->def->name"
          ],
          "line": 1100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1099
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "301-305",
          "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"pool '%s' is already defined with uuid %s\")",
            "obj->def->name",
            "uuidstr"
          ],
          "line": 1091
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "obj->def->name",
            "def->name"
          ],
          "line": 1088
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFindByUUIDLocked",
          "args": [
            "pools",
            "def->uuid"
          ],
          "line": 1083
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFindByUUIDLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "542-551",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFindByUUIDLocked(virStoragePoolObjListPtr pools,\n                                  const unsigned char *uuid)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(uuid, uuidstr);\n\n    return virObjectRef(virHashLookup(pools->objs, uuidstr));\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFindByUUIDLocked(virStoragePoolObjListPtr pools,\n                                  const unsigned char *uuid)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(uuid, uuidstr);\n\n    return virObjectRef(virHashLookup(pools->objs, uuidstr));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolObjIsDuplicate(virStoragePoolObjListPtr pools,\n                             virStoragePoolDefPtr def,\n                             bool check_active,\n                             virStoragePoolObjPtr *objRet)\n{\n    int ret = -1;\n    virStoragePoolObjPtr obj = NULL;\n\n    /* See if a Pool with matching UUID already exists */\n    obj = virStoragePoolObjFindByUUIDLocked(pools, def->uuid);\n    if (obj) {\n        virObjectLock(obj);\n\n        /* UUID matches, but if names don't match, refuse it */\n        if (STRNEQ(obj->def->name, def->name)) {\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n            virUUIDFormat(obj->def->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"pool '%s' is already defined with uuid %s\"),\n                           obj->def->name, uuidstr);\n            goto cleanup;\n        }\n\n        if (check_active) {\n            /* UUID & name match, but if Pool is already active, refuse it */\n            if (virStoragePoolObjIsActive(obj)) {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"pool is already active as '%s'\"),\n                               obj->def->name);\n                goto cleanup;\n            }\n\n            if (virStoragePoolObjIsStarting(obj)) {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"pool '%s' is starting up\"),\n                               obj->def->name);\n                goto cleanup;\n            }\n        }\n\n        *objRet = g_steal_pointer(&obj);\n        ret = 1;\n    } else {\n        /* UUID does not match, but if a name matches, refuse it */\n        obj = virStoragePoolObjFindByNameLocked(pools, def->name);\n        if (obj) {\n            virObjectLock(obj);\n\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n            virUUIDFormat(obj->def->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"pool '%s' already exists with uuid %s\"),\n                           def->name, uuidstr);\n            goto cleanup;\n        }\n        ret = 0;\n    }\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "virStoragePoolObjVolumeListExport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "1020-1057",
    "snippet": "int\nvirStoragePoolObjVolumeListExport(virConnectPtr conn,\n                                  virStoragePoolObjPtr obj,\n                                  virStorageVolPtr **vols,\n                                  virStoragePoolVolumeACLFilter filter)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    virStoragePoolObjVolumeListExportData data = {\n        .conn = conn, .filter = filter, .pooldef = obj->def, .error = false,\n        .nvols = 0, .vols = NULL };\n\n    virObjectRWLockRead(volumes);\n\n    if (!vols) {\n        int ret = virHashSize(volumes->objsName);\n        virObjectRWUnlock(volumes);\n        return ret;\n    }\n\n    if (VIR_ALLOC_N(data.vols, virHashSize(volumes->objsName) + 1) < 0) {\n        virObjectRWUnlock(volumes);\n        return -1;\n    }\n\n    virHashForEach(volumes->objsName, virStoragePoolObjVolumeListExportCallback, &data);\n    virObjectRWUnlock(volumes);\n\n    if (data.error)\n        goto error;\n\n    *vols = data.vols;\n\n    return data.nvols;\n\n error:\n    virObjectListFree(data.vols);\n    return -1;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectListFree",
          "args": [
            "data.vols"
          ],
          "line": 1055
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "603-615",
          "snippet": "void\nvirObjectListFree(void *list)\n{\n    void **next;\n\n    if (!list)\n        return;\n\n    for (next = (void **) list; *next; next++)\n        virObjectUnref(*next);\n\n    VIR_FREE(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid\nvirObjectListFree(void *list)\n{\n    void **next;\n\n    if (!list)\n        return;\n\n    for (next = (void **) list; *next; next++)\n        virObjectUnref(*next);\n\n    VIR_FREE(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "volumes"
          ],
          "line": 1045
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "volumes->objsName",
            "virStoragePoolObjVolumeListExportCallback",
            "&data"
          ],
          "line": 1044
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "data.vols",
            "virHashSize(volumes->objsName) + 1"
          ],
          "line": 1039
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashSize",
          "args": [
            "volumes->objsName"
          ],
          "line": 1039
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "547-553",
          "snippet": "ssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "volumes"
          ],
          "line": 1031
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjVolumeListExport(virConnectPtr conn,\n                                  virStoragePoolObjPtr obj,\n                                  virStorageVolPtr **vols,\n                                  virStoragePoolVolumeACLFilter filter)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    virStoragePoolObjVolumeListExportData data = {\n        .conn = conn, .filter = filter, .pooldef = obj->def, .error = false,\n        .nvols = 0, .vols = NULL };\n\n    virObjectRWLockRead(volumes);\n\n    if (!vols) {\n        int ret = virHashSize(volumes->objsName);\n        virObjectRWUnlock(volumes);\n        return ret;\n    }\n\n    if (VIR_ALLOC_N(data.vols, virHashSize(volumes->objsName) + 1) < 0) {\n        virObjectRWUnlock(volumes);\n        return -1;\n    }\n\n    virHashForEach(volumes->objsName, virStoragePoolObjVolumeListExportCallback, &data);\n    virObjectRWUnlock(volumes);\n\n    if (data.error)\n        goto error;\n\n    *vols = data.vols;\n\n    return data.nvols;\n\n error:\n    virObjectListFree(data.vols);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolObjVolumeListExportCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "984-1017",
    "snippet": "static int\nvirStoragePoolObjVolumeListExportCallback(void *payload,\n                                          const void *name G_GNUC_UNUSED,\n                                          void *opaque)\n{\n    virStorageVolObjPtr volobj = payload;\n    virStoragePoolObjVolumeListExportDataPtr data = opaque;\n    virStorageVolPtr vol = NULL;\n\n    if (data->error)\n        return 0;\n\n    virObjectLock(volobj);\n\n    if (data->filter &&\n        !data->filter(data->conn, data->pooldef, volobj->voldef))\n        goto cleanup;\n\n    if (data->vols) {\n        if (!(vol = virGetStorageVol(data->conn, data->pooldef->name,\n                                     volobj->voldef->name, volobj->voldef->key,\n                                     NULL, NULL))) {\n            data->error = true;\n            goto cleanup;\n        }\n        data->vols[data->nvols] = vol;\n    }\n\n    data->nvols++;\n\n cleanup:\n    virObjectUnlock(volobj);\n    return 0;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "volobj"
          ],
          "line": 1015
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetStorageVol",
          "args": [
            "data->conn",
            "data->pooldef->name",
            "volobj->voldef->name",
            "volobj->voldef->key",
            "NULL",
            "NULL"
          ],
          "line": 1003
        },
        "resolved": true,
        "details": {
          "function_name": "virGetStorageVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "600-632",
          "snippet": "virStorageVolPtr\nvirGetStorageVol(virConnectPtr conn, const char *pool, const char *name,\n                 const char *key, void *privateData, virFreeCallback freeFunc)\n{\n    virStorageVolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(pool, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(key, error);\n\n    if (!(ret = virObjectNew(virStorageVolClass)))\n        goto error;\n\n    ret->pool = g_strdup(pool);\n    ret->name = g_strdup(name);\n    ret->key = g_strdup(key);\n\n    ret->conn = virObjectRef(conn);\n\n    /* set driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virStorageVolClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virStorageVolClass;\n\nvirStorageVolPtr\nvirGetStorageVol(virConnectPtr conn, const char *pool, const char *name,\n                 const char *key, void *privateData, virFreeCallback freeFunc)\n{\n    virStorageVolPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(pool, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(key, error);\n\n    if (!(ret = virObjectNew(virStorageVolClass)))\n        goto error;\n\n    ret->pool = g_strdup(pool);\n    ret->name = g_strdup(name);\n    ret->key = g_strdup(key);\n\n    ret->conn = virObjectRef(conn);\n\n    /* set driver specific data */\n    ret->privateData = privateData;\n    ret->privateDataFreeFunc = freeFunc;\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->filter",
          "args": [
            "data->conn",
            "data->pooldef",
            "volobj->voldef"
          ],
          "line": 999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "volobj"
          ],
          "line": 996
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nstatic int\nvirStoragePoolObjVolumeListExportCallback(void *payload,\n                                          const void *name G_GNUC_UNUSED,\n                                          void *opaque)\n{\n    virStorageVolObjPtr volobj = payload;\n    virStoragePoolObjVolumeListExportDataPtr data = opaque;\n    virStorageVolPtr vol = NULL;\n\n    if (data->error)\n        return 0;\n\n    virObjectLock(volobj);\n\n    if (data->filter &&\n        !data->filter(data->conn, data->pooldef, volobj->voldef))\n        goto cleanup;\n\n    if (data->vols) {\n        if (!(vol = virGetStorageVol(data->conn, data->pooldef->name,\n                                     volobj->voldef->name, volobj->voldef->key,\n                                     NULL, NULL))) {\n            data->error = true;\n            goto cleanup;\n        }\n        data->vols[data->nvols] = vol;\n    }\n\n    data->nvols++;\n\n cleanup:\n    virObjectUnlock(volobj);\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolObjVolumeGetNames",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "945-970",
    "snippet": "int\nvirStoragePoolObjVolumeGetNames(virStoragePoolObjPtr obj,\n                                virConnectPtr conn,\n                                virStoragePoolVolumeACLFilter filter,\n                                char **const names,\n                                int maxnames)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    struct _virStorageVolObjNameData data = {\n        .conn = conn, .filter = filter, .pooldef = obj->def, .error = false,\n        .nnames = 0, .maxnames = maxnames, .names = names };\n\n    virObjectRWLockRead(volumes);\n    virHashForEach(volumes->objsName, virStoragePoolObjVolumeGetNamesCb, &data);\n    virObjectRWUnlock(volumes);\n\n    if (data.error)\n        goto error;\n\n    return data.nnames;\n\n error:\n    while (--data.nnames)\n        VIR_FREE(data.names[data.nnames]);\n    return -1;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data.names[data.nnames]"
          ],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "volumes"
          ],
          "line": 959
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "volumes->objsName",
            "virStoragePoolObjVolumeGetNamesCb",
            "&data"
          ],
          "line": 958
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "volumes"
          ],
          "line": 957
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjVolumeGetNames(virStoragePoolObjPtr obj,\n                                virConnectPtr conn,\n                                virStoragePoolVolumeACLFilter filter,\n                                char **const names,\n                                int maxnames)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    struct _virStorageVolObjNameData data = {\n        .conn = conn, .filter = filter, .pooldef = obj->def, .error = false,\n        .nnames = 0, .maxnames = maxnames, .names = names };\n\n    virObjectRWLockRead(volumes);\n    virHashForEach(volumes->objsName, virStoragePoolObjVolumeGetNamesCb, &data);\n    virObjectRWUnlock(volumes);\n\n    if (data.error)\n        goto error;\n\n    return data.nnames;\n\n error:\n    while (--data.nnames)\n        VIR_FREE(data.names[data.nnames]);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolObjVolumeGetNamesCb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "914-942",
    "snippet": "static int\nvirStoragePoolObjVolumeGetNamesCb(void *payload,\n                                  const void *name G_GNUC_UNUSED,\n                                  void *opaque)\n{\n    virStorageVolObjPtr volobj = payload;\n    struct _virStorageVolObjNameData *data = opaque;\n\n    if (data->error)\n        return 0;\n\n    if (data->maxnames >= 0 && data->nnames == data->maxnames)\n        return 0;\n\n    virObjectLock(volobj);\n\n    if (data->filter &&\n        !data->filter(data->conn, data->pooldef, volobj->voldef))\n        goto cleanup;\n\n    if (data->names)\n        data->names[data->nnames] = g_strdup(volobj->voldef->name);\n\n    data->nnames++;\n\n cleanup:\n    virObjectUnlock(volobj);\n    return 0;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "volobj"
          ],
          "line": 940
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "volobj->voldef->name"
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->filter",
          "args": [
            "data->conn",
            "data->pooldef",
            "volobj->voldef"
          ],
          "line": 931
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "volobj"
          ],
          "line": 928
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nstatic int\nvirStoragePoolObjVolumeGetNamesCb(void *payload,\n                                  const void *name G_GNUC_UNUSED,\n                                  void *opaque)\n{\n    virStorageVolObjPtr volobj = payload;\n    struct _virStorageVolObjNameData *data = opaque;\n\n    if (data->error)\n        return 0;\n\n    if (data->maxnames >= 0 && data->nnames == data->maxnames)\n        return 0;\n\n    virObjectLock(volobj);\n\n    if (data->filter &&\n        !data->filter(data->conn, data->pooldef, volobj->voldef))\n        goto cleanup;\n\n    if (data->names)\n        data->names[data->nnames] = g_strdup(volobj->voldef->name);\n\n    data->nnames++;\n\n cleanup:\n    virObjectUnlock(volobj);\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolObjNumOfVolumes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "887-901",
    "snippet": "int\nvirStoragePoolObjNumOfVolumes(virStoragePoolObjPtr obj,\n                              virConnectPtr conn,\n                              virStoragePoolVolumeACLFilter filter)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    struct _virStorageVolObjCountData data = {\n        .conn = conn, .filter = filter, .pooldef = obj->def, .count = 0 };\n\n    virObjectRWLockRead(volumes);\n    virHashForEach(volumes->objsName, virStoragePoolObjNumOfVolumesCb, &data);\n    virObjectRWUnlock(volumes);\n\n    return data.count;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "volumes"
          ],
          "line": 898
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "volumes->objsName",
            "virStoragePoolObjNumOfVolumesCb",
            "&data"
          ],
          "line": 897
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "volumes"
          ],
          "line": 896
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjNumOfVolumes(virStoragePoolObjPtr obj,\n                              virConnectPtr conn,\n                              virStoragePoolVolumeACLFilter filter)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    struct _virStorageVolObjCountData data = {\n        .conn = conn, .filter = filter, .pooldef = obj->def, .count = 0 };\n\n    virObjectRWLockRead(volumes);\n    virHashForEach(volumes->objsName, virStoragePoolObjNumOfVolumesCb, &data);\n    virObjectRWUnlock(volumes);\n\n    return data.count;\n}"
  },
  {
    "function_name": "virStoragePoolObjNumOfVolumesCb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "865-884",
    "snippet": "static int\nvirStoragePoolObjNumOfVolumesCb(void *payload,\n                                const void *name G_GNUC_UNUSED,\n                                void *opaque)\n{\n    virStorageVolObjPtr volobj = payload;\n    struct _virStorageVolObjCountData *data = opaque;\n\n    virObjectLock(volobj);\n\n    if (data->filter &&\n        !data->filter(data->conn, data->pooldef, volobj->voldef))\n        goto cleanup;\n\n    data->count++;\n\n cleanup:\n    virObjectUnlock(volobj);\n    return 0;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "volobj"
          ],
          "line": 882
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->filter",
          "args": [
            "data->conn",
            "data->pooldef",
            "volobj->voldef"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "volobj"
          ],
          "line": 873
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nstatic int\nvirStoragePoolObjNumOfVolumesCb(void *payload,\n                                const void *name G_GNUC_UNUSED,\n                                void *opaque)\n{\n    virStorageVolObjPtr volobj = payload;\n    struct _virStorageVolObjCountData *data = opaque;\n\n    virObjectLock(volobj);\n\n    if (data->filter &&\n        !data->filter(data->conn, data->pooldef, volobj->voldef))\n        goto cleanup;\n\n    data->count++;\n\n cleanup:\n    virObjectUnlock(volobj);\n    return 0;\n}"
  },
  {
    "function_name": "virStorageVolDefFindByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "841-854",
    "snippet": "virStorageVolDefPtr\nvirStorageVolDefFindByName(virStoragePoolObjPtr obj,\n                           const char *name)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsName, name);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "obj->volumes"
          ],
          "line": 849
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "obj->volumes->objsName",
            "name"
          ],
          "line": 848
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "obj->volumes"
          ],
          "line": 847
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStorageVolDefPtr\nvirStorageVolDefFindByName(virStoragePoolObjPtr obj,\n                           const char *name)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsName, name);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}"
  },
  {
    "function_name": "virStorageVolDefFindByPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "825-838",
    "snippet": "virStorageVolDefPtr\nvirStorageVolDefFindByPath(virStoragePoolObjPtr obj,\n                           const char *path)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsPath, path);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "obj->volumes"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "obj->volumes->objsPath",
            "path"
          ],
          "line": 832
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "obj->volumes"
          ],
          "line": 831
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStorageVolDefPtr\nvirStorageVolDefFindByPath(virStoragePoolObjPtr obj,\n                           const char *path)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsPath, path);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}"
  },
  {
    "function_name": "virStorageVolDefFindByKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "809-822",
    "snippet": "virStorageVolDefPtr\nvirStorageVolDefFindByKey(virStoragePoolObjPtr obj,\n                          const char *key)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsKey, key);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "obj->volumes"
          ],
          "line": 817
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "obj->volumes->objsKey",
            "key"
          ],
          "line": 816
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "obj->volumes"
          ],
          "line": 815
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStorageVolDefPtr\nvirStorageVolDefFindByKey(virStoragePoolObjPtr obj,\n                          const char *key)\n{\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashLookup(obj->volumes->objsKey, key);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n    return NULL;\n}"
  },
  {
    "function_name": "virStoragePoolObjSearchVolume",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "787-806",
    "snippet": "virStorageVolDefPtr\nvirStoragePoolObjSearchVolume(virStoragePoolObjPtr obj,\n                              virStorageVolObjListSearcher iter,\n                              const void *opaque)\n{\n    virStorageVolObjPtr volobj;\n    struct _virStoragePoolObjSearchVolData data = {\n        .iter = iter, .opaque = opaque };\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashSearch(obj->volumes->objsKey,\n                           virStoragePoolObjSearchVolumeCb,\n                           &data, NULL);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n\n    return NULL;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "obj->volumes"
          ],
          "line": 800
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashSearch",
          "args": [
            "obj->volumes->objsKey",
            "virStoragePoolObjSearchVolumeCb",
            "&data",
            "NULL"
          ],
          "line": 797
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "736-761",
          "snippet": "void *virHashSearch(const virHashTable *ctable,\n                    virHashSearcher iter,\n                    const void *data,\n                    void **name)\n{\n    size_t i;\n\n    /* Cast away const for internal detection of misuse.  */\n    virHashTablePtr table = (virHashTablePtr)ctable;\n\n    if (table == NULL || iter == NULL)\n        return NULL;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry;\n        for (entry = table->table[i]; entry; entry = entry->next) {\n            if (iter(entry->payload, entry->name, data)) {\n                if (name)\n                    *name = table->keyCopy(entry->name);\n                return entry->payload;\n            }\n        }\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *virHashSearch(const virHashTable *ctable,\n                    virHashSearcher iter,\n                    const void *data,\n                    void **name)\n{\n    size_t i;\n\n    /* Cast away const for internal detection of misuse.  */\n    virHashTablePtr table = (virHashTablePtr)ctable;\n\n    if (table == NULL || iter == NULL)\n        return NULL;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry;\n        for (entry = table->table[i]; entry; entry = entry->next) {\n            if (iter(entry->payload, entry->name, data)) {\n                if (name)\n                    *name = table->keyCopy(entry->name);\n                return entry->payload;\n            }\n        }\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "obj->volumes"
          ],
          "line": 796
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nvirStorageVolDefPtr\nvirStoragePoolObjSearchVolume(virStoragePoolObjPtr obj,\n                              virStorageVolObjListSearcher iter,\n                              const void *opaque)\n{\n    virStorageVolObjPtr volobj;\n    struct _virStoragePoolObjSearchVolData data = {\n        .iter = iter, .opaque = opaque };\n\n    virObjectRWLockRead(obj->volumes);\n    volobj = virHashSearch(obj->volumes->objsKey,\n                           virStoragePoolObjSearchVolumeCb,\n                           &data, NULL);\n    virObjectRWUnlock(obj->volumes);\n\n    if (volobj)\n        return volobj->voldef;\n\n    return NULL;\n}"
  },
  {
    "function_name": "virStoragePoolObjSearchVolumeCb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "768-784",
    "snippet": "static int\nvirStoragePoolObjSearchVolumeCb(const void *payload,\n                                const void *name G_GNUC_UNUSED,\n                                const void *opaque)\n{\n    virStorageVolObjPtr volobj = (virStorageVolObjPtr) payload;\n    struct _virStoragePoolObjSearchVolData *data =\n        (struct _virStoragePoolObjSearchVolData *) opaque;\n    int found = 0;\n\n    virObjectLock(volobj);\n    if (data->iter(volobj->voldef, data->opaque))\n        found = 1;\n    virObjectUnlock(volobj);\n\n    return found;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "volobj"
          ],
          "line": 781
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->iter",
          "args": [
            "volobj->voldef",
            "data->opaque"
          ],
          "line": 779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "volobj"
          ],
          "line": 778
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nstatic int\nvirStoragePoolObjSearchVolumeCb(const void *payload,\n                                const void *name G_GNUC_UNUSED,\n                                const void *opaque)\n{\n    virStorageVolObjPtr volobj = (virStorageVolObjPtr) payload;\n    struct _virStoragePoolObjSearchVolData *data =\n        (struct _virStoragePoolObjSearchVolData *) opaque;\n    int found = 0;\n\n    virObjectLock(volobj);\n    if (data->iter(volobj->voldef, data->opaque))\n        found = 1;\n    virObjectUnlock(volobj);\n\n    return found;\n}"
  },
  {
    "function_name": "virStoragePoolObjForEachVolume",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "747-760",
    "snippet": "int\nvirStoragePoolObjForEachVolume(virStoragePoolObjPtr obj,\n                               virStorageVolObjListIterator iter,\n                               const void *opaque)\n{\n    struct _virStoragePoolObjForEachVolData data = {\n        .iter = iter, .opaque = opaque };\n\n    virObjectRWLockRead(obj->volumes);\n    virHashForEach(obj->volumes->objsKey, virStoragePoolObjForEachVolumeCb,\n                   &data);\n    virObjectRWUnlock(obj->volumes);\n    return 0;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "obj->volumes"
          ],
          "line": 758
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "obj->volumes->objsKey",
            "virStoragePoolObjForEachVolumeCb",
            "&data"
          ],
          "line": 756
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "obj->volumes"
          ],
          "line": 755
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nint\nvirStoragePoolObjForEachVolume(virStoragePoolObjPtr obj,\n                               virStorageVolObjListIterator iter,\n                               const void *opaque)\n{\n    struct _virStoragePoolObjForEachVolData data = {\n        .iter = iter, .opaque = opaque };\n\n    virObjectRWLockRead(obj->volumes);\n    virHashForEach(obj->volumes->objsKey, virStoragePoolObjForEachVolumeCb,\n                   &data);\n    virObjectRWUnlock(obj->volumes);\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolObjForEachVolumeCb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "729-744",
    "snippet": "static int\nvirStoragePoolObjForEachVolumeCb(void *payload,\n                                 const void *name G_GNUC_UNUSED,\n                                 void *opaque)\n{\n    int ret = 0;\n    virStorageVolObjPtr volobj = payload;\n    struct _virStoragePoolObjForEachVolData *data = opaque;\n\n    virObjectLock(volobj);\n    if (data->iter(volobj->voldef, data->opaque) < 0)\n        ret = -1;\n    virObjectUnlock(volobj);\n\n    return ret;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "volobj"
          ],
          "line": 741
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->iter",
          "args": [
            "volobj->voldef",
            "data->opaque"
          ],
          "line": 739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "volobj"
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nstatic int\nvirStoragePoolObjForEachVolumeCb(void *payload,\n                                 const void *name G_GNUC_UNUSED,\n                                 void *opaque)\n{\n    int ret = 0;\n    virStorageVolObjPtr volobj = payload;\n    struct _virStoragePoolObjForEachVolData *data = opaque;\n\n    virObjectLock(volobj);\n    if (data->iter(volobj->voldef, data->opaque) < 0)\n        ret = -1;\n    virObjectUnlock(volobj);\n\n    return ret;\n}"
  },
  {
    "function_name": "virStoragePoolObjGetVolumesCount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "711-721",
    "snippet": "size_t\nvirStoragePoolObjGetVolumesCount(virStoragePoolObjPtr obj)\n{\n    size_t nbElems;\n\n    virObjectRWLockRead(obj->volumes);\n    nbElems = virHashSize(obj->volumes->objsKey);\n    virObjectRWUnlock(obj->volumes);\n\n    return nbElems;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "obj->volumes"
          ],
          "line": 718
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashSize",
          "args": [
            "obj->volumes->objsKey"
          ],
          "line": 717
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "547-553",
          "snippet": "ssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "obj->volumes"
          ],
          "line": 716
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nsize_t\nvirStoragePoolObjGetVolumesCount(virStoragePoolObjPtr obj)\n{\n    size_t nbElems;\n\n    virObjectRWLockRead(obj->volumes);\n    nbElems = virHashSize(obj->volumes->objsKey);\n    virObjectRWUnlock(obj->volumes);\n\n    return nbElems;\n}"
  },
  {
    "function_name": "virStoragePoolObjRemoveVol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "682-708",
    "snippet": "void\nvirStoragePoolObjRemoveVol(virStoragePoolObjPtr obj,\n                           virStorageVolDefPtr voldef)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockWrite(volumes);\n    volobj = virHashLookup(volumes->objsName, voldef->name);\n    if (!volobj) {\n        VIR_INFO(\"Cannot find volume '%s' from storage pool '%s'\",\n                 voldef->name, obj->def->name);\n        virObjectRWUnlock(volumes);\n        return;\n    }\n    VIR_INFO(\"Deleting volume '%s' from storage pool '%s'\",\n             voldef->name, obj->def->name);\n\n    virObjectRef(volobj);\n    virObjectLock(volobj);\n    virHashRemoveEntry(volumes->objsKey, voldef->key);\n    virHashRemoveEntry(volumes->objsName, voldef->name);\n    virHashRemoveEntry(volumes->objsPath, voldef->target.path);\n    virStorageVolObjEndAPI(&volobj);\n\n    virObjectRWUnlock(volumes);\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "volumes"
          ],
          "line": 707
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolObjEndAPI",
          "args": [
            "&volobj"
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "143-152",
          "snippet": "static void\nvirStorageVolObjEndAPI(virStorageVolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStorageVolObjEndAPI(virStorageVolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashRemoveEntry",
          "args": [
            "volumes->objsPath",
            "voldef->target.path"
          ],
          "line": 704
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "584-609",
          "snippet": "int\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "volobj"
          ],
          "line": 701
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "volobj"
          ],
          "line": 700
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Deleting volume '%s' from storage pool '%s'\"",
            "voldef->name",
            "obj->def->name"
          ],
          "line": 697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Cannot find volume '%s' from storage pool '%s'\"",
            "voldef->name",
            "obj->def->name"
          ],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "volumes->objsName",
            "voldef->name"
          ],
          "line": 690
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockWrite",
          "args": [
            "volumes"
          ],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "482-491",
          "snippet": "void\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjRemoveVol(virStoragePoolObjPtr obj,\n                           virStorageVolDefPtr voldef)\n{\n    virStorageVolObjListPtr volumes = obj->volumes;\n    virStorageVolObjPtr volobj;\n\n    virObjectRWLockWrite(volumes);\n    volobj = virHashLookup(volumes->objsName, voldef->name);\n    if (!volobj) {\n        VIR_INFO(\"Cannot find volume '%s' from storage pool '%s'\",\n                 voldef->name, obj->def->name);\n        virObjectRWUnlock(volumes);\n        return;\n    }\n    VIR_INFO(\"Deleting volume '%s' from storage pool '%s'\",\n             voldef->name, obj->def->name);\n\n    virObjectRef(volobj);\n    virObjectLock(volobj);\n    virHashRemoveEntry(volumes->objsKey, voldef->key);\n    virHashRemoveEntry(volumes->objsName, voldef->name);\n    virHashRemoveEntry(volumes->objsPath, voldef->target.path);\n    virStorageVolObjEndAPI(&volobj);\n\n    virObjectRWUnlock(volumes);\n}"
  },
  {
    "function_name": "virStoragePoolObjAddVol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "641-679",
    "snippet": "int\nvirStoragePoolObjAddVol(virStoragePoolObjPtr obj,\n                        virStorageVolDefPtr voldef)\n{\n    virStorageVolObjPtr volobj = NULL;\n    virStorageVolObjListPtr volumes = obj->volumes;\n\n    virObjectRWLockWrite(volumes);\n\n    if (!(volobj = virStorageVolObjNew()))\n        goto error;\n\n    if (virHashAddEntry(volumes->objsKey, voldef->key, volobj) < 0)\n        goto error;\n    virObjectRef(volobj);\n\n    if (virHashAddEntry(volumes->objsName, voldef->name, volobj) < 0) {\n        virHashRemoveEntry(volumes->objsKey, voldef->key);\n        goto error;\n    }\n    virObjectRef(volobj);\n\n    if (virHashAddEntry(volumes->objsPath, voldef->target.path, volobj) < 0) {\n        virHashRemoveEntry(volumes->objsKey, voldef->key);\n        virHashRemoveEntry(volumes->objsName, voldef->name);\n        goto error;\n    }\n    virObjectRef(volobj);\n\n    volobj->voldef = voldef;\n    virObjectRWUnlock(volumes);\n    virStorageVolObjEndAPI(&volobj);\n    return 0;\n\n error:\n    virStorageVolObjEndAPI(&volobj);\n    virObjectRWUnlock(volumes);\n    return -1;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "volumes"
          ],
          "line": 677
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolObjEndAPI",
          "args": [
            "&volobj"
          ],
          "line": 676
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "143-152",
          "snippet": "static void\nvirStorageVolObjEndAPI(virStorageVolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStorageVolObjEndAPI(virStorageVolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "volobj"
          ],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashRemoveEntry",
          "args": [
            "volumes->objsName",
            "voldef->name"
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "584-609",
          "snippet": "int\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "volumes->objsPath",
            "voldef->target.path",
            "volobj"
          ],
          "line": 663
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolObjNew",
          "args": [],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolObjNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "127-140",
          "snippet": "static virStorageVolObjPtr\nvirStorageVolObjNew(void)\n{\n    virStorageVolObjPtr obj;\n\n    if (virStorageVolObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virStorageVolObjClass)))\n        return NULL;\n\n    virObjectLock(obj);\n    return obj;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virStorageVolObjClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virClassPtr virStorageVolObjClass;\n\nstatic virStorageVolObjPtr\nvirStorageVolObjNew(void)\n{\n    virStorageVolObjPtr obj;\n\n    if (virStorageVolObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virStorageVolObjClass)))\n        return NULL;\n\n    virObjectLock(obj);\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockWrite",
          "args": [
            "volumes"
          ],
          "line": 648
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "482-491",
          "snippet": "void\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirStoragePoolObjAddVol(virStoragePoolObjPtr obj,\n                        virStorageVolDefPtr voldef)\n{\n    virStorageVolObjPtr volobj = NULL;\n    virStorageVolObjListPtr volumes = obj->volumes;\n\n    virObjectRWLockWrite(volumes);\n\n    if (!(volobj = virStorageVolObjNew()))\n        goto error;\n\n    if (virHashAddEntry(volumes->objsKey, voldef->key, volobj) < 0)\n        goto error;\n    virObjectRef(volobj);\n\n    if (virHashAddEntry(volumes->objsName, voldef->name, volobj) < 0) {\n        virHashRemoveEntry(volumes->objsKey, voldef->key);\n        goto error;\n    }\n    virObjectRef(volobj);\n\n    if (virHashAddEntry(volumes->objsPath, voldef->target.path, volobj) < 0) {\n        virHashRemoveEntry(volumes->objsKey, voldef->key);\n        virHashRemoveEntry(volumes->objsName, voldef->name);\n        goto error;\n    }\n    virObjectRef(volobj);\n\n    volobj->voldef = voldef;\n    virObjectRWUnlock(volumes);\n    virStorageVolObjEndAPI(&volobj);\n    return 0;\n\n error:\n    virStorageVolObjEndAPI(&volobj);\n    virObjectRWUnlock(volumes);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolObjClearVols",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "629-638",
    "snippet": "void\nvirStoragePoolObjClearVols(virStoragePoolObjPtr obj)\n{\n    if (!obj->volumes)\n        return;\n\n    virHashRemoveAll(obj->volumes->objsKey);\n    virHashRemoveAll(obj->volumes->objsName);\n    virHashRemoveAll(obj->volumes->objsPath);\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashRemoveAll",
          "args": [
            "obj->volumes->objsPath"
          ],
          "line": 637
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "715-721",
          "snippet": "ssize_t\nvirHashRemoveAll(virHashTablePtr table)\n{\n    return virHashRemoveSet(table,\n                            _virHashRemoveAllIter,\n                            NULL);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nssize_t\nvirHashRemoveAll(virHashTablePtr table)\n{\n    return virHashRemoveSet(table,\n                            _virHashRemoveAllIter,\n                            NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjClearVols(virStoragePoolObjPtr obj)\n{\n    if (!obj->volumes)\n        return;\n\n    virHashRemoveAll(obj->volumes->objsKey);\n    virHashRemoveAll(obj->volumes->objsName);\n    virHashRemoveAll(obj->volumes->objsPath);\n}"
  },
  {
    "function_name": "virStoragePoolSourceFindDuplicateDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "612-626",
    "snippet": "static virStoragePoolObjPtr\nvirStoragePoolSourceFindDuplicateDevices(virStoragePoolObjPtr obj,\n                                         virStoragePoolDefPtr def)\n{\n    size_t i, j;\n\n    for (i = 0; i < obj->def->source.ndevice; i++) {\n        for (j = 0; j < def->source.ndevice; j++) {\n            if (STREQ(obj->def->source.devices[i].path, def->source.devices[j].path))\n                return obj;\n        }\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "obj->def->source.devices[i].path",
            "def->source.devices[j].path"
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolSourceFindDuplicateDevices(virStoragePoolObjPtr obj,\n                                         virStoragePoolDefPtr def)\n{\n    size_t i, j;\n\n    for (i = 0; i < obj->def->source.ndevice; i++) {\n        for (j = 0; j < def->source.ndevice; j++) {\n            if (STREQ(obj->def->source.devices[i].path, def->source.devices[j].path))\n                return obj;\n        }\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "virStoragePoolObjFindByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "596-609",
    "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjFindByName(virStoragePoolObjListPtr pools,\n                            const char *name)\n{\n    virStoragePoolObjPtr obj;\n\n    virObjectRWLockRead(pools);\n    obj = virStoragePoolObjFindByNameLocked(pools, name);\n    virObjectRWUnlock(pools);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "pools"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFindByNameLocked",
          "args": [
            "pools",
            "name"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFindByNameLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "579-584",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFindByNameLocked(virStoragePoolObjListPtr pools,\n                                  const char *name)\n{\n    return virObjectRef(virHashLookup(pools->objsName, name));\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFindByNameLocked(virStoragePoolObjListPtr pools,\n                                  const char *name)\n{\n    return virObjectRef(virHashLookup(pools->objsName, name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "pools"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolObjPtr\nvirStoragePoolObjFindByName(virStoragePoolObjListPtr pools,\n                            const char *name)\n{\n    virStoragePoolObjPtr obj;\n\n    virObjectRWLockRead(pools);\n    obj = virStoragePoolObjFindByNameLocked(pools, name);\n    virObjectRWUnlock(pools);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}"
  },
  {
    "function_name": "virStoragePoolObjFindByNameLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "579-584",
    "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFindByNameLocked(virStoragePoolObjListPtr pools,\n                                  const char *name)\n{\n    return virObjectRef(virHashLookup(pools->objsName, name));\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "virHashLookup(pools->objsName, name)"
          ],
          "line": 583
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "pools->objsName",
            "name"
          ],
          "line": 583
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFindByNameLocked(virStoragePoolObjListPtr pools,\n                                  const char *name)\n{\n    return virObjectRef(virHashLookup(pools->objsName, name));\n}"
  },
  {
    "function_name": "virStoragePoolObjFindByUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "563-576",
    "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjFindByUUID(virStoragePoolObjListPtr pools,\n                            const unsigned char *uuid)\n{\n    virStoragePoolObjPtr obj;\n\n    virObjectRWLockRead(pools);\n    obj = virStoragePoolObjFindByUUIDLocked(pools, uuid);\n    virObjectRWUnlock(pools);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "pools"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjFindByUUIDLocked",
          "args": [
            "pools",
            "uuid"
          ],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjFindByUUIDLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "542-551",
          "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFindByUUIDLocked(virStoragePoolObjListPtr pools,\n                                  const unsigned char *uuid)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(uuid, uuidstr);\n\n    return virObjectRef(virHashLookup(pools->objs, uuidstr));\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFindByUUIDLocked(virStoragePoolObjListPtr pools,\n                                  const unsigned char *uuid)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(uuid, uuidstr);\n\n    return virObjectRef(virHashLookup(pools->objs, uuidstr));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "pools"
          ],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolObjPtr\nvirStoragePoolObjFindByUUID(virStoragePoolObjListPtr pools,\n                            const unsigned char *uuid)\n{\n    virStoragePoolObjPtr obj;\n\n    virObjectRWLockRead(pools);\n    obj = virStoragePoolObjFindByUUIDLocked(pools, uuid);\n    virObjectRWUnlock(pools);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}"
  },
  {
    "function_name": "virStoragePoolObjFindByUUIDLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "542-551",
    "snippet": "static virStoragePoolObjPtr\nvirStoragePoolObjFindByUUIDLocked(virStoragePoolObjListPtr pools,\n                                  const unsigned char *uuid)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(uuid, uuidstr);\n\n    return virObjectRef(virHashLookup(pools->objs, uuidstr));\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "virHashLookup(pools->objs, uuidstr)"
          ],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "pools->objs",
            "uuidstr"
          ],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "uuid",
            "uuidstr"
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virStoragePoolObjPtr\nvirStoragePoolObjFindByUUIDLocked(virStoragePoolObjListPtr pools,\n                                  const unsigned char *uuid)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(uuid, uuidstr);\n\n    return virObjectRef(virHashLookup(pools->objs, uuidstr));\n}"
  },
  {
    "function_name": "virStoragePoolObjRemove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "524-539",
    "snippet": "void\nvirStoragePoolObjRemove(virStoragePoolObjListPtr pools,\n                        virStoragePoolObjPtr obj)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(obj->def->uuid, uuidstr);\n    virObjectRef(obj);\n    virObjectUnlock(obj);\n    virObjectRWLockWrite(pools);\n    virObjectLock(obj);\n    virHashRemoveEntry(pools->objs, uuidstr);\n    virHashRemoveEntry(pools->objsName, obj->def->name);\n    virObjectUnref(obj);\n    virObjectRWUnlock(pools);\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "pools"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "obj"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashRemoveEntry",
          "args": [
            "pools->objsName",
            "obj->def->name"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "584-609",
          "snippet": "int\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 534
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockWrite",
          "args": [
            "pools"
          ],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "482-491",
          "snippet": "void\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "obj"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "obj->def->uuid",
            "uuidstr"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjRemove(virStoragePoolObjListPtr pools,\n                        virStoragePoolObjPtr obj)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(obj->def->uuid, uuidstr);\n    virObjectRef(obj);\n    virObjectUnlock(obj);\n    virObjectRWLockWrite(pools);\n    virObjectLock(obj);\n    virHashRemoveEntry(pools->objs, uuidstr);\n    virHashRemoveEntry(pools->objsName, obj->def->name);\n    virObjectUnref(obj);\n    virObjectRWUnlock(pools);\n}"
  },
  {
    "function_name": "virStoragePoolObjListSearch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "507-521",
    "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjListSearch(virStoragePoolObjListPtr pools,\n                            virStoragePoolObjListSearcher searcher,\n                            const void *opaque)\n{\n    virStoragePoolObjPtr obj = NULL;\n    struct _virStoragePoolObjListSearchData data = { .searcher = searcher,\n                                                     .opaque = opaque };\n\n    virObjectRWLockRead(pools);\n    obj = virHashSearch(pools->objs, virStoragePoolObjListSearchCb, &data, NULL);\n    virObjectRWUnlock(pools);\n\n    return virObjectRef(obj);\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "obj"
          ],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "pools"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashSearch",
          "args": [
            "pools->objs",
            "virStoragePoolObjListSearchCb",
            "&data",
            "NULL"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "736-761",
          "snippet": "void *virHashSearch(const virHashTable *ctable,\n                    virHashSearcher iter,\n                    const void *data,\n                    void **name)\n{\n    size_t i;\n\n    /* Cast away const for internal detection of misuse.  */\n    virHashTablePtr table = (virHashTablePtr)ctable;\n\n    if (table == NULL || iter == NULL)\n        return NULL;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry;\n        for (entry = table->table[i]; entry; entry = entry->next) {\n            if (iter(entry->payload, entry->name, data)) {\n                if (name)\n                    *name = table->keyCopy(entry->name);\n                return entry->payload;\n            }\n        }\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *virHashSearch(const virHashTable *ctable,\n                    virHashSearcher iter,\n                    const void *data,\n                    void **name)\n{\n    size_t i;\n\n    /* Cast away const for internal detection of misuse.  */\n    virHashTablePtr table = (virHashTablePtr)ctable;\n\n    if (table == NULL || iter == NULL)\n        return NULL;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry;\n        for (entry = table->table[i]; entry; entry = entry->next) {\n            if (iter(entry->payload, entry->name, data)) {\n                if (name)\n                    *name = table->keyCopy(entry->name);\n                return entry->payload;\n            }\n        }\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "pools"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nvirStoragePoolObjPtr\nvirStoragePoolObjListSearch(virStoragePoolObjListPtr pools,\n                            virStoragePoolObjListSearcher searcher,\n                            const void *opaque)\n{\n    virStoragePoolObjPtr obj = NULL;\n    struct _virStoragePoolObjListSearchData data = { .searcher = searcher,\n                                                     .opaque = opaque };\n\n    virObjectRWLockRead(pools);\n    obj = virHashSearch(pools->objs, virStoragePoolObjListSearchCb, &data, NULL);\n    virObjectRWUnlock(pools);\n\n    return virObjectRef(obj);\n}"
  },
  {
    "function_name": "virStoragePoolObjListSearchCb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "478-492",
    "snippet": "static int\nvirStoragePoolObjListSearchCb(const void *payload,\n                              const void *name G_GNUC_UNUSED,\n                              const void *opaque)\n{\n    virStoragePoolObjPtr obj = (virStoragePoolObjPtr) payload;\n    struct _virStoragePoolObjListSearchData *data =\n        (struct _virStoragePoolObjListSearchData *)opaque;\n\n    virObjectLock(obj);\n    if (data->searcher(obj, data->opaque))\n        return 1;\n    virObjectUnlock(obj);\n    return 0;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->searcher",
          "args": [
            "obj",
            "data->opaque"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nstatic int\nvirStoragePoolObjListSearchCb(const void *payload,\n                              const void *name G_GNUC_UNUSED,\n                              const void *opaque)\n{\n    virStoragePoolObjPtr obj = (virStoragePoolObjPtr) payload;\n    struct _virStoragePoolObjListSearchData *data =\n        (struct _virStoragePoolObjListSearchData *)opaque;\n\n    virObjectLock(obj);\n    if (data->searcher(obj, data->opaque))\n        return 1;\n    virObjectUnlock(obj);\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolObjListForEach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "460-469",
    "snippet": "void\nvirStoragePoolObjListForEach(virStoragePoolObjListPtr pools,\n                             virStoragePoolObjListIterator iter,\n                             const void *opaque)\n{\n    struct _virStoragePoolObjListForEachData data = { .iter = iter,\n                                                      .opaque = opaque };\n\n    virHashForEach(pools->objs, virStoragePoolObjListForEachCb, &data);\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "pools->objs",
            "virStoragePoolObjListForEachCb",
            "&data"
          ],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nvoid\nvirStoragePoolObjListForEach(virStoragePoolObjListPtr pools,\n                             virStoragePoolObjListIterator iter,\n                             const void *opaque)\n{\n    struct _virStoragePoolObjListForEachData data = { .iter = iter,\n                                                      .opaque = opaque };\n\n    virHashForEach(pools->objs, virStoragePoolObjListForEachCb, &data);\n}"
  },
  {
    "function_name": "virStoragePoolObjListForEachCb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "422-439",
    "snippet": "static int\nvirStoragePoolObjListForEachCb(void *payload,\n                               const void *name G_GNUC_UNUSED,\n                               void *opaque)\n{\n    virStoragePoolObjPtr obj = payload;\n    struct _virStoragePoolObjListForEachData *data = opaque;\n\n    /* Grab a reference so that we don't rely only on references grabbed by\n     * hash table earlier. Remember, an iterator can remove object from the\n     * hash table. */\n    virObjectRef(obj);\n    virObjectLock(obj);\n    data->iter(obj, data->opaque);\n    virStoragePoolObjEndAPI(&obj);\n\n    return 0;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "234-243",
          "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->iter",
          "args": [
            "obj",
            "data->opaque"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "obj"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nstatic int\nvirStoragePoolObjListForEachCb(void *payload,\n                               const void *name G_GNUC_UNUSED,\n                               void *opaque)\n{\n    virStoragePoolObjPtr obj = payload;\n    struct _virStoragePoolObjListForEachData *data = opaque;\n\n    /* Grab a reference so that we don't rely only on references grabbed by\n     * hash table earlier. Remember, an iterator can remove object from the\n     * hash table. */\n    virObjectRef(obj);\n    virObjectLock(obj);\n    data->iter(obj, data->opaque);\n    virStoragePoolObjEndAPI(&obj);\n\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolObjListNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "396-414",
    "snippet": "virStoragePoolObjListPtr\nvirStoragePoolObjListNew(void)\n{\n    virStoragePoolObjListPtr pools;\n\n    if (virStoragePoolObjInitialize() < 0)\n        return NULL;\n\n    if (!(pools = virObjectRWLockableNew(virStoragePoolObjListClass)))\n        return NULL;\n\n    if (!(pools->objs = virHashCreate(20, virObjectFreeHashData)) ||\n        !(pools->objsName = virHashCreate(20, virObjectFreeHashData))) {\n        virObjectUnref(pools);\n        return NULL;\n    }\n\n    return pools;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virStoragePoolObjListClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "pools"
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "20",
            "virObjectFreeHashData"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockableNew",
          "args": [
            "virStoragePoolObjListClass"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "282-305",
          "snippet": "void *\nvirObjectRWLockableNew(virClassPtr klass)\n{\n    virObjectRWLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectRWLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectRWLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virRWLockInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize RW lock\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectRWLockableNew(virClassPtr klass)\n{\n    virObjectRWLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectRWLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectRWLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virRWLockInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize RW lock\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjInitialize",
          "args": [],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virClassPtr virStoragePoolObjListClass;\n\nvirStoragePoolObjListPtr\nvirStoragePoolObjListNew(void)\n{\n    virStoragePoolObjListPtr pools;\n\n    if (virStoragePoolObjInitialize() < 0)\n        return NULL;\n\n    if (!(pools = virObjectRWLockableNew(virStoragePoolObjListClass)))\n        return NULL;\n\n    if (!(pools->objs = virHashCreate(20, virObjectFreeHashData)) ||\n        !(pools->objsName = virHashCreate(20, virObjectFreeHashData))) {\n        virObjectUnref(pools);\n        return NULL;\n    }\n\n    return pools;\n}"
  },
  {
    "function_name": "virStoragePoolObjListDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "386-393",
    "snippet": "void\nvirStoragePoolObjListDispose(void *opaque)\n{\n    virStoragePoolObjListPtr pools = opaque;\n\n    virHashFree(pools->objs);\n    virHashFree(pools->objsName);\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "pools->objsName"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nvoid\nvirStoragePoolObjListDispose(void *opaque)\n{\n    virStoragePoolObjListPtr pools = opaque;\n\n    virHashFree(pools->objs);\n    virHashFree(pools->objsName);\n}"
  },
  {
    "function_name": "virStoragePoolObjDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "370-383",
    "snippet": "void\nvirStoragePoolObjDispose(void *opaque)\n{\n    virStoragePoolObjPtr obj = opaque;\n\n    virStoragePoolObjClearVols(obj);\n    virObjectUnref(obj->volumes);\n\n    virStoragePoolDefFree(obj->def);\n    virStoragePoolDefFree(obj->newDef);\n\n    VIR_FREE(obj->configFile);\n    VIR_FREE(obj->autostartLink);\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "obj->autostartLink"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "obj->configFile"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolDefFree",
          "args": [
            "obj->newDef"
          ],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "504-520",
          "snippet": "void\nvirStoragePoolDefFree(virStoragePoolDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    virStoragePoolSourceClear(&def->source);\n\n    VIR_FREE(def->target.path);\n    VIR_FREE(def->target.perms.label);\n    VIR_FREE(def->refresh);\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirStoragePoolDefFree(virStoragePoolDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    virStoragePoolSourceClear(&def->source);\n\n    VIR_FREE(def->target.path);\n    VIR_FREE(def->target.perms.label);\n    VIR_FREE(def->refresh);\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "obj->volumes"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjClearVols",
          "args": [
            "obj"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolObjClearVols",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "629-638",
          "snippet": "void\nvirStoragePoolObjClearVols(virStoragePoolObjPtr obj)\n{\n    if (!obj->volumes)\n        return;\n\n    virHashRemoveAll(obj->volumes->objsKey);\n    virHashRemoveAll(obj->volumes->objsName);\n    virHashRemoveAll(obj->volumes->objsPath);\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjClearVols(virStoragePoolObjPtr obj)\n{\n    if (!obj->volumes)\n        return;\n\n    virHashRemoveAll(obj->volumes->objsKey);\n    virHashRemoveAll(obj->volumes->objsName);\n    virHashRemoveAll(obj->volumes->objsPath);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nvoid\nvirStoragePoolObjDispose(void *opaque)\n{\n    virStoragePoolObjPtr obj = opaque;\n\n    virStoragePoolObjClearVols(obj);\n    virObjectUnref(obj->volumes);\n\n    virStoragePoolDefFree(obj->def);\n    virStoragePoolDefFree(obj->newDef);\n\n    VIR_FREE(obj->configFile);\n    VIR_FREE(obj->autostartLink);\n}"
  },
  {
    "function_name": "virStoragePoolObjDecrAsyncjobs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "363-367",
    "snippet": "void\nvirStoragePoolObjDecrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs--;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjDecrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs--;\n}"
  },
  {
    "function_name": "virStoragePoolObjIncrAsyncjobs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "356-360",
    "snippet": "void\nvirStoragePoolObjIncrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs++;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjIncrAsyncjobs(virStoragePoolObjPtr obj)\n{\n    obj->asyncjobs++;\n}"
  },
  {
    "function_name": "virStoragePoolObjGetAsyncjobs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "349-353",
    "snippet": "unsigned int\nvirStoragePoolObjGetAsyncjobs(virStoragePoolObjPtr obj)\n{\n    return obj->asyncjobs;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nunsigned int\nvirStoragePoolObjGetAsyncjobs(virStoragePoolObjPtr obj)\n{\n    return obj->asyncjobs;\n}"
  },
  {
    "function_name": "virStoragePoolObjSetAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "341-346",
    "snippet": "void\nvirStoragePoolObjSetAutostart(virStoragePoolObjPtr obj,\n                              bool autostart)\n{\n    obj->autostart = autostart;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjSetAutostart(virStoragePoolObjPtr obj,\n                              bool autostart)\n{\n    obj->autostart = autostart;\n}"
  },
  {
    "function_name": "virStoragePoolObjIsAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "331-338",
    "snippet": "bool\nvirStoragePoolObjIsAutostart(virStoragePoolObjPtr obj)\n{\n    if (!obj->configFile)\n        return 0;\n\n    return obj->autostart;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsAutostart(virStoragePoolObjPtr obj)\n{\n    if (!obj->configFile)\n        return 0;\n\n    return obj->autostart;\n}"
  },
  {
    "function_name": "virStoragePoolObjIsStarting",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "324-328",
    "snippet": "bool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsStarting(virStoragePoolObjPtr obj)\n{\n    return obj->starting;\n}"
  },
  {
    "function_name": "virStoragePoolObjSetStarting",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "316-321",
    "snippet": "void\nvirStoragePoolObjSetStarting(virStoragePoolObjPtr obj,\n                             bool starting)\n{\n    obj->starting = starting;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjSetStarting(virStoragePoolObjPtr obj,\n                             bool starting)\n{\n    obj->starting = starting;\n}"
  },
  {
    "function_name": "virStoragePoolObjSetActive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "308-313",
    "snippet": "void\nvirStoragePoolObjSetActive(virStoragePoolObjPtr obj,\n                           bool active)\n{\n    obj->active = active;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjSetActive(virStoragePoolObjPtr obj,\n                           bool active)\n{\n    obj->active = active;\n}"
  },
  {
    "function_name": "virStoragePoolObjIsActive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "301-305",
    "snippet": "bool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirStoragePoolObjIsActive(virStoragePoolObjPtr obj)\n{\n    return obj->active;\n}"
  },
  {
    "function_name": "virStoragePoolObjGetAutostartLink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "294-298",
    "snippet": "const char *\nvirStoragePoolObjGetAutostartLink(virStoragePoolObjPtr obj)\n{\n    return obj->autostartLink;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nconst char *\nvirStoragePoolObjGetAutostartLink(virStoragePoolObjPtr obj)\n{\n    return obj->autostartLink;\n}"
  },
  {
    "function_name": "virStoragePoolObjSetConfigFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "285-291",
    "snippet": "void\nvirStoragePoolObjSetConfigFile(virStoragePoolObjPtr obj,\n                               char *configFile)\n{\n    VIR_FREE(obj->configFile);\n    obj->configFile = configFile;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "obj->configFile"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjSetConfigFile(virStoragePoolObjPtr obj,\n                               char *configFile)\n{\n    VIR_FREE(obj->configFile);\n    obj->configFile = configFile;\n}"
  },
  {
    "function_name": "virStoragePoolObjGetConfigFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "278-282",
    "snippet": "const char *\nvirStoragePoolObjGetConfigFile(virStoragePoolObjPtr obj)\n{\n    return obj->configFile;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nconst char *\nvirStoragePoolObjGetConfigFile(virStoragePoolObjPtr obj)\n{\n    return obj->configFile;\n}"
  },
  {
    "function_name": "virStoragePoolObjDefUseNewDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "269-275",
    "snippet": "void\nvirStoragePoolObjDefUseNewDef(virStoragePoolObjPtr obj)\n{\n    virStoragePoolDefFree(obj->def);\n    obj->def = obj->newDef;\n    obj->newDef = NULL;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolDefFree",
          "args": [
            "obj->def"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "504-520",
          "snippet": "void\nvirStoragePoolDefFree(virStoragePoolDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    virStoragePoolSourceClear(&def->source);\n\n    VIR_FREE(def->target.path);\n    VIR_FREE(def->target.perms.label);\n    VIR_FREE(def->refresh);\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirStoragePoolDefFree(virStoragePoolDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    virStoragePoolSourceClear(&def->source);\n\n    VIR_FREE(def->target.path);\n    VIR_FREE(def->target.perms.label);\n    VIR_FREE(def->refresh);\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjDefUseNewDef(virStoragePoolObjPtr obj)\n{\n    virStoragePoolDefFree(obj->def);\n    obj->def = obj->newDef;\n    obj->newDef = NULL;\n}"
  },
  {
    "function_name": "virStoragePoolObjGetNewDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "262-266",
    "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetNewDef(virStoragePoolObjPtr obj)\n{\n    return obj->newDef;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetNewDef(virStoragePoolObjPtr obj)\n{\n    return obj->newDef;\n}"
  },
  {
    "function_name": "virStoragePoolObjSetDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "253-259",
    "snippet": "void\nvirStoragePoolObjSetDef(virStoragePoolObjPtr obj,\n                        virStoragePoolDefPtr def)\n{\n    virStoragePoolDefFree(obj->def);\n    obj->def = def;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolDefFree",
          "args": [
            "obj->def"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "504-520",
          "snippet": "void\nvirStoragePoolDefFree(virStoragePoolDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    virStoragePoolSourceClear(&def->source);\n\n    VIR_FREE(def->target.path);\n    VIR_FREE(def->target.perms.label);\n    VIR_FREE(def->refresh);\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirStoragePoolDefFree(virStoragePoolDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    virStoragePoolSourceClear(&def->source);\n\n    VIR_FREE(def->target.path);\n    VIR_FREE(def->target.perms.label);\n    VIR_FREE(def->refresh);\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjSetDef(virStoragePoolObjPtr obj,\n                        virStoragePoolDefPtr def)\n{\n    virStoragePoolDefFree(obj->def);\n    obj->def = def;\n}"
  },
  {
    "function_name": "virStoragePoolObjGetDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "246-250",
    "snippet": "virStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolObjGetDef(virStoragePoolObjPtr obj)\n{\n    return obj->def;\n}"
  },
  {
    "function_name": "virStoragePoolObjEndAPI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "234-243",
    "snippet": "void\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "*obj"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "*obj"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirStoragePoolObjEndAPI(virStoragePoolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
  },
  {
    "function_name": "virStoragePoolObjNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "212-231",
    "snippet": "virStoragePoolObjPtr\nvirStoragePoolObjNew(void)\n{\n    virStoragePoolObjPtr obj;\n\n    if (virStoragePoolObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virStoragePoolObjClass)))\n        return NULL;\n\n    if (!(obj->volumes = virStorageVolObjListNew())) {\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    virObjectLock(obj);\n    obj->active = false;\n    return obj;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virStoragePoolObjClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "obj"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolObjListNew",
          "args": [],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolObjListNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
          "lines": "164-183",
          "snippet": "static virStorageVolObjListPtr\nvirStorageVolObjListNew(void)\n{\n    virStorageVolObjListPtr vols;\n\n    if (virStorageVolObjInitialize() < 0)\n        return NULL;\n\n    if (!(vols = virObjectRWLockableNew(virStorageVolObjListClass)))\n        return NULL;\n\n    if (!(vols->objsKey = virHashCreate(10, virObjectFreeHashData)) ||\n        !(vols->objsName = virHashCreate(10, virObjectFreeHashData)) ||\n        !(vols->objsPath = virHashCreate(10, virObjectFreeHashData))) {\n        virObjectUnref(vols);\n        return NULL;\n    }\n\n    return vols;\n}",
          "includes": [
            "#include \"virvhba.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstorageobj.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virStorageVolObjListClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virClassPtr virStorageVolObjListClass;\n\nstatic virStorageVolObjListPtr\nvirStorageVolObjListNew(void)\n{\n    virStorageVolObjListPtr vols;\n\n    if (virStorageVolObjInitialize() < 0)\n        return NULL;\n\n    if (!(vols = virObjectRWLockableNew(virStorageVolObjListClass)))\n        return NULL;\n\n    if (!(vols->objsKey = virHashCreate(10, virObjectFreeHashData)) ||\n        !(vols->objsName = virHashCreate(10, virObjectFreeHashData)) ||\n        !(vols->objsPath = virHashCreate(10, virObjectFreeHashData))) {\n        virObjectUnref(vols);\n        return NULL;\n    }\n\n    return vols;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virStoragePoolObjClass"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolObjInitialize",
          "args": [],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virClassPtr virStoragePoolObjClass;\n\nvirStoragePoolObjPtr\nvirStoragePoolObjNew(void)\n{\n    virStoragePoolObjPtr obj;\n\n    if (virStoragePoolObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virStoragePoolObjClass)))\n        return NULL;\n\n    if (!(obj->volumes = virStorageVolObjListNew())) {\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    virObjectLock(obj);\n    obj->active = false;\n    return obj;\n}"
  },
  {
    "function_name": "virStoragePoolObjOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "197-207",
    "snippet": "static int\nvirStoragePoolObjOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virStoragePoolObj, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virStoragePoolObjList, virClassForObjectRWLockable()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virStoragePoolObjList",
            "virClassForObjectRWLockable()"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectRWLockable",
          "args": [],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectRWLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "131-138",
          "snippet": "virClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectRWLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectRWLockableClass;\n\nvirClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virStoragePoolObj",
            "virClassForObjectLockable()"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolObjOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virStoragePoolObj, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virStoragePoolObjList, virClassForObjectRWLockable()))\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virStorageVolObjListDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "186-194",
    "snippet": "static void\nvirStorageVolObjListDispose(void *opaque)\n{\n    virStorageVolObjListPtr vols = opaque;\n\n    virHashFree(vols->objsKey);\n    virHashFree(vols->objsName);\n    virHashFree(vols->objsPath);\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "vols->objsPath"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nstatic void\nvirStorageVolObjListDispose(void *opaque)\n{\n    virStorageVolObjListPtr vols = opaque;\n\n    virHashFree(vols->objsKey);\n    virHashFree(vols->objsName);\n    virHashFree(vols->objsPath);\n}"
  },
  {
    "function_name": "virStorageVolObjListNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "164-183",
    "snippet": "static virStorageVolObjListPtr\nvirStorageVolObjListNew(void)\n{\n    virStorageVolObjListPtr vols;\n\n    if (virStorageVolObjInitialize() < 0)\n        return NULL;\n\n    if (!(vols = virObjectRWLockableNew(virStorageVolObjListClass)))\n        return NULL;\n\n    if (!(vols->objsKey = virHashCreate(10, virObjectFreeHashData)) ||\n        !(vols->objsName = virHashCreate(10, virObjectFreeHashData)) ||\n        !(vols->objsPath = virHashCreate(10, virObjectFreeHashData))) {\n        virObjectUnref(vols);\n        return NULL;\n    }\n\n    return vols;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virStorageVolObjListClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "vols"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "10",
            "virObjectFreeHashData"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockableNew",
          "args": [
            "virStorageVolObjListClass"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "282-305",
          "snippet": "void *\nvirObjectRWLockableNew(virClassPtr klass)\n{\n    virObjectRWLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectRWLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectRWLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virRWLockInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize RW lock\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectRWLockableNew(virClassPtr klass)\n{\n    virObjectRWLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectRWLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectRWLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virRWLockInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize RW lock\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolObjInitialize",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virClassPtr virStorageVolObjListClass;\n\nstatic virStorageVolObjListPtr\nvirStorageVolObjListNew(void)\n{\n    virStorageVolObjListPtr vols;\n\n    if (virStorageVolObjInitialize() < 0)\n        return NULL;\n\n    if (!(vols = virObjectRWLockableNew(virStorageVolObjListClass)))\n        return NULL;\n\n    if (!(vols->objsKey = virHashCreate(10, virObjectFreeHashData)) ||\n        !(vols->objsName = virHashCreate(10, virObjectFreeHashData)) ||\n        !(vols->objsPath = virHashCreate(10, virObjectFreeHashData))) {\n        virObjectUnref(vols);\n        return NULL;\n    }\n\n    return vols;\n}"
  },
  {
    "function_name": "virStorageVolObjDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "155-161",
    "snippet": "static void\nvirStorageVolObjDispose(void *opaque)\n{\n    virStorageVolObjPtr obj = opaque;\n\n    virStorageVolDefFree(obj->voldef);\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirStoragePoolObjDispose(void *opaque);",
      "static void\nvirStoragePoolObjListDispose(void *opaque);",
      "static void\nvirStorageVolObjDispose(void *opaque);",
      "static void\nvirStorageVolObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStorageVolDefFree",
          "args": [
            "obj->voldef"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "443-460",
          "snippet": "void\nvirStorageVolDefFree(virStorageVolDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->key);\n\n    for (i = 0; i < def->source.nextent; i++)\n        VIR_FREE(def->source.extents[i].path);\n    VIR_FREE(def->source.extents);\n\n    virStorageSourceClear(&def->target);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirStorageVolDefFree(virStorageVolDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->key);\n\n    for (i = 0; i < def->source.nextent; i++)\n        VIR_FREE(def->source.extents[i].path);\n    VIR_FREE(def->source.extents);\n\n    virStorageSourceClear(&def->target);\n    VIR_FREE(def);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolObjDispose(void *opaque);\nstatic void\nvirStoragePoolObjListDispose(void *opaque);\nstatic void\nvirStorageVolObjDispose(void *opaque);\nstatic void\nvirStorageVolObjListDispose(void *opaque);\n\nstatic void\nvirStorageVolObjDispose(void *opaque)\n{\n    virStorageVolObjPtr obj = opaque;\n\n    virStorageVolDefFree(obj->voldef);\n}"
  },
  {
    "function_name": "virStorageVolObjEndAPI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "143-152",
    "snippet": "static void\nvirStorageVolObjEndAPI(virStorageVolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "*obj"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "*obj"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirStorageVolObjEndAPI(virStorageVolObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
  },
  {
    "function_name": "virStorageVolObjNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "127-140",
    "snippet": "static virStorageVolObjPtr\nvirStorageVolObjNew(void)\n{\n    virStorageVolObjPtr obj;\n\n    if (virStorageVolObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virStorageVolObjClass)))\n        return NULL;\n\n    virObjectLock(obj);\n    return obj;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virStorageVolObjClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virStorageVolObjClass"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolObjInitialize",
          "args": [],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virClassPtr virStorageVolObjClass;\n\nstatic virStorageVolObjPtr\nvirStorageVolObjNew(void)\n{\n    virStorageVolObjPtr obj;\n\n    if (virStorageVolObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virStorageVolObjClass)))\n        return NULL;\n\n    virObjectLock(obj);\n    return obj;\n}"
  },
  {
    "function_name": "virStorageVolObjOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virstorageobj.c",
    "lines": "112-122",
    "snippet": "static int\nvirStorageVolObjOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virStorageVolObj, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virStorageVolObjList, virClassForObjectRWLockable()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virvhba.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virstorageobj.h\"",
      "#include \"node_device_util.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virStorageVolObjList",
            "virClassForObjectRWLockable()"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectRWLockable",
          "args": [],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectRWLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "131-138",
          "snippet": "virClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectRWLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectRWLockableClass;\n\nvirClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virStorageVolObj",
            "virClassForObjectLockable()"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virvhba.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virstorageobj.h\"\n#include \"node_device_util.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirStorageVolObjOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virStorageVolObj, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virStorageVolObjList, virClassForObjectRWLockable()))\n        return -1;\n\n    return 0;\n}"
  }
]