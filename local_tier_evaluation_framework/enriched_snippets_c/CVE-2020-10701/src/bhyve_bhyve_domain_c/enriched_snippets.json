[
  {
    "function_name": "bhyveDomainDefNamespaceFormatXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_domain.c",
    "lines": "245-266",
    "snippet": "static int\nbhyveDomainDefNamespaceFormatXML(virBufferPtr buf,\n                                 void *nsdata)\n{\n    bhyveDomainCmdlineDefPtr cmd = nsdata;\n    size_t i;\n\n    if (!cmd->num_args)\n        return 0;\n\n    virBufferAddLit(buf, \"<bhyve:commandline>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < cmd->num_args; i++)\n        virBufferEscapeString(buf, \"<bhyve:arg value='%s'/>\\n\",\n                              cmd->args[i]);\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</bhyve:commandline>\\n\");\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"bhyve_driver.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</bhyve:commandline>\\n\""
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\"<bhyve:arg value='%s'/>\\n\"",
            "cmd->args[i]"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<bhyve:commandline>\\n\""
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"bhyve_capabilities.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"bhyve_driver.h\"\n#include <config.h>\n\nstatic int\nbhyveDomainDefNamespaceFormatXML(virBufferPtr buf,\n                                 void *nsdata)\n{\n    bhyveDomainCmdlineDefPtr cmd = nsdata;\n    size_t i;\n\n    if (!cmd->num_args)\n        return 0;\n\n    virBufferAddLit(buf, \"<bhyve:commandline>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < cmd->num_args; i++)\n        virBufferEscapeString(buf, \"<bhyve:arg value='%s'/>\\n\",\n                              cmd->args[i]);\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</bhyve:commandline>\\n\");\n\n    return 0;\n}"
  },
  {
    "function_name": "bhyveDomainDefNamespaceParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_domain.c",
    "lines": "203-243",
    "snippet": "static int\nbhyveDomainDefNamespaceParse(xmlXPathContextPtr ctxt,\n                             void **data)\n{\n    bhyveDomainCmdlineDefPtr cmd = NULL;\n    xmlNodePtr *nodes = NULL;\n    int n;\n    size_t i;\n    int ret = -1;\n\n    if (VIR_ALLOC(cmd) < 0)\n        return -1;\n\n    n = virXPathNodeSet(\"./bhyve:commandline/bhyve:arg\", ctxt, &nodes);\n    if (n == 0)\n        ret = 0;\n    if (n <= 0)\n        goto cleanup;\n\n    if (VIR_ALLOC_N(cmd->args, n) < 0)\n        goto cleanup;\n\n    for (i = 0; i < n; i++) {\n        cmd->args[cmd->num_args] = virXMLPropString(nodes[i], \"value\");\n        if (cmd->args[cmd->num_args] == NULL) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           \"%s\", _(\"No bhyve command-line argument specified\"));\n            goto cleanup;\n        }\n        cmd->num_args++;\n    }\n\n    *data = g_steal_pointer(&cmd);\n    ret = 0;\n\n cleanup:\n    VIR_FREE(nodes);\n    bhyveDomainDefNamespaceFree(cmd);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"bhyve_driver.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bhyveDomainDefNamespaceFree",
          "args": [
            "cmd"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomainDefNamespaceFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_domain.c",
          "lines": "195-201",
          "snippet": "static void\nbhyveDomainDefNamespaceFree(void *nsdata)\n{\n    bhyveDomainCmdlineDefPtr cmd = nsdata;\n\n    bhyveDomainCmdlineDefFree(cmd);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"bhyve_driver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"bhyve_capabilities.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"bhyve_driver.h\"\n#include <config.h>\n\nstatic void\nbhyveDomainDefNamespaceFree(void *nsdata)\n{\n    bhyveDomainCmdlineDefPtr cmd = nsdata;\n\n    bhyveDomainCmdlineDefFree(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "nodes"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&cmd"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"No bhyve command-line argument specified\")"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"No bhyve command-line argument specified\""
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "nodes[i]",
            "\"value\""
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "cmd->args",
            "n"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXPathNodeSet",
          "args": [
            "\"./bhyve:commandline/bhyve:arg\"",
            "ctxt",
            "&nodes"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNodeSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "647-694",
          "snippet": "int\nvirXPathNodeSet(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                xmlNodePtr **list)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNodeSet()\"));\n        return -1;\n    }\n\n    if (list != NULL)\n        *list = NULL;\n\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if (obj == NULL)\n        return 0;\n\n    if (obj->type != XPATH_NODESET) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Incorrect xpath '%s'\"), xpath);\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    if ((obj->nodesetval == NULL)  || (obj->nodesetval->nodeNr < 0)) {\n        xmlXPathFreeObject(obj);\n        return 0;\n    }\n\n    ret = obj->nodesetval->nodeNr;\n    if (list != NULL && ret) {\n        if (VIR_ALLOC_N(*list, ret) < 0) {\n            ret = -1;\n        } else {\n            memcpy(*list, obj->nodesetval->nodeTab,\n                   ret * sizeof(xmlNodePtr));\n        }\n    }\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathNodeSet(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                xmlNodePtr **list)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNodeSet()\"));\n        return -1;\n    }\n\n    if (list != NULL)\n        *list = NULL;\n\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if (obj == NULL)\n        return 0;\n\n    if (obj->type != XPATH_NODESET) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Incorrect xpath '%s'\"), xpath);\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    if ((obj->nodesetval == NULL)  || (obj->nodesetval->nodeNr < 0)) {\n        xmlXPathFreeObject(obj);\n        return 0;\n    }\n\n    ret = obj->nodesetval->nodeNr;\n    if (list != NULL && ret) {\n        if (VIR_ALLOC_N(*list, ret) < 0) {\n            ret = -1;\n        } else {\n            memcpy(*list, obj->nodesetval->nodeTab,\n                   ret * sizeof(xmlNodePtr));\n        }\n    }\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "cmd"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"bhyve_capabilities.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"bhyve_driver.h\"\n#include <config.h>\n\nstatic int\nbhyveDomainDefNamespaceParse(xmlXPathContextPtr ctxt,\n                             void **data)\n{\n    bhyveDomainCmdlineDefPtr cmd = NULL;\n    xmlNodePtr *nodes = NULL;\n    int n;\n    size_t i;\n    int ret = -1;\n\n    if (VIR_ALLOC(cmd) < 0)\n        return -1;\n\n    n = virXPathNodeSet(\"./bhyve:commandline/bhyve:arg\", ctxt, &nodes);\n    if (n == 0)\n        ret = 0;\n    if (n <= 0)\n        goto cleanup;\n\n    if (VIR_ALLOC_N(cmd->args, n) < 0)\n        goto cleanup;\n\n    for (i = 0; i < n; i++) {\n        cmd->args[cmd->num_args] = virXMLPropString(nodes[i], \"value\");\n        if (cmd->args[cmd->num_args] == NULL) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           \"%s\", _(\"No bhyve command-line argument specified\"));\n            goto cleanup;\n        }\n        cmd->num_args++;\n    }\n\n    *data = g_steal_pointer(&cmd);\n    ret = 0;\n\n cleanup:\n    VIR_FREE(nodes);\n    bhyveDomainDefNamespaceFree(cmd);\n\n    return ret;\n}"
  },
  {
    "function_name": "bhyveDomainDefNamespaceFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_domain.c",
    "lines": "195-201",
    "snippet": "static void\nbhyveDomainDefNamespaceFree(void *nsdata)\n{\n    bhyveDomainCmdlineDefPtr cmd = nsdata;\n\n    bhyveDomainCmdlineDefFree(cmd);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"bhyve_driver.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bhyveDomainCmdlineDefFree",
          "args": [
            "cmd"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomainCmdlineDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_conf.c",
          "lines": "103-116",
          "snippet": "void\nbhyveDomainCmdlineDefFree(bhyveDomainCmdlineDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    for (i = 0; i < def->num_args; i++)\n        VIR_FREE(def->args[i]);\n\n    VIR_FREE(def->args);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_conf.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nbhyveDomainCmdlineDefFree(bhyveDomainCmdlineDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    for (i = 0; i < def->num_args; i++)\n        VIR_FREE(def->args[i]);\n\n    VIR_FREE(def->args);\n    VIR_FREE(def);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"bhyve_capabilities.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"bhyve_driver.h\"\n#include <config.h>\n\nstatic void\nbhyveDomainDefNamespaceFree(void *nsdata)\n{\n    bhyveDomainCmdlineDefPtr cmd = nsdata;\n\n    bhyveDomainCmdlineDefFree(cmd);\n}"
  },
  {
    "function_name": "virBhyveDriverCreateXMLConf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_domain.c",
    "lines": "179-187",
    "snippet": "virDomainXMLOptionPtr\nvirBhyveDriverCreateXMLConf(bhyveConnPtr driver)\n{\n    virBhyveDriverDomainDefParserConfig.priv = driver;\n    return virDomainXMLOptionNew(&virBhyveDriverDomainDefParserConfig,\n                                 &virBhyveDriverPrivateDataCallbacks,\n                                 &virBhyveDriverDomainXMLNamespace,\n                                 NULL, NULL);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"bhyve_driver.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virDomainXMLPrivateDataCallbacks virBhyveDriverPrivateDataCallbacks = {\n    .alloc = bhyveDomainObjPrivateAlloc,\n    .free = bhyveDomainObjPrivateFree,\n};",
      "virDomainDefParserConfig virBhyveDriverDomainDefParserConfig = {\n    .devicesPostParseCallback = bhyveDomainDeviceDefPostParse,\n    .domainPostParseCallback = bhyveDomainDefPostParse,\n    .assignAddressesCallback = bhyveDomainDefAssignAddresses,\n};",
      "virXMLNamespace virBhyveDriverDomainXMLNamespace = {\n    .parse = bhyveDomainDefNamespaceParse,\n    .free = bhyveDomainDefNamespaceFree,\n    .format = bhyveDomainDefNamespaceFormatXML,\n    .prefix = \"bhyve\",\n    .uri = \"http://libvirt.org/schemas/domain/bhyve/1.0\",\n\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainXMLOptionNew",
          "args": [
            "&virBhyveDriverDomainDefParserConfig",
            "&virBhyveDriverPrivateDataCallbacks",
            "&virBhyveDriverDomainXMLNamespace",
            "NULL",
            "NULL"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainXMLOptionNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1415-1458",
          "snippet": "virDomainXMLOptionPtr\nvirDomainXMLOptionNew(virDomainDefParserConfigPtr config,\n                      virDomainXMLPrivateDataCallbacksPtr priv,\n                      virXMLNamespacePtr xmlns,\n                      virDomainABIStabilityPtr abi,\n                      virSaveCookieCallbacksPtr saveCookie)\n{\n    virDomainXMLOptionPtr xmlopt;\n\n    if (virDomainObjInitialize() < 0)\n        return NULL;\n\n    if (!(xmlopt = virObjectNew(virDomainXMLOptionClass)))\n        return NULL;\n\n    if (priv)\n        xmlopt->privateData = *priv;\n\n    if (config)\n        xmlopt->config = *config;\n\n    if (xmlns)\n        xmlopt->ns = *xmlns;\n\n    if (abi)\n        xmlopt->abi = *abi;\n\n    if (saveCookie)\n        xmlopt->saveCookie = *saveCookie;\n\n    /* Technically this forbids to use one of Xerox's MAC address prefixes in\n     * our hypervisor drivers. This shouldn't ever be a problem.\n     *\n     * Use the KVM prefix as default as it's in the privately administered\n     * range */\n    if (xmlopt->config.macPrefix[0] == 0 &&\n        xmlopt->config.macPrefix[1] == 0 &&\n        xmlopt->config.macPrefix[2] == 0) {\n        xmlopt->config.macPrefix[0] = 0x52;\n        xmlopt->config.macPrefix[1] = 0x54;\n    }\n\n    return xmlopt;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virDomainXMLOptionClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virClassPtr virDomainXMLOptionClass;\n\nvirDomainXMLOptionPtr\nvirDomainXMLOptionNew(virDomainDefParserConfigPtr config,\n                      virDomainXMLPrivateDataCallbacksPtr priv,\n                      virXMLNamespacePtr xmlns,\n                      virDomainABIStabilityPtr abi,\n                      virSaveCookieCallbacksPtr saveCookie)\n{\n    virDomainXMLOptionPtr xmlopt;\n\n    if (virDomainObjInitialize() < 0)\n        return NULL;\n\n    if (!(xmlopt = virObjectNew(virDomainXMLOptionClass)))\n        return NULL;\n\n    if (priv)\n        xmlopt->privateData = *priv;\n\n    if (config)\n        xmlopt->config = *config;\n\n    if (xmlns)\n        xmlopt->ns = *xmlns;\n\n    if (abi)\n        xmlopt->abi = *abi;\n\n    if (saveCookie)\n        xmlopt->saveCookie = *saveCookie;\n\n    /* Technically this forbids to use one of Xerox's MAC address prefixes in\n     * our hypervisor drivers. This shouldn't ever be a problem.\n     *\n     * Use the KVM prefix as default as it's in the privately administered\n     * range */\n    if (xmlopt->config.macPrefix[0] == 0 &&\n        xmlopt->config.macPrefix[1] == 0 &&\n        xmlopt->config.macPrefix[2] == 0) {\n        xmlopt->config.macPrefix[0] = 0x52;\n        xmlopt->config.macPrefix[1] = 0x54;\n    }\n\n    return xmlopt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"bhyve_capabilities.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"bhyve_driver.h\"\n#include <config.h>\n\nvirDomainXMLPrivateDataCallbacks virBhyveDriverPrivateDataCallbacks = {\n    .alloc = bhyveDomainObjPrivateAlloc,\n    .free = bhyveDomainObjPrivateFree,\n};\nvirDomainDefParserConfig virBhyveDriverDomainDefParserConfig = {\n    .devicesPostParseCallback = bhyveDomainDeviceDefPostParse,\n    .domainPostParseCallback = bhyveDomainDefPostParse,\n    .assignAddressesCallback = bhyveDomainDefAssignAddresses,\n};\nvirXMLNamespace virBhyveDriverDomainXMLNamespace = {\n    .parse = bhyveDomainDefNamespaceParse,\n    .free = bhyveDomainDefNamespaceFree,\n    .format = bhyveDomainDefNamespaceFormatXML,\n    .prefix = \"bhyve\",\n    .uri = \"http://libvirt.org/schemas/domain/bhyve/1.0\",\n\n};\n\nvirDomainXMLOptionPtr\nvirBhyveDriverCreateXMLConf(bhyveConnPtr driver)\n{\n    virBhyveDriverDomainDefParserConfig.priv = driver;\n    return virDomainXMLOptionNew(&virBhyveDriverDomainDefParserConfig,\n                                 &virBhyveDriverPrivateDataCallbacks,\n                                 &virBhyveDriverDomainXMLNamespace,\n                                 NULL, NULL);\n}"
  },
  {
    "function_name": "bhyveDomainDefAssignAddresses",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_domain.c",
    "lines": "167-177",
    "snippet": "static int\nbhyveDomainDefAssignAddresses(virDomainDef *def,\n                              unsigned int parseFlags G_GNUC_UNUSED,\n                              void *opaque G_GNUC_UNUSED,\n                              void *parseOpaque G_GNUC_UNUSED)\n{\n    if (bhyveDomainAssignAddresses(def, NULL) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"bhyve_driver.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bhyveDomainAssignAddresses",
          "args": [
            "def",
            "NULL"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomainAssignAddresses",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_device.c",
          "lines": "186-189",
          "snippet": "int bhyveDomainAssignAddresses(virDomainDefPtr def, virDomainObjPtr obj)\n{\n    return bhyveDomainAssignPCIAddresses(def, obj);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_addr.h\"",
            "#include \"bhyve_device.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"domain_addr.h\"\n#include \"bhyve_device.h\"\n#include <config.h>\n\nint bhyveDomainAssignAddresses(virDomainDefPtr def, virDomainObjPtr obj)\n{\n    return bhyveDomainAssignPCIAddresses(def, obj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"bhyve_capabilities.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"bhyve_driver.h\"\n#include <config.h>\n\nstatic int\nbhyveDomainDefAssignAddresses(virDomainDef *def,\n                              unsigned int parseFlags G_GNUC_UNUSED,\n                              void *opaque G_GNUC_UNUSED,\n                              void *parseOpaque G_GNUC_UNUSED)\n{\n    if (bhyveDomainAssignAddresses(def, NULL) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "bhyveDomainDeviceDefPostParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_domain.c",
    "lines": "133-165",
    "snippet": "static int\nbhyveDomainDeviceDefPostParse(virDomainDeviceDefPtr dev,\n                              const virDomainDef *def,\n                              unsigned int parseFlags G_GNUC_UNUSED,\n                              void *opaque,\n                              void *parseOpaque G_GNUC_UNUSED)\n{\n    bhyveConnPtr driver = opaque;\n\n    if (dev->type == VIR_DOMAIN_DEVICE_DISK) {\n        virDomainDiskDefPtr disk = dev->data.disk;\n\n        if (disk->info.type == VIR_DOMAIN_DEVICE_ADDRESS_TYPE_NONE &&\n            bhyveDomainDiskDefAssignAddress(driver, disk, def) < 0)\n            return -1;\n    }\n\n    if (dev->type == VIR_DOMAIN_DEVICE_CONTROLLER) {\n        virDomainControllerDefPtr cont = dev->data.controller;\n\n        if (cont->type == VIR_DOMAIN_CONTROLLER_TYPE_PCI &&\n            (cont->model == VIR_DOMAIN_CONTROLLER_MODEL_PCI_ROOT ||\n             cont->model == VIR_DOMAIN_CONTROLLER_MODEL_PCIE_ROOT) &&\n            cont->idx != 0) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"pci-root and pcie-root controllers \"\n                             \"should have index 0\"));\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"bhyve_driver.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"pci-root and pcie-root controllers \"\n                             \"should have index 0\")"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"pci-root and pcie-root controllers \"\n                             \"should have index 0\""
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bhyveDomainDiskDefAssignAddress",
          "args": [
            "driver",
            "disk",
            "def"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDomainDiskDefAssignAddress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_domain.c",
          "lines": "101-131",
          "snippet": "static int\nbhyveDomainDiskDefAssignAddress(bhyveConnPtr driver,\n                                virDomainDiskDefPtr def,\n                                const virDomainDef *vmdef G_GNUC_UNUSED)\n{\n    int idx = virDiskNameToIndex(def->dst);\n\n    if (idx < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Unknown disk name '%s' and no address specified\"),\n                       def->dst);\n        return -1;\n    }\n\n    switch (def->bus) {\n    case VIR_DOMAIN_DISK_BUS_SATA:\n        def->info.type = VIR_DOMAIN_DEVICE_ADDRESS_TYPE_DRIVE;\n\n        if ((driver->bhyvecaps & BHYVE_CAP_AHCI32SLOT) != 0) {\n            def->info.addr.drive.controller = idx / 32;\n            def->info.addr.drive.unit = idx % 32;\n        } else {\n            def->info.addr.drive.controller = idx;\n            def->info.addr.drive.unit = 0;\n        }\n\n        def->info.addr.drive.bus = 0;\n        break;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"bhyve_driver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"bhyve_capabilities.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"bhyve_driver.h\"\n#include <config.h>\n\nstatic int\nbhyveDomainDiskDefAssignAddress(bhyveConnPtr driver,\n                                virDomainDiskDefPtr def,\n                                const virDomainDef *vmdef G_GNUC_UNUSED)\n{\n    int idx = virDiskNameToIndex(def->dst);\n\n    if (idx < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Unknown disk name '%s' and no address specified\"),\n                       def->dst);\n        return -1;\n    }\n\n    switch (def->bus) {\n    case VIR_DOMAIN_DISK_BUS_SATA:\n        def->info.type = VIR_DOMAIN_DEVICE_ADDRESS_TYPE_DRIVE;\n\n        if ((driver->bhyvecaps & BHYVE_CAP_AHCI32SLOT) != 0) {\n            def->info.addr.drive.controller = idx / 32;\n            def->info.addr.drive.unit = idx % 32;\n        } else {\n            def->info.addr.drive.controller = idx;\n            def->info.addr.drive.unit = 0;\n        }\n\n        def->info.addr.drive.bus = 0;\n        break;\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"bhyve_capabilities.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"bhyve_driver.h\"\n#include <config.h>\n\nstatic int\nbhyveDomainDeviceDefPostParse(virDomainDeviceDefPtr dev,\n                              const virDomainDef *def,\n                              unsigned int parseFlags G_GNUC_UNUSED,\n                              void *opaque,\n                              void *parseOpaque G_GNUC_UNUSED)\n{\n    bhyveConnPtr driver = opaque;\n\n    if (dev->type == VIR_DOMAIN_DEVICE_DISK) {\n        virDomainDiskDefPtr disk = dev->data.disk;\n\n        if (disk->info.type == VIR_DOMAIN_DEVICE_ADDRESS_TYPE_NONE &&\n            bhyveDomainDiskDefAssignAddress(driver, disk, def) < 0)\n            return -1;\n    }\n\n    if (dev->type == VIR_DOMAIN_DEVICE_CONTROLLER) {\n        virDomainControllerDefPtr cont = dev->data.controller;\n\n        if (cont->type == VIR_DOMAIN_CONTROLLER_TYPE_PCI &&\n            (cont->model == VIR_DOMAIN_CONTROLLER_MODEL_PCI_ROOT ||\n             cont->model == VIR_DOMAIN_CONTROLLER_MODEL_PCIE_ROOT) &&\n            cont->idx != 0) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"pci-root and pcie-root controllers \"\n                             \"should have index 0\"));\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "bhyveDomainDiskDefAssignAddress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_domain.c",
    "lines": "101-131",
    "snippet": "static int\nbhyveDomainDiskDefAssignAddress(bhyveConnPtr driver,\n                                virDomainDiskDefPtr def,\n                                const virDomainDef *vmdef G_GNUC_UNUSED)\n{\n    int idx = virDiskNameToIndex(def->dst);\n\n    if (idx < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Unknown disk name '%s' and no address specified\"),\n                       def->dst);\n        return -1;\n    }\n\n    switch (def->bus) {\n    case VIR_DOMAIN_DISK_BUS_SATA:\n        def->info.type = VIR_DOMAIN_DEVICE_ADDRESS_TYPE_DRIVE;\n\n        if ((driver->bhyvecaps & BHYVE_CAP_AHCI32SLOT) != 0) {\n            def->info.addr.drive.controller = idx / 32;\n            def->info.addr.drive.unit = idx % 32;\n        } else {\n            def->info.addr.drive.controller = idx;\n            def->info.addr.drive.unit = 0;\n        }\n\n        def->info.addr.drive.bus = 0;\n        break;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"bhyve_driver.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"Unknown disk name '%s' and no address specified\")",
            "def->dst"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unknown disk name '%s' and no address specified\""
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDiskNameToIndex",
          "args": [
            "def->dst"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "virDiskNameToIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "426-434",
          "snippet": "int virDiskNameToIndex(const char *name)\n{\n    int idx;\n\n    if (virDiskNameParse(name, &idx, NULL) < 0)\n        idx = -1;\n\n    return idx;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virDiskNameToIndex(const char *name)\n{\n    int idx;\n\n    if (virDiskNameParse(name, &idx, NULL) < 0)\n        idx = -1;\n\n    return idx;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"bhyve_capabilities.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"bhyve_driver.h\"\n#include <config.h>\n\nstatic int\nbhyveDomainDiskDefAssignAddress(bhyveConnPtr driver,\n                                virDomainDiskDefPtr def,\n                                const virDomainDef *vmdef G_GNUC_UNUSED)\n{\n    int idx = virDiskNameToIndex(def->dst);\n\n    if (idx < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Unknown disk name '%s' and no address specified\"),\n                       def->dst);\n        return -1;\n    }\n\n    switch (def->bus) {\n    case VIR_DOMAIN_DISK_BUS_SATA:\n        def->info.type = VIR_DOMAIN_DEVICE_ADDRESS_TYPE_DRIVE;\n\n        if ((driver->bhyvecaps & BHYVE_CAP_AHCI32SLOT) != 0) {\n            def->info.addr.drive.controller = idx / 32;\n            def->info.addr.drive.unit = idx % 32;\n        } else {\n            def->info.addr.drive.controller = idx;\n            def->info.addr.drive.unit = 0;\n        }\n\n        def->info.addr.drive.bus = 0;\n        break;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "bhyveDomainDefPostParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_domain.c",
    "lines": "77-99",
    "snippet": "static int\nbhyveDomainDefPostParse(virDomainDefPtr def,\n                        unsigned int parseFlags G_GNUC_UNUSED,\n                        void *opaque,\n                        void *parseOpaque G_GNUC_UNUSED)\n{\n    bhyveConnPtr driver = opaque;\n    g_autoptr(virCaps) caps = bhyveDriverGetCapabilities(driver);\n    if (!caps)\n        return -1;\n\n    if (!virCapabilitiesDomainSupported(caps, def->os.type,\n                                        def->os.arch,\n                                        def->virtType))\n        return -1;\n\n    /* Add an implicit PCI root controller */\n    if (virDomainDefMaybeAddController(def, VIR_DOMAIN_CONTROLLER_TYPE_PCI, 0,\n                                       VIR_DOMAIN_CONTROLLER_MODEL_PCI_ROOT) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"bhyve_driver.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainDefMaybeAddController",
          "args": [
            "def",
            "VIR_DOMAIN_CONTROLLER_TYPE_PCI",
            "0",
            "VIR_DOMAIN_CONTROLLER_MODEL_PCI_ROOT"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefMaybeAddController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "19009-19024",
          "snippet": "int\nvirDomainDefMaybeAddController(virDomainDefPtr def,\n                               int type,\n                               int idx,\n                               int model)\n{\n    /* skip if a specific index was given and it is already\n     * in use for that type of controller\n     */\n    if (idx >= 0 && virDomainControllerFind(def, type, idx) >= 0)\n        return 0;\n\n    if (virDomainDefAddController(def, type, idx, model))\n        return 1;\n    return -1;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefMaybeAddController(virDomainDefPtr def,\n                               int type,\n                               int idx,\n                               int model)\n{\n    /* skip if a specific index was given and it is already\n     * in use for that type of controller\n     */\n    if (idx >= 0 && virDomainControllerFind(def, type, idx) >= 0)\n        return 0;\n\n    if (virDomainDefAddController(def, type, idx, model))\n        return 1;\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCapabilitiesDomainSupported",
          "args": [
            "caps",
            "def->os.type",
            "def->os.arch",
            "def->virtType"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesDomainSupported",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "787-801",
          "snippet": "bool\nvirCapabilitiesDomainSupported(virCapsPtr caps,\n                               int ostype,\n                               virArch arch,\n                               int virttype)\n{\n    g_autofree virCapsDomainDataPtr capsdata = NULL;\n\n    capsdata = virCapabilitiesDomainDataLookup(caps, ostype,\n                                               arch,\n                                               virttype,\n                                               NULL, NULL);\n\n    return capsdata != NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirCapabilitiesDomainSupported(virCapsPtr caps,\n                               int ostype,\n                               virArch arch,\n                               int virttype)\n{\n    g_autofree virCapsDomainDataPtr capsdata = NULL;\n\n    capsdata = virCapabilitiesDomainDataLookup(caps, ostype,\n                                               arch,\n                                               virttype,\n                                               NULL, NULL);\n\n    return capsdata != NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bhyveDriverGetCapabilities",
          "args": [
            "driver"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"bhyve_capabilities.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"bhyve_driver.h\"\n#include <config.h>\n\nstatic int\nbhyveDomainDefPostParse(virDomainDefPtr def,\n                        unsigned int parseFlags G_GNUC_UNUSED,\n                        void *opaque,\n                        void *parseOpaque G_GNUC_UNUSED)\n{\n    bhyveConnPtr driver = opaque;\n    g_autoptr(virCaps) caps = bhyveDriverGetCapabilities(driver);\n    if (!caps)\n        return -1;\n\n    if (!virCapabilitiesDomainSupported(caps, def->os.type,\n                                        def->os.arch,\n                                        def->virtType))\n        return -1;\n\n    /* Add an implicit PCI root controller */\n    if (virDomainDefMaybeAddController(def, VIR_DOMAIN_CONTROLLER_TYPE_PCI, 0,\n                                       VIR_DOMAIN_CONTROLLER_MODEL_PCI_ROOT) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "bhyveDomainDefNeedsISAController",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_domain.c",
    "lines": "62-75",
    "snippet": "bool\nbhyveDomainDefNeedsISAController(virDomainDefPtr def)\n{\n    if (def->os.bootloader == NULL && def->os.loader)\n        return true;\n\n    if (def->nserials)\n        return true;\n\n    if (def->ngraphics && def->nvideos)\n        return true;\n\n    return false;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"bhyve_driver.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"bhyve_capabilities.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"bhyve_driver.h\"\n#include <config.h>\n\nbool\nbhyveDomainDefNeedsISAController(virDomainDefPtr def)\n{\n    if (def->os.bootloader == NULL && def->os.loader)\n        return true;\n\n    if (def->nserials)\n        return true;\n\n    if (def->ngraphics && def->nvideos)\n        return true;\n\n    return false;\n}"
  },
  {
    "function_name": "bhyveDomainObjPrivateFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_domain.c",
    "lines": "47-55",
    "snippet": "static void\nbhyveDomainObjPrivateFree(void *data)\n{\n    bhyveDomainObjPrivatePtr priv = data;\n\n    virDomainPCIAddressSetFree(priv->pciaddrs);\n\n    VIR_FREE(priv);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"bhyve_driver.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "priv"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainPCIAddressSetFree",
          "args": [
            "priv->pciaddrs"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainPCIAddressSetFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_addr.c",
          "lines": "1079-1088",
          "snippet": "void\nvirDomainPCIAddressSetFree(virDomainPCIAddressSetPtr addrs)\n{\n    if (!addrs)\n        return;\n\n    virDomainPCIAddressSetExtensionFree(addrs);\n    VIR_FREE(addrs->buses);\n    VIR_FREE(addrs);\n}",
          "includes": [
            "#include \"virhashcode.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhashcode.h\"\n#include \"domain_addr.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirDomainPCIAddressSetFree(virDomainPCIAddressSetPtr addrs)\n{\n    if (!addrs)\n        return;\n\n    virDomainPCIAddressSetExtensionFree(addrs);\n    VIR_FREE(addrs->buses);\n    VIR_FREE(addrs);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"bhyve_capabilities.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"bhyve_driver.h\"\n#include <config.h>\n\nstatic void\nbhyveDomainObjPrivateFree(void *data)\n{\n    bhyveDomainObjPrivatePtr priv = data;\n\n    virDomainPCIAddressSetFree(priv->pciaddrs);\n\n    VIR_FREE(priv);\n}"
  },
  {
    "function_name": "bhyveDomainObjPrivateAlloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_domain.c",
    "lines": "36-45",
    "snippet": "static void *\nbhyveDomainObjPrivateAlloc(void *opaque G_GNUC_UNUSED)\n{\n    bhyveDomainObjPrivatePtr priv;\n\n    if (VIR_ALLOC(priv) < 0)\n        return NULL;\n\n    return priv;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"bhyve_capabilities.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_device.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"bhyve_driver.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "priv"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"bhyve_capabilities.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"bhyve_driver.h\"\n#include <config.h>\n\nstatic void *\nbhyveDomainObjPrivateAlloc(void *opaque G_GNUC_UNUSED)\n{\n    bhyveDomainObjPrivatePtr priv;\n\n    if (VIR_ALLOC(priv) < 0)\n        return NULL;\n\n    return priv;\n}"
  }
]