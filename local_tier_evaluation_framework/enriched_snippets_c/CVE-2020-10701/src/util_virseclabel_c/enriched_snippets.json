[
  {
    "function_name": "virSecurityDeviceLabelDefCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virseclabel.c",
    "lines": "89-104",
    "snippet": "virSecurityDeviceLabelDefPtr\nvirSecurityDeviceLabelDefCopy(const virSecurityDeviceLabelDef *src)\n{\n    virSecurityDeviceLabelDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->relabel = src->relabel;\n    ret->labelskip = src->labelskip;\n\n    ret->model = g_strdup(src->model);\n    ret->label = g_strdup(src->label);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virseclabel.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "src->label"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ret"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virseclabel.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirSecurityDeviceLabelDefPtr\nvirSecurityDeviceLabelDefCopy(const virSecurityDeviceLabelDef *src)\n{\n    virSecurityDeviceLabelDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->relabel = src->relabel;\n    ret->labelskip = src->labelskip;\n\n    ret->model = g_strdup(src->model);\n    ret->label = g_strdup(src->label);\n\n    return ret;\n}"
  },
  {
    "function_name": "virSecurityDeviceLabelDefNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virseclabel.c",
    "lines": "73-86",
    "snippet": "virSecurityDeviceLabelDefPtr\nvirSecurityDeviceLabelDefNew(const char *model)\n{\n    virSecurityDeviceLabelDefPtr seclabel = NULL;\n\n    if (VIR_ALLOC(seclabel) < 0) {\n        virSecurityDeviceLabelDefFree(seclabel);\n        seclabel = NULL;\n    }\n\n    seclabel->model = g_strdup(model);\n\n    return seclabel;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virseclabel.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "model"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityDeviceLabelDefFree",
          "args": [
            "seclabel"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityDeviceLabelDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virseclabel.c",
          "lines": "45-53",
          "snippet": "void\nvirSecurityDeviceLabelDefFree(virSecurityDeviceLabelDefPtr def)\n{\n    if (!def)\n        return;\n    VIR_FREE(def->model);\n    VIR_FREE(def->label);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virseclabel.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virseclabel.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirSecurityDeviceLabelDefFree(virSecurityDeviceLabelDefPtr def)\n{\n    if (!def)\n        return;\n    VIR_FREE(def->model);\n    VIR_FREE(def->label);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "seclabel"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virseclabel.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirSecurityDeviceLabelDefPtr\nvirSecurityDeviceLabelDefNew(const char *model)\n{\n    virSecurityDeviceLabelDefPtr seclabel = NULL;\n\n    if (VIR_ALLOC(seclabel) < 0) {\n        virSecurityDeviceLabelDefFree(seclabel);\n        seclabel = NULL;\n    }\n\n    seclabel->model = g_strdup(model);\n\n    return seclabel;\n}"
  },
  {
    "function_name": "virSecurityLabelDefNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virseclabel.c",
    "lines": "56-71",
    "snippet": "virSecurityLabelDefPtr\nvirSecurityLabelDefNew(const char *model)\n{\n    virSecurityLabelDefPtr seclabel = NULL;\n\n    if (VIR_ALLOC(seclabel) < 0) {\n        virSecurityLabelDefFree(seclabel);\n        return NULL;\n    }\n\n    seclabel->model = g_strdup(model);\n\n    seclabel->relabel = true;\n\n    return seclabel;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virseclabel.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "model"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityLabelDefFree",
          "args": [
            "seclabel"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityLabelDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virseclabel.c",
          "lines": "32-42",
          "snippet": "void\nvirSecurityLabelDefFree(virSecurityLabelDefPtr def)\n{\n    if (!def)\n        return;\n    VIR_FREE(def->model);\n    VIR_FREE(def->label);\n    VIR_FREE(def->imagelabel);\n    VIR_FREE(def->baselabel);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virseclabel.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virseclabel.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirSecurityLabelDefFree(virSecurityLabelDefPtr def)\n{\n    if (!def)\n        return;\n    VIR_FREE(def->model);\n    VIR_FREE(def->label);\n    VIR_FREE(def->imagelabel);\n    VIR_FREE(def->baselabel);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "seclabel"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virseclabel.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirSecurityLabelDefPtr\nvirSecurityLabelDefNew(const char *model)\n{\n    virSecurityLabelDefPtr seclabel = NULL;\n\n    if (VIR_ALLOC(seclabel) < 0) {\n        virSecurityLabelDefFree(seclabel);\n        return NULL;\n    }\n\n    seclabel->model = g_strdup(model);\n\n    seclabel->relabel = true;\n\n    return seclabel;\n}"
  },
  {
    "function_name": "virSecurityDeviceLabelDefFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virseclabel.c",
    "lines": "45-53",
    "snippet": "void\nvirSecurityDeviceLabelDefFree(virSecurityDeviceLabelDefPtr def)\n{\n    if (!def)\n        return;\n    VIR_FREE(def->model);\n    VIR_FREE(def->label);\n    VIR_FREE(def);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virseclabel.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->label"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->model"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virseclabel.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirSecurityDeviceLabelDefFree(virSecurityDeviceLabelDefPtr def)\n{\n    if (!def)\n        return;\n    VIR_FREE(def->model);\n    VIR_FREE(def->label);\n    VIR_FREE(def);\n}"
  },
  {
    "function_name": "virSecurityLabelDefFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virseclabel.c",
    "lines": "32-42",
    "snippet": "void\nvirSecurityLabelDefFree(virSecurityLabelDefPtr def)\n{\n    if (!def)\n        return;\n    VIR_FREE(def->model);\n    VIR_FREE(def->label);\n    VIR_FREE(def->imagelabel);\n    VIR_FREE(def->baselabel);\n    VIR_FREE(def);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virseclabel.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->baselabel"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->imagelabel"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->label"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->model"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virseclabel.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirSecurityLabelDefFree(virSecurityLabelDefPtr def)\n{\n    if (!def)\n        return;\n    VIR_FREE(def->model);\n    VIR_FREE(def->label);\n    VIR_FREE(def->imagelabel);\n    VIR_FREE(def->baselabel);\n    VIR_FREE(def);\n}"
  }
]